(()=>{var fs=Object.create,qt=Object.defineProperty;var ps=Object.getOwnPropertyDescriptor;var ds=Object.getOwnPropertyNames;var vs=Object.getPrototypeOf,gs=Object.prototype.hasOwnProperty;var ms=n=>qt(n,"__esModule",{value:!0});var ys=(n,t)=>()=>(n&&(t=n(n=0)),t),bt=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports),Es=(n,t)=>{for(var e in t)qt(n,e,{get:t[e],enumerable:!0})},ws=(n,t,e)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of ds(t))!gs.call(n,i)&&i!=="default"&&qt(n,i,{get:()=>t[i],enumerable:!(e=ps(t,i))||e.enumerable});return n},_s=n=>ws(ms(qt(n!=null?fs(vs(n)):{},"default",n&&n.__esModule&&"default"in n?{get:()=>n.default,enumerable:!0}:{value:n,enumerable:!0})),n);var Dn={};Es(Dn,{basename:()=>Pn,default:()=>ks,delimiter:()=>On,dirname:()=>Mn,extname:()=>Bn,isAbsolute:()=>Le,join:()=>Cn,normalize:()=>Ce,relative:()=>Ln,resolve:()=>Zt,sep:()=>In});function Tn(n,t){for(var e=0,i=n.length-1;i>=0;i--){var s=n[i];s==="."?n.splice(i,1):s===".."?(n.splice(i,1),e++):e&&(n.splice(i,1),e--)}if(t)for(;e--;e)n.unshift("..");return n}function Zt(){for(var n="",t=!1,e=arguments.length-1;e>=-1&&!t;e--){var i=e>=0?arguments[e]:"/";if(typeof i!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!i)continue;n=i+"/"+n,t=i.charAt(0)==="/"}return n=Tn(Ie(n.split("/"),function(s){return!!s}),!t).join("/"),(t?"/":"")+n||"."}function Ce(n){var t=Le(n),e=Hs(n,-1)==="/";return n=Tn(Ie(n.split("/"),function(i){return!!i}),!t).join("/"),!n&&!t&&(n="."),n&&e&&(n+="/"),(t?"/":"")+n}function Le(n){return n.charAt(0)==="/"}function Cn(){var n=Array.prototype.slice.call(arguments,0);return Ce(Ie(n,function(t,e){if(typeof t!="string")throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))}function Ln(n,t){n=Zt(n).substr(1),t=Zt(t).substr(1);function e(c){for(var p=0;p<c.length&&c[p]==="";p++);for(var m=c.length-1;m>=0&&c[m]==="";m--);return p>m?[]:c.slice(p,m-p+1)}for(var i=e(n.split("/")),s=e(t.split("/")),r=Math.min(i.length,s.length),o=r,l=0;l<r;l++)if(i[l]!==s[l]){o=l;break}for(var a=[],l=o;l<i.length;l++)a.push("..");return a=a.concat(s.slice(o)),a.join("/")}function Mn(n){var t=Te(n),e=t[0],i=t[1];return!e&&!i?".":(i&&(i=i.substr(0,i.length-1)),e+i)}function Pn(n,t){var e=Te(n)[2];return t&&e.substr(-1*t.length)===t&&(e=e.substr(0,e.length-t.length)),e}function Bn(n){return Te(n)[3]}function Ie(n,t){if(n.filter)return n.filter(t);for(var e=[],i=0;i<n.length;i++)t(n[i],i,n)&&e.push(n[i]);return e}var Ds,Te,In,On,ks,Hs,kn=ys(()=>{Ds=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,Te=function(n){return Ds.exec(n).slice(1)};In="/",On=":";ks={extname:Bn,basename:Pn,dirname:Mn,sep:In,delimiter:On,relative:Ln,join:Cn,isAbsolute:Le,normalize:Ce,resolve:Zt};Hs="ab".substr(-1)==="b"?function(n,t,e){return n.substr(t,e)}:function(n,t,e){return t<0&&(t=n.length+t),n.substr(t,e)}});var Vt=bt((ja,Qt)=>{var St=(kn(),Dn);if(St&&St.default){Qt.exports=St.default;for(let n in St)Qt.exports[n]=St[n]}else St&&(Qt.exports=St)});var Ht=bt((Ga,$n)=>{"use strict";var Us=Vt(),ht="\\\\/",Hn=`[^${ht}]`,pt="\\.",Ns="\\+",Ks="\\?",Jt="\\/",$s="(?=.)",Un="[^/]",Oe=`(?:${Jt}|$)`,Nn=`(?:^|${Jt})`,Me=`${pt}{1,2}${Oe}`,Fs=`(?!${pt})`,zs=`(?!${Nn}${Me})`,Ys=`(?!${pt}{0,1}${Oe})`,js=`(?!${Me})`,Gs=`[^.${Jt}]`,Ws=`${Un}*?`,Kn={DOT_LITERAL:pt,PLUS_LITERAL:Ns,QMARK_LITERAL:Ks,SLASH_LITERAL:Jt,ONE_CHAR:$s,QMARK:Un,END_ANCHOR:Oe,DOTS_SLASH:Me,NO_DOT:Fs,NO_DOTS:zs,NO_DOT_SLASH:Ys,NO_DOTS_SLASH:js,QMARK_NO_DOT:Gs,STAR:Ws,START_ANCHOR:Nn},qs={...Kn,SLASH_LITERAL:`[${ht}]`,QMARK:Hn,STAR:`${Hn}*?`,DOTS_SLASH:`${pt}{1,2}(?:[${ht}]|$)`,NO_DOT:`(?!${pt})`,NO_DOTS:`(?!(?:^|[${ht}])${pt}{1,2}(?:[${ht}]|$))`,NO_DOT_SLASH:`(?!${pt}{0,1}(?:[${ht}]|$))`,NO_DOTS_SLASH:`(?!${pt}{1,2}(?:[${ht}]|$))`,QMARK_NO_DOT:`[^.${ht}]`,START_ANCHOR:`(?:^|[${ht}])`,END_ANCHOR:`(?:[${ht}]|$)`},Xs={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};$n.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:Xs,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:Us.sep,extglobChars(n){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${n.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(n){return n===!0?qs:Kn}}});var te=bt(J=>{"use strict";var Zs=Vt(),Qs=!1,{REGEX_BACKSLASH:Vs,REGEX_REMOVE_BACKSLASH:Js,REGEX_SPECIAL_CHARS:tr,REGEX_SPECIAL_CHARS_GLOBAL:er}=Ht();J.isObject=n=>n!==null&&typeof n=="object"&&!Array.isArray(n);J.hasRegexChars=n=>tr.test(n);J.isRegexChar=n=>n.length===1&&J.hasRegexChars(n);J.escapeRegex=n=>n.replace(er,"\\$1");J.toPosixSlashes=n=>n.replace(Vs,"/");J.removeBackslashes=n=>n.replace(Js,t=>t==="\\"?"":t);J.supportsLookbehinds=()=>{let n=process.version.slice(1).split(".").map(Number);return n.length===3&&n[0]>=9||n[0]===8&&n[1]>=10};J.isWindows=n=>n&&typeof n.windows=="boolean"?n.windows:Qs===!0||Zs.sep==="\\";J.escapeLast=(n,t,e)=>{let i=n.lastIndexOf(t,e);return i===-1?n:n[i-1]==="\\"?J.escapeLast(n,t,i-1):`${n.slice(0,i)}\\${n.slice(i)}`};J.removePrefix=(n,t={})=>{let e=n;return e.startsWith("./")&&(e=e.slice(2),t.prefix="./"),e};J.wrapOutput=(n,t={},e={})=>{let i=e.contains?"":"^",s=e.contains?"":"$",r=`${i}(?:${n})${s}`;return t.negated===!0&&(r=`(?:^(?!${r}).*$)`),r}});var Xn=bt((qa,qn)=>{"use strict";var Fn=te(),{CHAR_ASTERISK:Pe,CHAR_AT:nr,CHAR_BACKWARD_SLASH:Ut,CHAR_COMMA:ir,CHAR_DOT:Be,CHAR_EXCLAMATION_MARK:De,CHAR_FORWARD_SLASH:zn,CHAR_LEFT_CURLY_BRACE:ke,CHAR_LEFT_PARENTHESES:He,CHAR_LEFT_SQUARE_BRACKET:sr,CHAR_PLUS:rr,CHAR_QUESTION_MARK:Yn,CHAR_RIGHT_CURLY_BRACE:or,CHAR_RIGHT_PARENTHESES:jn,CHAR_RIGHT_SQUARE_BRACKET:ar}=Ht(),Gn=n=>n===zn||n===Ut,Wn=n=>{n.isPrefix!==!0&&(n.depth=n.isGlobstar?Infinity:1)},lr=(n,t)=>{let e=t||{},i=n.length-1,s=e.parts===!0||e.scanToEnd===!0,r=[],o=[],l=[],a=n,c=-1,p=0,m=0,_=!1,M=!1,T=!1,L=!1,P=!1,H=!1,z=!1,C=!1,j=!1,N=!1,q=0,$,y,A={value:"",depth:0,isGlob:!1},K=()=>c>=i,f=()=>a.charCodeAt(c+1),I=()=>($=y,a.charCodeAt(++c));for(;c<i;){y=I();let G;if(y===Ut){z=A.backslashes=!0,y=I(),y===ke&&(H=!0);continue}if(H===!0||y===ke){for(q++;K()!==!0&&(y=I());){if(y===Ut){z=A.backslashes=!0,I();continue}if(y===ke){q++;continue}if(H!==!0&&y===Be&&(y=I())===Be){if(_=A.isBrace=!0,T=A.isGlob=!0,N=!0,s===!0)continue;break}if(H!==!0&&y===ir){if(_=A.isBrace=!0,T=A.isGlob=!0,N=!0,s===!0)continue;break}if(y===or&&(q--,q===0)){H=!1,_=A.isBrace=!0,N=!0;break}}if(s===!0)continue;break}if(y===zn){if(r.push(c),o.push(A),A={value:"",depth:0,isGlob:!1},N===!0)continue;if($===Be&&c===p+1){p+=2;continue}m=c+1;continue}if(e.noext!==!0&&(y===rr||y===nr||y===Pe||y===Yn||y===De)===!0&&f()===He){if(T=A.isGlob=!0,L=A.isExtglob=!0,N=!0,y===De&&c===p&&(j=!0),s===!0){for(;K()!==!0&&(y=I());){if(y===Ut){z=A.backslashes=!0,y=I();continue}if(y===jn){T=A.isGlob=!0,N=!0;break}}continue}break}if(y===Pe){if($===Pe&&(P=A.isGlobstar=!0),T=A.isGlob=!0,N=!0,s===!0)continue;break}if(y===Yn){if(T=A.isGlob=!0,N=!0,s===!0)continue;break}if(y===sr){for(;K()!==!0&&(G=I());){if(G===Ut){z=A.backslashes=!0,I();continue}if(G===ar){M=A.isBracket=!0,T=A.isGlob=!0,N=!0;break}}if(s===!0)continue;break}if(e.nonegate!==!0&&y===De&&c===p){C=A.negated=!0,p++;continue}if(e.noparen!==!0&&y===He){if(T=A.isGlob=!0,s===!0){for(;K()!==!0&&(y=I());){if(y===He){z=A.backslashes=!0,y=I();continue}if(y===jn){N=!0;break}}continue}break}if(T===!0){if(N=!0,s===!0)continue;break}}e.noext===!0&&(L=!1,T=!1);let R=a,et="",h="";p>0&&(et=a.slice(0,p),a=a.slice(p),m-=p),R&&T===!0&&m>0?(R=a.slice(0,m),h=a.slice(m)):T===!0?(R="",h=a):R=a,R&&R!==""&&R!=="/"&&R!==a&&Gn(R.charCodeAt(R.length-1))&&(R=R.slice(0,-1)),e.unescape===!0&&(h&&(h=Fn.removeBackslashes(h)),R&&z===!0&&(R=Fn.removeBackslashes(R)));let u={prefix:et,input:n,start:p,base:R,glob:h,isBrace:_,isBracket:M,isGlob:T,isExtglob:L,isGlobstar:P,negated:C,negatedExtglob:j};if(e.tokens===!0&&(u.maxDepth=0,Gn(y)||o.push(A),u.tokens=o),e.parts===!0||e.tokens===!0){let G;for(let S=0;S<r.length;S++){let V=G?G+1:p,W=r[S],X=n.slice(V,W);e.tokens&&(S===0&&p!==0?(o[S].isPrefix=!0,o[S].value=et):o[S].value=X,Wn(o[S]),u.maxDepth+=o[S].depth),(S!==0||X!=="")&&l.push(X),G=W}if(G&&G+1<n.length){let S=n.slice(G+1);l.push(S),e.tokens&&(o[o.length-1].value=S,Wn(o[o.length-1]),u.maxDepth+=o[o.length-1].depth)}u.slashes=r,u.parts=l}return u};qn.exports=lr});var Vn=bt((Xa,Qn)=>{"use strict";var ee=Ht(),nt=te(),{MAX_LENGTH:ne,POSIX_REGEX_SOURCE:ur,REGEX_NON_SPECIAL_CHARS:hr,REGEX_SPECIAL_CHARS_BACKREF:cr,REPLACEMENTS:Zn}=ee,fr=(n,t)=>{if(typeof t.expandRange=="function")return t.expandRange(...n,t);n.sort();let e=`[${n.join("-")}]`;try{new RegExp(e)}catch(i){return n.map(s=>nt.escapeRegex(s)).join("..")}return e},It=(n,t)=>`Missing ${n}: "${t}" - use "\\\\${t}" to match literal characters`,Ue=(n,t)=>{if(typeof n!="string")throw new TypeError("Expected a string");n=Zn[n]||n;let e={...t},i=typeof e.maxLength=="number"?Math.min(ne,e.maxLength):ne,s=n.length;if(s>i)throw new SyntaxError(`Input length: ${s}, exceeds maximum allowed length: ${i}`);let r={type:"bos",value:"",output:e.prepend||""},o=[r],l=e.capture?"":"?:",a=nt.isWindows(t),c=ee.globChars(a),p=ee.extglobChars(c),{DOT_LITERAL:m,PLUS_LITERAL:_,SLASH_LITERAL:M,ONE_CHAR:T,DOTS_SLASH:L,NO_DOT:P,NO_DOT_SLASH:H,NO_DOTS_SLASH:z,QMARK:C,QMARK_NO_DOT:j,STAR:N,START_ANCHOR:q}=c,$=g=>`(${l}(?:(?!${q}${g.dot?L:m}).)*?)`,y=e.dot?"":P,A=e.dot?C:j,K=e.bash===!0?$(e):N;e.capture&&(K=`(${K})`),typeof e.noext=="boolean"&&(e.noextglob=e.noext);let f={input:n,index:-1,start:0,dot:e.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:o};n=nt.removePrefix(n,f),s=n.length;let I=[],R=[],et=[],h=r,u,G=()=>f.index===s-1,S=f.peek=(g=1)=>n[f.index+g],V=f.advance=()=>n[++f.index]||"",W=()=>n.slice(f.index+1),X=(g="",B=0)=>{f.consumed+=g,f.index+=B},at=g=>{f.output+=g.output!=null?g.output:g.value,X(g.value)},Dt=()=>{let g=1;for(;S()==="!"&&(S(2)!=="("||S(3)==="?");)V(),f.start++,g++;return g%2==0?!1:(f.negated=!0,f.start++,!0)},yt=g=>{f[g]++,et.push(g)},lt=g=>{f[g]--,et.pop()},b=g=>{if(h.type==="globstar"){let B=f.braces>0&&(g.type==="comma"||g.type==="brace"),d=g.extglob===!0||I.length&&(g.type==="pipe"||g.type==="paren");g.type!=="slash"&&g.type!=="paren"&&!B&&!d&&(f.output=f.output.slice(0,-h.output.length),h.type="star",h.value="*",h.output=K,f.output+=h.output)}if(I.length&&g.type!=="paren"&&(I[I.length-1].inner+=g.value),(g.value||g.output)&&at(g),h&&h.type==="text"&&g.type==="text"){h.value+=g.value,h.output=(h.output||"")+g.value;return}g.prev=h,o.push(g),h=g},At=(g,B)=>{let d={...p[B],conditions:1,inner:""};d.prev=h,d.parens=f.parens,d.output=f.output;let x=(e.capture?"(":"")+d.open;yt("parens"),b({type:g,value:B,output:f.output?"":T}),b({type:"paren",extglob:!0,value:V(),output:x}),I.push(d)},Gt=g=>{let B=g.close+(e.capture?")":""),d;if(g.type==="negate"){let x=K;if(g.inner&&g.inner.length>1&&g.inner.includes("/")&&(x=$(e)),(x!==K||G()||/^\)+$/.test(W()))&&(B=g.close=`)$))${x}`),g.inner.includes("*")&&(d=W())&&/^\.[^\\/.]+$/.test(d)){let U=Ue(d,{...t,fastpaths:!1}).output;B=g.close=`)${U})${x})`}g.prev.type==="bos"&&(f.negatedExtglob=!0)}b({type:"paren",extglob:!0,value:u,output:B}),lt("parens")};if(e.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(n)){let g=!1,B=n.replace(cr,(d,x,U,Z,Y,ve)=>Z==="\\"?(g=!0,d):Z==="?"?x?x+Z+(Y?C.repeat(Y.length):""):ve===0?A+(Y?C.repeat(Y.length):""):C.repeat(U.length):Z==="."?m.repeat(U.length):Z==="*"?x?x+Z+(Y?K:""):K:x?d:`\\${d}`);return g===!0&&(e.unescape===!0?B=B.replace(/\\/g,""):B=B.replace(/\\+/g,d=>d.length%2==0?"\\\\":d?"\\":"")),B===n&&e.contains===!0?(f.output=n,f):(f.output=nt.wrapOutput(B,f,t),f)}for(;!G();){if(u=V(),u==="\0")continue;if(u==="\\"){let d=S();if(d==="/"&&e.bash!==!0||d==="."||d===";")continue;if(!d){u+="\\",b({type:"text",value:u});continue}let x=/^\\+/.exec(W()),U=0;if(x&&x[0].length>2&&(U=x[0].length,f.index+=U,U%2!=0&&(u+="\\")),e.unescape===!0?u=V():u+=V(),f.brackets===0){b({type:"text",value:u});continue}}if(f.brackets>0&&(u!=="]"||h.value==="["||h.value==="[^")){if(e.posix!==!1&&u===":"){let d=h.value.slice(1);if(d.includes("[")&&(h.posix=!0,d.includes(":"))){let x=h.value.lastIndexOf("["),U=h.value.slice(0,x),Z=h.value.slice(x+2),Y=ur[Z];if(Y){h.value=U+Y,f.backtrack=!0,V(),!r.output&&o.indexOf(h)===1&&(r.output=T);continue}}}(u==="["&&S()!==":"||u==="-"&&S()==="]")&&(u=`\\${u}`),u==="]"&&(h.value==="["||h.value==="[^")&&(u=`\\${u}`),e.posix===!0&&u==="!"&&h.value==="["&&(u="^"),h.value+=u,at({value:u});continue}if(f.quotes===1&&u!=='"'){u=nt.escapeRegex(u),h.value+=u,at({value:u});continue}if(u==='"'){f.quotes=f.quotes===1?0:1,e.keepQuotes===!0&&b({type:"text",value:u});continue}if(u==="("){yt("parens"),b({type:"paren",value:u});continue}if(u===")"){if(f.parens===0&&e.strictBrackets===!0)throw new SyntaxError(It("opening","("));let d=I[I.length-1];if(d&&f.parens===d.parens+1){Gt(I.pop());continue}b({type:"paren",value:u,output:f.parens?")":"\\)"}),lt("parens");continue}if(u==="["){if(e.nobracket===!0||!W().includes("]")){if(e.nobracket!==!0&&e.strictBrackets===!0)throw new SyntaxError(It("closing","]"));u=`\\${u}`}else yt("brackets");b({type:"bracket",value:u});continue}if(u==="]"){if(e.nobracket===!0||h&&h.type==="bracket"&&h.value.length===1){b({type:"text",value:u,output:`\\${u}`});continue}if(f.brackets===0){if(e.strictBrackets===!0)throw new SyntaxError(It("opening","["));b({type:"text",value:u,output:`\\${u}`});continue}lt("brackets");let d=h.value.slice(1);if(h.posix!==!0&&d[0]==="^"&&!d.includes("/")&&(u=`/${u}`),h.value+=u,at({value:u}),e.literalBrackets===!1||nt.hasRegexChars(d))continue;let x=nt.escapeRegex(h.value);if(f.output=f.output.slice(0,-h.value.length),e.literalBrackets===!0){f.output+=x,h.value=x;continue}h.value=`(${l}${x}|${h.value})`,f.output+=h.value;continue}if(u==="{"&&e.nobrace!==!0){yt("braces");let d={type:"brace",value:u,output:"(",outputIndex:f.output.length,tokensIndex:f.tokens.length};R.push(d),b(d);continue}if(u==="}"){let d=R[R.length-1];if(e.nobrace===!0||!d){b({type:"text",value:u,output:u});continue}let x=")";if(d.dots===!0){let U=o.slice(),Z=[];for(let Y=U.length-1;Y>=0&&(o.pop(),U[Y].type!=="brace");Y--)U[Y].type!=="dots"&&Z.unshift(U[Y].value);x=fr(Z,e),f.backtrack=!0}if(d.comma!==!0&&d.dots!==!0){let U=f.output.slice(0,d.outputIndex),Z=f.tokens.slice(d.tokensIndex);d.value=d.output="\\{",u=x="\\}",f.output=U;for(let Y of Z)f.output+=Y.output||Y.value}b({type:"brace",value:u,output:x}),lt("braces"),R.pop();continue}if(u==="|"){I.length>0&&I[I.length-1].conditions++,b({type:"text",value:u});continue}if(u===","){let d=u,x=R[R.length-1];x&&et[et.length-1]==="braces"&&(x.comma=!0,d="|"),b({type:"comma",value:u,output:d});continue}if(u==="/"){if(h.type==="dot"&&f.index===f.start+1){f.start=f.index+1,f.consumed="",f.output="",o.pop(),h=r;continue}b({type:"slash",value:u,output:M});continue}if(u==="."){if(f.braces>0&&h.type==="dot"){h.value==="."&&(h.output=m);let d=R[R.length-1];h.type="dots",h.output+=u,h.value+=u,d.dots=!0;continue}if(f.braces+f.parens===0&&h.type!=="bos"&&h.type!=="slash"){b({type:"text",value:u,output:m});continue}b({type:"dot",value:u,output:m});continue}if(u==="?"){if(!(h&&h.value==="(")&&e.noextglob!==!0&&S()==="("&&S(2)!=="?"){At("qmark",u);continue}if(h&&h.type==="paren"){let x=S(),U=u;if(x==="<"&&!nt.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(h.value==="("&&!/[!=<:]/.test(x)||x==="<"&&!/<([!=]|\w+>)/.test(W()))&&(U=`\\${u}`),b({type:"text",value:u,output:U});continue}if(e.dot!==!0&&(h.type==="slash"||h.type==="bos")){b({type:"qmark",value:u,output:j});continue}b({type:"qmark",value:u,output:C});continue}if(u==="!"){if(e.noextglob!==!0&&S()==="("&&(S(2)!=="?"||!/[!=<:]/.test(S(3)))){At("negate",u);continue}if(e.nonegate!==!0&&f.index===0){Dt();continue}}if(u==="+"){if(e.noextglob!==!0&&S()==="("&&S(2)!=="?"){At("plus",u);continue}if(h&&h.value==="("||e.regex===!1){b({type:"plus",value:u,output:_});continue}if(h&&(h.type==="bracket"||h.type==="paren"||h.type==="brace")||f.parens>0){b({type:"plus",value:u});continue}b({type:"plus",value:_});continue}if(u==="@"){if(e.noextglob!==!0&&S()==="("&&S(2)!=="?"){b({type:"at",extglob:!0,value:u,output:""});continue}b({type:"text",value:u});continue}if(u!=="*"){(u==="$"||u==="^")&&(u=`\\${u}`);let d=hr.exec(W());d&&(u+=d[0],f.index+=d[0].length),b({type:"text",value:u});continue}if(h&&(h.type==="globstar"||h.star===!0)){h.type="star",h.star=!0,h.value+=u,h.output=K,f.backtrack=!0,f.globstar=!0,X(u);continue}let g=W();if(e.noextglob!==!0&&/^\([^?]/.test(g)){At("star",u);continue}if(h.type==="star"){if(e.noglobstar===!0){X(u);continue}let d=h.prev,x=d.prev,U=d.type==="slash"||d.type==="bos",Z=x&&(x.type==="star"||x.type==="globstar");if(e.bash===!0&&(!U||g[0]&&g[0]!=="/")){b({type:"star",value:u,output:""});continue}let Y=f.braces>0&&(d.type==="comma"||d.type==="brace"),ve=I.length&&(d.type==="pipe"||d.type==="paren");if(!U&&d.type!=="paren"&&!Y&&!ve){b({type:"star",value:u,output:""});continue}for(;g.slice(0,3)==="/**";){let Wt=n[f.index+4];if(Wt&&Wt!=="/")break;g=g.slice(3),X("/**",3)}if(d.type==="bos"&&G()){h.type="globstar",h.value+=u,h.output=$(e),f.output=h.output,f.globstar=!0,X(u);continue}if(d.type==="slash"&&d.prev.type!=="bos"&&!Z&&G()){f.output=f.output.slice(0,-(d.output+h.output).length),d.output=`(?:${d.output}`,h.type="globstar",h.output=$(e)+(e.strictSlashes?")":"|$)"),h.value+=u,f.globstar=!0,f.output+=d.output+h.output,X(u);continue}if(d.type==="slash"&&d.prev.type!=="bos"&&g[0]==="/"){let Wt=g[1]!==void 0?"|$":"";f.output=f.output.slice(0,-(d.output+h.output).length),d.output=`(?:${d.output}`,h.type="globstar",h.output=`${$(e)}${M}|${M}${Wt})`,h.value+=u,f.output+=d.output+h.output,f.globstar=!0,X(u+V()),b({type:"slash",value:"/",output:""});continue}if(d.type==="bos"&&g[0]==="/"){h.type="globstar",h.value+=u,h.output=`(?:^|${M}|${$(e)}${M})`,f.output=h.output,f.globstar=!0,X(u+V()),b({type:"slash",value:"/",output:""});continue}f.output=f.output.slice(0,-h.output.length),h.type="globstar",h.output=$(e),h.value+=u,f.output+=h.output,f.globstar=!0,X(u);continue}let B={type:"star",value:u,output:K};if(e.bash===!0){B.output=".*?",(h.type==="bos"||h.type==="slash")&&(B.output=y+B.output),b(B);continue}if(h&&(h.type==="bracket"||h.type==="paren")&&e.regex===!0){B.output=u,b(B);continue}(f.index===f.start||h.type==="slash"||h.type==="dot")&&(h.type==="dot"?(f.output+=H,h.output+=H):e.dot===!0?(f.output+=z,h.output+=z):(f.output+=y,h.output+=y),S()!=="*"&&(f.output+=T,h.output+=T)),b(B)}for(;f.brackets>0;){if(e.strictBrackets===!0)throw new SyntaxError(It("closing","]"));f.output=nt.escapeLast(f.output,"["),lt("brackets")}for(;f.parens>0;){if(e.strictBrackets===!0)throw new SyntaxError(It("closing",")"));f.output=nt.escapeLast(f.output,"("),lt("parens")}for(;f.braces>0;){if(e.strictBrackets===!0)throw new SyntaxError(It("closing","}"));f.output=nt.escapeLast(f.output,"{"),lt("braces")}if(e.strictSlashes!==!0&&(h.type==="star"||h.type==="bracket")&&b({type:"maybe_slash",value:"",output:`${M}?`}),f.backtrack===!0){f.output="";for(let g of f.tokens)f.output+=g.output!=null?g.output:g.value,g.suffix&&(f.output+=g.suffix)}return f};Ue.fastpaths=(n,t)=>{let e={...t},i=typeof e.maxLength=="number"?Math.min(ne,e.maxLength):ne,s=n.length;if(s>i)throw new SyntaxError(`Input length: ${s}, exceeds maximum allowed length: ${i}`);n=Zn[n]||n;let r=nt.isWindows(t),{DOT_LITERAL:o,SLASH_LITERAL:l,ONE_CHAR:a,DOTS_SLASH:c,NO_DOT:p,NO_DOTS:m,NO_DOTS_SLASH:_,STAR:M,START_ANCHOR:T}=ee.globChars(r),L=e.dot?m:p,P=e.dot?_:p,H=e.capture?"":"?:",z={negated:!1,prefix:""},C=e.bash===!0?".*?":M;e.capture&&(C=`(${C})`);let j=y=>y.noglobstar===!0?C:`(${H}(?:(?!${T}${y.dot?c:o}).)*?)`,N=y=>{switch(y){case"*":return`${L}${a}${C}`;case".*":return`${o}${a}${C}`;case"*.*":return`${L}${C}${o}${a}${C}`;case"*/*":return`${L}${C}${l}${a}${P}${C}`;case"**":return L+j(e);case"**/*":return`(?:${L}${j(e)}${l})?${P}${a}${C}`;case"**/*.*":return`(?:${L}${j(e)}${l})?${P}${C}${o}${a}${C}`;case"**/.*":return`(?:${L}${j(e)}${l})?${o}${a}${C}`;default:{let A=/^(.*?)\.(\w+)$/.exec(y);if(!A)return;let K=N(A[1]);return K?K+o+A[2]:void 0}}},q=nt.removePrefix(n,z),$=N(q);return $&&e.strictSlashes!==!0&&($+=`${l}?`),$};Qn.exports=Ue});var ti=bt((Za,Jn)=>{"use strict";var pr=Vt(),dr=Xn(),Ne=Vn(),Ke=te(),vr=Ht(),gr=n=>n&&typeof n=="object"&&!Array.isArray(n),F=(n,t,e=!1)=>{if(Array.isArray(n)){let p=n.map(_=>F(_,t,e));return _=>{for(let M of p){let T=M(_);if(T)return T}return!1}}let i=gr(n)&&n.tokens&&n.input;if(n===""||typeof n!="string"&&!i)throw new TypeError("Expected pattern to be a non-empty string");let s=t||{},r=Ke.isWindows(t),o=i?F.compileRe(n,t):F.makeRe(n,t,!1,!0),l=o.state;delete o.state;let a=()=>!1;if(s.ignore){let p={...t,ignore:null,onMatch:null,onResult:null};a=F(s.ignore,p,e)}let c=(p,m=!1)=>{let{isMatch:_,match:M,output:T}=F.test(p,o,t,{glob:n,posix:r}),L={glob:n,state:l,regex:o,posix:r,input:p,output:T,match:M,isMatch:_};return typeof s.onResult=="function"&&s.onResult(L),_===!1?(L.isMatch=!1,m?L:!1):a(p)?(typeof s.onIgnore=="function"&&s.onIgnore(L),L.isMatch=!1,m?L:!1):(typeof s.onMatch=="function"&&s.onMatch(L),m?L:!0)};return e&&(c.state=l),c};F.test=(n,t,e,{glob:i,posix:s}={})=>{if(typeof n!="string")throw new TypeError("Expected input to be a string");if(n==="")return{isMatch:!1,output:""};let r=e||{},o=r.format||(s?Ke.toPosixSlashes:null),l=n===i,a=l&&o?o(n):n;return l===!1&&(a=o?o(n):n,l=a===i),(l===!1||r.capture===!0)&&(r.matchBase===!0||r.basename===!0?l=F.matchBase(n,t,e,s):l=t.exec(a)),{isMatch:Boolean(l),match:l,output:a}};F.matchBase=(n,t,e,i=Ke.isWindows(e))=>(t instanceof RegExp?t:F.makeRe(t,e)).test(pr.basename(n));F.isMatch=(n,t,e)=>F(t,e)(n);F.parse=(n,t)=>Array.isArray(n)?n.map(e=>F.parse(e,t)):Ne(n,{...t,fastpaths:!1});F.scan=(n,t)=>dr(n,t);F.compileRe=(n,t,e=!1,i=!1)=>{if(e===!0)return n.output;let s=t||{},r=s.contains?"":"^",o=s.contains?"":"$",l=`${r}(?:${n.output})${o}`;n&&n.negated===!0&&(l=`^(?!${l}).*$`);let a=F.toRegex(l,t);return i===!0&&(a.state=n),a};F.makeRe=(n,t={},e=!1,i=!1)=>{if(!n||typeof n!="string")throw new TypeError("Expected a non-empty string");let s={negated:!1,fastpaths:!0};return t.fastpaths!==!1&&(n[0]==="."||n[0]==="*")&&(s.output=Ne.fastpaths(n,t)),s.output||(s=Ne(n,t)),F.compileRe(s,t,e,i)};F.toRegex=(n,t)=>{try{let e=t||{};return new RegExp(n,e.flags||(e.nocase?"i":""))}catch(e){if(t&&t.debug===!0)throw e;return/$^/}};F.constants=vr;Jn.exports=F});var ni=bt((Qa,ei)=>{"use strict";ei.exports=ti()});var As=`<div class="container">
  <label class="hidden" id="title">display-port</label>
  <label class="hidden" id="fps">00</label>
  <label class="hidden" id="dimension">0x0</label>
  <div class="content">
    <canvas> Oh no! Your browser does not support canvas. </canvas>
    <slot id="inner"></slot>
  </div>
  <slot name="frame"></slot>
</div>
`,bs=`:host {
  display: inline-block;
  color: #555555;
}

.container {
  display: flex;
  position: relative;
  width: 100%;
  height: 100%;
}

.content {
  position: relative;
  margin: auto;
}

.content > *:not(canvas) {
  width: 100%;
  height: 100%;
}

canvas {
  background: #000000;
  image-rendering: pixelated;
}

label {
  position: absolute;
  font-family: monospace;
  color: currentColor;
}

#inner {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: 0;
  left: 0;
  pointer-events: none;
}

#title {
  left: 0.5rem;
  top: 0.5rem;
}

#fps {
  right: 0.5rem;
  top: 0.5rem;
}

#dimension {
  left: 0.5rem;
  bottom: 0.5rem;
}

.hidden {
  display: none;
}

:host([debug]) .container {
  outline: 6px dashed rgba(0, 0, 0, 0.1);
  outline-offset: -4px;
  background-color: rgba(0, 0, 0, 0.1);
}

:host([mode='noscale']) canvas {
  margin: 0;
  top: 0;
  left: 0;
}

:host([mode='stretch']) canvas,
:host([mode='scale']) canvas {
  width: 100%;
  height: 100%;
}

:host([mode='fit']),
:host([mode='scale']),
:host([mode='center']),
:host([mode='stretch']),
:host([mode='fill']) {
  width: 100%;
  height: 100%;
}

:host([full]) {
  width: 100vw !important;
  height: 100vh !important;
}

:host([disabled]) {
  display: none;
}

slot {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  pointer-events: none;
}

::slotted(*) {
  pointer-events: auto;
}
`,dn="noscale",ge="fit",vn="scale",gn="fill",mn="stretch",xs=300,Ss=150,Rs=ge,Ts=200,yn=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=As,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=bs,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("display-port",this)}static get observedAttributes(){return["debug","disabled","width","height","onframe","id","class"]}get mode(){return this.getAttribute("mode")}set mode(t){this.setAttribute("mode",t)}get debug(){return this._debug}set debug(t){this.toggleAttribute("debug",t)}get disabled(){return this._disabled}set disabled(t){this.toggleAttribute("disabled",t)}get width(){return this._width}set width(t){this.setAttribute("width",String(t))}get height(){return this._height}set height(t){this.setAttribute("height",String(t))}get onframe(){return this._onframe}set onframe(t){this._onframe&&this.removeEventListener("frame",this._onframe),this._onframe=t,this._onframe&&this.addEventListener("frame",t)}constructor(){super();let t=this.attachShadow({mode:"open"});t.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),t.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._canvasElement=t.querySelector("canvas"),this._contentElement=t.querySelector(".content"),this._innerElement=t.querySelector("#inner"),this._titleElement=t.querySelector("#title"),this._fpsElement=t.querySelector("#fps"),this._dimensionElement=t.querySelector("#dimension"),this._debug=!1,this._disabled=!1,this._width=xs,this._height=Ss,this._onframe=void 0,this._animationRequestHandle=0,this._prevAnimationFrameTime=0,this._resizeTimeoutHandle=0,this._resizeCanvasWidth=0,this._resizeCanvasHeight=0,this._frameEvent=new CustomEvent("frame",{composed:!0,bubbles:!1,detail:{now:0,prevTime:0,deltaTime:0,canvas:this._canvasElement}}),this._resizeEvent=new CustomEvent("resize",{composed:!0,bubbles:!1,detail:{width:0,height:0}}),this.update=this.update.bind(this),this.onDelayCanvasResize=this.onDelayCanvasResize.bind(this)}get canvas(){return this._canvasElement}connectedCallback(){Lt(this,"mode"),Lt(this,"debug"),Lt(this,"disabled"),Lt(this,"width"),Lt(this,"height"),Lt(this,"onframe"),this.hasAttribute("mode")||this.setAttribute("mode",Rs),this.hasAttribute("tabindex")||this.setAttribute("tabindex","0"),this.updateCanvasSize(!0),this.resume()}disconnectedCallback(){this.pause()}attributeChangedCallback(t,e,i){switch(t){case"debug":this._debug=i!==null;break;case"disabled":this._disabled=i!==null;break;case"width":this._width=Number(i);break;case"height":this._height=Number(i);break;case"onframe":this.onframe=new Function("event","with(document){with(this){"+i+"}}").bind(this);break}switch(t){case"disabled":i?(this.update(0),this.pause()):this.resume();break;case"id":case"class":this._titleElement.innerHTML=`display-port${this.className?"."+this.className:""}${this.hasAttribute("id")?"#"+this.getAttribute("id"):""}`;break;case"debug":this._titleElement.classList.toggle("hidden",i),this._fpsElement.classList.toggle("hidden",i),this._dimensionElement.classList.toggle("hidden",i);break}}getContext(t="2d",e=void 0){return this._canvasElement.getContext(t,e)}pause(){cancelAnimationFrame(this._animationRequestHandle)}resume(){this._animationRequestHandle=requestAnimationFrame(this.update)}update(t){this._animationRequestHandle=requestAnimationFrame(this.update),this.updateCanvasSize(!1);let e=t-this._prevAnimationFrameTime;if(this._prevAnimationFrameTime=t,this._debug){let r=e<=0?"--":String(Math.round(1e3/e)).padStart(2,"0");if(this._fpsElement.textContent!==r&&(this._fpsElement.textContent=r),this.mode===dn){let l=`${this._width}x${this._height}`;this._dimensionElement.textContent!==l&&(this._dimensionElement.textContent=l)}else{let l=`${this._width}x${this._height}|${this.shadowRoot.host.clientWidth}x${this.shadowRoot.host.clientHeight}`;this._dimensionElement.textContent!==l&&(this._dimensionElement.textContent=l)}}let s=this._frameEvent.detail;s.now=t,s.prevTime=this._prevAnimationFrameTime,s.deltaTime=e,this.dispatchEvent(this._frameEvent)}onDelayCanvasResize(){this._resizeTimeoutHandle=0,this.updateCanvasSize(!0)}delayCanvasResize(t,e){(t!==this._resizeCanvasWidth||e!==this._resizeCanvasHeight)&&(this._resizeCanvasWidth=t,this._resizeCanvasHeight=e,this._resizeTimeoutHandle&&clearTimeout(this._resizeTimeoutHandle),this._resizeTimeoutHandle=setTimeout(this.onDelayCanvasResize,Ts))}updateCanvasSize(t=!0){let e=this.shadowRoot.host.getBoundingClientRect(),i=e.width,s=e.height,r=this._canvasElement,o=this._width,l=this._height,a=this.mode;if(a===mn||a===gn)o=i,l=s;else if(a!==dn&&(i<o||s<l||a===ge||a==vn)){let p=i/o,m=s/l;p<m?(o=i,l=l*p):(o=o*m,l=s)}if(o=Math.floor(o),l=Math.floor(l),typeof t=="undefined"&&(t=r.clientWidth!==o||r.clientHeight!==l),!t){this.delayCanvasResize(o,l);return}let c=Math.min(o/this._width,l/this._height)*.5;if(this._innerElement.style.fontSize=`font-size: ${c}em`,t){a===vn?(r.width=this._width,r.height=this._height):a!==mn&&(r.width=o,r.height=l);let p=this._contentElement.style;p.width=`${o}px`,p.height=`${l}px`,(a===ge||a===gn)&&(this._width=o,this._height=l);let _=this._resizeEvent.detail;_.width=o,_.height=l,this.dispatchEvent(this._resizeEvent)}}};yn.define();function Lt(n,t){if(Object.prototype.hasOwnProperty.call(n,t)){let e=n[t];delete n[t],n[t]=e}}var me=class{get polling(){return performance.now()-this._lastPollingTime<1e3}get value(){return 0}get size(){return this._size}constructor(t){this._size=t,this._lastPollingTime=Number.MIN_SAFE_INTEGER}resize(t){this._size=t}getState(t){throw new Error("Missing implementation.")}onUpdate(t,e,i){throw new Error("Missing implementation.")}onStatus(t,e){throw new Error("Missing implementation.")}onPoll(t){this._lastPollingTime=t}onBind(t,e=void 0){t>=this._size&&this.resize(t+1)}onUnbind(){this.resize(0)}},kt=class extends me{static createAxisBindingState(){return{value:0,delta:0,inverted:!1}}get delta(){return this._delta}get value(){return this._value}constructor(t=0){super(t);let e=new Array,i=this.constructor;for(let s=0;s<t;++s)e.push(i.createAxisBindingState());this._state=e,this._value=0,this._delta=0}resize(t){let e=this._state,i=e.length,s;if(t<=i)s=e.slice(0,t);else{s=e;let r=this.constructor;for(let o=i;o<t;++o)s.push(r.createAxisBindingState())}this._state=s,super.resize(t)}getState(t){return this._state[t].value}onPoll(t){let e=this._state,i=0,s=0,r=e.length;for(let o=0;o<r;++o){let l=e[o];i+=l.value*(l.inverted?-1:1),s+=l.delta,e[o].delta=0}this._value=i,this._delta=s,super.onPoll(t)}onUpdate(t,e,i){typeof e=="undefined"?this.onAxisChange(t,i):this.onAxisMove(t,e,i)}onStatus(t,e){this.onAxisStatus(t,e)}onBind(t,e=void 0){super.onBind(t,e);let{inverted:i=!1}=e||{},s=this._state;s[t].inverted=i}onAxisMove(t,e,i){let s=this._state[t];s.value=e,s.delta+=i}onAxisChange(t,e){let i=this._state[t];i.value+=e,i.delta+=e}onAxisStatus(t,e){let i=this._state[t],s=i.value;i.value=e,i.delta=e-s}},Cs=241,En=254,Ls=239,xt=1,ye=2,Ee=4,we=8,_e=16,Xt=class extends me{get pressed(){return this._pressed}get repeated(){return this._repeated}get released(){return this._released}get down(){return this._down}get value(){return this._value}constructor(t=0){super(t);this._state=new Uint8Array(t),this._value=0,this._down=!1,this._pressed=!1,this._repeated=!1,this._released=!1}resize(t){let e=this._state,i=e.length,s;t<=i?s=e.slice(0,t):(s=new Uint8Array(t),s.set(e)),this._state=s,super.resize(t)}getState(t){let e=this._state[t],i=e&_e?-1:1;return(e&xt?1:0)*i}onPoll(t){let e=this._state,i=0,s=0,r=0,o=0,l=0,a=e.length;for(let c=0;c<a;++c){let p=e[c],m=p&xt,_=p&_e;s|=m,r|=p&ye,o|=p&Ee,l|=p&we,i+=(m?1:0)*(_?-1:1),e[c]&=Cs}this._value=i,this._down=s!==0,this._pressed=r!==0,this._repeated=o!==0,this._released=l!==0,super.onPoll(t)}onUpdate(t,e,i){i>0?this.onButtonPressed(t):this.onButtonReleased(t)}onStatus(t,e){this.onButtonStatus(t,e!==0)}onBind(t,e={inverted:!1}){super.onBind(t,e);let{inverted:i=!1}=e,s=this._state;i?s[t]|=_e:s[t]&=Ls}onButtonPressed(t){let e=this._state,i=e[t];i&xt||(i|=ye,i|=xt),i|=Ee,e[t]=i}onButtonReleased(t){let e=this._state,i=e[t];i&xt&&(i|=we,i&=En),e[t]=i}onButtonStatus(t,e){let i=this._state,s=i[t],r=Boolean(s&xt);e?s|=xt:s&=En,r&&!e&&(s|=we),!r&&e&&(s|=ye,s|=Ee),i[t]=s}},v=class{static parse(t){t=t.trim();let e=t.indexOf(".");if(e<0)throw new Error("Missing device separator for key code.");let i=t.substring(0,e);if(i.length<0)throw new Error("Missing device for key code.");let s=t.substring(e+1);if(s.length<0)throw new Error("Missing code for key code.");return new v(i,s)}constructor(t,e){this.device=t,this.code=e}toString(){return`${this.device}.${this.code}`}};var E="Keyboard",ut="Mouse",Co=new v(E,"KeyA"),Lo=new v(E,"KeyB"),Io=new v(E,"KeyC"),Oo=new v(E,"KeyD"),Mo=new v(E,"KeyE"),Po=new v(E,"KeyF"),Bo=new v(E,"KeyG"),Do=new v(E,"KeyH"),ko=new v(E,"KeyI"),Ho=new v(E,"KeyJ"),Uo=new v(E,"KeyK"),No=new v(E,"KeyL"),Ko=new v(E,"KeyM"),$o=new v(E,"KeyN"),Fo=new v(E,"KeyO"),zo=new v(E,"KeyP"),Yo=new v(E,"KeyQ"),jo=new v(E,"KeyR"),Go=new v(E,"KeyS"),Wo=new v(E,"KeyT"),qo=new v(E,"KeyU"),Xo=new v(E,"KeyV"),Zo=new v(E,"KeyW"),Qo=new v(E,"KeyX"),Vo=new v(E,"KeyY"),Jo=new v(E,"KeyZ"),ta=new v(E,"Digit0"),ea=new v(E,"Digit1"),na=new v(E,"Digit2"),ia=new v(E,"Digit3"),sa=new v(E,"Digit4"),ra=new v(E,"Digit5"),oa=new v(E,"Digit6"),aa=new v(E,"Digit7"),la=new v(E,"Digit8"),ua=new v(E,"Digit9"),ha=new v(E,"Minus"),ca=new v(E,"Equal"),fa=new v(E,"BracketLeft"),pa=new v(E,"BracketRight"),da=new v(E,"Semicolon"),va=new v(E,"Quote"),ga=new v(E,"Backquote"),ma=new v(E,"Backslash"),ya=new v(E,"Comma"),Ea=new v(E,"Period"),wa=new v(E,"Slash"),_a=new v(E,"Escape"),Aa=new v(E,"Space"),ba=new v(E,"CapsLock"),xa=new v(E,"Backspace"),Sa=new v(E,"Delete"),Ra=new v(E,"Tab"),Ta=new v(E,"Enter"),Ca=new v(E,"ArrowUp"),La=new v(E,"ArrowDown"),Ia=new v(E,"ArrowLeft"),Oa=new v(E,"ArrowRight"),Ma=new v(ut,"Button0"),Pa=new v(ut,"Button1"),Ba=new v(ut,"Button2"),Da=new v(ut,"Button3"),ka=new v(ut,"Button4"),Ha=new v(ut,"PosX"),Ua=new v(ut,"PosY"),Na=new v(ut,"WheelX"),Ka=new v(ut,"WheelY"),$a=new v(ut,"WheelZ");var Ae=class{static isAxis(t){return!1}static isButton(t){return!1}constructor(t,e){if(!e)throw new Error(`Missing event target for device ${t}.`);this.name=t,this.eventTarget=e,this.listeners={input:[]}}setEventTarget(t){if(!t)throw new Error(`Missing event target for device ${this.name}.`);this.eventTarget=t}destroy(){let t=this.listeners;for(let e in t)t[e].length=0}addEventListener(t,e){let i=this.listeners;t in i?i[t].push(e):i[t]=[e]}removeEventListener(t,e){let i=this.listeners;if(t in i){let s=i[t],r=s.indexOf(e);r>=0&&s.splice(r,1)}}dispatchInputEvent(t){let e=0;for(let i of this.listeners.input)e|=i(t);return Boolean(e)}},wn=class extends Ae{static isAxis(t){return!1}static isButton(t){return!0}constructor(t,e,i={}){super(t,e);let{ignoreRepeat:s=!0}=i;this.ignoreRepeat=s,this._eventObject={target:e,device:t,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),e.addEventListener("keydown",this.onKeyDown),e.addEventListener("keyup",this.onKeyUp)}setEventTarget(t){this.eventTarget&&this.destroy(),super.setEventTarget(t),t.addEventListener("keydown",this.onKeyDown),t.addEventListener("keyup",this.onKeyUp)}destroy(){let t=this.eventTarget;t.removeEventListener("keydown",this.onKeyDown),t.removeEventListener("keyup",this.onKeyUp),super.destroy()}onKeyDown(t){if(t.repeat&&this.ignoreRepeat)return t.preventDefault(),t.stopPropagation(),!1;let e=this._eventObject;if(e.code=t.code,e.event="pressed",e.value=1,e.control=t.ctrlKey,e.shift=t.shiftKey,e.alt=t.altKey,this.dispatchInputEvent(e))return t.preventDefault(),t.stopPropagation(),!1}onKeyUp(t){let e=this._eventObject;if(e.code=t.code,e.event="released",e.value=1,e.control=t.ctrlKey,e.shift=t.shiftKey,e.alt=t.altKey,this.dispatchInputEvent(e))return t.preventDefault(),t.stopPropagation(),!1}},be=10,xe=100,_n=class extends Ae{static isAxis(t){return t==="PosX"||t==="PosY"||t==="WheelX"||t==="WheelY"||t==="WheelZ"}static isButton(t){return!this.isAxis(t)}constructor(t,e,i={}){super(t,e);let{eventsOnFocus:s=!0}=i;this.eventsOnFocus=s,this.canvasTarget=this.getCanvasFromEventTarget(e),this._downHasFocus=!1,this._eventObject={target:e,device:t,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this._positionObject={target:e,device:t,code:"",event:"move",value:0,movement:0},this._wheelObject={target:e,device:t,code:"",event:"wheel",movement:0},this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onWheel=this.onWheel.bind(this),e.addEventListener("mousedown",this.onMouseDown),e.addEventListener("contextmenu",this.onContextMenu),e.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}setEventTarget(t){this.eventTarget&&this.destroy(),super.setEventTarget(t),this.canvasTarget=this.getCanvasFromEventTarget(t),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("contextmenu",this.onContextMenu),t.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}destroy(){let t=this.eventTarget;t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("contextmenu",this.onContextMenu),t.removeEventListener("wheel",this.onWheel),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),super.destroy()}setPointerLock(t=!0){t?this.eventTarget.requestPointerLock():this.eventTarget.exitPointerLock()}hasPointerLock(){return document.pointerLockElement===this.eventTarget}onMouseDown(t){this._downHasFocus=!0;let e=this._eventObject;if(e.code="Button"+t.button,e.event="pressed",e.value=1,e.control=t.ctrlKey,e.shift=t.shiftKey,e.alt=t.altKey,this.dispatchInputEvent(e)&&document.activeElement===this.eventTarget)return t.preventDefault(),t.stopPropagation(),!1}onContextMenu(t){return t.preventDefault(),t.stopPropagation(),!1}onWheel(t){let e,i,s;switch(t.deltaMode){case WheelEvent.DOM_DELTA_LINE:e=t.deltaX*be,i=t.deltaY*be,s=t.deltaZ*be;break;case WheelEvent.DOM_DELTA_PAGE:e=t.deltaX*xe,i=t.deltaY*xe,s=t.deltaZ*xe;break;case WheelEvent.DOM_DELTA_PIXEL:default:e=t.deltaX,i=t.deltaY,s=t.deltaZ;break}let r=0,o=this._wheelObject;if(o.code="WheelX",o.movement=e,r|=this.dispatchInputEvent(o),o.code="WheelY",o.movement=i,r|=this.dispatchInputEvent(o),o.code="WheelZ",o.movement=s,r|=this.dispatchInputEvent(o),r)return t.preventDefault(),t.stopPropagation(),!1}onMouseUp(t){if(!this._downHasFocus)return;this._downHasFocus=!1;let e=this._eventObject;if(e.code="Button"+t.button,e.event="released",e.value=1,e.control=t.ctrlKey,e.shift=t.shiftKey,e.alt=t.altKey,this.dispatchInputEvent(e))return t.preventDefault(),t.stopPropagation(),!1}onMouseMove(t){if(this.eventsOnFocus&&document.activeElement!==this.eventTarget)return;let e=this.canvasTarget,{clientWidth:i,clientHeight:s}=e,r=e.getBoundingClientRect(),o=t.movementX/i,l=t.movementY/s,a=(t.clientX-r.left)/i,c=(t.clientY-r.top)/s,p=this._positionObject;p.code="PosX",p.value=a,p.movement=o,this.dispatchInputEvent(p),p.code="PosY",p.value=c,p.movement=l,this.dispatchInputEvent(p)}getCanvasFromEventTarget(t){return t instanceof HTMLCanvasElement?t:t.canvas||t.querySelector("canvas")||t.shadowRoot&&t.shadowRoot.querySelector("canvas")||t}},Is=`<kbd>
  <span id="name"><slot></slot></span>
  <span id="value" class="hidden"></span>
</kbd>
`,Os=`kbd {
  position: relative;
  display: inline-block;
  border-radius: 3px;
  border: 1px solid #888888;
  font-size: 0.85em;
  font-weight: 700;
  text-rendering: optimizeLegibility;
  line-height: 12px;
  height: 14px;
  padding: 2px 4px;
  color: #444444;
  background-color: #eeeeee;
  box-shadow: inset 0 -3px 0 #aaaaaa;
  overflow: hidden;
}

kbd:empty::after {
  content: '<?>';
  opacity: 0.6;
}

.disabled {
  opacity: 0.6;
  box-shadow: none;
  background-color: #aaaaaa;
}

.hidden {
  display: none;
}

#value {
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  font-size: 0.85em;
  padding: 0 4px;
  padding-top: 2px;
  color: #cccccc;
  background-color: #333333;
  box-shadow: inset 0 3px 0 #222222;
}
`,Se=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=Is,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Os,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("input-code",this)}static get observedAttributes(){return["name","value","disabled"]}get disabled(){return this._disabled}set disabled(t){this.toggleAttribute("disabled",t)}get value(){return this._value}set value(t){this.setAttribute("value",t)}get name(){return this._name}set name(t){this.setAttribute("name",t)}constructor(){super();let t=this.constructor,e=this.attachShadow({mode:"open"});e.appendChild(t[Symbol.for("templateNode")].content.cloneNode(!0)),e.appendChild(t[Symbol.for("styleNode")].cloneNode(!0)),this._name="",this._value="",this._disabled=!1,this._kbdElement=e.querySelector("kbd"),this._nameElement=e.querySelector("#name"),this._valueElement=e.querySelector("#value")}attributeChangedCallback(t,e,i){switch(t){case"name":this._name=i,this._nameElement.textContent=i;break;case"value":this._value=i,i!==null?(this._valueElement.classList.toggle("hidden",!1),this._valueElement.textContent=i,this._kbdElement.style.paddingRight=`${this._valueElement.clientWidth+4}px`):this._valueElement.classList.toggle("hidden",!0);break;case"disabled":this._disabled=i!==null,this._kbdElement.classList.toggle("disabled",i!==null);break}}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"name")){let t=this.name;delete this.name,this.name=t}if(Object.prototype.hasOwnProperty.call(this,"value")){let t=this.value;delete this.value,this.value=t}if(Object.prototype.hasOwnProperty.call(this,"disabled")){let t=this.disabled;delete this.disabled,this.disabled=t}}};Se.define();var Ms=`<table>
  <thead>
    <tr class="tableHeader">
      <th colspan="3">
        <span class="tableTitle">
          <label id="title"> input-source </label>
          <span id="slotContainer">
            <slot></slot>
          </span>
          <p>
            <label for="poll">poll</label>
            <output id="poll"></output>
          </p>
          <p>
            <label for="focus">focus</label>
            <output id="focus"></output>
          </p>
        </span>
      </th>
    </tr>
    <tr class="colHeader">
      <th>name</th>
      <th>value</th>
      <th>key</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
`,Ps=`:host {
  display: block;
}

table {
  border-collapse: collapse;
  font-family: monospace;
}

table,
th,
td {
  border: 1px solid #666666;
}

th,
td {
  padding: 5px 10px;
}

td {
  text-align: center;
}

thead th {
  padding: 0;
}

.colHeader > th {
  font-size: 0.8em;
  padding: 0 10px;
  letter-spacing: 3px;
  background-color: #aaaaaa;
  color: #666666;
}

tbody output {
  border-radius: 0.3em;
  padding: 3px;
}

tr:not(.primary) .name,
tr:not(.primary) .value {
  opacity: 0.3;
}

tr:nth-child(2n) {
  background-color: #eeeeee;
}

.tableHeader {
  color: #666666;
}

.tableTitle {
  display: flex;
  flex-direction: row;
  align-items: center;
  padding: 4px;
}

#slotContainer {
  flex: 1;
}

p {
  display: inline;
  margin: 0;
  padding: 0;
  padding-right: 10px;
}

#poll:empty::after,
#focus:empty::after {
  content: '\u2717';
  color: #ff0000;
}
`,An=class{constructor(t){this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null,this.pollable=t}get running(){return this.animationFrameHandle!==null}start(){let t=this.animationFrameHandle;t&&cancelAnimationFrame(t),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}stop(){let t=this.animationFrameHandle;t&&cancelAnimationFrame(t),this.animationFrameHandle=null}onAnimationFrame(t){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.pollable.onPoll(t)}},bn=class{constructor(t){this.onInput=this.onInput.bind(this),this.onPoll=this.onPoll.bind(this),this.bindings=t}onPoll(t){for(let e of this.bindings.getInputs())e.onPoll(t)}onInput(t){let{device:e,code:i,event:s,value:r,movement:o,control:l,shift:a,alt:c}=t,p=this.bindings.getBindings(e,i);switch(s){case"pressed":for(let{input:m,index:_}of p)m.onUpdate(_,1,1);break;case"released":for(let{input:m,index:_}of p)m.onUpdate(_,0,-1);break;case"move":for(let{input:m,index:_}of p)m.onUpdate(_,r,o);break;case"wheel":for(let{input:m,index:_}of p)m.onUpdate(_,void 0,o);break}return p.length>0}},Re=class{constructor(t,e,i,s){this.device=t,this.code=e,this.input=i,this.index=s}},xn=class{constructor(){this.bindingMap={},this.inputMap=new Map}clear(){for(let t of this.inputMap.keys())t.onUnbind();this.inputMap.clear(),this.bindingMap={}}bind(t,e,i,s={inverted:!1}){let r,o=this.inputMap;if(o.has(t)){let a=o.get(t),c=t.size;t.onBind(c,s),r=new Re(e,i,t,c),a.push(r)}else{let a=[];o.set(t,a);let c=0;t.onBind(c,s),r=new Re(e,i,t,c),a.push(r)}let l=this.bindingMap;e in l?i in l[e]?l[e][i].push(r):l[e][i]=[r]:l[e]={[i]:[r]}}unbind(t){let e=this.inputMap;if(e.has(t)){let i=this.bindingMap,s=e.get(t);for(let r of s){let{device:o,code:l}=r,a=i[o][l],c=a.indexOf(r);a.splice(c,1)}s.length=0,t.onUnbind(),e.delete(t)}}isBound(t){return this.inputMap.has(t)}getInputs(){return this.inputMap.keys()}getBindingsByInput(t){return this.inputMap.get(t)}getBindings(t,e){let i=this.bindingMap;if(t in i){let s=i[t];if(e in s)return s[e]}return[]}},Sn=class{constructor(t,e=void 0){this.inputs={},this.devices=[new _n("Mouse",t),new wn("Keyboard",t)],this.bindings=new xn,this.adapter=new bn(this.bindings),this.autopoller=new An(this.adapter),this.eventTarget=t,this.anyButton=new Xt(1),this.anyButtonDevice="",this.anyButtonCode="",this.anyAxis=new kt(1),this.anyAxisDevice="",this.anyAxisCode="",this.listeners={bind:[],unbind:[],focus:[],blur:[]},this.onInput=this.onInput.bind(this),this.onEventTargetBlur=this.onEventTargetBlur.bind(this),this.onEventTargetFocus=this.onEventTargetFocus.bind(this),t.addEventListener("focus",this.onEventTargetFocus),t.addEventListener("blur",this.onEventTargetBlur);for(let i of this.devices)i.addEventListener("input",this.onInput)}get autopoll(){return this.autopoller.running}set autopoll(t){this.toggleAutoPoll(t)}destroy(){let t=this.listeners;for(let i in t)t[i].length=0;this.autopoller.running&&this.autopoller.stop();for(let i of this.devices)i.removeEventListener("input",this.onInput),i.destroy();let e=this.eventTarget;e.removeEventListener("focus",this.onEventTargetFocus),e.removeEventListener("blur",this.onEventTargetBlur)}setEventTarget(t){let e=this.eventTarget;e.removeEventListener("focus",this.onEventTargetFocus),e.removeEventListener("blur",this.onEventTargetBlur),this.eventTarget=t;for(let i of this.devices)i.setEventTarget(t);t.addEventListener("focus",this.onEventTargetFocus),t.addEventListener("blur",this.onEventTargetBlur)}toggleAutoPoll(t=void 0){let e=this.autopoller.running,i=typeof t=="undefined"?!e:Boolean(t);i!==e&&(i?this.autopoller.start():this.autopoller.stop())}addEventListener(t,e){let i=this.listeners;t in i?i[t].push(e):i[t]=[e]}removeEventListener(t,e){let i=this.listeners;if(t in i){let s=i[t],r=s.indexOf(e);r>=0&&s.splice(r,1)}}dispatchEvent(t){let{type:e}=t,i=0;for(let s of this.listeners[e])i|=s(t)?1:0;return Boolean(i)}poll(t=performance.now()){if(this.autopoller.running)throw new Error("Should not manually poll() while autopolling.");this.onPoll(t)}onInput(t){let e=this.adapter.onInput(t);switch(t.event){case"pressed":this.anyButtonDevice=t.device,this.anyButtonCode=t.code,this.anyButton.onUpdate(0,1,1);break;case"released":this.anyButtonDevice=t.device,this.anyButtonCode=t.code,this.anyButton.onUpdate(0,0,-1);break;case"move":case"wheel":this.anyAxisDevice=t.device,this.anyAxisCode=t.code,this.anyAxis.onUpdate(0,t.value,t.movement);break}return e}onPoll(t){this.adapter.onPoll(t),this.anyButton.onPoll(t),this.anyAxis.onPoll(t)}onBind(){this.dispatchEvent({type:"bind"})}onUnbind(){this.dispatchEvent({type:"unbind"})}onEventTargetFocus(){this.dispatchEvent({type:"focus"})}onEventTargetBlur(){for(let t of this.bindings.getInputs())t.onStatus(0,0);this.anyButton.onStatus(0,0),this.anyAxis.onStatus(0,0),this.dispatchEvent({type:"blur"})}bindBindings(t){Array.isArray(t)||(t=Object.values(t));for(let e of t)e.bindTo(this)}bindBinding(t){t.bindTo(this)}bindButton(t,e,i,s=void 0){let r;this.hasButton(t)?r=this.getButton(t):(r=new Xt(1),this.inputs[t]=r),this.bindings.bind(r,e,i,s),this.onBind()}bindAxis(t,e,i,s=void 0){let r;this.hasAxis(t)?r=this.getAxis(t):(r=new kt(1),this.inputs[t]=r),this.bindings.bind(r,e,i,s),this.onBind()}bindAxisButtons(t,e,i,s){let r;this.hasAxis(t)?r=this.getAxis(t):(r=new kt(2),this.inputs[t]=r),this.bindings.bind(r,e,s),this.bindings.bind(r,e,i,{inverted:!0}),this.onBind()}unbindButton(t){if(this.hasButton(t)){let e=this.getButton(t);delete this.inputs[t],this.bindings.unbind(e),this.onUnbind()}}unbindAxis(t){if(this.hasAxis(t)){let e=this.getAxis(t);delete this.inputs[t],this.bindings.unbind(e),this.onUnbind()}}getInput(t){return this.inputs[t]}getButton(t){return this.inputs[t]}getAxis(t){return this.inputs[t]}hasButton(t){return t in this.inputs&&this.inputs[t]instanceof Xt}hasAxis(t){return t in this.inputs&&this.inputs[t]instanceof kt}isButtonDown(t){return this.inputs[t].down}isButtonPressed(t){return this.inputs[t].pressed}isButtonReleased(t){return this.inputs[t].released}getInputValue(t){return this.inputs[t].value}getButtonValue(t){return this.inputs[t].value}getAxisValue(t){return this.inputs[t].value}getAxisDelta(t){return this.inputs[t].delta}isAnyButtonDown(t=void 0){if(typeof t=="undefined")return this.anyButton.down;{let e=this.inputs;for(let i of t)if(e[i].down)return!0}return!1}isAnyButtonPressed(t=void 0){if(typeof t=="undefined")return this.anyButton.pressed;{let e=this.inputs;for(let i of t)if(e[i].pressed)return!0}return!1}isAnyButtonReleased(t=void 0){if(typeof t=="undefined")return this.anyButton.released;{let e=this.inputs;for(let i of t)if(e[i].released)return!0}return!1}getAnyAxisValue(t=void 0){if(typeof t=="undefined")return this.anyAxis.value;{let e=this.inputs;for(let i of t){let s=e[i];if(s.value)return s.value}}return 0}getAnyAxisDelta(t=void 0){if(typeof t=="undefined")return this.anyAxis.delta;{let e=this.inputs;for(let i of t){let s=e[i];if(s.delta)return s.delta}}return 0}getLastButtonDevice(){return this.anyButtonDevice}getLastButtonCode(){return this.anyButtonCode}getLastAxisDevice(){return this.anyAxisDevice}getLastAxisCode(){return this.anyAxisCode}getMouse(){return this.devices[0]}getKeyboard(){return this.devices[1]}},Rn=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=Ms,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Ps,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("input-port",this)}static get observedAttributes(){return["autopoll","for"]}get autopoll(){return this._autopoll}set autopoll(t){this.toggleAttribute("autopoll",t)}get for(){return this._for}set for(t){this.setAttribute("for",t)}constructor(){super();let t=this.attachShadow({mode:"open"});t.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),t.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._titleElement=t.querySelector("#title"),this._pollElement=t.querySelector("#poll"),this._focusElement=t.querySelector("#focus"),this._bodyElement=t.querySelector("tbody"),this._outputElements={},this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null;let e=this;this._for="",this._eventTarget=e,this._autopoll=!1,this._context=null,this.onInputContextBind=this.onInputContextBind.bind(this),this.onInputContextUnbind=this.onInputContextUnbind.bind(this),this.onInputContextFocus=this.onInputContextFocus.bind(this),this.onInputContextBlur=this.onInputContextBlur.bind(this)}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"for")){let t=this.for;delete this.for,this.for=t}if(Object.prototype.hasOwnProperty.call(this,"autopoll")){let t=this.autopoll;delete this.autopoll,this.autopoll=t}this.updateTable(),this.updateTableValues(),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}disconnectedCallback(){let t=this._context;t&&(t.removeEventListener("bind",this.onInputContextBind),t.removeEventListener("unbind",this.onInputContextUnbind),t.removeEventListener("blur",this.onInputContextBlur),t.removeEventListener("focus",this.onInputContextFocus),t.destroy(),this._context=null)}attributeChangedCallback(t,e,i){switch(t){case"for":{this._for=i;let s,r;i?(s=document.getElementById(i),r=`${s.tagName.toLowerCase()}#${i}`):(s=this,r="input-port"),this._eventTarget=s,this._context&&this._context.setEventTarget(this._eventTarget),this._titleElement.innerHTML=`for ${r}`}break;case"autopoll":this._autopoll=i!==null,this._context&&this._context.toggleAutoPoll(this._autopoll);break}}onAnimationFrame(){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.updateTableValues(),this.updatePollStatus()}onInputContextBind(){return this.updateTable(),!0}onInputContextUnbind(){return this.updateTable(),!0}onInputContextFocus(){return this._focusElement.innerHTML="\u2713",!0}onInputContextBlur(){return this._focusElement.innerHTML="",!0}getContext(t="axisbutton",e=void 0){switch(t){case"axisbutton":if(!this._context){let i=new Sn(this._eventTarget,e);i.addEventListener("bind",this.onInputContextBind),i.addEventListener("unbind",this.onInputContextUnbind),i.addEventListener("blur",this.onInputContextBlur),i.addEventListener("focus",this.onInputContextFocus),this._autopoll&&i.toggleAutoPoll(!0),this._context=i}return this._context;default:throw new Error(`Input context id '${t}' is not supported.`)}}updateTable(){if(this.isConnected)if(this._context){let t=this._context,e=t.inputs,i=t.bindings,s={},r=[];for(let o of Object.keys(e)){let l=e[o],a=!0;for(let c of i.getBindingsByInput(l)){let p=Bs(`${l.constructor.name}.${o}`,`${c.device}.${c.code}`,0,a);r.push(p),a&&(s[o]=p.querySelector("output"),a=!1)}}this._outputElements=s,this._bodyElement.innerHTML="";for(let o of r)this._bodyElement.appendChild(o)}else{this._outputElements={},this._bodyElement.innerHTML="";return}else return}updateTableValues(){if(this.isConnected)if(this._context){let e=this._context.inputs;for(let i of Object.keys(this._outputElements)){let s=this._outputElements[i],r=e[i].value;s.innerText=Number(r).toFixed(2)}}else{for(let t of Object.keys(this._outputElements)){let e=this._outputElements[t];e.innerText="---"}return}else return}updatePollStatus(){if(this.isConnected)if(this._context){let e=this._context.inputs;for(let i of Object.values(e))if(!i.polling){this._pollElement.innerHTML="";return}this._pollElement.innerHTML="\u2713"}else{this._pollElement.innerHTML="-";return}else return}};Rn.define();function Bs(n,t,e,i=!0){let s=document.createElement("tr");i&&s.classList.add("primary");{let r=document.createElement("td");r.textContent=n,r.classList.add("name"),s.appendChild(r)}{let r=document.createElement("td"),o=document.createElement("output");i?o.innerText=Number(e).toFixed(2):o.innerText="---",o.classList.add("value"),r.appendChild(o),s.appendChild(r)}{let r=document.createElement("td");r.classList.add("key");let o=new Se;o.innerText=t,r.appendChild(o),s.appendChild(r)}return s}var Fa=Symbol("keyboardSource");var za=Symbol("mouseSource");var Mr=_s(ni());var ii={},mr=function(n,t,e,i,s){var r=new Worker(ii[t]||(ii[t]=URL.createObjectURL(new Blob([n+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return r.onmessage=function(o){var l=o.data,a=l.$e$;if(a){var c=new Error(a[0]);c.code=a[1],c.stack=a[2],s(c,null)}else s(null,l)},r.postMessage(e,i),r},Q=Uint8Array,Et=Uint16Array,$e=Uint32Array,Fe=new Q([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ze=new Q([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),si=new Q([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ri=function(n,t){for(var e=new Et(31),i=0;i<31;++i)e[i]=t+=1<<n[i-1];for(var s=new $e(e[30]),i=1;i<30;++i)for(var r=e[i];r<e[i+1];++r)s[r]=r-e[i]<<5|i;return[e,s]},oi=ri(Fe,2),Ye=oi[0],yr=oi[1];Ye[28]=258,yr[258]=28;var ai=ri(ze,0),li=ai[0],Va=ai[1],ie=new Et(32768);for(var D=0;D<32768;++D)dt=(D&43690)>>>1|(D&21845)<<1,dt=(dt&52428)>>>2|(dt&13107)<<2,dt=(dt&61680)>>>4|(dt&3855)<<4,ie[D]=((dt&65280)>>>8|(dt&255)<<8)>>>1;var dt,Ot=function(n,t,e){for(var i=n.length,s=0,r=new Et(t);s<i;++s)n[s]&&++r[n[s]-1];var o=new Et(t);for(s=0;s<t;++s)o[s]=o[s-1]+r[s-1]<<1;var l;if(e){l=new Et(1<<t);var a=15-t;for(s=0;s<i;++s)if(n[s])for(var c=s<<4|n[s],p=t-n[s],m=o[n[s]-1]++<<p,_=m|(1<<p)-1;m<=_;++m)l[ie[m]>>>a]=c}else for(l=new Et(i),s=0;s<i;++s)n[s]&&(l[s]=ie[o[n[s]-1]++]>>>15-n[s]);return l},Nt=new Q(288);for(var D=0;D<144;++D)Nt[D]=8;for(var D=144;D<256;++D)Nt[D]=9;for(var D=256;D<280;++D)Nt[D]=7;for(var D=280;D<288;++D)Nt[D]=8;var ui=new Q(32);for(var D=0;D<32;++D)ui[D]=5;var hi=Ot(Nt,9,1);var ci=Ot(ui,5,1),se=function(n){for(var t=n[0],e=1;e<n.length;++e)n[e]>t&&(t=n[e]);return t},st=function(n,t,e){var i=t/8|0;return(n[i]|n[i+1]<<8)>>(t&7)&e},re=function(n,t){var e=t/8|0;return(n[e]|n[e+1]<<8|n[e+2]<<16)>>(t&7)},fi=function(n){return(n+7)/8|0},oe=function(n,t,e){(t==null||t<0)&&(t=0),(e==null||e>n.length)&&(e=n.length);var i=new(n.BYTES_PER_ELEMENT==2?Et:n.BYTES_PER_ELEMENT==4?$e:Q)(e-t);return i.set(n.subarray(t,e)),i};var pi=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],tt=function(n,t,e){var i=new Error(t||pi[n]);if(i.code=n,Error.captureStackTrace&&Error.captureStackTrace(i,tt),!e)throw i;return i},di=function(n,t,e){var i=n.length;if(!i||e&&e.f&&!e.l)return t||new Q(0);var s=!t||e,r=!e||e.i;e||(e={}),t||(t=new Q(i*3));var o=function(b){var At=t.length;if(b>At){var Gt=new Q(Math.max(At*2,b));Gt.set(t),t=Gt}},l=e.f||0,a=e.p||0,c=e.b||0,p=e.l,m=e.d,_=e.m,M=e.n,T=i*8;do{if(!p){l=st(n,a,1);var L=st(n,a+1,3);if(a+=3,L)if(L==1)p=hi,m=ci,_=9,M=5;else if(L==2){var C=st(n,a,31)+257,j=st(n,a+10,15)+4,N=C+st(n,a+5,31)+1;a+=14;for(var q=new Q(N),$=new Q(19),y=0;y<j;++y)$[si[y]]=st(n,a+y*3,7);a+=j*3;for(var A=se($),K=(1<<A)-1,f=Ot($,A,1),y=0;y<N;){var I=f[st(n,a,K)];a+=I&15;var P=I>>>4;if(P<16)q[y++]=P;else{var R=0,et=0;for(P==16?(et=3+st(n,a,3),a+=2,R=q[y-1]):P==17?(et=3+st(n,a,7),a+=3):P==18&&(et=11+st(n,a,127),a+=7);et--;)q[y++]=R}}var h=q.subarray(0,C),u=q.subarray(C);_=se(h),M=se(u),p=Ot(h,_,1),m=Ot(u,M,1)}else tt(1);else{var P=fi(a)+4,H=n[P-4]|n[P-3]<<8,z=P+H;if(z>i){r&&tt(0);break}s&&o(c+H),t.set(n.subarray(P,z),c),e.b=c+=H,e.p=a=z*8,e.f=l;continue}if(a>T){r&&tt(0);break}}s&&o(c+131072);for(var G=(1<<_)-1,S=(1<<M)-1,V=a;;V=a){var R=p[re(n,a)&G],W=R>>>4;if(a+=R&15,a>T){r&&tt(0);break}if(R||tt(2),W<256)t[c++]=W;else if(W==256){V=a,p=null;break}else{var X=W-254;if(W>264){var y=W-257,at=Fe[y];X=st(n,a,(1<<at)-1)+Ye[y],a+=at}var Dt=m[re(n,a)&S],yt=Dt>>>4;Dt||tt(3),a+=Dt&15;var u=li[yt];if(yt>3){var at=ze[yt];u+=re(n,a)&(1<<at)-1,a+=at}if(a>T){r&&tt(0);break}s&&o(c+131072);for(var lt=c+X;c<lt;c+=4)t[c]=t[c-u],t[c+1]=t[c+1-u],t[c+2]=t[c+2-u],t[c+3]=t[c+3-u];c=lt}}e.l=p,e.p=V,e.b=c,e.f=l,p&&(l=1,e.m=_,e.d=m,e.n=M)}while(!l);return c==t.length?t:oe(t,0,c)};var Er=new Q(0);var wr=function(n,t){var e={};for(var i in n)e[i]=n[i];for(var i in t)e[i]=t[i];return e},vi=function(n,t,e){for(var i=n(),s=n.toString(),r=s.slice(s.indexOf("[")+1,s.lastIndexOf("]")).replace(/\s+/g,"").split(","),o=0;o<i.length;++o){var l=i[o],a=r[o];if(typeof l=="function"){t+=";"+a+"=";var c=l.toString();if(l.prototype)if(c.indexOf("[native code]")!=-1){var p=c.indexOf(" ",8)+1;t+=c.slice(p,c.indexOf("(",p))}else{t+=c;for(var m in l.prototype)t+=";"+a+".prototype."+m+"="+l.prototype[m].toString()}else t+=c}else e[a]=l}return[t,e]},ae=[],_r=function(n){var t=[];for(var e in n)n[e].buffer&&t.push((n[e]=new n[e].constructor(n[e])).buffer);return t},Ar=function(n,t,e,i){var s;if(!ae[e]){for(var r="",o={},l=n.length-1,a=0;a<l;++a)s=vi(n[a],r,o),r=s[0],o=s[1];ae[e]=vi(n[l],r,o)}var c=wr({},ae[e][1]);return mr(ae[e][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",e,c,_r(c),i)},br=function(){return[Q,Et,$e,Fe,ze,si,Ye,li,hi,ci,ie,pi,Ot,se,st,re,fi,oe,tt,di,Ge,gi,mi]};var gi=function(n){return postMessage(n,[n.buffer])},mi=function(n){return n&&n.size&&new Q(n.size)},xr=function(n,t,e,i,s,r){var o=Ar(e,i,s,function(l,a){o.terminate(),r(l,a)});return o.postMessage([n,t],t.consume?[n.buffer]:[]),function(){o.terminate()}};var ct=function(n,t){return n[t]|n[t+1]<<8},ot=function(n,t){return(n[t]|n[t+1]<<8|n[t+2]<<16|n[t+3]<<24)>>>0},je=function(n,t){return ot(n,t)+ot(n,t+4)*4294967296};function Sr(n,t,e){return e||(e=t,t={}),typeof e!="function"&&tt(7),xr(n,t,[br],function(i){return gi(Ge(i.data[0],mi(i.data[1])))},1,e)}function Ge(n,t){return di(n,t)}var Ja=typeof TextEncoder!="undefined"&&new TextEncoder,We=typeof TextDecoder!="undefined"&&new TextDecoder,Rr=0;try{We.decode(Er,{stream:!0}),Rr=1}catch(n){}var Tr=function(n){for(var t="",e=0;;){var i=n[e++],s=(i>127)+(i>223)+(i>239);if(e+s>n.length)return[t,oe(n,e-1)];s?s==3?(i=((i&15)<<18|(n[e++]&63)<<12|(n[e++]&63)<<6|n[e++]&63)-65536,t+=String.fromCharCode(55296|i>>10,56320|i&1023)):s&1?t+=String.fromCharCode((i&31)<<6|n[e++]&63):t+=String.fromCharCode((i&15)<<12|(n[e++]&63)<<6|n[e++]&63):t+=String.fromCharCode(i)}};function Cr(n,t){if(t){for(var e="",i=0;i<n.length;i+=16384)e+=String.fromCharCode.apply(null,n.subarray(i,i+16384));return e}else{if(We)return We.decode(n);var s=Tr(n),r=s[0],o=s[1];return o.length&&tt(8),r}}var Lr=function(n,t){return t+30+ct(n,t+26)+ct(n,t+28)},Ir=function(n,t,e){var i=ct(n,t+28),s=Cr(n.subarray(t+46,t+46+i),!(ct(n,t+8)&2048)),r=t+46+i,o=ot(n,t+20),l=e&&o==4294967295?Or(n,r):[o,ot(n,t+24),ot(n,t+42)],a=l[0],c=l[1],p=l[2];return[ct(n,t+10),a,c,s,r+ct(n,t+30)+ct(n,t+32),p]},Or=function(n,t){for(;ct(n,t)!=1;t+=4+ct(n,t+2));return[je(n,t+12),je(n,t+4),je(n,t+20)]};var yi=typeof queueMicrotask=="function"?queueMicrotask:typeof setTimeout=="function"?setTimeout:function(n){n()};function qe(n,t,e){e||(e=t,t={}),typeof e!="function"&&tt(7);var i=[],s=function(){for(var P=0;P<i.length;++P)i[P]()},r={},o=function(P,H){yi(function(){e(P,H)})};yi(function(){o=e});for(var l=n.length-22;ot(n,l)!=101010256;--l)if(!l||n.length-l>65558)return o(tt(13,0,1),null),s;var a=ct(n,l+8);if(a){var c=a,p=ot(n,l+16),m=p==4294967295||c==65535;if(m){var _=ot(n,l-12);m=ot(n,_)==101075792,m&&(c=a=ot(n,_+32),p=ot(n,_+48))}for(var M=t&&t.filter,T=function(P){var H=Ir(n,p,m),z=H[0],C=H[1],j=H[2],N=H[3],q=H[4],$=H[5],y=Lr(n,$);p=q;var A=function(f,I){f?(s(),o(f,null)):(I&&(r[N]=I),--a||o(null,r))};if(!M||M({name:N,size:C,originalSize:j,compression:z}))if(!z)A(null,oe(n,y,y+C));else if(z==8){var K=n.subarray(y,y+C);if(C<32e4)try{A(null,Ge(K,new Q(j)))}catch(f){A(f,null)}else i.push(Sr(K,{size:j},A))}else A(tt(14,"unknown compression type "+z,1),null);else A(null,null)},L=0;L<c;++L)T(L)}else o(null,{});return s}var Pr=/^([_\w\d]+)\:\/\//,Ei=5e3;async function Br(n,t,e,i,s=Ei){let{cache:r,loadings:o}=n;if(t in r)return r[t];let l;if(t in o){if(l=o[t],l.active)return o[t].promise}else l=new Ze(s),o[t]=l;let a=[l.promise];return Pr.test(e)?a.push(wi(n,e,s).then(c=>i(c)).then(c=>Mt(n,t,c))):a.push(fetch(e).then(c=>c.arrayBuffer()).then(c=>i(c)).then(c=>Mt(n,t,c))),await Promise.race(a)}function Mt(n,t,e){let{cache:i,loadings:s}=n;return i[t]=e,t in s&&(s[t].resolve(e),delete s[t]),e}function Dr(n,t){let{cache:e,loadings:i}=n;t in i&&(i[t].reject(new Error("Stop loading to delete asset.")),delete i[t]),t in e&&delete e[t]}async function wi(n,t,e=Ei){let{cache:i,loadings:s}=n;if(t in i)return i[t];if(t in s)return s[t].promise;{let r=new Ze(e);return s[t]=r,r.promise}}function kr(n,t){let{defaults:e}=n;for(let i of e)if(i.glob.test(t))return Xe(n,i.uri);return null}function Xe(n,t){return n.cache[t]}function Hr(n){return Object.keys(n.cache)}var Ze=class{constructor(t){this.active=!1,this._resolve=null,this._reject=null,this._reason=null,this._value=null,this._timeoutHandle=Number.isFinite(t)&&t>0?setTimeout(()=>{this.reject(`Asset loading exceeded timeout of ${t} ms.`)},t):null,this._promise=new Promise((e,i)=>{this._value?e(this._value):this._resolve=e,this._reason?i(this._reason):this._reject=i})}get promise(){return this._promise}resolve(t){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._resolve?this._resolve(t):this._value=t}reject(t){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._reject?this._reject(t):this._reason=t}},wt=class{constructor(t,e,i){this.uri=t,this.source=e,this.loader=i,this.store=null}get current(){return Xe(this.store,this.uri)}set current(t){Mt(this.store,this.uri,t)}get default(){return kr(this.store,this.uri)}get loaded(){return wi(this.store,this.uri)}async preload(t,e=void 0,i=void 0){return this.store=t,typeof i!="undefined"?Mt(t,this.uri,i):await Br(this.store,this.uri,this.source,this.loader,e),this}async unload(){return Dr(this.store,this.uri),this.store=null,this}},Ur=5e3,Kt={cache:{},loadings:{},defaults:[]};async function Nr(n,t=void 0){let e="raw://",s=await(await fetch(n)).arrayBuffer();await new Promise((r,o)=>{qe(new Uint8Array(s),(l,a)=>{if(l)o(l);else{for(let[c,p]of Object.entries(a)){c=c.replaceAll("\\","/");let m=c.indexOf("/");m>=0&&(c=c.substring(m+1));let _=e+c;Mt(Kt,_,p),t&&t(p,_,c)}r()}})})}async function Kr(n,t){let i=await(await fetch(n)).arrayBuffer();await new Promise((s,r)=>{qe(new Uint8Array(i),(o,l)=>{if(o)r(o);else{for(let[a,c]of Object.entries(l))a=a.replaceAll("\\","/"),t(c,a);s()}})})}async function $r(n,t=Ur){let e=[];for(let i of n)e.push(i.preload(Kt,t));await Promise.allSettled(e)}function Fr(n,t){return Mt(Kt,n,t)}function zr(){return Hr(Kt)}function _i(n){return Xe(Kt,n)}function Yr(n){return _i(n)}var Qe=Object.freeze({__proto__:null,cache:Fr,current:_i,get:Yr,keys:zr,loadAssetPack:Kr,loadAssetPackAsRaw:Nr,loadAssetRefs:$r});window.addEventListener("error",Ai,!0);window.addEventListener("unhandledrejection",Ai,!0);function Ai(n){n instanceof PromiseRejectionEvent?window.alert(n.reason.stack):n instanceof ErrorEvent?window.alert(n.error.stack):window.alert(JSON.stringify(n))}function Rt(n,t){let e=n.components;if(t in e)return e[t];{let i={};return e[t]=i,i}}function jr(n,t){let e=n.components,i={};return e[t]=i,i}function bi(n,t,e,i){let s=e.name,r=Rt(n,s);return r[t]=i,i}function xi(n,t,e){let i=e.name,s=Rt(n,i),r=s[t];delete s[t],e.delete(r)}function Si(n,t){let e=t.name,i=Rt(n,e),s=Object.values(i);jr(n,e);for(let r of s)t.delete(r)}var Ri=Symbol("nextAvailableEntityId");function Gr(n){return++n[Ri]}var Ve=class{constructor(){this.components={},this[Ri]=1,this.queue=[]}flush(){for(;this.queue.length>0;){let[t,...e]=this.queue.shift();switch(t){case"attach":{let[i,s,r]=e;bi(this,i,s,r)}break;case"detach":{let[i,s]=e;xi(this,i,s)}break;case"clear":{let[i]=e;Si(this,i)}break}}}create(...t){let e=Gr(this),i=[e];for(let s of t){let r=this.attach(e,s);i.push(r)}return i}destroy(t){for(let e of Object.values(this.components))t in e&&delete e[t]}exists(t){for(let e of Object.values(this.components))if(t in e)return!0;return!1}attach(t,e){let i=e.new();return this.queue.push(["attach",t,e,i]),i}attachImmediately(t,e){let i=e.new();return bi(this,t,e,i)}detach(t,e){this.queue.push(["detach",t,e])}detachImmediately(t,e){xi(this,t,e)}clear(t){this.queue.push(["clear",t])}clearImmediately(t){Si(this,t)}get(t,e){let i=e.name,s=Rt(this,i);return s?null:s[t]||null}count(t){let e=t.name,i=Rt(this,e);return i?0:Object.keys(i).length}};var vt=class{constructor(...t){this.selectors=t}count(t){let e=0,i=this.findAll(t);for(;!i.next().done;)++e;return e}find(t){let i=this.findAll(t).next();return i.done?[]:i.value}*findAll(t){if(this.selectors.length<=0)return;let i=this.selectors[0].name,s=Rt(t,i),r=new Array(this.selectors.length+1);for(let o of Object.keys(s)){let l=Number(o),a=!0;r[0]=l;let c=1;for(let p of this.selectors){let m=p.name,_=Rt(t,m);if(!(l in _)){a=!1;break}let M=_[l];r[c++]=M}a&&(yield r)}}},gt=class{constructor(t,e=()=>null,i=()=>{}){this.name=t,this.new=e,this.delete=i}};var Je=class{constructor(){this.listeners={}}on(t,e){return this.addEventListener(t,e),this}off(t,e){return this.removeEventListener(t,e),this}once(t,e){let i=(...s)=>(this.removeEventListener(t,i),e(...s));return this.addEventListener(t,i),this}emit(t,...e){return this.dispatchEvent(t,e),this}addEventListener(t,e){t in this.listeners?this.listeners[t].push(e):this.listeners[t]=[e]}removeEventListener(t,e){if(!(t in this.listeners))return;let i=this.listeners[t],s=i.indexOf(e);s>=0&&i.splice(s,1)}countEventListeners(t){return t in this.listeners?this.listeners[t].length:0}getEventListeners(t){return t in this.listeners?this.listeners[t]:[]}dispatchEvent(t,...e){if(t in this.listeners)for(let i of this.listeners[t]){let s=i(...e);if(typeof s!="undefined"&&s===!0)break}}};var tn=Symbol("audioContext"),le=class{static getAudioContext(){if(tn in this)return this[tn];{let t=new AudioContext;return Wr(t),this[tn]=t,t}}constructor(t,e){this.audioContext=t,this.audioBuffer=e,this._playing=!1,this._started=!1,this._source=null,this.onAudioSourceEnded=this.onAudioSourceEnded.bind(this)}destroy(){this._source&&this._source.disconnect(),this._source=null,this._started=!1,this._playing=!1}onAudioSourceEnded(){this._playing=!1}play(t={}){let e=this.audioBuffer;if(!e)return;this._source&&this.destroy();let{pitch:i=void 0,gain:s=void 0,pan:r=void 0,loop:o=!1}=t,l=this.audioContext,a=l.createBufferSource();a.addEventListener("ended",this.onAudioSourceEnded),a.buffer=e,a.loop=o;let c=a;if(i&&(a.detune.value=i*100),s){let p=l.createGain();p.gain.value=s,c=c.connect(p)}if(r){let p=l.createStereoPanner();p.pan.value=r,c=c.connect(p)}c.connect(l.destination),a.start(),this._source=a,this._started=!0,this._playing=!0}pause(){this._source.stop(),this._playing=!1}isStarted(){return this._started}isPlaying(){return this._playing}isPaused(){return this._started&&!this._playing}};function Wr(n){let t=()=>{n.state==="suspended"&&n.resume()};document.addEventListener("click",t)}async function en(n,t){if(typeof n=="string"){let o=await(await fetch(n)).arrayBuffer();return en(o,t)}else if(!(n instanceof ArrayBuffer||ArrayBuffer.isView(n)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let e=n,i=new ArrayBuffer(e.byteLength);return new Uint8Array(i).set(e),await t.decodeAudioData(i)}async function Tt(n){let t=le.getAudioContext(),e=await en(n,t);return new le(t,e)}var rt={SoundStart:new wt("start","raw://start.wav",Tt),SoundDead:new wt("dead","raw://dead.wav",Tt),SoundPop:new wt("pop","raw://boop.wav",Tt),SoundShoot:new wt("shoot","raw://click.wav",Tt),SoundBoom:new wt("boom","raw://boom.wav",Tt),BackgroundMusic:new wt("music","raw://music.wav",Tt)};async function Ti(){await Qe.loadAssetPackAsRaw("res.pack"),Qe.loadAssetRefs(Object.values(rt))}var nn=class{next(){return 0}},Ci=class extends nn{next(){return Math.random()}},Li=class extends nn{constructor(t){super();this.seed=t,this.a=t}next(){var t=this.a+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}},w=class{static get RAND(){let t=new this;return this.next=this.next.bind(this),this.choose=this.choose.bind(this),this.range=this.range.bind(this),this.rangeInt=this.rangeInt.bind(this),this.sign=this.sign.bind(this),Object.defineProperty(this,"RAND",{value:t}),t}constructor(t=void 0){typeof t=="number"?this.generator=new Li(t):t?this.generator=t:this.generator=new Ci,this.next=this.next.bind(this),this.choose=this.choose.bind(this),this.range=this.range.bind(this),this.rangeInt=this.rangeInt.bind(this),this.sign=this.sign.bind(this)}static next(){return this.RAND.next()}next(){return this.generator.next()}static choose(t){return this.RAND.choose(t)}choose(t){return t[Math.floor(this.generator.next()*t.length)]}static range(t,e){return this.RAND.range(t,e)}range(t,e){return(e-t)*this.generator.next()+t}static rangeInt(t,e){return this.RAND.rangeInt(t,e)}rangeInt(t,e){return Math.trunc(this.range(t,e))}static sign(){return this.RAND.sign()}sign(){return this.generator.next()<.5?-1:1}};var qr=[2,4],Xr=[.3,1],Zr=30;function Ii(n,t){let e={x:[],y:[],size:[],speed:[],length:0,width:n,height:t};for(let i=0;i<Zr;++i)e.x.push(w.range(0,n)),e.y.push(w.range(0,t)),e.size.push(w.range(...qr)),e.speed.push(w.range(...Xr)),e.length++;return e}function Oi(n,t,e="white"){for(let i=0;i<t.length;++i){let s=t.x[i],r=t.y[i],o=t.size[i],l=o/2;n.fillStyle=e,n.fillRect(s-l,r-l,o,o)}}function Mi(n,t=1,e=0){let{length:i,width:s,height:r}=n;for(let o=0;o<i;++o){let l=t*n.speed[o],a=e*n.speed[o];n.x[o]+=l,n.y[o]+=a,l<0?n.x[o]<0&&(n.x[o]=s,n.y[o]=w.range(0,r)):l>0&&n.x[o]>s&&(n.x[o]=0,n.y[o]=w.range(0,r)),a<0?n.y[o]<0&&(n.x[o]=w.range(0,s),n.y[o]=r):a>0&&n.y[o]>r&&(n.x[o]=w.range(0,s),n.y[o]=0)}}var ue={showCollision:!1},$t=.1;function ft(n,t,e,i){let s=n.display.canvas;t.x<-e&&(t.x=s.width),t.y<-i&&(t.y=s.height),t.x>s.width+e/2&&(t.x=-e),t.y>s.height+i/2&&(t.y=-i)}function Pt(n,t,e){let i=n.x-t.x,s=n.y-t.y;return i*i+s*s<=e*e}function _t(n,t,e,i){!ue.showCollision||(n.translate(t,e),n.beginPath(),n.arc(0,0,i,0,Math.PI*2),n.strokeStyle="lime",n.stroke(),n.setTransform(1,0,0,1,0,0))}var sn=4,rn=2,Ft=600,on=new gt("Particle",()=>({x:0,y:0,dx:0,dy:0,rotation:0,age:0,color:"white"})),Pi=new vt(on);function Bi(n){n.ents.clear(on)}function he(n,t,e,i,s,r,o=0){typeof r=="function"&&(r=r());let[l,a]=n.ents.create(on);return a.x=t,a.y=e,a.dx=i,a.dy=s,a.rotation=Math.atan2(s,i),a.age=o,a.color=r,l}function Qr(n,t){n.ents.destroy(t)}function an(n,t){for(let[e,i]of Pi.findAll(t.ents))i.age+=n,i.age>Ft?Qr(t,e):(i.x+=i.dx,i.y+=i.dy,ft(t,i,sn*2,sn*2))}function Di(n,t){for(let[e,i]of Pi.findAll(t.ents)){n.translate(i.x,i.y),n.rotate(i.rotation),n.fillStyle=i.color;let s=sn*(1-i.age/Ft);n.fillRect(-s,-s,s*2,s*2),n.setTransform(1,0,0,1,0,0)}}function Bt(n,t,e,i=10,s){for(let r=0;r<i;++r)he(n,t,e,w.range(-1,1)*rn,w.range(-1,1)*rn,s)}var zt=4,ki=100,Ct=2,Vr="gold",Jr=2e3,ce=new gt("Bullet",()=>({x:0,y:0,dx:0,dy:0,rotation:0,age:0})),ln=new vt(ce);function un(n,t,e,i,s){let[r,o]=n.ents.create(ce);return o.x=t,o.y=e,o.dx=i,o.dy=s,o.rotation=Math.atan2(s,i),o.age=0,r}function Hi(n,t){n.ents.destroy(t)}function Ui(n){return n.ents.count(ce)}function Ni(n){n.ents.clear(ce)}function Ki(n,t){for(let[e,i]of ln.findAll(t.ents))i.age+=n,i.age>Jr?Hi(t,e):(i.x+=i.dx,i.y+=i.dy,ft(t,i,Ct*2,Ct*2));for(let[e,i]of ln.findAll(t.ents))for(let s of t.asteroids)if(Pt(i,s,s.size)){t.flashScore=1,t.score++,t.score>t.highScore&&(t.flashHighScore=t.score-t.highScore,t.highScore=t.score,localStorage.setItem("highscore",`${t.highScore}`)),cn(t,s),rt.SoundPop.current.play(),Hi(t,e),Fi(t,s,i.dx*hn,i.dy*hn);break}}function $i(n,t){for(let[e,i]of ln.findAll(t.ents))n.translate(i.x,i.y),n.rotate(i.rotation),n.fillStyle=Vr,n.fillRect(-Ct,-Ct,Ct*4,Ct*2),n.setTransform(1,0,0,1,0,0),_t(n,i.x,i.y,Ct)}var it=5,fe=[-2,2],to=.1,eo=.4,no=["red","red","red","yellow","orange"],io=["gray","darkgray","lightgray"],zi=10,Yi=1.5,ji=.02,so=.008,ro=.1,Gi=.001,Wi=new gt("Player",()=>({x:0,y:0,rotation:0,dx:0,dy:0,dr:0,left:0,right:0,up:0,down:0,fire:0,cooldown:0,powerMode:0})),qi=new vt(Wi);function Xi(n){let t=n.display.canvas;n.player.x=t.width/2,n.player.y=t.height/2,n.player.dx=0,n.player.dy=0}function Zi(n){let t=n.display.canvas,[e,i]=n.ents.create(Wi);return i.x=t.width/2,i.y=t.height/2,n.player=i,i}function Qi(n,t){let[e,i]=qi.find(t.ents);if(!i)return;let s=i.right-i.left,r=i.down-i.up,o=i.fire;i.dx+=r*Math.cos(i.rotation)*ji,i.dy+=r*Math.sin(i.rotation)*ji,i.dx*=1-Gi,i.dy*=1-Gi,i.dr+=s*so,i.dr*=1-ro,i.x+=i.dx,i.y+=i.dy,i.rotation+=i.dr,--i.cooldown,ft(t,i,it*2,it*2),o&&(oo(t,i),t.flashShootDelta=1),r&&ao(t,i.x,i.y,-r*Math.cos(i.rotation)*Yi,-r*Math.sin(i.rotation)*Yi,w.choose.bind(null,io))}function Vi(n,t){let[e,i]=qi.find(t.ents);if(!i)return;n.translate(i.x,i.y),n.rotate(i.rotation),n.fillStyle="white";let s=it;n.fillRect(-s,-s,s*2,s*2);let r=-1,o=0,l=0;t.flashShootDelta>0?(n.fillStyle=`rgb(${200*t.flashShootDelta+55*Math.sin(performance.now()/(zi*2))}, 0, 0)`,t.flashShootDelta-=$t,l=t.flashShootDelta*2,r=t.flashShootDelta):n.fillStyle="black",n.fillRect(-s-l/2+r,-(s/4)-l/2+o,s+l,s/2+l),n.setTransform(1,0,0,1,0,0)}function oo(n,t){if(!(Ui(n)>ki)&&!(t.cooldown>0)){if(t.powerMode>0){for(let e=-1;e<=1;++e){let i=t.rotation+e*Math.PI/4;un(n,t.x-Math.cos(i)*it,t.y-Math.sin(i)*it,-Math.cos(i)*zt+t.dx,-Math.sin(i)*zt+t.dy)}--t.powerMode}else un(n,t.x-Math.cos(t.rotation)*it,t.y-Math.sin(t.rotation)*it,-Math.cos(t.rotation)*zt+t.dx,-Math.sin(t.rotation)*zt+t.dy);t.cooldown=zi,rt.SoundShoot.current.play()}}function Ji(n,t){n.gamePause=!0,n.showPlayer=!1,Bt(n,t.x,t.y,100,w.choose.bind(null,no)),rt.SoundDead.current.play(),rt.SoundBoom.current.play(),setTimeout(()=>n.gameStart=n.gameWait=!0,1e3)}function ao(n,t,e,i,s,r){w.next()>.3&&he(n,t+w.range(fe[0],fe[1]),e+w.range(fe[0],fe[1]),i,s,r,w.range(Ft*to,Ft*eo))}var k=1,hn=.1,Yt=4,lo=100,uo=1,O=8,pe={MIN:3e3,MAX:1e4},ho=n=>n.range(pe.MIN,pe.MAX),co=["blue","blue","blue","dodgerblue","gray","darkgray","yellow"];function ts(n){n.asteroids.length=0;for(let t=0;t<uo*n.level;++t)n.asteroidSpawner.spawn(n)}function Fi(n,t,e=0,i=0){if(es(n,t),t.size>Yt){let s=[];s.push(jt(n,t.x+w.range(-O,O),t.y+w.range(-O,O),w.range(-k,k)+e,w.range(-k,k)+i,Yt)),s.push(jt(n,t.x+w.range(-O,O),t.y+w.range(-O,O),w.range(-k,k)+e,w.range(-k,k)+i,Yt)),s.push(jt(n,t.x+w.range(-O,O),t.y+w.range(-O,O),w.range(-k,k)+e,w.range(-k,k)+i,Yt)),s.push(jt(n,t.x+w.range(-O,O),t.y+w.range(-O,O),w.range(-k,k)+e,w.range(-k,k)+i,Yt)),n.asteroids.push(...s)}}function jt(n,t,e,i,s,r){return{scene:n,x:t,y:e,dx:i,dy:s,size:r,rotation:Math.atan2(s,i)}}function es(n,t){n.asteroids.splice(n.asteroids.indexOf(t),1)}function ns(n){return{scene:n,spawnTicks:pe.MAX,reset(){this.spawnTicks=pe.MAX},spawn(t){if(t.asteroids.length>lo)return;let e=w.choose(fn(t.display)),i=jt(t,w.range(e[0],e[0]+e[2]),w.range(e[1],e[1]+e[3]),w.range(-k,k),w.range(-k,k),O);t.asteroids.push(i)}}}function is(n,t,e){t.gamePause||(e.spawnTicks-=n,e.spawnTicks<=0&&(e.spawn(t),e.spawnTicks=ho(w.RAND)))}function ss(n,t,e){for(let i of e)i.x+=i.dx,i.y+=i.dy,ft(t,i,i.size*2,i.size*2);for(let i of e)if(Pt(i,t.player,i.size+it)){cn(t,i),es(t,i),Ji(t,t.player);break}}function cn(n,t){Bt(n,t.x,t.y,10,w.choose.bind(null,co))}function rs(n,t,e){for(let i of e)n.translate(i.x,i.y),n.rotate(i.rotation),n.fillStyle="slategray",n.fillRect(-i.size,-i.size,i.size*2,i.size*2),n.setTransform(1,0,0,1,0,0),_t(n,i.x,i.y,i.size)}function fn(n){return[[-O,-O,O*2+n.width,O],[-O,0,O,n.height],[-O,n.height,O*2+n.width,O],[n.width,0,O,n.height]]}var mt=4;var fo=["white","violet","violet"],po=30,vo=.7;function os(n){n.ents.clear(de),w.next()>vo&&n.powerUpSpawner.spawn(n)}var de=new gt("PowerUp",()=>({x:0,y:0,dx:0,dy:0,rotation:0})),pn=new vt(de);function go(n,t,e,i,s){return{scene:n,x:t,y:e,dx:i,dy:s,rotation:Math.atan2(s,i)}}function mo(n,t){n.ents.destroy(t)}function as(n,t){for(let[e,i]of pn.findAll(t.ents))i.x+=i.dx,i.y+=i.dy,ft(t,i,mt*2,mt*2);for(let[e,i]of pn.findAll(t.ents))if(Pt(i,t.player,mt+it)){Bt(t,i.x,i.y,10,w.choose.bind(null,fo)),mo(t,e),t.player.powerMode+=po;break}}function ls(n,t){for(let[e,i]of pn.findAll(t.ents))n.translate(i.x,i.y),n.rotate(i.rotation),n.beginPath(),n.strokeStyle="violet",n.arc(0,0,mt,0,Math.PI*2),n.moveTo(-mt/2,0),n.lineTo(mt/2,0),n.moveTo(0,-mt/2),n.lineTo(0,mt/2),n.stroke(),n.setTransform(1,0,0,1,0,0),_t(n,i.x,i.y,mt)}function us(n){return{scene:n,reset(){},spawn(t){let e=w.choose(fn(t.display));go(t,w.range(e[0],e[0]+e[2]),w.range(e[1],e[1]+e[3]),w.range(-k,k),w.range(-k,k))}}}function hs(n,t,e){}async function cs(){let n=document.querySelector("#display"),e=n.canvas.getContext("2d"),i={display:n},s={};await Eo.call(s),wo.call(s,i),n.addEventListener("frame",r=>{let{deltaTime:o}=r.detail;_o.call(s,o),Ao.call(s,e)})}var yo="[ wasd_ ]";async function Eo(){console.log("Loading..."),await Ti(),console.log("...loading complete!")}function wo(n){this.core=n,this.ents=new Ve,this.events=new Je,this.level=0,this.score=0,this.highScore=Number(localStorage.getItem("highscore")),this.flashScore=0,this.flashScoreDelta=0,this.flashHighScore=0,this.flashHighScoreDelta=0,this.flashShootDelta=0,this.dt=0;let t=n.display.canvas;this.display=n.display,this.player=null,Zi(this),this.asteroids=[],this.asteroidSpawner=ns(this),this.powerUpSpawner=us(this),this.starfield=Ii(t.width,t.height),this.gamePause=!0,this.showPlayer=!0,this.gameStart=!0,this.gameWait=!0,this.hint=yo,document.addEventListener("keydown",e=>xo.call(this,e.key)),document.addEventListener("keyup",e=>So.call(this,e.key))}function _o(n){if(this.gamePause){an(n,this);return}this.dt=n,Qi(n,this),Ki(n,this),an(n,this),ss(n,this,this.asteroids),as(n,this),Mi(this.starfield),is(n,this,this.asteroidSpawner),hs(n,this,this.powerUpSpawner),!this.gamePause&&this.asteroids.length<=0&&(this.gamePause=!0,this.showPlayer=!0,rt.SoundStart.current.play(),setTimeout(()=>this.gameWait=!0,1e3)),this.ents.flush()}function Ao(n){let t=n.canvas;n.fillStyle="black",n.fillRect(0,0,t.width,t.height),Oi(n,this.starfield),n.fillStyle="rgba(255, 255, 255, 0.2)",n.textAlign="center",n.textBaseline="middle",n.font="16px sans-serif",n.fillText(this.hint,t.width/2,t.height/2-32),this.flashScore>0?(n.fillStyle=`rgba(255, 255, 255, ${this.flashScore+.2})`,this.flashScore-=$t):n.fillStyle="rgba(255, 255, 255, 0.2)",n.font="48px sans-serif",n.fillText("= "+String(this.score).padStart(2,"0")+" =",t.width/2,t.height/2),this.flashHighScore>0?(n.fillStyle=`rgba(255, 255, 255, ${this.flashHighScore+.2})`,this.flashHighScore-=$t):n.fillStyle="rgba(255, 255, 255, 0.2)",n.font="16px sans-serif",n.fillText(String(this.highScore).padStart(2,"0"),t.width/2,t.height/2+32),n.fillStyle="rgba(255, 255, 255, 0.2)",n.font="24px sans-serif",n.textAlign="right",n.fillText(`${Math.ceil(this.asteroidSpawner.spawnTicks/1e3)}`,t.width,t.height-12),rs(n,this,this.asteroids),ls(n,this),$i(n,this),Di(n,this),this.showPlayer&&Vi(n,this),_t(n,this.player.x,this.player.y,it)}function bo(n){n.level++,n.gamePause=!1,n.showPlayer=!0,Xi(n),Ni(n),ts(n),os(n),Bi(n),rt.BackgroundMusic.current.isPlaying()||rt.BackgroundMusic.current.play({loop:!0})}function xo(n){switch(this.gameWait&&(this.gameStart&&(rt.BackgroundMusic.current.play(),this.score=0,this.flashScore=!0,this.level=0,this.gameStart=!1,this.player.powerMode=0,this.ents.clear(de),this.asteroidSpawner.reset(),this.powerUpSpawner.reset()),this.gameWait=!1,bo(this)),n){case"w":case"ArrowUp":this.player.up=1;break;case"s":case"ArrowDown":this.player.down=1;break;case"a":case"ArrowLeft":this.player.left=1;break;case"d":case"ArrowRight":this.player.right=1;break;case" ":this.player.fire=1;break;case"\\":break;default:console.log(n)}}function So(n){switch(n){case"w":case"ArrowUp":this.player.up=0;break;case"s":case"ArrowDown":this.player.down=0;break;case"a":case"ArrowLeft":this.player.left=0;break;case"d":case"ArrowRight":this.player.right=0;break;case" ":this.player.fire=0;break;case"\\":ue.showCollision=!ue.showCollision;break;default:console.log(n)}}window.addEventListener("DOMContentLoaded",cs);})();
//# sourceMappingURL=main.js.map
