(()=>{var Is=Object.create,st=Object.defineProperty,Ls=Object.getPrototypeOf,Cs=Object.prototype.hasOwnProperty,Fs=Object.getOwnPropertyNames,Os=Object.getOwnPropertyDescriptor;var Ns=e=>st(e,"__esModule",{value:!0});var Bs=(e,t)=>()=>(e&&(t=e(e=0)),t),Le=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ce=(e,t)=>{for(var n in t)st(e,n,{get:t[n],enumerable:!0})},Ds=(e,t,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of Fs(t))!Cs.call(e,r)&&r!=="default"&&st(e,r,{get:()=>t[r],enumerable:!(n=Os(t,r))||n.enumerable});return e},Ps=e=>Ds(Ns(st(e!=null?Is(Ls(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var sr={};Ce(sr,{basename:()=>fr,default:()=>Xs,delimiter:()=>hr,dirname:()=>ur,extname:()=>dr,isAbsolute:()=>Bt,join:()=>or,normalize:()=>Dt,relative:()=>lr,resolve:()=>ot,sep:()=>cr});function ar(e,t){for(var n=0,r=e.length-1;r>=0;r--){var i=e[r];i==="."?e.splice(r,1):i===".."?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function ot(){for(var e="",t=!1,n=arguments.length-1;n>=-1&&!t;n--){var r=n>=0?arguments[n]:"/";if(typeof r!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!r)continue;e=r+"/"+e,t=r.charAt(0)==="/"}return e=ar(Nt(e.split("/"),function(i){return!!i}),!t).join("/"),(t?"/":"")+e||"."}function Dt(e){var t=Bt(e),n=Ws(e,-1)==="/";return e=ar(Nt(e.split("/"),function(r){return!!r}),!t).join("/"),!e&&!t&&(e="."),e&&n&&(e+="/"),(t?"/":"")+e}function Bt(e){return e.charAt(0)==="/"}function or(){var e=Array.prototype.slice.call(arguments,0);return Dt(Nt(e,function(t,n){if(typeof t!="string")throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))}function lr(e,t){e=ot(e).substr(1),t=ot(t).substr(1);function n(c){for(var h=0;h<c.length&&c[h]==="";h++);for(var u=c.length-1;u>=0&&c[u]==="";u--);return h>u?[]:c.slice(h,u-h+1)}for(var r=n(e.split("/")),i=n(t.split("/")),s=Math.min(r.length,i.length),a=s,o=0;o<s;o++)if(r[o]!==i[o]){a=o;break}for(var l=[],o=a;o<r.length;o++)l.push("..");return l=l.concat(i.slice(a)),l.join("/")}function ur(e){var t=Ot(e),n=t[0],r=t[1];return!n&&!r?".":(r&&(r=r.substr(0,r.length-1)),n+r)}function fr(e,t){var n=Ot(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n}function dr(e){return Ot(e)[3]}function Nt(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}var $s,Ot,cr,hr,Xs,Ws,pr=Bs(()=>{$s=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,Ot=function(e){return $s.exec(e).slice(1)};cr="/",hr=":";Xs={extname:dr,basename:fr,dirname:ur,sep:cr,delimiter:hr,relative:lr,join:or,isAbsolute:Bt,normalize:Dt,resolve:ot};Ws="ab".substr(-1)==="b"?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}});var ct=Le((X0,lt)=>{var be=(pr(),sr);be&&be.default?lt.exports=be.default:be&&(lt.exports=be);if(be)for(let e in be)lt.exports[e]=be[e]});var je=Le((q0,vr)=>{"use strict";var qs=ct(),xe="\\\\/",xr=`[^${xe}]`,ge="\\.",Zs="\\+",Qs="\\?",ht="\\/",Js="(?=.)",mr="[^/]",Pt=`(?:${ht}|$)`,_r=`(?:^|${ht})`,kt=`${ge}{1,2}${Pt}`,ea=`(?!${ge})`,ta=`(?!${_r}${kt})`,na=`(?!${ge}{0,1}${Pt})`,ra=`(?!${kt})`,ia=`[^.${ht}]`,sa=`${mr}*?`,Er={DOT_LITERAL:ge,PLUS_LITERAL:Zs,QMARK_LITERAL:Qs,SLASH_LITERAL:ht,ONE_CHAR:Js,QMARK:mr,END_ANCHOR:Pt,DOTS_SLASH:kt,NO_DOT:ea,NO_DOTS:ta,NO_DOT_SLASH:na,NO_DOTS_SLASH:ra,QMARK_NO_DOT:ia,STAR:sa,START_ANCHOR:_r},aa={...Er,SLASH_LITERAL:`[${xe}]`,QMARK:xr,STAR:`${xr}*?`,DOTS_SLASH:`${ge}{1,2}(?:[${xe}]|$)`,NO_DOT:`(?!${ge})`,NO_DOTS:`(?!(?:^|[${xe}])${ge}{1,2}(?:[${xe}]|$))`,NO_DOT_SLASH:`(?!${ge}{0,1}(?:[${xe}]|$))`,NO_DOTS_SLASH:`(?!${ge}{1,2}(?:[${xe}]|$))`,QMARK_NO_DOT:`[^.${xe}]`,START_ANCHOR:`(?:^|[${xe}])`,END_ANCHOR:`(?:[${xe}]|$)`},oa={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};vr.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:oa,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:qs.sep,extglobChars(e){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${e.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(e){return e===!0?aa:Er}}});var ut=Le(ie=>{"use strict";var la=ct(),ca=!1,{REGEX_BACKSLASH:ha,REGEX_REMOVE_BACKSLASH:ua,REGEX_SPECIAL_CHARS:fa,REGEX_SPECIAL_CHARS_GLOBAL:da}=je();ie.isObject=e=>e!==null&&typeof e=="object"&&!Array.isArray(e);ie.hasRegexChars=e=>fa.test(e);ie.isRegexChar=e=>e.length===1&&ie.hasRegexChars(e);ie.escapeRegex=e=>e.replace(da,"\\$1");ie.toPosixSlashes=e=>e.replace(ha,"/");ie.removeBackslashes=e=>e.replace(ua,t=>t==="\\"?"":t);ie.supportsLookbehinds=()=>{let e=process.version.slice(1).split(".").map(Number);return e.length===3&&e[0]>=9||e[0]===8&&e[1]>=10};ie.isWindows=e=>e&&typeof e.windows=="boolean"?e.windows:ca===!0||la.sep==="\\";ie.escapeLast=(e,t,n)=>{let r=e.lastIndexOf(t,n);return r===-1?e:e[r-1]==="\\"?ie.escapeLast(e,t,r-1):`${e.slice(0,r)}\\${e.slice(r)}`};ie.removePrefix=(e,t={})=>{let n=e;return n.startsWith("./")&&(n=n.slice(2),t.prefix="./"),n};ie.wrapOutput=(e,t={},n={})=>{let r=n.contains?"":"^",i=n.contains?"":"$",s=`${r}(?:${e})${i}`;return t.negated===!0&&(s=`(?:^(?!${s}).*$)`),s}});var Rr=Le((Q0,gr)=>{"use strict";var Ar=ut(),{CHAR_ASTERISK:Ut,CHAR_AT:pa,CHAR_BACKWARD_SLASH:$e,CHAR_COMMA:va,CHAR_DOT:Ht,CHAR_EXCLAMATION_MARK:zt,CHAR_FORWARD_SLASH:yr,CHAR_LEFT_CURLY_BRACE:Yt,CHAR_LEFT_PARENTHESES:Vt,CHAR_LEFT_SQUARE_BRACKET:xa,CHAR_PLUS:ma,CHAR_QUESTION_MARK:Mr,CHAR_RIGHT_CURLY_BRACE:_a,CHAR_RIGHT_PARENTHESES:wr,CHAR_RIGHT_SQUARE_BRACKET:Ea}=je(),br=e=>e===yr||e===$e,Tr=e=>{e.isPrefix!==!0&&(e.depth=e.isGlobstar?Infinity:1)},ga=(e,t)=>{let n=t||{},r=e.length-1,i=n.parts===!0||n.scanToEnd===!0,s=[],a=[],o=[],l=e,c=-1,h=0,u=0,f=!1,d=!1,p=!1,x=!1,v=!1,g=!1,I=!1,A=!1,T=!1,w=!1,R=0,B,y,C={value:"",depth:0,isGlob:!1},D=()=>c>=r,m=()=>l.charCodeAt(c+1),N=()=>(B=y,l.charCodeAt(++c));for(;c<r;){y=N();let $;if(y===$e){I=C.backslashes=!0,y=N(),y===Yt&&(g=!0);continue}if(g===!0||y===Yt){for(R++;D()!==!0&&(y=N());){if(y===$e){I=C.backslashes=!0,N();continue}if(y===Yt){R++;continue}if(g!==!0&&y===Ht&&(y=N())===Ht){if(f=C.isBrace=!0,p=C.isGlob=!0,w=!0,i===!0)continue;break}if(g!==!0&&y===va){if(f=C.isBrace=!0,p=C.isGlob=!0,w=!0,i===!0)continue;break}if(y===_a&&(R--,R===0)){g=!1,f=C.isBrace=!0,w=!0;break}}if(i===!0)continue;break}if(y===yr){if(s.push(c),a.push(C),C={value:"",depth:0,isGlob:!1},w===!0)continue;if(B===Ht&&c===h+1){h+=2;continue}u=c+1;continue}if(n.noext!==!0&&(y===ma||y===pa||y===Ut||y===Mr||y===zt)===!0&&m()===Vt){if(p=C.isGlob=!0,x=C.isExtglob=!0,w=!0,y===zt&&c===h&&(T=!0),i===!0){for(;D()!==!0&&(y=N());){if(y===$e){I=C.backslashes=!0,y=N();continue}if(y===wr){p=C.isGlob=!0,w=!0;break}}continue}break}if(y===Ut){if(B===Ut&&(v=C.isGlobstar=!0),p=C.isGlob=!0,w=!0,i===!0)continue;break}if(y===Mr){if(p=C.isGlob=!0,w=!0,i===!0)continue;break}if(y===xa){for(;D()!==!0&&($=N());){if($===$e){I=C.backslashes=!0,N();continue}if($===Ea){d=C.isBracket=!0,p=C.isGlob=!0,w=!0;break}}if(i===!0)continue;break}if(n.nonegate!==!0&&y===zt&&c===h){A=C.negated=!0,h++;continue}if(n.noparen!==!0&&y===Vt){if(p=C.isGlob=!0,i===!0){for(;D()!==!0&&(y=N());){if(y===Vt){I=C.backslashes=!0,y=N();continue}if(y===wr){w=!0;break}}continue}break}if(p===!0){if(w=!0,i===!0)continue;break}}n.noext===!0&&(x=!1,p=!1);let O=l,F="",_="";h>0&&(F=l.slice(0,h),l=l.slice(h),u-=h),O&&p===!0&&u>0?(O=l.slice(0,u),_=l.slice(u)):p===!0?(O="",_=l):O=l,O&&O!==""&&O!=="/"&&O!==l&&br(O.charCodeAt(O.length-1))&&(O=O.slice(0,-1)),n.unescape===!0&&(_&&(_=Ar.removeBackslashes(_)),O&&I===!0&&(O=Ar.removeBackslashes(O)));let E={prefix:F,input:e,start:h,base:O,glob:_,isBrace:f,isBracket:d,isGlob:p,isExtglob:x,isGlobstar:v,negated:A,negatedExtglob:T};if(n.tokens===!0&&(E.maxDepth=0,br(y)||a.push(C),E.tokens=a),n.parts===!0||n.tokens===!0){let $;for(let H=0;H<s.length;H++){let Q=$?$+1:h,J=s[H],te=e.slice(Q,J);n.tokens&&(H===0&&h!==0?(a[H].isPrefix=!0,a[H].value=F):a[H].value=te,Tr(a[H]),E.maxDepth+=a[H].depth),(H!==0||te!=="")&&o.push(te),$=J}if($&&$+1<e.length){let H=e.slice($+1);o.push(H),n.tokens&&(a[a.length-1].value=H,Tr(a[a.length-1]),E.maxDepth+=a[a.length-1].depth)}E.slashes=s,E.parts=o}return E};gr.exports=ga});var Cr=Le((J0,Sr)=>{"use strict";var ft=je(),oe=ut(),{MAX_LENGTH:dt,POSIX_REGEX_SOURCE:Aa,REGEX_NON_SPECIAL_CHARS:ya,REGEX_SPECIAL_CHARS_BACKREF:Ma,REPLACEMENTS:Ir}=ft,wa=(e,t)=>{if(typeof t.expandRange=="function")return t.expandRange(...e,t);e.sort();let n=`[${e.join("-")}]`;try{new RegExp(n)}catch(r){return e.map(i=>oe.escapeRegex(i)).join("..")}return n},Pe=(e,t)=>`Missing ${e}: "${t}" - use "\\\\${t}" to match literal characters`,Lr=(e,t)=>{if(typeof e!="string")throw new TypeError("Expected a string");e=Ir[e]||e;let n={...t},r=typeof n.maxLength=="number"?Math.min(dt,n.maxLength):dt,i=e.length;if(i>r)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${r}`);let s={type:"bos",value:"",output:n.prepend||""},a=[s],o=n.capture?"":"?:",l=oe.isWindows(t),c=ft.globChars(l),h=ft.extglobChars(c),{DOT_LITERAL:u,PLUS_LITERAL:f,SLASH_LITERAL:d,ONE_CHAR:p,DOTS_SLASH:x,NO_DOT:v,NO_DOT_SLASH:g,NO_DOTS_SLASH:I,QMARK:A,QMARK_NO_DOT:T,STAR:w,START_ANCHOR:R}=c,B=S=>`(${o}(?:(?!${R}${S.dot?x:u}).)*?)`,y=n.dot?"":v,C=n.dot?A:T,D=n.bash===!0?B(n):w;n.capture&&(D=`(${D})`),typeof n.noext=="boolean"&&(n.noextglob=n.noext);let m={input:e,index:-1,start:0,dot:n.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:a};e=oe.removePrefix(e,m),i=e.length;let N=[],O=[],F=[],_=s,E,$=()=>m.index===i-1,H=m.peek=(S=1)=>e[m.index+S],Q=m.advance=()=>e[++m.index]||"",J=()=>e.slice(m.index+1),te=(S="",K=0)=>{m.consumed+=S,m.index+=K},pe=S=>{m.output+=S.output!=null?S.output:S.value,te(S.value)},Ve=()=>{let S=1;for(;H()==="!"&&(H(2)!=="("||H(3)==="?");)Q(),m.start++,S++;return S%2==0?!1:(m.negated=!0,m.start++,!0)},we=S=>{m[S]++,F.push(S)},ve=S=>{m[S]--,F.pop()},k=S=>{if(_.type==="globstar"){let K=m.braces>0&&(S.type==="comma"||S.type==="brace"),M=S.extglob===!0||N.length&&(S.type==="pipe"||S.type==="paren");S.type!=="slash"&&S.type!=="paren"&&!K&&!M&&(m.output=m.output.slice(0,-_.output.length),_.type="star",_.value="*",_.output=D,m.output+=_.output)}if(N.length&&S.type!=="paren"&&(N[N.length-1].inner+=S.value),(S.value||S.output)&&pe(S),_&&_.type==="text"&&S.type==="text"){_.value+=S.value,_.output=(_.output||"")+S.value;return}S.prev=_,a.push(S),_=S},Ie=(S,K)=>{let M={...h[K],conditions:1,inner:""};M.prev=_,M.parens=m.parens,M.output=m.output;let U=(n.capture?"(":"")+M.open;we("parens"),k({type:S,value:K,output:m.output?"":p}),k({type:"paren",extglob:!0,value:Q(),output:U}),N.push(M)},rt=S=>{let K=S.close+(n.capture?")":""),M;if(S.type==="negate"){let U=D;S.inner&&S.inner.length>1&&S.inner.includes("/")&&(U=B(n)),(U!==D||$()||/^\)+$/.test(J()))&&(K=S.close=`)$))${U}`),S.inner.includes("*")&&(M=J())&&/^\.[^\\/.]+$/.test(M)&&(K=S.close=`)${M})${U})`),S.prev.type==="bos"&&(m.negatedExtglob=!0)}k({type:"paren",extglob:!0,value:E,output:K}),ve("parens")};if(n.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(e)){let S=!1,K=e.replace(Ma,(M,U,W,re,Z,Ct)=>re==="\\"?(S=!0,M):re==="?"?U?U+re+(Z?A.repeat(Z.length):""):Ct===0?C+(Z?A.repeat(Z.length):""):A.repeat(W.length):re==="."?u.repeat(W.length):re==="*"?U?U+re+(Z?D:""):D:U?M:`\\${M}`);return S===!0&&(n.unescape===!0?K=K.replace(/\\/g,""):K=K.replace(/\\+/g,M=>M.length%2==0?"\\\\":M?"\\":"")),K===e&&n.contains===!0?(m.output=e,m):(m.output=oe.wrapOutput(K,m,t),m)}for(;!$();){if(E=Q(),E==="\0")continue;if(E==="\\"){let M=H();if(M==="/"&&n.bash!==!0||M==="."||M===";")continue;if(!M){E+="\\",k({type:"text",value:E});continue}let U=/^\\+/.exec(J()),W=0;if(U&&U[0].length>2&&(W=U[0].length,m.index+=W,W%2!=0&&(E+="\\")),n.unescape===!0?E=Q():E+=Q(),m.brackets===0){k({type:"text",value:E});continue}}if(m.brackets>0&&(E!=="]"||_.value==="["||_.value==="[^")){if(n.posix!==!1&&E===":"){let M=_.value.slice(1);if(M.includes("[")&&(_.posix=!0,M.includes(":"))){let U=_.value.lastIndexOf("["),W=_.value.slice(0,U),re=_.value.slice(U+2),Z=Aa[re];if(Z){_.value=W+Z,m.backtrack=!0,Q(),!s.output&&a.indexOf(_)===1&&(s.output=p);continue}}}(E==="["&&H()!==":"||E==="-"&&H()==="]")&&(E=`\\${E}`),E==="]"&&(_.value==="["||_.value==="[^")&&(E=`\\${E}`),n.posix===!0&&E==="!"&&_.value==="["&&(E="^"),_.value+=E,pe({value:E});continue}if(m.quotes===1&&E!=='"'){E=oe.escapeRegex(E),_.value+=E,pe({value:E});continue}if(E==='"'){m.quotes=m.quotes===1?0:1,n.keepQuotes===!0&&k({type:"text",value:E});continue}if(E==="("){we("parens"),k({type:"paren",value:E});continue}if(E===")"){if(m.parens===0&&n.strictBrackets===!0)throw new SyntaxError(Pe("opening","("));let M=N[N.length-1];if(M&&m.parens===M.parens+1){rt(N.pop());continue}k({type:"paren",value:E,output:m.parens?")":"\\)"}),ve("parens");continue}if(E==="["){if(n.nobracket===!0||!J().includes("]")){if(n.nobracket!==!0&&n.strictBrackets===!0)throw new SyntaxError(Pe("closing","]"));E=`\\${E}`}else we("brackets");k({type:"bracket",value:E});continue}if(E==="]"){if(n.nobracket===!0||_&&_.type==="bracket"&&_.value.length===1){k({type:"text",value:E,output:`\\${E}`});continue}if(m.brackets===0){if(n.strictBrackets===!0)throw new SyntaxError(Pe("opening","["));k({type:"text",value:E,output:`\\${E}`});continue}ve("brackets");let M=_.value.slice(1);if(_.posix!==!0&&M[0]==="^"&&!M.includes("/")&&(E=`/${E}`),_.value+=E,pe({value:E}),n.literalBrackets===!1||oe.hasRegexChars(M))continue;let U=oe.escapeRegex(_.value);if(m.output=m.output.slice(0,-_.value.length),n.literalBrackets===!0){m.output+=U,_.value=U;continue}_.value=`(${o}${U}|${_.value})`,m.output+=_.value;continue}if(E==="{"&&n.nobrace!==!0){we("braces");let M={type:"brace",value:E,output:"(",outputIndex:m.output.length,tokensIndex:m.tokens.length};O.push(M),k(M);continue}if(E==="}"){let M=O[O.length-1];if(n.nobrace===!0||!M){k({type:"text",value:E,output:E});continue}let U=")";if(M.dots===!0){let W=a.slice(),re=[];for(let Z=W.length-1;Z>=0&&(a.pop(),W[Z].type!=="brace");Z--)W[Z].type!=="dots"&&re.unshift(W[Z].value);U=wa(re,n),m.backtrack=!0}if(M.comma!==!0&&M.dots!==!0){let W=m.output.slice(0,M.outputIndex),re=m.tokens.slice(M.tokensIndex);M.value=M.output="\\{",E=U="\\}",m.output=W;for(let Z of re)m.output+=Z.output||Z.value}k({type:"brace",value:E,output:U}),ve("braces"),O.pop();continue}if(E==="|"){N.length>0&&N[N.length-1].conditions++,k({type:"text",value:E});continue}if(E===","){let M=E,U=O[O.length-1];U&&F[F.length-1]==="braces"&&(U.comma=!0,M="|"),k({type:"comma",value:E,output:M});continue}if(E==="/"){if(_.type==="dot"&&m.index===m.start+1){m.start=m.index+1,m.consumed="",m.output="",a.pop(),_=s;continue}k({type:"slash",value:E,output:d});continue}if(E==="."){if(m.braces>0&&_.type==="dot"){_.value==="."&&(_.output=u);let M=O[O.length-1];_.type="dots",_.output+=E,_.value+=E,M.dots=!0;continue}if(m.braces+m.parens===0&&_.type!=="bos"&&_.type!=="slash"){k({type:"text",value:E,output:u});continue}k({type:"dot",value:E,output:u});continue}if(E==="?"){if(!(_&&_.value==="(")&&n.noextglob!==!0&&H()==="("&&H(2)!=="?"){Ie("qmark",E);continue}if(_&&_.type==="paren"){let U=H(),W=E;if(U==="<"&&!oe.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(_.value==="("&&!/[!=<:]/.test(U)||U==="<"&&!/<([!=]|\w+>)/.test(J()))&&(W=`\\${E}`),k({type:"text",value:E,output:W});continue}if(n.dot!==!0&&(_.type==="slash"||_.type==="bos")){k({type:"qmark",value:E,output:T});continue}k({type:"qmark",value:E,output:A});continue}if(E==="!"){if(n.noextglob!==!0&&H()==="("&&(H(2)!=="?"||!/[!=<:]/.test(H(3)))){Ie("negate",E);continue}if(n.nonegate!==!0&&m.index===0){Ve();continue}}if(E==="+"){if(n.noextglob!==!0&&H()==="("&&H(2)!=="?"){Ie("plus",E);continue}if(_&&_.value==="("||n.regex===!1){k({type:"plus",value:E,output:f});continue}if(_&&(_.type==="bracket"||_.type==="paren"||_.type==="brace")||m.parens>0){k({type:"plus",value:E});continue}k({type:"plus",value:f});continue}if(E==="@"){if(n.noextglob!==!0&&H()==="("&&H(2)!=="?"){k({type:"at",extglob:!0,value:E,output:""});continue}k({type:"text",value:E});continue}if(E!=="*"){(E==="$"||E==="^")&&(E=`\\${E}`);let M=ya.exec(J());M&&(E+=M[0],m.index+=M[0].length),k({type:"text",value:E});continue}if(_&&(_.type==="globstar"||_.star===!0)){_.type="star",_.star=!0,_.value+=E,_.output=D,m.backtrack=!0,m.globstar=!0,te(E);continue}let S=J();if(n.noextglob!==!0&&/^\([^?]/.test(S)){Ie("star",E);continue}if(_.type==="star"){if(n.noglobstar===!0){te(E);continue}let M=_.prev,U=M.prev,W=M.type==="slash"||M.type==="bos",re=U&&(U.type==="star"||U.type==="globstar");if(n.bash===!0&&(!W||S[0]&&S[0]!=="/")){k({type:"star",value:E,output:""});continue}let Z=m.braces>0&&(M.type==="comma"||M.type==="brace"),Ct=N.length&&(M.type==="pipe"||M.type==="paren");if(!W&&M.type!=="paren"&&!Z&&!Ct){k({type:"star",value:E,output:""});continue}for(;S.slice(0,3)==="/**";){let it=e[m.index+4];if(it&&it!=="/")break;S=S.slice(3),te("/**",3)}if(M.type==="bos"&&$()){_.type="globstar",_.value+=E,_.output=B(n),m.output=_.output,m.globstar=!0,te(E);continue}if(M.type==="slash"&&M.prev.type!=="bos"&&!re&&$()){m.output=m.output.slice(0,-(M.output+_.output).length),M.output=`(?:${M.output}`,_.type="globstar",_.output=B(n)+(n.strictSlashes?")":"|$)"),_.value+=E,m.globstar=!0,m.output+=M.output+_.output,te(E);continue}if(M.type==="slash"&&M.prev.type!=="bos"&&S[0]==="/"){let it=S[1]!==void 0?"|$":"";m.output=m.output.slice(0,-(M.output+_.output).length),M.output=`(?:${M.output}`,_.type="globstar",_.output=`${B(n)}${d}|${d}${it})`,_.value+=E,m.output+=M.output+_.output,m.globstar=!0,te(E+Q()),k({type:"slash",value:"/",output:""});continue}if(M.type==="bos"&&S[0]==="/"){_.type="globstar",_.value+=E,_.output=`(?:^|${d}|${B(n)}${d})`,m.output=_.output,m.globstar=!0,te(E+Q()),k({type:"slash",value:"/",output:""});continue}m.output=m.output.slice(0,-_.output.length),_.type="globstar",_.output=B(n),_.value+=E,m.output+=_.output,m.globstar=!0,te(E);continue}let K={type:"star",value:E,output:D};if(n.bash===!0){K.output=".*?",(_.type==="bos"||_.type==="slash")&&(K.output=y+K.output),k(K);continue}if(_&&(_.type==="bracket"||_.type==="paren")&&n.regex===!0){K.output=E,k(K);continue}(m.index===m.start||_.type==="slash"||_.type==="dot")&&(_.type==="dot"?(m.output+=g,_.output+=g):n.dot===!0?(m.output+=I,_.output+=I):(m.output+=y,_.output+=y),H()!=="*"&&(m.output+=p,_.output+=p)),k(K)}for(;m.brackets>0;){if(n.strictBrackets===!0)throw new SyntaxError(Pe("closing","]"));m.output=oe.escapeLast(m.output,"["),ve("brackets")}for(;m.parens>0;){if(n.strictBrackets===!0)throw new SyntaxError(Pe("closing",")"));m.output=oe.escapeLast(m.output,"("),ve("parens")}for(;m.braces>0;){if(n.strictBrackets===!0)throw new SyntaxError(Pe("closing","}"));m.output=oe.escapeLast(m.output,"{"),ve("braces")}if(n.strictSlashes!==!0&&(_.type==="star"||_.type==="bracket")&&k({type:"maybe_slash",value:"",output:`${d}?`}),m.backtrack===!0){m.output="";for(let S of m.tokens)m.output+=S.output!=null?S.output:S.value,S.suffix&&(m.output+=S.suffix)}return m};Lr.fastpaths=(e,t)=>{let n={...t},r=typeof n.maxLength=="number"?Math.min(dt,n.maxLength):dt,i=e.length;if(i>r)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${r}`);e=Ir[e]||e;let s=oe.isWindows(t),{DOT_LITERAL:a,SLASH_LITERAL:o,ONE_CHAR:l,DOTS_SLASH:c,NO_DOT:h,NO_DOTS:u,NO_DOTS_SLASH:f,STAR:d,START_ANCHOR:p}=ft.globChars(s),x=n.dot?u:h,v=n.dot?f:h,g=n.capture?"":"?:",I={negated:!1,prefix:""},A=n.bash===!0?".*?":d;n.capture&&(A=`(${A})`);let T=y=>y.noglobstar===!0?A:`(${g}(?:(?!${p}${y.dot?c:a}).)*?)`,w=y=>{switch(y){case"*":return`${x}${l}${A}`;case".*":return`${a}${l}${A}`;case"*.*":return`${x}${A}${a}${l}${A}`;case"*/*":return`${x}${A}${o}${l}${v}${A}`;case"**":return x+T(n);case"**/*":return`(?:${x}${T(n)}${o})?${v}${l}${A}`;case"**/*.*":return`(?:${x}${T(n)}${o})?${v}${A}${a}${l}${A}`;case"**/.*":return`(?:${x}${T(n)}${o})?${a}${l}${A}`;default:{let C=/^(.*?)\.(\w+)$/.exec(y);if(!C)return;let D=w(C[1]);return D?D+a+C[2]:void 0}}},R=oe.removePrefix(e,I),B=w(R);return B&&n.strictSlashes!==!0&&(B+=`${o}?`),B};Sr.exports=Lr});var Or=Le((ed,Fr)=>{"use strict";var ba=ct(),Ta=Rr(),Gt=Cr(),Kt=ut(),Ra=je(),Sa=e=>e&&typeof e=="object"&&!Array.isArray(e),X=(e,t,n=!1)=>{if(Array.isArray(e)){let h=e.map(f=>X(f,t,n));return f=>{for(let d of h){let p=d(f);if(p)return p}return!1}}let r=Sa(e)&&e.tokens&&e.input;if(e===""||typeof e!="string"&&!r)throw new TypeError("Expected pattern to be a non-empty string");let i=t||{},s=Kt.isWindows(t),a=r?X.compileRe(e,t):X.makeRe(e,t,!1,!0),o=a.state;delete a.state;let l=()=>!1;if(i.ignore){let h={...t,ignore:null,onMatch:null,onResult:null};l=X(i.ignore,h,n)}let c=(h,u=!1)=>{let{isMatch:f,match:d,output:p}=X.test(h,a,t,{glob:e,posix:s}),x={glob:e,state:o,regex:a,posix:s,input:h,output:p,match:d,isMatch:f};return typeof i.onResult=="function"&&i.onResult(x),f===!1?(x.isMatch=!1,u?x:!1):l(h)?(typeof i.onIgnore=="function"&&i.onIgnore(x),x.isMatch=!1,u?x:!1):(typeof i.onMatch=="function"&&i.onMatch(x),u?x:!0)};return n&&(c.state=o),c};X.test=(e,t,n,{glob:r,posix:i}={})=>{if(typeof e!="string")throw new TypeError("Expected input to be a string");if(e==="")return{isMatch:!1,output:""};let s=n||{},a=s.format||(i?Kt.toPosixSlashes:null),o=e===r,l=o&&a?a(e):e;return o===!1&&(l=a?a(e):e,o=l===r),(o===!1||s.capture===!0)&&(s.matchBase===!0||s.basename===!0?o=X.matchBase(e,t,n,i):o=t.exec(l)),{isMatch:Boolean(o),match:o,output:l}};X.matchBase=(e,t,n,r=Kt.isWindows(n))=>(t instanceof RegExp?t:X.makeRe(t,n)).test(ba.basename(e));X.isMatch=(e,t,n)=>X(t,n)(e);X.parse=(e,t)=>Array.isArray(e)?e.map(n=>X.parse(n,t)):Gt(e,{...t,fastpaths:!1});X.scan=(e,t)=>Ta(e,t);X.compileRe=(e,t,n=!1,r=!1)=>{if(n===!0)return e.output;let i=t||{},s=i.contains?"":"^",a=i.contains?"":"$",o=`${s}(?:${e.output})${a}`;e&&e.negated===!0&&(o=`^(?!${o}).*$`);let l=X.toRegex(o,t);return r===!0&&(l.state=e),l};X.makeRe=(e,t={},n=!1,r=!1)=>{if(!e||typeof e!="string")throw new TypeError("Expected a non-empty string");let i={negated:!1,fastpaths:!0};return t.fastpaths!==!1&&(e[0]==="."||e[0]==="*")&&(i.output=Gt.fastpaths(e,t)),i.output||(i=Gt(e,t)),X.compileRe(i,t,n,r)};X.toRegex=(e,t)=>{try{let n=t||{};return new RegExp(e,n.flags||(n.nocase?"i":""))}catch(n){if(t&&t.debug===!0)throw n;return/$^/}};X.constants=Ra;Fr.exports=X});var Br=Le((td,Nr)=>{"use strict";Nr.exports=Or()});var ks=`<div class="container">
  <label class="hidden" id="title">display-port</label>
  <label class="hidden" id="fps">00</label>
  <label class="hidden" id="dimension">0x0</label>
  <div class="content">
    <canvas> Oh no! Your browser does not support canvas. </canvas>
    <slot id="inner"></slot>
  </div>
  <slot name="frame"></slot>
</div>
`,Us=`:host {
  display: inline-block;
  color: #555555;
}

.container {
  display: flex;
  position: relative;
  width: 100%;
  height: 100%;
}

.content {
  position: relative;
  margin: auto;
}

.content > *:not(canvas) {
  width: 100%;
  height: 100%;
}

canvas {
  background: #000000;
  image-rendering: pixelated;
}

label {
  position: absolute;
  font-family: monospace;
  color: currentColor;
}

#inner {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: 0;
  left: 0;
  pointer-events: none;
}

#title {
  left: 0.5rem;
  top: 0.5rem;
}

#fps {
  right: 0.5rem;
  top: 0.5rem;
}

#dimension {
  left: 0.5rem;
  bottom: 0.5rem;
}

.hidden {
  display: none;
}

:host([debug]) .container {
  outline: 6px dashed rgba(0, 0, 0, 0.1);
  outline-offset: -4px;
  background-color: rgba(0, 0, 0, 0.1);
}

:host([mode='noscale']) canvas {
  margin: 0;
  top: 0;
  left: 0;
}

:host([mode='stretch']) canvas,
:host([mode='scale']) canvas {
  width: 100%;
  height: 100%;
}

:host([mode='fit']),
:host([mode='scale']),
:host([mode='center']),
:host([mode='stretch']),
:host([mode='fill']) {
  width: 100%;
  height: 100%;
}

:host([full]) {
  width: 100vw !important;
  height: 100vh !important;
}

:host([disabled]) {
  display: none;
}

slot {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  pointer-events: none;
}

::slotted(*) {
  pointer-events: auto;
}
`,Jn="noscale",Ft="fit",er="scale",tr="fill",nr="stretch",Hs=300,zs=150,Ys=Ft,Vs=200,rr=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=ks,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Us,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("display-port",this)}static get observedAttributes(){return["debug","disabled","width","height","onframe","id","class"]}get mode(){return this.getAttribute("mode")}set mode(t){this.setAttribute("mode",t)}get debug(){return this._debug}set debug(t){this.toggleAttribute("debug",t)}get disabled(){return this._disabled}set disabled(t){this.toggleAttribute("disabled",t)}get width(){return this._width}set width(t){this.setAttribute("width",String(t))}get height(){return this._height}set height(t){this.setAttribute("height",String(t))}get onframe(){return this._onframe}set onframe(t){this._onframe&&this.removeEventListener("frame",this._onframe),this._onframe=t,this._onframe&&this.addEventListener("frame",t)}constructor(){super();let t=this.attachShadow({mode:"open"});t.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),t.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._canvasElement=t.querySelector("canvas"),this._contentElement=t.querySelector(".content"),this._innerElement=t.querySelector("#inner"),this._titleElement=t.querySelector("#title"),this._fpsElement=t.querySelector("#fps"),this._dimensionElement=t.querySelector("#dimension"),this._debug=!1,this._disabled=!1,this._width=Hs,this._height=zs,this._onframe=void 0,this._animationRequestHandle=0,this._prevAnimationFrameTime=0,this._resizeTimeoutHandle=0,this._resizeCanvasWidth=0,this._resizeCanvasHeight=0,this._frameEvent=new CustomEvent("frame",{composed:!0,bubbles:!1,detail:{now:0,prevTime:0,deltaTime:0,canvas:this._canvasElement}}),this._resizeEvent=new CustomEvent("resize",{composed:!0,bubbles:!1,detail:{width:0,height:0}}),this.update=this.update.bind(this),this.onDelayCanvasResize=this.onDelayCanvasResize.bind(this)}get canvas(){return this._canvasElement}connectedCallback(){De(this,"mode"),De(this,"debug"),De(this,"disabled"),De(this,"width"),De(this,"height"),De(this,"onframe"),this.hasAttribute("mode")||this.setAttribute("mode",Ys),this.hasAttribute("tabindex")||this.setAttribute("tabindex","0"),this.updateCanvasSize(!0),this.resume()}disconnectedCallback(){this.pause()}attributeChangedCallback(t,n,r){switch(t){case"debug":this._debug=r!==null;break;case"disabled":this._disabled=r!==null;break;case"width":this._width=Number(r);break;case"height":this._height=Number(r);break;case"onframe":this.onframe=new Function("event","with(document){with(this){"+r+"}}").bind(this);break}switch(t){case"disabled":r?(this.update(0),this.pause()):this.resume();break;case"id":case"class":this._titleElement.innerHTML=`display-port${this.className?"."+this.className:""}${this.hasAttribute("id")?"#"+this.getAttribute("id"):""}`;break;case"debug":this._titleElement.classList.toggle("hidden",r),this._fpsElement.classList.toggle("hidden",r),this._dimensionElement.classList.toggle("hidden",r);break}}getContext(t="2d",n=void 0){return this._canvasElement.getContext(t,n)}pause(){cancelAnimationFrame(this._animationRequestHandle)}resume(){this._animationRequestHandle=requestAnimationFrame(this.update)}update(t){this._animationRequestHandle=requestAnimationFrame(this.update),this.updateCanvasSize(!1);let n=t-this._prevAnimationFrameTime;if(this._prevAnimationFrameTime=t,this._debug){let s=n<=0?"--":String(Math.round(1e3/n)).padStart(2,"0");if(this._fpsElement.textContent!==s&&(this._fpsElement.textContent=s),this.mode===Jn){let o=`${this._width}x${this._height}`;this._dimensionElement.textContent!==o&&(this._dimensionElement.textContent=o)}else{let o=`${this._width}x${this._height}|${this.shadowRoot.host.clientWidth}x${this.shadowRoot.host.clientHeight}`;this._dimensionElement.textContent!==o&&(this._dimensionElement.textContent=o)}}let i=this._frameEvent.detail;i.now=t,i.prevTime=this._prevAnimationFrameTime,i.deltaTime=n,this.dispatchEvent(this._frameEvent)}onDelayCanvasResize(){this._resizeTimeoutHandle=0,this.updateCanvasSize(!0)}delayCanvasResize(t,n){(t!==this._resizeCanvasWidth||n!==this._resizeCanvasHeight)&&(this._resizeCanvasWidth=t,this._resizeCanvasHeight=n,this._resizeTimeoutHandle&&clearTimeout(this._resizeTimeoutHandle),this._resizeTimeoutHandle=setTimeout(this.onDelayCanvasResize,Vs))}updateCanvasSize(t=!0){let n=this.shadowRoot.host.getBoundingClientRect(),r=n.width,i=n.height,s=this._canvasElement,a=this._width,o=this._height,l=this.mode;if(l===nr||l===tr)a=r,o=i;else if(l!==Jn&&(r<a||i<o||l===Ft||l==er)){let h=r/a,u=i/o;h<u?(a=r,o=o*h):(a=a*u,o=i)}if(a=Math.floor(a),o=Math.floor(o),typeof t=="undefined"&&(t=s.clientWidth!==a||s.clientHeight!==o),!t){this.delayCanvasResize(a,o);return}let c=Math.min(a/this._width,o/this._height)*.5;if(this._innerElement.style.fontSize=`font-size: ${c}em`,t){l===er?(s.width=this._width,s.height=this._height):l!==nr&&(s.width=a,s.height=o);let h=this._contentElement.style;h.width=`${a}px`,h.height=`${o}px`,(l===Ft||l===tr)&&(this._width=a,this._height=o);let f=this._resizeEvent.detail;f.width=a,f.height=o,this.dispatchEvent(this._resizeEvent)}}};rr.define();function De(e,t){if(Object.prototype.hasOwnProperty.call(e,t)){let n=e[t];delete e[t],e[t]=n}}window.addEventListener("error",ir,!0);window.addEventListener("unhandledrejection",ir,!0);function ir(e){e instanceof PromiseRejectionEvent?window.alert(e.reason.stack):e instanceof ErrorEvent?window.alert(e.error.stack):window.alert(JSON.stringify(e))}var Gs={},Ge=class{constructor(t,n){this.name=t,this.blockId=n,this.renderer=(r,i,s,a)=>{},Gs[n]=this}setRenderer(t){return this.renderer=t,this}};var Ke=8,at=Ke*2,W0=new Ge("air",0),Ks=new Ge("stone",1).setRenderer((e,t,n,r)=>{e.setColor(11184810),e.drawBox(t*at,n*at,Ke,Ke)}),js=new Ge("gold",2).setRenderer((e,t,n,r)=>{e.setColor(13412864),e.drawBox(t*at,n*at,Ke,Ke)});var Ga=Ps(Br());var Dr={},Ia=function(e,t,n,r,i){var s=new Worker(Dr[t]||(Dr[t]=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))));return s.onerror=function(a){return i(a.error,null)},s.onmessage=function(a){return i(null,a.data)},s.postMessage(n,r),s},ne=Uint8Array,me=Uint16Array,We=Uint32Array,jt=new ne([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),$t=new ne([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Pr=new ne([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),kr=function(e,t){for(var n=new me(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];for(var i=new We(n[30]),r=1;r<30;++r)for(var s=n[r];s<n[r+1];++s)i[s]=s-n[r]<<5|r;return[n,i]},Ur=kr(jt,2),Wt=Ur[0],La=Ur[1];Wt[28]=258,La[258]=28;var Hr=kr($t,0),zr=Hr[0],rd=Hr[1],pt=new me(32768);for(var j=0;j<32768;++j)Ae=(j&43690)>>>1|(j&21845)<<1,Ae=(Ae&52428)>>>2|(Ae&13107)<<2,Ae=(Ae&61680)>>>4|(Ae&3855)<<4,pt[j]=((Ae&65280)>>>8|(Ae&255)<<8)>>>1;var Ae,ke=function(e,t,n){for(var r=e.length,i=0,s=new me(t);i<r;++i)++s[e[i]-1];var a=new me(t);for(i=0;i<t;++i)a[i]=a[i-1]+s[i-1]<<1;var o;if(n){o=new me(1<<t);var l=15-t;for(i=0;i<r;++i)if(e[i])for(var c=i<<4|e[i],h=t-e[i],u=a[e[i]-1]++<<h,f=u|(1<<h)-1;u<=f;++u)o[pt[u]>>>l]=c}else for(o=new me(r),i=0;i<r;++i)e[i]&&(o[i]=pt[a[e[i]-1]++]>>>15-e[i]);return o},Xe=new ne(288);for(var j=0;j<144;++j)Xe[j]=8;for(var j=144;j<256;++j)Xe[j]=9;for(var j=256;j<280;++j)Xe[j]=7;for(var j=280;j<288;++j)Xe[j]=8;var Yr=new ne(32);for(var j=0;j<32;++j)Yr[j]=5;var Vr=ke(Xe,9,1);var Gr=ke(Yr,5,1),vt=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},ce=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(t&7)&n},xt=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(t&7)},Kr=function(e){return(e/8|0)+(e&7&&1)},mt=function(e,t,n){(t==null||t<0)&&(t=0),(n==null||n>e.length)&&(n=e.length);var r=new(e instanceof me?me:e instanceof We?We:ne)(n-t);return r.set(e.subarray(t,n)),r},jr=function(e,t,n){var r=e.length;if(!r||n&&!n.l&&r<5)return t||new ne(0);var i=!t||n,s=!n||n.i;n||(n={}),t||(t=new ne(r*3));var a=function(k){var Ie=t.length;if(k>Ie){var rt=new ne(Math.max(Ie*2,k));rt.set(t),t=rt}},o=n.f||0,l=n.p||0,c=n.b||0,h=n.l,u=n.d,f=n.m,d=n.n,p=r*8;do{if(!h){n.f=o=ce(e,l,1);var x=ce(e,l+1,3);if(l+=3,x)if(x==1)h=Vr,u=Gr,f=9,d=5;else if(x==2){var A=ce(e,l,31)+257,T=ce(e,l+10,15)+4,w=A+ce(e,l+5,31)+1;l+=14;for(var R=new ne(w),B=new ne(19),y=0;y<T;++y)B[Pr[y]]=ce(e,l+y*3,7);l+=T*3;for(var C=vt(B),D=(1<<C)-1,m=ke(B,C,1),y=0;y<w;){var N=m[ce(e,l,D)];l+=N&15;var v=N>>>4;if(v<16)R[y++]=v;else{var O=0,F=0;for(v==16?(F=3+ce(e,l,3),l+=2,O=R[y-1]):v==17?(F=3+ce(e,l,7),l+=3):v==18&&(F=11+ce(e,l,127),l+=7);F--;)R[y++]=O}}var _=R.subarray(0,A),E=R.subarray(A);f=vt(_),d=vt(E),h=ke(_,f,1),u=ke(E,d,1)}else throw"invalid block type";else{var v=Kr(l)+4,g=e[v-4]|e[v-3]<<8,I=v+g;if(I>r){if(s)throw"unexpected EOF";break}i&&a(c+g),t.set(e.subarray(v,I),c),n.b=c+=g,n.p=l=I*8;continue}if(l>p){if(s)throw"unexpected EOF";break}}i&&a(c+131072);for(var $=(1<<f)-1,H=(1<<d)-1,Q=l;;Q=l){var O=h[xt(e,l)&$],J=O>>>4;if(l+=O&15,l>p){if(s)throw"unexpected EOF";break}if(!O)throw"invalid length/literal";if(J<256)t[c++]=J;else if(J==256){Q=l,h=null;break}else{var te=J-254;if(J>264){var y=J-257,pe=jt[y];te=ce(e,l,(1<<pe)-1)+Wt[y],l+=pe}var Ve=u[xt(e,l)&H],we=Ve>>>4;if(!Ve)throw"invalid distance";l+=Ve&15;var E=zr[we];if(we>3){var pe=$t[we];E+=xt(e,l)&(1<<pe)-1,l+=pe}if(l>p){if(s)throw"unexpected EOF";break}i&&a(c+131072);for(var ve=c+te;c<ve;c+=4)t[c]=t[c-E],t[c+1]=t[c+1-E],t[c+2]=t[c+2-E],t[c+3]=t[c+3-E];c=ve}}n.l=h,n.p=Q,n.b=c,h&&(o=1,n.m=f,n.d=u,n.n=d)}while(!o);return c==t.length?t:mt(t,0,c)};var Ca=new ne(0);var Fa=function(e,t){var n={};for(var r in e)n[r]=e[r];for(var r in t)n[r]=t[r];return n},$r=function(e,t,n){for(var r=e(),i=e.toString(),s=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/ /g,"").split(","),a=0;a<r.length;++a){var o=r[a],l=s[a];if(typeof o=="function"){t+=";"+l+"=";var c=o.toString();if(o.prototype)if(c.indexOf("[native code]")!=-1){var h=c.indexOf(" ",8)+1;t+=c.slice(h,c.indexOf("(",h))}else{t+=c;for(var u in o.prototype)t+=";"+l+".prototype."+u+"="+o.prototype[u].toString()}else t+=c}else n[l]=o}return[t,n]},_t=[],Oa=function(e){var t=[];for(var n in e)(e[n]instanceof ne||e[n]instanceof me||e[n]instanceof We)&&t.push((e[n]=new e[n].constructor(e[n])).buffer);return t},Na=function(e,t,n,r){var i;if(!_t[n]){for(var s="",a={},o=e.length-1,l=0;l<o;++l)i=$r(e[l],s,a),s=i[0],a=i[1];_t[n]=$r(e[o],s,a)}var c=Fa({},_t[n][1]);return Ia(_t[n][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",n,c,Oa(c),r)},Ba=function(){return[ne,me,We,jt,$t,Pr,Wt,zr,Vr,Gr,pt,ke,vt,ce,xt,Kr,mt,jr,Xt,Wr,Xr]};var Wr=function(e){return postMessage(e,[e.buffer])},Xr=function(e){return e&&e.size&&new ne(e.size)},Da=function(e,t,n,r,i,s){var a=Na(n,r,i,function(o,l){a.terminate(),s(o,l)});return a.postMessage([e,t],t.consume?[e.buffer]:[]),function(){a.terminate()}};var _e=function(e,t){return e[t]|e[t+1]<<8},he=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0},qt=function(e,t){return he(e,t)+he(e,t+4)*4294967296};function Pa(e,t,n){if(n||(n=t,t={}),typeof n!="function")throw"no callback";return Da(e,t,[Ba],function(r){return Wr(Xt(r.data[0],Xr(r.data[1])))},1,n)}function Xt(e,t){return jr(e,t)}var id=typeof TextEncoder!="undefined"&&new TextEncoder,Zt=typeof TextDecoder!="undefined"&&new TextDecoder,ka=0;try{Zt.decode(Ca,{stream:!0}),ka=1}catch(e){}var Ua=function(e){for(var t="",n=0;;){var r=e[n++],i=(r>127)+(r>223)+(r>239);if(n+i>e.length)return[t,mt(e,n-1)];i?i==3?(r=((r&15)<<18|(e[n++]&63)<<12|(e[n++]&63)<<6|e[n++]&63)-65536,t+=String.fromCharCode(55296|r>>10,56320|r&1023)):i&1?t+=String.fromCharCode((r&31)<<6|e[n++]&63):t+=String.fromCharCode((r&15)<<12|(e[n++]&63)<<6|e[n++]&63):t+=String.fromCharCode(r)}};function Ha(e,t){if(t){for(var n="",r=0;r<e.length;r+=16384)n+=String.fromCharCode.apply(null,e.subarray(r,r+16384));return n}else{if(Zt)return Zt.decode(e);var i=Ua(e),s=i[0],a=i[1];if(a.length)throw"invalid utf-8 data";return s}}var za=function(e,t){return t+30+_e(e,t+26)+_e(e,t+28)},Va=function(e,t,n){var r=_e(e,t+28),i=Ha(e.subarray(t+46,t+46+r),!(_e(e,t+8)&2048)),s=t+46+r,a=he(e,t+20),o=n&&a==4294967295?Ya(e,s):[a,he(e,t+24),he(e,t+42)],l=o[0],c=o[1],h=o[2];return[_e(e,t+10),l,c,i,s+_e(e,t+30)+_e(e,t+32),h]},Ya=function(e,t){for(;_e(e,t)!=1;t+=4+_e(e,t+2));return[qt(e,t+12),qt(e,t+4),qt(e,t+20)]};function Qt(e,t){if(typeof t!="function")throw"no callback";for(var n=[],r=function(){for(var f=0;f<n.length;++f)n[f]()},i={},s=e.length-22;he(e,s)!=101010256;--s)if(!s||e.length-s>65558){t("invalid zip file",null);return}var a=_e(e,s+8);a||t(null,{});var o=a,l=he(e,s+16),c=l==4294967295;if(c){if(s=he(e,s-12),he(e,s)!=101075792){t("invalid zip file",null);return}o=a=he(e,s+32),l=he(e,s+48)}for(var h=function(f){var d=Va(e,l,c),p=d[0],x=d[1],v=d[2],g=d[3],I=d[4],A=d[5],T=za(e,A);l=I;var w=function(B,y){B?(r(),t(B,null)):(i[g]=y,--a||t(null,i))};if(!p)w(null,mt(e,T,T+x));else if(p==8){var R=e.subarray(T,T+x);if(x<32e4)try{w(null,Xt(R,new ne(v)))}catch(B){w(B,null)}else n.push(Pa(R,{size:v},w))}else w("unknown compression type "+p,null)},u=0;u<o;++u)h(u);return r}var Ka=/^([_\w\d]+)\:\/\//,qr=5e3;async function ja(e,t,n,r,i=qr){let{cache:s,loadings:a}=e;if(t in s)return s[t];let o;if(t in a){if(o=a[t],o.active)return a[t].promise}else o=new Jt(i),a[t]=o;let l=[o.promise];return Ka.test(n)?l.push(Zr(e,n,i).then(c=>r(c)).then(c=>Ue(e,t,c))):l.push(fetch(n).then(c=>c.arrayBuffer()).then(c=>r(c)).then(c=>Ue(e,t,c))),await Promise.race(l)}function Ue(e,t,n){let{cache:r,loadings:i}=e;return r[t]=n,t in i&&(i[t].resolve(n),delete i[t]),n}function $a(e,t){let{cache:n,loadings:r}=e;t in r&&(r[t].reject(new Error("Stop loading to delete asset.")),delete r[t]),t in n&&delete n[t]}async function Zr(e,t,n=qr){let{cache:r,loadings:i}=e;if(t in r)return r[t];if(t in i)return i[t].promise;{let s=new Jt(n);return i[t]=s,s.promise}}function Wa(e,t){let{defaults:n}=e;for(let r of n)if(r.glob.test(t))return en(e,r.uri);return null}function en(e,t){return e.cache[t]}function Xa(e){return Object.keys(e.cache)}var Jt=class{constructor(t){this.active=!1,this._resolve=null,this._reject=null,this._reason=null,this._value=null,this._timeoutHandle=Number.isFinite(t)&&t>0?setTimeout(()=>{this.reject(`Asset loading exceeded timeout of ${t} ms.`)},t):null,this._promise=new Promise((n,r)=>{this._value?n(this._value):this._resolve=n,this._reason?r(this._reason):this._reject=r})}get promise(){return this._promise}resolve(t){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._resolve?this._resolve(t):this._value=t}reject(t){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._reject?this._reject(t):this._reason=t}},Te=class{constructor(t,n,r){this.uri=t,this.source=n,this.loader=r,this.store=null}get current(){return en(this.store,this.uri)}set current(t){Ue(this.store,this.uri,t)}get default(){return Wa(this.store,this.uri)}get loaded(){return Zr(this.store,this.uri)}async preload(t,n=void 0,r=void 0){return this.store=t,typeof r!="undefined"?Ue(t,this.uri,r):await ja(this.store,this.uri,this.source,this.loader,n),this}async unload(){return $a(this.store,this.uri),this.store=null,this}},qa=5e3,qe={cache:{},loadings:{},defaults:[]};async function Za(e,t=void 0){let n="raw://",i=await(await fetch(e)).arrayBuffer();await new Promise((s,a)=>{Qt(new Uint8Array(i),(o,l)=>{if(o)a(o);else{for(let[c,h]of Object.entries(l)){c=c.replaceAll("\\","/");let u=c.indexOf("/");u>=0&&(c=c.substring(u+1));let f=n+c;Ue(qe,f,h),t&&t(h,f,c)}s()}})})}async function Qa(e,t){let r=await(await fetch(e)).arrayBuffer();await new Promise((i,s)=>{Qt(new Uint8Array(r),(a,o)=>{if(a)s(a);else{for(let[l,c]of Object.entries(o))l=l.replaceAll("\\","/"),t(c,l);i()}})})}async function Ja(e,t=qa){let n=[];for(let r of e)n.push(r.preload(qe,t));await Promise.allSettled(n)}function eo(e,t){return Ue(qe,e,t)}function to(){return Xa(qe)}function Qr(e){return en(qe,e)}function no(e){return Qr(e)}var Et=Object.freeze({__proto__:null,loadAssetPackAsRaw:Za,loadAssetPack:Qa,loadAssetRefs:Ja,cache:eo,keys:to,current:Qr,get:no});var tn=Symbol("audioContext"),gt=class{static getAudioContext(){if(tn in this)return this[tn];{let t=new AudioContext;return ro(t),this[tn]=t,t}}constructor(t,n){this.audioContext=t,this.audioBuffer=n,this._playing=!1,this._started=!1,this._source=null,this.onAudioSourceEnded=this.onAudioSourceEnded.bind(this)}destroy(){this._source&&this._source.disconnect(),this._source=null,this._started=!1,this._playing=!1}onAudioSourceEnded(){this._playing=!1}play(t={}){let n=this.audioBuffer;if(!n)return;this._source&&this.destroy();let{pitch:r=void 0,gain:i=void 0,pan:s=void 0,loop:a=!1}=t,o=this.audioContext,l=o.createBufferSource();l.addEventListener("ended",this.onAudioSourceEnded),l.buffer=n,l.loop=a;let c=l;if(r&&(l.detune.value=r*100),i){let h=o.createGain();h.gain.value=i,c=c.connect(h)}if(s){let h=o.createStereoPanner();h.pan.value=s,c=c.connect(h)}c.connect(o.destination),l.start(),this._source=l,this._started=!0,this._playing=!0}pause(){this._source.stop(),this._playing=!1}isStarted(){return this._started}isPlaying(){return this._playing}isPaused(){return this._started&&!this._playing}};function ro(e){let t=()=>{e.state==="suspended"&&e.resume()};document.addEventListener("click",t)}async function nn(e,t){if(typeof e=="string"){let s=await(await fetch(e)).arrayBuffer();return nn(s,t)}else if(!(e instanceof ArrayBuffer||ArrayBuffer.isView(e)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let n=new Uint8Array(e);return await t.decodeAudioData(n)}async function Fe(e){let t=gt.getAudioContext(),n=await nn(e,t);return new gt(t,n)}var io={SoundStart:new Te("start","res/start.wav",Fe),SoundDead:new Te("dead","res/dead.wav",Fe),SoundPop:new Te("pop","res/boop.wav",Fe),SoundShoot:new Te("shoot","res/click.wav",Fe),SoundBoom:new Te("boom","res/boom.wav",Fe),BackgroundMusic:new Te("music","res/music.wav",Fe)};async function Jr(){await Et.loadAssetPack("res.pack",(e,t)=>Et.cache(t,e)),Et.loadAssetRefs(Object.values(io))}var rn=class{get polling(){return performance.now()-this._lastPollingTime<1e3}get value(){return 0}get size(){return this._size}constructor(t){this._size=t,this._lastPollingTime=Number.MIN_SAFE_INTEGER}resize(t){this._size=t}getState(t){throw new Error("Missing implementation.")}onUpdate(t,n,r){throw new Error("Missing implementation.")}onStatus(t,n){throw new Error("Missing implementation.")}onPoll(t){this._lastPollingTime=t}onBind(t,n={}){t>=this._size&&this.resize(t+1)}onUnbind(){this.resize(0)}},Ze=class extends rn{static createAxisBindingState(){return{value:0,delta:0,inverted:!1}}get delta(){return this._delta}get value(){return this._value}constructor(t=0){super(t);let n=new Array;for(let r=0;r<t;++r)n.push(this.constructor.createAxisBindingState());this._state=n,this._value=0,this._delta=0}resize(t){let n=this._state,r=n.length,i;if(t<=r)i=n.slice(0,t);else{i=n;for(let s=r;s<t;++s)i.push(this.constructor.createAxisBindingState())}this._state=i,super.resize(t)}getState(t){return this._state[t].value}onPoll(t){let n=this._state,r=0,i=0,s=n.length;for(let a=0;a<s;++a){let o=n[a];r+=o.value*(o.inverted?-1:1),i+=o.delta,n[a].delta=0}this._value=r,this._delta=i,super.onPoll(t)}onUpdate(t,n,r){typeof n=="undefined"?this.onAxisChange(t,r):this.onAxisMove(t,n,r)}onStatus(t,n){this.onAxisStatus(t,n)}onBind(t,n={}){super.onBind(t,n);let{inverted:r=!1}=n,i=this._state;i[t].inverted=r}onAxisMove(t,n,r){let i=this._state[t];i.value=n,i.delta+=r}onAxisChange(t,n){let r=this._state[t];r.value+=n,r.delta+=n}onAxisStatus(t,n){let r=this._state[t],i=r.value;r.value=n,r.delta=n-i}},so=241,ei=254,ao=239,Oe=1,sn=2,an=4,on=8,ln=16,At=class extends rn{get pressed(){return this._pressed}get repeated(){return this._repeated}get released(){return this._released}get down(){return this._down}get value(){return this._value}constructor(t=0){super(t);this._state=new Uint8Array(t),this._value=0,this._down=!1,this._pressed=!1,this._repeated=!1,this._released=!1}resize(t){let n=this._state,r=n.length,i;t<=r?i=n.slice(0,t):(i=new Uint8Array(t),i.set(n)),this._state=i,super.resize(t)}getState(t){let n=this._state[t],r=n&ln?-1:1;return(n&Oe?1:0)*r}onPoll(t){let n=this._state,r=0,i=0,s=0,a=0,o=0,l=n.length;for(let c=0;c<l;++c){let h=n[c],u=h&Oe,f=h&ln;i|=u,s|=h&sn,a|=h&an,o|=h&on,r+=(u?1:0)*(f?-1:1),n[c]&=so}this._value=r,this._down=i!==0,this._pressed=s!==0,this._repeated=a!==0,this._released=o!==0,super.onPoll(t)}onUpdate(t,n,r){r>0?this.onButtonPressed(t):this.onButtonReleased(t)}onStatus(t,n){this.onButtonStatus(t,n!==0)}onBind(t,n={}){super.onBind(t,n);let{inverted:r=!1}=n,i=this._state;r?i[t]|=ln:i[t]&=ao}onButtonPressed(t){let n=this._state,r=n[t];r&Oe||(r|=sn,r|=Oe),r|=an,n[t]=r}onButtonReleased(t){let n=this._state,r=n[t];r&Oe&&(r|=on,r&=ei),n[t]=r}onButtonStatus(t,n){let r=this._state,i=r[t],s=Boolean(i&Oe);n?i|=Oe:i&=ei,s&&!n&&(i|=on),!s&&n&&(i|=sn,i|=an),r[t]=i}},b=class{static parse(t){t=t.trim();let n=t.indexOf(".");if(n<0)throw new Error("Missing device separator for key code.");let r=t.substring(0,n);if(r.length<0)throw new Error("Missing device for key code.");let i=t.substring(n+1);if(i.length<0)throw new Error("Missing code for key code.");return new b(r,i)}constructor(t,n){this.device=t,this.code=n}toString(){return`${this.device}.${this.code}`}};function cn(e,t){return new b(e,t)}function oo(e){return"device"in e&&"code"in e}var L="Keyboard",ue="Mouse",lo=new b(L,"KeyA"),co=new b(L,"KeyB"),ho=new b(L,"KeyC"),uo=new b(L,"KeyD"),fo=new b(L,"KeyE"),po=new b(L,"KeyF"),vo=new b(L,"KeyG"),xo=new b(L,"KeyH"),mo=new b(L,"KeyI"),_o=new b(L,"KeyJ"),Eo=new b(L,"KeyK"),go=new b(L,"KeyL"),Ao=new b(L,"KeyM"),yo=new b(L,"KeyN"),Mo=new b(L,"KeyO"),wo=new b(L,"KeyP"),bo=new b(L,"KeyQ"),To=new b(L,"KeyR"),Ro=new b(L,"KeyS"),So=new b(L,"KeyT"),Io=new b(L,"KeyU"),Lo=new b(L,"KeyV"),Co=new b(L,"KeyW"),Fo=new b(L,"KeyX"),Oo=new b(L,"KeyY"),No=new b(L,"KeyZ"),Bo=new b(L,"Digit0"),Do=new b(L,"Digit1"),Po=new b(L,"Digit2"),ko=new b(L,"Digit3"),Uo=new b(L,"Digit4"),Ho=new b(L,"Digit5"),zo=new b(L,"Digit6"),Yo=new b(L,"Digit7"),Vo=new b(L,"Digit8"),Go=new b(L,"Digit9"),Ko=new b(L,"Minus"),jo=new b(L,"Equal"),$o=new b(L,"BracketLeft"),Wo=new b(L,"BracketRight"),Xo=new b(L,"Semicolon"),qo=new b(L,"Quote"),Zo=new b(L,"Backquote"),Qo=new b(L,"Backslash"),Jo=new b(L,"Comma"),el=new b(L,"Period"),tl=new b(L,"Slash"),nl=new b(L,"Escape"),rl=new b(L,"Space"),il=new b(L,"CapsLock"),sl=new b(L,"Backspace"),al=new b(L,"Delete"),ol=new b(L,"Tab"),ll=new b(L,"Enter"),cl=new b(L,"ArrowUp"),hl=new b(L,"ArrowDown"),ul=new b(L,"ArrowLeft"),fl=new b(L,"ArrowRight"),dl=new b(ue,"Button0"),pl=new b(ue,"Button1"),vl=new b(ue,"Button2"),xl=new b(ue,"Button3"),ml=new b(ue,"Button4"),_l=new b(ue,"PosX"),El=new b(ue,"PosY"),gl=new b(ue,"WheelX"),Al=new b(ue,"WheelY"),yl=new b(ue,"WheelZ"),q=Object.freeze({__proto__:null,from:cn,isKeyCode:oo,KEYBOARD:L,MOUSE:ue,KEY_A:lo,KEY_B:co,KEY_C:ho,KEY_D:uo,KEY_E:fo,KEY_F:po,KEY_G:vo,KEY_H:xo,KEY_I:mo,KEY_J:_o,KEY_K:Eo,KEY_L:go,KEY_M:Ao,KEY_N:yo,KEY_O:Mo,KEY_P:wo,KEY_Q:bo,KEY_R:To,KEY_S:Ro,KEY_T:So,KEY_U:Io,KEY_V:Lo,KEY_W:Co,KEY_X:Fo,KEY_Y:Oo,KEY_Z:No,DIGIT_0:Bo,DIGIT_1:Do,DIGIT_2:Po,DIGIT_3:ko,DIGIT_4:Uo,DIGIT_5:Ho,DIGIT_6:zo,DIGIT_7:Yo,DIGIT_8:Vo,DIGIT_9:Go,MINUS:Ko,EQUAL:jo,BRACKET_LEFT:$o,BRACKET_RIGHT:Wo,SEMICOLON:Xo,QUOTE:qo,BACKQUOTE:Zo,BACKSLASH:Qo,COMMA:Jo,PERIOD:el,SLASH:tl,ESCAPE:nl,SPACE:rl,CAPS_LOCK:il,BACKSPACE:sl,DELETE:al,TAB:ol,ENTER:ll,ARROW_UP:cl,ARROW_DOWN:hl,ARROW_LEFT:ul,ARROW_RIGHT:fl,MOUSE_BUTTON_0:dl,MOUSE_BUTTON_1:pl,MOUSE_BUTTON_2:vl,MOUSE_BUTTON_3:xl,MOUSE_BUTTON_4:ml,MOUSE_POS_X:_l,MOUSE_POS_Y:El,MOUSE_WHEEL_X:gl,MOUSE_WHEEL_Y:Al,MOUSE_WHEEL_Z:yl}),hn=class{get polling(){return this.ref?this.ref.polling:!1}get value(){return!this.ref||this.disabled?0:this.ref.value}constructor(t){this.name=t,this.ref=null,this.disabled=!1}register(t){throw new Error("Unsupported operation.")}disable(t=!0){return this.disabled=t,this}getState(t){return!this.ref||this.disabled?0:this.ref.getState(t)}};function ti(e){Array.isArray(e)||(e=[e]);let t=[];for(let n of e){let r;try{r=b.parse(n)}catch(i){let s=Ml(n).toUpperCase();if(!(s in q))throw new Error("Invalid key code string - "+i);r=q[s]}t.push(r)}return t}function Ml(e){return e.replace(/([a-z]|(?:[A-Z0-9]+))([A-Z0-9]|$)/g,function(t,n,r){return n+(r&&"_"+r)}).toLowerCase()}var Ne=class extends hn{static fromBind(t,n,r,i=void 0){return new Ne(t,cn(n,r),i)}static fromString(t,...n){let r=ti(n);return new Ne(t,r)}get delta(){return!this.ref||this.disabled?0:this.ref.delta}constructor(t,n,r=void 0){super(t);this.keyCodes=Array.isArray(n)?n:[n],this.opts=r}register(t){let n=this.name,r=this.opts;for(let i of this.keyCodes)t.bindAxis(n,i.device,i.code,r);return this.ref=t.getAxis(n),this}},se=class extends hn{static fromBind(t,n,r,i=void 0){return new se(t,cn(n,r),i)}static fromString(t,...n){let r=ti(n);return new se(t,r)}get pressed(){return!this.ref||this.disabled?!1:this.ref.pressed}get repeated(){return!this.ref||this.disabled?!1:this.ref.repeated}get released(){return!this.ref||this.disabled?!1:this.ref.released}get down(){return!this.ref||this.disabled?!1:this.ref.down}constructor(t,n,r=void 0){super(t);this.keyCodes=Array.isArray(n)?n:[n],this.opts=r}register(t){let n=this.name,r=this.opts;for(let i of this.keyCodes)t.bindButton(n,i.device,i.code,r);return this.ref=t.getButton(n),this}};var un=class{static isAxis(t){return!1}static isButton(t){return!1}constructor(t,n){if(!n)throw new Error(`Missing event target for device ${t}.`);this.name=t,this.eventTarget=n,this.listeners={input:[]}}setEventTarget(t){if(!t)throw new Error(`Missing event target for device ${this.name}.`);this.eventTarget=t}destroy(){let t=this.listeners;for(let n in t)t[n].length=0}addEventListener(t,n){let r=this.listeners;t in r?r[t].push(n):r[t]=[n]}removeEventListener(t,n){let r=this.listeners;if(t in r){let i=r[t],s=i.indexOf(n);s>=0&&i.splice(s,1)}}dispatchInputEvent(t){let n=0;for(let r of this.listeners.input)n|=r(t);return Boolean(n)}},ni=class extends un{static isAxis(t){return!1}static isButton(t){return!0}constructor(t,n,r={}){super(t,n);let{ignoreRepeat:i=!0}=r;this.ignoreRepeat=i,this._eventObject={target:n,device:t,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),n.addEventListener("keydown",this.onKeyDown),n.addEventListener("keyup",this.onKeyUp)}setEventTarget(t){this.eventTarget&&this.destroy(),super.setEventTarget(t),t.addEventListener("keydown",this.onKeyDown),t.addEventListener("keyup",this.onKeyUp)}destroy(){let t=this.eventTarget;t.removeEventListener("keydown",this.onKeyDown),t.removeEventListener("keyup",this.onKeyUp),super.destroy()}onKeyDown(t){if(t.repeat&&this.ignoreRepeat)return t.preventDefault(),t.stopPropagation(),!1;let n=this._eventObject;if(n.code=t.code,n.event="pressed",n.value=1,n.control=t.ctrlKey,n.shift=t.shiftKey,n.alt=t.altKey,this.dispatchInputEvent(n))return t.preventDefault(),t.stopPropagation(),!1}onKeyUp(t){let n=this._eventObject;if(n.code=t.code,n.event="released",n.value=1,n.control=t.ctrlKey,n.shift=t.shiftKey,n.alt=t.altKey,this.dispatchInputEvent(n))return t.preventDefault(),t.stopPropagation(),!1}},fn=10,dn=100,ri=class extends un{static isAxis(t){return t==="PosX"||t==="PosY"||t==="WheelX"||t==="WheelY"||t==="WheelZ"}static isButton(t){return!this.isAxis(t)}constructor(t,n,r={}){super(t,n);let{eventsOnFocus:i=!0}=r;this.eventsOnFocus=i,this.canvasTarget=this.getCanvasFromEventTarget(n),this._downHasFocus=!1,this._eventObject={target:n,device:t,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this._positionObject={target:n,device:t,code:"",event:"move",value:0,movement:0},this._wheelObject={target:n,device:t,code:"",event:"wheel",movement:0},this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onWheel=this.onWheel.bind(this),n.addEventListener("mousedown",this.onMouseDown),n.addEventListener("contextmenu",this.onContextMenu),n.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}setEventTarget(t){this.eventTarget&&this.destroy(),super.setEventTarget(t),this.canvasTarget=this.getCanvasFromEventTarget(t),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("contextmenu",this.onContextMenu),t.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}destroy(){let t=this.eventTarget;t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("contextmenu",this.onContextMenu),t.removeEventListener("wheel",this.onWheel),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),super.destroy()}setPointerLock(t=!0){t?this.eventTarget.requestPointerLock():this.eventTarget.exitPointerLock()}hasPointerLock(){return document.pointerLockElement===this.eventTarget}onMouseDown(t){this._downHasFocus=!0;let n=this._eventObject;if(n.code="Button"+t.button,n.event="pressed",n.value=1,n.control=t.ctrlKey,n.shift=t.shiftKey,n.alt=t.altKey,this.dispatchInputEvent(n)&&document.activeElement===this.eventTarget)return t.preventDefault(),t.stopPropagation(),!1}onContextMenu(t){return t.preventDefault(),t.stopPropagation(),!1}onWheel(t){let n,r,i;switch(t.deltaMode){case WheelEvent.DOM_DELTA_LINE:n=t.deltaX*fn,r=t.deltaY*fn,i=t.deltaZ*fn;break;case WheelEvent.DOM_DELTA_PAGE:n=t.deltaX*dn,r=t.deltaY*dn,i=t.deltaZ*dn;break;case WheelEvent.DOM_DELTA_PIXEL:default:n=t.deltaX,r=t.deltaY,i=t.deltaZ;break}let s=0,a=this._wheelObject;if(a.code="WheelX",a.movement=n,s|=this.dispatchInputEvent(a),a.code="WheelY",a.movement=r,s|=this.dispatchInputEvent(a),a.code="WheelZ",a.movement=i,s|=this.dispatchInputEvent(a),s)return t.preventDefault(),t.stopPropagation(),!1}onMouseUp(t){if(!this._downHasFocus)return;this._downHasFocus=!1;let n=this._eventObject;if(n.code="Button"+t.button,n.event="released",n.value=1,n.control=t.ctrlKey,n.shift=t.shiftKey,n.alt=t.altKey,this.dispatchInputEvent(n))return t.preventDefault(),t.stopPropagation(),!1}onMouseMove(t){if(this.eventsOnFocus&&document.activeElement!==this.eventTarget)return;let n=this.canvasTarget,{clientWidth:r,clientHeight:i}=n,s=n.getBoundingClientRect(),a=t.movementX/r,o=t.movementY/i,l=(t.clientX-s.left)/r,c=(t.clientY-s.top)/i,h=this._positionObject;h.code="PosX",h.value=l,h.movement=a,this.dispatchInputEvent(h),h.code="PosY",h.value=c,h.movement=o,this.dispatchInputEvent(h)}getCanvasFromEventTarget(t){return t instanceof HTMLCanvasElement?t:t.canvas||t.querySelector("canvas")||t.shadowRoot&&t.shadowRoot.querySelector("canvas")||t}},wl=`<kbd>
  <span id="name"><slot></slot></span>
  <span id="value" class="hidden"></span>
</kbd>
`,bl=`kbd {
  position: relative;
  display: inline-block;
  border-radius: 3px;
  border: 1px solid #888888;
  font-size: 0.85em;
  font-weight: 700;
  text-rendering: optimizeLegibility;
  line-height: 12px;
  height: 14px;
  padding: 2px 4px;
  color: #444444;
  background-color: #eeeeee;
  box-shadow: inset 0 -3px 0 #aaaaaa;
  overflow: hidden;
}

kbd:empty::after {
  content: '<?>';
  opacity: 0.6;
}

.disabled {
  opacity: 0.6;
  box-shadow: none;
  background-color: #aaaaaa;
}

.hidden {
  display: none;
}

#value {
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  font-size: 0.85em;
  padding: 0 4px;
  padding-top: 2px;
  color: #cccccc;
  background-color: #333333;
  box-shadow: inset 0 3px 0 #222222;
}
`,pn=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=wl,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=bl,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("input-code",this)}static get observedAttributes(){return["name","value","disabled"]}get disabled(){return this._disabled}set disabled(t){this.toggleAttribute("disabled",t)}get value(){return this._value}set value(t){this.setAttribute("value",t)}get name(){return this._name}set name(t){this.setAttribute("name",t)}constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._name="",this._value="",this._disabled=!1,this._kbdElement=this.shadowRoot.querySelector("kbd"),this._nameElement=this.shadowRoot.querySelector("#name"),this._valueElement=this.shadowRoot.querySelector("#value")}attributeChangedCallback(t,n,r){switch(t){case"name":this._name=r,this._nameElement.textContent=r;break;case"value":this._value=r,r!==null?(this._valueElement.classList.toggle("hidden",!1),this._valueElement.textContent=r,this._kbdElement.style.paddingRight=`${this._valueElement.clientWidth+4}px`):this._valueElement.classList.toggle("hidden",!0);break;case"disabled":this._disabled=r!==null,this._kbdElement.classList.toggle("disabled",r!==null);break}}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"name")){let t=this.name;delete this.name,this.name=t}if(Object.prototype.hasOwnProperty.call(this,"value")){let t=this.value;delete this.value,this.value=t}if(Object.prototype.hasOwnProperty.call(this,"disabled")){let t=this.disabled;delete this.disabled,this.disabled=t}}};pn.define();var Tl=`<table>
  <thead>
    <tr class="tableHeader">
      <th colspan="3">
        <span class="tableTitle">
          <label id="title"> input-source </label>
          <span id="slotContainer">
            <slot></slot>
          </span>
          <p>
            <label for="poll">poll</label>
            <output id="poll"></output>
          </p>
          <p>
            <label for="focus">focus</label>
            <output id="focus"></output>
          </p>
        </span>
      </th>
    </tr>
    <tr class="colHeader">
      <th>name</th>
      <th>value</th>
      <th>key</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
`,Rl=`:host {
  display: block;
}

table {
  border-collapse: collapse;
  font-family: monospace;
}

table,
th,
td {
  border: 1px solid #666666;
}

th,
td {
  padding: 5px 10px;
}

td {
  text-align: center;
}

thead th {
  padding: 0;
}

.colHeader > th {
  font-size: 0.8em;
  padding: 0 10px;
  letter-spacing: 3px;
  background-color: #aaaaaa;
  color: #666666;
}

tbody output {
  border-radius: 0.3em;
  padding: 3px;
}

tr:not(.primary) .name,
tr:not(.primary) .value {
  opacity: 0.3;
}

tr:nth-child(2n) {
  background-color: #eeeeee;
}

.tableHeader {
  color: #666666;
}

.tableTitle {
  display: flex;
  flex-direction: row;
  align-items: center;
  padding: 4px;
}

#slotContainer {
  flex: 1;
}

p {
  display: inline;
  margin: 0;
  padding: 0;
  padding-right: 10px;
}

#poll:empty::after,
#focus:empty::after {
  content: '\u2717';
  color: #ff0000;
}
`,ii=class{constructor(t){this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null,this.pollable=t}get running(){return this.animationFrameHandle!==null}start(){let t=this.animationFrameHandle;t&&cancelAnimationFrame(t),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}stop(){let t=this.animationFrameHandle;t&&cancelAnimationFrame(t),this.animationFrameHandle=null}onAnimationFrame(t){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.pollable.onPoll(t)}},si=class{constructor(t){this.onInput=this.onInput.bind(this),this.onPoll=this.onPoll.bind(this),this.bindings=t}onPoll(t){for(let n of this.bindings.getInputs())n.onPoll(t)}onInput(t){let{device:n,code:r,event:i,value:s,movement:a,control:o,shift:l,alt:c}=t,h=this.bindings.getBindings(n,r);switch(i){case"pressed":for(let{input:u,index:f}of h)u.onUpdate(f,1,1);break;case"released":for(let{input:u,index:f}of h)u.onUpdate(f,0,-1);break;case"move":for(let{input:u,index:f}of h)u.onUpdate(f,s,a);break;case"wheel":for(let{input:u,index:f}of h)u.onUpdate(f,void 0,a);break}return h.length>0}},vn=class{constructor(t,n,r,i){this.device=t,this.code=n,this.input=r,this.index=i}},ai=class{constructor(){this.bindingMap={},this.inputMap=new Map}clear(){for(let t of this.inputMap.keys())t.onUnbind();this.inputMap.clear(),this.bindingMap={}}bind(t,n,r,i={inverted:!1}){let s,a=this.inputMap;if(a.has(t)){let l=a.get(t),c=t.size;t.onBind(c,i),s=new vn(n,r,t,c),l.push(s)}else{let l=[];a.set(t,l);let c=0;t.onBind(c,i),s=new vn(n,r,t,c),l.push(s)}let o=this.bindingMap;n in o?r in o[n]?o[n][r].push(s):o[n][r]=[s]:o[n]={[r]:[s]}}unbind(t){let n=this.inputMap;if(n.has(t)){let r=this.bindingMap,i=n.get(t);for(let s of i){let{device:a,code:o}=s,l=r[a][o],c=l.indexOf(s);l.splice(c,1)}i.length=0,t.onUnbind(),n.delete(t)}}isBound(t){return this.inputMap.has(t)}getInputs(){return this.inputMap.keys()}getBindingsByInput(t){return this.inputMap.get(t)}getBindings(t,n){let r=this.bindingMap;if(t in r){let i=r[t];if(n in i)return i[n]}return[]}},oi=class{constructor(t,n={}){this.inputs={},this.devices=[new ri("Mouse",t),new ni("Keyboard",t)],this.bindings=new ai,this.adapter=new si(this.bindings),this.autopoller=new ii(this.adapter),this.eventTarget=t,this.anyButton=new At(1),this.anyButtonDevice="",this.anyButtonCode="",this.anyAxis=new Ze(1),this.anyAxisDevice="",this.anyAxisCode="",this.listeners={bind:[],unbind:[],focus:[],blur:[]},this.onInput=this.onInput.bind(this),this.onEventTargetBlur=this.onEventTargetBlur.bind(this),this.onEventTargetFocus=this.onEventTargetFocus.bind(this),t.addEventListener("focus",this.onEventTargetFocus),t.addEventListener("blur",this.onEventTargetBlur);for(let r of this.devices)r.addEventListener("input",this.onInput)}get autopoll(){return this.autopoller.running}set autopoll(t){this.toggleAutoPoll(t)}destroy(){let t=this.listeners;for(let r in t)t[r].length=0;this.autopoller.running&&this.autopoller.stop();for(let r of this.devices)r.removeEventListener("input",this.onInput),r.destroy();let n=this.eventTarget;n.removeEventListener("focus",this.onEventTargetFocus),n.removeEventListener("blur",this.onEventTargetBlur)}setEventTarget(t){let n=this.eventTarget;n.removeEventListener("focus",this.onEventTargetFocus),n.removeEventListener("blur",this.onEventTargetBlur),this.eventTarget=t;for(let r of this.devices)r.setEventTarget(t);t.addEventListener("focus",this.onEventTargetFocus),t.addEventListener("blur",this.onEventTargetBlur)}toggleAutoPoll(t=void 0){let n=this.autopoller.running,r=typeof t=="undefined"?!n:Boolean(t);r!==n&&(r?this.autopoller.start():this.autopoller.stop())}addEventListener(t,n){let r=this.listeners;t in r?r[t].push(n):r[t]=[n]}removeEventListener(t,n){let r=this.listeners;if(t in r){let i=r[t],s=i.indexOf(n);s>=0&&i.splice(s,1)}}dispatchEvent(t){let{type:n}=t,r=0;for(let i of this.listeners[n])r|=i(t)?1:0;return Boolean(r)}poll(t=performance.now()){if(this.autopoller.running)throw new Error("Should not manually poll() while autopolling.");this.onPoll(t)}onInput(t){let n=this.adapter.onInput(t);switch(t.event){case"pressed":this.anyButtonDevice=t.device,this.anyButtonCode=t.code,this.anyButton.onUpdate(0,1,1);break;case"released":this.anyButtonDevice=t.device,this.anyButtonCode=t.code,this.anyButton.onUpdate(0,0,-1);break;case"move":case"wheel":this.anyAxisDevice=t.device,this.anyAxisCode=t.code,this.anyAxis.onUpdate(0,t.value,t.movement);break}return n}onPoll(t){this.adapter.onPoll(t),this.anyButton.onPoll(t),this.anyAxis.onPoll(t)}onBind(){this.dispatchEvent({type:"bind"})}onUnbind(){this.dispatchEvent({type:"unbind"})}onEventTargetFocus(){this.dispatchEvent({type:"focus"})}onEventTargetBlur(){for(let t of this.bindings.getInputs())t.onStatus(0,0);this.anyButton.onStatus(0,0),this.anyAxis.onStatus(0,0),this.dispatchEvent({type:"blur"})}bindBindings(t){for(let n of t)n.register(this)}bindButton(t,n,r,i=void 0){let s;this.hasButton(t)?s=this.getButton(t):(s=new At(1),this.inputs[t]=s),this.bindings.bind(s,n,r,i),this.onBind()}bindAxis(t,n,r,i=void 0){let s;this.hasAxis(t)?s=this.getAxis(t):(s=new Ze(1),this.inputs[t]=s),this.bindings.bind(s,n,r,i),this.onBind()}bindAxisButtons(t,n,r,i){let s;this.hasAxis(t)?s=this.getAxis(t):(s=new Ze(2),this.inputs[t]=s),this.bindings.bind(s,n,i),this.bindings.bind(s,n,r,{inverted:!0}),this.onBind()}unbindButton(t){if(this.hasButton(t)){let n=this.getButton(t);delete this.inputs[t],this.bindings.unbind(n),this.onUnbind()}}unbindAxis(t){if(this.hasAxis(t)){let n=this.getAxis(t);delete this.inputs[t],this.bindings.unbind(n),this.onUnbind()}}getInput(t){return this.inputs[t]}getButton(t){return this.inputs[t]}getAxis(t){return this.inputs[t]}hasButton(t){return t in this.inputs&&this.inputs[t]instanceof At}hasAxis(t){return t in this.inputs&&this.inputs[t]instanceof Ze}isButtonDown(t){return this.inputs[t].down}isButtonPressed(t){return this.inputs[t].pressed}isButtonReleased(t){return this.inputs[t].released}getInputValue(t){return this.inputs[t].value}getButtonValue(t){return this.inputs[t].value}getAxisValue(t){return this.inputs[t].value}getAxisDelta(t){return this.inputs[t].delta}isAnyButtonDown(t=void 0){if(typeof t=="undefined")return this.anyButton.down;{let n=this.inputs;for(let r of t)if(n[r].down)return!0}return!1}isAnyButtonPressed(t=void 0){if(typeof t=="undefined")return this.anyButton.pressed;{let n=this.inputs;for(let r of t)if(n[r].pressed)return!0}return!1}isAnyButtonReleased(t=void 0){if(typeof t=="undefined")return this.anyButton.released;{let n=this.inputs;for(let r of t)if(n[r].released)return!0}return!1}getAnyAxisValue(t=void 0){if(typeof t=="undefined")return this.anyAxis.value;{let n=this.inputs;for(let r of t){let i=n[r];if(i.value)return i.value}}return 0}getAnyAxisDelta(t=void 0){if(typeof t=="undefined")return this.anyAxis.delta;{let n=this.inputs;for(let r of t){let i=n[r];if(i.delta)return i.delta}}return 0}getLastButtonDevice(){return this.anyButtonDevice}getLastButtonCode(){return this.anyButtonCode}getLastAxisDevice(){return this.anyAxisDevice}getLastAxisCode(){return this.anyAxisCode}getMouse(){return this.devices[0]}getKeyboard(){return this.devices[1]}},li=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=Tl,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Rl,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("input-port",this)}static get observedAttributes(){return["autopoll","for"]}get autopoll(){return this._autopoll}set autopoll(t){this.toggleAttribute("autopoll",t)}get for(){return this._for}set for(t){this.setAttribute("for",t)}constructor(){super();let t=this.attachShadow({mode:"open"});t.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),t.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._titleElement=t.querySelector("#title"),this._pollElement=t.querySelector("#poll"),this._focusElement=t.querySelector("#focus"),this._bodyElement=t.querySelector("tbody"),this._outputElements={},this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null;let n=this;this._for="",this._eventTarget=n,this._autopoll=!1,this._context=null,this.onInputContextBind=this.onInputContextBind.bind(this),this.onInputContextUnbind=this.onInputContextUnbind.bind(this),this.onInputContextFocus=this.onInputContextFocus.bind(this),this.onInputContextBlur=this.onInputContextBlur.bind(this)}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"for")){let t=this.for;delete this.for,this.for=t}if(Object.prototype.hasOwnProperty.call(this,"autopoll")){let t=this.autopoll;delete this.autopoll,this.autopoll=t}this.updateTable(),this.updateTableValues(),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}disconnectedCallback(){let t=this._context;t&&(t.removeEventListener("bind",this.onInputContextBind),t.removeEventListener("unbind",this.onInputContextUnbind),t.removeEventListener("blur",this.onInputContextBlur),t.removeEventListener("focus",this.onInputContextFocus),t.destroy(),this._context=null)}attributeChangedCallback(t,n,r){switch(t){case"for":{this._for=r;let i,s;r?(i=document.getElementById(r),s=`${i.tagName.toLowerCase()}#${r}`):(i=this,s="input-port"),this._eventTarget=i,this._context&&this._context.setEventTarget(this._eventTarget),this._titleElement.innerHTML=`for ${s}`}break;case"autopoll":this._autopoll=r!==null,this._context&&this._context.toggleAutoPoll(this._autopoll);break}}onAnimationFrame(){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.updateTableValues(),this.updatePollStatus()}onInputContextBind(){return this.updateTable(),!0}onInputContextUnbind(){return this.updateTable(),!0}onInputContextFocus(){return this._focusElement.innerHTML="\u2713",!0}onInputContextBlur(){return this._focusElement.innerHTML="",!0}getContext(t="axisbutton",n=void 0){switch(t){case"axisbutton":if(!this._context){let r=new oi(this._eventTarget,n);r.addEventListener("bind",this.onInputContextBind),r.addEventListener("unbind",this.onInputContextUnbind),r.addEventListener("blur",this.onInputContextBlur),r.addEventListener("focus",this.onInputContextFocus),this._autopoll&&r.toggleAutoPoll(!0),this._context=r}return this._context;default:throw new Error(`Input context id '${t}' is not supported.`)}}updateTable(){if(this.isConnected)if(this._context){let t=this._context,n=t.inputs,r=t.bindings,i={},s=[];for(let a of Object.keys(n)){let o=n[a],l=!0;for(let c of r.getBindingsByInput(o)){let h=Sl(`${o.constructor.name}.${a}`,`${c.device}.${c.code}`,0,l);s.push(h),l&&(i[a]=h.querySelector("output"),l=!1)}}this._outputElements=i,this._bodyElement.innerHTML="";for(let a of s)this._bodyElement.appendChild(a)}else{this._outputElements={},this._bodyElement.innerHTML="";return}else return}updateTableValues(){if(this.isConnected)if(this._context){let n=this._context.inputs;for(let r of Object.keys(this._outputElements)){let i=this._outputElements[r],s=n[r].value;i.innerText=Number(s).toFixed(2)}}else{for(let t of Object.keys(this._outputElements)){let n=this._outputElements[t];n.innerText="---"}return}else return}updatePollStatus(){if(this.isConnected)if(this._context){let n=this._context.inputs;for(let r of Object.values(n))if(!r.polling){this._pollElement.innerHTML="";return}this._pollElement.innerHTML="\u2713"}else{this._pollElement.innerHTML="-";return}else return}};li.define();function Sl(e,t,n,r=!0){let i=document.createElement("tr");r&&i.classList.add("primary");{let s=document.createElement("td");s.textContent=e,s.classList.add("name"),i.appendChild(s)}{let s=document.createElement("td"),a=document.createElement("output");r?a.innerText=Number(n).toFixed(2):a.innerText="---",a.classList.add("value"),s.appendChild(a),i.appendChild(s)}{let s=document.createElement("td");s.classList.add("key");let a=new pn;a.innerText=t,s.appendChild(a),i.appendChild(s)}return i}var xd=Symbol("keyboardSource");var md=Symbol("mouseSource");var ye={CursorX:new Ne("cursorX",[q.MOUSE_POS_X]),CursorY:new Ne("cursorY",[q.MOUSE_POS_Y]),CursorMain:new se("cursorMain",q.MOUSE_BUTTON_0),CursorAlt:new se("cursorAlt",q.MOUSE_BUTTON_2),MoveLeft:new se("moveLeft",[q.KEY_A,q.ARROW_LEFT]),MoveRight:new se("moveRight",[q.KEY_D,q.ARROW_RIGHT]),MoveUp:new se("moveUp",[q.KEY_W,q.ARROW_UP]),MoveDown:new se("moveDown",[q.KEY_S,q.ARROW_DOWN]),MainAction:new se("mainAction",[q.KEY_Z,q.KEY_Q]),AltAction:new se("altAction",[q.KEY_X,q.KEY_E]),Evade:new se("evade",[q.SPACE])};async function ci(){let t=document.querySelector("input-port").getContext("axisbutton");return t.bindBindings(Object.values(ye)),t}var xn=class{constructor(t){this.name=Symbol(this.constructor.name),this.initCallback=t}resolve(t){if(this.name in t)return t[this.name];{let n=this.initCallback();return t[this.name]=n,n}}get(t){return t[this.name]}};function fe(e){return typeof WebGL2RenderingContext!="undefined"&&e instanceof WebGL2RenderingContext}var mn=class{constructor(t,n){this.gl=t,this.target=n}data(t,n=void 0){let r=this.gl,i=this.target;if(typeof t=="number")r.bufferData(i,t,n||r.STATIC_DRAW);else{if(!ArrayBuffer.isView(t))throw new Error("Source data must be a typed array.");r.bufferData(i,t,n||r.STATIC_DRAW)}return this}subData(t,n=0,r=void 0,i=void 0){let s=this.gl,a=this.target;if(ArrayBuffer.isView(t))if(typeof r!="undefined")if(fe(s))s.bufferSubData(a,n,t,r,i);else{let o=i?t.subarray(r,r+i):t.subarray(r);s.bufferSubData(a,n,o)}else s.bufferSubData(a,n,t);else throw new Error("Source data must be a typed array.");return this}},hi=class{constructor(t,n,r=void 0){this.dataContext=new mn(t,n),this.handle=r||t.createBuffer(),t.bindBuffer(n,this.handle)}get gl(){return this.dataContext.gl}get target(){return this.dataContext.target}data(t,n=void 0){return this.dataContext.data(t,n),this}subData(t,n=0,r=void 0,i=void 0){return this.dataContext.subData(t,n,r,i),this}build(){return this.handle}},ui=class{constructor(t,n,r,i){this.gl=t,this.target=n,this.handle=i,this.type=r,this.bindContext=new mn(t,this.target)}bind(t){return t.bindBuffer(this.target,this.handle),this.bindContext.gl=t,this.bindContext}},Re={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,HALF_FLOAT:5131};function Il(e,t){let n=[],r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<r;++i){let s=e.getActiveUniform(t,i);if(!s)break;n.push(s)}return n}function Ll(e,t){let n=[],r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<r;++i){let s=e.getActiveAttrib(t,i);!s||n.push(s)}return n}function _n(e,t){switch(t){case e.FLOAT:case e.INT:case e.UNSIGNED_INT:case e.BOOL:return 1;case e.FLOAT_VEC2:case e.INT_VEC2:case e.BOOL_VEC2:return 2;case e.FLOAT_VEC3:case e.INT_VEC3:case e.BOOL_VEC3:return 3;case e.FLOAT_VEC4:case e.INT_VEC4:case e.BOOL_VEC4:return 4;case e.FLOAT_MAT2:return 4;case e.FLOAT_MAT3:return 9;case e.FLOAT_MAT4:return 16;default:throw new Error("Invalid vertex attribute type.")}}function Pl(e,t){switch(t){case e.FLOAT:case e.FLOAT_VEC2:case e.FLOAT_VEC3:case e.FLOAT_VEC4:return Cl}if(fe(e)){let n=e;switch(t){case e.INT:case e.INT_VEC2:case e.INT_VEC3:case e.INT_VEC4:case e.BOOL:case e.BOOL_VEC2:case e.BOOL_VEC3:case e.BOOL_VEC4:return Fl;case e.FLOAT_MAT2:return Nl;case e.FLOAT_MAT3:return Bl;case e.FLOAT_MAT4:return Dl;case n.UNSIGNED_INT:case n.UNSIGNED_INT_VEC2:case n.UNSIGNED_INT_VEC3:case n.UNSIGNED_INT_VEC4:return Ol}}throw new Error("Cannot find attribute function for gl enum.")}function Cl(e,t,n,r,i=!1,s=0,a=0,o=void 0){if(this.bindBuffer(this.ARRAY_BUFFER,t),this.enableVertexAttribArray(e),this.vertexAttribPointer(e,n,r,i,s,a),o!==void 0){if(!fe(this))throw new Error("Cannot use attribute divisor in WebGL 1.");this.vertexAttribDivisor(e,o)}}function Fl(e,t,n,r,i=!1,s=0,a=0,o=void 0){if(!fe(this))throw new Error("Cannot use attribute divisor in WebGL 1.");let l=this;l.bindBuffer(l.ARRAY_BUFFER,t),l.enableVertexAttribArray(e),l.vertexAttribIPointer(e,n,r,s,a),o!==void 0&&l.vertexAttribDivisor(e,o)}function Ol(e,t,n,r,i=!1,s=0,a=0,o=void 0){if(!fe(this))throw new Error("Cannot use attribute divisor in WebGL 1.");let l=this;l.bindBuffer(l.ARRAY_BUFFER,t),l.enableVertexAttribArray(e),l.vertexAttribIPointer(e,n,r,s,a),o!==void 0&&l.vertexAttribDivisor(e,o)}function Nl(e,t,n,r,i=!1,s=0,a=0,o=void 0){let l=_n(this,this.FLOAT_MAT2),c=l*l;En(c,l,e,t,n,r,i,s,a,o)}function Bl(e,t,n,r,i=!1,s=0,a=0,o=void 0){let l=_n(this,this.FLOAT_MAT3),c=l*l;En(c,l,e,t,n,r,i,s,a,o)}function Dl(e,t,n,r,i=!1,s=0,a=0,o=void 0){let l=_n(this,this.FLOAT_MAT4),c=l*l;En(c,l,e,t,n,r,i,s,a,o)}function En(e,t,n,r,i,s,a,o,l,c){if(!fe(this))throw new Error("Cannot use attribute divisor in WebGL 1.");let h=this;h.bindBuffer(h.ARRAY_BUFFER,r);let u=i/t,f=e*i,d=o/t;for(let p=0;p<t;++p){let x=n+p;h.enableVertexAttribArray(x),h.vertexAttribPointer(x,u,s,a,f,l+d*p),c!==void 0&&h.vertexAttribDivisor(x,c)}}function kl(e,t){let n={},r=Ll(e,t);for(let i of r){let s=i.name,a=i.size,o=i.type,l=e.getAttribLocation(t,s),c=Pl(e,o);n[s]={type:o,size:a,location:l,applier:c,set value([h,u,f,d,p,x,v]){this.applier(this.location,h,u,f,d,p,x,v)}}}return n}function Ul(e,t,n){let r=e.createShader(t);if(e.shaderSource(r,n),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS)){let s=e.getShaderInfoLog(r)+`
Failed to compile shader:
${n}`;throw e.deleteShader(r),new Error(s)}return r}async function Hl(e,t,n){for(let s of n)e.attachShader(t,s);e.linkProgram(t);let r=e.getExtension("KHR_parallel_shader_compile");if(r){let s=1e3/60,a;do await new Promise((o,l)=>setTimeout(o,s)),a=e.getProgramParameter(t,r.COMPLETION_STATUS_KHR);while(!a)}for(let s of n)e.detachShader(t,s),e.deleteShader(s);if(!e.getProgramParameter(t,e.LINK_STATUS)){let s=e.getProgramInfoLog(t);throw e.deleteProgram(t),new Error(s)}return t}function zl(e,t,n,r,i=void 0){i?(e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,i),e.drawElements(t,r,e.UNSIGNED_SHORT,n)):e.drawArrays(t,n,r)}function Zl(e,t){let n=e;switch(t){case n.FLOAT:return n.uniform1f;case n.FLOAT_VEC2:return n.uniform2fv;case n.FLOAT_VEC3:return n.uniform3fv;case n.FLOAT_VEC4:return n.uniform4fv;case n.INT:return n.uniform1i;case n.INT_VEC2:return n.uniform2iv;case n.INT_VEC3:return n.uniform3iv;case n.INT_VEC4:return n.uniform4iv;case n.BOOL:return n.uniform1i;case n.BOOL_VEC2:return n.uniform2iv;case n.BOOL_VEC3:return n.uniform3iv;case n.BOOL_VEC4:return n.uniform4iv;case n.FLOAT_MAT2:return Yl;case n.FLOAT_MAT3:return Vl;case n.FLOAT_MAT4:return Gl;case n.SAMPLER_2D:case n.SAMPLER_CUBE:return n.uniform1i}if(fe(e)){let r=e;switch(t){case r.UNSIGNED_INT:return r.uniform1ui;case r.UNSIGNED_INT_VEC2:return r.uniform2uiv;case r.UNSIGNED_INT_VEC3:return r.uniform3uiv;case r.UNSIGNED_INT_VEC4:return r.uniform4uiv;case r.FLOAT_MAT2x3:return Kl;case r.FLOAT_MAT2x4:return jl;case r.FLOAT_MAT3x2:return $l;case r.FLOAT_MAT3x4:return Wl;case r.FLOAT_MAT4x2:return Xl;case r.FLOAT_MAT4x3:return ql;case r.SAMPLER_3D:case r.SAMPLER_2D_SHADOW:case r.SAMPLER_2D_ARRAY:case r.SAMPLER_2D_ARRAY_SHADOW:case r.SAMPLER_CUBE_SHADOW:case r.INT_SAMPLER_2D:case r.INT_SAMPLER_3D:case r.INT_SAMPLER_CUBE:case r.INT_SAMPLER_2D_ARRAY:case r.UNSIGNED_INT_SAMPLER_2D:case r.UNSIGNED_INT_SAMPLER_3D:case r.UNSIGNED_INT_SAMPLER_CUBE:case r.UNSIGNED_INT_SAMPLER_2D_ARRAY:return r.uniform1i}}throw new Error("Cannot find uniform function for gl enum.")}function Yl(e,t){this.uniformMatrix2fv(e,!1,t)}function Vl(e,t){this.uniformMatrix3fv(e,!1,t)}function Gl(e,t){this.uniformMatrix4fv(e,!1,t)}function Kl(e,t){this.uniformMatrix2x3fv(e,!1,t)}function jl(e,t){this.uniformMatrix2x4fv(e,!1,t)}function $l(e,t){this.uniformMatrix3x2fv(e,!1,t)}function Wl(e,t){this.uniformMatrix3x4fv(e,!1,t)}function Xl(e,t){this.uniformMatrix4x2fv(e,!1,t)}function ql(e,t){this.uniformMatrix4x3fv(e,!1,t)}function Ql(e,t){let n={},r=Il(e,t);for(let i of r){let s=i.name,a=i.size,o=i.type,l=e.getUniformLocation(t,s),c=Zl(e,o);n[s]={type:o,size:a,location:l,applier:c,set value(h){this.applier.call(e,this.location,h)}}}return n}function Jl(e,t,n){if("handle"in n&&n.handle instanceof WebGLVertexArrayObject){if(!fe(e))throw new Error("Vertex array objects are only supported in WebGL 2.");let r=e,i=n;r.bindVertexArray(i.handle)}else{let r=n,i=t.attributes;for(let s in i){if(!(s in r.attributes))throw new Error(`Missing buffer for attribute '${s}'.`);let a=r.attributes[s],{location:o,applier:l}=i[a.name];l.call(e,o,a.buffer,a.size,a.type,a.normalize,a.stride,a.offset,a.divisor)}r.element&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r.element.buffer)}}function nc(e,t,n=void 0){let r=tc(e,t),i=ec(e,n),s;if(i)s=i.length;else{let a=Object.keys(r);if(a.length>0){let o=r[a[0]];s=Math.trunc(o.length/o.size)}else s=0}return{attributes:r,element:i,vertexCount:s}}function rc(e,t,n){if(!fe(e))throw new Error("Vertex array objects is only supported on WebGL2.");let r=e,i=r.createVertexArray();r.bindVertexArray(i);for(let s of n)Jl(r,s,t);return r.bindVertexArray(null),{handle:i,element:t.element,vertexCount:t.vertexCount}}function ic(e,t,n=e.TRIANGLES,r=0,i=t.vertexCount,s=void 0){let a=t.element;if(a){let o=a.type;if(s!==void 0){if(!fe(e))throw new Error("Instanced element drawing is only supported on WebGL2.");e.drawElementsInstanced(n,i,o,r,s)}else e.drawElements(n,i,o,r)}else if(s!==void 0){if(!fe(e))throw new Error("Instanced array drawing is only supported on WebGL2.");e.drawArraysInstanced(n,r,i,s)}else e.drawArrays(n,r,i)}function ec(e,t=void 0){if(!t)return null;if(typeof t!="object")throw new Error("Element attribute options must be an object.");let{type:n=e.UNSIGNED_SHORT,buffer:r,usage:i=e.STATIC_DRAW,length:s}=t;if(r instanceof WebGLBuffer)e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r);else if(ArrayBuffer.isView(r)){let a=r;r=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r),e.bufferData(e.ELEMENT_ARRAY_BUFFER,a,i),n===void 0&&(n=Qe(e,a)),s===void 0&&(s=a.length)}else if(Array.isArray(r)){let a=r;r=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(a),i),s===void 0&&(s=a.length)}else if(typeof r=="number"){let a=r;r=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r),e.bufferData(e.ELEMENT_ARRAY_BUFFER,a,i),s===void 0&&(s=a)}else throw new Error("Invalid buffer for element attribute options.");if(n===void 0&&(n=e.UNSIGNED_SHORT),s===void 0){let a=e.getBufferParameter(e.ELEMENT_ARRAY_BUFFER,e.BUFFER_SIZE);s=Math.trunc(a/yt(e,n))}return sc(r,n,s)}function tc(e,t){let n={};for(let r of Object.keys(t)){let i=t[r];if(!i)continue;if(typeof i!="object")throw new Error("Array attribute options must be an object.");let{name:s=r,buffer:a,size:o=3,type:l,normalize:c=!1,stride:h=0,offset:u=0,divisor:f=void 0,usage:d=e.STATIC_DRAW,length:p}=i;if(a instanceof WebGLBuffer)e.bindBuffer(e.ARRAY_BUFFER,a);else if(ArrayBuffer.isView(a)){let x=a;a=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,a),e.bufferData(e.ARRAY_BUFFER,x,d),l===void 0&&(l=Qe(e,x)),p===void 0&&(p=x.length)}else if(Array.isArray(a)){let x=a;l===void 0&&(l=e.FLOAT),p===void 0&&(p=x.length),a=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,a);let v=gn(e,l);e.bufferData(e.ARRAY_BUFFER,new v(x),d)}else if(typeof a=="number"){let x=a;a=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,a),e.bufferData(e.ARRAY_BUFFER,x,d),p===void 0&&(p=x)}else throw new Error("Invalid buffer for array attribute options.");if(l===void 0&&(l=e.FLOAT),p===void 0){let x=e.getBufferParameter(e.ARRAY_BUFFER,e.BUFFER_SIZE);p=Math.trunc(x/yt(e,l))}o===void 0&&(o=ac(s,p)),n[s]=oc(s,a,p,o,l,c,h,u,f)}return n}function ac(e,t){let n;if(e.includes("texcoord")?n=2:e.includes("color")?n=4:n=3,t%n!=0)throw new Error(`Could not determine vertex size - guessed ${n} but array length ${t} is not evenly divisible.`);return n}function sc(e,t,n){return{buffer:e,type:t,length:n}}function oc(e,t,n,r,i,s,a,o,l){return{name:e,buffer:t,length:n,size:r,type:i,normalize:s,stride:a,offset:o,divisor:l}}function lc(e,t,n){let r=gn(e,t);return new r(n)}function cc(e,t,n,r=e.STATIC_DRAW){if(!ArrayBuffer.isView(n))throw new Error("Source data must be a typed array.");let i=e.createBuffer();return e.bindBuffer(t,i),e.bufferData(t,n,r),i}function gn(e,t){switch(t){case e.BYTE:return Int8Array;case e.UNSIGNED_BYTE:return Uint8Array;case e.SHORT:return Int16Array;case e.UNSIGNED_SHORT:return Uint16Array;case e.INT:return Int32Array;case e.UNSIGNED_INT:return Uint32Array;case e.FLOAT:return Float32Array;default:throw new Error(`Cannot find valid typed array for buffer type '${t}'.`)}}function Qe(e,t){if(t instanceof Int8Array)return e.BYTE;if(t instanceof Uint8Array)return e.UNSIGNED_BYTE;if(t instanceof Int16Array)return e.SHORT;if(t instanceof Uint16Array)return e.UNSIGNED_SHORT;if(t instanceof Int32Array)return e.INT;if(t instanceof Uint32Array)return e.UNSIGNED_INT;if(t instanceof Float32Array)return e.FLOAT;throw new Error("Cannot find valid data type for buffer source.")}var hc={[Re.BYTE]:1,[Re.UNSIGNED_BYTE]:1,[Re.SHORT]:2,[Re.UNSIGNED_SHORT]:2,[Re.INT]:4,[Re.UNSIGNED_INT]:4,[Re.FLOAT]:4,[Re.HALF_FLOAT]:2};function yt(e,t){return hc[t]}function uc(e,t){switch(t){case Int8Array:return e.BYTE;case Uint8Array:return e.UNSIGNED_BYTE;case Int16Array:return e.SHORT;case Uint16Array:return e.UNSIGNED_SHORT;case Int32Array:return e.INT;case Uint32Array:return e.UNSIGNED_INT;case Float32Array:return e.FLOAT;default:throw new Error("Cannot find valid buffer type for typed array.")}}function fc(e,t,n){return e.bindBuffer(t,n),e.getBufferParameter(t,e.BUFFER_USAGE)}function fi(e,t,n){return e.bindBuffer(t,n),e.getBufferParameter(t,e.BUFFER_SIZE)}function dc(e,t,n,r){return Math.trunc(fi(e,t,n)/yt(e,r))}var Me=Object.freeze({__proto__:null,createBufferSource:lc,createBuffer:cc,getTypedArrayForBufferType:gn,getBufferTypeForBufferSource:Qe,getByteCountForBufferType:yt,getBufferTypeForTypedArray:uc,getBufferUsage:fc,getBufferByteCount:fi,getBufferLength:dc,createBufferInfo:nc,createVertexArrayInfo:rc,drawBufferInfo:ic}),Ee=class{constructor(t,n,r=void 0){this.bufferBuilder=new hi(t,n,r),this.bufferType=t.FLOAT}get gl(){return this.bufferBuilder.gl}get handle(){return this.bufferBuilder.handle}get target(){return this.bufferBuilder.target}data(t,n=void 0){return this.bufferBuilder.data(t,n),typeof t!="number"&&(this.bufferType=Qe(this.gl,t)),this}subData(t,n=void 0,r=void 0,i=void 0){return this.bufferBuilder.subData(t,n,r,i),this.bufferType=Qe(this.gl,t),this}build(){let t=this.bufferBuilder.build(),n=this.gl,r=this.target,i=this.bufferType;return new ui(n,r,i,t)}},di=class{constructor(t,n){this.handle=n,this.activeUniforms=Ql(t,n),this.activeAttributes=kl(t,n),this.drawContext=new pi(t,this)}bind(t){return t.useProgram(this.handle),this.drawContext.gl=t,this.drawContext}},pi=class{constructor(t,n){this.gl=t,this.parent=n}uniform(t,n){let r=this.parent.activeUniforms;if(t in r){let i=r[t],s=i.location;i.applier.call(this.gl,s,n)}return this}attribute(t,n,r,i=!1,s=0,a=0){let o=this.gl,l=this.parent.activeAttributes;if(t in l){let c=l[t],h=c.location,u=c.size;r?(o.bindBuffer(o.ARRAY_BUFFER,r),o.vertexAttribPointer(h,u,n,i,s,a),o.enableVertexAttribArray(h)):o.disableVertexAttribArray(h)}return this}draw(t,n,r,i,s=null){return zl(t,n,r,i,s),this.parent}},vi=class{constructor(t,n=void 0){this.handle=n||t.createProgram(),this.shaders=[],this.gl=t}shader(t,n){let r=this.gl,i=Ul(r,t,n);return this.shaders.push(i),this}link(){let t=this.gl;return Hl(t,this.handle,this.shaders),this.shaders.length=0,this.handle}},Be=class{constructor(t,n=void 0){this.programBuilder=new vi(t,n)}get gl(){return this.programBuilder.gl}get handle(){return this.programBuilder.handle}get shaders(){return this.programBuilder.shaders}shader(t,n){return this.programBuilder.shader(t,n),this}link(){let t=this.programBuilder.link();return new di(this.gl,t)}};var P=1e-6,V=typeof Float32Array!="undefined"?Float32Array:Array,ae=Math.random;var Md=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var Je={};Ce(Je,{add:()=>Dc,adjoint:()=>yc,clone:()=>vc,copy:()=>xc,create:()=>An,determinant:()=>Mc,equals:()=>Hc,exactEquals:()=>Uc,frob:()=>Bc,fromMat2d:()=>Lc,fromMat4:()=>pc,fromQuat:()=>Cc,fromRotation:()=>Sc,fromScaling:()=>Ic,fromTranslation:()=>Rc,fromValues:()=>mc,identity:()=>Ec,invert:()=>Ac,mul:()=>zc,multiply:()=>xi,multiplyScalar:()=>Pc,multiplyScalarAndAdd:()=>kc,normalFromMat4:()=>Fc,projection:()=>Oc,rotate:()=>bc,scale:()=>Tc,set:()=>_c,str:()=>Nc,sub:()=>Yc,subtract:()=>mi,translate:()=>wc,transpose:()=>gc});function An(){var e=new V(9);return V!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function pc(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function vc(e){var t=new V(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function xc(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function mc(e,t,n,r,i,s,a,o,l){var c=new V(9);return c[0]=e,c[1]=t,c[2]=n,c[3]=r,c[4]=i,c[5]=s,c[6]=a,c[7]=o,c[8]=l,c}function _c(e,t,n,r,i,s,a,o,l,c){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=s,e[5]=a,e[6]=o,e[7]=l,e[8]=c,e}function Ec(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function gc(e,t){if(e===t){var n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function Ac(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8],u=h*a-o*c,f=-h*s+o*l,d=c*s-a*l,p=n*u+r*f+i*d;return p?(p=1/p,e[0]=u*p,e[1]=(-h*r+i*c)*p,e[2]=(o*r-i*a)*p,e[3]=f*p,e[4]=(h*n-i*l)*p,e[5]=(-o*n+i*s)*p,e[6]=d*p,e[7]=(-c*n+r*l)*p,e[8]=(a*n-r*s)*p,e):null}function yc(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8];return e[0]=a*h-o*c,e[1]=i*c-r*h,e[2]=r*o-i*a,e[3]=o*l-s*h,e[4]=n*h-i*l,e[5]=i*s-n*o,e[6]=s*c-a*l,e[7]=r*l-n*c,e[8]=n*a-r*s,e}function Mc(e){var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8];return t*(c*s-a*l)+n*(-c*i+a*o)+r*(l*i-s*o)}function xi(e,t,n){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],u=t[8],f=n[0],d=n[1],p=n[2],x=n[3],v=n[4],g=n[5],I=n[6],A=n[7],T=n[8];return e[0]=f*r+d*a+p*c,e[1]=f*i+d*o+p*h,e[2]=f*s+d*l+p*u,e[3]=x*r+v*a+g*c,e[4]=x*i+v*o+g*h,e[5]=x*s+v*l+g*u,e[6]=I*r+A*a+T*c,e[7]=I*i+A*o+T*h,e[8]=I*s+A*l+T*u,e}function wc(e,t,n){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],u=t[8],f=n[0],d=n[1];return e[0]=r,e[1]=i,e[2]=s,e[3]=a,e[4]=o,e[5]=l,e[6]=f*r+d*a+c,e[7]=f*i+d*o+h,e[8]=f*s+d*l+u,e}function bc(e,t,n){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],u=t[8],f=Math.sin(n),d=Math.cos(n);return e[0]=d*r+f*a,e[1]=d*i+f*o,e[2]=d*s+f*l,e[3]=d*a-f*r,e[4]=d*o-f*i,e[5]=d*l-f*s,e[6]=c,e[7]=h,e[8]=u,e}function Tc(e,t,n){var r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Rc(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function Sc(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=-n,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Ic(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Lc(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function Cc(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=n+n,o=r+r,l=i+i,c=n*a,h=r*a,u=r*o,f=i*a,d=i*o,p=i*l,x=s*a,v=s*o,g=s*l;return e[0]=1-u-p,e[3]=h-g,e[6]=f+v,e[1]=h+g,e[4]=1-c-p,e[7]=d-x,e[2]=f-v,e[5]=d+x,e[8]=1-c-u,e}function Fc(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8],u=t[9],f=t[10],d=t[11],p=t[12],x=t[13],v=t[14],g=t[15],I=n*o-r*a,A=n*l-i*a,T=n*c-s*a,w=r*l-i*o,R=r*c-s*o,B=i*c-s*l,y=h*x-u*p,C=h*v-f*p,D=h*g-d*p,m=u*v-f*x,N=u*g-d*x,O=f*g-d*v,F=I*O-A*N+T*m+w*D-R*C+B*y;return F?(F=1/F,e[0]=(o*O-l*N+c*m)*F,e[1]=(l*D-a*O-c*C)*F,e[2]=(a*N-o*D+c*y)*F,e[3]=(i*N-r*O-s*m)*F,e[4]=(n*O-i*D+s*C)*F,e[5]=(r*D-n*N-s*y)*F,e[6]=(x*B-v*R+g*w)*F,e[7]=(v*T-p*B-g*A)*F,e[8]=(p*R-x*T+g*I)*F,e):null}function Oc(e,t,n){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/n,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function Nc(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function Bc(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}function Dc(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e}function mi(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e}function Pc(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e}function kc(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e}function Uc(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function Hc(e,t){var n=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],h=e[8],u=t[0],f=t[1],d=t[2],p=t[3],x=t[4],v=t[5],g=t[6],I=t[7],A=t[8];return Math.abs(n-u)<=P*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(r-f)<=P*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(i-d)<=P*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(s-p)<=P*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(a-x)<=P*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(o-v)<=P*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(l-g)<=P*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(c-I)<=P*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(h-A)<=P*Math.max(1,Math.abs(h),Math.abs(A))}var zc=xi,Yc=mi;var Y={};Ce(Y,{add:()=>wh,adjoint:()=>qc,clone:()=>Gc,copy:()=>Kc,create:()=>Vc,determinant:()=>Zc,equals:()=>Sh,exactEquals:()=>Rh,frob:()=>Mh,fromQuat:()=>vh,fromQuat2:()=>hh,fromRotation:()=>ah,fromRotationTranslation:()=>gi,fromRotationTranslationScale:()=>dh,fromRotationTranslationScaleOrigin:()=>ph,fromScaling:()=>sh,fromTranslation:()=>ih,fromValues:()=>jc,fromXRotation:()=>oh,fromYRotation:()=>lh,fromZRotation:()=>ch,frustum:()=>xh,getRotation:()=>fh,getScaling:()=>Ai,getTranslation:()=>uh,identity:()=>_i,invert:()=>Xc,lookAt:()=>gh,mul:()=>Ih,multiply:()=>Ei,multiplyScalar:()=>bh,multiplyScalarAndAdd:()=>Th,ortho:()=>Eh,perspective:()=>mh,perspectiveFromFieldOfView:()=>_h,rotate:()=>eh,rotateX:()=>th,rotateY:()=>nh,rotateZ:()=>rh,scale:()=>Jc,set:()=>$c,str:()=>yh,sub:()=>Lh,subtract:()=>yi,targetTo:()=>Ah,translate:()=>Qc,transpose:()=>Wc});function Vc(){var e=new V(16);return V!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function Gc(e){var t=new V(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Kc(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function jc(e,t,n,r,i,s,a,o,l,c,h,u,f,d,p,x){var v=new V(16);return v[0]=e,v[1]=t,v[2]=n,v[3]=r,v[4]=i,v[5]=s,v[6]=a,v[7]=o,v[8]=l,v[9]=c,v[10]=h,v[11]=u,v[12]=f,v[13]=d,v[14]=p,v[15]=x,v}function $c(e,t,n,r,i,s,a,o,l,c,h,u,f,d,p,x,v){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=s,e[5]=a,e[6]=o,e[7]=l,e[8]=c,e[9]=h,e[10]=u,e[11]=f,e[12]=d,e[13]=p,e[14]=x,e[15]=v,e}function _i(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Wc(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],s=t[6],a=t[7],o=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=s,e[11]=t[14],e[12]=i,e[13]=a,e[14]=o}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function Xc(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8],u=t[9],f=t[10],d=t[11],p=t[12],x=t[13],v=t[14],g=t[15],I=n*o-r*a,A=n*l-i*a,T=n*c-s*a,w=r*l-i*o,R=r*c-s*o,B=i*c-s*l,y=h*x-u*p,C=h*v-f*p,D=h*g-d*p,m=u*v-f*x,N=u*g-d*x,O=f*g-d*v,F=I*O-A*N+T*m+w*D-R*C+B*y;return F?(F=1/F,e[0]=(o*O-l*N+c*m)*F,e[1]=(i*N-r*O-s*m)*F,e[2]=(x*B-v*R+g*w)*F,e[3]=(f*R-u*B-d*w)*F,e[4]=(l*D-a*O-c*C)*F,e[5]=(n*O-i*D+s*C)*F,e[6]=(v*T-p*B-g*A)*F,e[7]=(h*B-f*T+d*A)*F,e[8]=(a*N-o*D+c*y)*F,e[9]=(r*D-n*N-s*y)*F,e[10]=(p*R-x*T+g*I)*F,e[11]=(u*T-h*R-d*I)*F,e[12]=(o*C-a*m-l*y)*F,e[13]=(n*m-r*C+i*y)*F,e[14]=(x*A-p*w-v*I)*F,e[15]=(h*w-u*A+f*I)*F,e):null}function qc(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8],u=t[9],f=t[10],d=t[11],p=t[12],x=t[13],v=t[14],g=t[15];return e[0]=o*(f*g-d*v)-u*(l*g-c*v)+x*(l*d-c*f),e[1]=-(r*(f*g-d*v)-u*(i*g-s*v)+x*(i*d-s*f)),e[2]=r*(l*g-c*v)-o*(i*g-s*v)+x*(i*c-s*l),e[3]=-(r*(l*d-c*f)-o*(i*d-s*f)+u*(i*c-s*l)),e[4]=-(a*(f*g-d*v)-h*(l*g-c*v)+p*(l*d-c*f)),e[5]=n*(f*g-d*v)-h*(i*g-s*v)+p*(i*d-s*f),e[6]=-(n*(l*g-c*v)-a*(i*g-s*v)+p*(i*c-s*l)),e[7]=n*(l*d-c*f)-a*(i*d-s*f)+h*(i*c-s*l),e[8]=a*(u*g-d*x)-h*(o*g-c*x)+p*(o*d-c*u),e[9]=-(n*(u*g-d*x)-h*(r*g-s*x)+p*(r*d-s*u)),e[10]=n*(o*g-c*x)-a*(r*g-s*x)+p*(r*c-s*o),e[11]=-(n*(o*d-c*u)-a*(r*d-s*u)+h*(r*c-s*o)),e[12]=-(a*(u*v-f*x)-h*(o*v-l*x)+p*(o*f-l*u)),e[13]=n*(u*v-f*x)-h*(r*v-i*x)+p*(r*f-i*u),e[14]=-(n*(o*v-l*x)-a*(r*v-i*x)+p*(r*l-i*o)),e[15]=n*(o*f-l*u)-a*(r*f-i*u)+h*(r*l-i*o),e}function Zc(e){var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],h=e[9],u=e[10],f=e[11],d=e[12],p=e[13],x=e[14],v=e[15],g=t*a-n*s,I=t*o-r*s,A=t*l-i*s,T=n*o-r*a,w=n*l-i*a,R=r*l-i*o,B=c*p-h*d,y=c*x-u*d,C=c*v-f*d,D=h*x-u*p,m=h*v-f*p,N=u*v-f*x;return g*N-I*m+A*D+T*C-w*y+R*B}function Ei(e,t,n){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],u=t[8],f=t[9],d=t[10],p=t[11],x=t[12],v=t[13],g=t[14],I=t[15],A=n[0],T=n[1],w=n[2],R=n[3];return e[0]=A*r+T*o+w*u+R*x,e[1]=A*i+T*l+w*f+R*v,e[2]=A*s+T*c+w*d+R*g,e[3]=A*a+T*h+w*p+R*I,A=n[4],T=n[5],w=n[6],R=n[7],e[4]=A*r+T*o+w*u+R*x,e[5]=A*i+T*l+w*f+R*v,e[6]=A*s+T*c+w*d+R*g,e[7]=A*a+T*h+w*p+R*I,A=n[8],T=n[9],w=n[10],R=n[11],e[8]=A*r+T*o+w*u+R*x,e[9]=A*i+T*l+w*f+R*v,e[10]=A*s+T*c+w*d+R*g,e[11]=A*a+T*h+w*p+R*I,A=n[12],T=n[13],w=n[14],R=n[15],e[12]=A*r+T*o+w*u+R*x,e[13]=A*i+T*l+w*f+R*v,e[14]=A*s+T*c+w*d+R*g,e[15]=A*a+T*h+w*p+R*I,e}function Qc(e,t,n){var r=n[0],i=n[1],s=n[2],a,o,l,c,h,u,f,d,p,x,v,g;return t===e?(e[12]=t[0]*r+t[4]*i+t[8]*s+t[12],e[13]=t[1]*r+t[5]*i+t[9]*s+t[13],e[14]=t[2]*r+t[6]*i+t[10]*s+t[14],e[15]=t[3]*r+t[7]*i+t[11]*s+t[15]):(a=t[0],o=t[1],l=t[2],c=t[3],h=t[4],u=t[5],f=t[6],d=t[7],p=t[8],x=t[9],v=t[10],g=t[11],e[0]=a,e[1]=o,e[2]=l,e[3]=c,e[4]=h,e[5]=u,e[6]=f,e[7]=d,e[8]=p,e[9]=x,e[10]=v,e[11]=g,e[12]=a*r+h*i+p*s+t[12],e[13]=o*r+u*i+x*s+t[13],e[14]=l*r+f*i+v*s+t[14],e[15]=c*r+d*i+g*s+t[15]),e}function Jc(e,t,n){var r=n[0],i=n[1],s=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function eh(e,t,n,r){var i=r[0],s=r[1],a=r[2],o=Math.hypot(i,s,a),l,c,h,u,f,d,p,x,v,g,I,A,T,w,R,B,y,C,D,m,N,O,F,_;return o<P?null:(o=1/o,i*=o,s*=o,a*=o,l=Math.sin(n),c=Math.cos(n),h=1-c,u=t[0],f=t[1],d=t[2],p=t[3],x=t[4],v=t[5],g=t[6],I=t[7],A=t[8],T=t[9],w=t[10],R=t[11],B=i*i*h+c,y=s*i*h+a*l,C=a*i*h-s*l,D=i*s*h-a*l,m=s*s*h+c,N=a*s*h+i*l,O=i*a*h+s*l,F=s*a*h-i*l,_=a*a*h+c,e[0]=u*B+x*y+A*C,e[1]=f*B+v*y+T*C,e[2]=d*B+g*y+w*C,e[3]=p*B+I*y+R*C,e[4]=u*D+x*m+A*N,e[5]=f*D+v*m+T*N,e[6]=d*D+g*m+w*N,e[7]=p*D+I*m+R*N,e[8]=u*O+x*F+A*_,e[9]=f*O+v*F+T*_,e[10]=d*O+g*F+w*_,e[11]=p*O+I*F+R*_,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function th(e,t,n){var r=Math.sin(n),i=Math.cos(n),s=t[4],a=t[5],o=t[6],l=t[7],c=t[8],h=t[9],u=t[10],f=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*i+c*r,e[5]=a*i+h*r,e[6]=o*i+u*r,e[7]=l*i+f*r,e[8]=c*i-s*r,e[9]=h*i-a*r,e[10]=u*i-o*r,e[11]=f*i-l*r,e}function nh(e,t,n){var r=Math.sin(n),i=Math.cos(n),s=t[0],a=t[1],o=t[2],l=t[3],c=t[8],h=t[9],u=t[10],f=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i-c*r,e[1]=a*i-h*r,e[2]=o*i-u*r,e[3]=l*i-f*r,e[8]=s*r+c*i,e[9]=a*r+h*i,e[10]=o*r+u*i,e[11]=l*r+f*i,e}function rh(e,t,n){var r=Math.sin(n),i=Math.cos(n),s=t[0],a=t[1],o=t[2],l=t[3],c=t[4],h=t[5],u=t[6],f=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i+c*r,e[1]=a*i+h*r,e[2]=o*i+u*r,e[3]=l*i+f*r,e[4]=c*i-s*r,e[5]=h*i-a*r,e[6]=u*i-o*r,e[7]=f*i-l*r,e}function ih(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function sh(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ah(e,t,n){var r=n[0],i=n[1],s=n[2],a=Math.hypot(r,i,s),o,l,c;return a<P?null:(a=1/a,r*=a,i*=a,s*=a,o=Math.sin(t),l=Math.cos(t),c=1-l,e[0]=r*r*c+l,e[1]=i*r*c+s*o,e[2]=s*r*c-i*o,e[3]=0,e[4]=r*i*c-s*o,e[5]=i*i*c+l,e[6]=s*i*c+r*o,e[7]=0,e[8]=r*s*c+i*o,e[9]=i*s*c-r*o,e[10]=s*s*c+l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function oh(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function lh(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ch(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function gi(e,t,n){var r=t[0],i=t[1],s=t[2],a=t[3],o=r+r,l=i+i,c=s+s,h=r*o,u=r*l,f=r*c,d=i*l,p=i*c,x=s*c,v=a*o,g=a*l,I=a*c;return e[0]=1-(d+x),e[1]=u+I,e[2]=f-g,e[3]=0,e[4]=u-I,e[5]=1-(h+x),e[6]=p+v,e[7]=0,e[8]=f+g,e[9]=p-v,e[10]=1-(h+d),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function hh(e,t){var n=new V(3),r=-t[0],i=-t[1],s=-t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],u=r*r+i*i+s*s+a*a;return u>0?(n[0]=(o*a+h*r+l*s-c*i)*2/u,n[1]=(l*a+h*i+c*r-o*s)*2/u,n[2]=(c*a+h*s+o*i-l*r)*2/u):(n[0]=(o*a+h*r+l*s-c*i)*2,n[1]=(l*a+h*i+c*r-o*s)*2,n[2]=(c*a+h*s+o*i-l*r)*2),gi(e,t,n),e}function uh(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Ai(e,t){var n=t[0],r=t[1],i=t[2],s=t[4],a=t[5],o=t[6],l=t[8],c=t[9],h=t[10];return e[0]=Math.hypot(n,r,i),e[1]=Math.hypot(s,a,o),e[2]=Math.hypot(l,c,h),e}function fh(e,t){var n=new V(3);Ai(n,t);var r=1/n[0],i=1/n[1],s=1/n[2],a=t[0]*r,o=t[1]*i,l=t[2]*s,c=t[4]*r,h=t[5]*i,u=t[6]*s,f=t[8]*r,d=t[9]*i,p=t[10]*s,x=a+h+p,v=0;return x>0?(v=Math.sqrt(x+1)*2,e[3]=.25*v,e[0]=(u-d)/v,e[1]=(f-l)/v,e[2]=(o-c)/v):a>h&&a>p?(v=Math.sqrt(1+a-h-p)*2,e[3]=(u-d)/v,e[0]=.25*v,e[1]=(o+c)/v,e[2]=(f+l)/v):h>p?(v=Math.sqrt(1+h-a-p)*2,e[3]=(f-l)/v,e[0]=(o+c)/v,e[1]=.25*v,e[2]=(u+d)/v):(v=Math.sqrt(1+p-a-h)*2,e[3]=(o-c)/v,e[0]=(f+l)/v,e[1]=(u+d)/v,e[2]=.25*v),e}function dh(e,t,n,r){var i=t[0],s=t[1],a=t[2],o=t[3],l=i+i,c=s+s,h=a+a,u=i*l,f=i*c,d=i*h,p=s*c,x=s*h,v=a*h,g=o*l,I=o*c,A=o*h,T=r[0],w=r[1],R=r[2];return e[0]=(1-(p+v))*T,e[1]=(f+A)*T,e[2]=(d-I)*T,e[3]=0,e[4]=(f-A)*w,e[5]=(1-(u+v))*w,e[6]=(x+g)*w,e[7]=0,e[8]=(d+I)*R,e[9]=(x-g)*R,e[10]=(1-(u+p))*R,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function ph(e,t,n,r,i){var s=t[0],a=t[1],o=t[2],l=t[3],c=s+s,h=a+a,u=o+o,f=s*c,d=s*h,p=s*u,x=a*h,v=a*u,g=o*u,I=l*c,A=l*h,T=l*u,w=r[0],R=r[1],B=r[2],y=i[0],C=i[1],D=i[2],m=(1-(x+g))*w,N=(d+T)*w,O=(p-A)*w,F=(d-T)*R,_=(1-(f+g))*R,E=(v+I)*R,$=(p+A)*B,H=(v-I)*B,Q=(1-(f+x))*B;return e[0]=m,e[1]=N,e[2]=O,e[3]=0,e[4]=F,e[5]=_,e[6]=E,e[7]=0,e[8]=$,e[9]=H,e[10]=Q,e[11]=0,e[12]=n[0]+y-(m*y+F*C+$*D),e[13]=n[1]+C-(N*y+_*C+H*D),e[14]=n[2]+D-(O*y+E*C+Q*D),e[15]=1,e}function vh(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=n+n,o=r+r,l=i+i,c=n*a,h=r*a,u=r*o,f=i*a,d=i*o,p=i*l,x=s*a,v=s*o,g=s*l;return e[0]=1-u-p,e[1]=h+g,e[2]=f-v,e[3]=0,e[4]=h-g,e[5]=1-c-p,e[6]=d+x,e[7]=0,e[8]=f+v,e[9]=d-x,e[10]=1-c-u,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function xh(e,t,n,r,i,s,a){var o=1/(n-t),l=1/(i-r),c=1/(s-a);return e[0]=s*2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s*2*l,e[6]=0,e[7]=0,e[8]=(n+t)*o,e[9]=(i+r)*l,e[10]=(a+s)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*s*2*c,e[15]=0,e}function mh(e,t,n,r,i){var s=1/Math.tan(t/2),a;return e[0]=s/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==Infinity?(a=1/(r-i),e[10]=(i+r)*a,e[14]=2*i*r*a):(e[10]=-1,e[14]=-2*r),e}function _h(e,t,n,r){var i=Math.tan(t.upDegrees*Math.PI/180),s=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),o=Math.tan(t.rightDegrees*Math.PI/180),l=2/(a+o),c=2/(i+s);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-((a-o)*l*.5),e[9]=(i-s)*c*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e}function Eh(e,t,n,r,i,s,a){var o=1/(t-n),l=1/(r-i),c=1/(s-a);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*o,e[13]=(i+r)*l,e[14]=(a+s)*c,e[15]=1,e}function gh(e,t,n,r){var i,s,a,o,l,c,h,u,f,d,p=t[0],x=t[1],v=t[2],g=r[0],I=r[1],A=r[2],T=n[0],w=n[1],R=n[2];return Math.abs(p-T)<P&&Math.abs(x-w)<P&&Math.abs(v-R)<P?_i(e):(h=p-T,u=x-w,f=v-R,d=1/Math.hypot(h,u,f),h*=d,u*=d,f*=d,i=I*f-A*u,s=A*h-g*f,a=g*u-I*h,d=Math.hypot(i,s,a),d?(d=1/d,i*=d,s*=d,a*=d):(i=0,s=0,a=0),o=u*a-f*s,l=f*i-h*a,c=h*s-u*i,d=Math.hypot(o,l,c),d?(d=1/d,o*=d,l*=d,c*=d):(o=0,l=0,c=0),e[0]=i,e[1]=o,e[2]=h,e[3]=0,e[4]=s,e[5]=l,e[6]=u,e[7]=0,e[8]=a,e[9]=c,e[10]=f,e[11]=0,e[12]=-(i*p+s*x+a*v),e[13]=-(o*p+l*x+c*v),e[14]=-(h*p+u*x+f*v),e[15]=1,e)}function Ah(e,t,n,r){var i=t[0],s=t[1],a=t[2],o=r[0],l=r[1],c=r[2],h=i-n[0],u=s-n[1],f=a-n[2],d=h*h+u*u+f*f;d>0&&(d=1/Math.sqrt(d),h*=d,u*=d,f*=d);var p=l*f-c*u,x=c*h-o*f,v=o*u-l*h;return d=p*p+x*x+v*v,d>0&&(d=1/Math.sqrt(d),p*=d,x*=d,v*=d),e[0]=p,e[1]=x,e[2]=v,e[3]=0,e[4]=u*v-f*x,e[5]=f*p-h*v,e[6]=h*x-u*p,e[7]=0,e[8]=h,e[9]=u,e[10]=f,e[11]=0,e[12]=i,e[13]=s,e[14]=a,e[15]=1,e}function yh(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function Mh(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function wh(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e}function yi(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}function bh(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e}function Th(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e[9]=t[9]+n[9]*r,e[10]=t[10]+n[10]*r,e[11]=t[11]+n[11]*r,e[12]=t[12]+n[12]*r,e[13]=t[13]+n[13]*r,e[14]=t[14]+n[14]*r,e[15]=t[15]+n[15]*r,e}function Rh(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Sh(e,t){var n=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],h=e[8],u=e[9],f=e[10],d=e[11],p=e[12],x=e[13],v=e[14],g=e[15],I=t[0],A=t[1],T=t[2],w=t[3],R=t[4],B=t[5],y=t[6],C=t[7],D=t[8],m=t[9],N=t[10],O=t[11],F=t[12],_=t[13],E=t[14],$=t[15];return Math.abs(n-I)<=P*Math.max(1,Math.abs(n),Math.abs(I))&&Math.abs(r-A)<=P*Math.max(1,Math.abs(r),Math.abs(A))&&Math.abs(i-T)<=P*Math.max(1,Math.abs(i),Math.abs(T))&&Math.abs(s-w)<=P*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(a-R)<=P*Math.max(1,Math.abs(a),Math.abs(R))&&Math.abs(o-B)<=P*Math.max(1,Math.abs(o),Math.abs(B))&&Math.abs(l-y)<=P*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(c-C)<=P*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(h-D)<=P*Math.max(1,Math.abs(h),Math.abs(D))&&Math.abs(u-m)<=P*Math.max(1,Math.abs(u),Math.abs(m))&&Math.abs(f-N)<=P*Math.max(1,Math.abs(f),Math.abs(N))&&Math.abs(d-O)<=P*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(p-F)<=P*Math.max(1,Math.abs(p),Math.abs(F))&&Math.abs(x-_)<=P*Math.max(1,Math.abs(x),Math.abs(_))&&Math.abs(v-E)<=P*Math.max(1,Math.abs(v),Math.abs(E))&&Math.abs(g-$)<=P*Math.max(1,Math.abs(g),Math.abs($))}var Ih=Ei,Lh=yi;var ee={};Ce(ee,{add:()=>Zu,calculateW:()=>Hu,clone:()=>$u,conjugate:()=>Gu,copy:()=>Xu,create:()=>Bn,dot:()=>Pi,equals:()=>rf,exactEquals:()=>nf,exp:()=>Ui,fromEuler:()=>Ku,fromMat3:()=>Yi,fromValues:()=>Wu,getAngle:()=>Du,getAxisAngle:()=>Bu,identity:()=>Nu,invert:()=>Vu,len:()=>ef,length:()=>Vi,lerp:()=>Ju,ln:()=>Hi,mul:()=>Qu,multiply:()=>ki,normalize:()=>Dn,pow:()=>zu,random:()=>Yu,rotateX:()=>Pu,rotateY:()=>ku,rotateZ:()=>Uu,rotationTo:()=>sf,scale:()=>zi,set:()=>qu,setAxes:()=>of,setAxisAngle:()=>Di,slerp:()=>St,sqlerp:()=>af,sqrLen:()=>tf,squaredLength:()=>Gi,str:()=>ju});var z={};Ce(z,{add:()=>Nh,angle:()=>eu,bezier:()=>jh,ceil:()=>Bh,clone:()=>Ch,copy:()=>Fh,create:()=>Mt,cross:()=>et,dist:()=>lu,distance:()=>Ri,div:()=>ou,divide:()=>Ti,dot:()=>bt,equals:()=>iu,exactEquals:()=>ru,floor:()=>Dh,forEach:()=>uu,fromValues:()=>wt,hermite:()=>Kh,inverse:()=>Vh,len:()=>Mn,length:()=>Mi,lerp:()=>Gh,max:()=>kh,min:()=>Ph,mul:()=>au,multiply:()=>bi,negate:()=>Yh,normalize:()=>yn,random:()=>$h,rotateX:()=>Zh,rotateY:()=>Qh,rotateZ:()=>Jh,round:()=>Uh,scale:()=>Hh,scaleAndAdd:()=>zh,set:()=>Oh,sqrDist:()=>cu,sqrLen:()=>hu,squaredDistance:()=>Si,squaredLength:()=>Ii,str:()=>nu,sub:()=>su,subtract:()=>wi,transformMat3:()=>Xh,transformMat4:()=>Wh,transformQuat:()=>qh,zero:()=>tu});function Mt(){var e=new V(3);return V!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Ch(e){var t=new V(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Mi(e){var t=e[0],n=e[1],r=e[2];return Math.hypot(t,n,r)}function wt(e,t,n){var r=new V(3);return r[0]=e,r[1]=t,r[2]=n,r}function Fh(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Oh(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}function Nh(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function wi(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function bi(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}function Ti(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}function Bh(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function Dh(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function Ph(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}function kh(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}function Uh(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function Hh(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function zh(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}function Ri(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.hypot(n,r,i)}function Si(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i}function Ii(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}function Yh(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function Vh(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function yn(e,t){var n=t[0],r=t[1],i=t[2],s=n*n+r*r+i*i;return s>0&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e}function bt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function et(e,t,n){var r=t[0],i=t[1],s=t[2],a=n[0],o=n[1],l=n[2];return e[0]=i*l-s*o,e[1]=s*a-r*l,e[2]=r*o-i*a,e}function Gh(e,t,n,r){var i=t[0],s=t[1],a=t[2];return e[0]=i+r*(n[0]-i),e[1]=s+r*(n[1]-s),e[2]=a+r*(n[2]-a),e}function Kh(e,t,n,r,i,s){var a=s*s,o=a*(2*s-3)+1,l=a*(s-2)+s,c=a*(s-1),h=a*(3-2*s);return e[0]=t[0]*o+n[0]*l+r[0]*c+i[0]*h,e[1]=t[1]*o+n[1]*l+r[1]*c+i[1]*h,e[2]=t[2]*o+n[2]*l+r[2]*c+i[2]*h,e}function jh(e,t,n,r,i,s){var a=1-s,o=a*a,l=s*s,c=o*a,h=3*s*o,u=3*l*a,f=l*s;return e[0]=t[0]*c+n[0]*h+r[0]*u+i[0]*f,e[1]=t[1]*c+n[1]*h+r[1]*u+i[1]*f,e[2]=t[2]*c+n[2]*h+r[2]*u+i[2]*f,e}function $h(e,t){t=t||1;var n=ae()*2*Math.PI,r=ae()*2-1,i=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*i,e[1]=Math.sin(n)*i,e[2]=r*t,e}function Wh(e,t,n){var r=t[0],i=t[1],s=t[2],a=n[3]*r+n[7]*i+n[11]*s+n[15];return a=a||1,e[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/a,e[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/a,e[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/a,e}function Xh(e,t,n){var r=t[0],i=t[1],s=t[2];return e[0]=r*n[0]+i*n[3]+s*n[6],e[1]=r*n[1]+i*n[4]+s*n[7],e[2]=r*n[2]+i*n[5]+s*n[8],e}function qh(e,t,n){var r=n[0],i=n[1],s=n[2],a=n[3],o=t[0],l=t[1],c=t[2],h=i*c-s*l,u=s*o-r*c,f=r*l-i*o,d=i*f-s*u,p=s*h-r*f,x=r*u-i*h,v=a*2;return h*=v,u*=v,f*=v,d*=2,p*=2,x*=2,e[0]=o+h+d,e[1]=l+u+p,e[2]=c+f+x,e}function Zh(e,t,n,r){var i=[],s=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=s[0]+n[0],e[1]=s[1]+n[1],e[2]=s[2]+n[2],e}function Qh(e,t,n,r){var i=[],s=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=s[0]+n[0],e[1]=s[1]+n[1],e[2]=s[2]+n[2],e}function Jh(e,t,n,r){var i=[],s=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],e[0]=s[0]+n[0],e[1]=s[1]+n[1],e[2]=s[2]+n[2],e}function eu(e,t){var n=e[0],r=e[1],i=e[2],s=t[0],a=t[1],o=t[2],l=Math.sqrt(n*n+r*r+i*i),c=Math.sqrt(s*s+a*a+o*o),h=l*c,u=h&&bt(e,t)/h;return Math.acos(Math.min(Math.max(u,-1),1))}function tu(e){return e[0]=0,e[1]=0,e[2]=0,e}function nu(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function ru(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function iu(e,t){var n=e[0],r=e[1],i=e[2],s=t[0],a=t[1],o=t[2];return Math.abs(n-s)<=P*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-a)<=P*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-o)<=P*Math.max(1,Math.abs(i),Math.abs(o))}var su=wi,au=bi,ou=Ti,lu=Ri,cu=Si,Mn=Mi,hu=Ii,uu=function(){var e=Mt();return function(t,n,r,i,s,a){var o,l;for(n||(n=3),r||(r=0),i?l=Math.min(i*n+r,t.length):l=t.length,o=r;o<l;o+=n)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],s(e,e,a),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2];return t}}();var le={};Ce(le,{add:()=>Sn,ceil:()=>fu,clone:()=>wn,copy:()=>Tn,create:()=>Li,cross:()=>gu,dist:()=>Iu,distance:()=>Ni,div:()=>Su,divide:()=>Oi,dot:()=>Cn,equals:()=>Nn,exactEquals:()=>On,floor:()=>du,forEach:()=>Ou,fromValues:()=>bn,inverse:()=>Eu,len:()=>Cu,length:()=>Tt,lerp:()=>Fn,max:()=>vu,min:()=>pu,mul:()=>Ru,multiply:()=>Fi,negate:()=>_u,normalize:()=>Ln,random:()=>Au,round:()=>xu,scale:()=>In,scaleAndAdd:()=>mu,set:()=>Rn,sqrDist:()=>Lu,sqrLen:()=>Fu,squaredDistance:()=>Bi,squaredLength:()=>Rt,str:()=>bu,sub:()=>Tu,subtract:()=>Ci,transformMat4:()=>yu,transformQuat:()=>Mu,zero:()=>wu});function Li(){var e=new V(4);return V!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function wn(e){var t=new V(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function bn(e,t,n,r){var i=new V(4);return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i}function Tn(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Rn(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e}function Sn(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e}function Ci(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}function Fi(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e}function Oi(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e}function fu(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function du(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function pu(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e}function vu(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e}function xu(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function In(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function mu(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e}function Ni(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],s=t[3]-e[3];return Math.hypot(n,r,i,s)}function Bi(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],s=t[3]-e[3];return n*n+r*r+i*i+s*s}function Tt(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.hypot(t,n,r,i)}function Rt(e){var t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i}function _u(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function Eu(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function Ln(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=n*n+r*r+i*i+s*s;return a>0&&(a=1/Math.sqrt(a)),e[0]=n*a,e[1]=r*a,e[2]=i*a,e[3]=s*a,e}function Cn(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function gu(e,t,n,r){var i=n[0]*r[1]-n[1]*r[0],s=n[0]*r[2]-n[2]*r[0],a=n[0]*r[3]-n[3]*r[0],o=n[1]*r[2]-n[2]*r[1],l=n[1]*r[3]-n[3]*r[1],c=n[2]*r[3]-n[3]*r[2],h=t[0],u=t[1],f=t[2],d=t[3];return e[0]=u*c-f*l+d*o,e[1]=-(h*c)+f*a-d*s,e[2]=h*l-u*a+d*i,e[3]=-(h*o)+u*s-f*i,e}function Fn(e,t,n,r){var i=t[0],s=t[1],a=t[2],o=t[3];return e[0]=i+r*(n[0]-i),e[1]=s+r*(n[1]-s),e[2]=a+r*(n[2]-a),e[3]=o+r*(n[3]-o),e}function Au(e,t){t=t||1;var n,r,i,s,a,o;do n=ae()*2-1,r=ae()*2-1,a=n*n+r*r;while(a>=1);do i=ae()*2-1,s=ae()*2-1,o=i*i+s*s;while(o>=1);var l=Math.sqrt((1-a)/o);return e[0]=t*n,e[1]=t*r,e[2]=t*i*l,e[3]=t*s*l,e}function yu(e,t,n){var r=t[0],i=t[1],s=t[2],a=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*a,e[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*a,e[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*a,e[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*a,e}function Mu(e,t,n){var r=t[0],i=t[1],s=t[2],a=n[0],o=n[1],l=n[2],c=n[3],h=c*r+o*s-l*i,u=c*i+l*r-a*s,f=c*s+a*i-o*r,d=-a*r-o*i-l*s;return e[0]=h*c+d*-a+u*-l-f*-o,e[1]=u*c+d*-o+f*-a-h*-l,e[2]=f*c+d*-l+h*-o-u*-a,e[3]=t[3],e}function wu(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function bu(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function On(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function Nn(e,t){var n=e[0],r=e[1],i=e[2],s=e[3],a=t[0],o=t[1],l=t[2],c=t[3];return Math.abs(n-a)<=P*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-o)<=P*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-l)<=P*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(s-c)<=P*Math.max(1,Math.abs(s),Math.abs(c))}var Tu=Ci,Ru=Fi,Su=Oi,Iu=Ni,Lu=Bi,Cu=Tt,Fu=Rt,Ou=function(){var e=Li();return function(t,n,r,i,s,a){var o,l;for(n||(n=4),r||(r=0),i?l=Math.min(i*n+r,t.length):l=t.length,o=r;o<l;o+=n)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],e[3]=t[o+3],s(e,e,a),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2],t[o+3]=e[3];return t}}();function Bn(){var e=new V(4);return V!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Nu(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Di(e,t,n){n=n*.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function Bu(e,t){var n=Math.acos(t[3])*2,r=Math.sin(n/2);return r>P?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=1,e[1]=0,e[2]=0),n}function Du(e,t){var n=Pi(e,t);return Math.acos(2*n*n-1)}function ki(e,t,n){var r=t[0],i=t[1],s=t[2],a=t[3],o=n[0],l=n[1],c=n[2],h=n[3];return e[0]=r*h+a*o+i*c-s*l,e[1]=i*h+a*l+s*o-r*c,e[2]=s*h+a*c+r*l-i*o,e[3]=a*h-r*o-i*l-s*c,e}function Pu(e,t,n){n*=.5;var r=t[0],i=t[1],s=t[2],a=t[3],o=Math.sin(n),l=Math.cos(n);return e[0]=r*l+a*o,e[1]=i*l+s*o,e[2]=s*l-i*o,e[3]=a*l-r*o,e}function ku(e,t,n){n*=.5;var r=t[0],i=t[1],s=t[2],a=t[3],o=Math.sin(n),l=Math.cos(n);return e[0]=r*l-s*o,e[1]=i*l+a*o,e[2]=s*l+r*o,e[3]=a*l-i*o,e}function Uu(e,t,n){n*=.5;var r=t[0],i=t[1],s=t[2],a=t[3],o=Math.sin(n),l=Math.cos(n);return e[0]=r*l+i*o,e[1]=i*l-r*o,e[2]=s*l+a*o,e[3]=a*l-s*o,e}function Hu(e,t){var n=t[0],r=t[1],i=t[2];return e[0]=n,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e}function Ui(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=Math.sqrt(n*n+r*r+i*i),o=Math.exp(s),l=a>0?o*Math.sin(a)/a:0;return e[0]=n*l,e[1]=r*l,e[2]=i*l,e[3]=o*Math.cos(a),e}function Hi(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=Math.sqrt(n*n+r*r+i*i),o=a>0?Math.atan2(a,s)/a:0;return e[0]=n*o,e[1]=r*o,e[2]=i*o,e[3]=.5*Math.log(n*n+r*r+i*i+s*s),e}function zu(e,t,n){return Hi(e,t),zi(e,e,n),Ui(e,e),e}function St(e,t,n,r){var i=t[0],s=t[1],a=t[2],o=t[3],l=n[0],c=n[1],h=n[2],u=n[3],f,d,p,x,v;return d=i*l+s*c+a*h+o*u,d<0&&(d=-d,l=-l,c=-c,h=-h,u=-u),1-d>P?(f=Math.acos(d),p=Math.sin(f),x=Math.sin((1-r)*f)/p,v=Math.sin(r*f)/p):(x=1-r,v=r),e[0]=x*i+v*l,e[1]=x*s+v*c,e[2]=x*a+v*h,e[3]=x*o+v*u,e}function Yu(e){var t=ae(),n=ae(),r=ae(),i=Math.sqrt(1-t),s=Math.sqrt(t);return e[0]=i*Math.sin(2*Math.PI*n),e[1]=i*Math.cos(2*Math.PI*n),e[2]=s*Math.sin(2*Math.PI*r),e[3]=s*Math.cos(2*Math.PI*r),e}function Vu(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=n*n+r*r+i*i+s*s,o=a?1/a:0;return e[0]=-n*o,e[1]=-r*o,e[2]=-i*o,e[3]=s*o,e}function Gu(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function Yi(e,t){var n=t[0]+t[4]+t[8],r;if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);var s=(i+1)%3,a=(i+2)%3;r=Math.sqrt(t[i*3+i]-t[s*3+s]-t[a*3+a]+1),e[i]=.5*r,r=.5/r,e[3]=(t[s*3+a]-t[a*3+s])*r,e[s]=(t[s*3+i]+t[i*3+s])*r,e[a]=(t[a*3+i]+t[i*3+a])*r}return e}function Ku(e,t,n,r){var i=.5*Math.PI/180;t*=i,n*=i,r*=i;var s=Math.sin(t),a=Math.cos(t),o=Math.sin(n),l=Math.cos(n),c=Math.sin(r),h=Math.cos(r);return e[0]=s*l*h-a*o*c,e[1]=a*o*h+s*l*c,e[2]=a*l*c-s*o*h,e[3]=a*l*h+s*o*c,e}function ju(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var $u=wn,Wu=bn,Xu=Tn,qu=Rn,Zu=Sn,Qu=ki,zi=In,Pi=Cn,Ju=Fn,Vi=Tt,ef=Vi,Gi=Rt,tf=Gi,Dn=Ln,nf=On,rf=Nn,sf=function(){var e=Mt(),t=wt(1,0,0),n=wt(0,1,0);return function(r,i,s){var a=bt(i,s);return a<-.999999?(et(e,t,i),Mn(e)<1e-6&&et(e,n,i),yn(e,e),Di(r,e,Math.PI),r):a>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(et(e,i,s),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+a,Dn(r,r))}}(),af=function(){var e=Bn(),t=Bn();return function(n,r,i,s,a,o){return St(e,r,a,o),St(t,i,s,o),St(n,e,t,2*o*(1-o)),n}}(),of=function(){var e=An();return function(t,n,r,i){return e[0]=r[0],e[3]=r[1],e[6]=r[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],Dn(t,Yi(t,e))}}();var He={};Ce(He,{add:()=>ff,angle:()=>Ff,ceil:()=>df,clone:()=>lf,copy:()=>hf,create:()=>Ki,cross:()=>wf,dist:()=>zf,distance:()=>Xi,div:()=>Hf,divide:()=>Wi,dot:()=>Mf,equals:()=>Df,exactEquals:()=>Bf,floor:()=>pf,forEach:()=>Gf,fromValues:()=>cf,inverse:()=>Af,len:()=>Pf,length:()=>Zi,lerp:()=>bf,max:()=>xf,min:()=>vf,mul:()=>Uf,multiply:()=>$i,negate:()=>gf,normalize:()=>yf,random:()=>Tf,rotate:()=>Cf,round:()=>mf,scale:()=>_f,scaleAndAdd:()=>Ef,set:()=>uf,sqrDist:()=>Yf,sqrLen:()=>Vf,squaredDistance:()=>qi,squaredLength:()=>Qi,str:()=>Nf,sub:()=>kf,subtract:()=>ji,transformMat2:()=>Rf,transformMat2d:()=>Sf,transformMat3:()=>If,transformMat4:()=>Lf,zero:()=>Of});function Ki(){var e=new V(2);return V!=Float32Array&&(e[0]=0,e[1]=0),e}function lf(e){var t=new V(2);return t[0]=e[0],t[1]=e[1],t}function cf(e,t){var n=new V(2);return n[0]=e,n[1]=t,n}function hf(e,t){return e[0]=t[0],e[1]=t[1],e}function uf(e,t,n){return e[0]=t,e[1]=n,e}function ff(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function ji(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}function $i(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e}function Wi(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e}function df(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function pf(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function vf(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e}function xf(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e}function mf(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function _f(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e}function Ef(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e}function Xi(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.hypot(n,r)}function qi(e,t){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}function Zi(e){var t=e[0],n=e[1];return Math.hypot(t,n)}function Qi(e){var t=e[0],n=e[1];return t*t+n*n}function gf(e,t){return e[0]=-t[0],e[1]=-t[1],e}function Af(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function yf(e,t){var n=t[0],r=t[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e}function Mf(e,t){return e[0]*t[0]+e[1]*t[1]}function wf(e,t,n){var r=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=r,e}function bf(e,t,n,r){var i=t[0],s=t[1];return e[0]=i+r*(n[0]-i),e[1]=s+r*(n[1]-s),e}function Tf(e,t){t=t||1;var n=ae()*2*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e}function Rf(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e}function Sf(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i+n[4],e[1]=n[1]*r+n[3]*i+n[5],e}function If(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[3]*i+n[6],e[1]=n[1]*r+n[4]*i+n[7],e}function Lf(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e}function Cf(e,t,n,r){var i=t[0]-n[0],s=t[1]-n[1],a=Math.sin(r),o=Math.cos(r);return e[0]=i*o-s*a+n[0],e[1]=i*a+s*o+n[1],e}function Ff(e,t){var n=e[0],r=e[1],i=t[0],s=t[1],a=Math.sqrt(n*n+r*r)*Math.sqrt(i*i+s*s),o=a&&(n*i+r*s)/a;return Math.acos(Math.min(Math.max(o,-1),1))}function Of(e){return e[0]=0,e[1]=0,e}function Nf(e){return"vec2("+e[0]+", "+e[1]+")"}function Bf(e,t){return e[0]===t[0]&&e[1]===t[1]}function Df(e,t){var n=e[0],r=e[1],i=t[0],s=t[1];return Math.abs(n-i)<=P*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-s)<=P*Math.max(1,Math.abs(r),Math.abs(s))}var Pf=Zi,kf=ji,Uf=$i,Hf=Wi,zf=Xi,Yf=qi,Vf=Qi,Gf=function(){var e=Ki();return function(t,n,r,i,s,a){var o,l;for(n||(n=2),r||(r=0),i?l=Math.min(i*n+r,t.length):l=t.length,o=r;o<l;o+=n)e[0]=t[o],e[1]=t[o+1],s(e,e,a),t[o]=e[0],t[o+1]=e[1];return t}}();var de={red(e){return e>>16&255},redf(e){return(e>>16&255)/255},green(e){return e>>8&255},greenf(e){return(e>>8&255)/255},blue(e){return e&255},bluef(e){return(e&255)/255},alpha(e){return e>>24&255},alphaf(e){return(e>>24&255)/255},hexf(e,t,n,r=1){let i=Math.floor(Math.max(Math.min(e,1),0)*255),s=Math.floor(Math.max(Math.min(t,1),0)*255),a=Math.floor(Math.max(Math.min(n,1),0)*255);return(Math.floor(Math.max(Math.min(r,1),0)*255)&255)<<24|(i&255)<<16|(s&255)<<8|a&255},mix(e=0,t=16777215,n=.5){let r=this.redf(e),i=this.greenf(e),s=this.bluef(e),a=this.alphaf(e),o=(this.redf(t)-r)*n+r,l=(this.greenf(t)-i)*n+i,c=(this.bluef(t)-s)*n+s,h=(this.alphaf(t)-a)*n+a;return h<.01&&(h=void 0),this.hexf(o,l,c,h)}};var Pd=z.fromValues(0,1,0);function Ji(e,t,n,r,i,s=!1){let a=le.fromValues(t,n,-1,1),o=Y.create();return Y.invert(o,r),le.transformMat4(a,a,o),a[2]=-1,a[3]=0,Y.invert(o,i),le.transformMat4(a,a,o),e[0]=a[0],e[1]=a[1],e[2]=a[2],s&&z.normalize(e,e),e}var es=class{constructor(t,n){this.projectionMatrix=t,this.viewMatrix=n}resize(t=void 0,n=void 0){return this}},kd=Math.PI/3;var Pn=class extends es{constructor(t=void 0,n=void 0,r=void 0,i=void 0,s=-1e3,a=1e3){super(Y.create(),Y.create());this.orthoBounds={left:typeof t=="undefined"?void 0:Number(t),top:typeof n=="undefined"?void 0:Number(n),right:typeof r=="undefined"?void 0:Number(r),bottom:typeof i=="undefined"?void 0:Number(i)},this.clippingPlane={near:Number(s),far:Number(a)}}resize(t=void 0,n=void 0){let{near:r,far:i}=this.clippingPlane,{left:s,top:a,right:o,bottom:l}=this.orthoBounds,c=this.projectionMatrix,h=typeof t!="undefined",u=typeof s!="undefined";if(h)if(u){let f=t/n;Y.ortho(c,s*f,o*f,l,a,r,i)}else Y.ortho(c,0,t,n,0,r,i);else u?Y.ortho(c,s,o,l,a,r,i):Y.ortho(c,-1,1,1,-1,-1,1);return this}},Ud=Math.PI/180;var kn=class{constructor(t,n=t.canvas,r=new Pn){this.gl=t,this.canvas=n,this.camera=r,this.projectionViewMatrix=Y.create(),this.modelMatrix=Y.create(),this.colorVector=z.create(),this.depthFloat=0,this.opacityFloat=1,this.transformStack=[],this.transformMatrix=Y.create(),this.translationVector=z.create(),this.rotationQuat=ee.create(),this.scaleVector=z.fromValues(1,1,1),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA)}reset(){this.resize(),this.clear(0,0,0,1),this.setColorVector(1,1,1),this.setDepthFloat(0),this.setOpacityFloat(1),this.resetTransform(),this.transformStack.length=0}resize(){let t=this.gl,n=t.canvas.width,r=t.canvas.height;t.viewport(0,0,n,r);let i=this.camera;i.resize(n,r);let s=this.projectionViewMatrix;Y.mul(s,i.projectionMatrix,i.viewMatrix)}clear(t,n,r,i=1){let s=this.gl;s.clearColor(t,n,r,i),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT)}setColorVector(t,n,r){return z.set(this.colorVector,t,n,r),this}setColor(t){return this.setColorVector(de.redf(t),de.greenf(t),de.bluef(t))}setDepthFloat(t){return this.depthFloat=t,this}setOpacityFloat(t){return this.opacityFloat=t,this}setTranslation(t,n,r=0){return z.set(this.translationVector,t,n,r),this}setRotation(t,n,r){return ee.fromEuler(this.rotationQuat,t,n,r),this}setScale(t,n){return z.set(this.scaleVector,t,n,1),this}resetTransform(){Y.identity(this.transformMatrix),z.zero(this.translationVector),ee.identity(this.rotationQuat),z.set(this.scaleVector,1,1,1)}pushTransform(){Y.fromRotationTranslationScale(this.transformMatrix,this.rotationQuat,this.translationVector,this.scaleVector),this.transformStack.push(this.transformMatrix),this.transformMatrix=Y.create(),this.resetTransform()}popTransform(){let t=this.transformStack.pop();Y.getRotation(this.rotationQuat,t),Y.getTranslation(this.translationVector,t),Y.getScaling(this.scaleVector,t),this.transformMatrix=t}applyTransform(t){for(let n=this.transformStack.length-1;n>=0;--n)Y.mul(t,this.transformStack[n],t);return Y.mul(t,Y.fromRotationTranslationScale(this.transformMatrix,this.rotationQuat,this.translationVector,this.scaleVector),t),t}};var Kf=`
attribute vec2 a_position;

uniform mat4 u_projection_view;
uniform mat4 u_model;

void main() {
    gl_Position = u_projection_view * u_model * vec4(a_position.xy, 0.0, 1.0);
}`,jf=`
precision mediump float;

uniform vec3 u_color;
uniform float u_opacity_inv;

void main() {
    gl_FragColor = vec4(u_color.rgb, 1.0 - u_opacity_inv);
}`,Un=16,ts=(()=>{let e=[],t=Un,n=Math.PI*2/t,r=1,i=0,s,a;for(let o=0;o<=t;++o)s=Math.cos(o*n),a=Math.sin(o*n),e.push(0,0),e.push(r,i),e.push(s,a),r=s,i=a;return e})(),$f=Math.trunc(ts.length/2),ns=(()=>{let e=[],t=Un,n=Math.PI*2/t,r=1,i=0,s,a;for(let o=0;o<=t;++o)s=Math.cos(o*n),a=Math.sin(o*n),e.push(r,i),e.push(s,a),r=s,i=a;return e})(),Wf=Math.trunc(ns.length/2),Xf=Un/2,rs=(()=>{let e=[],t=Xf,n=Math.PI/t,r=1,i=0,s,a;for(let o=0;o<=t;++o)s=Math.cos(o*n),a=Math.sin(o*n),e.push(0,0),e.push(r,i),e.push(s,a),r=s,i=a;return e})(),qf=Math.trunc(rs.length/2),It=[0,0,1,0,0,1,1,1,1,0,0,1],Zf=[0,0,1,1],Hn=class extends kn{constructor(t,n=void 0,r=void 0){super(t,n,r);this.shapeProgram=new Be(t).shader(t.VERTEX_SHADER,Kf).shader(t.FRAGMENT_SHADER,jf).link(),this.meshQuad=new Ee(t,t.ARRAY_BUFFER).data(Me.createBufferSource(t,t.FLOAT,It)).build(),this.meshLine=new Ee(t,t.ARRAY_BUFFER).data(Me.createBufferSource(t,t.FLOAT,Zf)).build(),this.meshCircle=new Ee(t,t.ARRAY_BUFFER).data(Me.createBufferSource(t,t.FLOAT,ts)).build(),this.meshLineCircle=new Ee(t,t.ARRAY_BUFFER).data(Me.createBufferSource(t,t.FLOAT,ns)).build(),this.meshHalfCircle=new Ee(t,t.ARRAY_BUFFER).data(Me.createBufferSource(t,t.FLOAT,rs)).build()}resize(){super.resize(),this.shapeProgram.bind(this.gl).uniform("u_projection_view",this.projectionViewMatrix)}setColorVector(t,n,r){return super.setColorVector(t,n,r),this.shapeProgram.bind(this.gl).uniform("u_color",this.colorVector),this}setOpacityFloat(t){return super.setOpacityFloat(t),this.shapeProgram.bind(this.gl).uniform("u_opacity_inv",1-this.opacityFloat),this}drawLine(t=0,n=0,r=t+16,i=n){let s=this.gl,a=this.depthFloat,o=r-t,l=i-n,c=this.modelMatrix;return Y.fromRotationTranslationScale(c,ee.create(),z.fromValues(t,n,a),z.fromValues(o,l,1)),this.applyTransform(c),this.shapeProgram.bind(s).attribute("a_position",s.FLOAT,this.meshLine.handle).uniform("u_model",c).draw(s,s.LINES,0,2),this}drawQuadratic(t=0,n=0,r=t+16,i=n,s=16,a=9){let o=r-t,l=i-n,c=o/2+t,h=l/2+n+s,u=[t,n,c,h,r,i];Qf(u,u,a);let f=u.length;for(let d=2;d<=f-2;d+=2)this.drawLine(u[d-2],u[d-1],u[d],u[d+1])}drawRay(t=0,n=0,r=0,i=16){let s=Math.PI*r/180;return this.drawLine(t,n,t+Math.cos(s)*i,n+Math.sin(s)*i)}drawBox(t=0,n=0,r=8,i=r){return this.drawBoxImpl(this.gl.TRIANGLES,t,n,this.depthFloat,r,i)}drawLineBox(t=0,n=0,r=8,i=r){return this.drawBoxImpl(this.gl.LINE_LOOP,t,n,this.depthFloat,r,i)}drawRect(t=0,n=0,r=16,i=16){let s=(r-t)/2,a=(i-n)/2;return this.drawBox(t+s,n+a,s,a)}drawLineRect(t=0,n=0,r=16,i=16){let s=(r-t)/2,a=(i-n)/2;return this.drawLineBox(t+s,n+a,s,a)}drawCircle(t=0,n=0,r=8){return this.drawCircleImpl(this.meshCircle,$f,this.gl.TRIANGLES,t,n,this.depthFloat,r)}drawLineCircle(t=0,n=0,r=8){return this.drawCircleImpl(this.meshLineCircle,Wf,this.gl.LINE_LOOP,t,n,this.depthFloat,r)}drawHalfCircle(t=0,n=0,r=8){return this.drawCircleImpl(this.meshHalfCircle,qf,this.gl.TRIANGLES,t,n,this.depthFloat,r)}drawBoxImpl(t,n,r,i,s,a){let o=this.gl,l=this.modelMatrix;return Y.fromRotationTranslationScaleOrigin(l,ee.create(),z.fromValues(n,r,i),z.fromValues(s*2,a*2,1),z.fromValues(.5,.5,0)),this.applyTransform(l),this.shapeProgram.bind(o).attribute("a_position",o.FLOAT,this.meshQuad.handle).uniform("u_model",l).draw(o,t,0,6),this}drawCircleImpl(t,n,r,i,s,a,o){let l=this.gl,c=this.modelMatrix;return Y.fromRotationTranslationScale(c,ee.create(),z.fromValues(i,s,a),z.fromValues(o,o,1)),this.applyTransform(c),this.shapeProgram.bind(l).attribute("a_position",l.FLOAT,t.handle).uniform("u_model",c).draw(l,r,0,n),this}};function Qf(e,t,n){if(t.length<6)throw new Error("Cannot find quadratic points from less than 3 points.");let[r,i,s,a,o,l]=t,c=Je.fromValues(r*r,s*s,o*o,r,s,o,1,1,1),h=z.fromValues(i,a,l);Je.invert(c,c);let u=z.transformMat3(h,h,c);e.length=0,e.push(r,i);let f=o-r;for(let d=1;d<n-1;++d){let p=d/n,x=f*p+r,v=u[0]*x*x+u[1]*x+u[2];e.push(x,v)}return e.push(o,l),e}var Jf=`
attribute vec2 a_position;
attribute vec2 a_texcoord;

varying vec2 v_texcoord;

uniform mat4 u_projection_view;
uniform mat4 u_model;

void main() {
    vec4 position = u_projection_view * u_model
        * vec4(a_position.xy, 0.0, 1.0);
    v_texcoord = a_texcoord;
    gl_Position = position;
}`,e0=`
precision mediump float;

varying vec2 v_texcoord;

uniform sampler2D u_texture;
uniform vec2 u_texture_size;
uniform vec4 u_sprite;
uniform vec3 u_color;
uniform float u_opacity_inv;

void main() {
    float spriteWidth = u_sprite.z - u_sprite.x;
    float spriteHeight = u_sprite.w - u_sprite.y;
    vec2 texcoord = vec2(
        (u_sprite.x / u_texture_size.x) + v_texcoord.x * (spriteWidth / u_texture_size.x),
        (u_sprite.y / u_texture_size.y) + v_texcoord.y * (spriteHeight / u_texture_size.y));
    vec4 texcolor = texture2D(u_texture, texcoord);
    if (texcolor.a <= 0.0) discard;
    gl_FragColor = vec4(
        texcolor.r * u_color.r,
        texcolor.g * u_color.g,
        texcolor.b * u_color.b,
        texcolor.a * (1.0 - u_opacity_inv));
}`,zn=class extends Hn{constructor(t,n=void 0,r=void 0){super(t,n,r);this.texturedProgram=new Be(t).shader(t.VERTEX_SHADER,Jf).shader(t.FRAGMENT_SHADER,e0).link(),this.meshQuadTextured={position:new Ee(t,t.ARRAY_BUFFER).data(Me.createBufferSource(t,t.FLOAT,It)).build(),texcoord:new Ee(t,t.ARRAY_BUFFER).data(Me.createBufferSource(t,t.FLOAT,It)).build()},this.spriteVector=le.fromValues(0,0,1,1),this.textureSize=He.fromValues(1,1),this.textureHandle=null,this.textureList=new Array(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS))}resize(){super.resize(),this.texturedProgram.bind(this.gl).uniform("u_projection_view",this.projectionViewMatrix)}setColorVector(t,n,r){return super.setColorVector(t,n,r),this.texturedProgram.bind(this.gl).uniform("u_color",this.colorVector),this}setOpacityFloat(t){return super.setOpacityFloat(t),this.texturedProgram.bind(this.gl).uniform("u_opacity_inv",1-this.opacityFloat),this}setTextureImage(t,n){let r=this.textureList,i=r.length;if(t<0||t>=i)throw new Error(`Invalid texture unit - must be within range [0, ${i-1}]`);let s=this.gl,a=r[t];a&&n0(s,a.handle);let o=t0(s,n);return r[t]=o,s.activeTexture(s.TEXTURE0+t),s.bindTexture(s.TEXTURE_2D,o.handle),this}drawTexturedBox(t=0,n=0,r=0,i=void 0,s=void 0,a=0,o=0,l=void 0,c=void 0){let{width:h,height:u}=this.textureList[t];He.set(this.textureSize,h,u),typeof l=="undefined"&&(l=h),typeof c=="undefined"&&(c=u),le.set(this.spriteVector,a,o,l,c);let f=l-a,d=c-o,p=!1;typeof i=="undefined"?i=f/2:p=!0,typeof s=="undefined"&&(p?s=i:s=d/2);let x=i*2,v=s*2,g=x/f,I=v/d;return this.drawTexturedQuadImpl(t,n,r,this.depthFloat,g,I)}drawTexturedRect(t=0,n=0,r=0,i=void 0,s=void 0,a=0,o=0,l=void 0,c=void 0){let{width:h,height:u}=this.textureList[t];typeof l=="undefined"&&(l=h),typeof c=="undefined"&&(c=u),He.set(this.textureSize,h,u),le.set(this.spriteVector,a,o,l,c),typeof i=="undefined"&&(i=n+h),typeof s=="undefined"&&(s=r+u);let f=i-n,d=s-r,p=l-a,x=c-o,v=f/p,g=d/x,I=n+p/2*v,A=r+x/2*g;return this.drawTexturedQuadImpl(t,I,A,this.depthFloat,v,g)}drawTexturedQuadImpl(t,n,r,i,s,a){let o=this.gl,l=this.spriteVector,c=l[2]-l[0],h=l[3]-l[1],u=this.modelMatrix;Y.fromRotationTranslationScaleOrigin(u,ee.fromEuler(ee.create(),0,0,0),z.fromValues(n-c/2,r-h/2,i),z.fromValues(s,a,1),z.fromValues(c/2,h/2,0)),Y.scale(u,u,z.fromValues(c,h,1)),this.applyTransform(u);let f=this.meshQuadTextured,d=this.textureSize;return this.texturedProgram.bind(o).attribute("a_position",o.FLOAT,f.position.handle).attribute("a_texcoord",o.FLOAT,f.texcoord.handle).uniform("u_model",u).uniform("u_texture",t).uniform("u_sprite",l).uniform("u_texture_size",d).draw(o,o.TRIANGLES,0,6),this}};function t0(e,t){if(!(t instanceof Image))throw new Error(`Not a valid image ${t}.`);let n=0,r=e.RGBA,i=e.RGBA,s=e.UNSIGNED_BYTE,a=e.createTexture();return e.bindTexture(e.TEXTURE_2D,a),e.texImage2D(e.TEXTURE_2D,n,r,i,s,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),{handle:a,width:t.width,height:t.height}}function n0(e,t){e.deleteTexture(t)}var r0=`
attribute vec2 a_position;

varying vec2 v_position;

uniform mat4 u_projection_view;
uniform mat4 u_model;

void main() {
    gl_Position = u_projection_view * u_model * vec4(a_position.xy, 0.0, 1.0);
    v_position = a_position;
}`,i0=`
precision mediump float;

varying vec2 v_position;

uniform vec3 u_color;
uniform float u_opacity_inv;

uniform vec3 u_color_from;
uniform vec3 u_color_to;

uniform vec4 u_gradient_rect;

void main() {
    // float fx = (gl_FragCoord.x - u_gradient_rect.x) / u_gradient_rect.z;
    float fy = (gl_FragCoord.y - u_gradient_rect.y) / u_gradient_rect.w;
    gl_FragColor = vec4(mix(u_color_to, u_color_from, fy), 1.0 - u_opacity_inv);
}`,Yn=class extends zn{constructor(t,n=void 0,r=void 0){super(t,n,r);this.gradientProgram=new Be(t).shader(t.VERTEX_SHADER,r0).shader(t.FRAGMENT_SHADER,i0).link(),this.gradientColor=z.create(),this.gradientVector=le.create()}resize(){super.resize(),this.gradientProgram.bind(this.gl).uniform("u_projection_view",this.projectionViewMatrix)}setColorVector(t,n,r){return super.setColorVector(t,n,r),this.gradientProgram.bind(this.gl).uniform("u_color",this.colorVector),this}setOpacityFloat(t){return super.setOpacityFloat(t),this.gradientProgram.bind(this.gl).uniform("u_opacity_inv",1-this.opacityFloat),this}drawGradientRect(t=16777215,n=0,r=0,i=0,s=this.canvas.width,a=this.canvas.height){let o=(s-r)/2,l=(a-i)/2,c=r+o,h=i+l,u=this.depthFloat,f=this.gl,d=this.modelMatrix;return Y.fromRotationTranslationScaleOrigin(d,ee.fromEuler(ee.create(),0,0,0),z.fromValues(c,h,u),z.fromValues(o*2,l*2,1),z.fromValues(.5,.5,0)),this.applyTransform(d),this.gradientProgram.bind(f).attribute("a_position",f.FLOAT,this.meshQuad.handle).uniform("u_model",d).uniform("u_color_from",z.set(this.gradientColor,de.redf(t),de.greenf(t),de.bluef(t))).uniform("u_color_to",z.set(this.gradientColor,de.redf(n),de.greenf(n),de.bluef(n))).uniform("u_gradient_rect",le.set(this.gradientVector,r,this.canvas.height-a,o*2,l*2)).draw(f,f.TRIANGLES,0,6),this}};var Vn=class extends Yn{constructor(t,n=void 0,r=void 0){super(t,n,r);this.bmFontMap={}}setBMFontTexture(t,n,r){let i={};for(let s of r.chars){let a=s.x,o=s.y,l=a+s.width,c=o+s.height;i[s.id]={u:a,v:o,s:l,t:c}}this.bmFontMap[t]=i,this.setTextureImage(t,n)}drawText(t,n,r,i){let s=r,a=13,o=18;for(let l=0;l<n.length;++l){let c=n.charAt(l);if(c===`
`){i+=o,r=s;continue}else if(c===" "){r+=a;continue}else{r+=a;let h=n.charCodeAt(l),{u,v:f,s:d,t:p}=this.bmFontMap[t][h],x=d-u,v=p-f;this.drawTexturedBox(t,r,i,x/2,v/2,u,f,d,p)}}}};var s0=new xn(()=>{let e=document.querySelector("display-port"),t=e.getContext("webgl"),n=new Vn(t);return{display:e,ctx:n}});function is(e){return s0.resolve(e)}function ss(e,t){let n;if("listeners"in e?n=e.listeners:(n={[t]:[]},e.listeners=n),t in n)return n[t];{let r=[];return n[t]=r,r}}function ze(e,t,n){ss(e,t).push(n)}function tt(e,t,...n){let r=ss(e,t);for(let i of r)i.call(void 0,...n)}var as=8,l0=as*2;function Gn(e){if("components"in e)return e.components;{let t={};return e.components=t,t}}function Kn(e,t){return t.name}function jn(e,t){if(t in e)return e[t];{let n={};return e[t]=n,n}}var $n=Symbol("nextAvailableEntityId");function c0(e){return $n in e?e[$n]++:(Object.defineProperty(e,$n,{value:2,writable:!0,enumerable:!1}),1)}function h0(e,t,n){let r=Kn(e,n),i=jn(e,r),s=n.new();return i[t]=s,s}function u0(e,t,n){let r=Kn(e,n),i=jn(e,r),s=i[t];return delete i[t],s}var Wn=class{constructor(t){this.componentClasses=t}instantiate(t){let n=Gn(t),r=c0(n);for(let i of this.componentClasses)h0(n,r,i);return r}destroy(t,n){let r=Gn(t);for(let i of this.componentClasses)u0(r,n,i)}};var Xn=class{constructor(t){this.componentClass=t}find(t){return this.findAll(t)[Symbol.iterator]().next().value}findAll(t){let n=Gn(t),r=Kn(n,this.componentClass),i=jn(n,r);return Object.values(i)}},qn=class{constructor(t,n,r=()=>{}){this.name=t,this.new=n,this.delete=r}};var f0=[{w:4,h:4,m:[0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0]},{w:4,h:4,m:[0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0]}],d0=[{w:3,h:3,m:[0,0,0,0,1,1,0,1,1]}],p0=[{w:3,h:3,m:[0,1,0,1,1,1,0,0,0]},{w:3,h:3,m:[0,1,0,0,1,1,0,1,0]},{w:3,h:3,m:[0,0,0,1,1,1,0,1,0]},{w:3,h:3,m:[0,1,0,1,1,0,0,1,0]}],v0=[{w:3,h:3,m:[0,1,0,0,1,0,0,1,1]},{w:3,h:3,m:[0,0,0,1,1,1,1,0,0]},{w:3,h:3,m:[1,1,0,0,1,0,0,1,0]},{w:3,h:3,m:[0,0,1,1,1,1,0,0,0]}],x0=[{w:3,h:3,m:[0,1,0,0,1,0,1,1,0]},{w:3,h:3,m:[1,0,0,1,1,1,0,0,0]},{w:3,h:3,m:[0,1,1,0,1,0,0,1,0]},{w:3,h:3,m:[0,0,0,1,1,1,0,0,1]}],m0=[{w:3,h:3,m:[1,1,0,0,1,1,0,0,0]},{w:3,h:3,m:[0,0,1,0,1,1,0,1,0]}],_0=[{w:3,h:3,m:[0,1,1,1,1,0,0,0,0]},{w:3,h:3,m:[1,0,0,1,1,0,0,1,0]}],os=[f0,d0,p0,x0,v0,_0,m0],ls=Infinity,cs=Infinity,hs=1,us=1;for(let e of os)for(let t of e)ls=Math.min(t.w,ls),cs=Math.min(t.h,cs),hs=Math.max(t.w,hs),us=Math.max(t.h,us);var fs=new qn("Cursor",()=>({x:0,y:0,side:0,shapeIndex:0,rotationIndex:0,gravityX:0,gravityY:0,blockIndex:1,cachedShapeIndex:0,cachedBlockIndex:1})),Dp=new Xn(fs),Pp=new Wn([fs]);var E0=5,g0=4,A0=3,y0=2,M0=1,w0=0,Gp={[E0]:nt("#7F8C8D"),[g0]:nt("#2ECC71"),[A0]:nt("#4794C8"),[y0]:nt("#F39C12"),[M0]:nt("#C0392B"),[w0]:[""]};function nt(e){return[`background: ${e}`,"border-radius: 0.5em","color: white","font-weight: bold","padding: 2px 0.5em"]}var Kp=Symbol("level"),jp=Symbol("domain");function ds(e,t,n,r,i){let s=Math.floor(e),a=Math.floor(t),o=Math.floor(n),l=Math.floor(r),c=Math.abs(n-e),h=e<n?1:-1,u=-Math.abs(r-t),f=t<r?1:-1,d=c+u,p=s,x=a,v=i(p,x);if(typeof v!="undefined")return v;let g=c*c+u*u,I=0;for(;I<g&&(p!==o||x!==l);){++I;let A=d*2;if(A>=u&&(d+=u,p+=h),A<=c&&(d+=c,x+=f),v=i(p,x),typeof v!="undefined")return v}}var Ye=0,b0=class{constructor(t){this._heap=[],this._comparator=t}get size(){return this._heap.length}clear(){this._heap.length=0}push(...t){for(let n of t)this._heap.push(n),this._shiftUp()}pop(){let t=this.peek(),n=T0(this);return n>Ye&&this._swap(Ye,n),this._heap.pop(),this._shiftDown(),t}replace(t){let n=this.peek();return this._heap[Ye]=t,this._shiftDown(),n}peek(){return this._heap[Ye]}_compare(t,n){return this._comparator(this._heap[t],this._heap[n])}_swap(t,n){let r=this._heap[t];this._heap[t]=this._heap[n],this._heap[n]=r}_shiftUp(){let t=this._heap.length-1,n;for(;t>Ye&&this._compare(t,n=R0(t));)this._swap(t,n),t=n}_shiftDown(){let t=this._heap.length,n=Ye,r,i=ps(n),s=i<t,a=vs(n),o=a<t;for(;s&&this._compare(i,n)||o&&this._compare(a,n);)r=o&&this._compare(a,i)?a:i,this._swap(n,r),n=r,i=ps(n),s=i<t,a=vs(n),o=a<t}values(){return this._heap}[Symbol.iterator](){return this._heap[Symbol.iterator]()}};function T0(e){return e._heap.length-1}function R0(e){return(e+1>>>1)-1}function ps(e){return(e<<1)+1}function vs(e){return e+1<<1}var $p=Math.PI/180,S0=180/Math.PI;function xs(e){return e*S0}var Se=16,G=Se*2,ms={FORWARD:1},I0={YIELD:0,GO:1,STOP:2};function _s(){return{nextAvailableJuncId:1,nextAvailableLaneId:1,juncs:{},lanes:{}}}function Es(e,t,n,r){let i={juncId:t,coordX:n,coordY:r,lanes:[]};return e.juncs[t]=i,i}function L0(e,t){if(e.juncs[t].lanes.length>0)throw new Error("Cannot delete junction with connected lanes.");delete e.juncs[t]}function gs(e,t,n,r,i){let s={laneId:t,laneType:n,from:r,to:i,status:I0.YIELD};return e.lanes[t]=s,e.juncs[r].lanes.push(t),s}function As(e){return e.nextAvailableJuncId++}function C0(e,t){let n=e.lanes[t];if(n)return;delete e.lanes[t];let r=n.from,i=e.juncs[r];i.lanes.splice(i.lanes.indexOf(t),1)}function ys(e){return e.nextAvailableLaneId++}function Zn(e,t,n){for(let r of Object.values(e.juncs))if(r.coordX===t&&r.coordY===n)return r;return null}function Ms(e,t,n,r){if(!n||!r)return e;let i=n.juncId,s=r.juncId;for(let a of Object.values(t.lanes))a.from===i&&a.to===s&&e.push(a);return e}function F0(e,t,n){if(!n)return e;let r=n.juncId;for(let i of Object.values(t.lanes))(i.from===r||i.to===r)&&e.push(i);return e}function Qn(e,t,n,r,i){if(t=Math.floor(t),n=Math.floor(n),r=Math.floor(r),i=Math.floor(i),t===r&&n==i)return!1;let s=r-t,a=i-n;if(Math.abs(s)>1||Math.abs(a)>1){let h=t,u=n,f=!1;return ds(t,n,r,i,(d,p)=>{f||=Qn(e,h,u,d,p),h=d,u=p}),f}let o=Zn(e,t,n),l=Zn(e,r,i),c=[];return Ms(c,e,o,l),Ms(c,e,l,o),c.length>0?!1:(o||(o=Es(e,As(e),t,n)),l||(l=Es(e,As(e),r,i)),gs(e,ys(e),ms.FORWARD,o.juncId,l.juncId),gs(e,ys(e),ms.FORWARD,l.juncId,o.juncId),!0)}function ws(e,t,n){t=Math.floor(t),n=Math.floor(n);let r=Zn(e,t,n),i=[];F0(i,e,r);for(let s of i)C0(e,s.laneId);L0(e,r.juncId)}function bs(e){ze(e,"init",()=>{B0(e),O0(e)}),ze(e,"render",t=>{N0(e,t),D0(e,t)})}function O0(e){let t=_s();e.map=t}function N0(e,t){t.setColor(4473924),k0(t,600,600),t.setColor(16777215),P0(t,e.map)}var Lt=0,Ts=1,Rs=2;function B0(e){e.cursor={prevCoordX:0,prevCoordY:0,nextCoordX:0,nextCoordY:0,action:Lt},ze(e,"update",t=>{switch(e.cursor.action){case Lt:ye.CursorMain.pressed?(e.cursor.action=Ts,e.cursor.prevCoordX=e.cursor.nextCoordX,e.cursor.prevCoordY=e.cursor.nextCoordY):ye.CursorAlt.pressed&&(e.cursor.action=Rs,e.cursor.prevCoordX=e.cursor.nextCoordX,e.cursor.prevCoordY=e.cursor.nextCoordY);break;case Ts:if(ye.CursorMain.released)e.cursor.action=Lt;else{let{prevCoordX:n,prevCoordY:r,nextCoordX:i,nextCoordY:s}=e.cursor,a=i-n,o=s-r;(Math.abs(a)>1||Math.abs(o)>1)&&(e.cursor.prevCoordX=e.cursor.nextCoordX,e.cursor.prevCoordY=e.cursor.nextCoordY,Qn(e.map,n,r,i,s))}break;case Rs:if(ye.CursorAlt.released)e.cursor.action=Lt;else{let{prevCoordX:n,prevCoordY:r,nextCoordX:i,nextCoordY:s}=e.cursor,a=i-n,o=s-r;(Math.abs(a)>1||Math.abs(o)>1)&&(e.cursor.prevCoordX=e.cursor.nextCoordX,e.cursor.prevCoordY=e.cursor.nextCoordY,ws(e.map,n,r))}break}})}function D0(e,t){let n=ye.CursorX.value*2-1,r=1-ye.CursorY.value*2,[i,s]=Ji([0,0,0],n,r,t.getProjectionMatrix(),t.getViewMatrix());e.cursor.nextCoordX=i/G,e.cursor.nextCoordY=s/G,Ss(t,e.cursor.nextCoordX*G,e.cursor.nextCoordY*G),Ss(t,e.cursor.prevCoordX*G,e.cursor.prevCoordY*G)}function Ss(e,t,n){t=Math.floor(t/G)*G,n=Math.floor(n/G)*G,e.setColor(16777215),e.drawLineRect(t-1,n-1,t+G+1,n+G+1),e.setColor(0),e.drawLineRect(t,n,t+G,n+G)}function P0(e,t){for(let n of Object.values(t.juncs)){let r=n.coordX,i=n.coordY;H0(e,r*G,i*G)}for(let n of Object.values(t.lanes))U0(e,t,n);for(let n of Object.values(t.lanes));}function U0(e,t,n){let r=t.juncs[n.from],i=t.juncs[n.to],s=r.coordX*G,a=r.coordY*G,o=i.coordX*G,l=i.coordY*G,c=o-s,h=l-a,u=Math.sqrt(h*h+c*c)/2,f=Math.atan2(h,c);e.pushTransform();let d=s+Se,p=a+Se;e.setTranslation(d,p,0),e.setRotation(0,0,xs(f)),e.setColor(16777215),e.drawBox(u,0,u,Se),e.popTransform()}function k0(e,t,n){for(let r=0;r<t/G;++r)e.drawLine(r*G,0,r*G,n);for(let r=0;r<n/G;++r)e.drawLine(0,r*G,t,r*G)}function H0(e,t,n){e.drawCircle(t+Se,n+Se,Se)}window.addEventListener("DOMContentLoaded",z0);async function z0(){let e={listeners:{update:[],draw:[]}};await Jr();let t=await ci(),{display:n,ctx:r}=is(e);bs(e),tt(e,"init"),n.addEventListener("frame",i=>{let{now:s,deltaTime:a}=i.detail;tt(e,"update",a),t.poll(s),tt(e,"input"),r.resize(),r.reset(),r.pushTransform(),tt(e,"render",r),r.popTransform()})}})();
//# sourceMappingURL=main.js.map
