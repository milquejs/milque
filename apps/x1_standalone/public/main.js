(()=>{var Dr=Object.create,He=Object.defineProperty;var Pr=Object.getOwnPropertyDescriptor;var Ur=Object.getOwnPropertyNames;var Fr=Object.getPrototypeOf,Hr=Object.prototype.hasOwnProperty;var kr=e=>He(e,"__esModule",{value:!0});var zr=(e,t)=>()=>(e&&(t=e(e=0)),t),ye=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),ke=(e,t)=>{for(var n in t)He(e,n,{get:t[n],enumerable:!0})},Kr=(e,t,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of Ur(t))!Hr.call(e,r)&&r!=="default"&&He(e,r,{get:()=>t[r],enumerable:!(n=Pr(t,r))||n.enumerable});return e},Yr=e=>Kr(kr(He(e!=null?Dr(Fr(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var yn={};ke(yn,{basename:()=>An,default:()=>xs,delimiter:()=>En,dirname:()=>_n,extname:()=>xn,isAbsolute:()=>xt,join:()=>dn,normalize:()=>At,relative:()=>vn,resolve:()=>Ke,sep:()=>mn});function pn(e,t){for(var n=0,r=e.length-1;r>=0;r--){var i=e[r];i==="."?e.splice(r,1):i===".."?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function Ke(){for(var e="",t=!1,n=arguments.length-1;n>=-1&&!t;n--){var r=n>=0?arguments[n]:"/";if(typeof r!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!r)continue;e=r+"/"+e,t=r.charAt(0)==="/"}return e=pn(yt(e.split("/"),function(i){return!!i}),!t).join("/"),(t?"/":"")+e||"."}function At(e){var t=xt(e),n=ys(e,-1)==="/";return e=pn(yt(e.split("/"),function(r){return!!r}),!t).join("/"),!e&&!t&&(e="."),e&&n&&(e+="/"),(t?"/":"")+e}function xt(e){return e.charAt(0)==="/"}function dn(){var e=Array.prototype.slice.call(arguments,0);return At(yt(e,function(t,n){if(typeof t!="string")throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))}function vn(e,t){e=Ke(e).substr(1),t=Ke(t).substr(1);function n(u){for(var c=0;c<u.length&&u[c]==="";c++);for(var f=u.length-1;f>=0&&u[f]==="";f--);return c>f?[]:u.slice(c,f-c+1)}for(var r=n(e.split("/")),i=n(t.split("/")),s=Math.min(r.length,i.length),a=s,o=0;o<s;o++)if(r[o]!==i[o]){a=o;break}for(var l=[],o=a;o<r.length;o++)l.push("..");return l=l.concat(i.slice(a)),l.join("/")}function _n(e){var t=_t(e),n=t[0],r=t[1];return!n&&!r?".":(r&&(r=r.substr(0,r.length-1)),n+r)}function An(e,t){var n=_t(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n}function xn(e){return _t(e)[3]}function yt(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}var As,_t,mn,En,xs,ys,gn=zr(()=>{As=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,_t=function(e){return As.exec(e).slice(1)};mn="/",En=":";xs={extname:xn,basename:An,dirname:_n,sep:mn,delimiter:En,relative:vn,join:dn,isAbsolute:xt,normalize:At,resolve:Ke};ys="ab".substr(-1)==="b"?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}});var $e=ye((Ql,Ye)=>{var be=(gn(),yn);if(be&&be.default){Ye.exports=be.default;for(let e in be)Ye.exports[e]=be[e]}else be&&(Ye.exports=be)});var Be=ye((Jl,Sn)=>{"use strict";var gs=$e(),ce="\\\\/",wn=`[^${ce}]`,de="\\.",ws="\\+",bs="\\?",Ge="\\/",Ts="(?=.)",bn="[^/]",gt=`(?:${Ge}|$)`,Tn=`(?:^|${Ge})`,wt=`${de}{1,2}${gt}`,Ms=`(?!${de})`,Ss=`(?!${Tn}${wt})`,Rs=`(?!${de}{0,1}${gt})`,Is=`(?!${wt})`,Ls=`[^.${Ge}]`,Cs=`${bn}*?`,Mn={DOT_LITERAL:de,PLUS_LITERAL:ws,QMARK_LITERAL:bs,SLASH_LITERAL:Ge,ONE_CHAR:Ts,QMARK:bn,END_ANCHOR:gt,DOTS_SLASH:wt,NO_DOT:Ms,NO_DOTS:Ss,NO_DOT_SLASH:Rs,NO_DOTS_SLASH:Is,QMARK_NO_DOT:Ls,STAR:Cs,START_ANCHOR:Tn},Os={...Mn,SLASH_LITERAL:`[${ce}]`,QMARK:wn,STAR:`${wn}*?`,DOTS_SLASH:`${de}{1,2}(?:[${ce}]|$)`,NO_DOT:`(?!${de})`,NO_DOTS:`(?!(?:^|[${ce}])${de}{1,2}(?:[${ce}]|$))`,NO_DOT_SLASH:`(?!${de}{0,1}(?:[${ce}]|$))`,NO_DOTS_SLASH:`(?!${de}{1,2}(?:[${ce}]|$))`,QMARK_NO_DOT:`[^.${ce}]`,START_ANCHOR:`(?:^|[${ce}])`,END_ANCHOR:`(?:[${ce}]|$)`},Bs={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};Sn.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:Bs,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:gs.sep,extglobChars(e){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${e.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(e){return e===!0?Os:Mn}}});var Ve=ye(te=>{"use strict";var Ns=$e(),Ds=!1,{REGEX_BACKSLASH:Ps,REGEX_REMOVE_BACKSLASH:Us,REGEX_SPECIAL_CHARS:Fs,REGEX_SPECIAL_CHARS_GLOBAL:Hs}=Be();te.isObject=e=>e!==null&&typeof e=="object"&&!Array.isArray(e);te.hasRegexChars=e=>Fs.test(e);te.isRegexChar=e=>e.length===1&&te.hasRegexChars(e);te.escapeRegex=e=>e.replace(Hs,"\\$1");te.toPosixSlashes=e=>e.replace(Ps,"/");te.removeBackslashes=e=>e.replace(Us,t=>t==="\\"?"":t);te.supportsLookbehinds=()=>{let e=process.version.slice(1).split(".").map(Number);return e.length===3&&e[0]>=9||e[0]===8&&e[1]>=10};te.isWindows=e=>e&&typeof e.windows=="boolean"?e.windows:Ds===!0||Ns.sep==="\\";te.escapeLast=(e,t,n)=>{let r=e.lastIndexOf(t,n);return r===-1?e:e[r-1]==="\\"?te.escapeLast(e,t,r-1):`${e.slice(0,r)}\\${e.slice(r)}`};te.removePrefix=(e,t={})=>{let n=e;return n.startsWith("./")&&(n=n.slice(2),t.prefix="./"),n};te.wrapOutput=(e,t={},n={})=>{let r=n.contains?"":"^",i=n.contains?"":"$",s=`${r}(?:${e})${i}`;return t.negated===!0&&(s=`(?:^(?!${s}).*$)`),s}});var Dn=ye((tu,Nn)=>{"use strict";var Rn=Ve(),{CHAR_ASTERISK:bt,CHAR_AT:ks,CHAR_BACKWARD_SLASH:Ne,CHAR_COMMA:zs,CHAR_DOT:Tt,CHAR_EXCLAMATION_MARK:Mt,CHAR_FORWARD_SLASH:In,CHAR_LEFT_CURLY_BRACE:St,CHAR_LEFT_PARENTHESES:Rt,CHAR_LEFT_SQUARE_BRACKET:Ks,CHAR_PLUS:Ys,CHAR_QUESTION_MARK:Ln,CHAR_RIGHT_CURLY_BRACE:$s,CHAR_RIGHT_PARENTHESES:Cn,CHAR_RIGHT_SQUARE_BRACKET:Gs}=Be(),On=e=>e===In||e===Ne,Bn=e=>{e.isPrefix!==!0&&(e.depth=e.isGlobstar?Infinity:1)},Vs=(e,t)=>{let n=t||{},r=e.length-1,i=n.parts===!0||n.scanToEnd===!0,s=[],a=[],o=[],l=e,u=-1,c=0,f=0,h=!1,d=!1,v=!1,_=!1,p=!1,x=!1,I=!1,g=!1,b=!1,T=!1,R=0,P,y,L={value:"",depth:0,isGlob:!1},D=()=>u>=r,m=()=>l.charCodeAt(u+1),O=()=>(P=y,l.charCodeAt(++u));for(;u<r;){y=O();let $;if(y===Ne){I=L.backslashes=!0,y=O(),y===St&&(x=!0);continue}if(x===!0||y===St){for(R++;D()!==!0&&(y=O());){if(y===Ne){I=L.backslashes=!0,O();continue}if(y===St){R++;continue}if(x!==!0&&y===Tt&&(y=O())===Tt){if(h=L.isBrace=!0,v=L.isGlob=!0,T=!0,i===!0)continue;break}if(x!==!0&&y===zs){if(h=L.isBrace=!0,v=L.isGlob=!0,T=!0,i===!0)continue;break}if(y===$s&&(R--,R===0)){x=!1,h=L.isBrace=!0,T=!0;break}}if(i===!0)continue;break}if(y===In){if(s.push(u),a.push(L),L={value:"",depth:0,isGlob:!1},T===!0)continue;if(P===Tt&&u===c+1){c+=2;continue}f=u+1;continue}if(n.noext!==!0&&(y===Ys||y===ks||y===bt||y===Ln||y===Mt)===!0&&m()===Rt){if(v=L.isGlob=!0,_=L.isExtglob=!0,T=!0,y===Mt&&u===c&&(b=!0),i===!0){for(;D()!==!0&&(y=O());){if(y===Ne){I=L.backslashes=!0,y=O();continue}if(y===Cn){v=L.isGlob=!0,T=!0;break}}continue}break}if(y===bt){if(P===bt&&(p=L.isGlobstar=!0),v=L.isGlob=!0,T=!0,i===!0)continue;break}if(y===Ln){if(v=L.isGlob=!0,T=!0,i===!0)continue;break}if(y===Ks){for(;D()!==!0&&($=O());){if($===Ne){I=L.backslashes=!0,O();continue}if($===Gs){d=L.isBracket=!0,v=L.isGlob=!0,T=!0;break}}if(i===!0)continue;break}if(n.nonegate!==!0&&y===Mt&&u===c){g=L.negated=!0,c++;continue}if(n.noparen!==!0&&y===Rt){if(v=L.isGlob=!0,i===!0){for(;D()!==!0&&(y=O());){if(y===Rt){I=L.backslashes=!0,y=O();continue}if(y===Cn){T=!0;break}}continue}break}if(v===!0){if(T=!0,i===!0)continue;break}}n.noext===!0&&(_=!1,v=!1);let B=l,N="",E="";c>0&&(N=l.slice(0,c),l=l.slice(c),f-=c),B&&v===!0&&f>0?(B=l.slice(0,f),E=l.slice(f)):v===!0?(B="",E=l):B=l,B&&B!==""&&B!=="/"&&B!==l&&On(B.charCodeAt(B.length-1))&&(B=B.slice(0,-1)),n.unescape===!0&&(E&&(E=Rn.removeBackslashes(E)),B&&I===!0&&(B=Rn.removeBackslashes(B)));let A={prefix:N,input:e,start:c,base:B,glob:E,isBrace:h,isBracket:d,isGlob:v,isExtglob:_,isGlobstar:p,negated:g,negatedExtglob:b};if(n.tokens===!0&&(A.maxDepth=0,On(y)||a.push(L),A.tokens=a),n.parts===!0||n.tokens===!0){let $;for(let H=0;H<s.length;H++){let q=$?$+1:c,X=s[H],Z=e.slice(q,X);n.tokens&&(H===0&&c!==0?(a[H].isPrefix=!0,a[H].value=N):a[H].value=Z,Bn(a[H]),A.maxDepth+=a[H].depth),(H!==0||Z!=="")&&o.push(Z),$=X}if($&&$+1<e.length){let H=e.slice($+1);o.push(H),n.tokens&&(a[a.length-1].value=H,Bn(a[a.length-1]),A.maxDepth+=a[a.length-1].depth)}A.slashes=s,A.parts=o}return A};Nn.exports=Vs});var Fn=ye((nu,Un)=>{"use strict";var We=Be(),re=Ve(),{MAX_LENGTH:je,POSIX_REGEX_SOURCE:Ws,REGEX_NON_SPECIAL_CHARS:js,REGEX_SPECIAL_CHARS_BACKREF:qs,REPLACEMENTS:Pn}=We,Xs=(e,t)=>{if(typeof t.expandRange=="function")return t.expandRange(...e,t);e.sort();let n=`[${e.join("-")}]`;try{new RegExp(n)}catch(r){return e.map(i=>re.escapeRegex(i)).join("..")}return n},Se=(e,t)=>`Missing ${e}: "${t}" - use "\\\\${t}" to match literal characters`,It=(e,t)=>{if(typeof e!="string")throw new TypeError("Expected a string");e=Pn[e]||e;let n={...t},r=typeof n.maxLength=="number"?Math.min(je,n.maxLength):je,i=e.length;if(i>r)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${r}`);let s={type:"bos",value:"",output:n.prepend||""},a=[s],o=n.capture?"":"?:",l=re.isWindows(t),u=We.globChars(l),c=We.extglobChars(u),{DOT_LITERAL:f,PLUS_LITERAL:h,SLASH_LITERAL:d,ONE_CHAR:v,DOTS_SLASH:_,NO_DOT:p,NO_DOT_SLASH:x,NO_DOTS_SLASH:I,QMARK:g,QMARK_NO_DOT:b,STAR:T,START_ANCHOR:R}=u,P=S=>`(${o}(?:(?!${R}${S.dot?_:f}).)*?)`,y=n.dot?"":p,L=n.dot?g:b,D=n.bash===!0?P(n):T;n.capture&&(D=`(${D})`),typeof n.noext=="boolean"&&(n.noextglob=n.noext);let m={input:e,index:-1,start:0,dot:n.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:a};e=re.removePrefix(e,m),i=e.length;let O=[],B=[],N=[],E=s,A,$=()=>m.index===i-1,H=m.peek=(S=1)=>e[m.index+S],q=m.advance=()=>e[++m.index]||"",X=()=>e.slice(m.index+1),Z=(S="",z=0)=>{m.consumed+=S,m.index+=z},le=S=>{m.output+=S.output!=null?S.output:S.value,Z(S.value)},Ce=()=>{let S=1;for(;H()==="!"&&(H(2)!=="("||H(3)==="?");)q(),m.start++,S++;return S%2==0?!1:(m.negated=!0,m.start++,!0)},me=S=>{m[S]++,N.push(S)},ue=S=>{m[S]--,N.pop()},U=S=>{if(E.type==="globstar"){let z=m.braces>0&&(S.type==="comma"||S.type==="brace"),w=S.extglob===!0||O.length&&(S.type==="pipe"||S.type==="paren");S.type!=="slash"&&S.type!=="paren"&&!z&&!w&&(m.output=m.output.slice(0,-E.output.length),E.type="star",E.value="*",E.output=D,m.output+=E.output)}if(O.length&&S.type!=="paren"&&(O[O.length-1].inner+=S.value),(S.value||S.output)&&le(S),E&&E.type==="text"&&S.type==="text"){E.value+=S.value,E.output=(E.output||"")+S.value;return}S.prev=E,a.push(S),E=S},xe=(S,z)=>{let w={...c[z],conditions:1,inner:""};w.prev=E,w.parens=m.parens,w.output=m.output;let F=(n.capture?"(":"")+w.open;me("parens"),U({type:S,value:z,output:m.output?"":v}),U({type:"paren",extglob:!0,value:q(),output:F}),O.push(w)},Ue=S=>{let z=S.close+(n.capture?")":""),w;if(S.type==="negate"){let F=D;if(S.inner&&S.inner.length>1&&S.inner.includes("/")&&(F=P(n)),(F!==D||$()||/^\)+$/.test(X()))&&(z=S.close=`)$))${F}`),S.inner.includes("*")&&(w=X())&&/^\.[^\\/.]+$/.test(w)){let G=It(w,{...t,fastpaths:!1}).output;z=S.close=`)${G})${F})`}S.prev.type==="bos"&&(m.negatedExtglob=!0)}U({type:"paren",extglob:!0,value:A,output:z}),ue("parens")};if(n.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(e)){let S=!1,z=e.replace(qs,(w,F,G,J,j,it)=>J==="\\"?(S=!0,w):J==="?"?F?F+J+(j?g.repeat(j.length):""):it===0?L+(j?g.repeat(j.length):""):g.repeat(G.length):J==="."?f.repeat(G.length):J==="*"?F?F+J+(j?D:""):D:F?w:`\\${w}`);return S===!0&&(n.unescape===!0?z=z.replace(/\\/g,""):z=z.replace(/\\+/g,w=>w.length%2==0?"\\\\":w?"\\":"")),z===e&&n.contains===!0?(m.output=e,m):(m.output=re.wrapOutput(z,m,t),m)}for(;!$();){if(A=q(),A==="\0")continue;if(A==="\\"){let w=H();if(w==="/"&&n.bash!==!0||w==="."||w===";")continue;if(!w){A+="\\",U({type:"text",value:A});continue}let F=/^\\+/.exec(X()),G=0;if(F&&F[0].length>2&&(G=F[0].length,m.index+=G,G%2!=0&&(A+="\\")),n.unescape===!0?A=q():A+=q(),m.brackets===0){U({type:"text",value:A});continue}}if(m.brackets>0&&(A!=="]"||E.value==="["||E.value==="[^")){if(n.posix!==!1&&A===":"){let w=E.value.slice(1);if(w.includes("[")&&(E.posix=!0,w.includes(":"))){let F=E.value.lastIndexOf("["),G=E.value.slice(0,F),J=E.value.slice(F+2),j=Ws[J];if(j){E.value=G+j,m.backtrack=!0,q(),!s.output&&a.indexOf(E)===1&&(s.output=v);continue}}}(A==="["&&H()!==":"||A==="-"&&H()==="]")&&(A=`\\${A}`),A==="]"&&(E.value==="["||E.value==="[^")&&(A=`\\${A}`),n.posix===!0&&A==="!"&&E.value==="["&&(A="^"),E.value+=A,le({value:A});continue}if(m.quotes===1&&A!=='"'){A=re.escapeRegex(A),E.value+=A,le({value:A});continue}if(A==='"'){m.quotes=m.quotes===1?0:1,n.keepQuotes===!0&&U({type:"text",value:A});continue}if(A==="("){me("parens"),U({type:"paren",value:A});continue}if(A===")"){if(m.parens===0&&n.strictBrackets===!0)throw new SyntaxError(Se("opening","("));let w=O[O.length-1];if(w&&m.parens===w.parens+1){Ue(O.pop());continue}U({type:"paren",value:A,output:m.parens?")":"\\)"}),ue("parens");continue}if(A==="["){if(n.nobracket===!0||!X().includes("]")){if(n.nobracket!==!0&&n.strictBrackets===!0)throw new SyntaxError(Se("closing","]"));A=`\\${A}`}else me("brackets");U({type:"bracket",value:A});continue}if(A==="]"){if(n.nobracket===!0||E&&E.type==="bracket"&&E.value.length===1){U({type:"text",value:A,output:`\\${A}`});continue}if(m.brackets===0){if(n.strictBrackets===!0)throw new SyntaxError(Se("opening","["));U({type:"text",value:A,output:`\\${A}`});continue}ue("brackets");let w=E.value.slice(1);if(E.posix!==!0&&w[0]==="^"&&!w.includes("/")&&(A=`/${A}`),E.value+=A,le({value:A}),n.literalBrackets===!1||re.hasRegexChars(w))continue;let F=re.escapeRegex(E.value);if(m.output=m.output.slice(0,-E.value.length),n.literalBrackets===!0){m.output+=F,E.value=F;continue}E.value=`(${o}${F}|${E.value})`,m.output+=E.value;continue}if(A==="{"&&n.nobrace!==!0){me("braces");let w={type:"brace",value:A,output:"(",outputIndex:m.output.length,tokensIndex:m.tokens.length};B.push(w),U(w);continue}if(A==="}"){let w=B[B.length-1];if(n.nobrace===!0||!w){U({type:"text",value:A,output:A});continue}let F=")";if(w.dots===!0){let G=a.slice(),J=[];for(let j=G.length-1;j>=0&&(a.pop(),G[j].type!=="brace");j--)G[j].type!=="dots"&&J.unshift(G[j].value);F=Xs(J,n),m.backtrack=!0}if(w.comma!==!0&&w.dots!==!0){let G=m.output.slice(0,w.outputIndex),J=m.tokens.slice(w.tokensIndex);w.value=w.output="\\{",A=F="\\}",m.output=G;for(let j of J)m.output+=j.output||j.value}U({type:"brace",value:A,output:F}),ue("braces"),B.pop();continue}if(A==="|"){O.length>0&&O[O.length-1].conditions++,U({type:"text",value:A});continue}if(A===","){let w=A,F=B[B.length-1];F&&N[N.length-1]==="braces"&&(F.comma=!0,w="|"),U({type:"comma",value:A,output:w});continue}if(A==="/"){if(E.type==="dot"&&m.index===m.start+1){m.start=m.index+1,m.consumed="",m.output="",a.pop(),E=s;continue}U({type:"slash",value:A,output:d});continue}if(A==="."){if(m.braces>0&&E.type==="dot"){E.value==="."&&(E.output=f);let w=B[B.length-1];E.type="dots",E.output+=A,E.value+=A,w.dots=!0;continue}if(m.braces+m.parens===0&&E.type!=="bos"&&E.type!=="slash"){U({type:"text",value:A,output:f});continue}U({type:"dot",value:A,output:f});continue}if(A==="?"){if(!(E&&E.value==="(")&&n.noextglob!==!0&&H()==="("&&H(2)!=="?"){xe("qmark",A);continue}if(E&&E.type==="paren"){let F=H(),G=A;if(F==="<"&&!re.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(E.value==="("&&!/[!=<:]/.test(F)||F==="<"&&!/<([!=]|\w+>)/.test(X()))&&(G=`\\${A}`),U({type:"text",value:A,output:G});continue}if(n.dot!==!0&&(E.type==="slash"||E.type==="bos")){U({type:"qmark",value:A,output:b});continue}U({type:"qmark",value:A,output:g});continue}if(A==="!"){if(n.noextglob!==!0&&H()==="("&&(H(2)!=="?"||!/[!=<:]/.test(H(3)))){xe("negate",A);continue}if(n.nonegate!==!0&&m.index===0){Ce();continue}}if(A==="+"){if(n.noextglob!==!0&&H()==="("&&H(2)!=="?"){xe("plus",A);continue}if(E&&E.value==="("||n.regex===!1){U({type:"plus",value:A,output:h});continue}if(E&&(E.type==="bracket"||E.type==="paren"||E.type==="brace")||m.parens>0){U({type:"plus",value:A});continue}U({type:"plus",value:h});continue}if(A==="@"){if(n.noextglob!==!0&&H()==="("&&H(2)!=="?"){U({type:"at",extglob:!0,value:A,output:""});continue}U({type:"text",value:A});continue}if(A!=="*"){(A==="$"||A==="^")&&(A=`\\${A}`);let w=js.exec(X());w&&(A+=w[0],m.index+=w[0].length),U({type:"text",value:A});continue}if(E&&(E.type==="globstar"||E.star===!0)){E.type="star",E.star=!0,E.value+=A,E.output=D,m.backtrack=!0,m.globstar=!0,Z(A);continue}let S=X();if(n.noextglob!==!0&&/^\([^?]/.test(S)){xe("star",A);continue}if(E.type==="star"){if(n.noglobstar===!0){Z(A);continue}let w=E.prev,F=w.prev,G=w.type==="slash"||w.type==="bos",J=F&&(F.type==="star"||F.type==="globstar");if(n.bash===!0&&(!G||S[0]&&S[0]!=="/")){U({type:"star",value:A,output:""});continue}let j=m.braces>0&&(w.type==="comma"||w.type==="brace"),it=O.length&&(w.type==="pipe"||w.type==="paren");if(!G&&w.type!=="paren"&&!j&&!it){U({type:"star",value:A,output:""});continue}for(;S.slice(0,3)==="/**";){let Fe=e[m.index+4];if(Fe&&Fe!=="/")break;S=S.slice(3),Z("/**",3)}if(w.type==="bos"&&$()){E.type="globstar",E.value+=A,E.output=P(n),m.output=E.output,m.globstar=!0,Z(A);continue}if(w.type==="slash"&&w.prev.type!=="bos"&&!J&&$()){m.output=m.output.slice(0,-(w.output+E.output).length),w.output=`(?:${w.output}`,E.type="globstar",E.output=P(n)+(n.strictSlashes?")":"|$)"),E.value+=A,m.globstar=!0,m.output+=w.output+E.output,Z(A);continue}if(w.type==="slash"&&w.prev.type!=="bos"&&S[0]==="/"){let Fe=S[1]!==void 0?"|$":"";m.output=m.output.slice(0,-(w.output+E.output).length),w.output=`(?:${w.output}`,E.type="globstar",E.output=`${P(n)}${d}|${d}${Fe})`,E.value+=A,m.output+=w.output+E.output,m.globstar=!0,Z(A+q()),U({type:"slash",value:"/",output:""});continue}if(w.type==="bos"&&S[0]==="/"){E.type="globstar",E.value+=A,E.output=`(?:^|${d}|${P(n)}${d})`,m.output=E.output,m.globstar=!0,Z(A+q()),U({type:"slash",value:"/",output:""});continue}m.output=m.output.slice(0,-E.output.length),E.type="globstar",E.output=P(n),E.value+=A,m.output+=E.output,m.globstar=!0,Z(A);continue}let z={type:"star",value:A,output:D};if(n.bash===!0){z.output=".*?",(E.type==="bos"||E.type==="slash")&&(z.output=y+z.output),U(z);continue}if(E&&(E.type==="bracket"||E.type==="paren")&&n.regex===!0){z.output=A,U(z);continue}(m.index===m.start||E.type==="slash"||E.type==="dot")&&(E.type==="dot"?(m.output+=x,E.output+=x):n.dot===!0?(m.output+=I,E.output+=I):(m.output+=y,E.output+=y),H()!=="*"&&(m.output+=v,E.output+=v)),U(z)}for(;m.brackets>0;){if(n.strictBrackets===!0)throw new SyntaxError(Se("closing","]"));m.output=re.escapeLast(m.output,"["),ue("brackets")}for(;m.parens>0;){if(n.strictBrackets===!0)throw new SyntaxError(Se("closing",")"));m.output=re.escapeLast(m.output,"("),ue("parens")}for(;m.braces>0;){if(n.strictBrackets===!0)throw new SyntaxError(Se("closing","}"));m.output=re.escapeLast(m.output,"{"),ue("braces")}if(n.strictSlashes!==!0&&(E.type==="star"||E.type==="bracket")&&U({type:"maybe_slash",value:"",output:`${d}?`}),m.backtrack===!0){m.output="";for(let S of m.tokens)m.output+=S.output!=null?S.output:S.value,S.suffix&&(m.output+=S.suffix)}return m};It.fastpaths=(e,t)=>{let n={...t},r=typeof n.maxLength=="number"?Math.min(je,n.maxLength):je,i=e.length;if(i>r)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${r}`);e=Pn[e]||e;let s=re.isWindows(t),{DOT_LITERAL:a,SLASH_LITERAL:o,ONE_CHAR:l,DOTS_SLASH:u,NO_DOT:c,NO_DOTS:f,NO_DOTS_SLASH:h,STAR:d,START_ANCHOR:v}=We.globChars(s),_=n.dot?f:c,p=n.dot?h:c,x=n.capture?"":"?:",I={negated:!1,prefix:""},g=n.bash===!0?".*?":d;n.capture&&(g=`(${g})`);let b=y=>y.noglobstar===!0?g:`(${x}(?:(?!${v}${y.dot?u:a}).)*?)`,T=y=>{switch(y){case"*":return`${_}${l}${g}`;case".*":return`${a}${l}${g}`;case"*.*":return`${_}${g}${a}${l}${g}`;case"*/*":return`${_}${g}${o}${l}${p}${g}`;case"**":return _+b(n);case"**/*":return`(?:${_}${b(n)}${o})?${p}${l}${g}`;case"**/*.*":return`(?:${_}${b(n)}${o})?${p}${g}${a}${l}${g}`;case"**/.*":return`(?:${_}${b(n)}${o})?${a}${l}${g}`;default:{let L=/^(.*?)\.(\w+)$/.exec(y);if(!L)return;let D=T(L[1]);return D?D+a+L[2]:void 0}}},R=re.removePrefix(e,I),P=T(R);return P&&n.strictSlashes!==!0&&(P+=`${o}?`),P};Un.exports=It});var kn=ye((ru,Hn)=>{"use strict";var Zs=$e(),Qs=Dn(),Lt=Fn(),Ct=Ve(),Js=Be(),ea=e=>e&&typeof e=="object"&&!Array.isArray(e),W=(e,t,n=!1)=>{if(Array.isArray(e)){let c=e.map(h=>W(h,t,n));return h=>{for(let d of c){let v=d(h);if(v)return v}return!1}}let r=ea(e)&&e.tokens&&e.input;if(e===""||typeof e!="string"&&!r)throw new TypeError("Expected pattern to be a non-empty string");let i=t||{},s=Ct.isWindows(t),a=r?W.compileRe(e,t):W.makeRe(e,t,!1,!0),o=a.state;delete a.state;let l=()=>!1;if(i.ignore){let c={...t,ignore:null,onMatch:null,onResult:null};l=W(i.ignore,c,n)}let u=(c,f=!1)=>{let{isMatch:h,match:d,output:v}=W.test(c,a,t,{glob:e,posix:s}),_={glob:e,state:o,regex:a,posix:s,input:c,output:v,match:d,isMatch:h};return typeof i.onResult=="function"&&i.onResult(_),h===!1?(_.isMatch=!1,f?_:!1):l(c)?(typeof i.onIgnore=="function"&&i.onIgnore(_),_.isMatch=!1,f?_:!1):(typeof i.onMatch=="function"&&i.onMatch(_),f?_:!0)};return n&&(u.state=o),u};W.test=(e,t,n,{glob:r,posix:i}={})=>{if(typeof e!="string")throw new TypeError("Expected input to be a string");if(e==="")return{isMatch:!1,output:""};let s=n||{},a=s.format||(i?Ct.toPosixSlashes:null),o=e===r,l=o&&a?a(e):e;return o===!1&&(l=a?a(e):e,o=l===r),(o===!1||s.capture===!0)&&(s.matchBase===!0||s.basename===!0?o=W.matchBase(e,t,n,i):o=t.exec(l)),{isMatch:Boolean(o),match:o,output:l}};W.matchBase=(e,t,n,r=Ct.isWindows(n))=>(t instanceof RegExp?t:W.makeRe(t,n)).test(Zs.basename(e));W.isMatch=(e,t,n)=>W(t,n)(e);W.parse=(e,t)=>Array.isArray(e)?e.map(n=>W.parse(n,t)):Lt(e,{...t,fastpaths:!1});W.scan=(e,t)=>Qs(e,t);W.compileRe=(e,t,n=!1,r=!1)=>{if(n===!0)return e.output;let i=t||{},s=i.contains?"":"^",a=i.contains?"":"$",o=`${s}(?:${e.output})${a}`;e&&e.negated===!0&&(o=`^(?!${o}).*$`);let l=W.toRegex(o,t);return r===!0&&(l.state=e),l};W.makeRe=(e,t={},n=!1,r=!1)=>{if(!e||typeof e!="string")throw new TypeError("Expected a non-empty string");let i={negated:!1,fastpaths:!0};return t.fastpaths!==!1&&(e[0]==="."||e[0]==="*")&&(i.output=Lt.fastpaths(e,t)),i.output||(i=Lt(e,t)),W.compileRe(i,t,n,r)};W.toRegex=(e,t)=>{try{let n=t||{};return new RegExp(e,n.flags||(n.nocase?"i":""))}catch(n){if(t&&t.debug===!0)throw n;return/$^/}};W.constants=Js;Hn.exports=W});var Kn=ye((iu,zn)=>{"use strict";zn.exports=kn()});var $r=`<div class="container">
  <label class="hidden" id="title">display-port</label>
  <label class="hidden" id="fps">00</label>
  <label class="hidden" id="dimension">0x0</label>
  <div class="content">
    <canvas> Oh no! Your browser does not support canvas. </canvas>
    <slot id="inner"></slot>
  </div>
  <slot name="frame"></slot>
</div>
`,Gr=`:host {
  display: inline-block;
  color: #555555;
}

.container {
  display: flex;
  position: relative;
  width: 100%;
  height: 100%;
}

.content {
  position: relative;
  margin: auto;
}

.content > *:not(canvas) {
  width: 100%;
  height: 100%;
}

canvas {
  background: #000000;
  image-rendering: pixelated;
}

label {
  position: absolute;
  font-family: monospace;
  color: currentColor;
}

#inner {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: 0;
  left: 0;
  pointer-events: none;
}

#title {
  left: 0.5rem;
  top: 0.5rem;
}

#fps {
  right: 0.5rem;
  top: 0.5rem;
}

#dimension {
  left: 0.5rem;
  bottom: 0.5rem;
}

.hidden {
  display: none;
}

:host([debug]) .container {
  outline: 6px dashed rgba(0, 0, 0, 0.1);
  outline-offset: -4px;
  background-color: rgba(0, 0, 0, 0.1);
}

:host([mode='noscale']) canvas {
  margin: 0;
  top: 0;
  left: 0;
}

:host([mode='stretch']) canvas,
:host([mode='scale']) canvas {
  width: 100%;
  height: 100%;
}

:host([mode='fit']),
:host([mode='scale']),
:host([mode='center']),
:host([mode='stretch']),
:host([mode='fill']) {
  width: 100%;
  height: 100%;
}

:host([full]) {
  width: 100vw !important;
  height: 100vh !important;
}

:host([disabled]) {
  display: none;
}

slot {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  pointer-events: none;
}

::slotted(*) {
  pointer-events: auto;
}
`,Qt="noscale",st="fit",Jt="scale",en="fill",tn="stretch",Vr=300,Wr=150,jr=st,qr=200,nn=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=$r,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Gr,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("display-port",this)}static get observedAttributes(){return["debug","disabled","width","height","onframe","id","class"]}get mode(){return this.getAttribute("mode")}set mode(t){this.setAttribute("mode",t)}get debug(){return this._debug}set debug(t){this.toggleAttribute("debug",t)}get disabled(){return this._disabled}set disabled(t){this.toggleAttribute("disabled",t)}get width(){return this._width}set width(t){this.setAttribute("width",String(t))}get height(){return this._height}set height(t){this.setAttribute("height",String(t))}get onframe(){return this._onframe}set onframe(t){this._onframe&&this.removeEventListener("frame",this._onframe),this._onframe=t,this._onframe&&this.addEventListener("frame",t)}constructor(){super();let t=this.attachShadow({mode:"open"});t.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),t.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._canvasElement=t.querySelector("canvas"),this._contentElement=t.querySelector(".content"),this._innerElement=t.querySelector("#inner"),this._titleElement=t.querySelector("#title"),this._fpsElement=t.querySelector("#fps"),this._dimensionElement=t.querySelector("#dimension"),this._debug=!1,this._disabled=!1,this._width=Vr,this._height=Wr,this._onframe=void 0,this._animationRequestHandle=0,this._prevAnimationFrameTime=0,this._resizeTimeoutHandle=0,this._resizeCanvasWidth=0,this._resizeCanvasHeight=0,this._frameEvent=new CustomEvent("frame",{composed:!0,bubbles:!1,detail:{now:0,prevTime:0,deltaTime:0,canvas:this._canvasElement}}),this._resizeEvent=new CustomEvent("resize",{composed:!0,bubbles:!1,detail:{width:0,height:0}}),this.update=this.update.bind(this),this.onDelayCanvasResize=this.onDelayCanvasResize.bind(this)}get canvas(){return this._canvasElement}connectedCallback(){Me(this,"mode"),Me(this,"debug"),Me(this,"disabled"),Me(this,"width"),Me(this,"height"),Me(this,"onframe"),this.hasAttribute("mode")||this.setAttribute("mode",jr),this.hasAttribute("tabindex")||this.setAttribute("tabindex","0"),this.updateCanvasSize(!0),this.resume()}disconnectedCallback(){this.pause()}attributeChangedCallback(t,n,r){switch(t){case"debug":this._debug=r!==null;break;case"disabled":this._disabled=r!==null;break;case"width":this._width=Number(r);break;case"height":this._height=Number(r);break;case"onframe":this.onframe=new Function("event","with(document){with(this){"+r+"}}").bind(this);break}switch(t){case"disabled":r?(this.update(0),this.pause()):this.resume();break;case"id":case"class":this._titleElement.innerHTML=`display-port${this.className?"."+this.className:""}${this.hasAttribute("id")?"#"+this.getAttribute("id"):""}`;break;case"debug":this._titleElement.classList.toggle("hidden",r),this._fpsElement.classList.toggle("hidden",r),this._dimensionElement.classList.toggle("hidden",r);break}}getContext(t="2d",n=void 0){return this._canvasElement.getContext(t,n)}pause(){cancelAnimationFrame(this._animationRequestHandle)}resume(){this._animationRequestHandle=requestAnimationFrame(this.update)}update(t){this._animationRequestHandle=requestAnimationFrame(this.update),this.updateCanvasSize(!1);let n=t-this._prevAnimationFrameTime;if(this._prevAnimationFrameTime=t,this._debug){let s=n<=0?"--":String(Math.round(1e3/n)).padStart(2,"0");if(this._fpsElement.textContent!==s&&(this._fpsElement.textContent=s),this.mode===Qt){let o=`${this._width}x${this._height}`;this._dimensionElement.textContent!==o&&(this._dimensionElement.textContent=o)}else{let o=`${this._width}x${this._height}|${this.shadowRoot.host.clientWidth}x${this.shadowRoot.host.clientHeight}`;this._dimensionElement.textContent!==o&&(this._dimensionElement.textContent=o)}}let i=this._frameEvent.detail;i.now=t,i.prevTime=this._prevAnimationFrameTime,i.deltaTime=n,this.dispatchEvent(this._frameEvent)}onDelayCanvasResize(){this._resizeTimeoutHandle=0,this.updateCanvasSize(!0)}delayCanvasResize(t,n){(t!==this._resizeCanvasWidth||n!==this._resizeCanvasHeight)&&(this._resizeCanvasWidth=t,this._resizeCanvasHeight=n,this._resizeTimeoutHandle&&clearTimeout(this._resizeTimeoutHandle),this._resizeTimeoutHandle=setTimeout(this.onDelayCanvasResize,qr))}updateCanvasSize(t=!0){let n=this.shadowRoot.host.getBoundingClientRect(),r=n.width,i=n.height,s=this._canvasElement,a=this._width,o=this._height,l=this.mode;if(l===tn||l===en)a=r,o=i;else if(l!==Qt&&(r<a||i<o||l===st||l==Jt)){let c=r/a,f=i/o;c<f?(a=r,o=o*c):(a=a*f,o=i)}if(a=Math.floor(a),o=Math.floor(o),typeof t=="undefined"&&(t=s.clientWidth!==a||s.clientHeight!==o),!t){this.delayCanvasResize(a,o);return}let u=Math.min(a/this._width,o/this._height)*.5;if(this._innerElement.style.fontSize=`font-size: ${u}em`,t){l===Jt?(s.width=this._width,s.height=this._height):l!==tn&&(s.width=a,s.height=o);let c=this._contentElement.style;c.width=`${a}px`,c.height=`${o}px`,(l===st||l===en)&&(this._width=a,this._height=o);let h=this._resizeEvent.detail;h.width=a,h.height=o,this.dispatchEvent(this._resizeEvent)}}};nn.define();function Me(e,t){if(Object.prototype.hasOwnProperty.call(e,t)){let n=e[t];delete e[t],e[t]=n}}var at=class{get polling(){return performance.now()-this._lastPollingTime<1e3}get value(){return 0}get size(){return this._size}constructor(t){this._size=t,this._lastPollingTime=Number.MIN_SAFE_INTEGER}resize(t){this._size=t}getState(t){throw new Error("Missing implementation.")}onUpdate(t,n,r){throw new Error("Missing implementation.")}onStatus(t,n){throw new Error("Missing implementation.")}onPoll(t){this._lastPollingTime=t}onBind(t,n=void 0){t>=this._size&&this.resize(t+1)}onUnbind(){this.resize(0)}},Oe=class extends at{static createAxisBindingState(){return{value:0,delta:0,inverted:!1}}get delta(){return this._delta}get value(){return this._value}constructor(t=0){super(t);let n=new Array,r=this.constructor;for(let i=0;i<t;++i)n.push(r.createAxisBindingState());this._state=n,this._value=0,this._delta=0}resize(t){let n=this._state,r=n.length,i;if(t<=r)i=n.slice(0,t);else{i=n;let s=this.constructor;for(let a=r;a<t;++a)i.push(s.createAxisBindingState())}this._state=i,super.resize(t)}getState(t){return this._state[t].value}onPoll(t){let n=this._state,r=0,i=0,s=n.length;for(let a=0;a<s;++a){let o=n[a];r+=o.value*(o.inverted?-1:1),i+=o.delta,n[a].delta=0}this._value=r,this._delta=i,super.onPoll(t)}onUpdate(t,n,r){typeof n=="undefined"?this.onAxisChange(t,r):this.onAxisMove(t,n,r)}onStatus(t,n){this.onAxisStatus(t,n)}onBind(t,n=void 0){super.onBind(t,n);let{inverted:r=!1}=n||{},i=this._state;i[t].inverted=r}onAxisMove(t,n,r){let i=this._state[t];i.value=n,i.delta+=r}onAxisChange(t,n){let r=this._state[t];r.value+=n,r.delta+=n}onAxisStatus(t,n){let r=this._state[t],i=r.value;r.value=n,r.delta=n-i}},Xr=241,rn=254,Zr=239,ge=1,ot=2,lt=4,ut=8,ct=16,ze=class extends at{get pressed(){return this._pressed}get repeated(){return this._repeated}get released(){return this._released}get down(){return this._down}get value(){return this._value}constructor(t=0){super(t);this._state=new Uint8Array(t),this._value=0,this._down=!1,this._pressed=!1,this._repeated=!1,this._released=!1}resize(t){let n=this._state,r=n.length,i;t<=r?i=n.slice(0,t):(i=new Uint8Array(t),i.set(n)),this._state=i,super.resize(t)}getState(t){let n=this._state[t],r=n&ct?-1:1;return(n&ge?1:0)*r}onPoll(t){let n=this._state,r=0,i=0,s=0,a=0,o=0,l=n.length;for(let u=0;u<l;++u){let c=n[u],f=c&ge,h=c&ct;i|=f,s|=c&ot,a|=c&lt,o|=c&ut,r+=(f?1:0)*(h?-1:1),n[u]&=Xr}this._value=r,this._down=i!==0,this._pressed=s!==0,this._repeated=a!==0,this._released=o!==0,super.onPoll(t)}onUpdate(t,n,r){r>0?this.onButtonPressed(t):this.onButtonReleased(t)}onStatus(t,n){this.onButtonStatus(t,n!==0)}onBind(t,n={inverted:!1}){super.onBind(t,n);let{inverted:r=!1}=n,i=this._state;r?i[t]|=ct:i[t]&=Zr}onButtonPressed(t){let n=this._state,r=n[t];r&ge||(r|=ot,r|=ge),r|=lt,n[t]=r}onButtonReleased(t){let n=this._state,r=n[t];r&ge&&(r|=ut,r&=rn),n[t]=r}onButtonStatus(t,n){let r=this._state,i=r[t],s=Boolean(i&ge);n?i|=ge:i&=rn,s&&!n&&(i|=ut),!s&&n&&(i|=ot,i|=lt),r[t]=i}},M=class{static parse(t){t=t.trim();let n=t.indexOf(".");if(n<0)throw new Error("Missing device separator for key code.");let r=t.substring(0,n);if(r.length<0)throw new Error("Missing device for key code.");let i=t.substring(n+1);if(i.length<0)throw new Error("Missing code for key code.");return new M(r,i)}constructor(t,n){this.device=t,this.code=n}toString(){return`${this.device}.${this.code}`}};function ft(e,t){return new M(e,t)}function Qr(e){return"device"in e&&"code"in e}var C="Keyboard",ae="Mouse",Jr=new M(C,"KeyA"),ei=new M(C,"KeyB"),ti=new M(C,"KeyC"),ni=new M(C,"KeyD"),ri=new M(C,"KeyE"),ii=new M(C,"KeyF"),si=new M(C,"KeyG"),ai=new M(C,"KeyH"),oi=new M(C,"KeyI"),li=new M(C,"KeyJ"),ui=new M(C,"KeyK"),ci=new M(C,"KeyL"),fi=new M(C,"KeyM"),hi=new M(C,"KeyN"),pi=new M(C,"KeyO"),di=new M(C,"KeyP"),vi=new M(C,"KeyQ"),mi=new M(C,"KeyR"),Ei=new M(C,"KeyS"),_i=new M(C,"KeyT"),Ai=new M(C,"KeyU"),xi=new M(C,"KeyV"),yi=new M(C,"KeyW"),gi=new M(C,"KeyX"),wi=new M(C,"KeyY"),bi=new M(C,"KeyZ"),Ti=new M(C,"Digit0"),Mi=new M(C,"Digit1"),Si=new M(C,"Digit2"),Ri=new M(C,"Digit3"),Ii=new M(C,"Digit4"),Li=new M(C,"Digit5"),Ci=new M(C,"Digit6"),Oi=new M(C,"Digit7"),Bi=new M(C,"Digit8"),Ni=new M(C,"Digit9"),Di=new M(C,"Minus"),Pi=new M(C,"Equal"),Ui=new M(C,"BracketLeft"),Fi=new M(C,"BracketRight"),Hi=new M(C,"Semicolon"),ki=new M(C,"Quote"),zi=new M(C,"Backquote"),Ki=new M(C,"Backslash"),Yi=new M(C,"Comma"),$i=new M(C,"Period"),Gi=new M(C,"Slash"),Vi=new M(C,"Escape"),Wi=new M(C,"Space"),ji=new M(C,"CapsLock"),qi=new M(C,"Backspace"),Xi=new M(C,"Delete"),Zi=new M(C,"Tab"),Qi=new M(C,"Enter"),Ji=new M(C,"ArrowUp"),es=new M(C,"ArrowDown"),ts=new M(C,"ArrowLeft"),ns=new M(C,"ArrowRight"),rs=new M(ae,"Button0"),is=new M(ae,"Button1"),ss=new M(ae,"Button2"),as=new M(ae,"Button3"),os=new M(ae,"Button4"),ls=new M(ae,"PosX"),us=new M(ae,"PosY"),cs=new M(ae,"WheelX"),fs=new M(ae,"WheelY"),hs=new M(ae,"WheelZ"),V=Object.freeze({__proto__:null,ARROW_DOWN:es,ARROW_LEFT:ts,ARROW_RIGHT:ns,ARROW_UP:Ji,BACKQUOTE:zi,BACKSLASH:Ki,BACKSPACE:qi,BRACKET_LEFT:Ui,BRACKET_RIGHT:Fi,CAPS_LOCK:ji,COMMA:Yi,DELETE:Xi,DIGIT_0:Ti,DIGIT_1:Mi,DIGIT_2:Si,DIGIT_3:Ri,DIGIT_4:Ii,DIGIT_5:Li,DIGIT_6:Ci,DIGIT_7:Oi,DIGIT_8:Bi,DIGIT_9:Ni,ENTER:Qi,EQUAL:Pi,ESCAPE:Vi,KEYBOARD:C,KEY_A:Jr,KEY_B:ei,KEY_C:ti,KEY_D:ni,KEY_E:ri,KEY_F:ii,KEY_G:si,KEY_H:ai,KEY_I:oi,KEY_J:li,KEY_K:ui,KEY_L:ci,KEY_M:fi,KEY_N:hi,KEY_O:pi,KEY_P:di,KEY_Q:vi,KEY_R:mi,KEY_S:Ei,KEY_T:_i,KEY_U:Ai,KEY_V:xi,KEY_W:yi,KEY_X:gi,KEY_Y:wi,KEY_Z:bi,MINUS:Di,MOUSE:ae,MOUSE_BUTTON_0:rs,MOUSE_BUTTON_1:is,MOUSE_BUTTON_2:ss,MOUSE_BUTTON_3:as,MOUSE_BUTTON_4:os,MOUSE_POS_X:ls,MOUSE_POS_Y:us,MOUSE_WHEEL_X:cs,MOUSE_WHEEL_Y:fs,MOUSE_WHEEL_Z:hs,PERIOD:$i,QUOTE:ki,SEMICOLON:Hi,SLASH:Gi,SPACE:Wi,TAB:Zi,from:ft,isKeyCode:Qr}),ht=class{get polling(){return this.ref?this.ref.polling:!1}get value(){return!this.ref||this.disabled?0:this.ref.value}constructor(t){this.name=t,this.ref=null,this.disabled=!1}bindTo(t){throw new Error("Unsupported operation.")}disable(t=!0){return this.disabled=t,this}getState(t){return!this.ref||this.disabled?0:this.ref.getState(t)}};function sn(e){Array.isArray(e)||(e=[e]);let t=[];for(let n of e){let r;try{r=M.parse(n)}catch(i){let s=ps(n).toUpperCase();if(!(s in V))throw new Error("Invalid key code string - "+i);r=V[s]}t.push(r)}return t}function ps(e){return e.replace(/([a-z]|(?:[A-Z0-9]+))([A-Z0-9]|$)/g,function(t,n,r){return n+(r&&"_"+r)}).toLowerCase()}var we=class extends ht{static fromBind(t,n,r,i=void 0){return new we(t,ft(n,r),i)}static fromString(t,...n){let r=sn(n);return new we(t,r)}get delta(){return!this.ref||this.disabled?0:this.ref.delta}constructor(t,n,r=void 0){super(t);this.keyCodes=Array.isArray(n)?n:[n],this.opts=r}bindTo(t){let n=this.name,r=this.opts;for(let i of this.keyCodes)t.bindAxis(n,i.device,i.code,r);return this.ref=t.getAxis(n),this}},Q=class extends ht{static fromBind(t,n,r,i=void 0){return new Q(t,ft(n,r),i)}static fromString(t,...n){let r=sn(n);return new Q(t,r)}get pressed(){return!this.ref||this.disabled?!1:this.ref.pressed}get repeated(){return!this.ref||this.disabled?!1:this.ref.repeated}get released(){return!this.ref||this.disabled?!1:this.ref.released}get down(){return!this.ref||this.disabled?!1:this.ref.down}constructor(t,n,r=void 0){super(t);this.keyCodes=Array.isArray(n)?n:[n],this.opts=r}bindTo(t){let n=this.name,r=this.opts;for(let i of this.keyCodes)t.bindButton(n,i.device,i.code,r);return this.ref=t.getButton(n),this}};var pt=class{static isAxis(t){return!1}static isButton(t){return!1}constructor(t,n){if(!n)throw new Error(`Missing event target for device ${t}.`);this.name=t,this.eventTarget=n,this.listeners={input:[]}}setEventTarget(t){if(!t)throw new Error(`Missing event target for device ${this.name}.`);this.eventTarget=t}destroy(){let t=this.listeners;for(let n in t)t[n].length=0}addEventListener(t,n){let r=this.listeners;t in r?r[t].push(n):r[t]=[n]}removeEventListener(t,n){let r=this.listeners;if(t in r){let i=r[t],s=i.indexOf(n);s>=0&&i.splice(s,1)}}dispatchInputEvent(t){let n=0;for(let r of this.listeners.input)n|=r(t);return Boolean(n)}},an=class extends pt{static isAxis(t){return!1}static isButton(t){return!0}constructor(t,n,r={}){super(t,n);let{ignoreRepeat:i=!0}=r;this.ignoreRepeat=i,this._eventObject={target:n,device:t,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),n.addEventListener("keydown",this.onKeyDown),n.addEventListener("keyup",this.onKeyUp)}setEventTarget(t){this.eventTarget&&this.destroy(),super.setEventTarget(t),t.addEventListener("keydown",this.onKeyDown),t.addEventListener("keyup",this.onKeyUp)}destroy(){let t=this.eventTarget;t.removeEventListener("keydown",this.onKeyDown),t.removeEventListener("keyup",this.onKeyUp),super.destroy()}onKeyDown(t){if(t.repeat&&this.ignoreRepeat)return t.preventDefault(),t.stopPropagation(),!1;let n=this._eventObject;if(n.code=t.code,n.event="pressed",n.value=1,n.control=t.ctrlKey,n.shift=t.shiftKey,n.alt=t.altKey,this.dispatchInputEvent(n))return t.preventDefault(),t.stopPropagation(),!1}onKeyUp(t){let n=this._eventObject;if(n.code=t.code,n.event="released",n.value=1,n.control=t.ctrlKey,n.shift=t.shiftKey,n.alt=t.altKey,this.dispatchInputEvent(n))return t.preventDefault(),t.stopPropagation(),!1}},dt=10,vt=100,on=class extends pt{static isAxis(t){return t==="PosX"||t==="PosY"||t==="WheelX"||t==="WheelY"||t==="WheelZ"}static isButton(t){return!this.isAxis(t)}constructor(t,n,r={}){super(t,n);let{eventsOnFocus:i=!0}=r;this.eventsOnFocus=i,this.canvasTarget=this.getCanvasFromEventTarget(n),this._downHasFocus=!1,this._eventObject={target:n,device:t,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this._positionObject={target:n,device:t,code:"",event:"move",value:0,movement:0},this._wheelObject={target:n,device:t,code:"",event:"wheel",movement:0},this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onWheel=this.onWheel.bind(this),n.addEventListener("mousedown",this.onMouseDown),n.addEventListener("contextmenu",this.onContextMenu),n.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}setEventTarget(t){this.eventTarget&&this.destroy(),super.setEventTarget(t),this.canvasTarget=this.getCanvasFromEventTarget(t),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("contextmenu",this.onContextMenu),t.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}destroy(){let t=this.eventTarget;t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("contextmenu",this.onContextMenu),t.removeEventListener("wheel",this.onWheel),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),super.destroy()}setPointerLock(t=!0){t?this.eventTarget.requestPointerLock():this.eventTarget.exitPointerLock()}hasPointerLock(){return document.pointerLockElement===this.eventTarget}onMouseDown(t){this._downHasFocus=!0;let n=this._eventObject;if(n.code="Button"+t.button,n.event="pressed",n.value=1,n.control=t.ctrlKey,n.shift=t.shiftKey,n.alt=t.altKey,this.dispatchInputEvent(n)&&document.activeElement===this.eventTarget)return t.preventDefault(),t.stopPropagation(),!1}onContextMenu(t){return t.preventDefault(),t.stopPropagation(),!1}onWheel(t){let n,r,i;switch(t.deltaMode){case WheelEvent.DOM_DELTA_LINE:n=t.deltaX*dt,r=t.deltaY*dt,i=t.deltaZ*dt;break;case WheelEvent.DOM_DELTA_PAGE:n=t.deltaX*vt,r=t.deltaY*vt,i=t.deltaZ*vt;break;case WheelEvent.DOM_DELTA_PIXEL:default:n=t.deltaX,r=t.deltaY,i=t.deltaZ;break}let s=0,a=this._wheelObject;if(a.code="WheelX",a.movement=n,s|=this.dispatchInputEvent(a),a.code="WheelY",a.movement=r,s|=this.dispatchInputEvent(a),a.code="WheelZ",a.movement=i,s|=this.dispatchInputEvent(a),s)return t.preventDefault(),t.stopPropagation(),!1}onMouseUp(t){if(!this._downHasFocus)return;this._downHasFocus=!1;let n=this._eventObject;if(n.code="Button"+t.button,n.event="released",n.value=1,n.control=t.ctrlKey,n.shift=t.shiftKey,n.alt=t.altKey,this.dispatchInputEvent(n))return t.preventDefault(),t.stopPropagation(),!1}onMouseMove(t){if(this.eventsOnFocus&&document.activeElement!==this.eventTarget)return;let n=this.canvasTarget,{clientWidth:r,clientHeight:i}=n,s=n.getBoundingClientRect(),a=t.movementX/r,o=t.movementY/i,l=(t.clientX-s.left)/r,u=(t.clientY-s.top)/i,c=this._positionObject;c.code="PosX",c.value=l,c.movement=a,this.dispatchInputEvent(c),c.code="PosY",c.value=u,c.movement=o,this.dispatchInputEvent(c)}getCanvasFromEventTarget(t){return t instanceof HTMLCanvasElement?t:t.canvas||t.querySelector("canvas")||t.shadowRoot&&t.shadowRoot.querySelector("canvas")||t}},ds=`<kbd>
  <span id="name"><slot></slot></span>
  <span id="value" class="hidden"></span>
</kbd>
`,vs=`kbd {
  position: relative;
  display: inline-block;
  border-radius: 3px;
  border: 1px solid #888888;
  font-size: 0.85em;
  font-weight: 700;
  text-rendering: optimizeLegibility;
  line-height: 12px;
  height: 14px;
  padding: 2px 4px;
  color: #444444;
  background-color: #eeeeee;
  box-shadow: inset 0 -3px 0 #aaaaaa;
  overflow: hidden;
}

kbd:empty::after {
  content: '<?>';
  opacity: 0.6;
}

.disabled {
  opacity: 0.6;
  box-shadow: none;
  background-color: #aaaaaa;
}

.hidden {
  display: none;
}

#value {
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  font-size: 0.85em;
  padding: 0 4px;
  padding-top: 2px;
  color: #cccccc;
  background-color: #333333;
  box-shadow: inset 0 3px 0 #222222;
}
`,mt=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=ds,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=vs,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("input-code",this)}static get observedAttributes(){return["name","value","disabled"]}get disabled(){return this._disabled}set disabled(t){this.toggleAttribute("disabled",t)}get value(){return this._value}set value(t){this.setAttribute("value",t)}get name(){return this._name}set name(t){this.setAttribute("name",t)}constructor(){super();let t=this.constructor,n=this.attachShadow({mode:"open"});n.appendChild(t[Symbol.for("templateNode")].content.cloneNode(!0)),n.appendChild(t[Symbol.for("styleNode")].cloneNode(!0)),this._name="",this._value="",this._disabled=!1,this._kbdElement=n.querySelector("kbd"),this._nameElement=n.querySelector("#name"),this._valueElement=n.querySelector("#value")}attributeChangedCallback(t,n,r){switch(t){case"name":this._name=r,this._nameElement.textContent=r;break;case"value":this._value=r,r!==null?(this._valueElement.classList.toggle("hidden",!1),this._valueElement.textContent=r,this._kbdElement.style.paddingRight=`${this._valueElement.clientWidth+4}px`):this._valueElement.classList.toggle("hidden",!0);break;case"disabled":this._disabled=r!==null,this._kbdElement.classList.toggle("disabled",r!==null);break}}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"name")){let t=this.name;delete this.name,this.name=t}if(Object.prototype.hasOwnProperty.call(this,"value")){let t=this.value;delete this.value,this.value=t}if(Object.prototype.hasOwnProperty.call(this,"disabled")){let t=this.disabled;delete this.disabled,this.disabled=t}}};mt.define();var ms=`<table>
  <thead>
    <tr class="tableHeader">
      <th colspan="3">
        <span class="tableTitle">
          <label id="title"> input-source </label>
          <span id="slotContainer">
            <slot></slot>
          </span>
          <p>
            <label for="poll">poll</label>
            <output id="poll"></output>
          </p>
          <p>
            <label for="focus">focus</label>
            <output id="focus"></output>
          </p>
        </span>
      </th>
    </tr>
    <tr class="colHeader">
      <th>name</th>
      <th>value</th>
      <th>key</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
`,Es=`:host {
  display: block;
}

table {
  border-collapse: collapse;
  font-family: monospace;
}

table,
th,
td {
  border: 1px solid #666666;
}

th,
td {
  padding: 5px 10px;
}

td {
  text-align: center;
}

thead th {
  padding: 0;
}

.colHeader > th {
  font-size: 0.8em;
  padding: 0 10px;
  letter-spacing: 3px;
  background-color: #aaaaaa;
  color: #666666;
}

tbody output {
  border-radius: 0.3em;
  padding: 3px;
}

tr:not(.primary) .name,
tr:not(.primary) .value {
  opacity: 0.3;
}

tr:nth-child(2n) {
  background-color: #eeeeee;
}

.tableHeader {
  color: #666666;
}

.tableTitle {
  display: flex;
  flex-direction: row;
  align-items: center;
  padding: 4px;
}

#slotContainer {
  flex: 1;
}

p {
  display: inline;
  margin: 0;
  padding: 0;
  padding-right: 10px;
}

#poll:empty::after,
#focus:empty::after {
  content: '\u2717';
  color: #ff0000;
}
`,ln=class{constructor(t){this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null,this.pollable=t}get running(){return this.animationFrameHandle!==null}start(){let t=this.animationFrameHandle;t&&cancelAnimationFrame(t),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}stop(){let t=this.animationFrameHandle;t&&cancelAnimationFrame(t),this.animationFrameHandle=null}onAnimationFrame(t){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.pollable.onPoll(t)}},un=class{constructor(t){this.onInput=this.onInput.bind(this),this.onPoll=this.onPoll.bind(this),this.bindings=t}onPoll(t){for(let n of this.bindings.getInputs())n.onPoll(t)}onInput(t){let{device:n,code:r,event:i,value:s,movement:a,control:o,shift:l,alt:u}=t,c=this.bindings.getBindings(n,r);switch(i){case"pressed":for(let{input:f,index:h}of c)f.onUpdate(h,1,1);break;case"released":for(let{input:f,index:h}of c)f.onUpdate(h,0,-1);break;case"move":for(let{input:f,index:h}of c)f.onUpdate(h,s,a);break;case"wheel":for(let{input:f,index:h}of c)f.onUpdate(h,void 0,a);break}return c.length>0}},Et=class{constructor(t,n,r,i){this.device=t,this.code=n,this.input=r,this.index=i}},cn=class{constructor(){this.bindingMap={},this.inputMap=new Map}clear(){for(let t of this.inputMap.keys())t.onUnbind();this.inputMap.clear(),this.bindingMap={}}bind(t,n,r,i={inverted:!1}){let s,a=this.inputMap;if(a.has(t)){let l=a.get(t),u=t.size;t.onBind(u,i),s=new Et(n,r,t,u),l.push(s)}else{let l=[];a.set(t,l);let u=0;t.onBind(u,i),s=new Et(n,r,t,u),l.push(s)}let o=this.bindingMap;n in o?r in o[n]?o[n][r].push(s):o[n][r]=[s]:o[n]={[r]:[s]}}unbind(t){let n=this.inputMap;if(n.has(t)){let r=this.bindingMap,i=n.get(t);for(let s of i){let{device:a,code:o}=s,l=r[a][o],u=l.indexOf(s);l.splice(u,1)}i.length=0,t.onUnbind(),n.delete(t)}}isBound(t){return this.inputMap.has(t)}getInputs(){return this.inputMap.keys()}getBindingsByInput(t){return this.inputMap.get(t)}getBindings(t,n){let r=this.bindingMap;if(t in r){let i=r[t];if(n in i)return i[n]}return[]}},fn=class{constructor(t,n=void 0){this.inputs={},this.devices=[new on("Mouse",t),new an("Keyboard",t)],this.bindings=new cn,this.adapter=new un(this.bindings),this.autopoller=new ln(this.adapter),this.eventTarget=t,this.anyButton=new ze(1),this.anyButtonDevice="",this.anyButtonCode="",this.anyAxis=new Oe(1),this.anyAxisDevice="",this.anyAxisCode="",this.listeners={bind:[],unbind:[],focus:[],blur:[]},this.onInput=this.onInput.bind(this),this.onEventTargetBlur=this.onEventTargetBlur.bind(this),this.onEventTargetFocus=this.onEventTargetFocus.bind(this),t.addEventListener("focus",this.onEventTargetFocus),t.addEventListener("blur",this.onEventTargetBlur);for(let r of this.devices)r.addEventListener("input",this.onInput)}get autopoll(){return this.autopoller.running}set autopoll(t){this.toggleAutoPoll(t)}destroy(){let t=this.listeners;for(let r in t)t[r].length=0;this.autopoller.running&&this.autopoller.stop();for(let r of this.devices)r.removeEventListener("input",this.onInput),r.destroy();let n=this.eventTarget;n.removeEventListener("focus",this.onEventTargetFocus),n.removeEventListener("blur",this.onEventTargetBlur)}setEventTarget(t){let n=this.eventTarget;n.removeEventListener("focus",this.onEventTargetFocus),n.removeEventListener("blur",this.onEventTargetBlur),this.eventTarget=t;for(let r of this.devices)r.setEventTarget(t);t.addEventListener("focus",this.onEventTargetFocus),t.addEventListener("blur",this.onEventTargetBlur)}toggleAutoPoll(t=void 0){let n=this.autopoller.running,r=typeof t=="undefined"?!n:Boolean(t);r!==n&&(r?this.autopoller.start():this.autopoller.stop())}addEventListener(t,n){let r=this.listeners;t in r?r[t].push(n):r[t]=[n]}removeEventListener(t,n){let r=this.listeners;if(t in r){let i=r[t],s=i.indexOf(n);s>=0&&i.splice(s,1)}}dispatchEvent(t){let{type:n}=t,r=0;for(let i of this.listeners[n])r|=i(t)?1:0;return Boolean(r)}poll(t=performance.now()){if(this.autopoller.running)throw new Error("Should not manually poll() while autopolling.");this.onPoll(t)}onInput(t){let n=this.adapter.onInput(t);switch(t.event){case"pressed":this.anyButtonDevice=t.device,this.anyButtonCode=t.code,this.anyButton.onUpdate(0,1,1);break;case"released":this.anyButtonDevice=t.device,this.anyButtonCode=t.code,this.anyButton.onUpdate(0,0,-1);break;case"move":case"wheel":this.anyAxisDevice=t.device,this.anyAxisCode=t.code,this.anyAxis.onUpdate(0,t.value,t.movement);break}return n}onPoll(t){this.adapter.onPoll(t),this.anyButton.onPoll(t),this.anyAxis.onPoll(t)}onBind(){this.dispatchEvent({type:"bind"})}onUnbind(){this.dispatchEvent({type:"unbind"})}onEventTargetFocus(){this.dispatchEvent({type:"focus"})}onEventTargetBlur(){for(let t of this.bindings.getInputs())t.onStatus(0,0);this.anyButton.onStatus(0,0),this.anyAxis.onStatus(0,0),this.dispatchEvent({type:"blur"})}bindBindings(t){Array.isArray(t)||(t=Object.values(t));for(let n of t)n.bindTo(this)}bindBinding(t){t.bindTo(this)}bindButton(t,n,r,i=void 0){let s;this.hasButton(t)?s=this.getButton(t):(s=new ze(1),this.inputs[t]=s),this.bindings.bind(s,n,r,i),this.onBind()}bindAxis(t,n,r,i=void 0){let s;this.hasAxis(t)?s=this.getAxis(t):(s=new Oe(1),this.inputs[t]=s),this.bindings.bind(s,n,r,i),this.onBind()}bindAxisButtons(t,n,r,i){let s;this.hasAxis(t)?s=this.getAxis(t):(s=new Oe(2),this.inputs[t]=s),this.bindings.bind(s,n,i),this.bindings.bind(s,n,r,{inverted:!0}),this.onBind()}unbindButton(t){if(this.hasButton(t)){let n=this.getButton(t);delete this.inputs[t],this.bindings.unbind(n),this.onUnbind()}}unbindAxis(t){if(this.hasAxis(t)){let n=this.getAxis(t);delete this.inputs[t],this.bindings.unbind(n),this.onUnbind()}}getInput(t){return this.inputs[t]}getButton(t){return this.inputs[t]}getAxis(t){return this.inputs[t]}hasButton(t){return t in this.inputs&&this.inputs[t]instanceof ze}hasAxis(t){return t in this.inputs&&this.inputs[t]instanceof Oe}isButtonDown(t){return this.inputs[t].down}isButtonPressed(t){return this.inputs[t].pressed}isButtonReleased(t){return this.inputs[t].released}getInputValue(t){return this.inputs[t].value}getButtonValue(t){return this.inputs[t].value}getAxisValue(t){return this.inputs[t].value}getAxisDelta(t){return this.inputs[t].delta}isAnyButtonDown(t=void 0){if(typeof t=="undefined")return this.anyButton.down;{let n=this.inputs;for(let r of t)if(n[r].down)return!0}return!1}isAnyButtonPressed(t=void 0){if(typeof t=="undefined")return this.anyButton.pressed;{let n=this.inputs;for(let r of t)if(n[r].pressed)return!0}return!1}isAnyButtonReleased(t=void 0){if(typeof t=="undefined")return this.anyButton.released;{let n=this.inputs;for(let r of t)if(n[r].released)return!0}return!1}getAnyAxisValue(t=void 0){if(typeof t=="undefined")return this.anyAxis.value;{let n=this.inputs;for(let r of t){let i=n[r];if(i.value)return i.value}}return 0}getAnyAxisDelta(t=void 0){if(typeof t=="undefined")return this.anyAxis.delta;{let n=this.inputs;for(let r of t){let i=n[r];if(i.delta)return i.delta}}return 0}getLastButtonDevice(){return this.anyButtonDevice}getLastButtonCode(){return this.anyButtonCode}getLastAxisDevice(){return this.anyAxisDevice}getLastAxisCode(){return this.anyAxisCode}getMouse(){return this.devices[0]}getKeyboard(){return this.devices[1]}},hn=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=ms,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Es,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("input-port",this)}static get observedAttributes(){return["autopoll","for"]}get autopoll(){return this._autopoll}set autopoll(t){this.toggleAttribute("autopoll",t)}get for(){return this._for}set for(t){this.setAttribute("for",t)}constructor(){super();let t=this.attachShadow({mode:"open"});t.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),t.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._titleElement=t.querySelector("#title"),this._pollElement=t.querySelector("#poll"),this._focusElement=t.querySelector("#focus"),this._bodyElement=t.querySelector("tbody"),this._outputElements={},this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null;let n=this;this._for="",this._eventTarget=n,this._autopoll=!1,this._context=null,this.onInputContextBind=this.onInputContextBind.bind(this),this.onInputContextUnbind=this.onInputContextUnbind.bind(this),this.onInputContextFocus=this.onInputContextFocus.bind(this),this.onInputContextBlur=this.onInputContextBlur.bind(this)}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"for")){let t=this.for;delete this.for,this.for=t}if(Object.prototype.hasOwnProperty.call(this,"autopoll")){let t=this.autopoll;delete this.autopoll,this.autopoll=t}this.updateTable(),this.updateTableValues(),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}disconnectedCallback(){let t=this._context;t&&(t.removeEventListener("bind",this.onInputContextBind),t.removeEventListener("unbind",this.onInputContextUnbind),t.removeEventListener("blur",this.onInputContextBlur),t.removeEventListener("focus",this.onInputContextFocus),t.destroy(),this._context=null)}attributeChangedCallback(t,n,r){switch(t){case"for":{this._for=r;let i,s;r?(i=document.getElementById(r),s=`${i.tagName.toLowerCase()}#${r}`):(i=this,s="input-port"),this._eventTarget=i,this._context&&this._context.setEventTarget(this._eventTarget),this._titleElement.innerHTML=`for ${s}`}break;case"autopoll":this._autopoll=r!==null,this._context&&this._context.toggleAutoPoll(this._autopoll);break}}onAnimationFrame(){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.updateTableValues(),this.updatePollStatus()}onInputContextBind(){return this.updateTable(),!0}onInputContextUnbind(){return this.updateTable(),!0}onInputContextFocus(){return this._focusElement.innerHTML="\u2713",!0}onInputContextBlur(){return this._focusElement.innerHTML="",!0}getContext(t="axisbutton",n=void 0){switch(t){case"axisbutton":if(!this._context){let r=new fn(this._eventTarget,n);r.addEventListener("bind",this.onInputContextBind),r.addEventListener("unbind",this.onInputContextUnbind),r.addEventListener("blur",this.onInputContextBlur),r.addEventListener("focus",this.onInputContextFocus),this._autopoll&&r.toggleAutoPoll(!0),this._context=r}return this._context;default:throw new Error(`Input context id '${t}' is not supported.`)}}updateTable(){if(this.isConnected)if(this._context){let t=this._context,n=t.inputs,r=t.bindings,i={},s=[];for(let a of Object.keys(n)){let o=n[a],l=!0;for(let u of r.getBindingsByInput(o)){let c=_s(`${o.constructor.name}.${a}`,`${u.device}.${u.code}`,0,l);s.push(c),l&&(i[a]=c.querySelector("output"),l=!1)}}this._outputElements=i,this._bodyElement.innerHTML="";for(let a of s)this._bodyElement.appendChild(a)}else{this._outputElements={},this._bodyElement.innerHTML="";return}else return}updateTableValues(){if(this.isConnected)if(this._context){let n=this._context.inputs;for(let r of Object.keys(this._outputElements)){let i=this._outputElements[r],s=n[r].value;i.innerText=Number(s).toFixed(2)}}else{for(let t of Object.keys(this._outputElements)){let n=this._outputElements[t];n.innerText="---"}return}else return}updatePollStatus(){if(this.isConnected)if(this._context){let n=this._context.inputs;for(let r of Object.values(n))if(!r.polling){this._pollElement.innerHTML="";return}this._pollElement.innerHTML="\u2713"}else{this._pollElement.innerHTML="-";return}else return}};hn.define();function _s(e,t,n,r=!0){let i=document.createElement("tr");r&&i.classList.add("primary");{let s=document.createElement("td");s.textContent=e,s.classList.add("name"),i.appendChild(s)}{let s=document.createElement("td"),a=document.createElement("output");r?a.innerText=Number(n).toFixed(2):a.innerText="---",a.classList.add("value"),s.appendChild(a),i.appendChild(s)}{let s=document.createElement("td");s.classList.add("key");let a=new mt;a.innerText=t,s.appendChild(a),i.appendChild(s)}return i}var ql=Symbol("keyboardSource");var Xl=Symbol("mouseSource");var ma=Yr(Kn());var Yn={},ta=function(e,t,n,r,i){var s=new Worker(Yn[t]||(Yn[t]=URL.createObjectURL(new Blob([e+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return s.onmessage=function(a){var o=a.data,l=o.$e$;if(l){var u=new Error(l[0]);u.code=l[1],u.stack=l[2],i(u,null)}else i(null,o)},s.postMessage(n,r),s},ee=Uint8Array,Ee=Uint16Array,Ot=Uint32Array,Bt=new ee([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Nt=new ee([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),$n=new ee([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Gn=function(e,t){for(var n=new Ee(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];for(var i=new Ot(n[30]),r=1;r<30;++r)for(var s=n[r];s<n[r+1];++s)i[s]=s-n[r]<<5|r;return[n,i]},Vn=Gn(Bt,2),Dt=Vn[0],na=Vn[1];Dt[28]=258,na[258]=28;var Wn=Gn(Nt,0),jn=Wn[0],su=Wn[1],qe=new Ee(32768);for(var K=0;K<32768;++K)ve=(K&43690)>>>1|(K&21845)<<1,ve=(ve&52428)>>>2|(ve&13107)<<2,ve=(ve&61680)>>>4|(ve&3855)<<4,qe[K]=((ve&65280)>>>8|(ve&255)<<8)>>>1;var ve,Re=function(e,t,n){for(var r=e.length,i=0,s=new Ee(t);i<r;++i)e[i]&&++s[e[i]-1];var a=new Ee(t);for(i=0;i<t;++i)a[i]=a[i-1]+s[i-1]<<1;var o;if(n){o=new Ee(1<<t);var l=15-t;for(i=0;i<r;++i)if(e[i])for(var u=i<<4|e[i],c=t-e[i],f=a[e[i]-1]++<<c,h=f|(1<<c)-1;f<=h;++f)o[qe[f]>>>l]=u}else for(o=new Ee(r),i=0;i<r;++i)e[i]&&(o[i]=qe[a[e[i]-1]++]>>>15-e[i]);return o},De=new ee(288);for(var K=0;K<144;++K)De[K]=8;for(var K=144;K<256;++K)De[K]=9;for(var K=256;K<280;++K)De[K]=7;for(var K=280;K<288;++K)De[K]=8;var qn=new ee(32);for(var K=0;K<32;++K)qn[K]=5;var Xn=Re(De,9,1);var Zn=Re(qn,5,1),Xe=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},ie=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(t&7)&n},Ze=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(t&7)},Qn=function(e){return(e+7)/8|0},Qe=function(e,t,n){(t==null||t<0)&&(t=0),(n==null||n>e.length)&&(n=e.length);var r=new(e.BYTES_PER_ELEMENT==2?Ee:e.BYTES_PER_ELEMENT==4?Ot:ee)(n-t);return r.set(e.subarray(t,n)),r};var Jn=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ne=function(e,t,n){var r=new Error(t||Jn[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,ne),!n)throw r;return r},er=function(e,t,n){var r=e.length;if(!r||n&&n.f&&!n.l)return t||new ee(0);var i=!t||n,s=!n||n.i;n||(n={}),t||(t=new ee(r*3));var a=function(U){var xe=t.length;if(U>xe){var Ue=new ee(Math.max(xe*2,U));Ue.set(t),t=Ue}},o=n.f||0,l=n.p||0,u=n.b||0,c=n.l,f=n.d,h=n.m,d=n.n,v=r*8;do{if(!c){o=ie(e,l,1);var _=ie(e,l+1,3);if(l+=3,_)if(_==1)c=Xn,f=Zn,h=9,d=5;else if(_==2){var g=ie(e,l,31)+257,b=ie(e,l+10,15)+4,T=g+ie(e,l+5,31)+1;l+=14;for(var R=new ee(T),P=new ee(19),y=0;y<b;++y)P[$n[y]]=ie(e,l+y*3,7);l+=b*3;for(var L=Xe(P),D=(1<<L)-1,m=Re(P,L,1),y=0;y<T;){var O=m[ie(e,l,D)];l+=O&15;var p=O>>>4;if(p<16)R[y++]=p;else{var B=0,N=0;for(p==16?(N=3+ie(e,l,3),l+=2,B=R[y-1]):p==17?(N=3+ie(e,l,7),l+=3):p==18&&(N=11+ie(e,l,127),l+=7);N--;)R[y++]=B}}var E=R.subarray(0,g),A=R.subarray(g);h=Xe(E),d=Xe(A),c=Re(E,h,1),f=Re(A,d,1)}else ne(1);else{var p=Qn(l)+4,x=e[p-4]|e[p-3]<<8,I=p+x;if(I>r){s&&ne(0);break}i&&a(u+x),t.set(e.subarray(p,I),u),n.b=u+=x,n.p=l=I*8,n.f=o;continue}if(l>v){s&&ne(0);break}}i&&a(u+131072);for(var $=(1<<h)-1,H=(1<<d)-1,q=l;;q=l){var B=c[Ze(e,l)&$],X=B>>>4;if(l+=B&15,l>v){s&&ne(0);break}if(B||ne(2),X<256)t[u++]=X;else if(X==256){q=l,c=null;break}else{var Z=X-254;if(X>264){var y=X-257,le=Bt[y];Z=ie(e,l,(1<<le)-1)+Dt[y],l+=le}var Ce=f[Ze(e,l)&H],me=Ce>>>4;Ce||ne(3),l+=Ce&15;var A=jn[me];if(me>3){var le=Nt[me];A+=Ze(e,l)&(1<<le)-1,l+=le}if(l>v){s&&ne(0);break}i&&a(u+131072);for(var ue=u+Z;u<ue;u+=4)t[u]=t[u-A],t[u+1]=t[u+1-A],t[u+2]=t[u+2-A],t[u+3]=t[u+3-A];u=ue}}n.l=c,n.p=q,n.b=u,n.f=o,c&&(o=1,n.m=h,n.d=f,n.n=d)}while(!o);return u==t.length?t:Qe(t,0,u)};var ra=new ee(0);var ia=function(e,t){var n={};for(var r in e)n[r]=e[r];for(var r in t)n[r]=t[r];return n},tr=function(e,t,n){for(var r=e(),i=e.toString(),s=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/\s+/g,"").split(","),a=0;a<r.length;++a){var o=r[a],l=s[a];if(typeof o=="function"){t+=";"+l+"=";var u=o.toString();if(o.prototype)if(u.indexOf("[native code]")!=-1){var c=u.indexOf(" ",8)+1;t+=u.slice(c,u.indexOf("(",c))}else{t+=u;for(var f in o.prototype)t+=";"+l+".prototype."+f+"="+o.prototype[f].toString()}else t+=u}else n[l]=o}return[t,n]},Je=[],sa=function(e){var t=[];for(var n in e)e[n].buffer&&t.push((e[n]=new e[n].constructor(e[n])).buffer);return t},aa=function(e,t,n,r){var i;if(!Je[n]){for(var s="",a={},o=e.length-1,l=0;l<o;++l)i=tr(e[l],s,a),s=i[0],a=i[1];Je[n]=tr(e[o],s,a)}var u=ia({},Je[n][1]);return ta(Je[n][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",n,u,sa(u),r)},oa=function(){return[ee,Ee,Ot,Bt,Nt,$n,Dt,jn,Xn,Zn,qe,Jn,Re,Xe,ie,Ze,Qn,Qe,ne,er,Ut,nr,rr]};var nr=function(e){return postMessage(e,[e.buffer])},rr=function(e){return e&&e.size&&new ee(e.size)},la=function(e,t,n,r,i,s){var a=aa(n,r,i,function(o,l){a.terminate(),s(o,l)});return a.postMessage([e,t],t.consume?[e.buffer]:[]),function(){a.terminate()}};var fe=function(e,t){return e[t]|e[t+1]<<8},oe=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0},Pt=function(e,t){return oe(e,t)+oe(e,t+4)*4294967296};function ua(e,t,n){return n||(n=t,t={}),typeof n!="function"&&ne(7),la(e,t,[oa],function(r){return nr(Ut(r.data[0],rr(r.data[1])))},1,n)}function Ut(e,t){return er(e,t)}var au=typeof TextEncoder!="undefined"&&new TextEncoder,Ft=typeof TextDecoder!="undefined"&&new TextDecoder,ca=0;try{Ft.decode(ra,{stream:!0}),ca=1}catch(e){}var fa=function(e){for(var t="",n=0;;){var r=e[n++],i=(r>127)+(r>223)+(r>239);if(n+i>e.length)return[t,Qe(e,n-1)];i?i==3?(r=((r&15)<<18|(e[n++]&63)<<12|(e[n++]&63)<<6|e[n++]&63)-65536,t+=String.fromCharCode(55296|r>>10,56320|r&1023)):i&1?t+=String.fromCharCode((r&31)<<6|e[n++]&63):t+=String.fromCharCode((r&15)<<12|(e[n++]&63)<<6|e[n++]&63):t+=String.fromCharCode(r)}};function ha(e,t){if(t){for(var n="",r=0;r<e.length;r+=16384)n+=String.fromCharCode.apply(null,e.subarray(r,r+16384));return n}else{if(Ft)return Ft.decode(e);var i=fa(e),s=i[0],a=i[1];return a.length&&ne(8),s}}var pa=function(e,t){return t+30+fe(e,t+26)+fe(e,t+28)},da=function(e,t,n){var r=fe(e,t+28),i=ha(e.subarray(t+46,t+46+r),!(fe(e,t+8)&2048)),s=t+46+r,a=oe(e,t+20),o=n&&a==4294967295?va(e,s):[a,oe(e,t+24),oe(e,t+42)],l=o[0],u=o[1],c=o[2];return[fe(e,t+10),l,u,i,s+fe(e,t+30)+fe(e,t+32),c]},va=function(e,t){for(;fe(e,t)!=1;t+=4+fe(e,t+2));return[Pt(e,t+12),Pt(e,t+4),Pt(e,t+20)]};var ir=typeof queueMicrotask=="function"?queueMicrotask:typeof setTimeout=="function"?setTimeout:function(e){e()};function Ht(e,t,n){n||(n=t,t={}),typeof n!="function"&&ne(7);var r=[],i=function(){for(var p=0;p<r.length;++p)r[p]()},s={},a=function(p,x){ir(function(){n(p,x)})};ir(function(){a=n});for(var o=e.length-22;oe(e,o)!=101010256;--o)if(!o||e.length-o>65558)return a(ne(13,0,1),null),i;var l=fe(e,o+8);if(l){var u=l,c=oe(e,o+16),f=c==4294967295||u==65535;if(f){var h=oe(e,o-12);f=oe(e,h)==101075792,f&&(u=l=oe(e,h+32),c=oe(e,h+48))}for(var d=t&&t.filter,v=function(p){var x=da(e,c,f),I=x[0],g=x[1],b=x[2],T=x[3],R=x[4],P=x[5],y=pa(e,P);c=R;var L=function(m,O){m?(i(),a(m,null)):(O&&(s[T]=O),--l||a(null,s))};if(!d||d({name:T,size:g,originalSize:b,compression:I}))if(!I)L(null,Qe(e,y,y+g));else if(I==8){var D=e.subarray(y,y+g);if(g<32e4)try{L(null,Ut(D,new ee(b)))}catch(m){L(m,null)}else r.push(ua(D,{size:b},L))}else L(ne(14,"unknown compression type "+I,1),null);else L(null,null)},_=0;_<u;++_)v(_)}else a(null,{});return i}var Ea=/^([_\w\d]+)\:\/\//,sr=5e3;async function _a(e,t,n,r,i=sr){let{cache:s,loadings:a}=e;if(t in s)return s[t];let o;if(t in a){if(o=a[t],o.active)return a[t].promise}else o=new zt(i),a[t]=o;let l=[o.promise];return Ea.test(n)?l.push(ar(e,n,i).then(u=>r(u)).then(u=>Ie(e,t,u))):l.push(fetch(n).then(u=>u.arrayBuffer()).then(u=>r(u)).then(u=>Ie(e,t,u))),await Promise.race(l)}function Ie(e,t,n){let{cache:r,loadings:i}=e;return r[t]=n,t in i&&(i[t].resolve(n),delete i[t]),n}function Aa(e,t){let{cache:n,loadings:r}=e;t in r&&(r[t].reject(new Error("Stop loading to delete asset.")),delete r[t]),t in n&&delete n[t]}async function ar(e,t,n=sr){let{cache:r,loadings:i}=e;if(t in r)return r[t];if(t in i)return i[t].promise;{let s=new zt(n);return i[t]=s,s.promise}}function xa(e,t){let{defaults:n}=e;for(let r of n)if(r.glob.test(t))return kt(e,r.uri);return null}function kt(e,t){return e.cache[t]}function ya(e){return Object.keys(e.cache)}var zt=class{constructor(t){this.active=!1,this._resolve=null,this._reject=null,this._reason=null,this._value=null,this._timeoutHandle=Number.isFinite(t)&&t>0?setTimeout(()=>{this.reject(`Asset loading exceeded timeout of ${t} ms.`)},t):null,this._promise=new Promise((n,r)=>{this._value?n(this._value):this._resolve=n,this._reason?r(this._reason):this._reject=r})}get promise(){return this._promise}resolve(t){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._resolve?this._resolve(t):this._value=t}reject(t){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._reject?this._reject(t):this._reason=t}},Kt=class{constructor(t,n,r){this.uri=t,this.source=n,this.loader=r,this.store=null}get current(){return kt(this.store,this.uri)}set current(t){Ie(this.store,this.uri,t)}get default(){return xa(this.store,this.uri)}get loaded(){return ar(this.store,this.uri)}async preload(t,n=void 0,r=void 0){return this.store=t,typeof r!="undefined"?Ie(t,this.uri,r):await _a(this.store,this.uri,this.source,this.loader,n),this}async unload(){return Aa(this.store,this.uri),this.store=null,this}},ga=5e3,Pe={cache:{},loadings:{},defaults:[]};async function wa(e,t=void 0){let n="raw://",i=await(await fetch(e)).arrayBuffer();await new Promise((s,a)=>{Ht(new Uint8Array(i),(o,l)=>{if(o)a(o);else{for(let[u,c]of Object.entries(l)){u=u.replaceAll("\\","/");let f=u.indexOf("/");f>=0&&(u=u.substring(f+1));let h=n+u;Ie(Pe,h,c),t&&t(c,h,u)}s()}})})}async function ba(e,t){let r=await(await fetch(e)).arrayBuffer();await new Promise((i,s)=>{Ht(new Uint8Array(r),(a,o)=>{if(a)s(a);else{for(let[l,u]of Object.entries(o))l=l.replaceAll("\\","/"),t(u,l);i()}})})}async function Ta(e,t=ga){let n=[];for(let r of e)n.push(r.preload(Pe,t));await Promise.allSettled(n)}function Ma(e,t){return Ie(Pe,e,t)}function Sa(){return ya(Pe)}function or(e){return kt(Pe,e)}function Ra(e){return or(e)}var et=Object.freeze({__proto__:null,cache:Ma,current:or,get:Ra,keys:Sa,loadAssetPack:ba,loadAssetPackAsRaw:wa,loadAssetRefs:Ta});window.addEventListener("error",tt,!0);window.addEventListener("unhandledrejection",tt,!0);function tt(e){typeof e=="object"?e instanceof PromiseRejectionEvent?tt(e.reason):e instanceof ErrorEvent?tt(e.error):e instanceof Error?window.alert(e.stack):window.alert(JSON.stringify(e)):window.alert(e)}var he={CursorX:new we("cursorX",[V.MOUSE_POS_X]),CursorY:new we("cursorY",[V.MOUSE_POS_Y]),CursorMain:new Q("cursorMain",V.MOUSE_BUTTON_0),CursorAlt:new Q("cursorAlt",V.MOUSE_BUTTON_2),MoveLeft:new Q("moveLeft",[V.KEY_A,V.ARROW_LEFT]),MoveRight:new Q("moveRight",[V.KEY_D,V.ARROW_RIGHT]),MoveUp:new Q("moveUp",[V.KEY_Q]),MoveDown:new Q("moveDown",[V.KEY_E]),MoveForward:new Q("moveForward",[V.KEY_W,V.ARROW_UP]),MoveBackward:new Q("moveBackward",[V.KEY_S,V.ARROW_DOWN]),MainAction:new Q("mainAction",[V.KEY_Z,V.KEY_Q]),AltAction:new Q("altAction",[V.KEY_X,V.KEY_E]),Evade:new Q("evade",[V.SPACE])};async function Yt(e,t=void 0){if(typeof e=="string"){let o=await(await fetch(e)).arrayBuffer();if(typeof t=="undefined"){let l=e.lastIndexOf(".");if(l<0)throw new Error("Cannot load from url - unknown image type.");t="image/"+e.slice(l+1)}return Yt(o,t)}else if(!(e instanceof ArrayBuffer||ArrayBuffer.isView(e)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let n=e;typeof t=="undefined"&&(t="image/png");let r=new Blob([n],{type:t}),i=URL.createObjectURL(r),s=new Image;return new Promise((a,o)=>{s.addEventListener("load",()=>{a(s)}),s.addEventListener("error",l=>{o(l)}),s.src=i})}var lr={ImageToast:new Kt("toast","res/toast.png",Yt)};var _e={};ke(_e,{connectInputs:()=>Ia,getDisplayPort:()=>Oa,getInputPort:()=>Ba,preloadAssetPack:()=>La,preloadAssets:()=>Ca});async function Ia(e,t="input-port"){let r=document.querySelector(t).getContext("axisbutton");return r.bindBindings(Object.values(e)),r}async function La(){await et.loadAssetPack("res.pack",(e,t)=>et.cache(t,e))}async function Ca(e,t="asset-port"){await et.loadAssetRefs(Object.values(e))}function Oa(e=document,t="display-port"){return e.querySelector(t)}function Ba(e=document,t="input-port"){return e.querySelector(t)}var k=1e-6,se=typeof Float32Array!="undefined"?Float32Array:Array,$t=Math.random;var Au=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var pe={};ke(pe,{add:()=>_o,adjoint:()=>za,clone:()=>Da,copy:()=>Pa,create:()=>Na,determinant:()=>Ka,equals:()=>go,exactEquals:()=>yo,frob:()=>Eo,fromQuat:()=>ao,fromQuat2:()=>to,fromRotation:()=>Za,fromRotationTranslation:()=>fr,fromRotationTranslationScale:()=>io,fromRotationTranslationScaleOrigin:()=>so,fromScaling:()=>Xa,fromTranslation:()=>qa,fromValues:()=>Ua,fromXRotation:()=>Qa,fromYRotation:()=>Ja,fromZRotation:()=>eo,frustum:()=>oo,getRotation:()=>ro,getScaling:()=>hr,getTranslation:()=>no,identity:()=>ur,invert:()=>ka,lookAt:()=>po,mul:()=>wo,multiply:()=>cr,multiplyScalar:()=>Ao,multiplyScalarAndAdd:()=>xo,ortho:()=>fo,orthoNO:()=>dr,orthoZO:()=>ho,perspective:()=>lo,perspectiveFromFieldOfView:()=>co,perspectiveNO:()=>pr,perspectiveZO:()=>uo,rotate:()=>Ga,rotateX:()=>Va,rotateY:()=>Wa,rotateZ:()=>ja,scale:()=>$a,set:()=>Fa,str:()=>mo,sub:()=>bo,subtract:()=>vr,targetTo:()=>vo,translate:()=>Ya,transpose:()=>Ha});function Na(){var e=new se(16);return se!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function Da(e){var t=new se(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Pa(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Ua(e,t,n,r,i,s,a,o,l,u,c,f,h,d,v,_){var p=new se(16);return p[0]=e,p[1]=t,p[2]=n,p[3]=r,p[4]=i,p[5]=s,p[6]=a,p[7]=o,p[8]=l,p[9]=u,p[10]=c,p[11]=f,p[12]=h,p[13]=d,p[14]=v,p[15]=_,p}function Fa(e,t,n,r,i,s,a,o,l,u,c,f,h,d,v,_,p){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=s,e[5]=a,e[6]=o,e[7]=l,e[8]=u,e[9]=c,e[10]=f,e[11]=h,e[12]=d,e[13]=v,e[14]=_,e[15]=p,e}function ur(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ha(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],s=t[6],a=t[7],o=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=s,e[11]=t[14],e[12]=i,e[13]=a,e[14]=o}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function ka(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=t[4],o=t[5],l=t[6],u=t[7],c=t[8],f=t[9],h=t[10],d=t[11],v=t[12],_=t[13],p=t[14],x=t[15],I=n*o-r*a,g=n*l-i*a,b=n*u-s*a,T=r*l-i*o,R=r*u-s*o,P=i*u-s*l,y=c*_-f*v,L=c*p-h*v,D=c*x-d*v,m=f*p-h*_,O=f*x-d*_,B=h*x-d*p,N=I*B-g*O+b*m+T*D-R*L+P*y;return N?(N=1/N,e[0]=(o*B-l*O+u*m)*N,e[1]=(i*O-r*B-s*m)*N,e[2]=(_*P-p*R+x*T)*N,e[3]=(h*R-f*P-d*T)*N,e[4]=(l*D-a*B-u*L)*N,e[5]=(n*B-i*D+s*L)*N,e[6]=(p*b-v*P-x*g)*N,e[7]=(c*P-h*b+d*g)*N,e[8]=(a*O-o*D+u*y)*N,e[9]=(r*D-n*O-s*y)*N,e[10]=(v*R-_*b+x*I)*N,e[11]=(f*b-c*R-d*I)*N,e[12]=(o*L-a*m-l*y)*N,e[13]=(n*m-r*L+i*y)*N,e[14]=(_*g-v*T-p*I)*N,e[15]=(c*T-f*g+h*I)*N,e):null}function za(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=t[4],o=t[5],l=t[6],u=t[7],c=t[8],f=t[9],h=t[10],d=t[11],v=t[12],_=t[13],p=t[14],x=t[15];return e[0]=o*(h*x-d*p)-f*(l*x-u*p)+_*(l*d-u*h),e[1]=-(r*(h*x-d*p)-f*(i*x-s*p)+_*(i*d-s*h)),e[2]=r*(l*x-u*p)-o*(i*x-s*p)+_*(i*u-s*l),e[3]=-(r*(l*d-u*h)-o*(i*d-s*h)+f*(i*u-s*l)),e[4]=-(a*(h*x-d*p)-c*(l*x-u*p)+v*(l*d-u*h)),e[5]=n*(h*x-d*p)-c*(i*x-s*p)+v*(i*d-s*h),e[6]=-(n*(l*x-u*p)-a*(i*x-s*p)+v*(i*u-s*l)),e[7]=n*(l*d-u*h)-a*(i*d-s*h)+c*(i*u-s*l),e[8]=a*(f*x-d*_)-c*(o*x-u*_)+v*(o*d-u*f),e[9]=-(n*(f*x-d*_)-c*(r*x-s*_)+v*(r*d-s*f)),e[10]=n*(o*x-u*_)-a*(r*x-s*_)+v*(r*u-s*o),e[11]=-(n*(o*d-u*f)-a*(r*d-s*f)+c*(r*u-s*o)),e[12]=-(a*(f*p-h*_)-c*(o*p-l*_)+v*(o*h-l*f)),e[13]=n*(f*p-h*_)-c*(r*p-i*_)+v*(r*h-i*f),e[14]=-(n*(o*p-l*_)-a*(r*p-i*_)+v*(r*l-i*o)),e[15]=n*(o*h-l*f)-a*(r*h-i*f)+c*(r*l-i*o),e}function Ka(e){var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],a=e[5],o=e[6],l=e[7],u=e[8],c=e[9],f=e[10],h=e[11],d=e[12],v=e[13],_=e[14],p=e[15],x=t*a-n*s,I=t*o-r*s,g=t*l-i*s,b=n*o-r*a,T=n*l-i*a,R=r*l-i*o,P=u*v-c*d,y=u*_-f*d,L=u*p-h*d,D=c*_-f*v,m=c*p-h*v,O=f*p-h*_;return x*O-I*m+g*D+b*L-T*y+R*P}function cr(e,t,n){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],u=t[6],c=t[7],f=t[8],h=t[9],d=t[10],v=t[11],_=t[12],p=t[13],x=t[14],I=t[15],g=n[0],b=n[1],T=n[2],R=n[3];return e[0]=g*r+b*o+T*f+R*_,e[1]=g*i+b*l+T*h+R*p,e[2]=g*s+b*u+T*d+R*x,e[3]=g*a+b*c+T*v+R*I,g=n[4],b=n[5],T=n[6],R=n[7],e[4]=g*r+b*o+T*f+R*_,e[5]=g*i+b*l+T*h+R*p,e[6]=g*s+b*u+T*d+R*x,e[7]=g*a+b*c+T*v+R*I,g=n[8],b=n[9],T=n[10],R=n[11],e[8]=g*r+b*o+T*f+R*_,e[9]=g*i+b*l+T*h+R*p,e[10]=g*s+b*u+T*d+R*x,e[11]=g*a+b*c+T*v+R*I,g=n[12],b=n[13],T=n[14],R=n[15],e[12]=g*r+b*o+T*f+R*_,e[13]=g*i+b*l+T*h+R*p,e[14]=g*s+b*u+T*d+R*x,e[15]=g*a+b*c+T*v+R*I,e}function Ya(e,t,n){var r=n[0],i=n[1],s=n[2],a,o,l,u,c,f,h,d,v,_,p,x;return t===e?(e[12]=t[0]*r+t[4]*i+t[8]*s+t[12],e[13]=t[1]*r+t[5]*i+t[9]*s+t[13],e[14]=t[2]*r+t[6]*i+t[10]*s+t[14],e[15]=t[3]*r+t[7]*i+t[11]*s+t[15]):(a=t[0],o=t[1],l=t[2],u=t[3],c=t[4],f=t[5],h=t[6],d=t[7],v=t[8],_=t[9],p=t[10],x=t[11],e[0]=a,e[1]=o,e[2]=l,e[3]=u,e[4]=c,e[5]=f,e[6]=h,e[7]=d,e[8]=v,e[9]=_,e[10]=p,e[11]=x,e[12]=a*r+c*i+v*s+t[12],e[13]=o*r+f*i+_*s+t[13],e[14]=l*r+h*i+p*s+t[14],e[15]=u*r+d*i+x*s+t[15]),e}function $a(e,t,n){var r=n[0],i=n[1],s=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Ga(e,t,n,r){var i=r[0],s=r[1],a=r[2],o=Math.hypot(i,s,a),l,u,c,f,h,d,v,_,p,x,I,g,b,T,R,P,y,L,D,m,O,B,N,E;return o<k?null:(o=1/o,i*=o,s*=o,a*=o,l=Math.sin(n),u=Math.cos(n),c=1-u,f=t[0],h=t[1],d=t[2],v=t[3],_=t[4],p=t[5],x=t[6],I=t[7],g=t[8],b=t[9],T=t[10],R=t[11],P=i*i*c+u,y=s*i*c+a*l,L=a*i*c-s*l,D=i*s*c-a*l,m=s*s*c+u,O=a*s*c+i*l,B=i*a*c+s*l,N=s*a*c-i*l,E=a*a*c+u,e[0]=f*P+_*y+g*L,e[1]=h*P+p*y+b*L,e[2]=d*P+x*y+T*L,e[3]=v*P+I*y+R*L,e[4]=f*D+_*m+g*O,e[5]=h*D+p*m+b*O,e[6]=d*D+x*m+T*O,e[7]=v*D+I*m+R*O,e[8]=f*B+_*N+g*E,e[9]=h*B+p*N+b*E,e[10]=d*B+x*N+T*E,e[11]=v*B+I*N+R*E,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function Va(e,t,n){var r=Math.sin(n),i=Math.cos(n),s=t[4],a=t[5],o=t[6],l=t[7],u=t[8],c=t[9],f=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*i+u*r,e[5]=a*i+c*r,e[6]=o*i+f*r,e[7]=l*i+h*r,e[8]=u*i-s*r,e[9]=c*i-a*r,e[10]=f*i-o*r,e[11]=h*i-l*r,e}function Wa(e,t,n){var r=Math.sin(n),i=Math.cos(n),s=t[0],a=t[1],o=t[2],l=t[3],u=t[8],c=t[9],f=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i-u*r,e[1]=a*i-c*r,e[2]=o*i-f*r,e[3]=l*i-h*r,e[8]=s*r+u*i,e[9]=a*r+c*i,e[10]=o*r+f*i,e[11]=l*r+h*i,e}function ja(e,t,n){var r=Math.sin(n),i=Math.cos(n),s=t[0],a=t[1],o=t[2],l=t[3],u=t[4],c=t[5],f=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i+u*r,e[1]=a*i+c*r,e[2]=o*i+f*r,e[3]=l*i+h*r,e[4]=u*i-s*r,e[5]=c*i-a*r,e[6]=f*i-o*r,e[7]=h*i-l*r,e}function qa(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Xa(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Za(e,t,n){var r=n[0],i=n[1],s=n[2],a=Math.hypot(r,i,s),o,l,u;return a<k?null:(a=1/a,r*=a,i*=a,s*=a,o=Math.sin(t),l=Math.cos(t),u=1-l,e[0]=r*r*u+l,e[1]=i*r*u+s*o,e[2]=s*r*u-i*o,e[3]=0,e[4]=r*i*u-s*o,e[5]=i*i*u+l,e[6]=s*i*u+r*o,e[7]=0,e[8]=r*s*u+i*o,e[9]=i*s*u-r*o,e[10]=s*s*u+l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function Qa(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ja(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function eo(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function fr(e,t,n){var r=t[0],i=t[1],s=t[2],a=t[3],o=r+r,l=i+i,u=s+s,c=r*o,f=r*l,h=r*u,d=i*l,v=i*u,_=s*u,p=a*o,x=a*l,I=a*u;return e[0]=1-(d+_),e[1]=f+I,e[2]=h-x,e[3]=0,e[4]=f-I,e[5]=1-(c+_),e[6]=v+p,e[7]=0,e[8]=h+x,e[9]=v-p,e[10]=1-(c+d),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function to(e,t){var n=new se(3),r=-t[0],i=-t[1],s=-t[2],a=t[3],o=t[4],l=t[5],u=t[6],c=t[7],f=r*r+i*i+s*s+a*a;return f>0?(n[0]=(o*a+c*r+l*s-u*i)*2/f,n[1]=(l*a+c*i+u*r-o*s)*2/f,n[2]=(u*a+c*s+o*i-l*r)*2/f):(n[0]=(o*a+c*r+l*s-u*i)*2,n[1]=(l*a+c*i+u*r-o*s)*2,n[2]=(u*a+c*s+o*i-l*r)*2),fr(e,t,n),e}function no(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function hr(e,t){var n=t[0],r=t[1],i=t[2],s=t[4],a=t[5],o=t[6],l=t[8],u=t[9],c=t[10];return e[0]=Math.hypot(n,r,i),e[1]=Math.hypot(s,a,o),e[2]=Math.hypot(l,u,c),e}function ro(e,t){var n=new se(3);hr(n,t);var r=1/n[0],i=1/n[1],s=1/n[2],a=t[0]*r,o=t[1]*i,l=t[2]*s,u=t[4]*r,c=t[5]*i,f=t[6]*s,h=t[8]*r,d=t[9]*i,v=t[10]*s,_=a+c+v,p=0;return _>0?(p=Math.sqrt(_+1)*2,e[3]=.25*p,e[0]=(f-d)/p,e[1]=(h-l)/p,e[2]=(o-u)/p):a>c&&a>v?(p=Math.sqrt(1+a-c-v)*2,e[3]=(f-d)/p,e[0]=.25*p,e[1]=(o+u)/p,e[2]=(h+l)/p):c>v?(p=Math.sqrt(1+c-a-v)*2,e[3]=(h-l)/p,e[0]=(o+u)/p,e[1]=.25*p,e[2]=(f+d)/p):(p=Math.sqrt(1+v-a-c)*2,e[3]=(o-u)/p,e[0]=(h+l)/p,e[1]=(f+d)/p,e[2]=.25*p),e}function io(e,t,n,r){var i=t[0],s=t[1],a=t[2],o=t[3],l=i+i,u=s+s,c=a+a,f=i*l,h=i*u,d=i*c,v=s*u,_=s*c,p=a*c,x=o*l,I=o*u,g=o*c,b=r[0],T=r[1],R=r[2];return e[0]=(1-(v+p))*b,e[1]=(h+g)*b,e[2]=(d-I)*b,e[3]=0,e[4]=(h-g)*T,e[5]=(1-(f+p))*T,e[6]=(_+x)*T,e[7]=0,e[8]=(d+I)*R,e[9]=(_-x)*R,e[10]=(1-(f+v))*R,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function so(e,t,n,r,i){var s=t[0],a=t[1],o=t[2],l=t[3],u=s+s,c=a+a,f=o+o,h=s*u,d=s*c,v=s*f,_=a*c,p=a*f,x=o*f,I=l*u,g=l*c,b=l*f,T=r[0],R=r[1],P=r[2],y=i[0],L=i[1],D=i[2],m=(1-(_+x))*T,O=(d+b)*T,B=(v-g)*T,N=(d-b)*R,E=(1-(h+x))*R,A=(p+I)*R,$=(v+g)*P,H=(p-I)*P,q=(1-(h+_))*P;return e[0]=m,e[1]=O,e[2]=B,e[3]=0,e[4]=N,e[5]=E,e[6]=A,e[7]=0,e[8]=$,e[9]=H,e[10]=q,e[11]=0,e[12]=n[0]+y-(m*y+N*L+$*D),e[13]=n[1]+L-(O*y+E*L+H*D),e[14]=n[2]+D-(B*y+A*L+q*D),e[15]=1,e}function ao(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=n+n,o=r+r,l=i+i,u=n*a,c=r*a,f=r*o,h=i*a,d=i*o,v=i*l,_=s*a,p=s*o,x=s*l;return e[0]=1-f-v,e[1]=c+x,e[2]=h-p,e[3]=0,e[4]=c-x,e[5]=1-u-v,e[6]=d+_,e[7]=0,e[8]=h+p,e[9]=d-_,e[10]=1-u-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function oo(e,t,n,r,i,s,a){var o=1/(n-t),l=1/(i-r),u=1/(s-a);return e[0]=s*2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s*2*l,e[6]=0,e[7]=0,e[8]=(n+t)*o,e[9]=(i+r)*l,e[10]=(a+s)*u,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*s*2*u,e[15]=0,e}function pr(e,t,n,r,i){var s=1/Math.tan(t/2),a;return e[0]=s/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==Infinity?(a=1/(r-i),e[10]=(i+r)*a,e[14]=2*i*r*a):(e[10]=-1,e[14]=-2*r),e}var lo=pr;function uo(e,t,n,r,i){var s=1/Math.tan(t/2),a;return e[0]=s/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==Infinity?(a=1/(r-i),e[10]=i*a,e[14]=i*r*a):(e[10]=-1,e[14]=-r),e}function co(e,t,n,r){var i=Math.tan(t.upDegrees*Math.PI/180),s=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),o=Math.tan(t.rightDegrees*Math.PI/180),l=2/(a+o),u=2/(i+s);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=u,e[6]=0,e[7]=0,e[8]=-((a-o)*l*.5),e[9]=(i-s)*u*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e}function dr(e,t,n,r,i,s,a){var o=1/(t-n),l=1/(r-i),u=1/(s-a);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+n)*o,e[13]=(i+r)*l,e[14]=(a+s)*u,e[15]=1,e}var fo=dr;function ho(e,t,n,r,i,s,a){var o=1/(t-n),l=1/(r-i),u=1/(s-a);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=u,e[11]=0,e[12]=(t+n)*o,e[13]=(i+r)*l,e[14]=s*u,e[15]=1,e}function po(e,t,n,r){var i,s,a,o,l,u,c,f,h,d,v=t[0],_=t[1],p=t[2],x=r[0],I=r[1],g=r[2],b=n[0],T=n[1],R=n[2];return Math.abs(v-b)<k&&Math.abs(_-T)<k&&Math.abs(p-R)<k?ur(e):(c=v-b,f=_-T,h=p-R,d=1/Math.hypot(c,f,h),c*=d,f*=d,h*=d,i=I*h-g*f,s=g*c-x*h,a=x*f-I*c,d=Math.hypot(i,s,a),d?(d=1/d,i*=d,s*=d,a*=d):(i=0,s=0,a=0),o=f*a-h*s,l=h*i-c*a,u=c*s-f*i,d=Math.hypot(o,l,u),d?(d=1/d,o*=d,l*=d,u*=d):(o=0,l=0,u=0),e[0]=i,e[1]=o,e[2]=c,e[3]=0,e[4]=s,e[5]=l,e[6]=f,e[7]=0,e[8]=a,e[9]=u,e[10]=h,e[11]=0,e[12]=-(i*v+s*_+a*p),e[13]=-(o*v+l*_+u*p),e[14]=-(c*v+f*_+h*p),e[15]=1,e)}function vo(e,t,n,r){var i=t[0],s=t[1],a=t[2],o=r[0],l=r[1],u=r[2],c=i-n[0],f=s-n[1],h=a-n[2],d=c*c+f*f+h*h;d>0&&(d=1/Math.sqrt(d),c*=d,f*=d,h*=d);var v=l*h-u*f,_=u*c-o*h,p=o*f-l*c;return d=v*v+_*_+p*p,d>0&&(d=1/Math.sqrt(d),v*=d,_*=d,p*=d),e[0]=v,e[1]=_,e[2]=p,e[3]=0,e[4]=f*p-h*_,e[5]=h*v-c*p,e[6]=c*_-f*v,e[7]=0,e[8]=c,e[9]=f,e[10]=h,e[11]=0,e[12]=i,e[13]=s,e[14]=a,e[15]=1,e}function mo(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function Eo(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function _o(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e}function vr(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}function Ao(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e}function xo(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e[9]=t[9]+n[9]*r,e[10]=t[10]+n[10]*r,e[11]=t[11]+n[11]*r,e[12]=t[12]+n[12]*r,e[13]=t[13]+n[13]*r,e[14]=t[14]+n[14]*r,e[15]=t[15]+n[15]*r,e}function yo(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function go(e,t){var n=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],u=e[7],c=e[8],f=e[9],h=e[10],d=e[11],v=e[12],_=e[13],p=e[14],x=e[15],I=t[0],g=t[1],b=t[2],T=t[3],R=t[4],P=t[5],y=t[6],L=t[7],D=t[8],m=t[9],O=t[10],B=t[11],N=t[12],E=t[13],A=t[14],$=t[15];return Math.abs(n-I)<=k*Math.max(1,Math.abs(n),Math.abs(I))&&Math.abs(r-g)<=k*Math.max(1,Math.abs(r),Math.abs(g))&&Math.abs(i-b)<=k*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(s-T)<=k*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(a-R)<=k*Math.max(1,Math.abs(a),Math.abs(R))&&Math.abs(o-P)<=k*Math.max(1,Math.abs(o),Math.abs(P))&&Math.abs(l-y)<=k*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(u-L)<=k*Math.max(1,Math.abs(u),Math.abs(L))&&Math.abs(c-D)<=k*Math.max(1,Math.abs(c),Math.abs(D))&&Math.abs(f-m)<=k*Math.max(1,Math.abs(f),Math.abs(m))&&Math.abs(h-O)<=k*Math.max(1,Math.abs(h),Math.abs(O))&&Math.abs(d-B)<=k*Math.max(1,Math.abs(d),Math.abs(B))&&Math.abs(v-N)<=k*Math.max(1,Math.abs(v),Math.abs(N))&&Math.abs(_-E)<=k*Math.max(1,Math.abs(_),Math.abs(E))&&Math.abs(p-A)<=k*Math.max(1,Math.abs(p),Math.abs(A))&&Math.abs(x-$)<=k*Math.max(1,Math.abs(x),Math.abs($))}var wo=cr,bo=vr;var Y={};ke(Y,{add:()=>Io,angle:()=>Zo,bezier:()=>Yo,ceil:()=>Lo,clone:()=>To,copy:()=>So,create:()=>mr,cross:()=>ko,dist:()=>sl,distance:()=>yr,div:()=>il,divide:()=>xr,dot:()=>br,equals:()=>tl,exactEquals:()=>el,floor:()=>Co,forEach:()=>ul,fromValues:()=>Mo,hermite:()=>Ko,inverse:()=>Fo,len:()=>ol,length:()=>Er,lerp:()=>zo,max:()=>Bo,min:()=>Oo,mul:()=>rl,multiply:()=>Ar,negate:()=>Uo,normalize:()=>Ho,random:()=>$o,rotateX:()=>jo,rotateY:()=>qo,rotateZ:()=>Xo,round:()=>No,scale:()=>Do,scaleAndAdd:()=>Po,set:()=>Ro,sqrDist:()=>al,sqrLen:()=>ll,squaredDistance:()=>gr,squaredLength:()=>wr,str:()=>Jo,sub:()=>nl,subtract:()=>_r,transformMat3:()=>Vo,transformMat4:()=>Go,transformQuat:()=>Wo,zero:()=>Qo});function mr(){var e=new se(3);return se!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function To(e){var t=new se(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Er(e){var t=e[0],n=e[1],r=e[2];return Math.hypot(t,n,r)}function Mo(e,t,n){var r=new se(3);return r[0]=e,r[1]=t,r[2]=n,r}function So(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Ro(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}function Io(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function _r(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function Ar(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}function xr(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}function Lo(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function Co(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function Oo(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}function Bo(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}function No(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function Do(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function Po(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}function yr(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.hypot(n,r,i)}function gr(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i}function wr(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}function Uo(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function Fo(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function Ho(e,t){var n=t[0],r=t[1],i=t[2],s=n*n+r*r+i*i;return s>0&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e}function br(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function ko(e,t,n){var r=t[0],i=t[1],s=t[2],a=n[0],o=n[1],l=n[2];return e[0]=i*l-s*o,e[1]=s*a-r*l,e[2]=r*o-i*a,e}function zo(e,t,n,r){var i=t[0],s=t[1],a=t[2];return e[0]=i+r*(n[0]-i),e[1]=s+r*(n[1]-s),e[2]=a+r*(n[2]-a),e}function Ko(e,t,n,r,i,s){var a=s*s,o=a*(2*s-3)+1,l=a*(s-2)+s,u=a*(s-1),c=a*(3-2*s);return e[0]=t[0]*o+n[0]*l+r[0]*u+i[0]*c,e[1]=t[1]*o+n[1]*l+r[1]*u+i[1]*c,e[2]=t[2]*o+n[2]*l+r[2]*u+i[2]*c,e}function Yo(e,t,n,r,i,s){var a=1-s,o=a*a,l=s*s,u=o*a,c=3*s*o,f=3*l*a,h=l*s;return e[0]=t[0]*u+n[0]*c+r[0]*f+i[0]*h,e[1]=t[1]*u+n[1]*c+r[1]*f+i[1]*h,e[2]=t[2]*u+n[2]*c+r[2]*f+i[2]*h,e}function $o(e,t){t=t||1;var n=$t()*2*Math.PI,r=$t()*2-1,i=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*i,e[1]=Math.sin(n)*i,e[2]=r*t,e}function Go(e,t,n){var r=t[0],i=t[1],s=t[2],a=n[3]*r+n[7]*i+n[11]*s+n[15];return a=a||1,e[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/a,e[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/a,e[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/a,e}function Vo(e,t,n){var r=t[0],i=t[1],s=t[2];return e[0]=r*n[0]+i*n[3]+s*n[6],e[1]=r*n[1]+i*n[4]+s*n[7],e[2]=r*n[2]+i*n[5]+s*n[8],e}function Wo(e,t,n){var r=n[0],i=n[1],s=n[2],a=n[3],o=t[0],l=t[1],u=t[2],c=i*u-s*l,f=s*o-r*u,h=r*l-i*o,d=i*h-s*f,v=s*c-r*h,_=r*f-i*c,p=a*2;return c*=p,f*=p,h*=p,d*=2,v*=2,_*=2,e[0]=o+c+d,e[1]=l+f+v,e[2]=u+h+_,e}function jo(e,t,n,r){var i=[],s=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=s[0]+n[0],e[1]=s[1]+n[1],e[2]=s[2]+n[2],e}function qo(e,t,n,r){var i=[],s=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=s[0]+n[0],e[1]=s[1]+n[1],e[2]=s[2]+n[2],e}function Xo(e,t,n,r){var i=[],s=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],e[0]=s[0]+n[0],e[1]=s[1]+n[1],e[2]=s[2]+n[2],e}function Zo(e,t){var n=e[0],r=e[1],i=e[2],s=t[0],a=t[1],o=t[2],l=Math.sqrt(n*n+r*r+i*i),u=Math.sqrt(s*s+a*a+o*o),c=l*u,f=c&&br(e,t)/c;return Math.acos(Math.min(Math.max(f,-1),1))}function Qo(e){return e[0]=0,e[1]=0,e[2]=0,e}function Jo(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function el(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function tl(e,t){var n=e[0],r=e[1],i=e[2],s=t[0],a=t[1],o=t[2];return Math.abs(n-s)<=k*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-a)<=k*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-o)<=k*Math.max(1,Math.abs(i),Math.abs(o))}var nl=_r,rl=Ar,il=xr,sl=yr,al=gr,ol=Er,ll=wr,ul=function(){var e=mr();return function(t,n,r,i,s,a){var o,l;for(n||(n=3),r||(r=0),i?l=Math.min(i*n+r,t.length):l=t.length,o=r;o<l;o+=n)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],s(e,e,a),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2];return t}}();var Su=Y.fromValues(0,1,0);var Tr=class{constructor(t,n){this.projectionMatrix=t,this.viewMatrix=n}resize(t=void 0,n=void 0){return this}},cl=Math.PI/3,Gt=class extends Tr{constructor(t=cl,n=.1,r=1e3){super(pe.create(),pe.create());this.fieldOfView=Number(t),this.clippingPlane={near:Number(n),far:Number(r)}}resize(t=void 0,n=void 0){let r=typeof t=="undefined"?1:t/n,{near:i,far:s}=this.clippingPlane;return pe.perspective(this.projectionMatrix,this.fieldOfView,r,i,s),this}};var Mr=Math.PI/180,Vt=class{constructor(t={locky:!1}){this.locky=t.locky,this.position=Y.create(),this.forward=Y.fromValues(0,0,-1),this.right=Y.fromValues(1,0,0),this.up=Y.fromValues(0,1,0),this.forwardAmount=0,this.rightAmount=0,this.upAmount=0,this.pitch=0,this.yaw=-90}look(t,n,r=1){return r*=1e3,this.pitch=Math.min(89.9,Math.max(-89.9,this.pitch+n*r)),this.yaw=(this.yaw+t*r)%360,this}move(t,n=0,r=0,i=1){return this.forwardAmount+=t*i,this.rightAmount+=n*i,this.upAmount+=r*i,this}apply(t){let{position:n,forward:r,right:i,up:s,forwardAmount:a,rightAmount:o,upAmount:l,pitch:u,yaw:c}=this,f=c*Mr,h=u*Mr,d=Math.cos(f),v=Math.cos(h),_=Math.sin(f),p=Math.sin(h),x=d*v,I=p,g=_*v;Y.normalize(r,Y.set(r,x,this.locky?0:I,g)),Y.normalize(i,Y.cross(i,r,s));let b=Y.create();Y.scale(b,r,a),Y.add(n,n,b),Y.scale(b,i,o),Y.add(n,n,b),Y.scale(b,s,l),Y.add(n,n,b),this.forwardAmount=0,this.rightAmount=0,this.upAmount=0,this.locky&&Y.set(r,x,I,g);let T=Y.add(b,n,r);return pe.lookAt(t,n,T,s),t}};function Te(e){return typeof WebGL2RenderingContext!="undefined"&&e instanceof WebGL2RenderingContext}var Sr=class{constructor(t,n){this.gl=t,this.target=n}data(t,n=void 0){let r=this.gl,i=this.target;if(typeof t=="number")r.bufferData(i,t,n||r.STATIC_DRAW);else{if(!ArrayBuffer.isView(t))throw new Error("Source data must be a typed array.");r.bufferData(i,t,n||r.STATIC_DRAW)}return this}subData(t,n=0,r=void 0,i=void 0){let s=this.gl,a=this.target;if(ArrayBuffer.isView(t))if(typeof r!="undefined")if(Te(s))s.bufferSubData(a,n,t,r,i);else{let o=i?t.subarray(r,r+i):t.subarray(r);s.bufferSubData(a,n,o)}else s.bufferSubData(a,n,t);else throw new Error("Source data must be a typed array.");return this}};var nt=class{constructor(t,n,r,i){this.gl=t,this.target=n,this.handle=i,this.type=r,this.bindContext=new Sr(t,this.target)}bind(t){return t.bindBuffer(this.target,this.handle),this.bindContext.gl=t,this.bindContext}},Ae={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,HALF_FLOAT:5131};function fl(e,t){let n=[],r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<r;++i){let s=e.getActiveUniform(t,i);if(!s)break;n.push(s)}return n}function hl(e,t){let n=[],r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<r;++i){let s=e.getActiveAttrib(t,i);!s||n.push(s)}return n}function rt(e,t){switch(t){case e.FLOAT:case e.INT:case e.UNSIGNED_INT:case e.BOOL:return 1;case e.FLOAT_VEC2:case e.INT_VEC2:case e.BOOL_VEC2:return 2;case e.FLOAT_VEC3:case e.INT_VEC3:case e.BOOL_VEC3:return 3;case e.FLOAT_VEC4:case e.INT_VEC4:case e.BOOL_VEC4:return 4;case e.FLOAT_MAT2:return 4;case e.FLOAT_MAT3:return 9;case e.FLOAT_MAT4:return 16;default:throw new Error("Invalid vertex attribute type.")}}function pl(e,t){switch(t){case e.FLOAT:case e.FLOAT_VEC2:case e.FLOAT_VEC3:case e.FLOAT_VEC4:return dl}if(Te(e)){let n=e;switch(t){case e.INT:case e.INT_VEC2:case e.INT_VEC3:case e.INT_VEC4:case e.BOOL:case e.BOOL_VEC2:case e.BOOL_VEC3:case e.BOOL_VEC4:return vl;case e.FLOAT_MAT2:return El;case e.FLOAT_MAT3:return _l;case e.FLOAT_MAT4:return Al;case n.UNSIGNED_INT:case n.UNSIGNED_INT_VEC2:case n.UNSIGNED_INT_VEC3:case n.UNSIGNED_INT_VEC4:return ml}}throw new Error("Cannot find attribute function for gl enum.")}function dl(e,t,n,r,i=!1,s=0,a=0,o=void 0){if(this.bindBuffer(this.ARRAY_BUFFER,t),this.enableVertexAttribArray(e),this.vertexAttribPointer(e,n,r,i,s,a),o!==void 0){if(!Te(this))throw new Error("Cannot use attribute divisor in WebGL 1.");this.vertexAttribDivisor(e,o)}}function vl(e,t,n,r,i=!1,s=0,a=0,o=void 0){if(!Te(this))throw new Error("Cannot use attribute divisor in WebGL 1.");let l=this;l.bindBuffer(l.ARRAY_BUFFER,t),l.enableVertexAttribArray(e),l.vertexAttribIPointer(e,n,r,s,a),o!==void 0&&l.vertexAttribDivisor(e,o)}function ml(e,t,n,r,i=!1,s=0,a=0,o=void 0){if(!Te(this))throw new Error("Cannot use attribute divisor in WebGL 1.");let l=this;l.bindBuffer(l.ARRAY_BUFFER,t),l.enableVertexAttribArray(e),l.vertexAttribIPointer(e,n,r,s,a),o!==void 0&&l.vertexAttribDivisor(e,o)}function El(e,t,n,r,i=!1,s=0,a=0,o=void 0){let l=rt(this,this.FLOAT_MAT2),u=l*l;Wt(u,l,e,t,n,r,i,s,a,o)}function _l(e,t,n,r,i=!1,s=0,a=0,o=void 0){let l=rt(this,this.FLOAT_MAT3),u=l*l;Wt(u,l,e,t,n,r,i,s,a,o)}function Al(e,t,n,r,i=!1,s=0,a=0,o=void 0){let l=rt(this,this.FLOAT_MAT4),u=l*l;Wt(u,l,e,t,n,r,i,s,a,o)}function Wt(e,t,n,r,i,s,a,o,l,u){if(!Te(this))throw new Error("Cannot use attribute divisor in WebGL 1.");let c=this;c.bindBuffer(c.ARRAY_BUFFER,r);let f=i/t,h=e*i,d=o/t;for(let v=0;v<t;++v){let _=n+v;c.enableVertexAttribArray(_),c.vertexAttribPointer(_,f,s,a,h,l+d*v),u!==void 0&&c.vertexAttribDivisor(_,u)}}function xl(e,t){let n={},r=hl(e,t);for(let i of r){let s=i.name,a=i.size,o=i.type,l=e.getAttribLocation(t,s),u=pl(e,o),c=rt(e,o);n[s]={type:o,length:a,location:l,size:c,applier:u,set value([f,h,d,v,_,p,x]){this.applier(this.location,f,h,d,v,_,p,x)}}}return n}function yl(e,t,n,r,i=void 0){i?(e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,i),e.drawElements(t,r,e.UNSIGNED_SHORT,n)):e.drawArrays(t,n,r)}function gl(e,t){let n=e;switch(t){case n.FLOAT:return n.uniform1f;case n.FLOAT_VEC2:return n.uniform2fv;case n.FLOAT_VEC3:return n.uniform3fv;case n.FLOAT_VEC4:return n.uniform4fv;case n.INT:return n.uniform1i;case n.INT_VEC2:return n.uniform2iv;case n.INT_VEC3:return n.uniform3iv;case n.INT_VEC4:return n.uniform4iv;case n.BOOL:return n.uniform1i;case n.BOOL_VEC2:return n.uniform2iv;case n.BOOL_VEC3:return n.uniform3iv;case n.BOOL_VEC4:return n.uniform4iv;case n.FLOAT_MAT2:return wl;case n.FLOAT_MAT3:return bl;case n.FLOAT_MAT4:return Tl;case n.SAMPLER_2D:case n.SAMPLER_CUBE:return n.uniform1i}if(Te(e)){let r=e;switch(t){case r.UNSIGNED_INT:return r.uniform1ui;case r.UNSIGNED_INT_VEC2:return r.uniform2uiv;case r.UNSIGNED_INT_VEC3:return r.uniform3uiv;case r.UNSIGNED_INT_VEC4:return r.uniform4uiv;case r.FLOAT_MAT2x3:return Ml;case r.FLOAT_MAT2x4:return Sl;case r.FLOAT_MAT3x2:return Rl;case r.FLOAT_MAT3x4:return Il;case r.FLOAT_MAT4x2:return Ll;case r.FLOAT_MAT4x3:return Cl;case r.SAMPLER_3D:case r.SAMPLER_2D_SHADOW:case r.SAMPLER_2D_ARRAY:case r.SAMPLER_2D_ARRAY_SHADOW:case r.SAMPLER_CUBE_SHADOW:case r.INT_SAMPLER_2D:case r.INT_SAMPLER_3D:case r.INT_SAMPLER_CUBE:case r.INT_SAMPLER_2D_ARRAY:case r.UNSIGNED_INT_SAMPLER_2D:case r.UNSIGNED_INT_SAMPLER_3D:case r.UNSIGNED_INT_SAMPLER_CUBE:case r.UNSIGNED_INT_SAMPLER_2D_ARRAY:return r.uniform1i}}throw new Error("Cannot find uniform function for gl enum.")}function wl(e,t){this.uniformMatrix2fv(e,!1,t)}function bl(e,t){this.uniformMatrix3fv(e,!1,t)}function Tl(e,t){this.uniformMatrix4fv(e,!1,t)}function Ml(e,t){this.uniformMatrix2x3fv(e,!1,t)}function Sl(e,t){this.uniformMatrix2x4fv(e,!1,t)}function Rl(e,t){this.uniformMatrix3x2fv(e,!1,t)}function Il(e,t){this.uniformMatrix3x4fv(e,!1,t)}function Ll(e,t){this.uniformMatrix4x2fv(e,!1,t)}function Cl(e,t){this.uniformMatrix4x3fv(e,!1,t)}function Ol(e,t){let n={},r=fl(e,t);for(let i of r){let s=i.name,a=i.size,o=i.type,l=e.getUniformLocation(t,s),u=gl(e,o);n[s]={type:o,length:a,location:l,applier:u,set value(c){this.applier.call(e,this.location,c)}}}return n}var Iu={[Ae.BYTE]:1,[Ae.UNSIGNED_BYTE]:1,[Ae.SHORT]:2,[Ae.UNSIGNED_SHORT]:2,[Ae.INT]:4,[Ae.UNSIGNED_INT]:4,[Ae.FLOAT]:4,[Ae.HALF_FLOAT]:2};var Le=class{constructor(t,n){this.handle=n,this.activeUniforms=Ol(t,n),this.activeAttributes=xl(t,n),this.drawContext=new Rr(t,this)}bind(t){return t.useProgram(this.handle),this.drawContext.gl=t,this.drawContext}},Rr=class{constructor(t,n){this.gl=t,this.parent=n}uniform(t,n){let r=this.parent.activeUniforms;if(t in r){let i=r[t],s=i.location;i.applier.call(this.gl,s,n)}return this}attribute(t,n,r,i=!1,s=0,a=0){let o=this.gl,l=this.parent.activeAttributes;if(t in l){let u=l[t],c=u.location,f=u.size;r?(o.bindBuffer(o.ARRAY_BUFFER,r),o.vertexAttribPointer(c,f,n,i,s,a),o.enableVertexAttribArray(c)):o.disableVertexAttribArray(c)}return this}draw(t,n,r,i,s=null){return yl(t,n,r,i,s),this.parent}};var Ir=`#version 300 es

in vec3 a_position;
in vec2 a_texcoord;
in vec3 a_normal;

out vec2 v_texcoord;

uniform mat4 u_model;
uniform mat4 u_view;
uniform mat4 u_projection;

void main() {
    gl_Position = u_projection * u_view * u_model * vec4(a_position, 1.0);
    v_texcoord = a_texcoord;
}
`,Lr=`#version 300 es

precision highp float;

in vec2 v_texcoord;

out vec4 out_FragColor;

uniform vec4 u_color;

void main() {
    out_FragColor = u_color;
}
`;function Cr(e,t=1,n=1,r=1,i=8,s=1,a=!1,o=0,l=Math.PI*2){return Bl(e,t,n,r,i,s,o,l),a||(t>0&&Or(e,!0,t,n,r,i,o,l),n>0&&Or(e,!1,t,n,r,i,o,l)),e}function Bl(e,t,n,r,i,s,a,o){let l=r/2,u=(n-t)/r,c=[],f=Y.create();for(let h=0;h<=s;++h){let d=[],v=h/s,_=v*(n-t)+t;for(let p=0;p<=i;++p){let x=p/i,I=x*o+a,g=Math.sin(I),b=Math.cos(I);f[0]=_*g,f[1]=-v*r+l,f[2]=_*b,e.position.push(f[0],f[1],f[2]),f[0]=g,f[1]=u,f[2]=b,Y.normalize(f,f),e.normal.push(f[0],f[1],f[2]),f[0]=x,f[1]=1-v,e.texcoord.push(v[0],v[1]);let T=++e.vertexCount;d.push(T)}c.push(d)}for(let h=0;h<i;++h)for(let d=0;d<s;++d){let v=c[d][h],_=c[d+1][h],p=c[d+1][h+1],x=c[d][h+1];e.indices.push(v,_,x),e.indices.push(_,p,x)}return e}function Or(e,t,n,r,i,s,a,o){let l=i/2,u=t?1:-1,c=t?n:r,f=e.vertexCount;for(let v=1;v<=s;++v)e.position.push(0,l*u,0),e.normal.push(0,u,0),e.texcoord.push(.5,.5),++e.vertexCount;let h=Y.create(),d=e.vertexCount;for(let v=0;v<=s;++v){let p=v/s*o+a,x=Math.cos(p),I=Math.sin(p);h[0]=c*I,h[1]=l*u,h[2]=c*x,e.position.push(h[0],h[1],h[2]),e.normal.push(0,u,0),h[0]=x*.5+.5,h[1]=I*.5*u+.5,e.texcoord.push(h[0],h[1]),++e.vertexCount}for(let v=0;v<s;++v){let _=f+v,p=d+v;t?e.indices.push(p,p+1,_):e.indices.push(p+1,p,_)}return e}var jt=class{constructor(...t){this.systems=t,this.callbacks=[]}async load(t){for(let n of this.systems){let r=await n(t);this.callbacks.push(r)}return this}update(t){for(let n of this.systems)n(t);return this}};function qt(e,t){let n=e.components;if(t in n)return n[t];{let r={};return n[t]=r,r}}function Nl(e,t,n){let r=n.name,i=qt(e,r),s=n.new();return i[t]=s,s}function Dl(e,t,n){let r=n.name,i=qt(e,r),s=i[t];return delete i[t],s}var Br=Symbol("nextAvailableEntityId");function Pl(e){return++e[Br]}var Xt=class{constructor(){this.components={},this[Br]=1,this.queue=[]}flush(){for(;this.queue.length>0;){let[t,...n]=this.queue.shift();switch(t){case"attach":{let[r,i]=n;this.attachImmediately(r,i)}break;case"detach":{let[r,i]=n;this.detachImmediately(r,i)}break}}}create(...t){let n=Pl(this);for(let r of t)this.attach(n,r);return n}delete(t){for(let n of Object.values(this.components))t in n&&delete n[t]}attach(t,n){this.queue.push(["attach",t,n])}attachImmediately(t,n){return Nl(this,t,n)}detach(t,n){this.queue.push(["detach",t,n])}detachImmediately(t,n){return Dl(this,t,n)}get(t,n){let r=n.name,i=qt(this,r);return i?null:i[t]||null}};var Zt=class{constructor(t=0,n=[],r=[],i=[],s=[]){this.vertexCount=t,this.indices=n,this.position=r,this.texcoord=i,this.normal=s}};window.addEventListener("DOMContentLoaded",Ul);async function Ul(){await _e.connectInputs(he),await _e.preloadAssetPack(),await _e.preloadAssets(lr);let e={deltaTime:0,now:0,systemManager:new jt,entityManager:new Xt};await Fl(e)}async function Fl(e){let t=_e.getDisplayPort(),n=_e.getInputPort(),r=e.entityManager,i=e.systemManager,s=n.getContext("axisbutton"),a=t.canvas.getContext("webgl2"),o=new Gt,l=new Vt;t.canvas.addEventListener("click",()=>{t.focus(),t.canvas.requestPointerLock()});let u=zl(Cr(new Zt,.5,1,10),kl([Ir,Lr],{u_color:[1,0,.5,1],u_model:pe.create(),u_view:o.viewMatrix,u_projection:o.projectionMatrix})),c={};t.addEventListener("frame",f=>{let{deltaTime:h,now:d}=f.detail,v=h/60;s.poll(d),o.resize(t.width,t.height),Hl(v,l),l.apply(o.viewMatrix);let _=u.uniforms.u_model;pe.rotateX(_,_,.01),Vl(c,a,t,[u])})}function Hl(e,t){let n=he.MoveForward.value-he.MoveBackward.value,r=he.MoveRight.value-he.MoveLeft.value,i=he.MoveDown.value-he.MoveUp.value;t.move(n,r,i,e);let s=he.CursorX.delta,a=-he.CursorY.delta;t.look(s,a,e)}function kl(e,t){return{shaders:e,uniforms:t}}function zl(e,t){return{geometry:e,material:t}}function Nr(e,t,n=()=>null){if(t in e)return e[t];{let r=n();return e[t]=r,r}}function Kl(e,t,n){let r=Nr(e,"bufferInfos",()=>new Map);if(r.has(n))return r.get(n);{let i=nt.createBufferInfo(t,{a_position:{buffer:n.position},a_texcoord:{buffer:n.texcoord,size:2},a_normal:{buffer:n.normal}},{buffer:n.indices});return r.set(n,i),i}}function Yl(e,t,n){let r=Nr(e,"bufferInfos",()=>new Map);if(r.has(n))return r.get(n);{let i=t.createProgram();Le.linkProgramShaders(t,i,n.shaders);let s=Le.createProgramInfo(t,i);return r.set(n,s),s}}function $l(e,t,n,r){let i=Kl(e,t,n),s=Yl(e,t,r);return{bufferInfo:i,programInfo:s,uniforms:{...r.uniforms}}}function Gl(e,t,n){return n&&n.geometry&&n.material?$l(e,n.geometry,n.material):null}function Vl(e,t,n,r=[]){t.viewport(0,0,n.width,n.height),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT);for(let i of r.map(s=>Gl(e,t,s))){if(!i)continue;let{programInfo:s,bufferInfo:a,uniforms:o}=i;t.useProgram(s.handle),Le.bindProgramAttributes(t,s,a),Le.bindProgramUniforms(t,s,o),nt.drawBufferInfo(t,a)}}})();
//# sourceMappingURL=main.js.map
