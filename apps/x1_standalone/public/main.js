(()=>{var Lr=Object.create,He=Object.defineProperty,Cr=Object.getPrototypeOf,Or=Object.prototype.hasOwnProperty,Br=Object.getOwnPropertyNames,Nr=Object.getOwnPropertyDescriptor;var Dr=t=>He(t,"__esModule",{value:!0});var Pr=(t,e)=>()=>(t&&(e=t(t=0)),e),ye=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),ke=(t,e)=>{for(var n in e)He(t,n,{get:e[n],enumerable:!0})},Ur=(t,e,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Br(e))!Or.call(t,r)&&r!=="default"&&He(t,r,{get:()=>e[r],enumerable:!(n=Nr(e,r))||n.enumerable});return t},Fr=t=>Ur(Dr(He(t!=null?Lr(Cr(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var fn={};ke(fn,{basename:()=>En,default:()=>ms,delimiter:()=>mn,dirname:()=>_n,extname:()=>An,isAbsolute:()=>At,join:()=>pn,normalize:()=>xt,relative:()=>dn,resolve:()=>Ke,sep:()=>vn});function hn(t,e){for(var n=0,r=t.length-1;r>=0;r--){var i=t[r];i==="."?t.splice(r,1):i===".."?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function Ke(){for(var t="",e=!1,n=arguments.length-1;n>=-1&&!e;n--){var r=n>=0?arguments[n]:"/";if(typeof r!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!r)continue;t=r+"/"+t,e=r.charAt(0)==="/"}return t=hn(Et(t.split("/"),function(i){return!!i}),!e).join("/"),(e?"/":"")+t||"."}function xt(t){var e=At(t),n=vs(t,-1)==="/";return t=hn(Et(t.split("/"),function(r){return!!r}),!e).join("/"),!t&&!e&&(t="."),t&&n&&(t+="/"),(e?"/":"")+t}function At(t){return t.charAt(0)==="/"}function pn(){var t=Array.prototype.slice.call(arguments,0);return xt(Et(t,function(e,n){if(typeof e!="string")throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))}function dn(t,e){t=Ke(t).substr(1),e=Ke(e).substr(1);function n(u){for(var c=0;c<u.length&&u[c]==="";c++);for(var f=u.length-1;f>=0&&u[f]==="";f--);return c>f?[]:u.slice(c,f-c+1)}for(var r=n(t.split("/")),i=n(e.split("/")),s=Math.min(r.length,i.length),a=s,o=0;o<s;o++)if(r[o]!==i[o]){a=o;break}for(var l=[],o=a;o<r.length;o++)l.push("..");return l=l.concat(i.slice(a)),l.join("/")}function _n(t){var e=_t(t),n=e[0],r=e[1];return!n&&!r?".":(r&&(r=r.substr(0,r.length-1)),n+r)}function En(t,e){var n=_t(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n}function An(t){return _t(t)[3]}function Et(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}var ds,_t,vn,mn,ms,vs,xn=Pr(()=>{ds=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,_t=function(t){return ds.exec(t).slice(1)};vn="/",mn=":";ms={extname:An,basename:En,dirname:_n,sep:vn,delimiter:mn,relative:dn,join:pn,isAbsolute:At,normalize:xt,resolve:Ke};vs="ab".substr(-1)==="b"?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}});var $e=ye((Gl,Ye)=>{var _e=(xn(),fn);_e&&_e.default?Ye.exports=_e.default:_e&&(Ye.exports=_e);if(_e)for(let t in _e)Ye.exports[t]=_e[t]});var Oe=ye((Vl,yn)=>{"use strict";var _s=$e(),ue="\\\\/",gn=`[^${ue}]`,de="\\.",Es="\\+",As="\\?",Ge="\\/",xs="(?=.)",wn="[^/]",yt=`(?:${Ge}|$)`,bn=`(?:^|${Ge})`,gt=`${de}{1,2}${yt}`,ys=`(?!${de})`,gs=`(?!${bn}${gt})`,ws=`(?!${de}{0,1}${yt})`,bs=`(?!${gt})`,Ts=`[^.${Ge}]`,Ms=`${wn}*?`,Tn={DOT_LITERAL:de,PLUS_LITERAL:Es,QMARK_LITERAL:As,SLASH_LITERAL:Ge,ONE_CHAR:xs,QMARK:wn,END_ANCHOR:yt,DOTS_SLASH:gt,NO_DOT:ys,NO_DOTS:gs,NO_DOT_SLASH:ws,NO_DOTS_SLASH:bs,QMARK_NO_DOT:Ts,STAR:Ms,START_ANCHOR:bn},Ss={...Tn,SLASH_LITERAL:`[${ue}]`,QMARK:gn,STAR:`${gn}*?`,DOTS_SLASH:`${de}{1,2}(?:[${ue}]|$)`,NO_DOT:`(?!${de})`,NO_DOTS:`(?!(?:^|[${ue}])${de}{1,2}(?:[${ue}]|$))`,NO_DOT_SLASH:`(?!${de}{0,1}(?:[${ue}]|$))`,NO_DOTS_SLASH:`(?!${de}{1,2}(?:[${ue}]|$))`,QMARK_NO_DOT:`[^.${ue}]`,START_ANCHOR:`(?:^|[${ue}])`,END_ANCHOR:`(?:[${ue}]|$)`},Rs={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};yn.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:Rs,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:_s.sep,extglobChars(t){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${t.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(t){return t===!0?Ss:Tn}}});var Ve=ye(te=>{"use strict";var Is=$e(),Ls=!1,{REGEX_BACKSLASH:Cs,REGEX_REMOVE_BACKSLASH:Os,REGEX_SPECIAL_CHARS:Bs,REGEX_SPECIAL_CHARS_GLOBAL:Ns}=Oe();te.isObject=t=>t!==null&&typeof t=="object"&&!Array.isArray(t);te.hasRegexChars=t=>Bs.test(t);te.isRegexChar=t=>t.length===1&&te.hasRegexChars(t);te.escapeRegex=t=>t.replace(Ns,"\\$1");te.toPosixSlashes=t=>t.replace(Cs,"/");te.removeBackslashes=t=>t.replace(Os,e=>e==="\\"?"":e);te.supportsLookbehinds=()=>{let t=process.version.slice(1).split(".").map(Number);return t.length===3&&t[0]>=9||t[0]===8&&t[1]>=10};te.isWindows=t=>t&&typeof t.windows=="boolean"?t.windows:Ls===!0||Is.sep==="\\";te.escapeLast=(t,e,n)=>{let r=t.lastIndexOf(e,n);return r===-1?t:t[r-1]==="\\"?te.escapeLast(t,e,r-1):`${t.slice(0,r)}\\${t.slice(r)}`};te.removePrefix=(t,e={})=>{let n=t;return n.startsWith("./")&&(n=n.slice(2),e.prefix="./"),n};te.wrapOutput=(t,e={},n={})=>{let r=n.contains?"":"^",i=n.contains?"":"$",s=`${r}(?:${t})${i}`;return e.negated===!0&&(s=`(?:^(?!${s}).*$)`),s}});var Bn=ye((jl,Mn)=>{"use strict";var Sn=Ve(),{CHAR_ASTERISK:wt,CHAR_AT:Ds,CHAR_BACKWARD_SLASH:Be,CHAR_COMMA:Ps,CHAR_DOT:bt,CHAR_EXCLAMATION_MARK:Tt,CHAR_FORWARD_SLASH:Rn,CHAR_LEFT_CURLY_BRACE:Mt,CHAR_LEFT_PARENTHESES:St,CHAR_LEFT_SQUARE_BRACKET:Us,CHAR_PLUS:Fs,CHAR_QUESTION_MARK:In,CHAR_RIGHT_CURLY_BRACE:Hs,CHAR_RIGHT_PARENTHESES:Ln,CHAR_RIGHT_SQUARE_BRACKET:ks}=Oe(),Cn=t=>t===Rn||t===Be,On=t=>{t.isPrefix!==!0&&(t.depth=t.isGlobstar?Infinity:1)},zs=(t,e)=>{let n=e||{},r=t.length-1,i=n.parts===!0||n.scanToEnd===!0,s=[],a=[],o=[],l=t,u=-1,c=0,f=0,h=!1,d=!1,v=!1,_=!1,p=!1,x=!1,I=!1,g=!1,T=!1,b=!1,R=0,N,y,C={value:"",depth:0,isGlob:!1},P=()=>u>=r,A=()=>l.charCodeAt(u+1),B=()=>(N=y,l.charCodeAt(++u));for(;u<r;){y=B();let $;if(y===Be){I=C.backslashes=!0,y=B(),y===Mt&&(x=!0);continue}if(x===!0||y===Mt){for(R++;P()!==!0&&(y=B());){if(y===Be){I=C.backslashes=!0,B();continue}if(y===Mt){R++;continue}if(x!==!0&&y===bt&&(y=B())===bt){if(h=C.isBrace=!0,v=C.isGlob=!0,b=!0,i===!0)continue;break}if(x!==!0&&y===Ps){if(h=C.isBrace=!0,v=C.isGlob=!0,b=!0,i===!0)continue;break}if(y===Hs&&(R--,R===0)){x=!1,h=C.isBrace=!0,b=!0;break}}if(i===!0)continue;break}if(y===Rn){if(s.push(u),a.push(C),C={value:"",depth:0,isGlob:!1},b===!0)continue;if(N===bt&&u===c+1){c+=2;continue}f=u+1;continue}if(n.noext!==!0&&(y===Fs||y===Ds||y===wt||y===In||y===Tt)===!0&&A()===St){if(v=C.isGlob=!0,_=C.isExtglob=!0,b=!0,y===Tt&&u===c&&(T=!0),i===!0){for(;P()!==!0&&(y=B());){if(y===Be){I=C.backslashes=!0,y=B();continue}if(y===Ln){v=C.isGlob=!0,b=!0;break}}continue}break}if(y===wt){if(N===wt&&(p=C.isGlobstar=!0),v=C.isGlob=!0,b=!0,i===!0)continue;break}if(y===In){if(v=C.isGlob=!0,b=!0,i===!0)continue;break}if(y===Us){for(;P()!==!0&&($=B());){if($===Be){I=C.backslashes=!0,B();continue}if($===ks){d=C.isBracket=!0,v=C.isGlob=!0,b=!0;break}}if(i===!0)continue;break}if(n.nonegate!==!0&&y===Tt&&u===c){g=C.negated=!0,c++;continue}if(n.noparen!==!0&&y===St){if(v=C.isGlob=!0,i===!0){for(;P()!==!0&&(y=B());){if(y===St){I=C.backslashes=!0,y=B();continue}if(y===Ln){b=!0;break}}continue}break}if(v===!0){if(b=!0,i===!0)continue;break}}n.noext===!0&&(_=!1,v=!1);let O=l,D="",m="";c>0&&(D=l.slice(0,c),l=l.slice(c),f-=c),O&&v===!0&&f>0?(O=l.slice(0,f),m=l.slice(f)):v===!0?(O="",m=l):O=l,O&&O!==""&&O!=="/"&&O!==l&&Cn(O.charCodeAt(O.length-1))&&(O=O.slice(0,-1)),n.unescape===!0&&(m&&(m=Sn.removeBackslashes(m)),O&&I===!0&&(O=Sn.removeBackslashes(O)));let E={prefix:D,input:t,start:c,base:O,glob:m,isBrace:h,isBracket:d,isGlob:v,isExtglob:_,isGlobstar:p,negated:g,negatedExtglob:T};if(n.tokens===!0&&(E.maxDepth=0,Cn(y)||a.push(C),E.tokens=a),n.parts===!0||n.tokens===!0){let $;for(let H=0;H<s.length;H++){let q=$?$+1:c,X=s[H],Z=t.slice(q,X);n.tokens&&(H===0&&c!==0?(a[H].isPrefix=!0,a[H].value=D):a[H].value=Z,On(a[H]),E.maxDepth+=a[H].depth),(H!==0||Z!=="")&&o.push(Z),$=X}if($&&$+1<t.length){let H=t.slice($+1);o.push(H),n.tokens&&(a[a.length-1].value=H,On(a[a.length-1]),E.maxDepth+=a[a.length-1].depth)}E.slashes=s,E.parts=o}return E};Mn.exports=zs});var Un=ye((ql,Nn)=>{"use strict";var We=Oe(),ne=Ve(),{MAX_LENGTH:je,POSIX_REGEX_SOURCE:Ks,REGEX_NON_SPECIAL_CHARS:Ys,REGEX_SPECIAL_CHARS_BACKREF:$s,REPLACEMENTS:Dn}=We,Gs=(t,e)=>{if(typeof e.expandRange=="function")return e.expandRange(...t,e);t.sort();let n=`[${t.join("-")}]`;try{new RegExp(n)}catch(r){return t.map(i=>ne.escapeRegex(i)).join("..")}return n},Me=(t,e)=>`Missing ${t}: "${e}" - use "\\\\${e}" to match literal characters`,Pn=(t,e)=>{if(typeof t!="string")throw new TypeError("Expected a string");t=Dn[t]||t;let n={...e},r=typeof n.maxLength=="number"?Math.min(je,n.maxLength):je,i=t.length;if(i>r)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${r}`);let s={type:"bos",value:"",output:n.prepend||""},a=[s],o=n.capture?"":"?:",l=ne.isWindows(e),u=We.globChars(l),c=We.extglobChars(u),{DOT_LITERAL:f,PLUS_LITERAL:h,SLASH_LITERAL:d,ONE_CHAR:v,DOTS_SLASH:_,NO_DOT:p,NO_DOT_SLASH:x,NO_DOTS_SLASH:I,QMARK:g,QMARK_NO_DOT:T,STAR:b,START_ANCHOR:R}=u,N=S=>`(${o}(?:(?!${R}${S.dot?_:f}).)*?)`,y=n.dot?"":p,C=n.dot?g:T,P=n.bash===!0?N(n):b;n.capture&&(P=`(${P})`),typeof n.noext=="boolean"&&(n.noextglob=n.noext);let A={input:t,index:-1,start:0,dot:n.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:a};t=ne.removePrefix(t,A),i=t.length;let B=[],O=[],D=[],m=s,E,$=()=>A.index===i-1,H=A.peek=(S=1)=>t[A.index+S],q=A.advance=()=>t[++A.index]||"",X=()=>t.slice(A.index+1),Z=(S="",z=0)=>{A.consumed+=S,A.index+=z},oe=S=>{A.output+=S.output!=null?S.output:S.value,Z(S.value)},Le=()=>{let S=1;for(;H()==="!"&&(H(2)!=="("||H(3)==="?");)q(),A.start++,S++;return S%2==0?!1:(A.negated=!0,A.start++,!0)},me=S=>{A[S]++,D.push(S)},le=S=>{A[S]--,D.pop()},U=S=>{if(m.type==="globstar"){let z=A.braces>0&&(S.type==="comma"||S.type==="brace"),w=S.extglob===!0||B.length&&(S.type==="pipe"||S.type==="paren");S.type!=="slash"&&S.type!=="paren"&&!z&&!w&&(A.output=A.output.slice(0,-m.output.length),m.type="star",m.value="*",m.output=P,A.output+=m.output)}if(B.length&&S.type!=="paren"&&(B[B.length-1].inner+=S.value),(S.value||S.output)&&oe(S),m&&m.type==="text"&&S.type==="text"){m.value+=S.value,m.output=(m.output||"")+S.value;return}S.prev=m,a.push(S),m=S},xe=(S,z)=>{let w={...c[z],conditions:1,inner:""};w.prev=m,w.parens=A.parens,w.output=A.output;let F=(n.capture?"(":"")+w.open;me("parens"),U({type:S,value:z,output:A.output?"":v}),U({type:"paren",extglob:!0,value:q(),output:F}),B.push(w)},Ue=S=>{let z=S.close+(n.capture?")":""),w;if(S.type==="negate"){let F=P;S.inner&&S.inner.length>1&&S.inner.includes("/")&&(F=N(n)),(F!==P||$()||/^\)+$/.test(X()))&&(z=S.close=`)$))${F}`),S.inner.includes("*")&&(w=X())&&/^\.[^\\/.]+$/.test(w)&&(z=S.close=`)${w})${F})`),S.prev.type==="bos"&&(A.negatedExtglob=!0)}U({type:"paren",extglob:!0,value:E,output:z}),le("parens")};if(n.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(t)){let S=!1,z=t.replace($s,(w,F,V,ee,j,rt)=>ee==="\\"?(S=!0,w):ee==="?"?F?F+ee+(j?g.repeat(j.length):""):rt===0?C+(j?g.repeat(j.length):""):g.repeat(V.length):ee==="."?f.repeat(V.length):ee==="*"?F?F+ee+(j?P:""):P:F?w:`\\${w}`);return S===!0&&(n.unescape===!0?z=z.replace(/\\/g,""):z=z.replace(/\\+/g,w=>w.length%2==0?"\\\\":w?"\\":"")),z===t&&n.contains===!0?(A.output=t,A):(A.output=ne.wrapOutput(z,A,e),A)}for(;!$();){if(E=q(),E==="\0")continue;if(E==="\\"){let w=H();if(w==="/"&&n.bash!==!0||w==="."||w===";")continue;if(!w){E+="\\",U({type:"text",value:E});continue}let F=/^\\+/.exec(X()),V=0;if(F&&F[0].length>2&&(V=F[0].length,A.index+=V,V%2!=0&&(E+="\\")),n.unescape===!0?E=q():E+=q(),A.brackets===0){U({type:"text",value:E});continue}}if(A.brackets>0&&(E!=="]"||m.value==="["||m.value==="[^")){if(n.posix!==!1&&E===":"){let w=m.value.slice(1);if(w.includes("[")&&(m.posix=!0,w.includes(":"))){let F=m.value.lastIndexOf("["),V=m.value.slice(0,F),ee=m.value.slice(F+2),j=Ks[ee];if(j){m.value=V+j,A.backtrack=!0,q(),!s.output&&a.indexOf(m)===1&&(s.output=v);continue}}}(E==="["&&H()!==":"||E==="-"&&H()==="]")&&(E=`\\${E}`),E==="]"&&(m.value==="["||m.value==="[^")&&(E=`\\${E}`),n.posix===!0&&E==="!"&&m.value==="["&&(E="^"),m.value+=E,oe({value:E});continue}if(A.quotes===1&&E!=='"'){E=ne.escapeRegex(E),m.value+=E,oe({value:E});continue}if(E==='"'){A.quotes=A.quotes===1?0:1,n.keepQuotes===!0&&U({type:"text",value:E});continue}if(E==="("){me("parens"),U({type:"paren",value:E});continue}if(E===")"){if(A.parens===0&&n.strictBrackets===!0)throw new SyntaxError(Me("opening","("));let w=B[B.length-1];if(w&&A.parens===w.parens+1){Ue(B.pop());continue}U({type:"paren",value:E,output:A.parens?")":"\\)"}),le("parens");continue}if(E==="["){if(n.nobracket===!0||!X().includes("]")){if(n.nobracket!==!0&&n.strictBrackets===!0)throw new SyntaxError(Me("closing","]"));E=`\\${E}`}else me("brackets");U({type:"bracket",value:E});continue}if(E==="]"){if(n.nobracket===!0||m&&m.type==="bracket"&&m.value.length===1){U({type:"text",value:E,output:`\\${E}`});continue}if(A.brackets===0){if(n.strictBrackets===!0)throw new SyntaxError(Me("opening","["));U({type:"text",value:E,output:`\\${E}`});continue}le("brackets");let w=m.value.slice(1);if(m.posix!==!0&&w[0]==="^"&&!w.includes("/")&&(E=`/${E}`),m.value+=E,oe({value:E}),n.literalBrackets===!1||ne.hasRegexChars(w))continue;let F=ne.escapeRegex(m.value);if(A.output=A.output.slice(0,-m.value.length),n.literalBrackets===!0){A.output+=F,m.value=F;continue}m.value=`(${o}${F}|${m.value})`,A.output+=m.value;continue}if(E==="{"&&n.nobrace!==!0){me("braces");let w={type:"brace",value:E,output:"(",outputIndex:A.output.length,tokensIndex:A.tokens.length};O.push(w),U(w);continue}if(E==="}"){let w=O[O.length-1];if(n.nobrace===!0||!w){U({type:"text",value:E,output:E});continue}let F=")";if(w.dots===!0){let V=a.slice(),ee=[];for(let j=V.length-1;j>=0&&(a.pop(),V[j].type!=="brace");j--)V[j].type!=="dots"&&ee.unshift(V[j].value);F=Gs(ee,n),A.backtrack=!0}if(w.comma!==!0&&w.dots!==!0){let V=A.output.slice(0,w.outputIndex),ee=A.tokens.slice(w.tokensIndex);w.value=w.output="\\{",E=F="\\}",A.output=V;for(let j of ee)A.output+=j.output||j.value}U({type:"brace",value:E,output:F}),le("braces"),O.pop();continue}if(E==="|"){B.length>0&&B[B.length-1].conditions++,U({type:"text",value:E});continue}if(E===","){let w=E,F=O[O.length-1];F&&D[D.length-1]==="braces"&&(F.comma=!0,w="|"),U({type:"comma",value:E,output:w});continue}if(E==="/"){if(m.type==="dot"&&A.index===A.start+1){A.start=A.index+1,A.consumed="",A.output="",a.pop(),m=s;continue}U({type:"slash",value:E,output:d});continue}if(E==="."){if(A.braces>0&&m.type==="dot"){m.value==="."&&(m.output=f);let w=O[O.length-1];m.type="dots",m.output+=E,m.value+=E,w.dots=!0;continue}if(A.braces+A.parens===0&&m.type!=="bos"&&m.type!=="slash"){U({type:"text",value:E,output:f});continue}U({type:"dot",value:E,output:f});continue}if(E==="?"){if(!(m&&m.value==="(")&&n.noextglob!==!0&&H()==="("&&H(2)!=="?"){xe("qmark",E);continue}if(m&&m.type==="paren"){let F=H(),V=E;if(F==="<"&&!ne.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(m.value==="("&&!/[!=<:]/.test(F)||F==="<"&&!/<([!=]|\w+>)/.test(X()))&&(V=`\\${E}`),U({type:"text",value:E,output:V});continue}if(n.dot!==!0&&(m.type==="slash"||m.type==="bos")){U({type:"qmark",value:E,output:T});continue}U({type:"qmark",value:E,output:g});continue}if(E==="!"){if(n.noextglob!==!0&&H()==="("&&(H(2)!=="?"||!/[!=<:]/.test(H(3)))){xe("negate",E);continue}if(n.nonegate!==!0&&A.index===0){Le();continue}}if(E==="+"){if(n.noextglob!==!0&&H()==="("&&H(2)!=="?"){xe("plus",E);continue}if(m&&m.value==="("||n.regex===!1){U({type:"plus",value:E,output:h});continue}if(m&&(m.type==="bracket"||m.type==="paren"||m.type==="brace")||A.parens>0){U({type:"plus",value:E});continue}U({type:"plus",value:h});continue}if(E==="@"){if(n.noextglob!==!0&&H()==="("&&H(2)!=="?"){U({type:"at",extglob:!0,value:E,output:""});continue}U({type:"text",value:E});continue}if(E!=="*"){(E==="$"||E==="^")&&(E=`\\${E}`);let w=Ys.exec(X());w&&(E+=w[0],A.index+=w[0].length),U({type:"text",value:E});continue}if(m&&(m.type==="globstar"||m.star===!0)){m.type="star",m.star=!0,m.value+=E,m.output=P,A.backtrack=!0,A.globstar=!0,Z(E);continue}let S=X();if(n.noextglob!==!0&&/^\([^?]/.test(S)){xe("star",E);continue}if(m.type==="star"){if(n.noglobstar===!0){Z(E);continue}let w=m.prev,F=w.prev,V=w.type==="slash"||w.type==="bos",ee=F&&(F.type==="star"||F.type==="globstar");if(n.bash===!0&&(!V||S[0]&&S[0]!=="/")){U({type:"star",value:E,output:""});continue}let j=A.braces>0&&(w.type==="comma"||w.type==="brace"),rt=B.length&&(w.type==="pipe"||w.type==="paren");if(!V&&w.type!=="paren"&&!j&&!rt){U({type:"star",value:E,output:""});continue}for(;S.slice(0,3)==="/**";){let Fe=t[A.index+4];if(Fe&&Fe!=="/")break;S=S.slice(3),Z("/**",3)}if(w.type==="bos"&&$()){m.type="globstar",m.value+=E,m.output=N(n),A.output=m.output,A.globstar=!0,Z(E);continue}if(w.type==="slash"&&w.prev.type!=="bos"&&!ee&&$()){A.output=A.output.slice(0,-(w.output+m.output).length),w.output=`(?:${w.output}`,m.type="globstar",m.output=N(n)+(n.strictSlashes?")":"|$)"),m.value+=E,A.globstar=!0,A.output+=w.output+m.output,Z(E);continue}if(w.type==="slash"&&w.prev.type!=="bos"&&S[0]==="/"){let Fe=S[1]!==void 0?"|$":"";A.output=A.output.slice(0,-(w.output+m.output).length),w.output=`(?:${w.output}`,m.type="globstar",m.output=`${N(n)}${d}|${d}${Fe})`,m.value+=E,A.output+=w.output+m.output,A.globstar=!0,Z(E+q()),U({type:"slash",value:"/",output:""});continue}if(w.type==="bos"&&S[0]==="/"){m.type="globstar",m.value+=E,m.output=`(?:^|${d}|${N(n)}${d})`,A.output=m.output,A.globstar=!0,Z(E+q()),U({type:"slash",value:"/",output:""});continue}A.output=A.output.slice(0,-m.output.length),m.type="globstar",m.output=N(n),m.value+=E,A.output+=m.output,A.globstar=!0,Z(E);continue}let z={type:"star",value:E,output:P};if(n.bash===!0){z.output=".*?",(m.type==="bos"||m.type==="slash")&&(z.output=y+z.output),U(z);continue}if(m&&(m.type==="bracket"||m.type==="paren")&&n.regex===!0){z.output=E,U(z);continue}(A.index===A.start||m.type==="slash"||m.type==="dot")&&(m.type==="dot"?(A.output+=x,m.output+=x):n.dot===!0?(A.output+=I,m.output+=I):(A.output+=y,m.output+=y),H()!=="*"&&(A.output+=v,m.output+=v)),U(z)}for(;A.brackets>0;){if(n.strictBrackets===!0)throw new SyntaxError(Me("closing","]"));A.output=ne.escapeLast(A.output,"["),le("brackets")}for(;A.parens>0;){if(n.strictBrackets===!0)throw new SyntaxError(Me("closing",")"));A.output=ne.escapeLast(A.output,"("),le("parens")}for(;A.braces>0;){if(n.strictBrackets===!0)throw new SyntaxError(Me("closing","}"));A.output=ne.escapeLast(A.output,"{"),le("braces")}if(n.strictSlashes!==!0&&(m.type==="star"||m.type==="bracket")&&U({type:"maybe_slash",value:"",output:`${d}?`}),A.backtrack===!0){A.output="";for(let S of A.tokens)A.output+=S.output!=null?S.output:S.value,S.suffix&&(A.output+=S.suffix)}return A};Pn.fastpaths=(t,e)=>{let n={...e},r=typeof n.maxLength=="number"?Math.min(je,n.maxLength):je,i=t.length;if(i>r)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${r}`);t=Dn[t]||t;let s=ne.isWindows(e),{DOT_LITERAL:a,SLASH_LITERAL:o,ONE_CHAR:l,DOTS_SLASH:u,NO_DOT:c,NO_DOTS:f,NO_DOTS_SLASH:h,STAR:d,START_ANCHOR:v}=We.globChars(s),_=n.dot?f:c,p=n.dot?h:c,x=n.capture?"":"?:",I={negated:!1,prefix:""},g=n.bash===!0?".*?":d;n.capture&&(g=`(${g})`);let T=y=>y.noglobstar===!0?g:`(${x}(?:(?!${v}${y.dot?u:a}).)*?)`,b=y=>{switch(y){case"*":return`${_}${l}${g}`;case".*":return`${a}${l}${g}`;case"*.*":return`${_}${g}${a}${l}${g}`;case"*/*":return`${_}${g}${o}${l}${p}${g}`;case"**":return _+T(n);case"**/*":return`(?:${_}${T(n)}${o})?${p}${l}${g}`;case"**/*.*":return`(?:${_}${T(n)}${o})?${p}${g}${a}${l}${g}`;case"**/.*":return`(?:${_}${T(n)}${o})?${a}${l}${g}`;default:{let C=/^(.*?)\.(\w+)$/.exec(y);if(!C)return;let P=b(C[1]);return P?P+a+C[2]:void 0}}},R=ne.removePrefix(t,I),N=b(R);return N&&n.strictSlashes!==!0&&(N+=`${o}?`),N};Nn.exports=Pn});var Hn=ye((Xl,Fn)=>{"use strict";var Vs=$e(),Ws=Bn(),Rt=Un(),It=Ve(),js=Oe(),qs=t=>t&&typeof t=="object"&&!Array.isArray(t),W=(t,e,n=!1)=>{if(Array.isArray(t)){let c=t.map(h=>W(h,e,n));return h=>{for(let d of c){let v=d(h);if(v)return v}return!1}}let r=qs(t)&&t.tokens&&t.input;if(t===""||typeof t!="string"&&!r)throw new TypeError("Expected pattern to be a non-empty string");let i=e||{},s=It.isWindows(e),a=r?W.compileRe(t,e):W.makeRe(t,e,!1,!0),o=a.state;delete a.state;let l=()=>!1;if(i.ignore){let c={...e,ignore:null,onMatch:null,onResult:null};l=W(i.ignore,c,n)}let u=(c,f=!1)=>{let{isMatch:h,match:d,output:v}=W.test(c,a,e,{glob:t,posix:s}),_={glob:t,state:o,regex:a,posix:s,input:c,output:v,match:d,isMatch:h};return typeof i.onResult=="function"&&i.onResult(_),h===!1?(_.isMatch=!1,f?_:!1):l(c)?(typeof i.onIgnore=="function"&&i.onIgnore(_),_.isMatch=!1,f?_:!1):(typeof i.onMatch=="function"&&i.onMatch(_),f?_:!0)};return n&&(u.state=o),u};W.test=(t,e,n,{glob:r,posix:i}={})=>{if(typeof t!="string")throw new TypeError("Expected input to be a string");if(t==="")return{isMatch:!1,output:""};let s=n||{},a=s.format||(i?It.toPosixSlashes:null),o=t===r,l=o&&a?a(t):t;return o===!1&&(l=a?a(t):t,o=l===r),(o===!1||s.capture===!0)&&(s.matchBase===!0||s.basename===!0?o=W.matchBase(t,e,n,i):o=e.exec(l)),{isMatch:Boolean(o),match:o,output:l}};W.matchBase=(t,e,n,r=It.isWindows(n))=>(e instanceof RegExp?e:W.makeRe(e,n)).test(Vs.basename(t));W.isMatch=(t,e,n)=>W(e,n)(t);W.parse=(t,e)=>Array.isArray(t)?t.map(n=>W.parse(n,e)):Rt(t,{...e,fastpaths:!1});W.scan=(t,e)=>Ws(t,e);W.compileRe=(t,e,n=!1,r=!1)=>{if(n===!0)return t.output;let i=e||{},s=i.contains?"":"^",a=i.contains?"":"$",o=`${s}(?:${t.output})${a}`;t&&t.negated===!0&&(o=`^(?!${o}).*$`);let l=W.toRegex(o,e);return r===!0&&(l.state=t),l};W.makeRe=(t,e={},n=!1,r=!1)=>{if(!t||typeof t!="string")throw new TypeError("Expected a non-empty string");let i={negated:!1,fastpaths:!0};return e.fastpaths!==!1&&(t[0]==="."||t[0]==="*")&&(i.output=Rt.fastpaths(t,e)),i.output||(i=Rt(t,e)),W.compileRe(i,e,n,r)};W.toRegex=(t,e)=>{try{let n=e||{};return new RegExp(t,n.flags||(n.nocase?"i":""))}catch(n){if(e&&e.debug===!0)throw n;return/$^/}};W.constants=js;Fn.exports=W});var zn=ye((Zl,kn)=>{"use strict";kn.exports=Hn()});var Hr=`<div class="container">
  <label class="hidden" id="title">display-port</label>
  <label class="hidden" id="fps">00</label>
  <label class="hidden" id="dimension">0x0</label>
  <div class="content">
    <canvas> Oh no! Your browser does not support canvas. </canvas>
    <slot id="inner"></slot>
  </div>
  <slot name="frame"></slot>
</div>
`,kr=`:host {
  display: inline-block;
  color: #555555;
}

.container {
  display: flex;
  position: relative;
  width: 100%;
  height: 100%;
}

.content {
  position: relative;
  margin: auto;
}

.content > *:not(canvas) {
  width: 100%;
  height: 100%;
}

canvas {
  background: #000000;
  image-rendering: pixelated;
}

label {
  position: absolute;
  font-family: monospace;
  color: currentColor;
}

#inner {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: 0;
  left: 0;
  pointer-events: none;
}

#title {
  left: 0.5rem;
  top: 0.5rem;
}

#fps {
  right: 0.5rem;
  top: 0.5rem;
}

#dimension {
  left: 0.5rem;
  bottom: 0.5rem;
}

.hidden {
  display: none;
}

:host([debug]) .container {
  outline: 6px dashed rgba(0, 0, 0, 0.1);
  outline-offset: -4px;
  background-color: rgba(0, 0, 0, 0.1);
}

:host([mode='noscale']) canvas {
  margin: 0;
  top: 0;
  left: 0;
}

:host([mode='stretch']) canvas,
:host([mode='scale']) canvas {
  width: 100%;
  height: 100%;
}

:host([mode='fit']),
:host([mode='scale']),
:host([mode='center']),
:host([mode='stretch']),
:host([mode='fill']) {
  width: 100%;
  height: 100%;
}

:host([full]) {
  width: 100vw !important;
  height: 100vh !important;
}

:host([disabled]) {
  display: none;
}

slot {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  pointer-events: none;
}

::slotted(*) {
  pointer-events: auto;
}
`,Xt="noscale",it="fit",Zt="scale",Qt="fill",Jt="stretch",zr=300,Kr=150,Yr=it,$r=200,en=class extends HTMLElement{static get[Symbol.for("templateNode")](){let e=document.createElement("template");return e.innerHTML=Hr,Object.defineProperty(this,Symbol.for("templateNode"),{value:e}),e}static get[Symbol.for("styleNode")](){let e=document.createElement("style");return e.innerHTML=kr,Object.defineProperty(this,Symbol.for("styleNode"),{value:e}),e}static define(e=window.customElements){e.define("display-port",this)}static get observedAttributes(){return["debug","disabled","width","height","onframe","id","class"]}get mode(){return this.getAttribute("mode")}set mode(e){this.setAttribute("mode",e)}get debug(){return this._debug}set debug(e){this.toggleAttribute("debug",e)}get disabled(){return this._disabled}set disabled(e){this.toggleAttribute("disabled",e)}get width(){return this._width}set width(e){this.setAttribute("width",String(e))}get height(){return this._height}set height(e){this.setAttribute("height",String(e))}get onframe(){return this._onframe}set onframe(e){this._onframe&&this.removeEventListener("frame",this._onframe),this._onframe=e,this._onframe&&this.addEventListener("frame",e)}constructor(){super();let e=this.attachShadow({mode:"open"});e.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),e.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._canvasElement=e.querySelector("canvas"),this._contentElement=e.querySelector(".content"),this._innerElement=e.querySelector("#inner"),this._titleElement=e.querySelector("#title"),this._fpsElement=e.querySelector("#fps"),this._dimensionElement=e.querySelector("#dimension"),this._debug=!1,this._disabled=!1,this._width=zr,this._height=Kr,this._onframe=void 0,this._animationRequestHandle=0,this._prevAnimationFrameTime=0,this._resizeTimeoutHandle=0,this._resizeCanvasWidth=0,this._resizeCanvasHeight=0,this._frameEvent=new CustomEvent("frame",{composed:!0,bubbles:!1,detail:{now:0,prevTime:0,deltaTime:0,canvas:this._canvasElement}}),this._resizeEvent=new CustomEvent("resize",{composed:!0,bubbles:!1,detail:{width:0,height:0}}),this.update=this.update.bind(this),this.onDelayCanvasResize=this.onDelayCanvasResize.bind(this)}get canvas(){return this._canvasElement}connectedCallback(){Te(this,"mode"),Te(this,"debug"),Te(this,"disabled"),Te(this,"width"),Te(this,"height"),Te(this,"onframe"),this.hasAttribute("mode")||this.setAttribute("mode",Yr),this.hasAttribute("tabindex")||this.setAttribute("tabindex","0"),this.updateCanvasSize(!0),this.resume()}disconnectedCallback(){this.pause()}attributeChangedCallback(e,n,r){switch(e){case"debug":this._debug=r!==null;break;case"disabled":this._disabled=r!==null;break;case"width":this._width=Number(r);break;case"height":this._height=Number(r);break;case"onframe":this.onframe=new Function("event","with(document){with(this){"+r+"}}").bind(this);break}switch(e){case"disabled":r?(this.update(0),this.pause()):this.resume();break;case"id":case"class":this._titleElement.innerHTML=`display-port${this.className?"."+this.className:""}${this.hasAttribute("id")?"#"+this.getAttribute("id"):""}`;break;case"debug":this._titleElement.classList.toggle("hidden",r),this._fpsElement.classList.toggle("hidden",r),this._dimensionElement.classList.toggle("hidden",r);break}}getContext(e="2d",n=void 0){return this._canvasElement.getContext(e,n)}pause(){cancelAnimationFrame(this._animationRequestHandle)}resume(){this._animationRequestHandle=requestAnimationFrame(this.update)}update(e){this._animationRequestHandle=requestAnimationFrame(this.update),this.updateCanvasSize(!1);let n=e-this._prevAnimationFrameTime;if(this._prevAnimationFrameTime=e,this._debug){let s=n<=0?"--":String(Math.round(1e3/n)).padStart(2,"0");if(this._fpsElement.textContent!==s&&(this._fpsElement.textContent=s),this.mode===Xt){let o=`${this._width}x${this._height}`;this._dimensionElement.textContent!==o&&(this._dimensionElement.textContent=o)}else{let o=`${this._width}x${this._height}|${this.shadowRoot.host.clientWidth}x${this.shadowRoot.host.clientHeight}`;this._dimensionElement.textContent!==o&&(this._dimensionElement.textContent=o)}}let i=this._frameEvent.detail;i.now=e,i.prevTime=this._prevAnimationFrameTime,i.deltaTime=n,this.dispatchEvent(this._frameEvent)}onDelayCanvasResize(){this._resizeTimeoutHandle=0,this.updateCanvasSize(!0)}delayCanvasResize(e,n){(e!==this._resizeCanvasWidth||n!==this._resizeCanvasHeight)&&(this._resizeCanvasWidth=e,this._resizeCanvasHeight=n,this._resizeTimeoutHandle&&clearTimeout(this._resizeTimeoutHandle),this._resizeTimeoutHandle=setTimeout(this.onDelayCanvasResize,$r))}updateCanvasSize(e=!0){let n=this.shadowRoot.host.getBoundingClientRect(),r=n.width,i=n.height,s=this._canvasElement,a=this._width,o=this._height,l=this.mode;if(l===Jt||l===Qt)a=r,o=i;else if(l!==Xt&&(r<a||i<o||l===it||l==Zt)){let c=r/a,f=i/o;c<f?(a=r,o=o*c):(a=a*f,o=i)}if(a=Math.floor(a),o=Math.floor(o),typeof e=="undefined"&&(e=s.clientWidth!==a||s.clientHeight!==o),!e){this.delayCanvasResize(a,o);return}let u=Math.min(a/this._width,o/this._height)*.5;if(this._innerElement.style.fontSize=`font-size: ${u}em`,e){l===Zt?(s.width=this._width,s.height=this._height):l!==Jt&&(s.width=a,s.height=o);let c=this._contentElement.style;c.width=`${a}px`,c.height=`${o}px`,(l===it||l===Qt)&&(this._width=a,this._height=o);let h=this._resizeEvent.detail;h.width=a,h.height=o,this.dispatchEvent(this._resizeEvent)}}};en.define();function Te(t,e){if(Object.prototype.hasOwnProperty.call(t,e)){let n=t[e];delete t[e],t[e]=n}}var st=class{get polling(){return performance.now()-this._lastPollingTime<1e3}get value(){return 0}get size(){return this._size}constructor(e){this._size=e,this._lastPollingTime=Number.MIN_SAFE_INTEGER}resize(e){this._size=e}getState(e){throw new Error("Missing implementation.")}onUpdate(e,n,r){throw new Error("Missing implementation.")}onStatus(e,n){throw new Error("Missing implementation.")}onPoll(e){this._lastPollingTime=e}onBind(e,n={}){e>=this._size&&this.resize(e+1)}onUnbind(){this.resize(0)}},Ce=class extends st{static createAxisBindingState(){return{value:0,delta:0,inverted:!1}}get delta(){return this._delta}get value(){return this._value}constructor(e=0){super(e);let n=new Array;for(let r=0;r<e;++r)n.push(this.constructor.createAxisBindingState());this._state=n,this._value=0,this._delta=0}resize(e){let n=this._state,r=n.length,i;if(e<=r)i=n.slice(0,e);else{i=n;for(let s=r;s<e;++s)i.push(this.constructor.createAxisBindingState())}this._state=i,super.resize(e)}getState(e){return this._state[e].value}onPoll(e){let n=this._state,r=0,i=0,s=n.length;for(let a=0;a<s;++a){let o=n[a];r+=o.value*(o.inverted?-1:1),i+=o.delta,n[a].delta=0}this._value=r,this._delta=i,super.onPoll(e)}onUpdate(e,n,r){typeof n=="undefined"?this.onAxisChange(e,r):this.onAxisMove(e,n,r)}onStatus(e,n){this.onAxisStatus(e,n)}onBind(e,n={}){super.onBind(e,n);let{inverted:r=!1}=n,i=this._state;i[e].inverted=r}onAxisMove(e,n,r){let i=this._state[e];i.value=n,i.delta+=r}onAxisChange(e,n){let r=this._state[e];r.value+=n,r.delta+=n}onAxisStatus(e,n){let r=this._state[e],i=r.value;r.value=n,r.delta=n-i}},Gr=241,tn=254,Vr=239,ge=1,at=2,ot=4,lt=8,ut=16,ze=class extends st{get pressed(){return this._pressed}get repeated(){return this._repeated}get released(){return this._released}get down(){return this._down}get value(){return this._value}constructor(e=0){super(e);this._state=new Uint8Array(e),this._value=0,this._down=!1,this._pressed=!1,this._repeated=!1,this._released=!1}resize(e){let n=this._state,r=n.length,i;e<=r?i=n.slice(0,e):(i=new Uint8Array(e),i.set(n)),this._state=i,super.resize(e)}getState(e){let n=this._state[e],r=n&ut?-1:1;return(n&ge?1:0)*r}onPoll(e){let n=this._state,r=0,i=0,s=0,a=0,o=0,l=n.length;for(let u=0;u<l;++u){let c=n[u],f=c&ge,h=c&ut;i|=f,s|=c&at,a|=c&ot,o|=c&lt,r+=(f?1:0)*(h?-1:1),n[u]&=Gr}this._value=r,this._down=i!==0,this._pressed=s!==0,this._repeated=a!==0,this._released=o!==0,super.onPoll(e)}onUpdate(e,n,r){r>0?this.onButtonPressed(e):this.onButtonReleased(e)}onStatus(e,n){this.onButtonStatus(e,n!==0)}onBind(e,n={}){super.onBind(e,n);let{inverted:r=!1}=n,i=this._state;r?i[e]|=ut:i[e]&=Vr}onButtonPressed(e){let n=this._state,r=n[e];r&ge||(r|=at,r|=ge),r|=ot,n[e]=r}onButtonReleased(e){let n=this._state,r=n[e];r&ge&&(r|=lt,r&=tn),n[e]=r}onButtonStatus(e,n){let r=this._state,i=r[e],s=Boolean(i&ge);n?i|=ge:i&=tn,s&&!n&&(i|=lt),!s&&n&&(i|=at,i|=ot),r[e]=i}},M=class{static parse(e){e=e.trim();let n=e.indexOf(".");if(n<0)throw new Error("Missing device separator for key code.");let r=e.substring(0,n);if(r.length<0)throw new Error("Missing device for key code.");let i=e.substring(n+1);if(i.length<0)throw new Error("Missing code for key code.");return new M(r,i)}constructor(e,n){this.device=e,this.code=n}toString(){return`${this.device}.${this.code}`}};function ct(t,e){return new M(t,e)}function Wr(t){return"device"in t&&"code"in t}var L="Keyboard",se="Mouse",jr=new M(L,"KeyA"),qr=new M(L,"KeyB"),Xr=new M(L,"KeyC"),Zr=new M(L,"KeyD"),Qr=new M(L,"KeyE"),Jr=new M(L,"KeyF"),ei=new M(L,"KeyG"),ti=new M(L,"KeyH"),ni=new M(L,"KeyI"),ri=new M(L,"KeyJ"),ii=new M(L,"KeyK"),si=new M(L,"KeyL"),ai=new M(L,"KeyM"),oi=new M(L,"KeyN"),li=new M(L,"KeyO"),ui=new M(L,"KeyP"),ci=new M(L,"KeyQ"),fi=new M(L,"KeyR"),hi=new M(L,"KeyS"),pi=new M(L,"KeyT"),di=new M(L,"KeyU"),vi=new M(L,"KeyV"),mi=new M(L,"KeyW"),_i=new M(L,"KeyX"),Ei=new M(L,"KeyY"),Ai=new M(L,"KeyZ"),xi=new M(L,"Digit0"),yi=new M(L,"Digit1"),gi=new M(L,"Digit2"),wi=new M(L,"Digit3"),bi=new M(L,"Digit4"),Ti=new M(L,"Digit5"),Mi=new M(L,"Digit6"),Si=new M(L,"Digit7"),Ri=new M(L,"Digit8"),Ii=new M(L,"Digit9"),Li=new M(L,"Minus"),Ci=new M(L,"Equal"),Oi=new M(L,"BracketLeft"),Bi=new M(L,"BracketRight"),Ni=new M(L,"Semicolon"),Di=new M(L,"Quote"),Pi=new M(L,"Backquote"),Ui=new M(L,"Backslash"),Fi=new M(L,"Comma"),Hi=new M(L,"Period"),ki=new M(L,"Slash"),zi=new M(L,"Escape"),Ki=new M(L,"Space"),Yi=new M(L,"CapsLock"),$i=new M(L,"Backspace"),Gi=new M(L,"Delete"),Vi=new M(L,"Tab"),Wi=new M(L,"Enter"),ji=new M(L,"ArrowUp"),qi=new M(L,"ArrowDown"),Xi=new M(L,"ArrowLeft"),Zi=new M(L,"ArrowRight"),Qi=new M(se,"Button0"),Ji=new M(se,"Button1"),es=new M(se,"Button2"),ts=new M(se,"Button3"),ns=new M(se,"Button4"),rs=new M(se,"PosX"),is=new M(se,"PosY"),ss=new M(se,"WheelX"),as=new M(se,"WheelY"),os=new M(se,"WheelZ"),G=Object.freeze({__proto__:null,from:ct,isKeyCode:Wr,KEYBOARD:L,MOUSE:se,KEY_A:jr,KEY_B:qr,KEY_C:Xr,KEY_D:Zr,KEY_E:Qr,KEY_F:Jr,KEY_G:ei,KEY_H:ti,KEY_I:ni,KEY_J:ri,KEY_K:ii,KEY_L:si,KEY_M:ai,KEY_N:oi,KEY_O:li,KEY_P:ui,KEY_Q:ci,KEY_R:fi,KEY_S:hi,KEY_T:pi,KEY_U:di,KEY_V:vi,KEY_W:mi,KEY_X:_i,KEY_Y:Ei,KEY_Z:Ai,DIGIT_0:xi,DIGIT_1:yi,DIGIT_2:gi,DIGIT_3:wi,DIGIT_4:bi,DIGIT_5:Ti,DIGIT_6:Mi,DIGIT_7:Si,DIGIT_8:Ri,DIGIT_9:Ii,MINUS:Li,EQUAL:Ci,BRACKET_LEFT:Oi,BRACKET_RIGHT:Bi,SEMICOLON:Ni,QUOTE:Di,BACKQUOTE:Pi,BACKSLASH:Ui,COMMA:Fi,PERIOD:Hi,SLASH:ki,ESCAPE:zi,SPACE:Ki,CAPS_LOCK:Yi,BACKSPACE:$i,DELETE:Gi,TAB:Vi,ENTER:Wi,ARROW_UP:ji,ARROW_DOWN:qi,ARROW_LEFT:Xi,ARROW_RIGHT:Zi,MOUSE_BUTTON_0:Qi,MOUSE_BUTTON_1:Ji,MOUSE_BUTTON_2:es,MOUSE_BUTTON_3:ts,MOUSE_BUTTON_4:ns,MOUSE_POS_X:rs,MOUSE_POS_Y:is,MOUSE_WHEEL_X:ss,MOUSE_WHEEL_Y:as,MOUSE_WHEEL_Z:os}),ft=class{get polling(){return this.ref?this.ref.polling:!1}get value(){return!this.ref||this.disabled?0:this.ref.value}constructor(e){this.name=e,this.ref=null,this.disabled=!1}register(e){throw new Error("Unsupported operation.")}disable(e=!0){return this.disabled=e,this}getState(e){return!this.ref||this.disabled?0:this.ref.getState(e)}};function nn(t){Array.isArray(t)||(t=[t]);let e=[];for(let n of t){let r;try{r=M.parse(n)}catch(i){let s=ls(n).toUpperCase();if(!(s in G))throw new Error("Invalid key code string - "+i);r=G[s]}e.push(r)}return e}function ls(t){return t.replace(/([a-z]|(?:[A-Z0-9]+))([A-Z0-9]|$)/g,function(e,n,r){return n+(r&&"_"+r)}).toLowerCase()}var we=class extends ft{static fromBind(e,n,r,i=void 0){return new we(e,ct(n,r),i)}static fromString(e,...n){let r=nn(n);return new we(e,r)}get delta(){return!this.ref||this.disabled?0:this.ref.delta}constructor(e,n,r=void 0){super(e);this.keyCodes=Array.isArray(n)?n:[n],this.opts=r}register(e){let n=this.name,r=this.opts;for(let i of this.keyCodes)e.bindAxis(n,i.device,i.code,r);return this.ref=e.getAxis(n),this}},Q=class extends ft{static fromBind(e,n,r,i=void 0){return new Q(e,ct(n,r),i)}static fromString(e,...n){let r=nn(n);return new Q(e,r)}get pressed(){return!this.ref||this.disabled?!1:this.ref.pressed}get repeated(){return!this.ref||this.disabled?!1:this.ref.repeated}get released(){return!this.ref||this.disabled?!1:this.ref.released}get down(){return!this.ref||this.disabled?!1:this.ref.down}constructor(e,n,r=void 0){super(e);this.keyCodes=Array.isArray(n)?n:[n],this.opts=r}register(e){let n=this.name,r=this.opts;for(let i of this.keyCodes)e.bindButton(n,i.device,i.code,r);return this.ref=e.getButton(n),this}};var ht=class{static isAxis(e){return!1}static isButton(e){return!1}constructor(e,n){if(!n)throw new Error(`Missing event target for device ${e}.`);this.name=e,this.eventTarget=n,this.listeners={input:[]}}setEventTarget(e){if(!e)throw new Error(`Missing event target for device ${this.name}.`);this.eventTarget=e}destroy(){let e=this.listeners;for(let n in e)e[n].length=0}addEventListener(e,n){let r=this.listeners;e in r?r[e].push(n):r[e]=[n]}removeEventListener(e,n){let r=this.listeners;if(e in r){let i=r[e],s=i.indexOf(n);s>=0&&i.splice(s,1)}}dispatchInputEvent(e){let n=0;for(let r of this.listeners.input)n|=r(e);return Boolean(n)}},rn=class extends ht{static isAxis(e){return!1}static isButton(e){return!0}constructor(e,n,r={}){super(e,n);let{ignoreRepeat:i=!0}=r;this.ignoreRepeat=i,this._eventObject={target:n,device:e,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),n.addEventListener("keydown",this.onKeyDown),n.addEventListener("keyup",this.onKeyUp)}setEventTarget(e){this.eventTarget&&this.destroy(),super.setEventTarget(e),e.addEventListener("keydown",this.onKeyDown),e.addEventListener("keyup",this.onKeyUp)}destroy(){let e=this.eventTarget;e.removeEventListener("keydown",this.onKeyDown),e.removeEventListener("keyup",this.onKeyUp),super.destroy()}onKeyDown(e){if(e.repeat&&this.ignoreRepeat)return e.preventDefault(),e.stopPropagation(),!1;let n=this._eventObject;if(n.code=e.code,n.event="pressed",n.value=1,n.control=e.ctrlKey,n.shift=e.shiftKey,n.alt=e.altKey,this.dispatchInputEvent(n))return e.preventDefault(),e.stopPropagation(),!1}onKeyUp(e){let n=this._eventObject;if(n.code=e.code,n.event="released",n.value=1,n.control=e.ctrlKey,n.shift=e.shiftKey,n.alt=e.altKey,this.dispatchInputEvent(n))return e.preventDefault(),e.stopPropagation(),!1}},pt=10,dt=100,sn=class extends ht{static isAxis(e){return e==="PosX"||e==="PosY"||e==="WheelX"||e==="WheelY"||e==="WheelZ"}static isButton(e){return!this.isAxis(e)}constructor(e,n,r={}){super(e,n);let{eventsOnFocus:i=!0}=r;this.eventsOnFocus=i,this.canvasTarget=this.getCanvasFromEventTarget(n),this._downHasFocus=!1,this._eventObject={target:n,device:e,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this._positionObject={target:n,device:e,code:"",event:"move",value:0,movement:0},this._wheelObject={target:n,device:e,code:"",event:"wheel",movement:0},this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onWheel=this.onWheel.bind(this),n.addEventListener("mousedown",this.onMouseDown),n.addEventListener("contextmenu",this.onContextMenu),n.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}setEventTarget(e){this.eventTarget&&this.destroy(),super.setEventTarget(e),this.canvasTarget=this.getCanvasFromEventTarget(e),e.addEventListener("mousedown",this.onMouseDown),e.addEventListener("contextmenu",this.onContextMenu),e.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}destroy(){let e=this.eventTarget;e.removeEventListener("mousedown",this.onMouseDown),e.removeEventListener("contextmenu",this.onContextMenu),e.removeEventListener("wheel",this.onWheel),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),super.destroy()}setPointerLock(e=!0){e?this.eventTarget.requestPointerLock():this.eventTarget.exitPointerLock()}hasPointerLock(){return document.pointerLockElement===this.eventTarget}onMouseDown(e){this._downHasFocus=!0;let n=this._eventObject;if(n.code="Button"+e.button,n.event="pressed",n.value=1,n.control=e.ctrlKey,n.shift=e.shiftKey,n.alt=e.altKey,this.dispatchInputEvent(n)&&document.activeElement===this.eventTarget)return e.preventDefault(),e.stopPropagation(),!1}onContextMenu(e){return e.preventDefault(),e.stopPropagation(),!1}onWheel(e){let n,r,i;switch(e.deltaMode){case WheelEvent.DOM_DELTA_LINE:n=e.deltaX*pt,r=e.deltaY*pt,i=e.deltaZ*pt;break;case WheelEvent.DOM_DELTA_PAGE:n=e.deltaX*dt,r=e.deltaY*dt,i=e.deltaZ*dt;break;case WheelEvent.DOM_DELTA_PIXEL:default:n=e.deltaX,r=e.deltaY,i=e.deltaZ;break}let s=0,a=this._wheelObject;if(a.code="WheelX",a.movement=n,s|=this.dispatchInputEvent(a),a.code="WheelY",a.movement=r,s|=this.dispatchInputEvent(a),a.code="WheelZ",a.movement=i,s|=this.dispatchInputEvent(a),s)return e.preventDefault(),e.stopPropagation(),!1}onMouseUp(e){if(!this._downHasFocus)return;this._downHasFocus=!1;let n=this._eventObject;if(n.code="Button"+e.button,n.event="released",n.value=1,n.control=e.ctrlKey,n.shift=e.shiftKey,n.alt=e.altKey,this.dispatchInputEvent(n))return e.preventDefault(),e.stopPropagation(),!1}onMouseMove(e){if(this.eventsOnFocus&&document.activeElement!==this.eventTarget)return;let n=this.canvasTarget,{clientWidth:r,clientHeight:i}=n,s=n.getBoundingClientRect(),a=e.movementX/r,o=e.movementY/i,l=(e.clientX-s.left)/r,u=(e.clientY-s.top)/i,c=this._positionObject;c.code="PosX",c.value=l,c.movement=a,this.dispatchInputEvent(c),c.code="PosY",c.value=u,c.movement=o,this.dispatchInputEvent(c)}getCanvasFromEventTarget(e){return e instanceof HTMLCanvasElement?e:e.canvas||e.querySelector("canvas")||e.shadowRoot&&e.shadowRoot.querySelector("canvas")||e}},us=`<kbd>
  <span id="name"><slot></slot></span>
  <span id="value" class="hidden"></span>
</kbd>
`,cs=`kbd {
  position: relative;
  display: inline-block;
  border-radius: 3px;
  border: 1px solid #888888;
  font-size: 0.85em;
  font-weight: 700;
  text-rendering: optimizeLegibility;
  line-height: 12px;
  height: 14px;
  padding: 2px 4px;
  color: #444444;
  background-color: #eeeeee;
  box-shadow: inset 0 -3px 0 #aaaaaa;
  overflow: hidden;
}

kbd:empty::after {
  content: '<?>';
  opacity: 0.6;
}

.disabled {
  opacity: 0.6;
  box-shadow: none;
  background-color: #aaaaaa;
}

.hidden {
  display: none;
}

#value {
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  font-size: 0.85em;
  padding: 0 4px;
  padding-top: 2px;
  color: #cccccc;
  background-color: #333333;
  box-shadow: inset 0 3px 0 #222222;
}
`,vt=class extends HTMLElement{static get[Symbol.for("templateNode")](){let e=document.createElement("template");return e.innerHTML=us,Object.defineProperty(this,Symbol.for("templateNode"),{value:e}),e}static get[Symbol.for("styleNode")](){let e=document.createElement("style");return e.innerHTML=cs,Object.defineProperty(this,Symbol.for("styleNode"),{value:e}),e}static define(e=window.customElements){e.define("input-code",this)}static get observedAttributes(){return["name","value","disabled"]}get disabled(){return this._disabled}set disabled(e){this.toggleAttribute("disabled",e)}get value(){return this._value}set value(e){this.setAttribute("value",e)}get name(){return this._name}set name(e){this.setAttribute("name",e)}constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._name="",this._value="",this._disabled=!1,this._kbdElement=this.shadowRoot.querySelector("kbd"),this._nameElement=this.shadowRoot.querySelector("#name"),this._valueElement=this.shadowRoot.querySelector("#value")}attributeChangedCallback(e,n,r){switch(e){case"name":this._name=r,this._nameElement.textContent=r;break;case"value":this._value=r,r!==null?(this._valueElement.classList.toggle("hidden",!1),this._valueElement.textContent=r,this._kbdElement.style.paddingRight=`${this._valueElement.clientWidth+4}px`):this._valueElement.classList.toggle("hidden",!0);break;case"disabled":this._disabled=r!==null,this._kbdElement.classList.toggle("disabled",r!==null);break}}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"name")){let e=this.name;delete this.name,this.name=e}if(Object.prototype.hasOwnProperty.call(this,"value")){let e=this.value;delete this.value,this.value=e}if(Object.prototype.hasOwnProperty.call(this,"disabled")){let e=this.disabled;delete this.disabled,this.disabled=e}}};vt.define();var fs=`<table>
  <thead>
    <tr class="tableHeader">
      <th colspan="3">
        <span class="tableTitle">
          <label id="title"> input-source </label>
          <span id="slotContainer">
            <slot></slot>
          </span>
          <p>
            <label for="poll">poll</label>
            <output id="poll"></output>
          </p>
          <p>
            <label for="focus">focus</label>
            <output id="focus"></output>
          </p>
        </span>
      </th>
    </tr>
    <tr class="colHeader">
      <th>name</th>
      <th>value</th>
      <th>key</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
`,hs=`:host {
  display: block;
}

table {
  border-collapse: collapse;
  font-family: monospace;
}

table,
th,
td {
  border: 1px solid #666666;
}

th,
td {
  padding: 5px 10px;
}

td {
  text-align: center;
}

thead th {
  padding: 0;
}

.colHeader > th {
  font-size: 0.8em;
  padding: 0 10px;
  letter-spacing: 3px;
  background-color: #aaaaaa;
  color: #666666;
}

tbody output {
  border-radius: 0.3em;
  padding: 3px;
}

tr:not(.primary) .name,
tr:not(.primary) .value {
  opacity: 0.3;
}

tr:nth-child(2n) {
  background-color: #eeeeee;
}

.tableHeader {
  color: #666666;
}

.tableTitle {
  display: flex;
  flex-direction: row;
  align-items: center;
  padding: 4px;
}

#slotContainer {
  flex: 1;
}

p {
  display: inline;
  margin: 0;
  padding: 0;
  padding-right: 10px;
}

#poll:empty::after,
#focus:empty::after {
  content: '\u2717';
  color: #ff0000;
}
`,an=class{constructor(e){this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null,this.pollable=e}get running(){return this.animationFrameHandle!==null}start(){let e=this.animationFrameHandle;e&&cancelAnimationFrame(e),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}stop(){let e=this.animationFrameHandle;e&&cancelAnimationFrame(e),this.animationFrameHandle=null}onAnimationFrame(e){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.pollable.onPoll(e)}},on=class{constructor(e){this.onInput=this.onInput.bind(this),this.onPoll=this.onPoll.bind(this),this.bindings=e}onPoll(e){for(let n of this.bindings.getInputs())n.onPoll(e)}onInput(e){let{device:n,code:r,event:i,value:s,movement:a,control:o,shift:l,alt:u}=e,c=this.bindings.getBindings(n,r);switch(i){case"pressed":for(let{input:f,index:h}of c)f.onUpdate(h,1,1);break;case"released":for(let{input:f,index:h}of c)f.onUpdate(h,0,-1);break;case"move":for(let{input:f,index:h}of c)f.onUpdate(h,s,a);break;case"wheel":for(let{input:f,index:h}of c)f.onUpdate(h,void 0,a);break}return c.length>0}},mt=class{constructor(e,n,r,i){this.device=e,this.code=n,this.input=r,this.index=i}},ln=class{constructor(){this.bindingMap={},this.inputMap=new Map}clear(){for(let e of this.inputMap.keys())e.onUnbind();this.inputMap.clear(),this.bindingMap={}}bind(e,n,r,i={inverted:!1}){let s,a=this.inputMap;if(a.has(e)){let l=a.get(e),u=e.size;e.onBind(u,i),s=new mt(n,r,e,u),l.push(s)}else{let l=[];a.set(e,l);let u=0;e.onBind(u,i),s=new mt(n,r,e,u),l.push(s)}let o=this.bindingMap;n in o?r in o[n]?o[n][r].push(s):o[n][r]=[s]:o[n]={[r]:[s]}}unbind(e){let n=this.inputMap;if(n.has(e)){let r=this.bindingMap,i=n.get(e);for(let s of i){let{device:a,code:o}=s,l=r[a][o],u=l.indexOf(s);l.splice(u,1)}i.length=0,e.onUnbind(),n.delete(e)}}isBound(e){return this.inputMap.has(e)}getInputs(){return this.inputMap.keys()}getBindingsByInput(e){return this.inputMap.get(e)}getBindings(e,n){let r=this.bindingMap;if(e in r){let i=r[e];if(n in i)return i[n]}return[]}},un=class{constructor(e,n={}){this.inputs={},this.devices=[new sn("Mouse",e),new rn("Keyboard",e)],this.bindings=new ln,this.adapter=new on(this.bindings),this.autopoller=new an(this.adapter),this.eventTarget=e,this.anyButton=new ze(1),this.anyButtonDevice="",this.anyButtonCode="",this.anyAxis=new Ce(1),this.anyAxisDevice="",this.anyAxisCode="",this.listeners={bind:[],unbind:[],focus:[],blur:[]},this.onInput=this.onInput.bind(this),this.onEventTargetBlur=this.onEventTargetBlur.bind(this),this.onEventTargetFocus=this.onEventTargetFocus.bind(this),e.addEventListener("focus",this.onEventTargetFocus),e.addEventListener("blur",this.onEventTargetBlur);for(let r of this.devices)r.addEventListener("input",this.onInput)}get autopoll(){return this.autopoller.running}set autopoll(e){this.toggleAutoPoll(e)}destroy(){let e=this.listeners;for(let r in e)e[r].length=0;this.autopoller.running&&this.autopoller.stop();for(let r of this.devices)r.removeEventListener("input",this.onInput),r.destroy();let n=this.eventTarget;n.removeEventListener("focus",this.onEventTargetFocus),n.removeEventListener("blur",this.onEventTargetBlur)}setEventTarget(e){let n=this.eventTarget;n.removeEventListener("focus",this.onEventTargetFocus),n.removeEventListener("blur",this.onEventTargetBlur),this.eventTarget=e;for(let r of this.devices)r.setEventTarget(e);e.addEventListener("focus",this.onEventTargetFocus),e.addEventListener("blur",this.onEventTargetBlur)}toggleAutoPoll(e=void 0){let n=this.autopoller.running,r=typeof e=="undefined"?!n:Boolean(e);r!==n&&(r?this.autopoller.start():this.autopoller.stop())}addEventListener(e,n){let r=this.listeners;e in r?r[e].push(n):r[e]=[n]}removeEventListener(e,n){let r=this.listeners;if(e in r){let i=r[e],s=i.indexOf(n);s>=0&&i.splice(s,1)}}dispatchEvent(e){let{type:n}=e,r=0;for(let i of this.listeners[n])r|=i(e)?1:0;return Boolean(r)}poll(e=performance.now()){if(this.autopoller.running)throw new Error("Should not manually poll() while autopolling.");this.onPoll(e)}onInput(e){let n=this.adapter.onInput(e);switch(e.event){case"pressed":this.anyButtonDevice=e.device,this.anyButtonCode=e.code,this.anyButton.onUpdate(0,1,1);break;case"released":this.anyButtonDevice=e.device,this.anyButtonCode=e.code,this.anyButton.onUpdate(0,0,-1);break;case"move":case"wheel":this.anyAxisDevice=e.device,this.anyAxisCode=e.code,this.anyAxis.onUpdate(0,e.value,e.movement);break}return n}onPoll(e){this.adapter.onPoll(e),this.anyButton.onPoll(e),this.anyAxis.onPoll(e)}onBind(){this.dispatchEvent({type:"bind"})}onUnbind(){this.dispatchEvent({type:"unbind"})}onEventTargetFocus(){this.dispatchEvent({type:"focus"})}onEventTargetBlur(){for(let e of this.bindings.getInputs())e.onStatus(0,0);this.anyButton.onStatus(0,0),this.anyAxis.onStatus(0,0),this.dispatchEvent({type:"blur"})}bindBindings(e){for(let n of e)n.register(this)}bindButton(e,n,r,i=void 0){let s;this.hasButton(e)?s=this.getButton(e):(s=new ze(1),this.inputs[e]=s),this.bindings.bind(s,n,r,i),this.onBind()}bindAxis(e,n,r,i=void 0){let s;this.hasAxis(e)?s=this.getAxis(e):(s=new Ce(1),this.inputs[e]=s),this.bindings.bind(s,n,r,i),this.onBind()}bindAxisButtons(e,n,r,i){let s;this.hasAxis(e)?s=this.getAxis(e):(s=new Ce(2),this.inputs[e]=s),this.bindings.bind(s,n,i),this.bindings.bind(s,n,r,{inverted:!0}),this.onBind()}unbindButton(e){if(this.hasButton(e)){let n=this.getButton(e);delete this.inputs[e],this.bindings.unbind(n),this.onUnbind()}}unbindAxis(e){if(this.hasAxis(e)){let n=this.getAxis(e);delete this.inputs[e],this.bindings.unbind(n),this.onUnbind()}}getInput(e){return this.inputs[e]}getButton(e){return this.inputs[e]}getAxis(e){return this.inputs[e]}hasButton(e){return e in this.inputs&&this.inputs[e]instanceof ze}hasAxis(e){return e in this.inputs&&this.inputs[e]instanceof Ce}isButtonDown(e){return this.inputs[e].down}isButtonPressed(e){return this.inputs[e].pressed}isButtonReleased(e){return this.inputs[e].released}getInputValue(e){return this.inputs[e].value}getButtonValue(e){return this.inputs[e].value}getAxisValue(e){return this.inputs[e].value}getAxisDelta(e){return this.inputs[e].delta}isAnyButtonDown(e=void 0){if(typeof e=="undefined")return this.anyButton.down;{let n=this.inputs;for(let r of e)if(n[r].down)return!0}return!1}isAnyButtonPressed(e=void 0){if(typeof e=="undefined")return this.anyButton.pressed;{let n=this.inputs;for(let r of e)if(n[r].pressed)return!0}return!1}isAnyButtonReleased(e=void 0){if(typeof e=="undefined")return this.anyButton.released;{let n=this.inputs;for(let r of e)if(n[r].released)return!0}return!1}getAnyAxisValue(e=void 0){if(typeof e=="undefined")return this.anyAxis.value;{let n=this.inputs;for(let r of e){let i=n[r];if(i.value)return i.value}}return 0}getAnyAxisDelta(e=void 0){if(typeof e=="undefined")return this.anyAxis.delta;{let n=this.inputs;for(let r of e){let i=n[r];if(i.delta)return i.delta}}return 0}getLastButtonDevice(){return this.anyButtonDevice}getLastButtonCode(){return this.anyButtonCode}getLastAxisDevice(){return this.anyAxisDevice}getLastAxisCode(){return this.anyAxisCode}getMouse(){return this.devices[0]}getKeyboard(){return this.devices[1]}},cn=class extends HTMLElement{static get[Symbol.for("templateNode")](){let e=document.createElement("template");return e.innerHTML=fs,Object.defineProperty(this,Symbol.for("templateNode"),{value:e}),e}static get[Symbol.for("styleNode")](){let e=document.createElement("style");return e.innerHTML=hs,Object.defineProperty(this,Symbol.for("styleNode"),{value:e}),e}static define(e=window.customElements){e.define("input-port",this)}static get observedAttributes(){return["autopoll","for"]}get autopoll(){return this._autopoll}set autopoll(e){this.toggleAttribute("autopoll",e)}get for(){return this._for}set for(e){this.setAttribute("for",e)}constructor(){super();let e=this.attachShadow({mode:"open"});e.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),e.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._titleElement=e.querySelector("#title"),this._pollElement=e.querySelector("#poll"),this._focusElement=e.querySelector("#focus"),this._bodyElement=e.querySelector("tbody"),this._outputElements={},this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null;let n=this;this._for="",this._eventTarget=n,this._autopoll=!1,this._context=null,this.onInputContextBind=this.onInputContextBind.bind(this),this.onInputContextUnbind=this.onInputContextUnbind.bind(this),this.onInputContextFocus=this.onInputContextFocus.bind(this),this.onInputContextBlur=this.onInputContextBlur.bind(this)}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"for")){let e=this.for;delete this.for,this.for=e}if(Object.prototype.hasOwnProperty.call(this,"autopoll")){let e=this.autopoll;delete this.autopoll,this.autopoll=e}this.updateTable(),this.updateTableValues(),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}disconnectedCallback(){let e=this._context;e&&(e.removeEventListener("bind",this.onInputContextBind),e.removeEventListener("unbind",this.onInputContextUnbind),e.removeEventListener("blur",this.onInputContextBlur),e.removeEventListener("focus",this.onInputContextFocus),e.destroy(),this._context=null)}attributeChangedCallback(e,n,r){switch(e){case"for":{this._for=r;let i,s;r?(i=document.getElementById(r),s=`${i.tagName.toLowerCase()}#${r}`):(i=this,s="input-port"),this._eventTarget=i,this._context&&this._context.setEventTarget(this._eventTarget),this._titleElement.innerHTML=`for ${s}`}break;case"autopoll":this._autopoll=r!==null,this._context&&this._context.toggleAutoPoll(this._autopoll);break}}onAnimationFrame(){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.updateTableValues(),this.updatePollStatus()}onInputContextBind(){return this.updateTable(),!0}onInputContextUnbind(){return this.updateTable(),!0}onInputContextFocus(){return this._focusElement.innerHTML="\u2713",!0}onInputContextBlur(){return this._focusElement.innerHTML="",!0}getContext(e="axisbutton",n=void 0){switch(e){case"axisbutton":if(!this._context){let r=new un(this._eventTarget,n);r.addEventListener("bind",this.onInputContextBind),r.addEventListener("unbind",this.onInputContextUnbind),r.addEventListener("blur",this.onInputContextBlur),r.addEventListener("focus",this.onInputContextFocus),this._autopoll&&r.toggleAutoPoll(!0),this._context=r}return this._context;default:throw new Error(`Input context id '${e}' is not supported.`)}}updateTable(){if(this.isConnected)if(this._context){let e=this._context,n=e.inputs,r=e.bindings,i={},s=[];for(let a of Object.keys(n)){let o=n[a],l=!0;for(let u of r.getBindingsByInput(o)){let c=ps(`${o.constructor.name}.${a}`,`${u.device}.${u.code}`,0,l);s.push(c),l&&(i[a]=c.querySelector("output"),l=!1)}}this._outputElements=i,this._bodyElement.innerHTML="";for(let a of s)this._bodyElement.appendChild(a)}else{this._outputElements={},this._bodyElement.innerHTML="";return}else return}updateTableValues(){if(this.isConnected)if(this._context){let n=this._context.inputs;for(let r of Object.keys(this._outputElements)){let i=this._outputElements[r],s=n[r].value;i.innerText=Number(s).toFixed(2)}}else{for(let e of Object.keys(this._outputElements)){let n=this._outputElements[e];n.innerText="---"}return}else return}updatePollStatus(){if(this.isConnected)if(this._context){let n=this._context.inputs;for(let r of Object.values(n))if(!r.polling){this._pollElement.innerHTML="";return}this._pollElement.innerHTML="\u2713"}else{this._pollElement.innerHTML="-";return}else return}};cn.define();function ps(t,e,n,r=!0){let i=document.createElement("tr");r&&i.classList.add("primary");{let s=document.createElement("td");s.textContent=t,s.classList.add("name"),i.appendChild(s)}{let s=document.createElement("td"),a=document.createElement("output");r?a.innerText=Number(n).toFixed(2):a.innerText="---",a.classList.add("value"),s.appendChild(a),i.appendChild(s)}{let s=document.createElement("td");s.classList.add("key");let a=new vt;a.innerText=e,s.appendChild(a),i.appendChild(s)}return i}var Yl=Symbol("keyboardSource");var $l=Symbol("mouseSource");var fa=Fr(zn());var Kn={},Xs=function(t,e,n,r,i){var s=new Worker(Kn[e]||(Kn[e]=URL.createObjectURL(new Blob([t],{type:"text/javascript"}))));return s.onerror=function(a){return i(a.error,null)},s.onmessage=function(a){return i(null,a.data)},s.postMessage(n,r),s},J=Uint8Array,ce=Uint16Array,Ne=Uint32Array,Lt=new J([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Ct=new J([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Yn=new J([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),$n=function(t,e){for(var n=new ce(31),r=0;r<31;++r)n[r]=e+=1<<t[r-1];for(var i=new Ne(n[30]),r=1;r<30;++r)for(var s=n[r];s<n[r+1];++s)i[s]=s-n[r]<<5|r;return[n,i]},Gn=$n(Lt,2),Ot=Gn[0],Zs=Gn[1];Ot[28]=258,Zs[258]=28;var Vn=$n(Ct,0),Wn=Vn[0],Jl=Vn[1],qe=new ce(32768);for(var K=0;K<32768;++K)ve=(K&43690)>>>1|(K&21845)<<1,ve=(ve&52428)>>>2|(ve&13107)<<2,ve=(ve&61680)>>>4|(ve&3855)<<4,qe[K]=((ve&65280)>>>8|(ve&255)<<8)>>>1;var ve,Se=function(t,e,n){for(var r=t.length,i=0,s=new ce(e);i<r;++i)++s[t[i]-1];var a=new ce(e);for(i=0;i<e;++i)a[i]=a[i-1]+s[i-1]<<1;var o;if(n){o=new ce(1<<e);var l=15-e;for(i=0;i<r;++i)if(t[i])for(var u=i<<4|t[i],c=e-t[i],f=a[t[i]-1]++<<c,h=f|(1<<c)-1;f<=h;++f)o[qe[f]>>>l]=u}else for(o=new ce(r),i=0;i<r;++i)t[i]&&(o[i]=qe[a[t[i]-1]++]>>>15-t[i]);return o},De=new J(288);for(var K=0;K<144;++K)De[K]=8;for(var K=144;K<256;++K)De[K]=9;for(var K=256;K<280;++K)De[K]=7;for(var K=280;K<288;++K)De[K]=8;var jn=new J(32);for(var K=0;K<32;++K)jn[K]=5;var qn=Se(De,9,1);var Xn=Se(jn,5,1),Xe=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},re=function(t,e,n){var r=e/8|0;return(t[r]|t[r+1]<<8)>>(e&7)&n},Ze=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(e&7)},Zn=function(t){return(t/8|0)+(t&7&&1)},Qe=function(t,e,n){(e==null||e<0)&&(e=0),(n==null||n>t.length)&&(n=t.length);var r=new(t instanceof ce?ce:t instanceof Ne?Ne:J)(n-e);return r.set(t.subarray(e,n)),r},Qn=function(t,e,n){var r=t.length;if(!r||n&&!n.l&&r<5)return e||new J(0);var i=!e||n,s=!n||n.i;n||(n={}),e||(e=new J(r*3));var a=function(U){var xe=e.length;if(U>xe){var Ue=new J(Math.max(xe*2,U));Ue.set(e),e=Ue}},o=n.f||0,l=n.p||0,u=n.b||0,c=n.l,f=n.d,h=n.m,d=n.n,v=r*8;do{if(!c){n.f=o=re(t,l,1);var _=re(t,l+1,3);if(l+=3,_)if(_==1)c=qn,f=Xn,h=9,d=5;else if(_==2){var g=re(t,l,31)+257,T=re(t,l+10,15)+4,b=g+re(t,l+5,31)+1;l+=14;for(var R=new J(b),N=new J(19),y=0;y<T;++y)N[Yn[y]]=re(t,l+y*3,7);l+=T*3;for(var C=Xe(N),P=(1<<C)-1,A=Se(N,C,1),y=0;y<b;){var B=A[re(t,l,P)];l+=B&15;var p=B>>>4;if(p<16)R[y++]=p;else{var O=0,D=0;for(p==16?(D=3+re(t,l,3),l+=2,O=R[y-1]):p==17?(D=3+re(t,l,7),l+=3):p==18&&(D=11+re(t,l,127),l+=7);D--;)R[y++]=O}}var m=R.subarray(0,g),E=R.subarray(g);h=Xe(m),d=Xe(E),c=Se(m,h,1),f=Se(E,d,1)}else throw"invalid block type";else{var p=Zn(l)+4,x=t[p-4]|t[p-3]<<8,I=p+x;if(I>r){if(s)throw"unexpected EOF";break}i&&a(u+x),e.set(t.subarray(p,I),u),n.b=u+=x,n.p=l=I*8;continue}if(l>v){if(s)throw"unexpected EOF";break}}i&&a(u+131072);for(var $=(1<<h)-1,H=(1<<d)-1,q=l;;q=l){var O=c[Ze(t,l)&$],X=O>>>4;if(l+=O&15,l>v){if(s)throw"unexpected EOF";break}if(!O)throw"invalid length/literal";if(X<256)e[u++]=X;else if(X==256){q=l,c=null;break}else{var Z=X-254;if(X>264){var y=X-257,oe=Lt[y];Z=re(t,l,(1<<oe)-1)+Ot[y],l+=oe}var Le=f[Ze(t,l)&H],me=Le>>>4;if(!Le)throw"invalid distance";l+=Le&15;var E=Wn[me];if(me>3){var oe=Ct[me];E+=Ze(t,l)&(1<<oe)-1,l+=oe}if(l>v){if(s)throw"unexpected EOF";break}i&&a(u+131072);for(var le=u+Z;u<le;u+=4)e[u]=e[u-E],e[u+1]=e[u+1-E],e[u+2]=e[u+2-E],e[u+3]=e[u+3-E];u=le}}n.l=c,n.p=q,n.b=u,c&&(o=1,n.m=h,n.d=f,n.n=d)}while(!o);return u==e.length?e:Qe(e,0,u)};var Qs=new J(0);var Js=function(t,e){var n={};for(var r in t)n[r]=t[r];for(var r in e)n[r]=e[r];return n},Jn=function(t,e,n){for(var r=t(),i=t.toString(),s=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/ /g,"").split(","),a=0;a<r.length;++a){var o=r[a],l=s[a];if(typeof o=="function"){e+=";"+l+"=";var u=o.toString();if(o.prototype)if(u.indexOf("[native code]")!=-1){var c=u.indexOf(" ",8)+1;e+=u.slice(c,u.indexOf("(",c))}else{e+=u;for(var f in o.prototype)e+=";"+l+".prototype."+f+"="+o.prototype[f].toString()}else e+=u}else n[l]=o}return[e,n]},Je=[],ea=function(t){var e=[];for(var n in t)(t[n]instanceof J||t[n]instanceof ce||t[n]instanceof Ne)&&e.push((t[n]=new t[n].constructor(t[n])).buffer);return e},ta=function(t,e,n,r){var i;if(!Je[n]){for(var s="",a={},o=t.length-1,l=0;l<o;++l)i=Jn(t[l],s,a),s=i[0],a=i[1];Je[n]=Jn(t[o],s,a)}var u=Js({},Je[n][1]);return Xs(Je[n][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",n,u,ea(u),r)},na=function(){return[J,ce,Ne,Lt,Ct,Yn,Ot,Wn,qn,Xn,qe,Se,Xe,re,Ze,Zn,Qe,Qn,Bt,er,tr]};var er=function(t){return postMessage(t,[t.buffer])},tr=function(t){return t&&t.size&&new J(t.size)},ra=function(t,e,n,r,i,s){var a=ta(n,r,i,function(o,l){a.terminate(),s(o,l)});return a.postMessage([t,e],e.consume?[t.buffer]:[]),function(){a.terminate()}};var fe=function(t,e){return t[e]|t[e+1]<<8},ae=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},Nt=function(t,e){return ae(t,e)+ae(t,e+4)*4294967296};function ia(t,e,n){if(n||(n=e,e={}),typeof n!="function")throw"no callback";return ra(t,e,[na],function(r){return er(Bt(r.data[0],tr(r.data[1])))},1,n)}function Bt(t,e){return Qn(t,e)}var eu=typeof TextEncoder!="undefined"&&new TextEncoder,Dt=typeof TextDecoder!="undefined"&&new TextDecoder,sa=0;try{Dt.decode(Qs,{stream:!0}),sa=1}catch(t){}var aa=function(t){for(var e="",n=0;;){var r=t[n++],i=(r>127)+(r>223)+(r>239);if(n+i>t.length)return[e,Qe(t,n-1)];i?i==3?(r=((r&15)<<18|(t[n++]&63)<<12|(t[n++]&63)<<6|t[n++]&63)-65536,e+=String.fromCharCode(55296|r>>10,56320|r&1023)):i&1?e+=String.fromCharCode((r&31)<<6|t[n++]&63):e+=String.fromCharCode((r&15)<<12|(t[n++]&63)<<6|t[n++]&63):e+=String.fromCharCode(r)}};function oa(t,e){if(e){for(var n="",r=0;r<t.length;r+=16384)n+=String.fromCharCode.apply(null,t.subarray(r,r+16384));return n}else{if(Dt)return Dt.decode(t);var i=aa(t),s=i[0],a=i[1];if(a.length)throw"invalid utf-8 data";return s}}var la=function(t,e){return e+30+fe(t,e+26)+fe(t,e+28)},ca=function(t,e,n){var r=fe(t,e+28),i=oa(t.subarray(e+46,e+46+r),!(fe(t,e+8)&2048)),s=e+46+r,a=ae(t,e+20),o=n&&a==4294967295?ua(t,s):[a,ae(t,e+24),ae(t,e+42)],l=o[0],u=o[1],c=o[2];return[fe(t,e+10),l,u,i,s+fe(t,e+30)+fe(t,e+32),c]},ua=function(t,e){for(;fe(t,e)!=1;e+=4+fe(t,e+2));return[Nt(t,e+12),Nt(t,e+4),Nt(t,e+20)]};function Pt(t,e){if(typeof e!="function")throw"no callback";for(var n=[],r=function(){for(var h=0;h<n.length;++h)n[h]()},i={},s=t.length-22;ae(t,s)!=101010256;--s)if(!s||t.length-s>65558){e("invalid zip file",null);return}var a=fe(t,s+8);a||e(null,{});var o=a,l=ae(t,s+16),u=l==4294967295;if(u){if(s=ae(t,s-12),ae(t,s)!=101075792){e("invalid zip file",null);return}o=a=ae(t,s+32),l=ae(t,s+48)}for(var c=function(h){var d=ca(t,l,u),v=d[0],_=d[1],p=d[2],x=d[3],I=d[4],g=d[5],T=la(t,g);l=I;var b=function(N,y){N?(r(),e(N,null)):(i[x]=y,--a||e(null,i))};if(!v)b(null,Qe(t,T,T+_));else if(v==8){var R=t.subarray(T,T+_);if(_<32e4)try{b(null,Bt(R,new J(p)))}catch(N){b(N,null)}else n.push(ia(R,{size:p},b))}else b("unknown compression type "+v,null)},f=0;f<o;++f)c(f);return r}var ha=/^([_\w\d]+)\:\/\//,nr=5e3;async function pa(t,e,n,r,i=nr){let{cache:s,loadings:a}=t;if(e in s)return s[e];let o;if(e in a){if(o=a[e],o.active)return a[e].promise}else o=new Ut(i),a[e]=o;let l=[o.promise];return ha.test(n)?l.push(rr(t,n,i).then(u=>r(u)).then(u=>Re(t,e,u))):l.push(fetch(n).then(u=>u.arrayBuffer()).then(u=>r(u)).then(u=>Re(t,e,u))),await Promise.race(l)}function Re(t,e,n){let{cache:r,loadings:i}=t;return r[e]=n,e in i&&(i[e].resolve(n),delete i[e]),n}function da(t,e){let{cache:n,loadings:r}=t;e in r&&(r[e].reject(new Error("Stop loading to delete asset.")),delete r[e]),e in n&&delete n[e]}async function rr(t,e,n=nr){let{cache:r,loadings:i}=t;if(e in r)return r[e];if(e in i)return i[e].promise;{let s=new Ut(n);return i[e]=s,s.promise}}function va(t,e){let{defaults:n}=t;for(let r of n)if(r.glob.test(e))return Ft(t,r.uri);return null}function Ft(t,e){return t.cache[e]}function ma(t){return Object.keys(t.cache)}var Ut=class{constructor(e){this.active=!1,this._resolve=null,this._reject=null,this._reason=null,this._value=null,this._timeoutHandle=Number.isFinite(e)&&e>0?setTimeout(()=>{this.reject(`Asset loading exceeded timeout of ${e} ms.`)},e):null,this._promise=new Promise((n,r)=>{this._value?n(this._value):this._resolve=n,this._reason?r(this._reason):this._reject=r})}get promise(){return this._promise}resolve(e){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._resolve?this._resolve(e):this._value=e}reject(e){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._reject?this._reject(e):this._reason=e}},Ht=class{constructor(e,n,r){this.uri=e,this.source=n,this.loader=r,this.store=null}get current(){return Ft(this.store,this.uri)}set current(e){Re(this.store,this.uri,e)}get default(){return va(this.store,this.uri)}get loaded(){return rr(this.store,this.uri)}async preload(e,n=void 0,r=void 0){return this.store=e,typeof r!="undefined"?Re(e,this.uri,r):await pa(this.store,this.uri,this.source,this.loader,n),this}async unload(){return da(this.store,this.uri),this.store=null,this}},_a=5e3,Pe={cache:{},loadings:{},defaults:[]};async function Ea(t,e=void 0){let n="raw://",i=await(await fetch(t)).arrayBuffer();await new Promise((s,a)=>{Pt(new Uint8Array(i),(o,l)=>{if(o)a(o);else{for(let[u,c]of Object.entries(l)){u=u.replaceAll("\\","/");let f=u.indexOf("/");f>=0&&(u=u.substring(f+1));let h=n+u;Re(Pe,h,c),e&&e(c,h,u)}s()}})})}async function Aa(t,e){let r=await(await fetch(t)).arrayBuffer();await new Promise((i,s)=>{Pt(new Uint8Array(r),(a,o)=>{if(a)s(a);else{for(let[l,u]of Object.entries(o))l=l.replaceAll("\\","/"),e(u,l);i()}})})}async function xa(t,e=_a){let n=[];for(let r of t)n.push(r.preload(Pe,e));await Promise.allSettled(n)}function ya(t,e){return Re(Pe,t,e)}function ga(){return ma(Pe)}function ir(t){return Ft(Pe,t)}function wa(t){return ir(t)}var et=Object.freeze({__proto__:null,loadAssetPackAsRaw:Ea,loadAssetPack:Aa,loadAssetRefs:xa,cache:ya,keys:ga,current:ir,get:wa});window.addEventListener("error",tt,!0);window.addEventListener("unhandledrejection",tt,!0);function tt(t){typeof t=="object"?t instanceof PromiseRejectionEvent?tt(t.reason):t instanceof ErrorEvent?tt(t.error):t instanceof Error?window.alert(t.stack):window.alert(JSON.stringify(t)):window.alert(t)}var he={CursorX:new we("cursorX",[G.MOUSE_POS_X]),CursorY:new we("cursorY",[G.MOUSE_POS_Y]),CursorMain:new Q("cursorMain",G.MOUSE_BUTTON_0),CursorAlt:new Q("cursorAlt",G.MOUSE_BUTTON_2),MoveLeft:new Q("moveLeft",[G.KEY_A,G.ARROW_LEFT]),MoveRight:new Q("moveRight",[G.KEY_D,G.ARROW_RIGHT]),MoveUp:new Q("moveUp",[G.KEY_Q]),MoveDown:new Q("moveDown",[G.KEY_E]),MoveForward:new Q("moveForward",[G.KEY_W,G.ARROW_UP]),MoveBackward:new Q("moveBackward",[G.KEY_S,G.ARROW_DOWN]),MainAction:new Q("mainAction",[G.KEY_Z,G.KEY_Q]),AltAction:new Q("altAction",[G.KEY_X,G.KEY_E]),Evade:new Q("evade",[G.SPACE])};async function kt(t,e=void 0){if(typeof t=="string"){let o=await(await fetch(t)).arrayBuffer();if(typeof e=="undefined"){let l=t.lastIndexOf(".");if(l<0)throw new Error("Cannot load from url - unknown image type.");e="image/"+t.slice(l+1)}return kt(o,e)}else if(!(t instanceof ArrayBuffer||ArrayBuffer.isView(t)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let n=t;typeof e=="undefined"&&(e="image/png");let r=new Blob([n],{type:e}),i=URL.createObjectURL(r),s=new Image;return new Promise((a,o)=>{s.addEventListener("load",()=>{a(s)}),s.addEventListener("error",l=>{o(l)}),s.src=i})}var sr={ImageToast:new Ht("toast","res/toast.png",kt)};var Ee={};ke(Ee,{connectInputs:()=>ba,getDisplayPort:()=>Sa,getInputPort:()=>Ra,preloadAssetPack:()=>Ta,preloadAssets:()=>Ma});async function ba(t,e="input-port"){let r=document.querySelector(e).getContext("axisbutton");return r.bindBindings(Object.values(t)),r}async function Ta(){await et.loadAssetPack("res.pack",(t,e)=>et.cache(e,t))}async function Ma(t,e="asset-port"){await et.loadAssetRefs(Object.values(t))}function Sa(t=document,e="display-port"){return t.querySelector(e)}function Ra(t=document,e="input-port"){return t.querySelector(e)}var k=1e-6,ie=typeof Float32Array!="undefined"?Float32Array:Array,zt=Math.random;var pu=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var pe={};ke(pe,{add:()=>co,adjoint:()=>Pa,clone:()=>La,copy:()=>Ca,create:()=>Ia,determinant:()=>Ua,equals:()=>vo,exactEquals:()=>po,frob:()=>uo,fromQuat:()=>to,fromQuat2:()=>Xa,fromRotation:()=>Va,fromRotationTranslation:()=>lr,fromRotationTranslationScale:()=>Ja,fromRotationTranslationScaleOrigin:()=>eo,fromScaling:()=>Ga,fromTranslation:()=>$a,fromValues:()=>Oa,fromXRotation:()=>Wa,fromYRotation:()=>ja,fromZRotation:()=>qa,frustum:()=>no,getRotation:()=>Qa,getScaling:()=>ur,getTranslation:()=>Za,identity:()=>ar,invert:()=>Da,lookAt:()=>ao,mul:()=>mo,multiply:()=>or,multiplyScalar:()=>fo,multiplyScalarAndAdd:()=>ho,ortho:()=>so,perspective:()=>ro,perspectiveFromFieldOfView:()=>io,rotate:()=>ka,rotateX:()=>za,rotateY:()=>Ka,rotateZ:()=>Ya,scale:()=>Ha,set:()=>Ba,str:()=>lo,sub:()=>_o,subtract:()=>cr,targetTo:()=>oo,translate:()=>Fa,transpose:()=>Na});function Ia(){var t=new ie(16);return ie!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function La(t){var e=new ie(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Ca(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Oa(t,e,n,r,i,s,a,o,l,u,c,f,h,d,v,_){var p=new ie(16);return p[0]=t,p[1]=e,p[2]=n,p[3]=r,p[4]=i,p[5]=s,p[6]=a,p[7]=o,p[8]=l,p[9]=u,p[10]=c,p[11]=f,p[12]=h,p[13]=d,p[14]=v,p[15]=_,p}function Ba(t,e,n,r,i,s,a,o,l,u,c,f,h,d,v,_,p){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=s,t[5]=a,t[6]=o,t[7]=l,t[8]=u,t[9]=c,t[10]=f,t[11]=h,t[12]=d,t[13]=v,t[14]=_,t[15]=p,t}function ar(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Na(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],s=e[6],a=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=a,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Da(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],u=e[7],c=e[8],f=e[9],h=e[10],d=e[11],v=e[12],_=e[13],p=e[14],x=e[15],I=n*o-r*a,g=n*l-i*a,T=n*u-s*a,b=r*l-i*o,R=r*u-s*o,N=i*u-s*l,y=c*_-f*v,C=c*p-h*v,P=c*x-d*v,A=f*p-h*_,B=f*x-d*_,O=h*x-d*p,D=I*O-g*B+T*A+b*P-R*C+N*y;return D?(D=1/D,t[0]=(o*O-l*B+u*A)*D,t[1]=(i*B-r*O-s*A)*D,t[2]=(_*N-p*R+x*b)*D,t[3]=(h*R-f*N-d*b)*D,t[4]=(l*P-a*O-u*C)*D,t[5]=(n*O-i*P+s*C)*D,t[6]=(p*T-v*N-x*g)*D,t[7]=(c*N-h*T+d*g)*D,t[8]=(a*B-o*P+u*y)*D,t[9]=(r*P-n*B-s*y)*D,t[10]=(v*R-_*T+x*I)*D,t[11]=(f*T-c*R-d*I)*D,t[12]=(o*C-a*A-l*y)*D,t[13]=(n*A-r*C+i*y)*D,t[14]=(_*g-v*b-p*I)*D,t[15]=(c*b-f*g+h*I)*D,t):null}function Pa(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],u=e[7],c=e[8],f=e[9],h=e[10],d=e[11],v=e[12],_=e[13],p=e[14],x=e[15];return t[0]=o*(h*x-d*p)-f*(l*x-u*p)+_*(l*d-u*h),t[1]=-(r*(h*x-d*p)-f*(i*x-s*p)+_*(i*d-s*h)),t[2]=r*(l*x-u*p)-o*(i*x-s*p)+_*(i*u-s*l),t[3]=-(r*(l*d-u*h)-o*(i*d-s*h)+f*(i*u-s*l)),t[4]=-(a*(h*x-d*p)-c*(l*x-u*p)+v*(l*d-u*h)),t[5]=n*(h*x-d*p)-c*(i*x-s*p)+v*(i*d-s*h),t[6]=-(n*(l*x-u*p)-a*(i*x-s*p)+v*(i*u-s*l)),t[7]=n*(l*d-u*h)-a*(i*d-s*h)+c*(i*u-s*l),t[8]=a*(f*x-d*_)-c*(o*x-u*_)+v*(o*d-u*f),t[9]=-(n*(f*x-d*_)-c*(r*x-s*_)+v*(r*d-s*f)),t[10]=n*(o*x-u*_)-a*(r*x-s*_)+v*(r*u-s*o),t[11]=-(n*(o*d-u*f)-a*(r*d-s*f)+c*(r*u-s*o)),t[12]=-(a*(f*p-h*_)-c*(o*p-l*_)+v*(o*h-l*f)),t[13]=n*(f*p-h*_)-c*(r*p-i*_)+v*(r*h-i*f),t[14]=-(n*(o*p-l*_)-a*(r*p-i*_)+v*(r*l-i*o)),t[15]=n*(o*h-l*f)-a*(r*h-i*f)+c*(r*l-i*o),t}function Ua(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],a=t[5],o=t[6],l=t[7],u=t[8],c=t[9],f=t[10],h=t[11],d=t[12],v=t[13],_=t[14],p=t[15],x=e*a-n*s,I=e*o-r*s,g=e*l-i*s,T=n*o-r*a,b=n*l-i*a,R=r*l-i*o,N=u*v-c*d,y=u*_-f*d,C=u*p-h*d,P=c*_-f*v,A=c*p-h*v,B=f*p-h*_;return x*B-I*A+g*P+T*C-b*y+R*N}function or(t,e,n){var r=e[0],i=e[1],s=e[2],a=e[3],o=e[4],l=e[5],u=e[6],c=e[7],f=e[8],h=e[9],d=e[10],v=e[11],_=e[12],p=e[13],x=e[14],I=e[15],g=n[0],T=n[1],b=n[2],R=n[3];return t[0]=g*r+T*o+b*f+R*_,t[1]=g*i+T*l+b*h+R*p,t[2]=g*s+T*u+b*d+R*x,t[3]=g*a+T*c+b*v+R*I,g=n[4],T=n[5],b=n[6],R=n[7],t[4]=g*r+T*o+b*f+R*_,t[5]=g*i+T*l+b*h+R*p,t[6]=g*s+T*u+b*d+R*x,t[7]=g*a+T*c+b*v+R*I,g=n[8],T=n[9],b=n[10],R=n[11],t[8]=g*r+T*o+b*f+R*_,t[9]=g*i+T*l+b*h+R*p,t[10]=g*s+T*u+b*d+R*x,t[11]=g*a+T*c+b*v+R*I,g=n[12],T=n[13],b=n[14],R=n[15],t[12]=g*r+T*o+b*f+R*_,t[13]=g*i+T*l+b*h+R*p,t[14]=g*s+T*u+b*d+R*x,t[15]=g*a+T*c+b*v+R*I,t}function Fa(t,e,n){var r=n[0],i=n[1],s=n[2],a,o,l,u,c,f,h,d,v,_,p,x;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*s+e[12],t[13]=e[1]*r+e[5]*i+e[9]*s+e[13],t[14]=e[2]*r+e[6]*i+e[10]*s+e[14],t[15]=e[3]*r+e[7]*i+e[11]*s+e[15]):(a=e[0],o=e[1],l=e[2],u=e[3],c=e[4],f=e[5],h=e[6],d=e[7],v=e[8],_=e[9],p=e[10],x=e[11],t[0]=a,t[1]=o,t[2]=l,t[3]=u,t[4]=c,t[5]=f,t[6]=h,t[7]=d,t[8]=v,t[9]=_,t[10]=p,t[11]=x,t[12]=a*r+c*i+v*s+e[12],t[13]=o*r+f*i+_*s+e[13],t[14]=l*r+h*i+p*s+e[14],t[15]=u*r+d*i+x*s+e[15]),t}function Ha(t,e,n){var r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function ka(t,e,n,r){var i=r[0],s=r[1],a=r[2],o=Math.hypot(i,s,a),l,u,c,f,h,d,v,_,p,x,I,g,T,b,R,N,y,C,P,A,B,O,D,m;return o<k?null:(o=1/o,i*=o,s*=o,a*=o,l=Math.sin(n),u=Math.cos(n),c=1-u,f=e[0],h=e[1],d=e[2],v=e[3],_=e[4],p=e[5],x=e[6],I=e[7],g=e[8],T=e[9],b=e[10],R=e[11],N=i*i*c+u,y=s*i*c+a*l,C=a*i*c-s*l,P=i*s*c-a*l,A=s*s*c+u,B=a*s*c+i*l,O=i*a*c+s*l,D=s*a*c-i*l,m=a*a*c+u,t[0]=f*N+_*y+g*C,t[1]=h*N+p*y+T*C,t[2]=d*N+x*y+b*C,t[3]=v*N+I*y+R*C,t[4]=f*P+_*A+g*B,t[5]=h*P+p*A+T*B,t[6]=d*P+x*A+b*B,t[7]=v*P+I*A+R*B,t[8]=f*O+_*D+g*m,t[9]=h*O+p*D+T*m,t[10]=d*O+x*D+b*m,t[11]=v*O+I*D+R*m,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function za(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[4],a=e[5],o=e[6],l=e[7],u=e[8],c=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+u*r,t[5]=a*i+c*r,t[6]=o*i+f*r,t[7]=l*i+h*r,t[8]=u*i-s*r,t[9]=c*i-a*r,t[10]=f*i-o*r,t[11]=h*i-l*r,t}function Ka(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],a=e[1],o=e[2],l=e[3],u=e[8],c=e[9],f=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-u*r,t[1]=a*i-c*r,t[2]=o*i-f*r,t[3]=l*i-h*r,t[8]=s*r+u*i,t[9]=a*r+c*i,t[10]=o*r+f*i,t[11]=l*r+h*i,t}function Ya(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],a=e[1],o=e[2],l=e[3],u=e[4],c=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+u*r,t[1]=a*i+c*r,t[2]=o*i+f*r,t[3]=l*i+h*r,t[4]=u*i-s*r,t[5]=c*i-a*r,t[6]=f*i-o*r,t[7]=h*i-l*r,t}function $a(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function Ga(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Va(t,e,n){var r=n[0],i=n[1],s=n[2],a=Math.hypot(r,i,s),o,l,u;return a<k?null:(a=1/a,r*=a,i*=a,s*=a,o=Math.sin(e),l=Math.cos(e),u=1-l,t[0]=r*r*u+l,t[1]=i*r*u+s*o,t[2]=s*r*u-i*o,t[3]=0,t[4]=r*i*u-s*o,t[5]=i*i*u+l,t[6]=s*i*u+r*o,t[7]=0,t[8]=r*s*u+i*o,t[9]=i*s*u-r*o,t[10]=s*s*u+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function Wa(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ja(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function qa(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function lr(t,e,n){var r=e[0],i=e[1],s=e[2],a=e[3],o=r+r,l=i+i,u=s+s,c=r*o,f=r*l,h=r*u,d=i*l,v=i*u,_=s*u,p=a*o,x=a*l,I=a*u;return t[0]=1-(d+_),t[1]=f+I,t[2]=h-x,t[3]=0,t[4]=f-I,t[5]=1-(c+_),t[6]=v+p,t[7]=0,t[8]=h+x,t[9]=v-p,t[10]=1-(c+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function Xa(t,e){var n=new ie(3),r=-e[0],i=-e[1],s=-e[2],a=e[3],o=e[4],l=e[5],u=e[6],c=e[7],f=r*r+i*i+s*s+a*a;return f>0?(n[0]=(o*a+c*r+l*s-u*i)*2/f,n[1]=(l*a+c*i+u*r-o*s)*2/f,n[2]=(u*a+c*s+o*i-l*r)*2/f):(n[0]=(o*a+c*r+l*s-u*i)*2,n[1]=(l*a+c*i+u*r-o*s)*2,n[2]=(u*a+c*s+o*i-l*r)*2),lr(t,e,n),t}function Za(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function ur(t,e){var n=e[0],r=e[1],i=e[2],s=e[4],a=e[5],o=e[6],l=e[8],u=e[9],c=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(s,a,o),t[2]=Math.hypot(l,u,c),t}function Qa(t,e){var n=new ie(3);ur(n,e);var r=1/n[0],i=1/n[1],s=1/n[2],a=e[0]*r,o=e[1]*i,l=e[2]*s,u=e[4]*r,c=e[5]*i,f=e[6]*s,h=e[8]*r,d=e[9]*i,v=e[10]*s,_=a+c+v,p=0;return _>0?(p=Math.sqrt(_+1)*2,t[3]=.25*p,t[0]=(f-d)/p,t[1]=(h-l)/p,t[2]=(o-u)/p):a>c&&a>v?(p=Math.sqrt(1+a-c-v)*2,t[3]=(f-d)/p,t[0]=.25*p,t[1]=(o+u)/p,t[2]=(h+l)/p):c>v?(p=Math.sqrt(1+c-a-v)*2,t[3]=(h-l)/p,t[0]=(o+u)/p,t[1]=.25*p,t[2]=(f+d)/p):(p=Math.sqrt(1+v-a-c)*2,t[3]=(o-u)/p,t[0]=(h+l)/p,t[1]=(f+d)/p,t[2]=.25*p),t}function Ja(t,e,n,r){var i=e[0],s=e[1],a=e[2],o=e[3],l=i+i,u=s+s,c=a+a,f=i*l,h=i*u,d=i*c,v=s*u,_=s*c,p=a*c,x=o*l,I=o*u,g=o*c,T=r[0],b=r[1],R=r[2];return t[0]=(1-(v+p))*T,t[1]=(h+g)*T,t[2]=(d-I)*T,t[3]=0,t[4]=(h-g)*b,t[5]=(1-(f+p))*b,t[6]=(_+x)*b,t[7]=0,t[8]=(d+I)*R,t[9]=(_-x)*R,t[10]=(1-(f+v))*R,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function eo(t,e,n,r,i){var s=e[0],a=e[1],o=e[2],l=e[3],u=s+s,c=a+a,f=o+o,h=s*u,d=s*c,v=s*f,_=a*c,p=a*f,x=o*f,I=l*u,g=l*c,T=l*f,b=r[0],R=r[1],N=r[2],y=i[0],C=i[1],P=i[2],A=(1-(_+x))*b,B=(d+T)*b,O=(v-g)*b,D=(d-T)*R,m=(1-(h+x))*R,E=(p+I)*R,$=(v+g)*N,H=(p-I)*N,q=(1-(h+_))*N;return t[0]=A,t[1]=B,t[2]=O,t[3]=0,t[4]=D,t[5]=m,t[6]=E,t[7]=0,t[8]=$,t[9]=H,t[10]=q,t[11]=0,t[12]=n[0]+y-(A*y+D*C+$*P),t[13]=n[1]+C-(B*y+m*C+H*P),t[14]=n[2]+P-(O*y+E*C+q*P),t[15]=1,t}function to(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],a=n+n,o=r+r,l=i+i,u=n*a,c=r*a,f=r*o,h=i*a,d=i*o,v=i*l,_=s*a,p=s*o,x=s*l;return t[0]=1-f-v,t[1]=c+x,t[2]=h-p,t[3]=0,t[4]=c-x,t[5]=1-u-v,t[6]=d+_,t[7]=0,t[8]=h+p,t[9]=d-_,t[10]=1-u-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function no(t,e,n,r,i,s,a){var o=1/(n-e),l=1/(i-r),u=1/(s-a);return t[0]=s*2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*l,t[6]=0,t[7]=0,t[8]=(n+e)*o,t[9]=(i+r)*l,t[10]=(a+s)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*s*2*u,t[15]=0,t}function ro(t,e,n,r,i){var s=1/Math.tan(e/2),a;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==Infinity?(a=1/(r-i),t[10]=(i+r)*a,t[14]=2*i*r*a):(t[10]=-1,t[14]=-2*r),t}function io(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),s=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),o=Math.tan(e.rightDegrees*Math.PI/180),l=2/(a+o),u=2/(i+s);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-((a-o)*l*.5),t[9]=(i-s)*u*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function so(t,e,n,r,i,s,a){var o=1/(e-n),l=1/(r-i),u=1/(s-a);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*o,t[13]=(i+r)*l,t[14]=(a+s)*u,t[15]=1,t}function ao(t,e,n,r){var i,s,a,o,l,u,c,f,h,d,v=e[0],_=e[1],p=e[2],x=r[0],I=r[1],g=r[2],T=n[0],b=n[1],R=n[2];return Math.abs(v-T)<k&&Math.abs(_-b)<k&&Math.abs(p-R)<k?ar(t):(c=v-T,f=_-b,h=p-R,d=1/Math.hypot(c,f,h),c*=d,f*=d,h*=d,i=I*h-g*f,s=g*c-x*h,a=x*f-I*c,d=Math.hypot(i,s,a),d?(d=1/d,i*=d,s*=d,a*=d):(i=0,s=0,a=0),o=f*a-h*s,l=h*i-c*a,u=c*s-f*i,d=Math.hypot(o,l,u),d?(d=1/d,o*=d,l*=d,u*=d):(o=0,l=0,u=0),t[0]=i,t[1]=o,t[2]=c,t[3]=0,t[4]=s,t[5]=l,t[6]=f,t[7]=0,t[8]=a,t[9]=u,t[10]=h,t[11]=0,t[12]=-(i*v+s*_+a*p),t[13]=-(o*v+l*_+u*p),t[14]=-(c*v+f*_+h*p),t[15]=1,t)}function oo(t,e,n,r){var i=e[0],s=e[1],a=e[2],o=r[0],l=r[1],u=r[2],c=i-n[0],f=s-n[1],h=a-n[2],d=c*c+f*f+h*h;d>0&&(d=1/Math.sqrt(d),c*=d,f*=d,h*=d);var v=l*h-u*f,_=u*c-o*h,p=o*f-l*c;return d=v*v+_*_+p*p,d>0&&(d=1/Math.sqrt(d),v*=d,_*=d,p*=d),t[0]=v,t[1]=_,t[2]=p,t[3]=0,t[4]=f*p-h*_,t[5]=h*v-c*p,t[6]=c*_-f*v,t[7]=0,t[8]=c,t[9]=f,t[10]=h,t[11]=0,t[12]=i,t[13]=s,t[14]=a,t[15]=1,t}function lo(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function uo(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function co(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function cr(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function fo(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function ho(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function po(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function vo(t,e){var n=t[0],r=t[1],i=t[2],s=t[3],a=t[4],o=t[5],l=t[6],u=t[7],c=t[8],f=t[9],h=t[10],d=t[11],v=t[12],_=t[13],p=t[14],x=t[15],I=e[0],g=e[1],T=e[2],b=e[3],R=e[4],N=e[5],y=e[6],C=e[7],P=e[8],A=e[9],B=e[10],O=e[11],D=e[12],m=e[13],E=e[14],$=e[15];return Math.abs(n-I)<=k*Math.max(1,Math.abs(n),Math.abs(I))&&Math.abs(r-g)<=k*Math.max(1,Math.abs(r),Math.abs(g))&&Math.abs(i-T)<=k*Math.max(1,Math.abs(i),Math.abs(T))&&Math.abs(s-b)<=k*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(a-R)<=k*Math.max(1,Math.abs(a),Math.abs(R))&&Math.abs(o-N)<=k*Math.max(1,Math.abs(o),Math.abs(N))&&Math.abs(l-y)<=k*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(u-C)<=k*Math.max(1,Math.abs(u),Math.abs(C))&&Math.abs(c-P)<=k*Math.max(1,Math.abs(c),Math.abs(P))&&Math.abs(f-A)<=k*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(h-B)<=k*Math.max(1,Math.abs(h),Math.abs(B))&&Math.abs(d-O)<=k*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(v-D)<=k*Math.max(1,Math.abs(v),Math.abs(D))&&Math.abs(_-m)<=k*Math.max(1,Math.abs(_),Math.abs(m))&&Math.abs(p-E)<=k*Math.max(1,Math.abs(p),Math.abs(E))&&Math.abs(x-$)<=k*Math.max(1,Math.abs(x),Math.abs($))}var mo=or,_o=cr;var Y={};ke(Y,{add:()=>go,angle:()=>$o,bezier:()=>Po,ceil:()=>wo,clone:()=>Eo,copy:()=>xo,create:()=>fr,cross:()=>Bo,dist:()=>Qo,distance:()=>mr,div:()=>Zo,divide:()=>vr,dot:()=>Ar,equals:()=>jo,exactEquals:()=>Wo,floor:()=>bo,forEach:()=>nl,fromValues:()=>Ao,hermite:()=>Do,inverse:()=>Co,len:()=>el,length:()=>hr,lerp:()=>No,max:()=>Mo,min:()=>To,mul:()=>Xo,multiply:()=>dr,negate:()=>Lo,normalize:()=>Oo,random:()=>Uo,rotateX:()=>zo,rotateY:()=>Ko,rotateZ:()=>Yo,round:()=>So,scale:()=>Ro,scaleAndAdd:()=>Io,set:()=>yo,sqrDist:()=>Jo,sqrLen:()=>tl,squaredDistance:()=>_r,squaredLength:()=>Er,str:()=>Vo,sub:()=>qo,subtract:()=>pr,transformMat3:()=>Ho,transformMat4:()=>Fo,transformQuat:()=>ko,zero:()=>Go});function fr(){var t=new ie(3);return ie!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Eo(t){var e=new ie(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function hr(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function Ao(t,e,n){var r=new ie(3);return r[0]=t,r[1]=e,r[2]=n,r}function xo(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function yo(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function go(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function pr(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function dr(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function vr(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function wo(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function bo(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function To(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function Mo(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function So(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function Ro(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function Io(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function mr(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,r,i)}function _r(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function Er(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function Lo(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Co(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function Oo(t,e){var n=e[0],r=e[1],i=e[2],s=n*n+r*r+i*i;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function Ar(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Bo(t,e,n){var r=e[0],i=e[1],s=e[2],a=n[0],o=n[1],l=n[2];return t[0]=i*l-s*o,t[1]=s*a-r*l,t[2]=r*o-i*a,t}function No(t,e,n,r){var i=e[0],s=e[1],a=e[2];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=a+r*(n[2]-a),t}function Do(t,e,n,r,i,s){var a=s*s,o=a*(2*s-3)+1,l=a*(s-2)+s,u=a*(s-1),c=a*(3-2*s);return t[0]=e[0]*o+n[0]*l+r[0]*u+i[0]*c,t[1]=e[1]*o+n[1]*l+r[1]*u+i[1]*c,t[2]=e[2]*o+n[2]*l+r[2]*u+i[2]*c,t}function Po(t,e,n,r,i,s){var a=1-s,o=a*a,l=s*s,u=o*a,c=3*s*o,f=3*l*a,h=l*s;return t[0]=e[0]*u+n[0]*c+r[0]*f+i[0]*h,t[1]=e[1]*u+n[1]*c+r[1]*f+i[1]*h,t[2]=e[2]*u+n[2]*c+r[2]*f+i[2]*h,t}function Uo(t,e){e=e||1;var n=zt()*2*Math.PI,r=zt()*2-1,i=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=r*e,t}function Fo(t,e,n){var r=e[0],i=e[1],s=e[2],a=n[3]*r+n[7]*i+n[11]*s+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/a,t}function Ho(t,e,n){var r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function ko(t,e,n){var r=n[0],i=n[1],s=n[2],a=n[3],o=e[0],l=e[1],u=e[2],c=i*u-s*l,f=s*o-r*u,h=r*l-i*o,d=i*h-s*f,v=s*c-r*h,_=r*f-i*c,p=a*2;return c*=p,f*=p,h*=p,d*=2,v*=2,_*=2,t[0]=o+c+d,t[1]=l+f+v,t[2]=u+h+_,t}function zo(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function Ko(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function Yo(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function $o(t,e){var n=t[0],r=t[1],i=t[2],s=e[0],a=e[1],o=e[2],l=Math.sqrt(n*n+r*r+i*i),u=Math.sqrt(s*s+a*a+o*o),c=l*u,f=c&&Ar(t,e)/c;return Math.acos(Math.min(Math.max(f,-1),1))}function Go(t){return t[0]=0,t[1]=0,t[2]=0,t}function Vo(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Wo(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function jo(t,e){var n=t[0],r=t[1],i=t[2],s=e[0],a=e[1],o=e[2];return Math.abs(n-s)<=k*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-a)<=k*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-o)<=k*Math.max(1,Math.abs(i),Math.abs(o))}var qo=pr,Xo=dr,Zo=vr,Qo=mr,Jo=_r,el=hr,tl=Er,nl=function(){var t=fr();return function(e,n,r,i,s,a){var o,l;for(n||(n=3),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,o=r;o<l;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],s(t,t,a),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}}();var yu=Y.fromValues(0,1,0);var xr=class{constructor(e,n){this.projectionMatrix=e,this.viewMatrix=n}resize(e=void 0,n=void 0){return this}},rl=Math.PI/3,Kt=class extends xr{constructor(e=rl,n=.1,r=1e3){super(pe.create(),pe.create());this.fieldOfView=Number(e),this.clippingPlane={near:Number(n),far:Number(r)}}resize(e=void 0,n=void 0){let r=typeof e=="undefined"?1:e/n,{near:i,far:s}=this.clippingPlane;return pe.perspective(this.projectionMatrix,this.fieldOfView,r,i,s),this}};var yr=Math.PI/180,Yt=class{constructor(e={locky:!1}){this.locky=e.locky,this.position=Y.create(),this.forward=Y.fromValues(0,0,-1),this.right=Y.fromValues(1,0,0),this.up=Y.fromValues(0,1,0),this.forwardAmount=0,this.rightAmount=0,this.upAmount=0,this.pitch=0,this.yaw=-90}look(e,n,r=1){return r*=1e3,this.pitch=Math.min(89.9,Math.max(-89.9,this.pitch+n*r)),this.yaw=(this.yaw+e*r)%360,this}move(e,n=0,r=0,i=1){return this.forwardAmount+=e*i,this.rightAmount+=n*i,this.upAmount+=r*i,this}apply(e){let{position:n,forward:r,right:i,up:s,forwardAmount:a,rightAmount:o,upAmount:l,pitch:u,yaw:c}=this,f=c*yr,h=u*yr,d=Math.cos(f),v=Math.cos(h),_=Math.sin(f),p=Math.sin(h),x=d*v,I=p,g=_*v;Y.normalize(r,Y.set(r,x,this.locky?0:I,g)),Y.normalize(i,Y.cross(i,r,s));let T=Y.create();Y.scale(T,r,a),Y.add(n,n,T),Y.scale(T,i,o),Y.add(n,n,T),Y.scale(T,s,l),Y.add(n,n,T),this.forwardAmount=0,this.rightAmount=0,this.upAmount=0,this.locky&&Y.set(r,x,I,g);let b=Y.add(T,n,r);return pe.lookAt(e,n,b,s),e}};function be(t){return typeof WebGL2RenderingContext!="undefined"&&t instanceof WebGL2RenderingContext}var gr=class{constructor(e,n){this.gl=e,this.target=n}data(e,n=void 0){let r=this.gl,i=this.target;if(typeof e=="number")r.bufferData(i,e,n||r.STATIC_DRAW);else{if(!ArrayBuffer.isView(e))throw new Error("Source data must be a typed array.");r.bufferData(i,e,n||r.STATIC_DRAW)}return this}subData(e,n=0,r=void 0,i=void 0){let s=this.gl,a=this.target;if(ArrayBuffer.isView(e))if(typeof r!="undefined")if(be(s))s.bufferSubData(a,n,e,r,i);else{let o=i?e.subarray(r,r+i):e.subarray(r);s.bufferSubData(a,n,o)}else s.bufferSubData(a,n,e);else throw new Error("Source data must be a typed array.");return this}};var nt=class{constructor(e,n,r,i){this.gl=e,this.target=n,this.handle=i,this.type=r,this.bindContext=new gr(e,this.target)}bind(e){return e.bindBuffer(this.target,this.handle),this.bindContext.gl=e,this.bindContext}},Ae={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,HALF_FLOAT:5131};function il(t,e){let n=[],r=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let i=0;i<r;++i){let s=t.getActiveUniform(e,i);if(!s)break;n.push(s)}return n}function sl(t,e){let n=[],r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let i=0;i<r;++i){let s=t.getActiveAttrib(e,i);!s||n.push(s)}return n}function $t(t,e){switch(e){case t.FLOAT:case t.INT:case t.UNSIGNED_INT:case t.BOOL:return 1;case t.FLOAT_VEC2:case t.INT_VEC2:case t.BOOL_VEC2:return 2;case t.FLOAT_VEC3:case t.INT_VEC3:case t.BOOL_VEC3:return 3;case t.FLOAT_VEC4:case t.INT_VEC4:case t.BOOL_VEC4:return 4;case t.FLOAT_MAT2:return 4;case t.FLOAT_MAT3:return 9;case t.FLOAT_MAT4:return 16;default:throw new Error("Invalid vertex attribute type.")}}function hl(t,e){switch(e){case t.FLOAT:case t.FLOAT_VEC2:case t.FLOAT_VEC3:case t.FLOAT_VEC4:return al}if(be(t)){let n=t;switch(e){case t.INT:case t.INT_VEC2:case t.INT_VEC3:case t.INT_VEC4:case t.BOOL:case t.BOOL_VEC2:case t.BOOL_VEC3:case t.BOOL_VEC4:return ol;case t.FLOAT_MAT2:return ul;case t.FLOAT_MAT3:return cl;case t.FLOAT_MAT4:return fl;case n.UNSIGNED_INT:case n.UNSIGNED_INT_VEC2:case n.UNSIGNED_INT_VEC3:case n.UNSIGNED_INT_VEC4:return ll}}throw new Error("Cannot find attribute function for gl enum.")}function al(t,e,n,r,i=!1,s=0,a=0,o=void 0){if(this.bindBuffer(this.ARRAY_BUFFER,e),this.enableVertexAttribArray(t),this.vertexAttribPointer(t,n,r,i,s,a),o!==void 0){if(!be(this))throw new Error("Cannot use attribute divisor in WebGL 1.");this.vertexAttribDivisor(t,o)}}function ol(t,e,n,r,i=!1,s=0,a=0,o=void 0){if(!be(this))throw new Error("Cannot use attribute divisor in WebGL 1.");let l=this;l.bindBuffer(l.ARRAY_BUFFER,e),l.enableVertexAttribArray(t),l.vertexAttribIPointer(t,n,r,s,a),o!==void 0&&l.vertexAttribDivisor(t,o)}function ll(t,e,n,r,i=!1,s=0,a=0,o=void 0){if(!be(this))throw new Error("Cannot use attribute divisor in WebGL 1.");let l=this;l.bindBuffer(l.ARRAY_BUFFER,e),l.enableVertexAttribArray(t),l.vertexAttribIPointer(t,n,r,s,a),o!==void 0&&l.vertexAttribDivisor(t,o)}function ul(t,e,n,r,i=!1,s=0,a=0,o=void 0){let l=$t(this,this.FLOAT_MAT2),u=l*l;Gt(u,l,t,e,n,r,i,s,a,o)}function cl(t,e,n,r,i=!1,s=0,a=0,o=void 0){let l=$t(this,this.FLOAT_MAT3),u=l*l;Gt(u,l,t,e,n,r,i,s,a,o)}function fl(t,e,n,r,i=!1,s=0,a=0,o=void 0){let l=$t(this,this.FLOAT_MAT4),u=l*l;Gt(u,l,t,e,n,r,i,s,a,o)}function Gt(t,e,n,r,i,s,a,o,l,u){if(!be(this))throw new Error("Cannot use attribute divisor in WebGL 1.");let c=this;c.bindBuffer(c.ARRAY_BUFFER,r);let f=i/e,h=t*i,d=o/e;for(let v=0;v<e;++v){let _=n+v;c.enableVertexAttribArray(_),c.vertexAttribPointer(_,f,s,a,h,l+d*v),u!==void 0&&c.vertexAttribDivisor(_,u)}}function pl(t,e){let n={},r=sl(t,e);for(let i of r){let s=i.name,a=i.size,o=i.type,l=t.getAttribLocation(e,s),u=hl(t,o);n[s]={type:o,size:a,location:l,applier:u,set value([c,f,h,d,v,_,p]){this.applier(this.location,c,f,h,d,v,_,p)}}}return n}function dl(t,e,n,r,i=void 0){i?(t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i),t.drawElements(e,r,t.UNSIGNED_SHORT,n)):t.drawArrays(e,n,r)}function bl(t,e){let n=t;switch(e){case n.FLOAT:return n.uniform1f;case n.FLOAT_VEC2:return n.uniform2fv;case n.FLOAT_VEC3:return n.uniform3fv;case n.FLOAT_VEC4:return n.uniform4fv;case n.INT:return n.uniform1i;case n.INT_VEC2:return n.uniform2iv;case n.INT_VEC3:return n.uniform3iv;case n.INT_VEC4:return n.uniform4iv;case n.BOOL:return n.uniform1i;case n.BOOL_VEC2:return n.uniform2iv;case n.BOOL_VEC3:return n.uniform3iv;case n.BOOL_VEC4:return n.uniform4iv;case n.FLOAT_MAT2:return vl;case n.FLOAT_MAT3:return ml;case n.FLOAT_MAT4:return _l;case n.SAMPLER_2D:case n.SAMPLER_CUBE:return n.uniform1i}if(be(t)){let r=t;switch(e){case r.UNSIGNED_INT:return r.uniform1ui;case r.UNSIGNED_INT_VEC2:return r.uniform2uiv;case r.UNSIGNED_INT_VEC3:return r.uniform3uiv;case r.UNSIGNED_INT_VEC4:return r.uniform4uiv;case r.FLOAT_MAT2x3:return El;case r.FLOAT_MAT2x4:return Al;case r.FLOAT_MAT3x2:return xl;case r.FLOAT_MAT3x4:return yl;case r.FLOAT_MAT4x2:return gl;case r.FLOAT_MAT4x3:return wl;case r.SAMPLER_3D:case r.SAMPLER_2D_SHADOW:case r.SAMPLER_2D_ARRAY:case r.SAMPLER_2D_ARRAY_SHADOW:case r.SAMPLER_CUBE_SHADOW:case r.INT_SAMPLER_2D:case r.INT_SAMPLER_3D:case r.INT_SAMPLER_CUBE:case r.INT_SAMPLER_2D_ARRAY:case r.UNSIGNED_INT_SAMPLER_2D:case r.UNSIGNED_INT_SAMPLER_3D:case r.UNSIGNED_INT_SAMPLER_CUBE:case r.UNSIGNED_INT_SAMPLER_2D_ARRAY:return r.uniform1i}}throw new Error("Cannot find uniform function for gl enum.")}function vl(t,e){this.uniformMatrix2fv(t,!1,e)}function ml(t,e){this.uniformMatrix3fv(t,!1,e)}function _l(t,e){this.uniformMatrix4fv(t,!1,e)}function El(t,e){this.uniformMatrix2x3fv(t,!1,e)}function Al(t,e){this.uniformMatrix2x4fv(t,!1,e)}function xl(t,e){this.uniformMatrix3x2fv(t,!1,e)}function yl(t,e){this.uniformMatrix3x4fv(t,!1,e)}function gl(t,e){this.uniformMatrix4x2fv(t,!1,e)}function wl(t,e){this.uniformMatrix4x3fv(t,!1,e)}function Tl(t,e){let n={},r=il(t,e);for(let i of r){let s=i.name,a=i.size,o=i.type,l=t.getUniformLocation(e,s),u=bl(t,o);n[s]={type:o,size:a,location:l,applier:u,set value(c){this.applier.call(t,this.location,c)}}}return n}var wu={[Ae.BYTE]:1,[Ae.UNSIGNED_BYTE]:1,[Ae.SHORT]:2,[Ae.UNSIGNED_SHORT]:2,[Ae.INT]:4,[Ae.UNSIGNED_INT]:4,[Ae.FLOAT]:4,[Ae.HALF_FLOAT]:2};var Ie=class{constructor(e,n){this.handle=n,this.activeUniforms=Tl(e,n),this.activeAttributes=pl(e,n),this.drawContext=new wr(e,this)}bind(e){return e.useProgram(this.handle),this.drawContext.gl=e,this.drawContext}},wr=class{constructor(e,n){this.gl=e,this.parent=n}uniform(e,n){let r=this.parent.activeUniforms;if(e in r){let i=r[e],s=i.location;i.applier.call(this.gl,s,n)}return this}attribute(e,n,r,i=!1,s=0,a=0){let o=this.gl,l=this.parent.activeAttributes;if(e in l){let u=l[e],c=u.location,f=u.size;r?(o.bindBuffer(o.ARRAY_BUFFER,r),o.vertexAttribPointer(c,f,n,i,s,a),o.enableVertexAttribArray(c)):o.disableVertexAttribArray(c)}return this}draw(e,n,r,i,s=null){return dl(e,n,r,i,s),this.parent}};var br=`#version 300 es

in vec3 a_position;
in vec2 a_texcoord;
in vec3 a_normal;

out vec2 v_texcoord;

uniform mat4 u_model;
uniform mat4 u_view;
uniform mat4 u_projection;

void main() {
    gl_Position = u_projection * u_view * u_model * vec4(a_position, 1.0);
    v_texcoord = a_texcoord;
}
`,Tr=`#version 300 es

precision highp float;

in vec2 v_texcoord;

out vec4 out_FragColor;

uniform vec4 u_color;

void main() {
    out_FragColor = u_color;
}
`;function Sr(t,e=1,n=1,r=1,i=8,s=1,a=!1,o=0,l=Math.PI*2){return Ml(t,e,n,r,i,s,o,l),a||(e>0&&Mr(t,!0,e,n,r,i,o,l),n>0&&Mr(t,!1,e,n,r,i,o,l)),t}function Ml(t,e,n,r,i,s,a,o){let l=r/2,u=(n-e)/r,c=[],f=Y.create();for(let h=0;h<=s;++h){let d=[],v=h/s,_=v*(n-e)+e;for(let p=0;p<=i;++p){let x=p/i,I=x*o+a,g=Math.sin(I),T=Math.cos(I);f[0]=_*g,f[1]=-v*r+l,f[2]=_*T,t.position.push(f[0],f[1],f[2]),f[0]=g,f[1]=u,f[2]=T,Y.normalize(f,f),t.normal.push(f[0],f[1],f[2]),f[0]=x,f[1]=1-v,t.texcoord.push(v[0],v[1]);let b=++t.vertexCount;d.push(b)}c.push(d)}for(let h=0;h<i;++h)for(let d=0;d<s;++d){let v=c[d][h],_=c[d+1][h],p=c[d+1][h+1],x=c[d][h+1];t.indices.push(v,_,x),t.indices.push(_,p,x)}return t}function Mr(t,e,n,r,i,s,a,o){let l=i/2,u=e?1:-1,c=e?n:r,f=t.vertexCount;for(let v=1;v<=s;++v)t.position.push(0,l*u,0),t.normal.push(0,u,0),t.texcoord.push(.5,.5),++t.vertexCount;let h=Y.create(),d=t.vertexCount;for(let v=0;v<=s;++v){let p=v/s*o+a,x=Math.cos(p),I=Math.sin(p);h[0]=c*I,h[1]=l*u,h[2]=c*x,t.position.push(h[0],h[1],h[2]),t.normal.push(0,u,0),h[0]=x*.5+.5,h[1]=I*.5*u+.5,t.texcoord.push(h[0],h[1]),++t.vertexCount}for(let v=0;v<s;++v){let _=f+v,p=d+v;e?t.indices.push(p,p+1,_):t.indices.push(p+1,p,_)}return t}var Vt=class{constructor(...e){this.systems=e,this.callbacks=[]}async load(e){for(let n of this.systems){let r=await n(e);this.callbacks.push(r)}return this}update(e){for(let n of this.systems)n(e);return this}};function Wt(t,e){let n=t.components;if(e in n)return n[e];{let r={};return n[e]=r,r}}function Sl(t,e,n){let r=n.name,i=Wt(t,r),s=n.new();return i[e]=s,s}function Rl(t,e,n){let r=n.name,i=Wt(t,r),s=i[e];return delete i[e],s}var Rr=Symbol("nextAvailableEntityId");function Il(t){return++t[Rr]}var jt=class{constructor(){this.components={},this[Rr]=1,this.queue=[]}flush(){for(;this.queue.length>0;){let[e,...n]=this.queue.shift();switch(e){case"attach":{let[r,i]=n;this.attachImmediately(r,i)}break;case"detach":{let[r,i]=n;this.detachImmediately(r,i)}break}}}create(...e){let n=Il(this);for(let r of e)this.attach(n,r);return n}delete(e){for(let n of Object.values(this.components))e in n&&delete n[e]}attach(e,n){this.queue.push(["attach",e,n])}attachImmediately(e,n){return Sl(this,e,n)}detach(e,n){this.queue.push(["detach",e,n])}detachImmediately(e,n){return Rl(this,e,n)}get(e,n){let r=n.name,i=Wt(this,r);return i?null:i[e]||null}};var qt=class{constructor(e=0,n=[],r=[],i=[],s=[]){this.vertexCount=e,this.indices=n,this.position=r,this.texcoord=i,this.normal=s}};window.addEventListener("DOMContentLoaded",Ll);async function Ll(){await Ee.connectInputs(he),await Ee.preloadAssetPack(),await Ee.preloadAssets(sr);let t={deltaTime:0,now:0,systemManager:new Vt,entityManager:new jt};await Cl(t)}async function Cl(t){let e=Ee.getDisplayPort(),n=Ee.getInputPort(),r=t.entityManager,i=t.systemManager,s=n.getContext("axisbutton"),a=e.canvas.getContext("webgl2"),o=new Kt,l=new Yt;e.canvas.addEventListener("click",()=>{e.focus(),e.canvas.requestPointerLock()});let u=Nl(Sr(new qt,.5,1,10),Bl([br,Tr],{u_color:[1,0,.5,1],u_model:pe.create(),u_view:o.viewMatrix,u_projection:o.projectionMatrix})),c={};e.addEventListener("frame",f=>{let{deltaTime:h,now:d}=f.detail,v=h/60;s.poll(d),o.resize(e.width,e.height),Ol(v,l),l.apply(o.viewMatrix);let _=u.uniforms.u_model;pe.rotateX(_,_,.01),Dl(c,a,e,[u])})}function Ol(t,e){let n=he.MoveForward.value-he.MoveBackward.value,r=he.MoveRight.value-he.MoveLeft.value,i=he.MoveDown.value-he.MoveUp.value;e.move(n,r,i,t);let s=he.CursorX.delta,a=-he.CursorY.delta;e.look(s,a,t)}function Bl(t,e){return{shaders:t,uniforms:e}}function Nl(t,e){return{geometry:t,material:e}}function Ir(t,e,n=()=>null){if(e in t)return t[e];{let r=n();return t[e]=r,r}}function Pl(t,e,n){let r=Ir(t,"bufferInfos",()=>new Map);if(r.has(n))return r.get(n);{let i=nt.createBufferInfo(e,{a_position:{buffer:n.position},a_texcoord:{buffer:n.texcoord,size:2},a_normal:{buffer:n.normal}},{buffer:n.indices});return r.set(n,i),i}}function Ul(t,e,n){let r=Ir(t,"bufferInfos",()=>new Map);if(r.has(n))return r.get(n);{let i=e.createProgram();Ie.linkProgramShaders(e,i,n.shaders);let s=Ie.createProgramInfo(e,i);return r.set(n,s),s}}function Fl(t,e,n,r){let i=Pl(t,e,n),s=Ul(t,e,r);return{bufferInfo:i,programInfo:s,uniforms:{...r.uniforms}}}function Hl(t,e,n){return n&&n.geometry&&n.material?Fl(t,n.geometry,n.material):null}function Dl(t,e,n,r=[]){e.viewport(0,0,n.width,n.height),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT);for(let i of r.map(s=>Hl(t,e,s))){if(!i)continue;let{programInfo:s,bufferInfo:a,uniforms:o}=i;e.useProgram(s.handle),Ie.bindProgramAttributes(e,s,a),Ie.bindProgramUniforms(e,s,o),nt.drawBufferInfo(e,a)}}})();
//# sourceMappingURL=main.js.map
