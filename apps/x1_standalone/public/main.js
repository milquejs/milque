(()=>{var Mr=Object.create,He=Object.defineProperty,Sr=Object.getPrototypeOf,Rr=Object.prototype.hasOwnProperty,Lr=Object.getOwnPropertyNames,Ir=Object.getOwnPropertyDescriptor;var Cr=e=>He(e,"__esModule",{value:!0});var Or=(e,t)=>()=>(e&&(t=e(e=0)),t),ge=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),ke=(e,t)=>{for(var n in t)He(e,n,{get:t[n],enumerable:!0})},Br=(e,t,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of Lr(t))!Rr.call(e,r)&&r!=="default"&&He(e,r,{get:()=>t[r],enumerable:!(n=Ir(t,r))||n.enumerable});return e},Nr=e=>Br(Cr(He(e!=null?Mr(Sr(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var ln={};ke(ln,{basename:()=>vn,default:()=>hs,delimiter:()=>pn,dirname:()=>dn,extname:()=>mn,isAbsolute:()=>At,join:()=>cn,normalize:()=>xt,relative:()=>fn,resolve:()=>Ke,sep:()=>hn});function un(e,t){for(var n=0,r=e.length-1;r>=0;r--){var i=e[r];i==="."?e.splice(r,1):i===".."?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function Ke(){for(var e="",t=!1,n=arguments.length-1;n>=-1&&!t;n--){var r=n>=0?arguments[n]:"/";if(typeof r!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!r)continue;e=r+"/"+e,t=r.charAt(0)==="/"}return e=un(Et(e.split("/"),function(i){return!!i}),!t).join("/"),(t?"/":"")+e||"."}function xt(e){var t=At(e),n=fs(e,-1)==="/";return e=un(Et(e.split("/"),function(r){return!!r}),!t).join("/"),!e&&!t&&(e="."),e&&n&&(e+="/"),(t?"/":"")+e}function At(e){return e.charAt(0)==="/"}function cn(){var e=Array.prototype.slice.call(arguments,0);return xt(Et(e,function(t,n){if(typeof t!="string")throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))}function fn(e,t){e=Ke(e).substr(1),t=Ke(t).substr(1);function n(u){for(var c=0;c<u.length&&u[c]==="";c++);for(var f=u.length-1;f>=0&&u[f]==="";f--);return c>f?[]:u.slice(c,f-c+1)}for(var r=n(e.split("/")),i=n(t.split("/")),s=Math.min(r.length,i.length),a=s,l=0;l<s;l++)if(r[l]!==i[l]){a=l;break}for(var o=[],l=a;l<r.length;l++)o.push("..");return o=o.concat(i.slice(a)),o.join("/")}function dn(e){var t=_t(e),n=t[0],r=t[1];return!n&&!r?".":(r&&(r=r.substr(0,r.length-1)),n+r)}function vn(e,t){var n=_t(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n}function mn(e){return _t(e)[3]}function Et(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}var cs,_t,hn,pn,hs,fs,_n=Or(()=>{cs=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,_t=function(e){return cs.exec(e).slice(1)};hn="/",pn=":";hs={extname:mn,basename:vn,dirname:dn,sep:hn,delimiter:pn,relative:fn,join:cn,isAbsolute:At,normalize:xt,resolve:Ke};fs="ab".substr(-1)==="b"?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}});var Ge=ge((Gl,Ye)=>{var Ee=(_n(),ln);Ee&&Ee.default?Ye.exports=Ee.default:Ee&&(Ye.exports=Ee);if(Ee)for(let e in Ee)Ye.exports[e]=Ee[e]});var Ce=ge(($l,En)=>{"use strict";var ps=Ge(),ce="\\\\/",An=`[^${ce}]`,ve="\\.",ds="\\+",vs="\\?",$e="\\/",ms="(?=.)",xn="[^/]",yt=`(?:${$e}|$)`,yn=`(?:^|${$e})`,gt=`${ve}{1,2}${yt}`,_s=`(?!${ve})`,Es=`(?!${yn}${gt})`,As=`(?!${ve}{0,1}${yt})`,xs=`(?!${gt})`,ys=`[^.${$e}]`,gs=`${xn}*?`,gn={DOT_LITERAL:ve,PLUS_LITERAL:ds,QMARK_LITERAL:vs,SLASH_LITERAL:$e,ONE_CHAR:ms,QMARK:xn,END_ANCHOR:yt,DOTS_SLASH:gt,NO_DOT:_s,NO_DOTS:Es,NO_DOT_SLASH:As,NO_DOTS_SLASH:xs,QMARK_NO_DOT:ys,STAR:gs,START_ANCHOR:yn},ws={...gn,SLASH_LITERAL:`[${ce}]`,QMARK:An,STAR:`${An}*?`,DOTS_SLASH:`${ve}{1,2}(?:[${ce}]|$)`,NO_DOT:`(?!${ve})`,NO_DOTS:`(?!(?:^|[${ce}])${ve}{1,2}(?:[${ce}]|$))`,NO_DOT_SLASH:`(?!${ve}{0,1}(?:[${ce}]|$))`,NO_DOTS_SLASH:`(?!${ve}{1,2}(?:[${ce}]|$))`,QMARK_NO_DOT:`[^.${ce}]`,START_ANCHOR:`(?:^|[${ce}])`,END_ANCHOR:`(?:[${ce}]|$)`},bs={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};En.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:bs,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:ps.sep,extglobChars(e){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${e.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(e){return e===!0?ws:gn}}});var Ve=ge(te=>{"use strict";var Ts=Ge(),Ms=!1,{REGEX_BACKSLASH:Ss,REGEX_REMOVE_BACKSLASH:Rs,REGEX_SPECIAL_CHARS:Ls,REGEX_SPECIAL_CHARS_GLOBAL:Is}=Ce();te.isObject=e=>e!==null&&typeof e=="object"&&!Array.isArray(e);te.hasRegexChars=e=>Ls.test(e);te.isRegexChar=e=>e.length===1&&te.hasRegexChars(e);te.escapeRegex=e=>e.replace(Is,"\\$1");te.toPosixSlashes=e=>e.replace(Ss,"/");te.removeBackslashes=e=>e.replace(Rs,t=>t==="\\"?"":t);te.supportsLookbehinds=()=>{let e=process.version.slice(1).split(".").map(Number);return e.length===3&&e[0]>=9||e[0]===8&&e[1]>=10};te.isWindows=e=>e&&typeof e.windows=="boolean"?e.windows:Ms===!0||Ts.sep==="\\";te.escapeLast=(e,t,n)=>{let r=e.lastIndexOf(t,n);return r===-1?e:e[r-1]==="\\"?te.escapeLast(e,t,r-1):`${e.slice(0,r)}\\${e.slice(r)}`};te.removePrefix=(e,t={})=>{let n=e;return n.startsWith("./")&&(n=n.slice(2),t.prefix="./"),n};te.wrapOutput=(e,t={},n={})=>{let r=n.contains?"":"^",i=n.contains?"":"$",s=`${r}(?:${e})${i}`;return t.negated===!0&&(s=`(?:^(?!${s}).*$)`),s}});var In=ge((Wl,wn)=>{"use strict";var bn=Ve(),{CHAR_ASTERISK:wt,CHAR_AT:Cs,CHAR_BACKWARD_SLASH:Oe,CHAR_COMMA:Os,CHAR_DOT:bt,CHAR_EXCLAMATION_MARK:Tt,CHAR_FORWARD_SLASH:Tn,CHAR_LEFT_CURLY_BRACE:Mt,CHAR_LEFT_PARENTHESES:St,CHAR_LEFT_SQUARE_BRACKET:Bs,CHAR_PLUS:Ns,CHAR_QUESTION_MARK:Mn,CHAR_RIGHT_CURLY_BRACE:Ds,CHAR_RIGHT_PARENTHESES:Sn,CHAR_RIGHT_SQUARE_BRACKET:Ps}=Ce(),Rn=e=>e===Tn||e===Oe,Ln=e=>{e.isPrefix!==!0&&(e.depth=e.isGlobstar?Infinity:1)},Us=(e,t)=>{let n=t||{},r=e.length-1,i=n.parts===!0||n.scanToEnd===!0,s=[],a=[],l=[],o=e,u=-1,c=0,f=0,h=!1,d=!1,v=!1,m=!1,p=!1,x=!1,L=!1,y=!1,T=!1,w=!1,R=0,N,g,C={value:"",depth:0,isGlob:!1},P=()=>u>=r,A=()=>o.charCodeAt(u+1),B=()=>(N=g,o.charCodeAt(++u));for(;u<r;){g=B();let G;if(g===Oe){L=C.backslashes=!0,g=B(),g===Mt&&(x=!0);continue}if(x===!0||g===Mt){for(R++;P()!==!0&&(g=B());){if(g===Oe){L=C.backslashes=!0,B();continue}if(g===Mt){R++;continue}if(x!==!0&&g===bt&&(g=B())===bt){if(h=C.isBrace=!0,v=C.isGlob=!0,w=!0,i===!0)continue;break}if(x!==!0&&g===Os){if(h=C.isBrace=!0,v=C.isGlob=!0,w=!0,i===!0)continue;break}if(g===Ds&&(R--,R===0)){x=!1,h=C.isBrace=!0,w=!0;break}}if(i===!0)continue;break}if(g===Tn){if(s.push(u),a.push(C),C={value:"",depth:0,isGlob:!1},w===!0)continue;if(N===bt&&u===c+1){c+=2;continue}f=u+1;continue}if(n.noext!==!0&&(g===Ns||g===Cs||g===wt||g===Mn||g===Tt)===!0&&A()===St){if(v=C.isGlob=!0,m=C.isExtglob=!0,w=!0,g===Tt&&u===c&&(T=!0),i===!0){for(;P()!==!0&&(g=B());){if(g===Oe){L=C.backslashes=!0,g=B();continue}if(g===Sn){v=C.isGlob=!0,w=!0;break}}continue}break}if(g===wt){if(N===wt&&(p=C.isGlobstar=!0),v=C.isGlob=!0,w=!0,i===!0)continue;break}if(g===Mn){if(v=C.isGlob=!0,w=!0,i===!0)continue;break}if(g===Bs){for(;P()!==!0&&(G=B());){if(G===Oe){L=C.backslashes=!0,B();continue}if(G===Ps){d=C.isBracket=!0,v=C.isGlob=!0,w=!0;break}}if(i===!0)continue;break}if(n.nonegate!==!0&&g===Tt&&u===c){y=C.negated=!0,c++;continue}if(n.noparen!==!0&&g===St){if(v=C.isGlob=!0,i===!0){for(;P()!==!0&&(g=B());){if(g===St){L=C.backslashes=!0,g=B();continue}if(g===Sn){w=!0;break}}continue}break}if(v===!0){if(w=!0,i===!0)continue;break}}n.noext===!0&&(m=!1,v=!1);let O=o,D="",_="";c>0&&(D=o.slice(0,c),o=o.slice(c),f-=c),O&&v===!0&&f>0?(O=o.slice(0,f),_=o.slice(f)):v===!0?(O="",_=o):O=o,O&&O!==""&&O!=="/"&&O!==o&&Rn(O.charCodeAt(O.length-1))&&(O=O.slice(0,-1)),n.unescape===!0&&(_&&(_=bn.removeBackslashes(_)),O&&L===!0&&(O=bn.removeBackslashes(O)));let E={prefix:D,input:e,start:c,base:O,glob:_,isBrace:h,isBracket:d,isGlob:v,isExtglob:m,isGlobstar:p,negated:y,negatedExtglob:T};if(n.tokens===!0&&(E.maxDepth=0,Rn(g)||a.push(C),E.tokens=a),n.parts===!0||n.tokens===!0){let G;for(let H=0;H<s.length;H++){let q=G?G+1:c,X=s[H],Z=e.slice(q,X);n.tokens&&(H===0&&c!==0?(a[H].isPrefix=!0,a[H].value=D):a[H].value=Z,Ln(a[H]),E.maxDepth+=a[H].depth),(H!==0||Z!=="")&&l.push(Z),G=X}if(G&&G+1<e.length){let H=e.slice(G+1);l.push(H),n.tokens&&(a[a.length-1].value=H,Ln(a[a.length-1]),E.maxDepth+=a[a.length-1].depth)}E.slashes=s,E.parts=l}return E};wn.exports=Us});var Nn=ge((jl,Cn)=>{"use strict";var We=Ce(),ne=Ve(),{MAX_LENGTH:je,POSIX_REGEX_SOURCE:Fs,REGEX_NON_SPECIAL_CHARS:Hs,REGEX_SPECIAL_CHARS_BACKREF:ks,REPLACEMENTS:On}=We,zs=(e,t)=>{if(typeof t.expandRange=="function")return t.expandRange(...e,t);e.sort();let n=`[${e.join("-")}]`;try{new RegExp(n)}catch(r){return e.map(i=>ne.escapeRegex(i)).join("..")}return n},Me=(e,t)=>`Missing ${e}: "${t}" - use "\\\\${t}" to match literal characters`,Bn=(e,t)=>{if(typeof e!="string")throw new TypeError("Expected a string");e=On[e]||e;let n={...t},r=typeof n.maxLength=="number"?Math.min(je,n.maxLength):je,i=e.length;if(i>r)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${r}`);let s={type:"bos",value:"",output:n.prepend||""},a=[s],l=n.capture?"":"?:",o=ne.isWindows(t),u=We.globChars(o),c=We.extglobChars(u),{DOT_LITERAL:f,PLUS_LITERAL:h,SLASH_LITERAL:d,ONE_CHAR:v,DOTS_SLASH:m,NO_DOT:p,NO_DOT_SLASH:x,NO_DOTS_SLASH:L,QMARK:y,QMARK_NO_DOT:T,STAR:w,START_ANCHOR:R}=u,N=S=>`(${l}(?:(?!${R}${S.dot?m:f}).)*?)`,g=n.dot?"":p,C=n.dot?y:T,P=n.bash===!0?N(n):w;n.capture&&(P=`(${P})`),typeof n.noext=="boolean"&&(n.noextglob=n.noext);let A={input:e,index:-1,start:0,dot:n.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:a};e=ne.removePrefix(e,A),i=e.length;let B=[],O=[],D=[],_=s,E,G=()=>A.index===i-1,H=A.peek=(S=1)=>e[A.index+S],q=A.advance=()=>e[++A.index]||"",X=()=>e.slice(A.index+1),Z=(S="",K=0)=>{A.consumed+=S,A.index+=K},le=S=>{A.output+=S.output!=null?S.output:S.value,Z(S.value)},Le=()=>{let S=1;for(;H()==="!"&&(H(2)!=="("||H(3)==="?");)q(),A.start++,S++;return S%2==0?!1:(A.negated=!0,A.start++,!0)},_e=S=>{A[S]++,D.push(S)},ue=S=>{A[S]--,D.pop()},U=S=>{if(_.type==="globstar"){let K=A.braces>0&&(S.type==="comma"||S.type==="brace"),b=S.extglob===!0||B.length&&(S.type==="pipe"||S.type==="paren");S.type!=="slash"&&S.type!=="paren"&&!K&&!b&&(A.output=A.output.slice(0,-_.output.length),_.type="star",_.value="*",_.output=P,A.output+=_.output)}if(B.length&&S.type!=="paren"&&(B[B.length-1].inner+=S.value),(S.value||S.output)&&le(S),_&&_.type==="text"&&S.type==="text"){_.value+=S.value,_.output=(_.output||"")+S.value;return}S.prev=_,a.push(S),_=S},ye=(S,K)=>{let b={...c[K],conditions:1,inner:""};b.prev=_,b.parens=A.parens,b.output=A.output;let F=(n.capture?"(":"")+b.open;_e("parens"),U({type:S,value:K,output:A.output?"":v}),U({type:"paren",extglob:!0,value:q(),output:F}),B.push(b)},Ue=S=>{let K=S.close+(n.capture?")":""),b;if(S.type==="negate"){let F=P;S.inner&&S.inner.length>1&&S.inner.includes("/")&&(F=N(n)),(F!==P||G()||/^\)+$/.test(X()))&&(K=S.close=`)$))${F}`),S.inner.includes("*")&&(b=X())&&/^\.[^\\/.]+$/.test(b)&&(K=S.close=`)${b})${F})`),S.prev.type==="bos"&&(A.negatedExtglob=!0)}U({type:"paren",extglob:!0,value:E,output:K}),ue("parens")};if(n.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(e)){let S=!1,K=e.replace(ks,(b,F,V,ee,j,rt)=>ee==="\\"?(S=!0,b):ee==="?"?F?F+ee+(j?y.repeat(j.length):""):rt===0?C+(j?y.repeat(j.length):""):y.repeat(V.length):ee==="."?f.repeat(V.length):ee==="*"?F?F+ee+(j?P:""):P:F?b:`\\${b}`);return S===!0&&(n.unescape===!0?K=K.replace(/\\/g,""):K=K.replace(/\\+/g,b=>b.length%2==0?"\\\\":b?"\\":"")),K===e&&n.contains===!0?(A.output=e,A):(A.output=ne.wrapOutput(K,A,t),A)}for(;!G();){if(E=q(),E==="\0")continue;if(E==="\\"){let b=H();if(b==="/"&&n.bash!==!0||b==="."||b===";")continue;if(!b){E+="\\",U({type:"text",value:E});continue}let F=/^\\+/.exec(X()),V=0;if(F&&F[0].length>2&&(V=F[0].length,A.index+=V,V%2!=0&&(E+="\\")),n.unescape===!0?E=q():E+=q(),A.brackets===0){U({type:"text",value:E});continue}}if(A.brackets>0&&(E!=="]"||_.value==="["||_.value==="[^")){if(n.posix!==!1&&E===":"){let b=_.value.slice(1);if(b.includes("[")&&(_.posix=!0,b.includes(":"))){let F=_.value.lastIndexOf("["),V=_.value.slice(0,F),ee=_.value.slice(F+2),j=Fs[ee];if(j){_.value=V+j,A.backtrack=!0,q(),!s.output&&a.indexOf(_)===1&&(s.output=v);continue}}}(E==="["&&H()!==":"||E==="-"&&H()==="]")&&(E=`\\${E}`),E==="]"&&(_.value==="["||_.value==="[^")&&(E=`\\${E}`),n.posix===!0&&E==="!"&&_.value==="["&&(E="^"),_.value+=E,le({value:E});continue}if(A.quotes===1&&E!=='"'){E=ne.escapeRegex(E),_.value+=E,le({value:E});continue}if(E==='"'){A.quotes=A.quotes===1?0:1,n.keepQuotes===!0&&U({type:"text",value:E});continue}if(E==="("){_e("parens"),U({type:"paren",value:E});continue}if(E===")"){if(A.parens===0&&n.strictBrackets===!0)throw new SyntaxError(Me("opening","("));let b=B[B.length-1];if(b&&A.parens===b.parens+1){Ue(B.pop());continue}U({type:"paren",value:E,output:A.parens?")":"\\)"}),ue("parens");continue}if(E==="["){if(n.nobracket===!0||!X().includes("]")){if(n.nobracket!==!0&&n.strictBrackets===!0)throw new SyntaxError(Me("closing","]"));E=`\\${E}`}else _e("brackets");U({type:"bracket",value:E});continue}if(E==="]"){if(n.nobracket===!0||_&&_.type==="bracket"&&_.value.length===1){U({type:"text",value:E,output:`\\${E}`});continue}if(A.brackets===0){if(n.strictBrackets===!0)throw new SyntaxError(Me("opening","["));U({type:"text",value:E,output:`\\${E}`});continue}ue("brackets");let b=_.value.slice(1);if(_.posix!==!0&&b[0]==="^"&&!b.includes("/")&&(E=`/${E}`),_.value+=E,le({value:E}),n.literalBrackets===!1||ne.hasRegexChars(b))continue;let F=ne.escapeRegex(_.value);if(A.output=A.output.slice(0,-_.value.length),n.literalBrackets===!0){A.output+=F,_.value=F;continue}_.value=`(${l}${F}|${_.value})`,A.output+=_.value;continue}if(E==="{"&&n.nobrace!==!0){_e("braces");let b={type:"brace",value:E,output:"(",outputIndex:A.output.length,tokensIndex:A.tokens.length};O.push(b),U(b);continue}if(E==="}"){let b=O[O.length-1];if(n.nobrace===!0||!b){U({type:"text",value:E,output:E});continue}let F=")";if(b.dots===!0){let V=a.slice(),ee=[];for(let j=V.length-1;j>=0&&(a.pop(),V[j].type!=="brace");j--)V[j].type!=="dots"&&ee.unshift(V[j].value);F=zs(ee,n),A.backtrack=!0}if(b.comma!==!0&&b.dots!==!0){let V=A.output.slice(0,b.outputIndex),ee=A.tokens.slice(b.tokensIndex);b.value=b.output="\\{",E=F="\\}",A.output=V;for(let j of ee)A.output+=j.output||j.value}U({type:"brace",value:E,output:F}),ue("braces"),O.pop();continue}if(E==="|"){B.length>0&&B[B.length-1].conditions++,U({type:"text",value:E});continue}if(E===","){let b=E,F=O[O.length-1];F&&D[D.length-1]==="braces"&&(F.comma=!0,b="|"),U({type:"comma",value:E,output:b});continue}if(E==="/"){if(_.type==="dot"&&A.index===A.start+1){A.start=A.index+1,A.consumed="",A.output="",a.pop(),_=s;continue}U({type:"slash",value:E,output:d});continue}if(E==="."){if(A.braces>0&&_.type==="dot"){_.value==="."&&(_.output=f);let b=O[O.length-1];_.type="dots",_.output+=E,_.value+=E,b.dots=!0;continue}if(A.braces+A.parens===0&&_.type!=="bos"&&_.type!=="slash"){U({type:"text",value:E,output:f});continue}U({type:"dot",value:E,output:f});continue}if(E==="?"){if(!(_&&_.value==="(")&&n.noextglob!==!0&&H()==="("&&H(2)!=="?"){ye("qmark",E);continue}if(_&&_.type==="paren"){let F=H(),V=E;if(F==="<"&&!ne.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(_.value==="("&&!/[!=<:]/.test(F)||F==="<"&&!/<([!=]|\w+>)/.test(X()))&&(V=`\\${E}`),U({type:"text",value:E,output:V});continue}if(n.dot!==!0&&(_.type==="slash"||_.type==="bos")){U({type:"qmark",value:E,output:T});continue}U({type:"qmark",value:E,output:y});continue}if(E==="!"){if(n.noextglob!==!0&&H()==="("&&(H(2)!=="?"||!/[!=<:]/.test(H(3)))){ye("negate",E);continue}if(n.nonegate!==!0&&A.index===0){Le();continue}}if(E==="+"){if(n.noextglob!==!0&&H()==="("&&H(2)!=="?"){ye("plus",E);continue}if(_&&_.value==="("||n.regex===!1){U({type:"plus",value:E,output:h});continue}if(_&&(_.type==="bracket"||_.type==="paren"||_.type==="brace")||A.parens>0){U({type:"plus",value:E});continue}U({type:"plus",value:h});continue}if(E==="@"){if(n.noextglob!==!0&&H()==="("&&H(2)!=="?"){U({type:"at",extglob:!0,value:E,output:""});continue}U({type:"text",value:E});continue}if(E!=="*"){(E==="$"||E==="^")&&(E=`\\${E}`);let b=Hs.exec(X());b&&(E+=b[0],A.index+=b[0].length),U({type:"text",value:E});continue}if(_&&(_.type==="globstar"||_.star===!0)){_.type="star",_.star=!0,_.value+=E,_.output=P,A.backtrack=!0,A.globstar=!0,Z(E);continue}let S=X();if(n.noextglob!==!0&&/^\([^?]/.test(S)){ye("star",E);continue}if(_.type==="star"){if(n.noglobstar===!0){Z(E);continue}let b=_.prev,F=b.prev,V=b.type==="slash"||b.type==="bos",ee=F&&(F.type==="star"||F.type==="globstar");if(n.bash===!0&&(!V||S[0]&&S[0]!=="/")){U({type:"star",value:E,output:""});continue}let j=A.braces>0&&(b.type==="comma"||b.type==="brace"),rt=B.length&&(b.type==="pipe"||b.type==="paren");if(!V&&b.type!=="paren"&&!j&&!rt){U({type:"star",value:E,output:""});continue}for(;S.slice(0,3)==="/**";){let Fe=e[A.index+4];if(Fe&&Fe!=="/")break;S=S.slice(3),Z("/**",3)}if(b.type==="bos"&&G()){_.type="globstar",_.value+=E,_.output=N(n),A.output=_.output,A.globstar=!0,Z(E);continue}if(b.type==="slash"&&b.prev.type!=="bos"&&!ee&&G()){A.output=A.output.slice(0,-(b.output+_.output).length),b.output=`(?:${b.output}`,_.type="globstar",_.output=N(n)+(n.strictSlashes?")":"|$)"),_.value+=E,A.globstar=!0,A.output+=b.output+_.output,Z(E);continue}if(b.type==="slash"&&b.prev.type!=="bos"&&S[0]==="/"){let Fe=S[1]!==void 0?"|$":"";A.output=A.output.slice(0,-(b.output+_.output).length),b.output=`(?:${b.output}`,_.type="globstar",_.output=`${N(n)}${d}|${d}${Fe})`,_.value+=E,A.output+=b.output+_.output,A.globstar=!0,Z(E+q()),U({type:"slash",value:"/",output:""});continue}if(b.type==="bos"&&S[0]==="/"){_.type="globstar",_.value+=E,_.output=`(?:^|${d}|${N(n)}${d})`,A.output=_.output,A.globstar=!0,Z(E+q()),U({type:"slash",value:"/",output:""});continue}A.output=A.output.slice(0,-_.output.length),_.type="globstar",_.output=N(n),_.value+=E,A.output+=_.output,A.globstar=!0,Z(E);continue}let K={type:"star",value:E,output:P};if(n.bash===!0){K.output=".*?",(_.type==="bos"||_.type==="slash")&&(K.output=g+K.output),U(K);continue}if(_&&(_.type==="bracket"||_.type==="paren")&&n.regex===!0){K.output=E,U(K);continue}(A.index===A.start||_.type==="slash"||_.type==="dot")&&(_.type==="dot"?(A.output+=x,_.output+=x):n.dot===!0?(A.output+=L,_.output+=L):(A.output+=g,_.output+=g),H()!=="*"&&(A.output+=v,_.output+=v)),U(K)}for(;A.brackets>0;){if(n.strictBrackets===!0)throw new SyntaxError(Me("closing","]"));A.output=ne.escapeLast(A.output,"["),ue("brackets")}for(;A.parens>0;){if(n.strictBrackets===!0)throw new SyntaxError(Me("closing",")"));A.output=ne.escapeLast(A.output,"("),ue("parens")}for(;A.braces>0;){if(n.strictBrackets===!0)throw new SyntaxError(Me("closing","}"));A.output=ne.escapeLast(A.output,"{"),ue("braces")}if(n.strictSlashes!==!0&&(_.type==="star"||_.type==="bracket")&&U({type:"maybe_slash",value:"",output:`${d}?`}),A.backtrack===!0){A.output="";for(let S of A.tokens)A.output+=S.output!=null?S.output:S.value,S.suffix&&(A.output+=S.suffix)}return A};Bn.fastpaths=(e,t)=>{let n={...t},r=typeof n.maxLength=="number"?Math.min(je,n.maxLength):je,i=e.length;if(i>r)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${r}`);e=On[e]||e;let s=ne.isWindows(t),{DOT_LITERAL:a,SLASH_LITERAL:l,ONE_CHAR:o,DOTS_SLASH:u,NO_DOT:c,NO_DOTS:f,NO_DOTS_SLASH:h,STAR:d,START_ANCHOR:v}=We.globChars(s),m=n.dot?f:c,p=n.dot?h:c,x=n.capture?"":"?:",L={negated:!1,prefix:""},y=n.bash===!0?".*?":d;n.capture&&(y=`(${y})`);let T=g=>g.noglobstar===!0?y:`(${x}(?:(?!${v}${g.dot?u:a}).)*?)`,w=g=>{switch(g){case"*":return`${m}${o}${y}`;case".*":return`${a}${o}${y}`;case"*.*":return`${m}${y}${a}${o}${y}`;case"*/*":return`${m}${y}${l}${o}${p}${y}`;case"**":return m+T(n);case"**/*":return`(?:${m}${T(n)}${l})?${p}${o}${y}`;case"**/*.*":return`(?:${m}${T(n)}${l})?${p}${y}${a}${o}${y}`;case"**/.*":return`(?:${m}${T(n)}${l})?${a}${o}${y}`;default:{let C=/^(.*?)\.(\w+)$/.exec(g);if(!C)return;let P=w(C[1]);return P?P+a+C[2]:void 0}}},R=ne.removePrefix(e,L),N=w(R);return N&&n.strictSlashes!==!0&&(N+=`${l}?`),N};Cn.exports=Bn});var Pn=ge((ql,Dn)=>{"use strict";var Ks=Ge(),Ys=In(),Rt=Nn(),Lt=Ve(),Gs=Ce(),$s=e=>e&&typeof e=="object"&&!Array.isArray(e),W=(e,t,n=!1)=>{if(Array.isArray(e)){let c=e.map(h=>W(h,t,n));return h=>{for(let d of c){let v=d(h);if(v)return v}return!1}}let r=$s(e)&&e.tokens&&e.input;if(e===""||typeof e!="string"&&!r)throw new TypeError("Expected pattern to be a non-empty string");let i=t||{},s=Lt.isWindows(t),a=r?W.compileRe(e,t):W.makeRe(e,t,!1,!0),l=a.state;delete a.state;let o=()=>!1;if(i.ignore){let c={...t,ignore:null,onMatch:null,onResult:null};o=W(i.ignore,c,n)}let u=(c,f=!1)=>{let{isMatch:h,match:d,output:v}=W.test(c,a,t,{glob:e,posix:s}),m={glob:e,state:l,regex:a,posix:s,input:c,output:v,match:d,isMatch:h};return typeof i.onResult=="function"&&i.onResult(m),h===!1?(m.isMatch=!1,f?m:!1):o(c)?(typeof i.onIgnore=="function"&&i.onIgnore(m),m.isMatch=!1,f?m:!1):(typeof i.onMatch=="function"&&i.onMatch(m),f?m:!0)};return n&&(u.state=l),u};W.test=(e,t,n,{glob:r,posix:i}={})=>{if(typeof e!="string")throw new TypeError("Expected input to be a string");if(e==="")return{isMatch:!1,output:""};let s=n||{},a=s.format||(i?Lt.toPosixSlashes:null),l=e===r,o=l&&a?a(e):e;return l===!1&&(o=a?a(e):e,l=o===r),(l===!1||s.capture===!0)&&(s.matchBase===!0||s.basename===!0?l=W.matchBase(e,t,n,i):l=t.exec(o)),{isMatch:Boolean(l),match:l,output:o}};W.matchBase=(e,t,n,r=Lt.isWindows(n))=>(t instanceof RegExp?t:W.makeRe(t,n)).test(Ks.basename(e));W.isMatch=(e,t,n)=>W(t,n)(e);W.parse=(e,t)=>Array.isArray(e)?e.map(n=>W.parse(n,t)):Rt(e,{...t,fastpaths:!1});W.scan=(e,t)=>Ys(e,t);W.compileRe=(e,t,n=!1,r=!1)=>{if(n===!0)return e.output;let i=t||{},s=i.contains?"":"^",a=i.contains?"":"$",l=`${s}(?:${e.output})${a}`;e&&e.negated===!0&&(l=`^(?!${l}).*$`);let o=W.toRegex(l,t);return r===!0&&(o.state=e),o};W.makeRe=(e,t={},n=!1,r=!1)=>{if(!e||typeof e!="string")throw new TypeError("Expected a non-empty string");let i={negated:!1,fastpaths:!0};return t.fastpaths!==!1&&(e[0]==="."||e[0]==="*")&&(i.output=Rt.fastpaths(e,t)),i.output||(i=Rt(e,t)),W.compileRe(i,t,n,r)};W.toRegex=(e,t)=>{try{let n=t||{};return new RegExp(e,n.flags||(n.nocase?"i":""))}catch(n){if(t&&t.debug===!0)throw n;return/$^/}};W.constants=Gs;Dn.exports=W});var Fn=ge((Xl,Un)=>{"use strict";Un.exports=Pn()});var Dr=`<div class="container">
  <label class="hidden" id="title">display-port</label>
  <label class="hidden" id="fps">00</label>
  <label class="hidden" id="dimension">0x0</label>
  <div class="content">
    <canvas> Oh no! Your browser does not support canvas. </canvas>
    <slot id="inner"></slot>
  </div>
  <slot name="frame"></slot>
</div>
`,Pr=`:host {
  display: inline-block;
  color: #555555;
}

.container {
  display: flex;
  position: relative;
  width: 100%;
  height: 100%;
}

.content {
  position: relative;
  margin: auto;
}

.content > *:not(canvas) {
  width: 100%;
  height: 100%;
}

canvas {
  background: #000000;
  image-rendering: pixelated;
}

label {
  position: absolute;
  font-family: monospace;
  color: currentColor;
}

#inner {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: 0;
  left: 0;
  pointer-events: none;
}

#title {
  left: 0.5rem;
  top: 0.5rem;
}

#fps {
  right: 0.5rem;
  top: 0.5rem;
}

#dimension {
  left: 0.5rem;
  bottom: 0.5rem;
}

.hidden {
  display: none;
}

:host([debug]) .container {
  outline: 6px dashed rgba(0, 0, 0, 0.1);
  outline-offset: -4px;
  background-color: rgba(0, 0, 0, 0.1);
}

:host([mode='noscale']) canvas {
  margin: 0;
  top: 0;
  left: 0;
}

:host([mode='stretch']) canvas,
:host([mode='scale']) canvas {
  width: 100%;
  height: 100%;
}

:host([mode='fit']),
:host([mode='scale']),
:host([mode='center']),
:host([mode='stretch']),
:host([mode='fill']) {
  width: 100%;
  height: 100%;
}

:host([full]) {
  width: 100vw !important;
  height: 100vh !important;
}

:host([disabled]) {
  display: none;
}

slot {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  pointer-events: none;
}

::slotted(*) {
  pointer-events: auto;
}
`,Wt="noscale",it="fit",jt="scale",qt="fill",Xt="stretch",Ur=300,Fr=150,Hr=it,kr=200,Zt=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=Dr,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Pr,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("display-port",this)}static get observedAttributes(){return["debug","disabled","width","height","onframe","id","class"]}get mode(){return this.getAttribute("mode")}set mode(t){this.setAttribute("mode",t)}get debug(){return this._debug}set debug(t){this.toggleAttribute("debug",t)}get disabled(){return this._disabled}set disabled(t){this.toggleAttribute("disabled",t)}get width(){return this._width}set width(t){this.setAttribute("width",String(t))}get height(){return this._height}set height(t){this.setAttribute("height",String(t))}get onframe(){return this._onframe}set onframe(t){this._onframe&&this.removeEventListener("frame",this._onframe),this._onframe=t,this._onframe&&this.addEventListener("frame",t)}constructor(){super();let t=this.attachShadow({mode:"open"});t.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),t.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._canvasElement=t.querySelector("canvas"),this._contentElement=t.querySelector(".content"),this._innerElement=t.querySelector("#inner"),this._titleElement=t.querySelector("#title"),this._fpsElement=t.querySelector("#fps"),this._dimensionElement=t.querySelector("#dimension"),this._debug=!1,this._disabled=!1,this._width=Ur,this._height=Fr,this._onframe=void 0,this._animationRequestHandle=0,this._prevAnimationFrameTime=0,this._resizeTimeoutHandle=0,this._resizeCanvasWidth=0,this._resizeCanvasHeight=0,this._frameEvent=new CustomEvent("frame",{composed:!0,bubbles:!1,detail:{now:0,prevTime:0,deltaTime:0,canvas:this._canvasElement}}),this._resizeEvent=new CustomEvent("resize",{composed:!0,bubbles:!1,detail:{width:0,height:0}}),this.update=this.update.bind(this),this.onDelayCanvasResize=this.onDelayCanvasResize.bind(this)}get canvas(){return this._canvasElement}connectedCallback(){Te(this,"mode"),Te(this,"debug"),Te(this,"disabled"),Te(this,"width"),Te(this,"height"),Te(this,"onframe"),this.hasAttribute("mode")||this.setAttribute("mode",Hr),this.hasAttribute("tabindex")||this.setAttribute("tabindex","0"),this.updateCanvasSize(!0),this.resume()}disconnectedCallback(){this.pause()}attributeChangedCallback(t,n,r){switch(t){case"debug":this._debug=r!==null;break;case"disabled":this._disabled=r!==null;break;case"width":this._width=Number(r);break;case"height":this._height=Number(r);break;case"onframe":this.onframe=new Function("event","with(document){with(this){"+r+"}}").bind(this);break}switch(t){case"disabled":r?(this.update(0),this.pause()):this.resume();break;case"id":case"class":this._titleElement.innerHTML=`display-port${this.className?"."+this.className:""}${this.hasAttribute("id")?"#"+this.getAttribute("id"):""}`;break;case"debug":this._titleElement.classList.toggle("hidden",r),this._fpsElement.classList.toggle("hidden",r),this._dimensionElement.classList.toggle("hidden",r);break}}getContext(t="2d",n=void 0){return this._canvasElement.getContext(t,n)}pause(){cancelAnimationFrame(this._animationRequestHandle)}resume(){this._animationRequestHandle=requestAnimationFrame(this.update)}update(t){this._animationRequestHandle=requestAnimationFrame(this.update),this.updateCanvasSize(!1);let n=t-this._prevAnimationFrameTime;if(this._prevAnimationFrameTime=t,this._debug){let s=n<=0?"--":String(Math.round(1e3/n)).padStart(2,"0");if(this._fpsElement.textContent!==s&&(this._fpsElement.textContent=s),this.mode===Wt){let l=`${this._width}x${this._height}`;this._dimensionElement.textContent!==l&&(this._dimensionElement.textContent=l)}else{let l=`${this._width}x${this._height}|${this.shadowRoot.host.clientWidth}x${this.shadowRoot.host.clientHeight}`;this._dimensionElement.textContent!==l&&(this._dimensionElement.textContent=l)}}let i=this._frameEvent.detail;i.now=t,i.prevTime=this._prevAnimationFrameTime,i.deltaTime=n,this.dispatchEvent(this._frameEvent)}onDelayCanvasResize(){this._resizeTimeoutHandle=0,this.updateCanvasSize(!0)}delayCanvasResize(t,n){(t!==this._resizeCanvasWidth||n!==this._resizeCanvasHeight)&&(this._resizeCanvasWidth=t,this._resizeCanvasHeight=n,this._resizeTimeoutHandle&&clearTimeout(this._resizeTimeoutHandle),this._resizeTimeoutHandle=setTimeout(this.onDelayCanvasResize,kr))}updateCanvasSize(t=!0){let n=this.shadowRoot.host.getBoundingClientRect(),r=n.width,i=n.height,s=this._canvasElement,a=this._width,l=this._height,o=this.mode;if(o===Xt||o===qt)a=r,l=i;else if(o!==Wt&&(r<a||i<l||o===it||o==jt)){let c=r/a,f=i/l;c<f?(a=r,l=l*c):(a=a*f,l=i)}if(a=Math.floor(a),l=Math.floor(l),typeof t=="undefined"&&(t=s.clientWidth!==a||s.clientHeight!==l),!t){this.delayCanvasResize(a,l);return}let u=Math.min(a/this._width,l/this._height)*.5;if(this._innerElement.style.fontSize=`font-size: ${u}em`,t){o===jt?(s.width=this._width,s.height=this._height):o!==Xt&&(s.width=a,s.height=l);let c=this._contentElement.style;c.width=`${a}px`,c.height=`${l}px`,(o===it||o===qt)&&(this._width=a,this._height=l);let h=this._resizeEvent.detail;h.width=a,h.height=l,this.dispatchEvent(this._resizeEvent)}}};Zt.define();function Te(e,t){if(Object.prototype.hasOwnProperty.call(e,t)){let n=e[t];delete e[t],e[t]=n}}var st=class{get polling(){return performance.now()-this._lastPollingTime<1e3}get value(){return 0}get size(){return this._size}constructor(t){this._size=t,this._lastPollingTime=Number.MIN_SAFE_INTEGER}resize(t){this._size=t}getState(t){throw new Error("Missing implementation.")}onUpdate(t,n,r){throw new Error("Missing implementation.")}onStatus(t,n){throw new Error("Missing implementation.")}onPoll(t){this._lastPollingTime=t}onBind(t,n={}){t>=this._size&&this.resize(t+1)}onUnbind(){this.resize(0)}},Ie=class extends st{static createAxisBindingState(){return{value:0,delta:0,inverted:!1}}get delta(){return this._delta}get value(){return this._value}constructor(t=0){super(t);let n=new Array;for(let r=0;r<t;++r)n.push(this.constructor.createAxisBindingState());this._state=n,this._value=0,this._delta=0}resize(t){let n=this._state,r=n.length,i;if(t<=r)i=n.slice(0,t);else{i=n;for(let s=r;s<t;++s)i.push(this.constructor.createAxisBindingState())}this._state=i,super.resize(t)}getState(t){return this._state[t].value}onPoll(t){let n=this._state,r=0,i=0,s=n.length;for(let a=0;a<s;++a){let l=n[a];r+=l.value*(l.inverted?-1:1),i+=l.delta,n[a].delta=0}this._value=r,this._delta=i,super.onPoll(t)}onUpdate(t,n,r){typeof n=="undefined"?this.onAxisChange(t,r):this.onAxisMove(t,n,r)}onStatus(t,n){this.onAxisStatus(t,n)}onBind(t,n={}){super.onBind(t,n);let{inverted:r=!1}=n,i=this._state;i[t].inverted=r}onAxisMove(t,n,r){let i=this._state[t];i.value=n,i.delta+=r}onAxisChange(t,n){let r=this._state[t];r.value+=n,r.delta+=n}onAxisStatus(t,n){let r=this._state[t],i=r.value;r.value=n,r.delta=n-i}},zr=241,Qt=254,Kr=239,we=1,at=2,ot=4,lt=8,ut=16,ze=class extends st{get pressed(){return this._pressed}get repeated(){return this._repeated}get released(){return this._released}get down(){return this._down}get value(){return this._value}constructor(t=0){super(t);this._state=new Uint8Array(t),this._value=0,this._down=!1,this._pressed=!1,this._repeated=!1,this._released=!1}resize(t){let n=this._state,r=n.length,i;t<=r?i=n.slice(0,t):(i=new Uint8Array(t),i.set(n)),this._state=i,super.resize(t)}getState(t){let n=this._state[t],r=n&ut?-1:1;return(n&we?1:0)*r}onPoll(t){let n=this._state,r=0,i=0,s=0,a=0,l=0,o=n.length;for(let u=0;u<o;++u){let c=n[u],f=c&we,h=c&ut;i|=f,s|=c&at,a|=c&ot,l|=c&lt,r+=(f?1:0)*(h?-1:1),n[u]&=zr}this._value=r,this._down=i!==0,this._pressed=s!==0,this._repeated=a!==0,this._released=l!==0,super.onPoll(t)}onUpdate(t,n,r){r>0?this.onButtonPressed(t):this.onButtonReleased(t)}onStatus(t,n){this.onButtonStatus(t,n!==0)}onBind(t,n={}){super.onBind(t,n);let{inverted:r=!1}=n,i=this._state;r?i[t]|=ut:i[t]&=Kr}onButtonPressed(t){let n=this._state,r=n[t];r&we||(r|=at,r|=we),r|=ot,n[t]=r}onButtonReleased(t){let n=this._state,r=n[t];r&we&&(r|=lt,r&=Qt),n[t]=r}onButtonStatus(t,n){let r=this._state,i=r[t],s=Boolean(i&we);n?i|=we:i&=Qt,s&&!n&&(i|=lt),!s&&n&&(i|=at,i|=ot),r[t]=i}},M=class{static parse(t){t=t.trim();let n=t.indexOf(".");if(n<0)throw new Error("Missing device separator for key code.");let r=t.substring(0,n);if(r.length<0)throw new Error("Missing device for key code.");let i=t.substring(n+1);if(i.length<0)throw new Error("Missing code for key code.");return new M(r,i)}constructor(t,n){this.device=t,this.code=n}toString(){return`${this.device}.${this.code}`}};function ct(e,t){return new M(e,t)}function Yr(e){return"device"in e&&"code"in e}var I="Keyboard",se="Mouse",Gr=new M(I,"KeyA"),$r=new M(I,"KeyB"),Vr=new M(I,"KeyC"),Wr=new M(I,"KeyD"),jr=new M(I,"KeyE"),qr=new M(I,"KeyF"),Xr=new M(I,"KeyG"),Zr=new M(I,"KeyH"),Qr=new M(I,"KeyI"),Jr=new M(I,"KeyJ"),ei=new M(I,"KeyK"),ti=new M(I,"KeyL"),ni=new M(I,"KeyM"),ri=new M(I,"KeyN"),ii=new M(I,"KeyO"),si=new M(I,"KeyP"),ai=new M(I,"KeyQ"),oi=new M(I,"KeyR"),li=new M(I,"KeyS"),ui=new M(I,"KeyT"),ci=new M(I,"KeyU"),fi=new M(I,"KeyV"),hi=new M(I,"KeyW"),pi=new M(I,"KeyX"),di=new M(I,"KeyY"),vi=new M(I,"KeyZ"),mi=new M(I,"Digit0"),_i=new M(I,"Digit1"),Ei=new M(I,"Digit2"),Ai=new M(I,"Digit3"),xi=new M(I,"Digit4"),yi=new M(I,"Digit5"),gi=new M(I,"Digit6"),wi=new M(I,"Digit7"),bi=new M(I,"Digit8"),Ti=new M(I,"Digit9"),Mi=new M(I,"Minus"),Si=new M(I,"Equal"),Ri=new M(I,"BracketLeft"),Li=new M(I,"BracketRight"),Ii=new M(I,"Semicolon"),Ci=new M(I,"Quote"),Oi=new M(I,"Backquote"),Bi=new M(I,"Backslash"),Ni=new M(I,"Comma"),Di=new M(I,"Period"),Pi=new M(I,"Slash"),Ui=new M(I,"Escape"),Fi=new M(I,"Space"),Hi=new M(I,"CapsLock"),ki=new M(I,"Backspace"),zi=new M(I,"Delete"),Ki=new M(I,"Tab"),Yi=new M(I,"Enter"),Gi=new M(I,"ArrowUp"),$i=new M(I,"ArrowDown"),Vi=new M(I,"ArrowLeft"),Wi=new M(I,"ArrowRight"),ji=new M(se,"Button0"),qi=new M(se,"Button1"),Xi=new M(se,"Button2"),Zi=new M(se,"Button3"),Qi=new M(se,"Button4"),Ji=new M(se,"PosX"),es=new M(se,"PosY"),ts=new M(se,"WheelX"),ns=new M(se,"WheelY"),rs=new M(se,"WheelZ"),$=Object.freeze({__proto__:null,from:ct,isKeyCode:Yr,KEYBOARD:I,MOUSE:se,KEY_A:Gr,KEY_B:$r,KEY_C:Vr,KEY_D:Wr,KEY_E:jr,KEY_F:qr,KEY_G:Xr,KEY_H:Zr,KEY_I:Qr,KEY_J:Jr,KEY_K:ei,KEY_L:ti,KEY_M:ni,KEY_N:ri,KEY_O:ii,KEY_P:si,KEY_Q:ai,KEY_R:oi,KEY_S:li,KEY_T:ui,KEY_U:ci,KEY_V:fi,KEY_W:hi,KEY_X:pi,KEY_Y:di,KEY_Z:vi,DIGIT_0:mi,DIGIT_1:_i,DIGIT_2:Ei,DIGIT_3:Ai,DIGIT_4:xi,DIGIT_5:yi,DIGIT_6:gi,DIGIT_7:wi,DIGIT_8:bi,DIGIT_9:Ti,MINUS:Mi,EQUAL:Si,BRACKET_LEFT:Ri,BRACKET_RIGHT:Li,SEMICOLON:Ii,QUOTE:Ci,BACKQUOTE:Oi,BACKSLASH:Bi,COMMA:Ni,PERIOD:Di,SLASH:Pi,ESCAPE:Ui,SPACE:Fi,CAPS_LOCK:Hi,BACKSPACE:ki,DELETE:zi,TAB:Ki,ENTER:Yi,ARROW_UP:Gi,ARROW_DOWN:$i,ARROW_LEFT:Vi,ARROW_RIGHT:Wi,MOUSE_BUTTON_0:ji,MOUSE_BUTTON_1:qi,MOUSE_BUTTON_2:Xi,MOUSE_BUTTON_3:Zi,MOUSE_BUTTON_4:Qi,MOUSE_POS_X:Ji,MOUSE_POS_Y:es,MOUSE_WHEEL_X:ts,MOUSE_WHEEL_Y:ns,MOUSE_WHEEL_Z:rs}),ft=class{get polling(){return this.ref?this.ref.polling:!1}get value(){return!this.ref||this.disabled?0:this.ref.value}constructor(t){this.name=t,this.ref=null,this.disabled=!1}register(t){throw new Error("Unsupported operation.")}disable(t=!0){return this.disabled=t,this}getState(t){return!this.ref||this.disabled?0:this.ref.getState(t)}};function Jt(e){Array.isArray(e)||(e=[e]);let t=[];for(let n of e){let r;try{r=M.parse(n)}catch(i){let s=is(n).toUpperCase();if(!(s in $))throw new Error("Invalid key code string - "+i);r=$[s]}t.push(r)}return t}function is(e){return e.replace(/([a-z]|(?:[A-Z0-9]+))([A-Z0-9]|$)/g,function(t,n,r){return n+(r&&"_"+r)}).toLowerCase()}var be=class extends ft{static fromBind(t,n,r,i=void 0){return new be(t,ct(n,r),i)}static fromString(t,...n){let r=Jt(n);return new be(t,r)}get delta(){return!this.ref||this.disabled?0:this.ref.delta}constructor(t,n,r=void 0){super(t);this.keyCodes=Array.isArray(n)?n:[n],this.opts=r}register(t){let n=this.name,r=this.opts;for(let i of this.keyCodes)t.bindAxis(n,i.device,i.code,r);return this.ref=t.getAxis(n),this}},Q=class extends ft{static fromBind(t,n,r,i=void 0){return new Q(t,ct(n,r),i)}static fromString(t,...n){let r=Jt(n);return new Q(t,r)}get pressed(){return!this.ref||this.disabled?!1:this.ref.pressed}get repeated(){return!this.ref||this.disabled?!1:this.ref.repeated}get released(){return!this.ref||this.disabled?!1:this.ref.released}get down(){return!this.ref||this.disabled?!1:this.ref.down}constructor(t,n,r=void 0){super(t);this.keyCodes=Array.isArray(n)?n:[n],this.opts=r}register(t){let n=this.name,r=this.opts;for(let i of this.keyCodes)t.bindButton(n,i.device,i.code,r);return this.ref=t.getButton(n),this}};var ht=class{static isAxis(t){return!1}static isButton(t){return!1}constructor(t,n){if(!n)throw new Error(`Missing event target for device ${t}.`);this.name=t,this.eventTarget=n,this.listeners={input:[]}}setEventTarget(t){if(!t)throw new Error(`Missing event target for device ${this.name}.`);this.eventTarget=t}destroy(){let t=this.listeners;for(let n in t)t[n].length=0}addEventListener(t,n){let r=this.listeners;t in r?r[t].push(n):r[t]=[n]}removeEventListener(t,n){let r=this.listeners;if(t in r){let i=r[t],s=i.indexOf(n);s>=0&&i.splice(s,1)}}dispatchInputEvent(t){let n=0;for(let r of this.listeners.input)n|=r(t);return Boolean(n)}},en=class extends ht{static isAxis(t){return!1}static isButton(t){return!0}constructor(t,n,r={}){super(t,n);let{ignoreRepeat:i=!0}=r;this.ignoreRepeat=i,this._eventObject={target:n,device:t,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),n.addEventListener("keydown",this.onKeyDown),n.addEventListener("keyup",this.onKeyUp)}setEventTarget(t){this.eventTarget&&this.destroy(),super.setEventTarget(t),t.addEventListener("keydown",this.onKeyDown),t.addEventListener("keyup",this.onKeyUp)}destroy(){let t=this.eventTarget;t.removeEventListener("keydown",this.onKeyDown),t.removeEventListener("keyup",this.onKeyUp),super.destroy()}onKeyDown(t){if(t.repeat&&this.ignoreRepeat)return t.preventDefault(),t.stopPropagation(),!1;let n=this._eventObject;if(n.code=t.code,n.event="pressed",n.value=1,n.control=t.ctrlKey,n.shift=t.shiftKey,n.alt=t.altKey,this.dispatchInputEvent(n))return t.preventDefault(),t.stopPropagation(),!1}onKeyUp(t){let n=this._eventObject;if(n.code=t.code,n.event="released",n.value=1,n.control=t.ctrlKey,n.shift=t.shiftKey,n.alt=t.altKey,this.dispatchInputEvent(n))return t.preventDefault(),t.stopPropagation(),!1}},pt=10,dt=100,tn=class extends ht{static isAxis(t){return t==="PosX"||t==="PosY"||t==="WheelX"||t==="WheelY"||t==="WheelZ"}static isButton(t){return!this.isAxis(t)}constructor(t,n,r={}){super(t,n);let{eventsOnFocus:i=!0}=r;this.eventsOnFocus=i,this.canvasTarget=this.getCanvasFromEventTarget(n),this._downHasFocus=!1,this._eventObject={target:n,device:t,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this._positionObject={target:n,device:t,code:"",event:"move",value:0,movement:0},this._wheelObject={target:n,device:t,code:"",event:"wheel",movement:0},this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onWheel=this.onWheel.bind(this),n.addEventListener("mousedown",this.onMouseDown),n.addEventListener("contextmenu",this.onContextMenu),n.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}setEventTarget(t){this.eventTarget&&this.destroy(),super.setEventTarget(t),this.canvasTarget=this.getCanvasFromEventTarget(t),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("contextmenu",this.onContextMenu),t.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}destroy(){let t=this.eventTarget;t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("contextmenu",this.onContextMenu),t.removeEventListener("wheel",this.onWheel),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),super.destroy()}setPointerLock(t=!0){t?this.eventTarget.requestPointerLock():this.eventTarget.exitPointerLock()}hasPointerLock(){return document.pointerLockElement===this.eventTarget}onMouseDown(t){this._downHasFocus=!0;let n=this._eventObject;if(n.code="Button"+t.button,n.event="pressed",n.value=1,n.control=t.ctrlKey,n.shift=t.shiftKey,n.alt=t.altKey,this.dispatchInputEvent(n)&&document.activeElement===this.eventTarget)return t.preventDefault(),t.stopPropagation(),!1}onContextMenu(t){return t.preventDefault(),t.stopPropagation(),!1}onWheel(t){let n,r,i;switch(t.deltaMode){case WheelEvent.DOM_DELTA_LINE:n=t.deltaX*pt,r=t.deltaY*pt,i=t.deltaZ*pt;break;case WheelEvent.DOM_DELTA_PAGE:n=t.deltaX*dt,r=t.deltaY*dt,i=t.deltaZ*dt;break;case WheelEvent.DOM_DELTA_PIXEL:default:n=t.deltaX,r=t.deltaY,i=t.deltaZ;break}let s=0,a=this._wheelObject;if(a.code="WheelX",a.movement=n,s|=this.dispatchInputEvent(a),a.code="WheelY",a.movement=r,s|=this.dispatchInputEvent(a),a.code="WheelZ",a.movement=i,s|=this.dispatchInputEvent(a),s)return t.preventDefault(),t.stopPropagation(),!1}onMouseUp(t){if(!this._downHasFocus)return;this._downHasFocus=!1;let n=this._eventObject;if(n.code="Button"+t.button,n.event="released",n.value=1,n.control=t.ctrlKey,n.shift=t.shiftKey,n.alt=t.altKey,this.dispatchInputEvent(n))return t.preventDefault(),t.stopPropagation(),!1}onMouseMove(t){if(this.eventsOnFocus&&document.activeElement!==this.eventTarget)return;let n=this.canvasTarget,{clientWidth:r,clientHeight:i}=n,s=n.getBoundingClientRect(),a=t.movementX/r,l=t.movementY/i,o=(t.clientX-s.left)/r,u=(t.clientY-s.top)/i,c=this._positionObject;c.code="PosX",c.value=o,c.movement=a,this.dispatchInputEvent(c),c.code="PosY",c.value=u,c.movement=l,this.dispatchInputEvent(c)}getCanvasFromEventTarget(t){return t instanceof HTMLCanvasElement?t:t.canvas||t.querySelector("canvas")||t.shadowRoot&&t.shadowRoot.querySelector("canvas")||t}},ss=`<kbd>
  <span id="name"><slot></slot></span>
  <span id="value" class="hidden"></span>
</kbd>
`,as=`kbd {
  position: relative;
  display: inline-block;
  border-radius: 3px;
  border: 1px solid #888888;
  font-size: 0.85em;
  font-weight: 700;
  text-rendering: optimizeLegibility;
  line-height: 12px;
  height: 14px;
  padding: 2px 4px;
  color: #444444;
  background-color: #eeeeee;
  box-shadow: inset 0 -3px 0 #aaaaaa;
  overflow: hidden;
}

kbd:empty::after {
  content: '<?>';
  opacity: 0.6;
}

.disabled {
  opacity: 0.6;
  box-shadow: none;
  background-color: #aaaaaa;
}

.hidden {
  display: none;
}

#value {
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  font-size: 0.85em;
  padding: 0 4px;
  padding-top: 2px;
  color: #cccccc;
  background-color: #333333;
  box-shadow: inset 0 3px 0 #222222;
}
`,vt=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=ss,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=as,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("input-code",this)}static get observedAttributes(){return["name","value","disabled"]}get disabled(){return this._disabled}set disabled(t){this.toggleAttribute("disabled",t)}get value(){return this._value}set value(t){this.setAttribute("value",t)}get name(){return this._name}set name(t){this.setAttribute("name",t)}constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._name="",this._value="",this._disabled=!1,this._kbdElement=this.shadowRoot.querySelector("kbd"),this._nameElement=this.shadowRoot.querySelector("#name"),this._valueElement=this.shadowRoot.querySelector("#value")}attributeChangedCallback(t,n,r){switch(t){case"name":this._name=r,this._nameElement.textContent=r;break;case"value":this._value=r,r!==null?(this._valueElement.classList.toggle("hidden",!1),this._valueElement.textContent=r,this._kbdElement.style.paddingRight=`${this._valueElement.clientWidth+4}px`):this._valueElement.classList.toggle("hidden",!0);break;case"disabled":this._disabled=r!==null,this._kbdElement.classList.toggle("disabled",r!==null);break}}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"name")){let t=this.name;delete this.name,this.name=t}if(Object.prototype.hasOwnProperty.call(this,"value")){let t=this.value;delete this.value,this.value=t}if(Object.prototype.hasOwnProperty.call(this,"disabled")){let t=this.disabled;delete this.disabled,this.disabled=t}}};vt.define();var os=`<table>
  <thead>
    <tr class="tableHeader">
      <th colspan="3">
        <span class="tableTitle">
          <label id="title"> input-source </label>
          <span id="slotContainer">
            <slot></slot>
          </span>
          <p>
            <label for="poll">poll</label>
            <output id="poll"></output>
          </p>
          <p>
            <label for="focus">focus</label>
            <output id="focus"></output>
          </p>
        </span>
      </th>
    </tr>
    <tr class="colHeader">
      <th>name</th>
      <th>value</th>
      <th>key</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
`,ls=`:host {
  display: block;
}

table {
  border-collapse: collapse;
  font-family: monospace;
}

table,
th,
td {
  border: 1px solid #666666;
}

th,
td {
  padding: 5px 10px;
}

td {
  text-align: center;
}

thead th {
  padding: 0;
}

.colHeader > th {
  font-size: 0.8em;
  padding: 0 10px;
  letter-spacing: 3px;
  background-color: #aaaaaa;
  color: #666666;
}

tbody output {
  border-radius: 0.3em;
  padding: 3px;
}

tr:not(.primary) .name,
tr:not(.primary) .value {
  opacity: 0.3;
}

tr:nth-child(2n) {
  background-color: #eeeeee;
}

.tableHeader {
  color: #666666;
}

.tableTitle {
  display: flex;
  flex-direction: row;
  align-items: center;
  padding: 4px;
}

#slotContainer {
  flex: 1;
}

p {
  display: inline;
  margin: 0;
  padding: 0;
  padding-right: 10px;
}

#poll:empty::after,
#focus:empty::after {
  content: '\u2717';
  color: #ff0000;
}
`,nn=class{constructor(t){this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null,this.pollable=t}get running(){return this.animationFrameHandle!==null}start(){let t=this.animationFrameHandle;t&&cancelAnimationFrame(t),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}stop(){let t=this.animationFrameHandle;t&&cancelAnimationFrame(t),this.animationFrameHandle=null}onAnimationFrame(t){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.pollable.onPoll(t)}},rn=class{constructor(t){this.onInput=this.onInput.bind(this),this.onPoll=this.onPoll.bind(this),this.bindings=t}onPoll(t){for(let n of this.bindings.getInputs())n.onPoll(t)}onInput(t){let{device:n,code:r,event:i,value:s,movement:a,control:l,shift:o,alt:u}=t,c=this.bindings.getBindings(n,r);switch(i){case"pressed":for(let{input:f,index:h}of c)f.onUpdate(h,1,1);break;case"released":for(let{input:f,index:h}of c)f.onUpdate(h,0,-1);break;case"move":for(let{input:f,index:h}of c)f.onUpdate(h,s,a);break;case"wheel":for(let{input:f,index:h}of c)f.onUpdate(h,void 0,a);break}return c.length>0}},mt=class{constructor(t,n,r,i){this.device=t,this.code=n,this.input=r,this.index=i}},sn=class{constructor(){this.bindingMap={},this.inputMap=new Map}clear(){for(let t of this.inputMap.keys())t.onUnbind();this.inputMap.clear(),this.bindingMap={}}bind(t,n,r,i={inverted:!1}){let s,a=this.inputMap;if(a.has(t)){let o=a.get(t),u=t.size;t.onBind(u,i),s=new mt(n,r,t,u),o.push(s)}else{let o=[];a.set(t,o);let u=0;t.onBind(u,i),s=new mt(n,r,t,u),o.push(s)}let l=this.bindingMap;n in l?r in l[n]?l[n][r].push(s):l[n][r]=[s]:l[n]={[r]:[s]}}unbind(t){let n=this.inputMap;if(n.has(t)){let r=this.bindingMap,i=n.get(t);for(let s of i){let{device:a,code:l}=s,o=r[a][l],u=o.indexOf(s);o.splice(u,1)}i.length=0,t.onUnbind(),n.delete(t)}}isBound(t){return this.inputMap.has(t)}getInputs(){return this.inputMap.keys()}getBindingsByInput(t){return this.inputMap.get(t)}getBindings(t,n){let r=this.bindingMap;if(t in r){let i=r[t];if(n in i)return i[n]}return[]}},an=class{constructor(t,n={}){this.inputs={},this.devices=[new tn("Mouse",t),new en("Keyboard",t)],this.bindings=new sn,this.adapter=new rn(this.bindings),this.autopoller=new nn(this.adapter),this.eventTarget=t,this.anyButton=new ze(1),this.anyButtonDevice="",this.anyButtonCode="",this.anyAxis=new Ie(1),this.anyAxisDevice="",this.anyAxisCode="",this.listeners={bind:[],unbind:[],focus:[],blur:[]},this.onInput=this.onInput.bind(this),this.onEventTargetBlur=this.onEventTargetBlur.bind(this),this.onEventTargetFocus=this.onEventTargetFocus.bind(this),t.addEventListener("focus",this.onEventTargetFocus),t.addEventListener("blur",this.onEventTargetBlur);for(let r of this.devices)r.addEventListener("input",this.onInput)}get autopoll(){return this.autopoller.running}set autopoll(t){this.toggleAutoPoll(t)}destroy(){let t=this.listeners;for(let r in t)t[r].length=0;this.autopoller.running&&this.autopoller.stop();for(let r of this.devices)r.removeEventListener("input",this.onInput),r.destroy();let n=this.eventTarget;n.removeEventListener("focus",this.onEventTargetFocus),n.removeEventListener("blur",this.onEventTargetBlur)}setEventTarget(t){let n=this.eventTarget;n.removeEventListener("focus",this.onEventTargetFocus),n.removeEventListener("blur",this.onEventTargetBlur),this.eventTarget=t;for(let r of this.devices)r.setEventTarget(t);t.addEventListener("focus",this.onEventTargetFocus),t.addEventListener("blur",this.onEventTargetBlur)}toggleAutoPoll(t=void 0){let n=this.autopoller.running,r=typeof t=="undefined"?!n:Boolean(t);r!==n&&(r?this.autopoller.start():this.autopoller.stop())}addEventListener(t,n){let r=this.listeners;t in r?r[t].push(n):r[t]=[n]}removeEventListener(t,n){let r=this.listeners;if(t in r){let i=r[t],s=i.indexOf(n);s>=0&&i.splice(s,1)}}dispatchEvent(t){let{type:n}=t,r=0;for(let i of this.listeners[n])r|=i(t)?1:0;return Boolean(r)}poll(t=performance.now()){if(this.autopoller.running)throw new Error("Should not manually poll() while autopolling.");this.onPoll(t)}onInput(t){let n=this.adapter.onInput(t);switch(t.event){case"pressed":this.anyButtonDevice=t.device,this.anyButtonCode=t.code,this.anyButton.onUpdate(0,1,1);break;case"released":this.anyButtonDevice=t.device,this.anyButtonCode=t.code,this.anyButton.onUpdate(0,0,-1);break;case"move":case"wheel":this.anyAxisDevice=t.device,this.anyAxisCode=t.code,this.anyAxis.onUpdate(0,t.value,t.movement);break}return n}onPoll(t){this.adapter.onPoll(t),this.anyButton.onPoll(t),this.anyAxis.onPoll(t)}onBind(){this.dispatchEvent({type:"bind"})}onUnbind(){this.dispatchEvent({type:"unbind"})}onEventTargetFocus(){this.dispatchEvent({type:"focus"})}onEventTargetBlur(){for(let t of this.bindings.getInputs())t.onStatus(0,0);this.anyButton.onStatus(0,0),this.anyAxis.onStatus(0,0),this.dispatchEvent({type:"blur"})}bindBindings(t){for(let n of t)n.register(this)}bindButton(t,n,r,i=void 0){let s;this.hasButton(t)?s=this.getButton(t):(s=new ze(1),this.inputs[t]=s),this.bindings.bind(s,n,r,i),this.onBind()}bindAxis(t,n,r,i=void 0){let s;this.hasAxis(t)?s=this.getAxis(t):(s=new Ie(1),this.inputs[t]=s),this.bindings.bind(s,n,r,i),this.onBind()}bindAxisButtons(t,n,r,i){let s;this.hasAxis(t)?s=this.getAxis(t):(s=new Ie(2),this.inputs[t]=s),this.bindings.bind(s,n,i),this.bindings.bind(s,n,r,{inverted:!0}),this.onBind()}unbindButton(t){if(this.hasButton(t)){let n=this.getButton(t);delete this.inputs[t],this.bindings.unbind(n),this.onUnbind()}}unbindAxis(t){if(this.hasAxis(t)){let n=this.getAxis(t);delete this.inputs[t],this.bindings.unbind(n),this.onUnbind()}}getInput(t){return this.inputs[t]}getButton(t){return this.inputs[t]}getAxis(t){return this.inputs[t]}hasButton(t){return t in this.inputs&&this.inputs[t]instanceof ze}hasAxis(t){return t in this.inputs&&this.inputs[t]instanceof Ie}isButtonDown(t){return this.inputs[t].down}isButtonPressed(t){return this.inputs[t].pressed}isButtonReleased(t){return this.inputs[t].released}getInputValue(t){return this.inputs[t].value}getButtonValue(t){return this.inputs[t].value}getAxisValue(t){return this.inputs[t].value}getAxisDelta(t){return this.inputs[t].delta}isAnyButtonDown(t=void 0){if(typeof t=="undefined")return this.anyButton.down;{let n=this.inputs;for(let r of t)if(n[r].down)return!0}return!1}isAnyButtonPressed(t=void 0){if(typeof t=="undefined")return this.anyButton.pressed;{let n=this.inputs;for(let r of t)if(n[r].pressed)return!0}return!1}isAnyButtonReleased(t=void 0){if(typeof t=="undefined")return this.anyButton.released;{let n=this.inputs;for(let r of t)if(n[r].released)return!0}return!1}getAnyAxisValue(t=void 0){if(typeof t=="undefined")return this.anyAxis.value;{let n=this.inputs;for(let r of t){let i=n[r];if(i.value)return i.value}}return 0}getAnyAxisDelta(t=void 0){if(typeof t=="undefined")return this.anyAxis.delta;{let n=this.inputs;for(let r of t){let i=n[r];if(i.delta)return i.delta}}return 0}getLastButtonDevice(){return this.anyButtonDevice}getLastButtonCode(){return this.anyButtonCode}getLastAxisDevice(){return this.anyAxisDevice}getLastAxisCode(){return this.anyAxisCode}getMouse(){return this.devices[0]}getKeyboard(){return this.devices[1]}},on=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=os,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=ls,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("input-port",this)}static get observedAttributes(){return["autopoll","for"]}get autopoll(){return this._autopoll}set autopoll(t){this.toggleAttribute("autopoll",t)}get for(){return this._for}set for(t){this.setAttribute("for",t)}constructor(){super();let t=this.attachShadow({mode:"open"});t.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),t.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._titleElement=t.querySelector("#title"),this._pollElement=t.querySelector("#poll"),this._focusElement=t.querySelector("#focus"),this._bodyElement=t.querySelector("tbody"),this._outputElements={},this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null;let n=this;this._for="",this._eventTarget=n,this._autopoll=!1,this._context=null,this.onInputContextBind=this.onInputContextBind.bind(this),this.onInputContextUnbind=this.onInputContextUnbind.bind(this),this.onInputContextFocus=this.onInputContextFocus.bind(this),this.onInputContextBlur=this.onInputContextBlur.bind(this)}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"for")){let t=this.for;delete this.for,this.for=t}if(Object.prototype.hasOwnProperty.call(this,"autopoll")){let t=this.autopoll;delete this.autopoll,this.autopoll=t}this.updateTable(),this.updateTableValues(),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}disconnectedCallback(){let t=this._context;t&&(t.removeEventListener("bind",this.onInputContextBind),t.removeEventListener("unbind",this.onInputContextUnbind),t.removeEventListener("blur",this.onInputContextBlur),t.removeEventListener("focus",this.onInputContextFocus),t.destroy(),this._context=null)}attributeChangedCallback(t,n,r){switch(t){case"for":{this._for=r;let i,s;r?(i=document.getElementById(r),s=`${i.tagName.toLowerCase()}#${r}`):(i=this,s="input-port"),this._eventTarget=i,this._context&&this._context.setEventTarget(this._eventTarget),this._titleElement.innerHTML=`for ${s}`}break;case"autopoll":this._autopoll=r!==null,this._context&&this._context.toggleAutoPoll(this._autopoll);break}}onAnimationFrame(){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.updateTableValues(),this.updatePollStatus()}onInputContextBind(){return this.updateTable(),!0}onInputContextUnbind(){return this.updateTable(),!0}onInputContextFocus(){return this._focusElement.innerHTML="\u2713",!0}onInputContextBlur(){return this._focusElement.innerHTML="",!0}getContext(t="axisbutton",n=void 0){switch(t){case"axisbutton":if(!this._context){let r=new an(this._eventTarget,n);r.addEventListener("bind",this.onInputContextBind),r.addEventListener("unbind",this.onInputContextUnbind),r.addEventListener("blur",this.onInputContextBlur),r.addEventListener("focus",this.onInputContextFocus),this._autopoll&&r.toggleAutoPoll(!0),this._context=r}return this._context;default:throw new Error(`Input context id '${t}' is not supported.`)}}updateTable(){if(this.isConnected)if(this._context){let t=this._context,n=t.inputs,r=t.bindings,i={},s=[];for(let a of Object.keys(n)){let l=n[a],o=!0;for(let u of r.getBindingsByInput(l)){let c=us(`${l.constructor.name}.${a}`,`${u.device}.${u.code}`,0,o);s.push(c),o&&(i[a]=c.querySelector("output"),o=!1)}}this._outputElements=i,this._bodyElement.innerHTML="";for(let a of s)this._bodyElement.appendChild(a)}else{this._outputElements={},this._bodyElement.innerHTML="";return}else return}updateTableValues(){if(this.isConnected)if(this._context){let n=this._context.inputs;for(let r of Object.keys(this._outputElements)){let i=this._outputElements[r],s=n[r].value;i.innerText=Number(s).toFixed(2)}}else{for(let t of Object.keys(this._outputElements)){let n=this._outputElements[t];n.innerText="---"}return}else return}updatePollStatus(){if(this.isConnected)if(this._context){let n=this._context.inputs;for(let r of Object.values(n))if(!r.polling){this._pollElement.innerHTML="";return}this._pollElement.innerHTML="\u2713"}else{this._pollElement.innerHTML="-";return}else return}};on.define();function us(e,t,n,r=!0){let i=document.createElement("tr");r&&i.classList.add("primary");{let s=document.createElement("td");s.textContent=e,s.classList.add("name"),i.appendChild(s)}{let s=document.createElement("td"),a=document.createElement("output");r?a.innerText=Number(n).toFixed(2):a.innerText="---",a.classList.add("value"),s.appendChild(a),i.appendChild(s)}{let s=document.createElement("td");s.classList.add("key");let a=new vt;a.innerText=t,s.appendChild(a),i.appendChild(s)}return i}var Kl=Symbol("keyboardSource");var Yl=Symbol("mouseSource");var oa=Nr(Fn());var Hn={},Vs=function(e,t,n,r,i){var s=new Worker(Hn[t]||(Hn[t]=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))));return s.onerror=function(a){return i(a.error,null)},s.onmessage=function(a){return i(null,a.data)},s.postMessage(n,r),s},J=Uint8Array,fe=Uint16Array,Be=Uint32Array,It=new J([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Ct=new J([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),kn=new J([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),zn=function(e,t){for(var n=new fe(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];for(var i=new Be(n[30]),r=1;r<30;++r)for(var s=n[r];s<n[r+1];++s)i[s]=s-n[r]<<5|r;return[n,i]},Kn=zn(It,2),Ot=Kn[0],Ws=Kn[1];Ot[28]=258,Ws[258]=28;var Yn=zn(Ct,0),Gn=Yn[0],Ql=Yn[1],qe=new fe(32768);for(var Y=0;Y<32768;++Y)me=(Y&43690)>>>1|(Y&21845)<<1,me=(me&52428)>>>2|(me&13107)<<2,me=(me&61680)>>>4|(me&3855)<<4,qe[Y]=((me&65280)>>>8|(me&255)<<8)>>>1;var me,Se=function(e,t,n){for(var r=e.length,i=0,s=new fe(t);i<r;++i)++s[e[i]-1];var a=new fe(t);for(i=0;i<t;++i)a[i]=a[i-1]+s[i-1]<<1;var l;if(n){l=new fe(1<<t);var o=15-t;for(i=0;i<r;++i)if(e[i])for(var u=i<<4|e[i],c=t-e[i],f=a[e[i]-1]++<<c,h=f|(1<<c)-1;f<=h;++f)l[qe[f]>>>o]=u}else for(l=new fe(r),i=0;i<r;++i)e[i]&&(l[i]=qe[a[e[i]-1]++]>>>15-e[i]);return l},Ne=new J(288);for(var Y=0;Y<144;++Y)Ne[Y]=8;for(var Y=144;Y<256;++Y)Ne[Y]=9;for(var Y=256;Y<280;++Y)Ne[Y]=7;for(var Y=280;Y<288;++Y)Ne[Y]=8;var $n=new J(32);for(var Y=0;Y<32;++Y)$n[Y]=5;var Vn=Se(Ne,9,1);var Wn=Se($n,5,1),Xe=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},re=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(t&7)&n},Ze=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(t&7)},jn=function(e){return(e/8|0)+(e&7&&1)},Qe=function(e,t,n){(t==null||t<0)&&(t=0),(n==null||n>e.length)&&(n=e.length);var r=new(e instanceof fe?fe:e instanceof Be?Be:J)(n-t);return r.set(e.subarray(t,n)),r},qn=function(e,t,n){var r=e.length;if(!r||n&&!n.l&&r<5)return t||new J(0);var i=!t||n,s=!n||n.i;n||(n={}),t||(t=new J(r*3));var a=function(U){var ye=t.length;if(U>ye){var Ue=new J(Math.max(ye*2,U));Ue.set(t),t=Ue}},l=n.f||0,o=n.p||0,u=n.b||0,c=n.l,f=n.d,h=n.m,d=n.n,v=r*8;do{if(!c){n.f=l=re(e,o,1);var m=re(e,o+1,3);if(o+=3,m)if(m==1)c=Vn,f=Wn,h=9,d=5;else if(m==2){var y=re(e,o,31)+257,T=re(e,o+10,15)+4,w=y+re(e,o+5,31)+1;o+=14;for(var R=new J(w),N=new J(19),g=0;g<T;++g)N[kn[g]]=re(e,o+g*3,7);o+=T*3;for(var C=Xe(N),P=(1<<C)-1,A=Se(N,C,1),g=0;g<w;){var B=A[re(e,o,P)];o+=B&15;var p=B>>>4;if(p<16)R[g++]=p;else{var O=0,D=0;for(p==16?(D=3+re(e,o,3),o+=2,O=R[g-1]):p==17?(D=3+re(e,o,7),o+=3):p==18&&(D=11+re(e,o,127),o+=7);D--;)R[g++]=O}}var _=R.subarray(0,y),E=R.subarray(y);h=Xe(_),d=Xe(E),c=Se(_,h,1),f=Se(E,d,1)}else throw"invalid block type";else{var p=jn(o)+4,x=e[p-4]|e[p-3]<<8,L=p+x;if(L>r){if(s)throw"unexpected EOF";break}i&&a(u+x),t.set(e.subarray(p,L),u),n.b=u+=x,n.p=o=L*8;continue}if(o>v){if(s)throw"unexpected EOF";break}}i&&a(u+131072);for(var G=(1<<h)-1,H=(1<<d)-1,q=o;;q=o){var O=c[Ze(e,o)&G],X=O>>>4;if(o+=O&15,o>v){if(s)throw"unexpected EOF";break}if(!O)throw"invalid length/literal";if(X<256)t[u++]=X;else if(X==256){q=o,c=null;break}else{var Z=X-254;if(X>264){var g=X-257,le=It[g];Z=re(e,o,(1<<le)-1)+Ot[g],o+=le}var Le=f[Ze(e,o)&H],_e=Le>>>4;if(!Le)throw"invalid distance";o+=Le&15;var E=Gn[_e];if(_e>3){var le=Ct[_e];E+=Ze(e,o)&(1<<le)-1,o+=le}if(o>v){if(s)throw"unexpected EOF";break}i&&a(u+131072);for(var ue=u+Z;u<ue;u+=4)t[u]=t[u-E],t[u+1]=t[u+1-E],t[u+2]=t[u+2-E],t[u+3]=t[u+3-E];u=ue}}n.l=c,n.p=q,n.b=u,c&&(l=1,n.m=h,n.d=f,n.n=d)}while(!l);return u==t.length?t:Qe(t,0,u)};var js=new J(0);var qs=function(e,t){var n={};for(var r in e)n[r]=e[r];for(var r in t)n[r]=t[r];return n},Xn=function(e,t,n){for(var r=e(),i=e.toString(),s=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/ /g,"").split(","),a=0;a<r.length;++a){var l=r[a],o=s[a];if(typeof l=="function"){t+=";"+o+"=";var u=l.toString();if(l.prototype)if(u.indexOf("[native code]")!=-1){var c=u.indexOf(" ",8)+1;t+=u.slice(c,u.indexOf("(",c))}else{t+=u;for(var f in l.prototype)t+=";"+o+".prototype."+f+"="+l.prototype[f].toString()}else t+=u}else n[o]=l}return[t,n]},Je=[],Xs=function(e){var t=[];for(var n in e)(e[n]instanceof J||e[n]instanceof fe||e[n]instanceof Be)&&t.push((e[n]=new e[n].constructor(e[n])).buffer);return t},Zs=function(e,t,n,r){var i;if(!Je[n]){for(var s="",a={},l=e.length-1,o=0;o<l;++o)i=Xn(e[o],s,a),s=i[0],a=i[1];Je[n]=Xn(e[l],s,a)}var u=qs({},Je[n][1]);return Vs(Je[n][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",n,u,Xs(u),r)},Qs=function(){return[J,fe,Be,It,Ct,kn,Ot,Gn,Vn,Wn,qe,Se,Xe,re,Ze,jn,Qe,qn,Bt,Zn,Qn]};var Zn=function(e){return postMessage(e,[e.buffer])},Qn=function(e){return e&&e.size&&new J(e.size)},Js=function(e,t,n,r,i,s){var a=Zs(n,r,i,function(l,o){a.terminate(),s(l,o)});return a.postMessage([e,t],t.consume?[e.buffer]:[]),function(){a.terminate()}};var he=function(e,t){return e[t]|e[t+1]<<8},ae=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0},Nt=function(e,t){return ae(e,t)+ae(e,t+4)*4294967296};function ea(e,t,n){if(n||(n=t,t={}),typeof n!="function")throw"no callback";return Js(e,t,[Qs],function(r){return Zn(Bt(r.data[0],Qn(r.data[1])))},1,n)}function Bt(e,t){return qn(e,t)}var Jl=typeof TextEncoder!="undefined"&&new TextEncoder,Dt=typeof TextDecoder!="undefined"&&new TextDecoder,ta=0;try{Dt.decode(js,{stream:!0}),ta=1}catch(e){}var na=function(e){for(var t="",n=0;;){var r=e[n++],i=(r>127)+(r>223)+(r>239);if(n+i>e.length)return[t,Qe(e,n-1)];i?i==3?(r=((r&15)<<18|(e[n++]&63)<<12|(e[n++]&63)<<6|e[n++]&63)-65536,t+=String.fromCharCode(55296|r>>10,56320|r&1023)):i&1?t+=String.fromCharCode((r&31)<<6|e[n++]&63):t+=String.fromCharCode((r&15)<<12|(e[n++]&63)<<6|e[n++]&63):t+=String.fromCharCode(r)}};function ra(e,t){if(t){for(var n="",r=0;r<e.length;r+=16384)n+=String.fromCharCode.apply(null,e.subarray(r,r+16384));return n}else{if(Dt)return Dt.decode(e);var i=na(e),s=i[0],a=i[1];if(a.length)throw"invalid utf-8 data";return s}}var ia=function(e,t){return t+30+he(e,t+26)+he(e,t+28)},aa=function(e,t,n){var r=he(e,t+28),i=ra(e.subarray(t+46,t+46+r),!(he(e,t+8)&2048)),s=t+46+r,a=ae(e,t+20),l=n&&a==4294967295?sa(e,s):[a,ae(e,t+24),ae(e,t+42)],o=l[0],u=l[1],c=l[2];return[he(e,t+10),o,u,i,s+he(e,t+30)+he(e,t+32),c]},sa=function(e,t){for(;he(e,t)!=1;t+=4+he(e,t+2));return[Nt(e,t+12),Nt(e,t+4),Nt(e,t+20)]};function Pt(e,t){if(typeof t!="function")throw"no callback";for(var n=[],r=function(){for(var h=0;h<n.length;++h)n[h]()},i={},s=e.length-22;ae(e,s)!=101010256;--s)if(!s||e.length-s>65558){t("invalid zip file",null);return}var a=he(e,s+8);a||t(null,{});var l=a,o=ae(e,s+16),u=o==4294967295;if(u){if(s=ae(e,s-12),ae(e,s)!=101075792){t("invalid zip file",null);return}l=a=ae(e,s+32),o=ae(e,s+48)}for(var c=function(h){var d=aa(e,o,u),v=d[0],m=d[1],p=d[2],x=d[3],L=d[4],y=d[5],T=ia(e,y);o=L;var w=function(N,g){N?(r(),t(N,null)):(i[x]=g,--a||t(null,i))};if(!v)w(null,Qe(e,T,T+m));else if(v==8){var R=e.subarray(T,T+m);if(m<32e4)try{w(null,Bt(R,new J(p)))}catch(N){w(N,null)}else n.push(ea(R,{size:p},w))}else w("unknown compression type "+v,null)},f=0;f<l;++f)c(f);return r}var la=/^([_\w\d]+)\:\/\//,Jn=5e3;async function ua(e,t,n,r,i=Jn){let{cache:s,loadings:a}=e;if(t in s)return s[t];let l;if(t in a){if(l=a[t],l.active)return a[t].promise}else l=new Ut(i),a[t]=l;let o=[l.promise];return la.test(n)?o.push(er(e,n,i).then(u=>r(u)).then(u=>Re(e,t,u))):o.push(fetch(n).then(u=>u.arrayBuffer()).then(u=>r(u)).then(u=>Re(e,t,u))),await Promise.race(o)}function Re(e,t,n){let{cache:r,loadings:i}=e;return r[t]=n,t in i&&(i[t].resolve(n),delete i[t]),n}function ca(e,t){let{cache:n,loadings:r}=e;t in r&&(r[t].reject(new Error("Stop loading to delete asset.")),delete r[t]),t in n&&delete n[t]}async function er(e,t,n=Jn){let{cache:r,loadings:i}=e;if(t in r)return r[t];if(t in i)return i[t].promise;{let s=new Ut(n);return i[t]=s,s.promise}}function fa(e,t){let{defaults:n}=e;for(let r of n)if(r.glob.test(t))return Ft(e,r.uri);return null}function Ft(e,t){return e.cache[t]}function ha(e){return Object.keys(e.cache)}var Ut=class{constructor(t){this.active=!1,this._resolve=null,this._reject=null,this._reason=null,this._value=null,this._timeoutHandle=Number.isFinite(t)&&t>0?setTimeout(()=>{this.reject(`Asset loading exceeded timeout of ${t} ms.`)},t):null,this._promise=new Promise((n,r)=>{this._value?n(this._value):this._resolve=n,this._reason?r(this._reason):this._reject=r})}get promise(){return this._promise}resolve(t){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._resolve?this._resolve(t):this._value=t}reject(t){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._reject?this._reject(t):this._reason=t}},Ht=class{constructor(t,n,r){this.uri=t,this.source=n,this.loader=r,this.store=null}get current(){return Ft(this.store,this.uri)}set current(t){Re(this.store,this.uri,t)}get default(){return fa(this.store,this.uri)}get loaded(){return er(this.store,this.uri)}async preload(t,n=void 0,r=void 0){return this.store=t,typeof r!="undefined"?Re(t,this.uri,r):await ua(this.store,this.uri,this.source,this.loader,n),this}async unload(){return ca(this.store,this.uri),this.store=null,this}},pa=5e3,De={cache:{},loadings:{},defaults:[]};async function da(e,t=void 0){let n="raw://",i=await(await fetch(e)).arrayBuffer();await new Promise((s,a)=>{Pt(new Uint8Array(i),(l,o)=>{if(l)a(l);else{for(let[u,c]of Object.entries(o)){u=u.replaceAll("\\","/");let f=u.indexOf("/");f>=0&&(u=u.substring(f+1));let h=n+u;Re(De,h,c),t&&t(c,h,u)}s()}})})}async function va(e,t){let r=await(await fetch(e)).arrayBuffer();await new Promise((i,s)=>{Pt(new Uint8Array(r),(a,l)=>{if(a)s(a);else{for(let[o,u]of Object.entries(l))o=o.replaceAll("\\","/"),t(u,o);i()}})})}async function ma(e,t=pa){let n=[];for(let r of e)n.push(r.preload(De,t));await Promise.allSettled(n)}function _a(e,t){return Re(De,e,t)}function Ea(){return ha(De)}function Aa(e){return Ft(De,e)}var et=Object.freeze({__proto__:null,loadAssetPackAsRaw:da,loadAssetPack:va,loadAssetRefs:ma,cache:_a,keys:Ea,current:Aa});window.addEventListener("error",tt,!0);window.addEventListener("unhandledrejection",tt,!0);function tt(e){typeof e=="object"?e instanceof PromiseRejectionEvent?tt(e.reason):e instanceof ErrorEvent?tt(e.error):e instanceof Error?window.alert(e.stack):window.alert(JSON.stringify(e)):window.alert(e)}var pe={CursorX:new be("cursorX",[$.MOUSE_POS_X]),CursorY:new be("cursorY",[$.MOUSE_POS_Y]),CursorMain:new Q("cursorMain",$.MOUSE_BUTTON_0),CursorAlt:new Q("cursorAlt",$.MOUSE_BUTTON_2),MoveLeft:new Q("moveLeft",[$.KEY_A,$.ARROW_LEFT]),MoveRight:new Q("moveRight",[$.KEY_D,$.ARROW_RIGHT]),MoveUp:new Q("moveUp",[$.KEY_Q]),MoveDown:new Q("moveDown",[$.KEY_E]),MoveForward:new Q("moveForward",[$.KEY_W,$.ARROW_UP]),MoveBackward:new Q("moveBackward",[$.KEY_S,$.ARROW_DOWN]),MainAction:new Q("mainAction",[$.KEY_Z,$.KEY_Q]),AltAction:new Q("altAction",[$.KEY_X,$.KEY_E]),Evade:new Q("evade",[$.SPACE])};async function kt(e,t=void 0){if(typeof e=="string"){let l=await(await fetch(e)).arrayBuffer();if(typeof t=="undefined"){let o=e.lastIndexOf(".");if(o<0)throw new Error("Cannot load from url - unknown image type.");t="image/"+e.slice(o+1)}return kt(l,t)}else if(!(e instanceof ArrayBuffer||ArrayBuffer.isView(e)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let n=e;typeof t=="undefined"&&(t="image/png");let r=new Blob([n],{type:t}),i=URL.createObjectURL(r),s=new Image;return new Promise((a,l)=>{s.addEventListener("load",()=>{a(s)}),s.addEventListener("error",o=>{l(o)}),s.src=i})}var tr={ImageToast:new Ht("toast","res/toast.png",kt)};var Ae={};ke(Ae,{connectInputs:()=>xa,getDisplayPort:()=>wa,getInputPort:()=>ba,preloadAssetPack:()=>ya,preloadAssets:()=>ga});async function xa(e,t="input-port"){let r=document.querySelector(t).getContext("axisbutton");return r.bindBindings(Object.values(e)),r}async function ya(){await et.loadAssetPack("res.pack",(e,t)=>et.cache(t,e))}async function ga(e,t="asset-port"){await et.loadAssetRefs(Object.values(e))}function wa(e=document,t="display-port"){return e.querySelector(t)}function ba(e=document,t="input-port"){return e.querySelector(t)}var z=1e-6,ie=typeof Float32Array!="undefined"?Float32Array:Array,zt=Math.random;var hu=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var oe={};ke(oe,{add:()=>ao,adjoint:()=>Oa,clone:()=>Ma,copy:()=>Sa,create:()=>Ta,determinant:()=>Ba,equals:()=>co,exactEquals:()=>uo,frob:()=>so,fromQuat:()=>Za,fromQuat2:()=>Va,fromRotation:()=>Ka,fromRotationTranslation:()=>ir,fromRotationTranslationScale:()=>qa,fromRotationTranslationScaleOrigin:()=>Xa,fromScaling:()=>za,fromTranslation:()=>ka,fromValues:()=>Ra,fromXRotation:()=>Ya,fromYRotation:()=>Ga,fromZRotation:()=>$a,frustum:()=>Qa,getRotation:()=>ja,getScaling:()=>sr,getTranslation:()=>Wa,identity:()=>nr,invert:()=>Ca,lookAt:()=>no,mul:()=>fo,multiply:()=>rr,multiplyScalar:()=>oo,multiplyScalarAndAdd:()=>lo,ortho:()=>to,perspective:()=>Ja,perspectiveFromFieldOfView:()=>eo,rotate:()=>Pa,rotateX:()=>Ua,rotateY:()=>Fa,rotateZ:()=>Ha,scale:()=>Da,set:()=>La,str:()=>io,sub:()=>ho,subtract:()=>ar,targetTo:()=>ro,translate:()=>Na,transpose:()=>Ia});function Ta(){var e=new ie(16);return ie!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function Ma(e){var t=new ie(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Sa(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Ra(e,t,n,r,i,s,a,l,o,u,c,f,h,d,v,m){var p=new ie(16);return p[0]=e,p[1]=t,p[2]=n,p[3]=r,p[4]=i,p[5]=s,p[6]=a,p[7]=l,p[8]=o,p[9]=u,p[10]=c,p[11]=f,p[12]=h,p[13]=d,p[14]=v,p[15]=m,p}function La(e,t,n,r,i,s,a,l,o,u,c,f,h,d,v,m,p){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=s,e[5]=a,e[6]=l,e[7]=o,e[8]=u,e[9]=c,e[10]=f,e[11]=h,e[12]=d,e[13]=v,e[14]=m,e[15]=p,e}function nr(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ia(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],s=t[6],a=t[7],l=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=s,e[11]=t[14],e[12]=i,e[13]=a,e[14]=l}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function Ca(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=t[4],l=t[5],o=t[6],u=t[7],c=t[8],f=t[9],h=t[10],d=t[11],v=t[12],m=t[13],p=t[14],x=t[15],L=n*l-r*a,y=n*o-i*a,T=n*u-s*a,w=r*o-i*l,R=r*u-s*l,N=i*u-s*o,g=c*m-f*v,C=c*p-h*v,P=c*x-d*v,A=f*p-h*m,B=f*x-d*m,O=h*x-d*p,D=L*O-y*B+T*A+w*P-R*C+N*g;return D?(D=1/D,e[0]=(l*O-o*B+u*A)*D,e[1]=(i*B-r*O-s*A)*D,e[2]=(m*N-p*R+x*w)*D,e[3]=(h*R-f*N-d*w)*D,e[4]=(o*P-a*O-u*C)*D,e[5]=(n*O-i*P+s*C)*D,e[6]=(p*T-v*N-x*y)*D,e[7]=(c*N-h*T+d*y)*D,e[8]=(a*B-l*P+u*g)*D,e[9]=(r*P-n*B-s*g)*D,e[10]=(v*R-m*T+x*L)*D,e[11]=(f*T-c*R-d*L)*D,e[12]=(l*C-a*A-o*g)*D,e[13]=(n*A-r*C+i*g)*D,e[14]=(m*y-v*w-p*L)*D,e[15]=(c*w-f*y+h*L)*D,e):null}function Oa(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=t[4],l=t[5],o=t[6],u=t[7],c=t[8],f=t[9],h=t[10],d=t[11],v=t[12],m=t[13],p=t[14],x=t[15];return e[0]=l*(h*x-d*p)-f*(o*x-u*p)+m*(o*d-u*h),e[1]=-(r*(h*x-d*p)-f*(i*x-s*p)+m*(i*d-s*h)),e[2]=r*(o*x-u*p)-l*(i*x-s*p)+m*(i*u-s*o),e[3]=-(r*(o*d-u*h)-l*(i*d-s*h)+f*(i*u-s*o)),e[4]=-(a*(h*x-d*p)-c*(o*x-u*p)+v*(o*d-u*h)),e[5]=n*(h*x-d*p)-c*(i*x-s*p)+v*(i*d-s*h),e[6]=-(n*(o*x-u*p)-a*(i*x-s*p)+v*(i*u-s*o)),e[7]=n*(o*d-u*h)-a*(i*d-s*h)+c*(i*u-s*o),e[8]=a*(f*x-d*m)-c*(l*x-u*m)+v*(l*d-u*f),e[9]=-(n*(f*x-d*m)-c*(r*x-s*m)+v*(r*d-s*f)),e[10]=n*(l*x-u*m)-a*(r*x-s*m)+v*(r*u-s*l),e[11]=-(n*(l*d-u*f)-a*(r*d-s*f)+c*(r*u-s*l)),e[12]=-(a*(f*p-h*m)-c*(l*p-o*m)+v*(l*h-o*f)),e[13]=n*(f*p-h*m)-c*(r*p-i*m)+v*(r*h-i*f),e[14]=-(n*(l*p-o*m)-a*(r*p-i*m)+v*(r*o-i*l)),e[15]=n*(l*h-o*f)-a*(r*h-i*f)+c*(r*o-i*l),e}function Ba(e){var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],a=e[5],l=e[6],o=e[7],u=e[8],c=e[9],f=e[10],h=e[11],d=e[12],v=e[13],m=e[14],p=e[15],x=t*a-n*s,L=t*l-r*s,y=t*o-i*s,T=n*l-r*a,w=n*o-i*a,R=r*o-i*l,N=u*v-c*d,g=u*m-f*d,C=u*p-h*d,P=c*m-f*v,A=c*p-h*v,B=f*p-h*m;return x*B-L*A+y*P+T*C-w*g+R*N}function rr(e,t,n){var r=t[0],i=t[1],s=t[2],a=t[3],l=t[4],o=t[5],u=t[6],c=t[7],f=t[8],h=t[9],d=t[10],v=t[11],m=t[12],p=t[13],x=t[14],L=t[15],y=n[0],T=n[1],w=n[2],R=n[3];return e[0]=y*r+T*l+w*f+R*m,e[1]=y*i+T*o+w*h+R*p,e[2]=y*s+T*u+w*d+R*x,e[3]=y*a+T*c+w*v+R*L,y=n[4],T=n[5],w=n[6],R=n[7],e[4]=y*r+T*l+w*f+R*m,e[5]=y*i+T*o+w*h+R*p,e[6]=y*s+T*u+w*d+R*x,e[7]=y*a+T*c+w*v+R*L,y=n[8],T=n[9],w=n[10],R=n[11],e[8]=y*r+T*l+w*f+R*m,e[9]=y*i+T*o+w*h+R*p,e[10]=y*s+T*u+w*d+R*x,e[11]=y*a+T*c+w*v+R*L,y=n[12],T=n[13],w=n[14],R=n[15],e[12]=y*r+T*l+w*f+R*m,e[13]=y*i+T*o+w*h+R*p,e[14]=y*s+T*u+w*d+R*x,e[15]=y*a+T*c+w*v+R*L,e}function Na(e,t,n){var r=n[0],i=n[1],s=n[2],a,l,o,u,c,f,h,d,v,m,p,x;return t===e?(e[12]=t[0]*r+t[4]*i+t[8]*s+t[12],e[13]=t[1]*r+t[5]*i+t[9]*s+t[13],e[14]=t[2]*r+t[6]*i+t[10]*s+t[14],e[15]=t[3]*r+t[7]*i+t[11]*s+t[15]):(a=t[0],l=t[1],o=t[2],u=t[3],c=t[4],f=t[5],h=t[6],d=t[7],v=t[8],m=t[9],p=t[10],x=t[11],e[0]=a,e[1]=l,e[2]=o,e[3]=u,e[4]=c,e[5]=f,e[6]=h,e[7]=d,e[8]=v,e[9]=m,e[10]=p,e[11]=x,e[12]=a*r+c*i+v*s+t[12],e[13]=l*r+f*i+m*s+t[13],e[14]=o*r+h*i+p*s+t[14],e[15]=u*r+d*i+x*s+t[15]),e}function Da(e,t,n){var r=n[0],i=n[1],s=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Pa(e,t,n,r){var i=r[0],s=r[1],a=r[2],l=Math.hypot(i,s,a),o,u,c,f,h,d,v,m,p,x,L,y,T,w,R,N,g,C,P,A,B,O,D,_;return l<z?null:(l=1/l,i*=l,s*=l,a*=l,o=Math.sin(n),u=Math.cos(n),c=1-u,f=t[0],h=t[1],d=t[2],v=t[3],m=t[4],p=t[5],x=t[6],L=t[7],y=t[8],T=t[9],w=t[10],R=t[11],N=i*i*c+u,g=s*i*c+a*o,C=a*i*c-s*o,P=i*s*c-a*o,A=s*s*c+u,B=a*s*c+i*o,O=i*a*c+s*o,D=s*a*c-i*o,_=a*a*c+u,e[0]=f*N+m*g+y*C,e[1]=h*N+p*g+T*C,e[2]=d*N+x*g+w*C,e[3]=v*N+L*g+R*C,e[4]=f*P+m*A+y*B,e[5]=h*P+p*A+T*B,e[6]=d*P+x*A+w*B,e[7]=v*P+L*A+R*B,e[8]=f*O+m*D+y*_,e[9]=h*O+p*D+T*_,e[10]=d*O+x*D+w*_,e[11]=v*O+L*D+R*_,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function Ua(e,t,n){var r=Math.sin(n),i=Math.cos(n),s=t[4],a=t[5],l=t[6],o=t[7],u=t[8],c=t[9],f=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*i+u*r,e[5]=a*i+c*r,e[6]=l*i+f*r,e[7]=o*i+h*r,e[8]=u*i-s*r,e[9]=c*i-a*r,e[10]=f*i-l*r,e[11]=h*i-o*r,e}function Fa(e,t,n){var r=Math.sin(n),i=Math.cos(n),s=t[0],a=t[1],l=t[2],o=t[3],u=t[8],c=t[9],f=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i-u*r,e[1]=a*i-c*r,e[2]=l*i-f*r,e[3]=o*i-h*r,e[8]=s*r+u*i,e[9]=a*r+c*i,e[10]=l*r+f*i,e[11]=o*r+h*i,e}function Ha(e,t,n){var r=Math.sin(n),i=Math.cos(n),s=t[0],a=t[1],l=t[2],o=t[3],u=t[4],c=t[5],f=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i+u*r,e[1]=a*i+c*r,e[2]=l*i+f*r,e[3]=o*i+h*r,e[4]=u*i-s*r,e[5]=c*i-a*r,e[6]=f*i-l*r,e[7]=h*i-o*r,e}function ka(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function za(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ka(e,t,n){var r=n[0],i=n[1],s=n[2],a=Math.hypot(r,i,s),l,o,u;return a<z?null:(a=1/a,r*=a,i*=a,s*=a,l=Math.sin(t),o=Math.cos(t),u=1-o,e[0]=r*r*u+o,e[1]=i*r*u+s*l,e[2]=s*r*u-i*l,e[3]=0,e[4]=r*i*u-s*l,e[5]=i*i*u+o,e[6]=s*i*u+r*l,e[7]=0,e[8]=r*s*u+i*l,e[9]=i*s*u-r*l,e[10]=s*s*u+o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function Ya(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ga(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function $a(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ir(e,t,n){var r=t[0],i=t[1],s=t[2],a=t[3],l=r+r,o=i+i,u=s+s,c=r*l,f=r*o,h=r*u,d=i*o,v=i*u,m=s*u,p=a*l,x=a*o,L=a*u;return e[0]=1-(d+m),e[1]=f+L,e[2]=h-x,e[3]=0,e[4]=f-L,e[5]=1-(c+m),e[6]=v+p,e[7]=0,e[8]=h+x,e[9]=v-p,e[10]=1-(c+d),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function Va(e,t){var n=new ie(3),r=-t[0],i=-t[1],s=-t[2],a=t[3],l=t[4],o=t[5],u=t[6],c=t[7],f=r*r+i*i+s*s+a*a;return f>0?(n[0]=(l*a+c*r+o*s-u*i)*2/f,n[1]=(o*a+c*i+u*r-l*s)*2/f,n[2]=(u*a+c*s+l*i-o*r)*2/f):(n[0]=(l*a+c*r+o*s-u*i)*2,n[1]=(o*a+c*i+u*r-l*s)*2,n[2]=(u*a+c*s+l*i-o*r)*2),ir(e,t,n),e}function Wa(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function sr(e,t){var n=t[0],r=t[1],i=t[2],s=t[4],a=t[5],l=t[6],o=t[8],u=t[9],c=t[10];return e[0]=Math.hypot(n,r,i),e[1]=Math.hypot(s,a,l),e[2]=Math.hypot(o,u,c),e}function ja(e,t){var n=new ie(3);sr(n,t);var r=1/n[0],i=1/n[1],s=1/n[2],a=t[0]*r,l=t[1]*i,o=t[2]*s,u=t[4]*r,c=t[5]*i,f=t[6]*s,h=t[8]*r,d=t[9]*i,v=t[10]*s,m=a+c+v,p=0;return m>0?(p=Math.sqrt(m+1)*2,e[3]=.25*p,e[0]=(f-d)/p,e[1]=(h-o)/p,e[2]=(l-u)/p):a>c&&a>v?(p=Math.sqrt(1+a-c-v)*2,e[3]=(f-d)/p,e[0]=.25*p,e[1]=(l+u)/p,e[2]=(h+o)/p):c>v?(p=Math.sqrt(1+c-a-v)*2,e[3]=(h-o)/p,e[0]=(l+u)/p,e[1]=.25*p,e[2]=(f+d)/p):(p=Math.sqrt(1+v-a-c)*2,e[3]=(l-u)/p,e[0]=(h+o)/p,e[1]=(f+d)/p,e[2]=.25*p),e}function qa(e,t,n,r){var i=t[0],s=t[1],a=t[2],l=t[3],o=i+i,u=s+s,c=a+a,f=i*o,h=i*u,d=i*c,v=s*u,m=s*c,p=a*c,x=l*o,L=l*u,y=l*c,T=r[0],w=r[1],R=r[2];return e[0]=(1-(v+p))*T,e[1]=(h+y)*T,e[2]=(d-L)*T,e[3]=0,e[4]=(h-y)*w,e[5]=(1-(f+p))*w,e[6]=(m+x)*w,e[7]=0,e[8]=(d+L)*R,e[9]=(m-x)*R,e[10]=(1-(f+v))*R,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function Xa(e,t,n,r,i){var s=t[0],a=t[1],l=t[2],o=t[3],u=s+s,c=a+a,f=l+l,h=s*u,d=s*c,v=s*f,m=a*c,p=a*f,x=l*f,L=o*u,y=o*c,T=o*f,w=r[0],R=r[1],N=r[2],g=i[0],C=i[1],P=i[2],A=(1-(m+x))*w,B=(d+T)*w,O=(v-y)*w,D=(d-T)*R,_=(1-(h+x))*R,E=(p+L)*R,G=(v+y)*N,H=(p-L)*N,q=(1-(h+m))*N;return e[0]=A,e[1]=B,e[2]=O,e[3]=0,e[4]=D,e[5]=_,e[6]=E,e[7]=0,e[8]=G,e[9]=H,e[10]=q,e[11]=0,e[12]=n[0]+g-(A*g+D*C+G*P),e[13]=n[1]+C-(B*g+_*C+H*P),e[14]=n[2]+P-(O*g+E*C+q*P),e[15]=1,e}function Za(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=n+n,l=r+r,o=i+i,u=n*a,c=r*a,f=r*l,h=i*a,d=i*l,v=i*o,m=s*a,p=s*l,x=s*o;return e[0]=1-f-v,e[1]=c+x,e[2]=h-p,e[3]=0,e[4]=c-x,e[5]=1-u-v,e[6]=d+m,e[7]=0,e[8]=h+p,e[9]=d-m,e[10]=1-u-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Qa(e,t,n,r,i,s,a){var l=1/(n-t),o=1/(i-r),u=1/(s-a);return e[0]=s*2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s*2*o,e[6]=0,e[7]=0,e[8]=(n+t)*l,e[9]=(i+r)*o,e[10]=(a+s)*u,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*s*2*u,e[15]=0,e}function Ja(e,t,n,r,i){var s=1/Math.tan(t/2),a;return e[0]=s/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==Infinity?(a=1/(r-i),e[10]=(i+r)*a,e[14]=2*i*r*a):(e[10]=-1,e[14]=-2*r),e}function eo(e,t,n,r){var i=Math.tan(t.upDegrees*Math.PI/180),s=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),l=Math.tan(t.rightDegrees*Math.PI/180),o=2/(a+l),u=2/(i+s);return e[0]=o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=u,e[6]=0,e[7]=0,e[8]=-((a-l)*o*.5),e[9]=(i-s)*u*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e}function to(e,t,n,r,i,s,a){var l=1/(t-n),o=1/(r-i),u=1/(s-a);return e[0]=-2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+n)*l,e[13]=(i+r)*o,e[14]=(a+s)*u,e[15]=1,e}function no(e,t,n,r){var i,s,a,l,o,u,c,f,h,d,v=t[0],m=t[1],p=t[2],x=r[0],L=r[1],y=r[2],T=n[0],w=n[1],R=n[2];return Math.abs(v-T)<z&&Math.abs(m-w)<z&&Math.abs(p-R)<z?nr(e):(c=v-T,f=m-w,h=p-R,d=1/Math.hypot(c,f,h),c*=d,f*=d,h*=d,i=L*h-y*f,s=y*c-x*h,a=x*f-L*c,d=Math.hypot(i,s,a),d?(d=1/d,i*=d,s*=d,a*=d):(i=0,s=0,a=0),l=f*a-h*s,o=h*i-c*a,u=c*s-f*i,d=Math.hypot(l,o,u),d?(d=1/d,l*=d,o*=d,u*=d):(l=0,o=0,u=0),e[0]=i,e[1]=l,e[2]=c,e[3]=0,e[4]=s,e[5]=o,e[6]=f,e[7]=0,e[8]=a,e[9]=u,e[10]=h,e[11]=0,e[12]=-(i*v+s*m+a*p),e[13]=-(l*v+o*m+u*p),e[14]=-(c*v+f*m+h*p),e[15]=1,e)}function ro(e,t,n,r){var i=t[0],s=t[1],a=t[2],l=r[0],o=r[1],u=r[2],c=i-n[0],f=s-n[1],h=a-n[2],d=c*c+f*f+h*h;d>0&&(d=1/Math.sqrt(d),c*=d,f*=d,h*=d);var v=o*h-u*f,m=u*c-l*h,p=l*f-o*c;return d=v*v+m*m+p*p,d>0&&(d=1/Math.sqrt(d),v*=d,m*=d,p*=d),e[0]=v,e[1]=m,e[2]=p,e[3]=0,e[4]=f*p-h*m,e[5]=h*v-c*p,e[6]=c*m-f*v,e[7]=0,e[8]=c,e[9]=f,e[10]=h,e[11]=0,e[12]=i,e[13]=s,e[14]=a,e[15]=1,e}function io(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function so(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function ao(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e}function ar(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}function oo(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e}function lo(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e[9]=t[9]+n[9]*r,e[10]=t[10]+n[10]*r,e[11]=t[11]+n[11]*r,e[12]=t[12]+n[12]*r,e[13]=t[13]+n[13]*r,e[14]=t[14]+n[14]*r,e[15]=t[15]+n[15]*r,e}function uo(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function co(e,t){var n=e[0],r=e[1],i=e[2],s=e[3],a=e[4],l=e[5],o=e[6],u=e[7],c=e[8],f=e[9],h=e[10],d=e[11],v=e[12],m=e[13],p=e[14],x=e[15],L=t[0],y=t[1],T=t[2],w=t[3],R=t[4],N=t[5],g=t[6],C=t[7],P=t[8],A=t[9],B=t[10],O=t[11],D=t[12],_=t[13],E=t[14],G=t[15];return Math.abs(n-L)<=z*Math.max(1,Math.abs(n),Math.abs(L))&&Math.abs(r-y)<=z*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(i-T)<=z*Math.max(1,Math.abs(i),Math.abs(T))&&Math.abs(s-w)<=z*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(a-R)<=z*Math.max(1,Math.abs(a),Math.abs(R))&&Math.abs(l-N)<=z*Math.max(1,Math.abs(l),Math.abs(N))&&Math.abs(o-g)<=z*Math.max(1,Math.abs(o),Math.abs(g))&&Math.abs(u-C)<=z*Math.max(1,Math.abs(u),Math.abs(C))&&Math.abs(c-P)<=z*Math.max(1,Math.abs(c),Math.abs(P))&&Math.abs(f-A)<=z*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(h-B)<=z*Math.max(1,Math.abs(h),Math.abs(B))&&Math.abs(d-O)<=z*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(v-D)<=z*Math.max(1,Math.abs(v),Math.abs(D))&&Math.abs(m-_)<=z*Math.max(1,Math.abs(m),Math.abs(_))&&Math.abs(p-E)<=z*Math.max(1,Math.abs(p),Math.abs(E))&&Math.abs(x-G)<=z*Math.max(1,Math.abs(x),Math.abs(G))}var fo=rr,ho=ar;var k={};ke(k,{add:()=>Eo,angle:()=>ko,bezier:()=>Oo,ceil:()=>Ao,clone:()=>po,copy:()=>mo,create:()=>or,cross:()=>Lo,dist:()=>jo,distance:()=>hr,div:()=>Wo,divide:()=>fr,dot:()=>vr,equals:()=>Go,exactEquals:()=>Yo,floor:()=>xo,forEach:()=>Qo,fromValues:()=>vo,hermite:()=>Co,inverse:()=>So,len:()=>Xo,length:()=>lr,lerp:()=>Io,max:()=>go,min:()=>yo,mul:()=>Vo,multiply:()=>cr,negate:()=>Mo,normalize:()=>Ro,random:()=>Bo,rotateX:()=>Uo,rotateY:()=>Fo,rotateZ:()=>Ho,round:()=>wo,scale:()=>bo,scaleAndAdd:()=>To,set:()=>_o,sqrDist:()=>qo,sqrLen:()=>Zo,squaredDistance:()=>pr,squaredLength:()=>dr,str:()=>Ko,sub:()=>$o,subtract:()=>ur,transformMat3:()=>Do,transformMat4:()=>No,transformQuat:()=>Po,zero:()=>zo});function or(){var e=new ie(3);return ie!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function po(e){var t=new ie(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function lr(e){var t=e[0],n=e[1],r=e[2];return Math.hypot(t,n,r)}function vo(e,t,n){var r=new ie(3);return r[0]=e,r[1]=t,r[2]=n,r}function mo(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function _o(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}function Eo(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function ur(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function cr(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}function fr(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}function Ao(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function xo(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function yo(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}function go(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}function wo(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function bo(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function To(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}function hr(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.hypot(n,r,i)}function pr(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i}function dr(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}function Mo(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function So(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function Ro(e,t){var n=t[0],r=t[1],i=t[2],s=n*n+r*r+i*i;return s>0&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e}function vr(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Lo(e,t,n){var r=t[0],i=t[1],s=t[2],a=n[0],l=n[1],o=n[2];return e[0]=i*o-s*l,e[1]=s*a-r*o,e[2]=r*l-i*a,e}function Io(e,t,n,r){var i=t[0],s=t[1],a=t[2];return e[0]=i+r*(n[0]-i),e[1]=s+r*(n[1]-s),e[2]=a+r*(n[2]-a),e}function Co(e,t,n,r,i,s){var a=s*s,l=a*(2*s-3)+1,o=a*(s-2)+s,u=a*(s-1),c=a*(3-2*s);return e[0]=t[0]*l+n[0]*o+r[0]*u+i[0]*c,e[1]=t[1]*l+n[1]*o+r[1]*u+i[1]*c,e[2]=t[2]*l+n[2]*o+r[2]*u+i[2]*c,e}function Oo(e,t,n,r,i,s){var a=1-s,l=a*a,o=s*s,u=l*a,c=3*s*l,f=3*o*a,h=o*s;return e[0]=t[0]*u+n[0]*c+r[0]*f+i[0]*h,e[1]=t[1]*u+n[1]*c+r[1]*f+i[1]*h,e[2]=t[2]*u+n[2]*c+r[2]*f+i[2]*h,e}function Bo(e,t){t=t||1;var n=zt()*2*Math.PI,r=zt()*2-1,i=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*i,e[1]=Math.sin(n)*i,e[2]=r*t,e}function No(e,t,n){var r=t[0],i=t[1],s=t[2],a=n[3]*r+n[7]*i+n[11]*s+n[15];return a=a||1,e[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/a,e[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/a,e[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/a,e}function Do(e,t,n){var r=t[0],i=t[1],s=t[2];return e[0]=r*n[0]+i*n[3]+s*n[6],e[1]=r*n[1]+i*n[4]+s*n[7],e[2]=r*n[2]+i*n[5]+s*n[8],e}function Po(e,t,n){var r=n[0],i=n[1],s=n[2],a=n[3],l=t[0],o=t[1],u=t[2],c=i*u-s*o,f=s*l-r*u,h=r*o-i*l,d=i*h-s*f,v=s*c-r*h,m=r*f-i*c,p=a*2;return c*=p,f*=p,h*=p,d*=2,v*=2,m*=2,e[0]=l+c+d,e[1]=o+f+v,e[2]=u+h+m,e}function Uo(e,t,n,r){var i=[],s=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=s[0]+n[0],e[1]=s[1]+n[1],e[2]=s[2]+n[2],e}function Fo(e,t,n,r){var i=[],s=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=s[0]+n[0],e[1]=s[1]+n[1],e[2]=s[2]+n[2],e}function Ho(e,t,n,r){var i=[],s=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],e[0]=s[0]+n[0],e[1]=s[1]+n[1],e[2]=s[2]+n[2],e}function ko(e,t){var n=e[0],r=e[1],i=e[2],s=t[0],a=t[1],l=t[2],o=Math.sqrt(n*n+r*r+i*i),u=Math.sqrt(s*s+a*a+l*l),c=o*u,f=c&&vr(e,t)/c;return Math.acos(Math.min(Math.max(f,-1),1))}function zo(e){return e[0]=0,e[1]=0,e[2]=0,e}function Ko(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function Yo(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function Go(e,t){var n=e[0],r=e[1],i=e[2],s=t[0],a=t[1],l=t[2];return Math.abs(n-s)<=z*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-a)<=z*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-l)<=z*Math.max(1,Math.abs(i),Math.abs(l))}var $o=ur,Vo=cr,Wo=fr,jo=hr,qo=pr,Xo=lr,Zo=dr,Qo=function(){var e=or();return function(t,n,r,i,s,a){var l,o;for(n||(n=3),r||(r=0),i?o=Math.min(i*n+r,t.length):o=t.length,l=r;l<o;l+=n)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],s(e,e,a),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2];return t}}();var xu=k.fromValues(0,1,0);var mr=class{constructor(t,n){this.projectionMatrix=t,this.viewMatrix=n}resize(t=void 0,n=void 0){return this}},Jo=Math.PI/3,Kt=class extends mr{constructor(t=Jo,n=.1,r=1e3){super(oe.create(),oe.create());this.fieldOfView=Number(t),this.clippingPlane={near:Number(n),far:Number(r)}}resize(t=void 0,n=void 0){let r=typeof t=="undefined"?1:t/n,{near:i,far:s}=this.clippingPlane;return oe.perspective(this.projectionMatrix,this.fieldOfView,r,i,s),this}};var _r=Math.PI/180,Yt=class{constructor(t={locky:!1}){this.locky=t.locky,this.position=k.create(),this.forward=k.fromValues(0,0,-1),this.right=k.fromValues(1,0,0),this.up=k.fromValues(0,1,0),this.forwardAmount=0,this.rightAmount=0,this.upAmount=0,this.pitch=0,this.yaw=-90}look(t,n,r=1){return r*=1e3,this.pitch=Math.min(89.9,Math.max(-89.9,this.pitch+n*r)),this.yaw=(this.yaw+t*r)%360,this}move(t,n=0,r=0,i=1){return this.forwardAmount+=t*i,this.rightAmount+=n*i,this.upAmount+=r*i,this}apply(t){let{position:n,forward:r,right:i,up:s,forwardAmount:a,rightAmount:l,upAmount:o,pitch:u,yaw:c}=this,f=c*_r,h=u*_r,d=Math.cos(f),v=Math.cos(h),m=Math.sin(f),p=Math.sin(h),x=d*v,L=p,y=m*v;k.normalize(r,k.set(r,x,this.locky?0:L,y)),k.normalize(i,k.cross(i,r,s));let T=k.create();k.scale(T,r,a),k.add(n,n,T),k.scale(T,i,l),k.add(n,n,T),k.scale(T,s,o),k.add(n,n,T),this.forwardAmount=0,this.rightAmount=0,this.upAmount=0,this.locky&&k.set(r,x,L,y);let w=k.add(T,n,r);return oe.lookAt(t,n,w,s),t}};function de(e){return typeof WebGL2RenderingContext!="undefined"&&e instanceof WebGL2RenderingContext}var xe={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,HALF_FLOAT:5131};function el(e,t){switch(t){case e.BYTE:return Int8Array;case e.UNSIGNED_BYTE:return Uint8Array;case e.SHORT:return Int16Array;case e.UNSIGNED_SHORT:return Uint16Array;case e.INT:return Int32Array;case e.UNSIGNED_INT:return Uint32Array;case e.FLOAT:return Float32Array;default:throw new Error(`Cannot find valid typed array for buffer type '${t}'.`)}}function Er(e,t){if(t instanceof Int8Array)return e.BYTE;if(t instanceof Uint8Array)return e.UNSIGNED_BYTE;if(t instanceof Int16Array)return e.SHORT;if(t instanceof Uint16Array)return e.UNSIGNED_SHORT;if(t instanceof Int32Array)return e.INT;if(t instanceof Uint32Array)return e.UNSIGNED_INT;if(t instanceof Float32Array)return e.FLOAT;throw new Error("Cannot find valid data type for buffer source.")}var tl={[xe.BYTE]:1,[xe.UNSIGNED_BYTE]:1,[xe.SHORT]:2,[xe.UNSIGNED_SHORT]:2,[xe.INT]:4,[xe.UNSIGNED_INT]:4,[xe.FLOAT]:4,[xe.HALF_FLOAT]:2};function Ar(e,t){return tl[t]}function nl(e,t){let n=[],r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<r;++i){let s=e.getActiveUniform(t,i);if(!s)break;n.push(s)}return n}function rl(e,t){let n=[],r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<r;++i){let s=e.getActiveAttrib(t,i);!s||n.push(s)}return n}function Gt(e,t){switch(t){case e.FLOAT:case e.INT:case e.UNSIGNED_INT:case e.BOOL:return 1;case e.FLOAT_VEC2:case e.INT_VEC2:case e.BOOL_VEC2:return 2;case e.FLOAT_VEC3:case e.INT_VEC3:case e.BOOL_VEC3:return 3;case e.FLOAT_VEC4:case e.INT_VEC4:case e.BOOL_VEC4:return 4;case e.FLOAT_MAT2:return 4;case e.FLOAT_MAT3:return 9;case e.FLOAT_MAT4:return 16;default:throw new Error("Invalid vertex attribute type.")}}function cl(e,t){switch(t){case e.FLOAT:case e.FLOAT_VEC2:case e.FLOAT_VEC3:case e.FLOAT_VEC4:return il}if(de(e)){let n=e;switch(t){case e.INT:case e.INT_VEC2:case e.INT_VEC3:case e.INT_VEC4:case e.BOOL:case e.BOOL_VEC2:case e.BOOL_VEC3:case e.BOOL_VEC4:return sl;case e.FLOAT_MAT2:return ol;case e.FLOAT_MAT3:return ll;case e.FLOAT_MAT4:return ul;case n.UNSIGNED_INT:case n.UNSIGNED_INT_VEC2:case n.UNSIGNED_INT_VEC3:case n.UNSIGNED_INT_VEC4:return al}}throw new Error("Cannot find attribute function for gl enum.")}function il(e,t,n,r,i=!1,s=0,a=0,l=void 0){if(this.bindBuffer(this.ARRAY_BUFFER,t),this.enableVertexAttribArray(e),this.vertexAttribPointer(e,n,r,i,s,a),l!==void 0){if(!de(this))throw new Error("Cannot use attribute divisor in WebGL 1.");this.vertexAttribDivisor(e,l)}}function sl(e,t,n,r,i=!1,s=0,a=0,l=void 0){if(!de(this))throw new Error("Cannot use attribute divisor in WebGL 1.");let o=this;o.bindBuffer(o.ARRAY_BUFFER,t),o.enableVertexAttribArray(e),o.vertexAttribIPointer(e,n,r,s,a),l!==void 0&&o.vertexAttribDivisor(e,l)}function al(e,t,n,r,i=!1,s=0,a=0,l=void 0){if(!de(this))throw new Error("Cannot use attribute divisor in WebGL 1.");let o=this;o.bindBuffer(o.ARRAY_BUFFER,t),o.enableVertexAttribArray(e),o.vertexAttribIPointer(e,n,r,s,a),l!==void 0&&o.vertexAttribDivisor(e,l)}function ol(e,t,n,r,i=!1,s=0,a=0,l=void 0){let o=Gt(this,this.FLOAT_MAT2),u=o*o;$t(u,o,e,t,n,r,i,s,a,l)}function ll(e,t,n,r,i=!1,s=0,a=0,l=void 0){let o=Gt(this,this.FLOAT_MAT3),u=o*o;$t(u,o,e,t,n,r,i,s,a,l)}function ul(e,t,n,r,i=!1,s=0,a=0,l=void 0){let o=Gt(this,this.FLOAT_MAT4),u=o*o;$t(u,o,e,t,n,r,i,s,a,l)}function $t(e,t,n,r,i,s,a,l,o,u){if(!de(this))throw new Error("Cannot use attribute divisor in WebGL 1.");let c=this;c.bindBuffer(c.ARRAY_BUFFER,r);let f=i/t,h=e*i,d=l/t;for(let v=0;v<t;++v){let m=n+v;c.enableVertexAttribArray(m),c.vertexAttribPointer(m,f,s,a,h,o+d*v),u!==void 0&&c.vertexAttribDivisor(m,u)}}function fl(e,t){let n={},r=rl(e,t);for(let i of r){let s=i.name,a=i.size,l=i.type,o=e.getAttribLocation(t,s),u=cl(e,l);n[s]={type:l,length:a,location:o,set:u}}return n}function hl(e,t,n){let r=e.createShader(t);if(e.shaderSource(r,n),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS)){let s=e.getShaderInfoLog(r)+`
Failed to compile shader:
${n}`;throw e.deleteShader(r),new Error(s)}return r}async function pl(e,t,n){for(let s of n)e.attachShader(t,s);e.linkProgram(t);let r=e.getExtension("KHR_parallel_shader_compile");if(r){let s=1e3/60,a;do await new Promise((l,o)=>setTimeout(l,s)),a=e.getProgramParameter(t,r.COMPLETION_STATUS_KHR);while(!a)}for(let s of n)e.detachShader(t,s),e.deleteShader(s);if(!e.getProgramParameter(t,e.LINK_STATUS)){let s=e.getProgramInfoLog(t);throw e.deleteProgram(t),new Error(s)}return t}function wl(e,t){let n=e;switch(t){case n.FLOAT:return n.uniform1f;case n.FLOAT_VEC2:return n.uniform2fv;case n.FLOAT_VEC3:return n.uniform3fv;case n.FLOAT_VEC4:return n.uniform4fv;case n.INT:return n.uniform1i;case n.INT_VEC2:return n.uniform2iv;case n.INT_VEC3:return n.uniform3iv;case n.INT_VEC4:return n.uniform4iv;case n.BOOL:return n.uniform1i;case n.BOOL_VEC2:return n.uniform2iv;case n.BOOL_VEC3:return n.uniform3iv;case n.BOOL_VEC4:return n.uniform4iv;case n.FLOAT_MAT2:return dl;case n.FLOAT_MAT3:return vl;case n.FLOAT_MAT4:return ml;case n.SAMPLER_2D:case n.SAMPLER_CUBE:return n.uniform1i}if(de(e)){let r=e;switch(t){case r.UNSIGNED_INT:return r.uniform1ui;case r.UNSIGNED_INT_VEC2:return r.uniform2uiv;case r.UNSIGNED_INT_VEC3:return r.uniform3uiv;case r.UNSIGNED_INT_VEC4:return r.uniform4uiv;case r.FLOAT_MAT2x3:return _l;case r.FLOAT_MAT2x4:return El;case r.FLOAT_MAT3x2:return Al;case r.FLOAT_MAT3x4:return xl;case r.FLOAT_MAT4x2:return yl;case r.FLOAT_MAT4x3:return gl;case r.SAMPLER_3D:case r.SAMPLER_2D_SHADOW:case r.SAMPLER_2D_ARRAY:case r.SAMPLER_2D_ARRAY_SHADOW:case r.SAMPLER_CUBE_SHADOW:case r.INT_SAMPLER_2D:case r.INT_SAMPLER_3D:case r.INT_SAMPLER_CUBE:case r.INT_SAMPLER_2D_ARRAY:case r.UNSIGNED_INT_SAMPLER_2D:case r.UNSIGNED_INT_SAMPLER_3D:case r.UNSIGNED_INT_SAMPLER_CUBE:case r.UNSIGNED_INT_SAMPLER_2D_ARRAY:return r.uniform1i}}throw new Error("Cannot find uniform function for gl enum.")}function dl(e,t){this.uniformMatrix2fv(e,!1,t)}function vl(e,t){this.uniformMatrix3fv(e,!1,t)}function ml(e,t){this.uniformMatrix4fv(e,!1,t)}function _l(e,t){this.uniformMatrix2x3fv(e,!1,t)}function El(e,t){this.uniformMatrix2x4fv(e,!1,t)}function Al(e,t){this.uniformMatrix3x2fv(e,!1,t)}function xl(e,t){this.uniformMatrix3x4fv(e,!1,t)}function yl(e,t){this.uniformMatrix4x2fv(e,!1,t)}function gl(e,t){this.uniformMatrix4x3fv(e,!1,t)}function bl(e,t){let n={},r=nl(e,t);for(let i of r){let s=i.name,a=i.size,l=i.type,o=e.getUniformLocation(t,s),u=wl(e,l);n[s]={type:l,length:a,location:o,set:u}}return n}function Tl(e,t){return{handle:t,attributes:fl(e,t),uniforms:bl(e,t)}}async function Ml(e,t,n,r=[e.VERTEX_SHADER,e.FRAGMENT_SHADER]){let i=0,s=[];for(let a of n){if(i>=r.length)throw new Error("Missing shader type for shader source.");let l=r[i++],o=hl(e,l,a);s.push(o)}return await pl(e,t,s),t}function xr(e,t,n){if("handle"in n&&n.handle instanceof WebGLVertexArrayObject){if(!de(e))throw new Error("Vertex array objects are only supported in WebGL 2.");let r=e,i=n;r.bindVertexArray(i.handle)}else{let r=n,i=t.attributes;for(let s in i){if(!(s in r.attributes))throw new Error(`Missing buffer for attribute '${s}'.`);let a=r.attributes[s],{location:l,set:o}=i[a.name];o.call(e,l,a.buffer,a.size,a.type,a.normalize,a.stride,a.offset,a.divisor)}r.element&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r.element.buffer)}}function Sl(e,t,n){let r=t.uniforms;for(let i in n){let s=n[i],{location:a,set:l}=r[i];l.call(e,a,s)}}var Pe=Object.freeze({__proto__:null,getProgramInfo:Tl,linkProgramShaders:Ml,bindProgramAttributes:xr,bindProgramUniforms:Sl});function Il(e,t,n=void 0){let r=Ll(e,t),i=Rl(e,n),s;if(i)s=i.length;else{let a=Object.keys(r);if(a.length>0){let l=r[a[0]];s=Math.trunc(l.length/l.size)}else s=0}return{attributes:r,element:i,vertexCount:s}}function Cl(e,t,n){if(!de(e))throw new Error("Vertex array objects is only supported on WebGL2.");let r=e,i=r.createVertexArray();r.bindVertexArray(i);for(let s of n)xr(r,s,t);return r.bindVertexArray(null),{handle:i,element:t.element,vertexCount:t.vertexCount}}function Ol(e,t,n=e.TRIANGLES,r=0,i=t.vertexCount,s=void 0){let a=t.element;if(a){let l=a.type;if(s!==void 0){if(!de(e))throw new Error("Instanced element drawing is only supported on WebGL2.");e.drawElementsInstanced(n,i,l,r,s)}else e.drawElements(n,i,l,r)}else if(s!==void 0){if(!de(e))throw new Error("Instanced array drawing is only supported on WebGL2.");e.drawArraysInstanced(n,r,i,s)}else e.drawArrays(n,r,i)}function Rl(e,t=void 0){if(!t)return null;if(typeof t!="object")throw new Error("Element attribute options must be an object.");let{type:n=e.UNSIGNED_SHORT,buffer:r,usage:i=e.STATIC_DRAW,length:s}=t;if(r instanceof WebGLBuffer)e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r);else if(ArrayBuffer.isView(r)){let a=r;r=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r),e.bufferData(e.ELEMENT_ARRAY_BUFFER,a,i),n===void 0&&(n=Er(e,a)),s===void 0&&(s=a.length)}else if(Array.isArray(r)){let a=r;r=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(a),i),s===void 0&&(s=a.length)}else if(typeof r=="number"){let a=r;r=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r),e.bufferData(e.ELEMENT_ARRAY_BUFFER,a,i),s===void 0&&(s=a)}else throw new Error("Invalid buffer for element attribute options.");if(n===void 0&&(n=e.UNSIGNED_SHORT),s===void 0){let a=e.getBufferParameter(e.ELEMENT_ARRAY_BUFFER,e.BUFFER_SIZE);s=Math.trunc(a/Ar(e,n))}return Bl(r,n,s)}function Ll(e,t){let n={};for(let r of Object.keys(t)){let i=t[r];if(!i)continue;if(typeof i!="object")throw new Error("Array attribute options must be an object.");let{name:s=r,buffer:a,size:l=3,type:o,normalize:u=!1,stride:c=0,offset:f=0,divisor:h=void 0,usage:d=e.STATIC_DRAW,length:v}=i;if(a instanceof WebGLBuffer)e.bindBuffer(e.ARRAY_BUFFER,a);else if(ArrayBuffer.isView(a)){let m=a;a=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,a),e.bufferData(e.ARRAY_BUFFER,m,d),o===void 0&&(o=Er(e,m)),v===void 0&&(v=m.length)}else if(Array.isArray(a)){let m=a;o===void 0&&(o=e.FLOAT),v===void 0&&(v=m.length),a=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,a);let p=el(e,o);e.bufferData(e.ARRAY_BUFFER,new p(m),d)}else if(typeof a=="number"){let m=a;a=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,a),e.bufferData(e.ARRAY_BUFFER,m,d),v===void 0&&(v=m)}else throw new Error("Invalid buffer for array attribute options.");if(o===void 0&&(o=e.FLOAT),v===void 0){let m=e.getBufferParameter(e.ARRAY_BUFFER,e.BUFFER_SIZE);v=Math.trunc(m/Ar(e,o))}l===void 0&&(l=Nl(s,v)),n[s]=Dl(s,a,v,l,o,u,c,f,h)}return n}function Nl(e,t){let n;if(e.includes("texcoord")?n=2:e.includes("color")?n=4:n=3,t%n!=0)throw new Error(`Could not determine vertex size - guessed ${n} but array length ${t} is not evenly divisible.`);return n}function Bl(e,t,n){return{buffer:e,type:t,length:n}}function Dl(e,t,n,r,i,s,a,l,o){return{name:e,buffer:t,length:n,size:r,type:i,normalize:s,stride:a,offset:l,divisor:o}}var nt=Object.freeze({__proto__:null,createBufferInfo:Il,createVertexArrayInfo:Cl,drawBufferInfo:Ol});function Vt(e=0,t=[],n=[],r=[],i=[]){return{vertexCount:e,indices:t,position:n,texcoord:r,normal:i}}function yr(e){return{vertexCount:e.vertexCount,indices:new Uint16Array(e.indices),position:new Float32Array(e.position),texcoord:new Float32Array(e.texcoord),normal:new Float32Array(e.normal)}}var gr=`#version 300 es

in vec3 a_position;
in vec2 a_texcoord;
in vec3 a_normal;

out vec2 v_texcoord;

uniform mat4 u_model;
uniform mat4 u_view;
uniform mat4 u_projection;

void main() {
    gl_Position = u_projection * u_view * u_model * vec4(a_position, 1.0);
    v_texcoord = a_texcoord;
}
`,wr=`#version 300 es

precision highp float;

in vec2 v_texcoord;

out vec4 out_FragColor;

uniform vec4 u_color;

void main() {
    out_FragColor = u_color;
}
`;function Tr(e=1,t=1,n=1,r=8,i=1,s=!1,a=0,l=Math.PI*2){let o=Vt();return Pl(o,e,t,n,r,i,a,l),s||(e>0&&br(o,!0,e,t,n,r,a,l),t>0&&br(o,!1,e,t,n,r,a,l)),o}function Pl(e,t,n,r,i,s,a,l){let o=r/2,u=(n-t)/r,c=[],f=k.create();for(let h=0;h<=s;++h){let d=[],v=h/s,m=v*(n-t)+t;for(let p=0;p<=i;++p){let x=p/i,L=x*l+a,y=Math.sin(L),T=Math.cos(L);f[0]=m*y,f[1]=-v*r+o,f[2]=m*T,e.position.push(f[0],f[1],f[2]),f[0]=y,f[1]=u,f[2]=T,k.normalize(f,f),e.normal.push(f[0],f[1],f[2]),f[0]=x,f[1]=1-v,e.texcoord.push(v[0],v[1]);let w=++e.vertexCount;d.push(w)}c.push(d)}for(let h=0;h<i;++h)for(let d=0;d<s;++d){let v=c[d][h],m=c[d+1][h],p=c[d+1][h+1],x=c[d][h+1];e.indices.push(v,m,x),e.indices.push(m,p,x)}return e}function br(e,t,n,r,i,s,a,l){let o=i/2,u=t?1:-1,c=t?n:r,f=e.vertexCount;for(let v=1;v<=s;++v)e.position.push(0,o*u,0),e.normal.push(0,u,0),e.texcoord.push(.5,.5),++e.vertexCount;let h=k.create(),d=e.vertexCount;for(let v=0;v<=s;++v){let p=v/s*l+a,x=Math.cos(p),L=Math.sin(p);h[0]=c*L,h[1]=o*u,h[2]=c*x,e.position.push(h[0],h[1],h[2]),e.normal.push(0,u,0),h[0]=x*.5+.5,h[1]=L*.5*u+.5,e.texcoord.push(h[0],h[1]),++e.vertexCount}for(let v=0;v<s;++v){let m=f+v,p=d+v;t?e.indices.push(p,p+1,m):e.indices.push(p+1,p,m)}return e}window.addEventListener("DOMContentLoaded",Ul);async function Ul(){await Ae.connectInputs(pe),await Ae.preloadAssetPack(),await Ae.preloadAssets(tr),await Fl({})}async function Fl(e){let t=Ae.getDisplayPort();if(!t)return;let n=Ae.getInputPort();if(!n)return;let r=n.getContext("axisbutton"),i=t.canvas.getContext("webgl2"),s=new Kt,a=new Yt;oe.translate(s.viewMatrix,s.viewMatrix,k.fromValues(0,0,-10)),t.canvas.addEventListener("click",()=>{t.focus(),t.canvas.requestPointerLock()});let l=[gr,wr],o=i.createProgram();await Pe.linkProgramShaders(i,o,l);let u=Pe.getProgramInfo(i,o),c=yr(Tr(.5,1,10)),f=nt.createBufferInfo(i,{a_position:{buffer:c.position,size:3},a_texcoord:{buffer:c.texcoord,size:2},a_normal:{buffer:c.normal,size:3}},{buffer:c.indices}),h=nt.createVertexArrayInfo(i,f,[u]),d=oe.create();t.addEventListener("frame",v=>{let{deltaTime:m,now:p}=v.detail,x=m/60;r.poll(p),i.viewport(0,0,t.width,t.height),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),s.resize(t.width,t.height);let L=pe.MoveForward.value-pe.MoveBackward.value,y=pe.MoveRight.value-pe.MoveLeft.value,T=pe.MoveDown.value-pe.MoveUp.value;a.move(L,y,T,x);let w=pe.CursorX.delta,R=-pe.CursorY.delta;a.look(w,R,x),a.apply(s.viewMatrix),oe.rotateX(d,d,.01),i.useProgram(u.handle),Pe.bindProgramAttributes(i,u,h),Pe.bindProgramUniforms(i,u,{u_color:[1,0,.5,1],u_model:d,u_view:s.viewMatrix,u_projection:s.projectionMatrix}),nt.drawBufferInfo(i,f)})}})();
//# sourceMappingURL=main.js.map
