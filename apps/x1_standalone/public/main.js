(()=>{var rr=Object.create,Ie=Object.defineProperty;var sr=Object.getOwnPropertyDescriptor;var ir=Object.getOwnPropertyNames;var ar=Object.getPrototypeOf,or=Object.prototype.hasOwnProperty;var lr=t=>Ie(t,"__esModule",{value:!0});var ur=(t,e)=>()=>(t&&(e=t(t=0)),e),ce=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Le=(t,e)=>{for(var n in e)Ie(t,n,{get:e[n],enumerable:!0})},cr=(t,e,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of ir(e))!or.call(t,r)&&r!=="default"&&Ie(t,r,{get:()=>e[r],enumerable:!(n=sr(e,r))||n.enumerable});return t},hr=t=>cr(lr(Ie(t!=null?rr(ar(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var Zt={};Le(Zt,{basename:()=>Xt,default:()=>Hs,delimiter:()=>qt,dirname:()=>Wt,extname:()=>Qt,isAbsolute:()=>lt,join:()=>zt,normalize:()=>ot,relative:()=>Vt,resolve:()=>Be,sep:()=>jt});function Gt(t,e){for(var n=0,r=t.length-1;r>=0;r--){var s=t[r];s==="."?t.splice(r,1):s===".."?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function Be(){for(var t="",e=!1,n=arguments.length-1;n>=-1&&!e;n--){var r=n>=0?arguments[n]:"/";if(typeof r!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!r)continue;t=r+"/"+t,e=r.charAt(0)==="/"}return t=Gt(ut(t.split("/"),function(s){return!!s}),!e).join("/"),(e?"/":"")+t||"."}function ot(t){var e=lt(t),n=ks(t,-1)==="/";return t=Gt(ut(t.split("/"),function(r){return!!r}),!e).join("/"),!t&&!e&&(t="."),t&&n&&(t+="/"),(e?"/":"")+t}function lt(t){return t.charAt(0)==="/"}function zt(){var t=Array.prototype.slice.call(arguments,0);return ot(ut(t,function(e,n){if(typeof e!="string")throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))}function Vt(t,e){t=Be(t).substr(1),e=Be(e).substr(1);function n(c){for(var u=0;u<c.length&&c[u]==="";u++);for(var h=c.length-1;h>=0&&c[h]==="";h--);return u>h?[]:c.slice(u,h-u+1)}for(var r=n(t.split("/")),s=n(e.split("/")),i=Math.min(r.length,s.length),a=i,o=0;o<i;o++)if(r[o]!==s[o]){a=o;break}for(var l=[],o=a;o<r.length;o++)l.push("..");return l=l.concat(s.slice(a)),l.join("/")}function Wt(t){var e=at(t),n=e[0],r=e[1];return!n&&!r?".":(r&&(r=r.substr(0,r.length-1)),n+r)}function Xt(t,e){var n=at(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n}function Qt(t){return at(t)[3]}function ut(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}var Us,at,jt,qt,Hs,ks,Jt=ur(()=>{Us=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,at=function(t){return Us.exec(t).slice(1)};jt="/",qt=":";Hs={extname:Qt,basename:Xt,dirname:Wt,sep:jt,delimiter:qt,relative:Vt,join:zt,isAbsolute:lt,normalize:ot,resolve:Be};ks="ab".substr(-1)==="b"?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}});var De=ce((Zo,Pe)=>{var de=(Jt(),Zt);if(de&&de.default){Pe.exports=de.default;for(let t in de)Pe.exports[t]=de[t]}else de&&(Pe.exports=de)});var be=ce((Jo,sn)=>{"use strict";var Ks=De(),re="\\\\/",en=`[^${re}]`,ae="\\.",Ys="\\+",$s="\\?",Fe="\\/",Gs="(?=.)",tn="[^/]",ct=`(?:${Fe}|$)`,nn=`(?:^|${Fe})`,ht=`${ae}{1,2}${ct}`,zs=`(?!${ae})`,Vs=`(?!${nn}${ht})`,js=`(?!${ae}{0,1}${ct})`,qs=`(?!${ht})`,Ws=`[^.${Fe}]`,Xs=`${tn}*?`,rn={DOT_LITERAL:ae,PLUS_LITERAL:Ys,QMARK_LITERAL:$s,SLASH_LITERAL:Fe,ONE_CHAR:Gs,QMARK:tn,END_ANCHOR:ct,DOTS_SLASH:ht,NO_DOT:zs,NO_DOTS:Vs,NO_DOT_SLASH:js,NO_DOTS_SLASH:qs,QMARK_NO_DOT:Ws,STAR:Xs,START_ANCHOR:nn},Qs={...rn,SLASH_LITERAL:`[${re}]`,QMARK:en,STAR:`${en}*?`,DOTS_SLASH:`${ae}{1,2}(?:[${re}]|$)`,NO_DOT:`(?!${ae})`,NO_DOTS:`(?!(?:^|[${re}])${ae}{1,2}(?:[${re}]|$))`,NO_DOT_SLASH:`(?!${ae}{0,1}(?:[${re}]|$))`,NO_DOTS_SLASH:`(?!${ae}{1,2}(?:[${re}]|$))`,QMARK_NO_DOT:`[^.${re}]`,START_ANCHOR:`(?:^|[${re}])`,END_ANCHOR:`(?:[${re}]|$)`},Zs={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};sn.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:Zs,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:Ks.sep,extglobChars(t){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${t.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(t){return t===!0?Qs:rn}}});var Ue=ce(X=>{"use strict";var Js=De(),ei=!1,{REGEX_BACKSLASH:ti,REGEX_REMOVE_BACKSLASH:ni,REGEX_SPECIAL_CHARS:ri,REGEX_SPECIAL_CHARS_GLOBAL:si}=be();X.isObject=t=>t!==null&&typeof t=="object"&&!Array.isArray(t);X.hasRegexChars=t=>ri.test(t);X.isRegexChar=t=>t.length===1&&X.hasRegexChars(t);X.escapeRegex=t=>t.replace(si,"\\$1");X.toPosixSlashes=t=>t.replace(ti,"/");X.removeBackslashes=t=>t.replace(ni,e=>e==="\\"?"":e);X.supportsLookbehinds=()=>{let t=process.version.slice(1).split(".").map(Number);return t.length===3&&t[0]>=9||t[0]===8&&t[1]>=10};X.isWindows=t=>t&&typeof t.windows=="boolean"?t.windows:ei===!0||Js.sep==="\\";X.escapeLast=(t,e,n)=>{let r=t.lastIndexOf(e,n);return r===-1?t:t[r-1]==="\\"?X.escapeLast(t,e,r-1):`${t.slice(0,r)}\\${t.slice(r)}`};X.removePrefix=(t,e={})=>{let n=t;return n.startsWith("./")&&(n=n.slice(2),e.prefix="./"),n};X.wrapOutput=(t,e={},n={})=>{let r=n.contains?"":"^",s=n.contains?"":"$",i=`${r}(?:${t})${s}`;return e.negated===!0&&(i=`(?:^(?!${i}).*$)`),i}});var dn=ce((tl,fn)=>{"use strict";var an=Ue(),{CHAR_ASTERISK:ft,CHAR_AT:ii,CHAR_BACKWARD_SLASH:ye,CHAR_COMMA:ai,CHAR_DOT:dt,CHAR_EXCLAMATION_MARK:pt,CHAR_FORWARD_SLASH:on,CHAR_LEFT_CURLY_BRACE:mt,CHAR_LEFT_PARENTHESES:_t,CHAR_LEFT_SQUARE_BRACKET:oi,CHAR_PLUS:li,CHAR_QUESTION_MARK:ln,CHAR_RIGHT_CURLY_BRACE:ui,CHAR_RIGHT_PARENTHESES:un,CHAR_RIGHT_SQUARE_BRACKET:ci}=be(),cn=t=>t===on||t===ye,hn=t=>{t.isPrefix!==!0&&(t.depth=t.isGlobstar?Infinity:1)},hi=(t,e)=>{let n=e||{},r=t.length-1,s=n.parts===!0||n.scanToEnd===!0,i=[],a=[],o=[],l=t,c=-1,u=0,h=0,f=!1,p=!1,m=!1,v=!1,d=!1,x=!1,L=!1,y=!1,T=!1,M=!1,I=0,F,S,C={value:"",depth:0,isGlob:!1},P=()=>c>=r,E=()=>l.charCodeAt(c+1),N=()=>(F=S,l.charCodeAt(++c));for(;c<r;){S=N();let z;if(S===ye){L=C.backslashes=!0,S=N(),S===mt&&(x=!0);continue}if(x===!0||S===mt){for(I++;P()!==!0&&(S=N());){if(S===ye){L=C.backslashes=!0,N();continue}if(S===mt){I++;continue}if(x!==!0&&S===dt&&(S=N())===dt){if(f=C.isBrace=!0,m=C.isGlob=!0,M=!0,s===!0)continue;break}if(x!==!0&&S===ai){if(f=C.isBrace=!0,m=C.isGlob=!0,M=!0,s===!0)continue;break}if(S===ui&&(I--,I===0)){x=!1,f=C.isBrace=!0,M=!0;break}}if(s===!0)continue;break}if(S===on){if(i.push(c),a.push(C),C={value:"",depth:0,isGlob:!1},M===!0)continue;if(F===dt&&c===u+1){u+=2;continue}h=c+1;continue}if(n.noext!==!0&&(S===li||S===ii||S===ft||S===ln||S===pt)===!0&&E()===_t){if(m=C.isGlob=!0,v=C.isExtglob=!0,M=!0,S===pt&&c===u&&(T=!0),s===!0){for(;P()!==!0&&(S=N());){if(S===ye){L=C.backslashes=!0,S=N();continue}if(S===un){m=C.isGlob=!0,M=!0;break}}continue}break}if(S===ft){if(F===ft&&(d=C.isGlobstar=!0),m=C.isGlob=!0,M=!0,s===!0)continue;break}if(S===ln){if(m=C.isGlob=!0,M=!0,s===!0)continue;break}if(S===oi){for(;P()!==!0&&(z=N());){if(z===ye){L=C.backslashes=!0,N();continue}if(z===ci){p=C.isBracket=!0,m=C.isGlob=!0,M=!0;break}}if(s===!0)continue;break}if(n.nonegate!==!0&&S===pt&&c===u){y=C.negated=!0,u++;continue}if(n.noparen!==!0&&S===_t){if(m=C.isGlob=!0,s===!0){for(;P()!==!0&&(S=N());){if(S===_t){L=C.backslashes=!0,S=N();continue}if(S===un){M=!0;break}}continue}break}if(m===!0){if(M=!0,s===!0)continue;break}}n.noext===!0&&(v=!1,m=!1);let O=l,B="",_="";u>0&&(B=l.slice(0,u),l=l.slice(u),h-=u),O&&m===!0&&h>0?(O=l.slice(0,h),_=l.slice(h)):m===!0?(O="",_=l):O=l,O&&O!==""&&O!=="/"&&O!==l&&cn(O.charCodeAt(O.length-1))&&(O=O.slice(0,-1)),n.unescape===!0&&(_&&(_=an.removeBackslashes(_)),O&&L===!0&&(O=an.removeBackslashes(O)));let A={prefix:B,input:t,start:u,base:O,glob:_,isBrace:f,isBracket:p,isGlob:m,isExtglob:v,isGlobstar:d,negated:y,negatedExtglob:T};if(n.tokens===!0&&(A.maxDepth=0,cn(S)||a.push(C),A.tokens=a),n.parts===!0||n.tokens===!0){let z;for(let H=0;H<i.length;H++){let Q=z?z+1:u,ne=i[H],Z=t.slice(Q,ne);n.tokens&&(H===0&&u!==0?(a[H].isPrefix=!0,a[H].value=B):a[H].value=Z,hn(a[H]),A.maxDepth+=a[H].depth),(H!==0||Z!=="")&&o.push(Z),z=ne}if(z&&z+1<t.length){let H=t.slice(z+1);o.push(H),n.tokens&&(a[a.length-1].value=H,hn(a[a.length-1]),A.maxDepth+=a[a.length-1].depth)}A.slashes=i,A.parts=o}return A};fn.exports=hi});var _n=ce((nl,mn)=>{"use strict";var He=be(),J=Ue(),{MAX_LENGTH:ke,POSIX_REGEX_SOURCE:fi,REGEX_NON_SPECIAL_CHARS:di,REGEX_SPECIAL_CHARS_BACKREF:pi,REPLACEMENTS:pn}=He,mi=(t,e)=>{if(typeof e.expandRange=="function")return e.expandRange(...t,e);t.sort();let n=`[${t.join("-")}]`;try{new RegExp(n)}catch(r){return t.map(s=>J.escapeRegex(s)).join("..")}return n},_e=(t,e)=>`Missing ${t}: "${e}" - use "\\\\${e}" to match literal characters`,Et=(t,e)=>{if(typeof t!="string")throw new TypeError("Expected a string");t=pn[t]||t;let n={...e},r=typeof n.maxLength=="number"?Math.min(ke,n.maxLength):ke,s=t.length;if(s>r)throw new SyntaxError(`Input length: ${s}, exceeds maximum allowed length: ${r}`);let i={type:"bos",value:"",output:n.prepend||""},a=[i],o=n.capture?"":"?:",l=J.isWindows(e),c=He.globChars(l),u=He.extglobChars(c),{DOT_LITERAL:h,PLUS_LITERAL:f,SLASH_LITERAL:p,ONE_CHAR:m,DOTS_SLASH:v,NO_DOT:d,NO_DOT_SLASH:x,NO_DOTS_SLASH:L,QMARK:y,QMARK_NO_DOT:T,STAR:M,START_ANCHOR:I}=c,F=w=>`(${o}(?:(?!${I}${w.dot?v:h}).)*?)`,S=n.dot?"":d,C=n.dot?y:T,P=n.bash===!0?F(n):M;n.capture&&(P=`(${P})`),typeof n.noext=="boolean"&&(n.noextglob=n.noext);let E={input:t,index:-1,start:0,dot:n.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:a};t=J.removePrefix(t,E),s=t.length;let N=[],O=[],B=[],_=i,A,z=()=>E.index===s-1,H=E.peek=(w=1)=>t[E.index+w],Q=E.advance=()=>t[++E.index]||"",ne=()=>t.slice(E.index+1),Z=(w="",K=0)=>{E.consumed+=w,E.index+=K},Te=w=>{E.output+=w.output!=null?w.output:w.value,Z(w.value)},tr=()=>{let w=1;for(;H()==="!"&&(H(2)!=="("||H(3)==="?");)Q(),E.start++,w++;return w%2==0?!1:(E.negated=!0,E.start++,!0)},Me=w=>{E[w]++,B.push(w)},ue=w=>{E[w]--,B.pop()},U=w=>{if(_.type==="globstar"){let K=E.braces>0&&(w.type==="comma"||w.type==="brace"),b=w.extglob===!0||N.length&&(w.type==="pipe"||w.type==="paren");w.type!=="slash"&&w.type!=="paren"&&!K&&!b&&(E.output=E.output.slice(0,-_.output.length),_.type="star",_.value="*",_.output=P,E.output+=_.output)}if(N.length&&w.type!=="paren"&&(N[N.length-1].inner+=w.value),(w.value||w.output)&&Te(w),_&&_.type==="text"&&w.type==="text"){_.value+=w.value,_.output=(_.output||"")+w.value;return}w.prev=_,a.push(w),_=w},Se=(w,K)=>{let b={...u[K],conditions:1,inner:""};b.prev=_,b.parens=E.parens,b.output=E.output;let D=(n.capture?"(":"")+b.open;Me("parens"),U({type:w,value:K,output:E.output?"":m}),U({type:"paren",extglob:!0,value:Q(),output:D}),N.push(b)},nr=w=>{let K=w.close+(n.capture?")":""),b;if(w.type==="negate"){let D=P;if(w.inner&&w.inner.length>1&&w.inner.includes("/")&&(D=F(n)),(D!==P||z()||/^\)+$/.test(ne()))&&(K=w.close=`)$))${D}`),w.inner.includes("*")&&(b=ne())&&/^\.[^\\/.]+$/.test(b)){let $=Et(b,{...e,fastpaths:!1}).output;K=w.close=`)${$})${D})`}w.prev.type==="bos"&&(E.negatedExtglob=!0)}U({type:"paren",extglob:!0,value:A,output:K}),ue("parens")};if(n.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(t)){let w=!1,K=t.replace(pi,(b,D,$,W,j,Ve)=>W==="\\"?(w=!0,b):W==="?"?D?D+W+(j?y.repeat(j.length):""):Ve===0?C+(j?y.repeat(j.length):""):y.repeat($.length):W==="."?h.repeat($.length):W==="*"?D?D+W+(j?P:""):P:D?b:`\\${b}`);return w===!0&&(n.unescape===!0?K=K.replace(/\\/g,""):K=K.replace(/\\+/g,b=>b.length%2==0?"\\\\":b?"\\":"")),K===t&&n.contains===!0?(E.output=t,E):(E.output=J.wrapOutput(K,E,e),E)}for(;!z();){if(A=Q(),A==="\0")continue;if(A==="\\"){let b=H();if(b==="/"&&n.bash!==!0||b==="."||b===";")continue;if(!b){A+="\\",U({type:"text",value:A});continue}let D=/^\\+/.exec(ne()),$=0;if(D&&D[0].length>2&&($=D[0].length,E.index+=$,$%2!=0&&(A+="\\")),n.unescape===!0?A=Q():A+=Q(),E.brackets===0){U({type:"text",value:A});continue}}if(E.brackets>0&&(A!=="]"||_.value==="["||_.value==="[^")){if(n.posix!==!1&&A===":"){let b=_.value.slice(1);if(b.includes("[")&&(_.posix=!0,b.includes(":"))){let D=_.value.lastIndexOf("["),$=_.value.slice(0,D),W=_.value.slice(D+2),j=fi[W];if(j){_.value=$+j,E.backtrack=!0,Q(),!i.output&&a.indexOf(_)===1&&(i.output=m);continue}}}(A==="["&&H()!==":"||A==="-"&&H()==="]")&&(A=`\\${A}`),A==="]"&&(_.value==="["||_.value==="[^")&&(A=`\\${A}`),n.posix===!0&&A==="!"&&_.value==="["&&(A="^"),_.value+=A,Te({value:A});continue}if(E.quotes===1&&A!=='"'){A=J.escapeRegex(A),_.value+=A,Te({value:A});continue}if(A==='"'){E.quotes=E.quotes===1?0:1,n.keepQuotes===!0&&U({type:"text",value:A});continue}if(A==="("){Me("parens"),U({type:"paren",value:A});continue}if(A===")"){if(E.parens===0&&n.strictBrackets===!0)throw new SyntaxError(_e("opening","("));let b=N[N.length-1];if(b&&E.parens===b.parens+1){nr(N.pop());continue}U({type:"paren",value:A,output:E.parens?")":"\\)"}),ue("parens");continue}if(A==="["){if(n.nobracket===!0||!ne().includes("]")){if(n.nobracket!==!0&&n.strictBrackets===!0)throw new SyntaxError(_e("closing","]"));A=`\\${A}`}else Me("brackets");U({type:"bracket",value:A});continue}if(A==="]"){if(n.nobracket===!0||_&&_.type==="bracket"&&_.value.length===1){U({type:"text",value:A,output:`\\${A}`});continue}if(E.brackets===0){if(n.strictBrackets===!0)throw new SyntaxError(_e("opening","["));U({type:"text",value:A,output:`\\${A}`});continue}ue("brackets");let b=_.value.slice(1);if(_.posix!==!0&&b[0]==="^"&&!b.includes("/")&&(A=`/${A}`),_.value+=A,Te({value:A}),n.literalBrackets===!1||J.hasRegexChars(b))continue;let D=J.escapeRegex(_.value);if(E.output=E.output.slice(0,-_.value.length),n.literalBrackets===!0){E.output+=D,_.value=D;continue}_.value=`(${o}${D}|${_.value})`,E.output+=_.value;continue}if(A==="{"&&n.nobrace!==!0){Me("braces");let b={type:"brace",value:A,output:"(",outputIndex:E.output.length,tokensIndex:E.tokens.length};O.push(b),U(b);continue}if(A==="}"){let b=O[O.length-1];if(n.nobrace===!0||!b){U({type:"text",value:A,output:A});continue}let D=")";if(b.dots===!0){let $=a.slice(),W=[];for(let j=$.length-1;j>=0&&(a.pop(),$[j].type!=="brace");j--)$[j].type!=="dots"&&W.unshift($[j].value);D=mi(W,n),E.backtrack=!0}if(b.comma!==!0&&b.dots!==!0){let $=E.output.slice(0,b.outputIndex),W=E.tokens.slice(b.tokensIndex);b.value=b.output="\\{",A=D="\\}",E.output=$;for(let j of W)E.output+=j.output||j.value}U({type:"brace",value:A,output:D}),ue("braces"),O.pop();continue}if(A==="|"){N.length>0&&N[N.length-1].conditions++,U({type:"text",value:A});continue}if(A===","){let b=A,D=O[O.length-1];D&&B[B.length-1]==="braces"&&(D.comma=!0,b="|"),U({type:"comma",value:A,output:b});continue}if(A==="/"){if(_.type==="dot"&&E.index===E.start+1){E.start=E.index+1,E.consumed="",E.output="",a.pop(),_=i;continue}U({type:"slash",value:A,output:p});continue}if(A==="."){if(E.braces>0&&_.type==="dot"){_.value==="."&&(_.output=h);let b=O[O.length-1];_.type="dots",_.output+=A,_.value+=A,b.dots=!0;continue}if(E.braces+E.parens===0&&_.type!=="bos"&&_.type!=="slash"){U({type:"text",value:A,output:h});continue}U({type:"dot",value:A,output:h});continue}if(A==="?"){if(!(_&&_.value==="(")&&n.noextglob!==!0&&H()==="("&&H(2)!=="?"){Se("qmark",A);continue}if(_&&_.type==="paren"){let D=H(),$=A;if(D==="<"&&!J.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(_.value==="("&&!/[!=<:]/.test(D)||D==="<"&&!/<([!=]|\w+>)/.test(ne()))&&($=`\\${A}`),U({type:"text",value:A,output:$});continue}if(n.dot!==!0&&(_.type==="slash"||_.type==="bos")){U({type:"qmark",value:A,output:T});continue}U({type:"qmark",value:A,output:y});continue}if(A==="!"){if(n.noextglob!==!0&&H()==="("&&(H(2)!=="?"||!/[!=<:]/.test(H(3)))){Se("negate",A);continue}if(n.nonegate!==!0&&E.index===0){tr();continue}}if(A==="+"){if(n.noextglob!==!0&&H()==="("&&H(2)!=="?"){Se("plus",A);continue}if(_&&_.value==="("||n.regex===!1){U({type:"plus",value:A,output:f});continue}if(_&&(_.type==="bracket"||_.type==="paren"||_.type==="brace")||E.parens>0){U({type:"plus",value:A});continue}U({type:"plus",value:f});continue}if(A==="@"){if(n.noextglob!==!0&&H()==="("&&H(2)!=="?"){U({type:"at",extglob:!0,value:A,output:""});continue}U({type:"text",value:A});continue}if(A!=="*"){(A==="$"||A==="^")&&(A=`\\${A}`);let b=di.exec(ne());b&&(A+=b[0],E.index+=b[0].length),U({type:"text",value:A});continue}if(_&&(_.type==="globstar"||_.star===!0)){_.type="star",_.star=!0,_.value+=A,_.output=P,E.backtrack=!0,E.globstar=!0,Z(A);continue}let w=ne();if(n.noextglob!==!0&&/^\([^?]/.test(w)){Se("star",A);continue}if(_.type==="star"){if(n.noglobstar===!0){Z(A);continue}let b=_.prev,D=b.prev,$=b.type==="slash"||b.type==="bos",W=D&&(D.type==="star"||D.type==="globstar");if(n.bash===!0&&(!$||w[0]&&w[0]!=="/")){U({type:"star",value:A,output:""});continue}let j=E.braces>0&&(b.type==="comma"||b.type==="brace"),Ve=N.length&&(b.type==="pipe"||b.type==="paren");if(!$&&b.type!=="paren"&&!j&&!Ve){U({type:"star",value:A,output:""});continue}for(;w.slice(0,3)==="/**";){let Re=t[E.index+4];if(Re&&Re!=="/")break;w=w.slice(3),Z("/**",3)}if(b.type==="bos"&&z()){_.type="globstar",_.value+=A,_.output=F(n),E.output=_.output,E.globstar=!0,Z(A);continue}if(b.type==="slash"&&b.prev.type!=="bos"&&!W&&z()){E.output=E.output.slice(0,-(b.output+_.output).length),b.output=`(?:${b.output}`,_.type="globstar",_.output=F(n)+(n.strictSlashes?")":"|$)"),_.value+=A,E.globstar=!0,E.output+=b.output+_.output,Z(A);continue}if(b.type==="slash"&&b.prev.type!=="bos"&&w[0]==="/"){let Re=w[1]!==void 0?"|$":"";E.output=E.output.slice(0,-(b.output+_.output).length),b.output=`(?:${b.output}`,_.type="globstar",_.output=`${F(n)}${p}|${p}${Re})`,_.value+=A,E.output+=b.output+_.output,E.globstar=!0,Z(A+Q()),U({type:"slash",value:"/",output:""});continue}if(b.type==="bos"&&w[0]==="/"){_.type="globstar",_.value+=A,_.output=`(?:^|${p}|${F(n)}${p})`,E.output=_.output,E.globstar=!0,Z(A+Q()),U({type:"slash",value:"/",output:""});continue}E.output=E.output.slice(0,-_.output.length),_.type="globstar",_.output=F(n),_.value+=A,E.output+=_.output,E.globstar=!0,Z(A);continue}let K={type:"star",value:A,output:P};if(n.bash===!0){K.output=".*?",(_.type==="bos"||_.type==="slash")&&(K.output=S+K.output),U(K);continue}if(_&&(_.type==="bracket"||_.type==="paren")&&n.regex===!0){K.output=A,U(K);continue}(E.index===E.start||_.type==="slash"||_.type==="dot")&&(_.type==="dot"?(E.output+=x,_.output+=x):n.dot===!0?(E.output+=L,_.output+=L):(E.output+=S,_.output+=S),H()!=="*"&&(E.output+=m,_.output+=m)),U(K)}for(;E.brackets>0;){if(n.strictBrackets===!0)throw new SyntaxError(_e("closing","]"));E.output=J.escapeLast(E.output,"["),ue("brackets")}for(;E.parens>0;){if(n.strictBrackets===!0)throw new SyntaxError(_e("closing",")"));E.output=J.escapeLast(E.output,"("),ue("parens")}for(;E.braces>0;){if(n.strictBrackets===!0)throw new SyntaxError(_e("closing","}"));E.output=J.escapeLast(E.output,"{"),ue("braces")}if(n.strictSlashes!==!0&&(_.type==="star"||_.type==="bracket")&&U({type:"maybe_slash",value:"",output:`${p}?`}),E.backtrack===!0){E.output="";for(let w of E.tokens)E.output+=w.output!=null?w.output:w.value,w.suffix&&(E.output+=w.suffix)}return E};Et.fastpaths=(t,e)=>{let n={...e},r=typeof n.maxLength=="number"?Math.min(ke,n.maxLength):ke,s=t.length;if(s>r)throw new SyntaxError(`Input length: ${s}, exceeds maximum allowed length: ${r}`);t=pn[t]||t;let i=J.isWindows(e),{DOT_LITERAL:a,SLASH_LITERAL:o,ONE_CHAR:l,DOTS_SLASH:c,NO_DOT:u,NO_DOTS:h,NO_DOTS_SLASH:f,STAR:p,START_ANCHOR:m}=He.globChars(i),v=n.dot?h:u,d=n.dot?f:u,x=n.capture?"":"?:",L={negated:!1,prefix:""},y=n.bash===!0?".*?":p;n.capture&&(y=`(${y})`);let T=S=>S.noglobstar===!0?y:`(${x}(?:(?!${m}${S.dot?c:a}).)*?)`,M=S=>{switch(S){case"*":return`${v}${l}${y}`;case".*":return`${a}${l}${y}`;case"*.*":return`${v}${y}${a}${l}${y}`;case"*/*":return`${v}${y}${o}${l}${d}${y}`;case"**":return v+T(n);case"**/*":return`(?:${v}${T(n)}${o})?${d}${l}${y}`;case"**/*.*":return`(?:${v}${T(n)}${o})?${d}${y}${a}${l}${y}`;case"**/.*":return`(?:${v}${T(n)}${o})?${a}${l}${y}`;default:{let C=/^(.*?)\.(\w+)$/.exec(S);if(!C)return;let P=M(C[1]);return P?P+a+C[2]:void 0}}},I=J.removePrefix(t,L),F=M(I);return F&&n.strictSlashes!==!0&&(F+=`${o}?`),F};mn.exports=Et});var vn=ce((rl,En)=>{"use strict";var _i=De(),Ei=dn(),vt=_n(),At=Ue(),vi=be(),Ai=t=>t&&typeof t=="object"&&!Array.isArray(t),V=(t,e,n=!1)=>{if(Array.isArray(t)){let u=t.map(f=>V(f,e,n));return f=>{for(let p of u){let m=p(f);if(m)return m}return!1}}let r=Ai(t)&&t.tokens&&t.input;if(t===""||typeof t!="string"&&!r)throw new TypeError("Expected pattern to be a non-empty string");let s=e||{},i=At.isWindows(e),a=r?V.compileRe(t,e):V.makeRe(t,e,!1,!0),o=a.state;delete a.state;let l=()=>!1;if(s.ignore){let u={...e,ignore:null,onMatch:null,onResult:null};l=V(s.ignore,u,n)}let c=(u,h=!1)=>{let{isMatch:f,match:p,output:m}=V.test(u,a,e,{glob:t,posix:i}),v={glob:t,state:o,regex:a,posix:i,input:u,output:m,match:p,isMatch:f};return typeof s.onResult=="function"&&s.onResult(v),f===!1?(v.isMatch=!1,h?v:!1):l(u)?(typeof s.onIgnore=="function"&&s.onIgnore(v),v.isMatch=!1,h?v:!1):(typeof s.onMatch=="function"&&s.onMatch(v),h?v:!0)};return n&&(c.state=o),c};V.test=(t,e,n,{glob:r,posix:s}={})=>{if(typeof t!="string")throw new TypeError("Expected input to be a string");if(t==="")return{isMatch:!1,output:""};let i=n||{},a=i.format||(s?At.toPosixSlashes:null),o=t===r,l=o&&a?a(t):t;return o===!1&&(l=a?a(t):t,o=l===r),(o===!1||i.capture===!0)&&(i.matchBase===!0||i.basename===!0?o=V.matchBase(t,e,n,s):o=e.exec(l)),{isMatch:Boolean(o),match:o,output:l}};V.matchBase=(t,e,n,r=At.isWindows(n))=>(e instanceof RegExp?e:V.makeRe(e,n)).test(_i.basename(t));V.isMatch=(t,e,n)=>V(e,n)(t);V.parse=(t,e)=>Array.isArray(t)?t.map(n=>V.parse(n,e)):vt(t,{...e,fastpaths:!1});V.scan=(t,e)=>Ei(t,e);V.compileRe=(t,e,n=!1,r=!1)=>{if(n===!0)return t.output;let s=e||{},i=s.contains?"":"^",a=s.contains?"":"$",o=`${i}(?:${t.output})${a}`;t&&t.negated===!0&&(o=`^(?!${o}).*$`);let l=V.toRegex(o,e);return r===!0&&(l.state=t),l};V.makeRe=(t,e={},n=!1,r=!1)=>{if(!t||typeof t!="string")throw new TypeError("Expected a non-empty string");let s={negated:!1,fastpaths:!0};return e.fastpaths!==!1&&(t[0]==="."||t[0]==="*")&&(s.output=vt.fastpaths(t,e)),s.output||(s=vt(t,e)),V.compileRe(s,e,n,r)};V.toRegex=(t,e)=>{try{let n=e||{};return new RegExp(t,n.flags||(n.nocase?"i":""))}catch(n){if(e&&e.debug===!0)throw n;return/$^/}};V.constants=vi;En.exports=V});var xn=ce((sl,An)=>{"use strict";An.exports=vn()});var fr=`<div class="container">
  <label class="hidden" id="title">display-port</label>
  <label class="hidden" id="fps">00</label>
  <label class="hidden" id="dimension">0x0</label>
  <div class="content">
    <canvas> Oh no! Your browser does not support canvas. </canvas>
    <slot id="inner"></slot>
  </div>
  <slot name="frame"></slot>
</div>
`,dr=`:host {
  display: inline-block;
  color: #555555;
}

.container {
  display: flex;
  position: relative;
  width: 100%;
  height: 100%;
}

.content {
  position: relative;
  margin: auto;
}

.content > *:not(canvas) {
  width: 100%;
  height: 100%;
}

canvas {
  background: #000000;
  image-rendering: pixelated;
}

label {
  position: absolute;
  font-family: monospace;
  color: currentColor;
}

#inner {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: 0;
  left: 0;
  pointer-events: none;
}

#title {
  left: 0.5rem;
  top: 0.5rem;
}

#fps {
  right: 0.5rem;
  top: 0.5rem;
}

#dimension {
  left: 0.5rem;
  bottom: 0.5rem;
}

.hidden {
  display: none;
}

:host([debug]) .container {
  outline: 6px dashed rgba(0, 0, 0, 0.1);
  outline-offset: -4px;
  background-color: rgba(0, 0, 0, 0.1);
}

:host([mode='noscale']) canvas {
  margin: 0;
  top: 0;
  left: 0;
}

:host([mode='stretch']) canvas,
:host([mode='scale']) canvas {
  width: 100%;
  height: 100%;
}

:host([mode='fit']),
:host([mode='scale']),
:host([mode='center']),
:host([mode='stretch']),
:host([mode='fill']) {
  width: 100%;
  height: 100%;
}

:host([full]) {
  width: 100vw !important;
  height: 100vh !important;
}

:host([disabled]) {
  display: none;
}

slot {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  pointer-events: none;
}

::slotted(*) {
  pointer-events: auto;
}
`,It="noscale";var je="fit",Lt="scale",Ct="fill",Nt="stretch",Ot=300,Bt=150,Pt=je,pr=200,Ce=class extends HTMLElement{static create(e={}){let{root:n=document.body,id:r=void 0,mode:s=Pt,width:i=Ot,height:a=Bt,debug:o=!1}=e||{},l=new Ce;return l.id=r,l.mode=s,l.width=i,l.height=a,l.debug=o,n.appendChild(l),l}static get[Symbol.for("templateNode")](){let e=document.createElement("template");return e.innerHTML=fr,Object.defineProperty(this,Symbol.for("templateNode"),{value:e}),e}static get[Symbol.for("styleNode")](){let e=document.createElement("style");return e.innerHTML=dr,Object.defineProperty(this,Symbol.for("styleNode"),{value:e}),e}static define(e=window.customElements){e.define("display-port",this)}static get observedAttributes(){return["debug","disabled","width","height","onframe","id","class"]}get mode(){return this.getAttribute("mode")}set mode(e){this.setAttribute("mode",e)}get debug(){return this._debug}set debug(e){this.toggleAttribute("debug",e)}get disabled(){return this._disabled}set disabled(e){this.toggleAttribute("disabled",e)}get width(){return this._width}set width(e){this.setAttribute("width",String(e))}get height(){return this._height}set height(e){this.setAttribute("height",String(e))}get onframe(){return this._onframe}set onframe(e){this._onframe&&this.removeEventListener("frame",this._onframe),this._onframe=e,this._onframe&&this.addEventListener("frame",e)}constructor(){super();let e=this.attachShadow({mode:"open"});e.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),e.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._canvasElement=e.querySelector("canvas"),this._contentElement=e.querySelector(".content"),this._innerElement=e.querySelector("#inner"),this._titleElement=e.querySelector("#title"),this._fpsElement=e.querySelector("#fps"),this._dimensionElement=e.querySelector("#dimension"),this._debug=!1,this._disabled=!1,this._width=Ot,this._height=Bt,this._onframe=void 0,this._animationRequestHandle=0,this._prevAnimationFrameTime=0,this._resizeTimeoutHandle=0,this._resizeCanvasWidth=0,this._resizeCanvasHeight=0,this._frameEvent=new CustomEvent("frame",{composed:!0,bubbles:!1,detail:{now:0,prevTime:0,deltaTime:0,canvas:this._canvasElement}}),this._resizeEvent=new CustomEvent("resize",{composed:!0,bubbles:!1,detail:{width:0,height:0}}),this.update=this.update.bind(this),this.onDelayCanvasResize=this.onDelayCanvasResize.bind(this)}get canvas(){return this._canvasElement}connectedCallback(){me(this,"mode"),me(this,"debug"),me(this,"disabled"),me(this,"width"),me(this,"height"),me(this,"onframe"),this.hasAttribute("mode")||this.setAttribute("mode",Pt),this.hasAttribute("tabindex")||this.setAttribute("tabindex","0"),this.updateCanvasSize(!0),this.resume()}disconnectedCallback(){this.pause()}attributeChangedCallback(e,n,r){switch(e){case"debug":this._debug=r!==null;break;case"disabled":this._disabled=r!==null;break;case"width":this._width=Number(r);break;case"height":this._height=Number(r);break;case"onframe":this.onframe=new Function("event","with(document){with(this){"+r+"}}").bind(this);break}switch(e){case"disabled":r?(this.update(0),this.pause()):this.resume();break;case"id":case"class":this._titleElement.innerHTML=`display-port${this.className?"."+this.className:""}${this.hasAttribute("id")?"#"+this.getAttribute("id"):""}`;break;case"debug":this._titleElement.classList.toggle("hidden",r),this._fpsElement.classList.toggle("hidden",r),this._dimensionElement.classList.toggle("hidden",r);break}}getContext(e="2d",n=void 0){return this._canvasElement.getContext(e,n)}pause(){window.cancelAnimationFrame(this._animationRequestHandle)}resume(){this._animationRequestHandle=window.requestAnimationFrame(this.update)}update(e){this._animationRequestHandle=window.requestAnimationFrame(this.update),this.updateCanvasSize(!1);let n=e-this._prevAnimationFrameTime;if(this._prevAnimationFrameTime=e,this._debug){let i=n<=0?"--":String(Math.round(1e3/n)).padStart(2,"0");if(this._fpsElement.textContent!==i&&(this._fpsElement.textContent=i),this.mode===It){let o=`${this._width}x${this._height}`;this._dimensionElement.textContent!==o&&(this._dimensionElement.textContent=o)}else{let o=`${this._width}x${this._height}|${this.shadowRoot.host.clientWidth}x${this.shadowRoot.host.clientHeight}`;this._dimensionElement.textContent!==o&&(this._dimensionElement.textContent=o)}}let s=this._frameEvent.detail;s.now=e,s.prevTime=this._prevAnimationFrameTime,s.deltaTime=n,this.dispatchEvent(this._frameEvent)}onDelayCanvasResize(){this._resizeTimeoutHandle=null,this.updateCanvasSize(!0)}delayCanvasResize(e,n){(e!==this._resizeCanvasWidth||n!==this._resizeCanvasHeight)&&(this._resizeCanvasWidth=e,this._resizeCanvasHeight=n,this._resizeTimeoutHandle&&window.clearTimeout(this._resizeTimeoutHandle),this._resizeTimeoutHandle=window.setTimeout(this.onDelayCanvasResize,pr))}updateCanvasSize(e=!0){let n=this.shadowRoot.host.getBoundingClientRect(),r=n.width,s=n.height,i=this._canvasElement,a=this._width,o=this._height,l=this.mode;if(l===Nt||l===Ct)a=r,o=s;else if(l!==It&&(r<a||s<o||l===je||l==Lt)){let u=r/a,h=s/o;u<h?(a=r,o=o*u):(a=a*h,o=s)}if(a=Math.floor(a),o=Math.floor(o),typeof e=="undefined"&&(e=i.clientWidth!==a||i.clientHeight!==o),!e){this.delayCanvasResize(a,o);return}let c=Math.min(a/this._width,o/this._height)*.5;if(this._innerElement.style.fontSize=`font-size: ${c}em`,e){l===Lt?(i.width=this._width,i.height=this._height):l!==Nt&&(i.width=a,i.height=o);let u=this._contentElement.style;u.width=`${a}px`,u.height=`${o}px`,(l===je||l===Ct)&&(this._width=a,this._height=o);let f=this._resizeEvent.detail;f.width=a,f.height=o,this.dispatchEvent(this._resizeEvent)}}};Ce.define();function me(t,e){if(Object.prototype.hasOwnProperty.call(t,e)){let n=t[e];delete t[e],t[e]=n}}var qe=class{get polling(){return performance.now()-this._lastPollingTime<1e3}get value(){return 0}get size(){return this._size}constructor(e){this._size=e,this._lastPollingTime=Number.MIN_SAFE_INTEGER}resize(e){this._size=e}getState(e){throw new Error("Missing implementation.")}onUpdate(e,n,r){throw new Error("Missing implementation.")}onStatus(e,n){throw new Error("Missing implementation.")}onPoll(e){this._lastPollingTime=e}onBind(e,n=void 0){e>=this._size&&this.resize(e+1)}onUnbind(){this.resize(0)}},xe=class extends qe{static createAxisBindingState(){return{value:0,delta:0,inverted:!1}}get delta(){return this._delta}get value(){return this._value}constructor(e=0){super(e);let n=new Array,r=this.constructor;for(let s=0;s<e;++s)n.push(r.createAxisBindingState());this._state=n,this._value=0,this._delta=0}resize(e){let n=this._state,r=n.length,s;if(e<=r)s=n.slice(0,e);else{s=n;let i=this.constructor;for(let a=r;a<e;++a)s.push(i.createAxisBindingState())}this._state=s,super.resize(e)}getState(e){return this._state[e].value}onPoll(e){let n=this._state,r=0,s=0,i=n.length;for(let a=0;a<i;++a){let o=n[a];r+=o.value*(o.inverted?-1:1),s+=o.delta,n[a].delta=0}this._value=r,this._delta=s,super.onPoll(e)}onUpdate(e,n,r){typeof n=="undefined"?this.onAxisChange(e,r):this.onAxisMove(e,n,r)}onStatus(e,n){this.onAxisStatus(e,n)}onBind(e,n=void 0){super.onBind(e,n);let{inverted:r=!1}=n||{},s=this._state;s[e].inverted=r}onAxisMove(e,n,r){let s=this._state[e];s.value=n,s.delta+=r}onAxisChange(e,n){let r=this._state[e];r.value+=n,r.delta+=n}onAxisStatus(e,n){let r=this._state[e],s=r.value;r.value=n,r.delta=n-s}},mr=241,Dt=254,_r=239,he=1,We=2,Xe=4,Qe=8,Ze=16,Ne=class extends qe{get pressed(){return this._pressed}get repeated(){return this._repeated}get released(){return this._released}get down(){return this._down}get value(){return this._value}constructor(e=0){super(e);this._state=new Uint8Array(e),this._value=0,this._down=!1,this._pressed=!1,this._repeated=!1,this._released=!1}resize(e){let n=this._state,r=n.length,s;e<=r?s=n.slice(0,e):(s=new Uint8Array(e),s.set(n)),this._state=s,super.resize(e)}getState(e){let n=this._state[e],r=n&Ze?-1:1;return(n&he?1:0)*r}onPoll(e){let n=this._state,r=0,s=0,i=0,a=0,o=0,l=n.length;for(let c=0;c<l;++c){let u=n[c],h=u&he,f=u&Ze;s|=h,i|=u&We,a|=u&Xe,o|=u&Qe,r+=(h?1:0)*(f?-1:1),n[c]&=mr}this._value=r,this._down=s!==0,this._pressed=i!==0,this._repeated=a!==0,this._released=o!==0,super.onPoll(e)}onUpdate(e,n,r){r>0?this.onButtonPressed(e):this.onButtonReleased(e)}onStatus(e,n){this.onButtonStatus(e,n!==0)}onBind(e,n={inverted:!1}){super.onBind(e,n);let{inverted:r=!1}=n,s=this._state;r?s[e]|=Ze:s[e]&=_r}onButtonPressed(e){let n=this._state,r=n[e];r&he||(r|=We,r|=he),r|=Xe,n[e]=r}onButtonReleased(e){let n=this._state,r=n[e];r&he&&(r|=Qe,r&=Dt),n[e]=r}onButtonStatus(e,n){let r=this._state,s=r[e],i=Boolean(s&he);n?s|=he:s&=Dt,i&&!n&&(s|=Qe),!i&&n&&(s|=We,s|=Xe),r[e]=s}},g=class{static parse(e){e=e.trim();let n=e.indexOf(".");if(n<0)throw new Error("Missing device separator for key code.");let r=e.substring(0,n);if(r.length<0)throw new Error("Missing device for key code.");let s=e.substring(n+1);if(s.length<0)throw new Error("Missing code for key code.");return new g(r,s)}constructor(e,n){this.device=e,this.code=n}toString(){return`${this.device}.${this.code}`}};function Je(t,e){return new g(t,e)}function Er(t){return"device"in t&&"code"in t}var R="Keyboard",te="Mouse",vr=new g(R,"KeyA"),Ar=new g(R,"KeyB"),xr=new g(R,"KeyC"),br=new g(R,"KeyD"),yr=new g(R,"KeyE"),gr=new g(R,"KeyF"),wr=new g(R,"KeyG"),Tr=new g(R,"KeyH"),Mr=new g(R,"KeyI"),Sr=new g(R,"KeyJ"),Rr=new g(R,"KeyK"),Ir=new g(R,"KeyL"),Lr=new g(R,"KeyM"),Cr=new g(R,"KeyN"),Nr=new g(R,"KeyO"),Or=new g(R,"KeyP"),Br=new g(R,"KeyQ"),Pr=new g(R,"KeyR"),Dr=new g(R,"KeyS"),Fr=new g(R,"KeyT"),Ur=new g(R,"KeyU"),Hr=new g(R,"KeyV"),kr=new g(R,"KeyW"),Kr=new g(R,"KeyX"),Yr=new g(R,"KeyY"),$r=new g(R,"KeyZ"),Gr=new g(R,"Digit0"),zr=new g(R,"Digit1"),Vr=new g(R,"Digit2"),jr=new g(R,"Digit3"),qr=new g(R,"Digit4"),Wr=new g(R,"Digit5"),Xr=new g(R,"Digit6"),Qr=new g(R,"Digit7"),Zr=new g(R,"Digit8"),Jr=new g(R,"Digit9"),es=new g(R,"Minus"),ts=new g(R,"Equal"),ns=new g(R,"BracketLeft"),rs=new g(R,"BracketRight"),ss=new g(R,"Semicolon"),is=new g(R,"Quote"),as=new g(R,"Backquote"),os=new g(R,"Backslash"),ls=new g(R,"Comma"),us=new g(R,"Period"),cs=new g(R,"Slash"),hs=new g(R,"Escape"),fs=new g(R,"Space"),ds=new g(R,"CapsLock"),ps=new g(R,"Backspace"),ms=new g(R,"Delete"),_s=new g(R,"Tab"),Es=new g(R,"Enter"),vs=new g(R,"ArrowUp"),As=new g(R,"ArrowDown"),xs=new g(R,"ArrowLeft"),bs=new g(R,"ArrowRight"),ys=new g(te,"Button0"),gs=new g(te,"Button1"),ws=new g(te,"Button2"),Ts=new g(te,"Button3"),Ms=new g(te,"Button4"),Ss=new g(te,"PosX"),Rs=new g(te,"PosY"),Is=new g(te,"WheelX"),Ls=new g(te,"WheelY"),Cs=new g(te,"WheelZ"),G=Object.freeze({__proto__:null,ARROW_DOWN:As,ARROW_LEFT:xs,ARROW_RIGHT:bs,ARROW_UP:vs,BACKQUOTE:as,BACKSLASH:os,BACKSPACE:ps,BRACKET_LEFT:ns,BRACKET_RIGHT:rs,CAPS_LOCK:ds,COMMA:ls,DELETE:ms,DIGIT_0:Gr,DIGIT_1:zr,DIGIT_2:Vr,DIGIT_3:jr,DIGIT_4:qr,DIGIT_5:Wr,DIGIT_6:Xr,DIGIT_7:Qr,DIGIT_8:Zr,DIGIT_9:Jr,ENTER:Es,EQUAL:ts,ESCAPE:hs,KEYBOARD:R,KEY_A:vr,KEY_B:Ar,KEY_C:xr,KEY_D:br,KEY_E:yr,KEY_F:gr,KEY_G:wr,KEY_H:Tr,KEY_I:Mr,KEY_J:Sr,KEY_K:Rr,KEY_L:Ir,KEY_M:Lr,KEY_N:Cr,KEY_O:Nr,KEY_P:Or,KEY_Q:Br,KEY_R:Pr,KEY_S:Dr,KEY_T:Fr,KEY_U:Ur,KEY_V:Hr,KEY_W:kr,KEY_X:Kr,KEY_Y:Yr,KEY_Z:$r,MINUS:es,MOUSE:te,MOUSE_BUTTON_0:ys,MOUSE_BUTTON_1:gs,MOUSE_BUTTON_2:ws,MOUSE_BUTTON_3:Ts,MOUSE_BUTTON_4:Ms,MOUSE_POS_X:Ss,MOUSE_POS_Y:Rs,MOUSE_WHEEL_X:Is,MOUSE_WHEEL_Y:Ls,MOUSE_WHEEL_Z:Cs,PERIOD:us,QUOTE:is,SEMICOLON:ss,SLASH:cs,SPACE:fs,TAB:_s,from:Je,isKeyCode:Er}),et=class{get polling(){return this.ref?this.ref.polling:!1}get value(){return!this.ref||this.disabled?0:this.ref.value}constructor(e){this.name=e,this.ref=null,this.disabled=!1}bindTo(e){throw new Error("Unsupported operation.")}disable(e=!0){return this.disabled=e,this}getState(e){return!this.ref||this.disabled?0:this.ref.getState(e)}};function Ft(t){Array.isArray(t)||(t=[t]);let e=[];for(let n of t){let r;try{r=g.parse(n)}catch(s){let i=Ns(n).toUpperCase();if(!(i in G))throw new Error("Invalid key code string - "+s);r=G[i]}e.push(r)}return e}function Ns(t){return t.replace(/([a-z]|(?:[A-Z0-9]+))([A-Z0-9]|$)/g,function(e,n,r){return n+(r&&"_"+r)}).toLowerCase()}var fe=class extends et{static fromBind(e,n,r,s=void 0){return new fe(e,Je(n,r),s)}static fromString(e,...n){let r=Ft(n);return new fe(e,r)}get delta(){return!this.ref||this.disabled?0:this.ref.delta}constructor(e,n,r=void 0){super(e);this.keyCodes=Array.isArray(n)?n:[n],this.opts=r}bindTo(e){let n=this.name,r=this.opts;for(let s of this.keyCodes)e.bindAxis(n,s.device,s.code,r);return this.ref=e.getAxis(n),this}},q=class extends et{static fromBind(e,n,r,s=void 0){return new q(e,Je(n,r),s)}static fromString(e,...n){let r=Ft(n);return new q(e,r)}get pressed(){return!this.ref||this.disabled?!1:this.ref.pressed}get repeated(){return!this.ref||this.disabled?!1:this.ref.repeated}get released(){return!this.ref||this.disabled?!1:this.ref.released}get down(){return!this.ref||this.disabled?!1:this.ref.down}constructor(e,n,r=void 0){super(e);this.keyCodes=Array.isArray(n)?n:[n],this.opts=r}bindTo(e){let n=this.name,r=this.opts;for(let s of this.keyCodes)e.bindButton(n,s.device,s.code,r);return this.ref=e.getButton(n),this}};var tt=class{static isAxis(e){return!1}static isButton(e){return!1}constructor(e,n){if(!n)throw new Error(`Missing event target for device ${e}.`);this.name=e,this.eventTarget=n,this.listeners={input:[]}}setEventTarget(e){if(!e)throw new Error(`Missing event target for device ${this.name}.`);this.eventTarget=e}destroy(){let e=this.listeners;for(let n in e)e[n].length=0}addEventListener(e,n){let r=this.listeners;e in r?r[e].push(n):r[e]=[n]}removeEventListener(e,n){let r=this.listeners;if(e in r){let s=r[e],i=s.indexOf(n);i>=0&&s.splice(i,1)}}dispatchInputEvent(e){let n=0;for(let r of this.listeners.input)n|=r(e);return Boolean(n)}},Ut=class extends tt{static isAxis(e){return!1}static isButton(e){return!0}constructor(e,n,r={}){super(e,n);let{ignoreRepeat:s=!0}=r;this.ignoreRepeat=s,this._eventObject={target:n,device:e,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),n.addEventListener("keydown",this.onKeyDown),n.addEventListener("keyup",this.onKeyUp)}setEventTarget(e){this.eventTarget&&this.destroy(),super.setEventTarget(e),e.addEventListener("keydown",this.onKeyDown),e.addEventListener("keyup",this.onKeyUp)}destroy(){let e=this.eventTarget;e.removeEventListener("keydown",this.onKeyDown),e.removeEventListener("keyup",this.onKeyUp),super.destroy()}onKeyDown(e){if(e.repeat&&this.ignoreRepeat)return e.preventDefault(),e.stopPropagation(),!1;let n=this._eventObject;if(n.code=e.code,n.event="pressed",n.value=1,n.control=e.ctrlKey,n.shift=e.shiftKey,n.alt=e.altKey,this.dispatchInputEvent(n))return e.preventDefault(),e.stopPropagation(),!1}onKeyUp(e){let n=this._eventObject;if(n.code=e.code,n.event="released",n.value=1,n.control=e.ctrlKey,n.shift=e.shiftKey,n.alt=e.altKey,this.dispatchInputEvent(n))return e.preventDefault(),e.stopPropagation(),!1}},nt=10,rt=100,Ht=class extends tt{static isAxis(e){return e==="PosX"||e==="PosY"||e==="WheelX"||e==="WheelY"||e==="WheelZ"}static isButton(e){return!this.isAxis(e)}constructor(e,n,r={}){super(e,n);let{eventsOnFocus:s=!0}=r;this.eventsOnFocus=s,this.canvasTarget=this.getCanvasFromEventTarget(n),this._downHasFocus=!1,this._eventObject={target:n,device:e,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this._positionObject={target:n,device:e,code:"",event:"move",value:0,movement:0},this._wheelObject={target:n,device:e,code:"",event:"wheel",movement:0},this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onWheel=this.onWheel.bind(this),n.addEventListener("mousedown",this.onMouseDown),n.addEventListener("contextmenu",this.onContextMenu),n.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}setEventTarget(e){this.eventTarget&&this.destroy(),super.setEventTarget(e),this.canvasTarget=this.getCanvasFromEventTarget(e),e.addEventListener("mousedown",this.onMouseDown),e.addEventListener("contextmenu",this.onContextMenu),e.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}destroy(){let e=this.eventTarget;e.removeEventListener("mousedown",this.onMouseDown),e.removeEventListener("contextmenu",this.onContextMenu),e.removeEventListener("wheel",this.onWheel),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),super.destroy()}setPointerLock(e=!0){e?this.eventTarget.requestPointerLock():this.eventTarget.exitPointerLock()}hasPointerLock(){return document.pointerLockElement===this.eventTarget}onMouseDown(e){this._downHasFocus=!0;let n=this._eventObject;if(n.code="Button"+e.button,n.event="pressed",n.value=1,n.control=e.ctrlKey,n.shift=e.shiftKey,n.alt=e.altKey,this.dispatchInputEvent(n)&&document.activeElement===this.eventTarget)return e.preventDefault(),e.stopPropagation(),!1}onContextMenu(e){return e.preventDefault(),e.stopPropagation(),!1}onWheel(e){let n,r,s;switch(e.deltaMode){case WheelEvent.DOM_DELTA_LINE:n=e.deltaX*nt,r=e.deltaY*nt,s=e.deltaZ*nt;break;case WheelEvent.DOM_DELTA_PAGE:n=e.deltaX*rt,r=e.deltaY*rt,s=e.deltaZ*rt;break;case WheelEvent.DOM_DELTA_PIXEL:default:n=e.deltaX,r=e.deltaY,s=e.deltaZ;break}let i=0,a=this._wheelObject;if(a.code="WheelX",a.movement=n,i|=this.dispatchInputEvent(a),a.code="WheelY",a.movement=r,i|=this.dispatchInputEvent(a),a.code="WheelZ",a.movement=s,i|=this.dispatchInputEvent(a),i)return e.preventDefault(),e.stopPropagation(),!1}onMouseUp(e){if(!this._downHasFocus)return;this._downHasFocus=!1;let n=this._eventObject;if(n.code="Button"+e.button,n.event="released",n.value=1,n.control=e.ctrlKey,n.shift=e.shiftKey,n.alt=e.altKey,this.dispatchInputEvent(n))return e.preventDefault(),e.stopPropagation(),!1}onMouseMove(e){if(this.eventsOnFocus&&document.activeElement!==this.eventTarget)return;let n=this.canvasTarget,{clientWidth:r,clientHeight:s}=n,i=n.getBoundingClientRect(),a=e.movementX/r,o=e.movementY/s,l=(e.clientX-i.left)/r,c=(e.clientY-i.top)/s,u=this._positionObject;u.code="PosX",u.value=l,u.movement=a,this.dispatchInputEvent(u),u.code="PosY",u.value=c,u.movement=o,this.dispatchInputEvent(u)}getCanvasFromEventTarget(e){return e instanceof HTMLCanvasElement?e:e.canvas||e.querySelector("canvas")||e.shadowRoot&&e.shadowRoot.querySelector("canvas")||e}},Os=`<kbd>
  <span id="name"><slot></slot></span>
  <span id="value" class="hidden"></span>
</kbd>
`,Bs=`kbd {
  position: relative;
  display: inline-block;
  border-radius: 3px;
  border: 1px solid #888888;
  font-size: 0.85em;
  font-weight: 700;
  text-rendering: optimizeLegibility;
  line-height: 12px;
  height: 14px;
  padding: 2px 4px;
  color: #444444;
  background-color: #eeeeee;
  box-shadow: inset 0 -3px 0 #aaaaaa;
  overflow: hidden;
}

kbd:empty::after {
  content: '<?>';
  opacity: 0.6;
}

.disabled {
  opacity: 0.6;
  box-shadow: none;
  background-color: #aaaaaa;
}

.hidden {
  display: none;
}

#value {
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  font-size: 0.85em;
  padding: 0 4px;
  padding-top: 2px;
  color: #cccccc;
  background-color: #333333;
  box-shadow: inset 0 3px 0 #222222;
}
`,st=class extends HTMLElement{static get[Symbol.for("templateNode")](){let e=document.createElement("template");return e.innerHTML=Os,Object.defineProperty(this,Symbol.for("templateNode"),{value:e}),e}static get[Symbol.for("styleNode")](){let e=document.createElement("style");return e.innerHTML=Bs,Object.defineProperty(this,Symbol.for("styleNode"),{value:e}),e}static define(e=window.customElements){e.define("input-code",this)}static get observedAttributes(){return["name","value","disabled"]}get disabled(){return this._disabled}set disabled(e){this.toggleAttribute("disabled",e)}get value(){return this._value}set value(e){this.setAttribute("value",e)}get name(){return this._name}set name(e){this.setAttribute("name",e)}constructor(){super();let e=this.constructor,n=this.attachShadow({mode:"open"});n.appendChild(e[Symbol.for("templateNode")].content.cloneNode(!0)),n.appendChild(e[Symbol.for("styleNode")].cloneNode(!0)),this._name="",this._value="",this._disabled=!1,this._kbdElement=n.querySelector("kbd"),this._nameElement=n.querySelector("#name"),this._valueElement=n.querySelector("#value")}attributeChangedCallback(e,n,r){switch(e){case"name":this._name=r,this._nameElement.textContent=r;break;case"value":this._value=r,r!==null?(this._valueElement.classList.toggle("hidden",!1),this._valueElement.textContent=r,this._kbdElement.style.paddingRight=`${this._valueElement.clientWidth+4}px`):this._valueElement.classList.toggle("hidden",!0);break;case"disabled":this._disabled=r!==null,this._kbdElement.classList.toggle("disabled",r!==null);break}}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"name")){let e=this.name;delete this.name,this.name=e}if(Object.prototype.hasOwnProperty.call(this,"value")){let e=this.value;delete this.value,this.value=e}if(Object.prototype.hasOwnProperty.call(this,"disabled")){let e=this.disabled;delete this.disabled,this.disabled=e}}};st.define();var Ps=`<table>
  <thead>
    <tr class="tableHeader">
      <th colspan="3">
        <span class="tableTitle">
          <label id="title"> input-source </label>
          <span id="slotContainer">
            <slot></slot>
          </span>
          <p>
            <label for="poll">poll</label>
            <output id="poll"></output>
          </p>
          <p>
            <label for="focus">focus</label>
            <output id="focus"></output>
          </p>
        </span>
      </th>
    </tr>
    <tr class="colHeader">
      <th>name</th>
      <th>value</th>
      <th>key</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
`,Ds=`:host {
  display: block;
}

table {
  border-collapse: collapse;
  font-family: monospace;
}

table,
th,
td {
  border: 1px solid #666666;
}

th,
td {
  padding: 5px 10px;
}

td {
  text-align: center;
}

thead th {
  padding: 0;
}

.colHeader > th {
  font-size: 0.8em;
  padding: 0 10px;
  letter-spacing: 3px;
  background-color: #aaaaaa;
  color: #666666;
}

tbody output {
  border-radius: 0.3em;
  padding: 3px;
}

tr:not(.primary) .name,
tr:not(.primary) .value {
  opacity: 0.3;
}

tr:nth-child(2n) {
  background-color: #eeeeee;
}

.tableHeader {
  color: #666666;
}

.tableTitle {
  display: flex;
  flex-direction: row;
  align-items: center;
  padding: 4px;
}

#slotContainer {
  flex: 1;
}

p {
  display: inline;
  margin: 0;
  padding: 0;
  padding-right: 10px;
}

#poll:empty::after,
#focus:empty::after {
  content: '\u2717';
  color: #ff0000;
}
`,kt=class{constructor(e){this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null,this.pollable=e}get running(){return this.animationFrameHandle!==null}start(){let e=this.animationFrameHandle;e&&cancelAnimationFrame(e),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}stop(){let e=this.animationFrameHandle;e&&cancelAnimationFrame(e),this.animationFrameHandle=null}onAnimationFrame(e){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.pollable.onPoll(e)}},Kt=class{constructor(e){this.onInput=this.onInput.bind(this),this.onPoll=this.onPoll.bind(this),this.bindings=e}onPoll(e){for(let n of this.bindings.getInputs())n.onPoll(e)}onInput(e){let{device:n,code:r,event:s,value:i,movement:a,control:o,shift:l,alt:c}=e,u=this.bindings.getBindings(n,r);switch(s){case"pressed":for(let{input:h,index:f}of u)h.onUpdate(f,1,1);break;case"released":for(let{input:h,index:f}of u)h.onUpdate(f,0,-1);break;case"move":for(let{input:h,index:f}of u)h.onUpdate(f,i,a);break;case"wheel":for(let{input:h,index:f}of u)h.onUpdate(f,void 0,a);break}return u.length>0}},it=class{constructor(e,n,r,s){this.device=e,this.code=n,this.input=r,this.index=s}},Yt=class{constructor(){this.bindingMap={},this.inputMap=new Map}clear(){for(let e of this.inputMap.keys())e.onUnbind();this.inputMap.clear(),this.bindingMap={}}bind(e,n,r,s={inverted:!1}){let i,a=this.inputMap;if(a.has(e)){let l=a.get(e),c=e.size;e.onBind(c,s),i=new it(n,r,e,c),l.push(i)}else{let l=[];a.set(e,l);let c=0;e.onBind(c,s),i=new it(n,r,e,c),l.push(i)}let o=this.bindingMap;n in o?r in o[n]?o[n][r].push(i):o[n][r]=[i]:o[n]={[r]:[i]}}unbind(e){let n=this.inputMap;if(n.has(e)){let r=this.bindingMap,s=n.get(e);for(let i of s){let{device:a,code:o}=i,l=r[a][o],c=l.indexOf(i);l.splice(c,1)}s.length=0,e.onUnbind(),n.delete(e)}}isBound(e){return this.inputMap.has(e)}getInputs(){return this.inputMap.keys()}getBindingsByInput(e){return this.inputMap.get(e)}getBindings(e,n){let r=this.bindingMap;if(e in r){let s=r[e];if(n in s)return s[n]}return[]}},$t=class{constructor(e,n=void 0){this.inputs={},this.devices=[new Ht("Mouse",e),new Ut("Keyboard",e)],this.bindings=new Yt,this.adapter=new Kt(this.bindings),this.autopoller=new kt(this.adapter),this.eventTarget=e,this.anyButton=new Ne(1),this.anyButtonDevice="",this.anyButtonCode="",this.anyAxis=new xe(1),this.anyAxisDevice="",this.anyAxisCode="",this.listeners={bind:[],unbind:[],focus:[],blur:[]},this.onInput=this.onInput.bind(this),this.onEventTargetBlur=this.onEventTargetBlur.bind(this),this.onEventTargetFocus=this.onEventTargetFocus.bind(this),e.addEventListener("focus",this.onEventTargetFocus),e.addEventListener("blur",this.onEventTargetBlur);for(let r of this.devices)r.addEventListener("input",this.onInput)}get autopoll(){return this.autopoller.running}set autopoll(e){this.toggleAutoPoll(e)}destroy(){let e=this.listeners;for(let r in e)e[r].length=0;this.autopoller.running&&this.autopoller.stop();for(let r of this.devices)r.removeEventListener("input",this.onInput),r.destroy();let n=this.eventTarget;n.removeEventListener("focus",this.onEventTargetFocus),n.removeEventListener("blur",this.onEventTargetBlur)}setEventTarget(e){let n=this.eventTarget;n.removeEventListener("focus",this.onEventTargetFocus),n.removeEventListener("blur",this.onEventTargetBlur),this.eventTarget=e;for(let r of this.devices)r.setEventTarget(e);e.addEventListener("focus",this.onEventTargetFocus),e.addEventListener("blur",this.onEventTargetBlur)}toggleAutoPoll(e=void 0){let n=this.autopoller.running,r=typeof e=="undefined"?!n:Boolean(e);r!==n&&(r?this.autopoller.start():this.autopoller.stop())}addEventListener(e,n){let r=this.listeners;e in r?r[e].push(n):r[e]=[n]}removeEventListener(e,n){let r=this.listeners;if(e in r){let s=r[e],i=s.indexOf(n);i>=0&&s.splice(i,1)}}dispatchEvent(e){let{type:n}=e,r=0;for(let s of this.listeners[n])r|=s(e)?1:0;return Boolean(r)}poll(e=performance.now()){if(this.autopoller.running)throw new Error("Should not manually poll() while autopolling.");this.onPoll(e)}onInput(e){let n=this.adapter.onInput(e);switch(e.event){case"pressed":this.anyButtonDevice=e.device,this.anyButtonCode=e.code,this.anyButton.onUpdate(0,1,1);break;case"released":this.anyButtonDevice=e.device,this.anyButtonCode=e.code,this.anyButton.onUpdate(0,0,-1);break;case"move":case"wheel":this.anyAxisDevice=e.device,this.anyAxisCode=e.code,this.anyAxis.onUpdate(0,e.value,e.movement);break}return n}onPoll(e){this.adapter.onPoll(e),this.anyButton.onPoll(e),this.anyAxis.onPoll(e)}onBind(){this.dispatchEvent({type:"bind"})}onUnbind(){this.dispatchEvent({type:"unbind"})}onEventTargetFocus(){this.dispatchEvent({type:"focus"})}onEventTargetBlur(){for(let e of this.bindings.getInputs())e.onStatus(0,0);this.anyButton.onStatus(0,0),this.anyAxis.onStatus(0,0),this.dispatchEvent({type:"blur"})}bindBindings(e){Array.isArray(e)||(e=Object.values(e));for(let n of e)n.bindTo(this)}bindBinding(e){e.bindTo(this)}bindButton(e,n,r,s=void 0){let i;this.hasButton(e)?i=this.getButton(e):(i=new Ne(1),this.inputs[e]=i),this.bindings.bind(i,n,r,s),this.onBind()}bindAxis(e,n,r,s=void 0){let i;this.hasAxis(e)?i=this.getAxis(e):(i=new xe(1),this.inputs[e]=i),this.bindings.bind(i,n,r,s),this.onBind()}bindAxisButtons(e,n,r,s){let i;this.hasAxis(e)?i=this.getAxis(e):(i=new xe(2),this.inputs[e]=i),this.bindings.bind(i,n,s),this.bindings.bind(i,n,r,{inverted:!0}),this.onBind()}unbindButton(e){if(this.hasButton(e)){let n=this.getButton(e);delete this.inputs[e],this.bindings.unbind(n),this.onUnbind()}}unbindAxis(e){if(this.hasAxis(e)){let n=this.getAxis(e);delete this.inputs[e],this.bindings.unbind(n),this.onUnbind()}}getInput(e){return this.inputs[e]}getButton(e){return this.inputs[e]}getAxis(e){return this.inputs[e]}hasButton(e){return e in this.inputs&&this.inputs[e]instanceof Ne}hasAxis(e){return e in this.inputs&&this.inputs[e]instanceof xe}isButtonDown(e){return this.inputs[e].down}isButtonPressed(e){return this.inputs[e].pressed}isButtonReleased(e){return this.inputs[e].released}getInputValue(e){return this.inputs[e].value}getButtonValue(e){return this.inputs[e].value}getAxisValue(e){return this.inputs[e].value}getAxisDelta(e){return this.inputs[e].delta}isAnyButtonDown(e=void 0){if(typeof e=="undefined")return this.anyButton.down;{let n=this.inputs;for(let r of e)if(n[r].down)return!0}return!1}isAnyButtonPressed(e=void 0){if(typeof e=="undefined")return this.anyButton.pressed;{let n=this.inputs;for(let r of e)if(n[r].pressed)return!0}return!1}isAnyButtonReleased(e=void 0){if(typeof e=="undefined")return this.anyButton.released;{let n=this.inputs;for(let r of e)if(n[r].released)return!0}return!1}getAnyAxisValue(e=void 0){if(typeof e=="undefined")return this.anyAxis.value;{let n=this.inputs;for(let r of e){let s=n[r];if(s.value)return s.value}}return 0}getAnyAxisDelta(e=void 0){if(typeof e=="undefined")return this.anyAxis.delta;{let n=this.inputs;for(let r of e){let s=n[r];if(s.delta)return s.delta}}return 0}getLastButtonDevice(){return this.anyButtonDevice}getLastButtonCode(){return this.anyButtonCode}getLastAxisDevice(){return this.anyAxisDevice}getLastAxisCode(){return this.anyAxisCode}getMouse(){return this.devices[0]}getKeyboard(){return this.devices[1]}},Oe=class extends HTMLElement{static create(e={}){let{root:n=document.body,id:r=void 0,for:s=void 0,autopoll:i=!1}=e||{},a=new Oe;return a.id=r,a.for=s,a.autopoll=i,n.appendChild(a),a}static get[Symbol.for("templateNode")](){let e=document.createElement("template");return e.innerHTML=Ps,Object.defineProperty(this,Symbol.for("templateNode"),{value:e}),e}static get[Symbol.for("styleNode")](){let e=document.createElement("style");return e.innerHTML=Ds,Object.defineProperty(this,Symbol.for("styleNode"),{value:e}),e}static define(e=window.customElements){e.define("input-port",this)}static get observedAttributes(){return["autopoll","for"]}get autopoll(){return this._autopoll}set autopoll(e){this.toggleAttribute("autopoll",e)}get for(){return this._for}set for(e){this.setAttribute("for",e)}constructor(){super();let e=this.attachShadow({mode:"open"});e.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),e.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._titleElement=e.querySelector("#title"),this._pollElement=e.querySelector("#poll"),this._focusElement=e.querySelector("#focus"),this._bodyElement=e.querySelector("tbody"),this._outputElements={},this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null;let n=this;this._for="",this._eventTarget=n,this._autopoll=!1,this._context=null,this.onInputContextBind=this.onInputContextBind.bind(this),this.onInputContextUnbind=this.onInputContextUnbind.bind(this),this.onInputContextFocus=this.onInputContextFocus.bind(this),this.onInputContextBlur=this.onInputContextBlur.bind(this)}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"for")){let e=this.for;delete this.for,this.for=e}if(Object.prototype.hasOwnProperty.call(this,"autopoll")){let e=this.autopoll;delete this.autopoll,this.autopoll=e}this.updateTable(),this.updateTableValues(),this.animationFrameHandle=window.requestAnimationFrame(this.onAnimationFrame)}disconnectedCallback(){let e=this._context;e&&(e.removeEventListener("bind",this.onInputContextBind),e.removeEventListener("unbind",this.onInputContextUnbind),e.removeEventListener("blur",this.onInputContextBlur),e.removeEventListener("focus",this.onInputContextFocus),e.destroy(),this._context=null)}attributeChangedCallback(e,n,r){switch(e){case"for":{this._for=r;let s,i;r?(s=document.getElementById(r),i=`${s.tagName.toLowerCase()}#${r}`):(s=this,i="input-port"),this._eventTarget=s,this._context&&this._context.setEventTarget(this._eventTarget),this._titleElement.innerHTML=`for ${i}`}break;case"autopoll":this._autopoll=r!==null,this._context&&this._context.toggleAutoPoll(this._autopoll);break}}onAnimationFrame(){this.animationFrameHandle=window.requestAnimationFrame(this.onAnimationFrame),this.updateTableValues(),this.updatePollStatus()}onInputContextBind(){return this.updateTable(),!0}onInputContextUnbind(){return this.updateTable(),!0}onInputContextFocus(){return this._focusElement.innerHTML="\u2713",!0}onInputContextBlur(){return this._focusElement.innerHTML="",!0}getContext(e="axisbutton",n=void 0){switch(e){case"axisbutton":if(!this._context){let r=new $t(this._eventTarget,n);r.addEventListener("bind",this.onInputContextBind),r.addEventListener("unbind",this.onInputContextUnbind),r.addEventListener("blur",this.onInputContextBlur),r.addEventListener("focus",this.onInputContextFocus),this._autopoll&&r.toggleAutoPoll(!0),this._context=r}return this._context;default:throw new Error(`Input context id '${e}' is not supported.`)}}updateTable(){if(this.isConnected)if(this._context){let e=this._context,n=e.inputs,r=e.bindings,s={},i=[];for(let a of Object.keys(n)){let o=n[a],l=!0;for(let c of r.getBindingsByInput(o)){let u=Fs(`${o.constructor.name}.${a}`,`${c.device}.${c.code}`,0,l);i.push(u),l&&(s[a]=u.querySelector("output"),l=!1)}}this._outputElements=s,this._bodyElement.innerHTML="";for(let a of i)this._bodyElement.appendChild(a)}else{this._outputElements={},this._bodyElement.innerHTML="";return}else return}updateTableValues(){if(this.isConnected)if(this._context){let n=this._context.inputs;for(let r of Object.keys(this._outputElements)){let s=this._outputElements[r],i=n[r].value;s.innerText=Number(i).toFixed(2)}}else{for(let e of Object.keys(this._outputElements)){let n=this._outputElements[e];n.innerText="---"}return}else return}updatePollStatus(){if(this.isConnected)if(this._context){let n=this._context.inputs;for(let r of Object.values(n))if(!r.polling){this._pollElement.innerHTML="";return}this._pollElement.innerHTML="\u2713"}else{this._pollElement.innerHTML="-";return}else return}};Oe.define();function Fs(t,e,n,r=!0){let s=document.createElement("tr");r&&s.classList.add("primary");{let i=document.createElement("td");i.textContent=t,i.classList.add("name"),s.appendChild(i)}{let i=document.createElement("td"),a=document.createElement("output");r?a.innerText=Number(n).toFixed(2):a.innerText="---",a.classList.add("value"),i.appendChild(a),s.appendChild(i)}{let i=document.createElement("td");i.classList.add("key");let a=new st;a.innerText=e,i.appendChild(a),s.appendChild(i)}return s}var Wo=Symbol("keyboardSource");var Xo=Symbol("mouseSource");var bn=hr(xn());var ge=class{constructor(e){let n;typeof e=="object"&&e instanceof ge?n=e.source:n=String(e),this.source=n,this._re=(0,bn.makeRe)(n)}test(e){return this._re.test(e)}},xi=/^([_\w\d]+)\:\/\//;async function yn(t,e,n,r,s,i){let{loadings:a}=t,o;e in a?o=a[e]:(o=new Ee(i),a[e]=o);let l=Ee.nextAttempt(o),c=[o.promise];return xi.test(n)?c.push(gn(t,n,i).then(u=>r(u,s)).then(u=>Ee.isCurrentAttempt(o,l)?Ke(t,e,u):void 0)):c.push(fetch(n).then(u=>u.arrayBuffer()).then(u=>r(u)).then(u=>Ee.isCurrentAttempt(o,l)?Ke(t,e,u):void 0)),await Promise.race(c)}function Ke(t,e,n){let{store:r,loadings:s}=t;return r[e]=n,e in s&&(s[e].resolve(n),delete s[e]),n}function bi(t,e,n){let{defaults:r}=t;typeof e=="string"&&(e=new ge(e));let s=`__default://[${r.length}]`;return Ke(t,s,n),r.push(new Mn(e,s)),n}function yi(t,e){let{store:n,loadings:r}=t;e in r&&(r[e].reject(new Error("Stop loading to delete asset.")),delete r[e]),e in n&&delete n[e]}function gi(t,e){typeof e=="string"&&(e=new ge(e));let{store:n,loadings:r}=t;for(let[s,i]of Object.entries(r))e.test(s)&&(i.reject(new Error(`Stop loading to clear assets matching ${e}`)),delete r[s]);for(let s of Object.keys(n))e.test(s)&&delete n[s]}function wi(t){let{store:e,loadings:n,defaults:r}=t;for(let[s,i]of Object.entries(n))i.reject(new Error("Stop loading to clear all assets.")),delete n[s];for(let s of Object.keys(e))delete e[s];r.length=0}function Ti(t,e){let{loadings:n}=t;return e in n?n[e].promise:null}async function gn(t,e,n){let{store:r,loadings:s}=t;if(e in r)return r[e];if(e in s)return s[e].promise;{let i=new Ee(n);return s[e]=i,i.promise}}function Mi(t,e){let{defaults:n}=t;for(let r of n)if(r.glob.test(e))return Ye(t,r.uri);return null}function Ye(t,e){return t.store[e]}function Si(t,e){return Boolean(t.store[e])}function Ri(t){return Object.keys(t.store)}function wn(t,e){return e in t.store}function Tn(t,e){return e in t.loadings}var Mn=class{constructor(e,n){this.glob=e,this.uri=n}},Ee=class{static nextAttempt(e){return++e._promiseHandle}static isCurrentAttempt(e,n){return e._promiseHandle===n}constructor(e){this._promiseHandle=0,this._resolve=null,this._reject=null,this._reason=null,this._value=null,this._timeoutHandle=Number.isFinite(e)&&e>0?setTimeout(()=>{this.reject(`Asset loading exceeded timeout of ${e} ms.`)},e):null,this._promise=new Promise((n,r)=>{this._value?n(this._value):this._resolve=n,this._reason?r(this._reason):this._reject=r})}get promise(){return this._promise}resolve(e){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._resolve?this._resolve(e):this._value=e}reject(e){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._reject?this._reject(e):this._reason=e}},we=class{constructor(e=null){this.parent=e,this.store={},this.loadings={},this.defaults=[]}get(e){let n=this;if(wn(n,e))return Ye(n,e);let r=Mi(n,e);return r||null}async resolve(e,n,r,s,i){return this.get(e)||await this.load(e,n,r,s,i)}fallback(e,n){return bi(this,e,n)}cache(e,n){return Ke(this,e,n)}async load(e,n,r,s,i){let a=this;return wn(a,e)?Ye(a,e):Tn(a,e)?await gn(a,e,i):await yn(a,e,n,r,s,i)}async reload(e,n,r,s,i){return await yn(this,e,n,r,s,i)}unload(e){yi(this,e)}clear(e){gi(this,e)}current(e){return Ye(this,e)}exists(e){return Si(this,e)}loading(e){let n=this;return Tn(n,e)?Ti(n,e):null}keys(){return Ri(this)}reset(){wi(this)}},Sn=5e3,ve=class{constructor(e,n,r=void 0,s=e,i=null){this.uri=e,this.loader=n,this.opts=r,this.initial=i,this.filepath=s,this.source=null,this.current=null}cache(e,n){return e.cache(this.uri,n),this.source=e,this.current=n,this}get(e){let n;return e.exists(this.uri)?n=e.current(this.uri):this.initial&&this.initial instanceof ve?n=this.initial.get(e):n=this.initial,this.source=e,this.current=n,n}async load(e,n=Sn){let r;if(e.exists(this.uri))r=e.current(this.uri);else if(r=await e.load(this.uri,this.filepath,this.loader,this.opts,n),!r)if(this.initial&&this.initial instanceof ve){let s=this.initial;r=await e.load(s.uri,s.filepath,s.loader,s.opts,n)}else r=this.initial;return this.source=e,this.current=r,r}async reload(e,n=Sn){let r=await e.reload(this.uri,this.filepath,this.loader,this.opts,n);return this.source=e,this.current=r,r}};async function xt(t,e=void 0){let{imageType:n=void 0}=e||{};if(typeof t=="string"){let l=await(await fetch(t)).arrayBuffer();if(typeof n=="undefined"){let c=t.lastIndexOf(".");if(c<0)throw new Error("Cannot load from url - unknown image type.");n="image/"+t.slice(c+1)}return xt(l,{...e,imageType:n})}else if(!(t instanceof ArrayBuffer||ArrayBuffer.isView(t)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let r=t;typeof n=="undefined"&&(n="image/png");let s=new Blob([r],{type:n}),i=URL.createObjectURL(s),a=new Image;return new Promise((o,l)=>{a.addEventListener("load",()=>{o(a)}),a.addEventListener("error",c=>{l(c)}),a.src=i})}window.addEventListener("error",$e,!0);window.addEventListener("unhandledrejection",$e,!0);function $e(t){typeof t=="object"?t instanceof PromiseRejectionEvent?$e(t.reason):t instanceof ErrorEvent?$e(t.error):t instanceof Error?window.alert(t.stack):window.alert(JSON.stringify(t)):window.alert(t)}var se={CursorX:new fe("cursorX",[G.MOUSE_POS_X]),CursorY:new fe("cursorY",[G.MOUSE_POS_Y]),CursorMain:new q("cursorMain",G.MOUSE_BUTTON_0),CursorAlt:new q("cursorAlt",G.MOUSE_BUTTON_2),MoveLeft:new q("moveLeft",[G.KEY_A,G.ARROW_LEFT]),MoveRight:new q("moveRight",[G.KEY_D,G.ARROW_RIGHT]),MoveUp:new q("moveUp",[G.KEY_Q]),MoveDown:new q("moveDown",[G.KEY_E]),MoveForward:new q("moveForward",[G.KEY_W,G.ARROW_UP]),MoveBackward:new q("moveBackward",[G.KEY_S,G.ARROW_DOWN]),MainAction:new q("mainAction",[G.KEY_Z,G.KEY_Q]),AltAction:new q("altAction",[G.KEY_X,G.KEY_E]),Evade:new q("evade",[G.SPACE])};var Rn={ImageToast:new ve("toast",xt,void 0,"res/toast.png")};var oe={};Le(oe,{connectInputs:()=>Ii,getDisplayPort:()=>Ni,getInputPort:()=>Oi,preloadAssetPack:()=>Li,preloadAssets:()=>Ci});async function Ii(t,e="input-port"){let r=document.querySelector(e).getContext("axisbutton");return r.bindBindings(Object.values(t)),r}async function Li(){await we.loadAssetPack("res.pack",(t,e)=>we.cache(e,t))}async function Ci(t,e="asset-port"){await we.loadAssetRefs(Object.values(t))}function Ni(t=document,e="display-port"){return t.querySelector(e)}function Oi(t=document,e="input-port"){return t.querySelector(e)}var k=1e-6,ee=typeof Float32Array!="undefined"?Float32Array:Array,bt=Math.random;var dl=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var ie={};Le(ie,{add:()=>Ea,adjoint:()=>Ki,clone:()=>Pi,copy:()=>Di,create:()=>Bi,determinant:()=>Yi,equals:()=>ba,exactEquals:()=>xa,frob:()=>_a,fromQuat:()=>aa,fromQuat2:()=>ta,fromRotation:()=>Qi,fromRotationTranslation:()=>Cn,fromRotationTranslationScale:()=>sa,fromRotationTranslationScaleOrigin:()=>ia,fromScaling:()=>Xi,fromTranslation:()=>Wi,fromValues:()=>Fi,fromXRotation:()=>Zi,fromYRotation:()=>Ji,fromZRotation:()=>ea,frustum:()=>oa,getRotation:()=>ra,getScaling:()=>Nn,getTranslation:()=>na,identity:()=>In,invert:()=>ki,lookAt:()=>da,mul:()=>ya,multiply:()=>Ln,multiplyScalar:()=>va,multiplyScalarAndAdd:()=>Aa,ortho:()=>ha,orthoNO:()=>Bn,orthoZO:()=>fa,perspective:()=>la,perspectiveFromFieldOfView:()=>ca,perspectiveNO:()=>On,perspectiveZO:()=>ua,rotate:()=>zi,rotateX:()=>Vi,rotateY:()=>ji,rotateZ:()=>qi,scale:()=>Gi,set:()=>Ui,str:()=>ma,sub:()=>ga,subtract:()=>Pn,targetTo:()=>pa,translate:()=>$i,transpose:()=>Hi});function Bi(){var t=new ee(16);return ee!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Pi(t){var e=new ee(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Di(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Fi(t,e,n,r,s,i,a,o,l,c,u,h,f,p,m,v){var d=new ee(16);return d[0]=t,d[1]=e,d[2]=n,d[3]=r,d[4]=s,d[5]=i,d[6]=a,d[7]=o,d[8]=l,d[9]=c,d[10]=u,d[11]=h,d[12]=f,d[13]=p,d[14]=m,d[15]=v,d}function Ui(t,e,n,r,s,i,a,o,l,c,u,h,f,p,m,v,d){return t[0]=e,t[1]=n,t[2]=r,t[3]=s,t[4]=i,t[5]=a,t[6]=o,t[7]=l,t[8]=c,t[9]=u,t[10]=h,t[11]=f,t[12]=p,t[13]=m,t[14]=v,t[15]=d,t}function In(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Hi(t,e){if(t===e){var n=e[1],r=e[2],s=e[3],i=e[6],a=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=i,t[11]=e[14],t[12]=s,t[13]=a,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function ki(t,e){var n=e[0],r=e[1],s=e[2],i=e[3],a=e[4],o=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],p=e[11],m=e[12],v=e[13],d=e[14],x=e[15],L=n*o-r*a,y=n*l-s*a,T=n*c-i*a,M=r*l-s*o,I=r*c-i*o,F=s*c-i*l,S=u*v-h*m,C=u*d-f*m,P=u*x-p*m,E=h*d-f*v,N=h*x-p*v,O=f*x-p*d,B=L*O-y*N+T*E+M*P-I*C+F*S;return B?(B=1/B,t[0]=(o*O-l*N+c*E)*B,t[1]=(s*N-r*O-i*E)*B,t[2]=(v*F-d*I+x*M)*B,t[3]=(f*I-h*F-p*M)*B,t[4]=(l*P-a*O-c*C)*B,t[5]=(n*O-s*P+i*C)*B,t[6]=(d*T-m*F-x*y)*B,t[7]=(u*F-f*T+p*y)*B,t[8]=(a*N-o*P+c*S)*B,t[9]=(r*P-n*N-i*S)*B,t[10]=(m*I-v*T+x*L)*B,t[11]=(h*T-u*I-p*L)*B,t[12]=(o*C-a*E-l*S)*B,t[13]=(n*E-r*C+s*S)*B,t[14]=(v*y-m*M-d*L)*B,t[15]=(u*M-h*y+f*L)*B,t):null}function Ki(t,e){var n=e[0],r=e[1],s=e[2],i=e[3],a=e[4],o=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],p=e[11],m=e[12],v=e[13],d=e[14],x=e[15];return t[0]=o*(f*x-p*d)-h*(l*x-c*d)+v*(l*p-c*f),t[1]=-(r*(f*x-p*d)-h*(s*x-i*d)+v*(s*p-i*f)),t[2]=r*(l*x-c*d)-o*(s*x-i*d)+v*(s*c-i*l),t[3]=-(r*(l*p-c*f)-o*(s*p-i*f)+h*(s*c-i*l)),t[4]=-(a*(f*x-p*d)-u*(l*x-c*d)+m*(l*p-c*f)),t[5]=n*(f*x-p*d)-u*(s*x-i*d)+m*(s*p-i*f),t[6]=-(n*(l*x-c*d)-a*(s*x-i*d)+m*(s*c-i*l)),t[7]=n*(l*p-c*f)-a*(s*p-i*f)+u*(s*c-i*l),t[8]=a*(h*x-p*v)-u*(o*x-c*v)+m*(o*p-c*h),t[9]=-(n*(h*x-p*v)-u*(r*x-i*v)+m*(r*p-i*h)),t[10]=n*(o*x-c*v)-a*(r*x-i*v)+m*(r*c-i*o),t[11]=-(n*(o*p-c*h)-a*(r*p-i*h)+u*(r*c-i*o)),t[12]=-(a*(h*d-f*v)-u*(o*d-l*v)+m*(o*f-l*h)),t[13]=n*(h*d-f*v)-u*(r*d-s*v)+m*(r*f-s*h),t[14]=-(n*(o*d-l*v)-a*(r*d-s*v)+m*(r*l-s*o)),t[15]=n*(o*f-l*h)-a*(r*f-s*h)+u*(r*l-s*o),t}function Yi(t){var e=t[0],n=t[1],r=t[2],s=t[3],i=t[4],a=t[5],o=t[6],l=t[7],c=t[8],u=t[9],h=t[10],f=t[11],p=t[12],m=t[13],v=t[14],d=t[15],x=e*a-n*i,L=e*o-r*i,y=e*l-s*i,T=n*o-r*a,M=n*l-s*a,I=r*l-s*o,F=c*m-u*p,S=c*v-h*p,C=c*d-f*p,P=u*v-h*m,E=u*d-f*m,N=h*d-f*v;return x*N-L*E+y*P+T*C-M*S+I*F}function Ln(t,e,n){var r=e[0],s=e[1],i=e[2],a=e[3],o=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=e[9],p=e[10],m=e[11],v=e[12],d=e[13],x=e[14],L=e[15],y=n[0],T=n[1],M=n[2],I=n[3];return t[0]=y*r+T*o+M*h+I*v,t[1]=y*s+T*l+M*f+I*d,t[2]=y*i+T*c+M*p+I*x,t[3]=y*a+T*u+M*m+I*L,y=n[4],T=n[5],M=n[6],I=n[7],t[4]=y*r+T*o+M*h+I*v,t[5]=y*s+T*l+M*f+I*d,t[6]=y*i+T*c+M*p+I*x,t[7]=y*a+T*u+M*m+I*L,y=n[8],T=n[9],M=n[10],I=n[11],t[8]=y*r+T*o+M*h+I*v,t[9]=y*s+T*l+M*f+I*d,t[10]=y*i+T*c+M*p+I*x,t[11]=y*a+T*u+M*m+I*L,y=n[12],T=n[13],M=n[14],I=n[15],t[12]=y*r+T*o+M*h+I*v,t[13]=y*s+T*l+M*f+I*d,t[14]=y*i+T*c+M*p+I*x,t[15]=y*a+T*u+M*m+I*L,t}function $i(t,e,n){var r=n[0],s=n[1],i=n[2],a,o,l,c,u,h,f,p,m,v,d,x;return e===t?(t[12]=e[0]*r+e[4]*s+e[8]*i+e[12],t[13]=e[1]*r+e[5]*s+e[9]*i+e[13],t[14]=e[2]*r+e[6]*s+e[10]*i+e[14],t[15]=e[3]*r+e[7]*s+e[11]*i+e[15]):(a=e[0],o=e[1],l=e[2],c=e[3],u=e[4],h=e[5],f=e[6],p=e[7],m=e[8],v=e[9],d=e[10],x=e[11],t[0]=a,t[1]=o,t[2]=l,t[3]=c,t[4]=u,t[5]=h,t[6]=f,t[7]=p,t[8]=m,t[9]=v,t[10]=d,t[11]=x,t[12]=a*r+u*s+m*i+e[12],t[13]=o*r+h*s+v*i+e[13],t[14]=l*r+f*s+d*i+e[14],t[15]=c*r+p*s+x*i+e[15]),t}function Gi(t,e,n){var r=n[0],s=n[1],i=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function zi(t,e,n,r){var s=r[0],i=r[1],a=r[2],o=Math.hypot(s,i,a),l,c,u,h,f,p,m,v,d,x,L,y,T,M,I,F,S,C,P,E,N,O,B,_;return o<k?null:(o=1/o,s*=o,i*=o,a*=o,l=Math.sin(n),c=Math.cos(n),u=1-c,h=e[0],f=e[1],p=e[2],m=e[3],v=e[4],d=e[5],x=e[6],L=e[7],y=e[8],T=e[9],M=e[10],I=e[11],F=s*s*u+c,S=i*s*u+a*l,C=a*s*u-i*l,P=s*i*u-a*l,E=i*i*u+c,N=a*i*u+s*l,O=s*a*u+i*l,B=i*a*u-s*l,_=a*a*u+c,t[0]=h*F+v*S+y*C,t[1]=f*F+d*S+T*C,t[2]=p*F+x*S+M*C,t[3]=m*F+L*S+I*C,t[4]=h*P+v*E+y*N,t[5]=f*P+d*E+T*N,t[6]=p*P+x*E+M*N,t[7]=m*P+L*E+I*N,t[8]=h*O+v*B+y*_,t[9]=f*O+d*B+T*_,t[10]=p*O+x*B+M*_,t[11]=m*O+L*B+I*_,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Vi(t,e,n){var r=Math.sin(n),s=Math.cos(n),i=e[4],a=e[5],o=e[6],l=e[7],c=e[8],u=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*s+c*r,t[5]=a*s+u*r,t[6]=o*s+h*r,t[7]=l*s+f*r,t[8]=c*s-i*r,t[9]=u*s-a*r,t[10]=h*s-o*r,t[11]=f*s-l*r,t}function ji(t,e,n){var r=Math.sin(n),s=Math.cos(n),i=e[0],a=e[1],o=e[2],l=e[3],c=e[8],u=e[9],h=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*s-c*r,t[1]=a*s-u*r,t[2]=o*s-h*r,t[3]=l*s-f*r,t[8]=i*r+c*s,t[9]=a*r+u*s,t[10]=o*r+h*s,t[11]=l*r+f*s,t}function qi(t,e,n){var r=Math.sin(n),s=Math.cos(n),i=e[0],a=e[1],o=e[2],l=e[3],c=e[4],u=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*s+c*r,t[1]=a*s+u*r,t[2]=o*s+h*r,t[3]=l*s+f*r,t[4]=c*s-i*r,t[5]=u*s-a*r,t[6]=h*s-o*r,t[7]=f*s-l*r,t}function Wi(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function Xi(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Qi(t,e,n){var r=n[0],s=n[1],i=n[2],a=Math.hypot(r,s,i),o,l,c;return a<k?null:(a=1/a,r*=a,s*=a,i*=a,o=Math.sin(e),l=Math.cos(e),c=1-l,t[0]=r*r*c+l,t[1]=s*r*c+i*o,t[2]=i*r*c-s*o,t[3]=0,t[4]=r*s*c-i*o,t[5]=s*s*c+l,t[6]=i*s*c+r*o,t[7]=0,t[8]=r*i*c+s*o,t[9]=s*i*c-r*o,t[10]=i*i*c+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function Zi(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ji(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ea(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Cn(t,e,n){var r=e[0],s=e[1],i=e[2],a=e[3],o=r+r,l=s+s,c=i+i,u=r*o,h=r*l,f=r*c,p=s*l,m=s*c,v=i*c,d=a*o,x=a*l,L=a*c;return t[0]=1-(p+v),t[1]=h+L,t[2]=f-x,t[3]=0,t[4]=h-L,t[5]=1-(u+v),t[6]=m+d,t[7]=0,t[8]=f+x,t[9]=m-d,t[10]=1-(u+p),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function ta(t,e){var n=new ee(3),r=-e[0],s=-e[1],i=-e[2],a=e[3],o=e[4],l=e[5],c=e[6],u=e[7],h=r*r+s*s+i*i+a*a;return h>0?(n[0]=(o*a+u*r+l*i-c*s)*2/h,n[1]=(l*a+u*s+c*r-o*i)*2/h,n[2]=(c*a+u*i+o*s-l*r)*2/h):(n[0]=(o*a+u*r+l*i-c*s)*2,n[1]=(l*a+u*s+c*r-o*i)*2,n[2]=(c*a+u*i+o*s-l*r)*2),Cn(t,e,n),t}function na(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function Nn(t,e){var n=e[0],r=e[1],s=e[2],i=e[4],a=e[5],o=e[6],l=e[8],c=e[9],u=e[10];return t[0]=Math.hypot(n,r,s),t[1]=Math.hypot(i,a,o),t[2]=Math.hypot(l,c,u),t}function ra(t,e){var n=new ee(3);Nn(n,e);var r=1/n[0],s=1/n[1],i=1/n[2],a=e[0]*r,o=e[1]*s,l=e[2]*i,c=e[4]*r,u=e[5]*s,h=e[6]*i,f=e[8]*r,p=e[9]*s,m=e[10]*i,v=a+u+m,d=0;return v>0?(d=Math.sqrt(v+1)*2,t[3]=.25*d,t[0]=(h-p)/d,t[1]=(f-l)/d,t[2]=(o-c)/d):a>u&&a>m?(d=Math.sqrt(1+a-u-m)*2,t[3]=(h-p)/d,t[0]=.25*d,t[1]=(o+c)/d,t[2]=(f+l)/d):u>m?(d=Math.sqrt(1+u-a-m)*2,t[3]=(f-l)/d,t[0]=(o+c)/d,t[1]=.25*d,t[2]=(h+p)/d):(d=Math.sqrt(1+m-a-u)*2,t[3]=(o-c)/d,t[0]=(f+l)/d,t[1]=(h+p)/d,t[2]=.25*d),t}function sa(t,e,n,r){var s=e[0],i=e[1],a=e[2],o=e[3],l=s+s,c=i+i,u=a+a,h=s*l,f=s*c,p=s*u,m=i*c,v=i*u,d=a*u,x=o*l,L=o*c,y=o*u,T=r[0],M=r[1],I=r[2];return t[0]=(1-(m+d))*T,t[1]=(f+y)*T,t[2]=(p-L)*T,t[3]=0,t[4]=(f-y)*M,t[5]=(1-(h+d))*M,t[6]=(v+x)*M,t[7]=0,t[8]=(p+L)*I,t[9]=(v-x)*I,t[10]=(1-(h+m))*I,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function ia(t,e,n,r,s){var i=e[0],a=e[1],o=e[2],l=e[3],c=i+i,u=a+a,h=o+o,f=i*c,p=i*u,m=i*h,v=a*u,d=a*h,x=o*h,L=l*c,y=l*u,T=l*h,M=r[0],I=r[1],F=r[2],S=s[0],C=s[1],P=s[2],E=(1-(v+x))*M,N=(p+T)*M,O=(m-y)*M,B=(p-T)*I,_=(1-(f+x))*I,A=(d+L)*I,z=(m+y)*F,H=(d-L)*F,Q=(1-(f+v))*F;return t[0]=E,t[1]=N,t[2]=O,t[3]=0,t[4]=B,t[5]=_,t[6]=A,t[7]=0,t[8]=z,t[9]=H,t[10]=Q,t[11]=0,t[12]=n[0]+S-(E*S+B*C+z*P),t[13]=n[1]+C-(N*S+_*C+H*P),t[14]=n[2]+P-(O*S+A*C+Q*P),t[15]=1,t}function aa(t,e){var n=e[0],r=e[1],s=e[2],i=e[3],a=n+n,o=r+r,l=s+s,c=n*a,u=r*a,h=r*o,f=s*a,p=s*o,m=s*l,v=i*a,d=i*o,x=i*l;return t[0]=1-h-m,t[1]=u+x,t[2]=f-d,t[3]=0,t[4]=u-x,t[5]=1-c-m,t[6]=p+v,t[7]=0,t[8]=f+d,t[9]=p-v,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function oa(t,e,n,r,s,i,a){var o=1/(n-e),l=1/(s-r),c=1/(i-a);return t[0]=i*2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i*2*l,t[6]=0,t[7]=0,t[8]=(n+e)*o,t[9]=(s+r)*l,t[10]=(a+i)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*i*2*c,t[15]=0,t}function On(t,e,n,r,s){var i=1/Math.tan(e/2),a;return t[0]=i/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==Infinity?(a=1/(r-s),t[10]=(s+r)*a,t[14]=2*s*r*a):(t[10]=-1,t[14]=-2*r),t}var la=On;function ua(t,e,n,r,s){var i=1/Math.tan(e/2),a;return t[0]=i/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==Infinity?(a=1/(r-s),t[10]=s*a,t[14]=s*r*a):(t[10]=-1,t[14]=-r),t}function ca(t,e,n,r){var s=Math.tan(e.upDegrees*Math.PI/180),i=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),o=Math.tan(e.rightDegrees*Math.PI/180),l=2/(a+o),c=2/(s+i);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-((a-o)*l*.5),t[9]=(s-i)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function Bn(t,e,n,r,s,i,a){var o=1/(e-n),l=1/(r-s),c=1/(i-a);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*o,t[13]=(s+r)*l,t[14]=(a+i)*c,t[15]=1,t}var ha=Bn;function fa(t,e,n,r,s,i,a){var o=1/(e-n),l=1/(r-s),c=1/(i-a);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=c,t[11]=0,t[12]=(e+n)*o,t[13]=(s+r)*l,t[14]=i*c,t[15]=1,t}function da(t,e,n,r){var s,i,a,o,l,c,u,h,f,p,m=e[0],v=e[1],d=e[2],x=r[0],L=r[1],y=r[2],T=n[0],M=n[1],I=n[2];return Math.abs(m-T)<k&&Math.abs(v-M)<k&&Math.abs(d-I)<k?In(t):(u=m-T,h=v-M,f=d-I,p=1/Math.hypot(u,h,f),u*=p,h*=p,f*=p,s=L*f-y*h,i=y*u-x*f,a=x*h-L*u,p=Math.hypot(s,i,a),p?(p=1/p,s*=p,i*=p,a*=p):(s=0,i=0,a=0),o=h*a-f*i,l=f*s-u*a,c=u*i-h*s,p=Math.hypot(o,l,c),p?(p=1/p,o*=p,l*=p,c*=p):(o=0,l=0,c=0),t[0]=s,t[1]=o,t[2]=u,t[3]=0,t[4]=i,t[5]=l,t[6]=h,t[7]=0,t[8]=a,t[9]=c,t[10]=f,t[11]=0,t[12]=-(s*m+i*v+a*d),t[13]=-(o*m+l*v+c*d),t[14]=-(u*m+h*v+f*d),t[15]=1,t)}function pa(t,e,n,r){var s=e[0],i=e[1],a=e[2],o=r[0],l=r[1],c=r[2],u=s-n[0],h=i-n[1],f=a-n[2],p=u*u+h*h+f*f;p>0&&(p=1/Math.sqrt(p),u*=p,h*=p,f*=p);var m=l*f-c*h,v=c*u-o*f,d=o*h-l*u;return p=m*m+v*v+d*d,p>0&&(p=1/Math.sqrt(p),m*=p,v*=p,d*=p),t[0]=m,t[1]=v,t[2]=d,t[3]=0,t[4]=h*d-f*v,t[5]=f*m-u*d,t[6]=u*v-h*m,t[7]=0,t[8]=u,t[9]=h,t[10]=f,t[11]=0,t[12]=s,t[13]=i,t[14]=a,t[15]=1,t}function ma(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function _a(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function Ea(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function Pn(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function va(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function Aa(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function xa(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function ba(t,e){var n=t[0],r=t[1],s=t[2],i=t[3],a=t[4],o=t[5],l=t[6],c=t[7],u=t[8],h=t[9],f=t[10],p=t[11],m=t[12],v=t[13],d=t[14],x=t[15],L=e[0],y=e[1],T=e[2],M=e[3],I=e[4],F=e[5],S=e[6],C=e[7],P=e[8],E=e[9],N=e[10],O=e[11],B=e[12],_=e[13],A=e[14],z=e[15];return Math.abs(n-L)<=k*Math.max(1,Math.abs(n),Math.abs(L))&&Math.abs(r-y)<=k*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(s-T)<=k*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(i-M)<=k*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(a-I)<=k*Math.max(1,Math.abs(a),Math.abs(I))&&Math.abs(o-F)<=k*Math.max(1,Math.abs(o),Math.abs(F))&&Math.abs(l-S)<=k*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(c-C)<=k*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(u-P)<=k*Math.max(1,Math.abs(u),Math.abs(P))&&Math.abs(h-E)<=k*Math.max(1,Math.abs(h),Math.abs(E))&&Math.abs(f-N)<=k*Math.max(1,Math.abs(f),Math.abs(N))&&Math.abs(p-O)<=k*Math.max(1,Math.abs(p),Math.abs(O))&&Math.abs(m-B)<=k*Math.max(1,Math.abs(m),Math.abs(B))&&Math.abs(v-_)<=k*Math.max(1,Math.abs(v),Math.abs(_))&&Math.abs(d-A)<=k*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(x-z)<=k*Math.max(1,Math.abs(x),Math.abs(z))}var ya=Ln,ga=Pn;var Y={};Le(Y,{add:()=>Ra,angle:()=>Xa,bezier:()=>Ya,ceil:()=>Ia,clone:()=>wa,copy:()=>Ma,create:()=>Dn,cross:()=>Ha,dist:()=>so,distance:()=>Kn,div:()=>ro,divide:()=>kn,dot:()=>Gn,equals:()=>eo,exactEquals:()=>Ja,floor:()=>La,forEach:()=>lo,fromValues:()=>Ta,hermite:()=>Ka,inverse:()=>Fa,len:()=>ao,length:()=>Fn,lerp:()=>ka,max:()=>Na,min:()=>Ca,mul:()=>no,multiply:()=>Hn,negate:()=>Da,normalize:()=>Ua,random:()=>$a,rotateX:()=>ja,rotateY:()=>qa,rotateZ:()=>Wa,round:()=>Oa,scale:()=>Ba,scaleAndAdd:()=>Pa,set:()=>Sa,sqrDist:()=>io,sqrLen:()=>oo,squaredDistance:()=>Yn,squaredLength:()=>$n,str:()=>Za,sub:()=>to,subtract:()=>Un,transformMat3:()=>za,transformMat4:()=>Ga,transformQuat:()=>Va,zero:()=>Qa});function Dn(){var t=new ee(3);return ee!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function wa(t){var e=new ee(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Fn(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function Ta(t,e,n){var r=new ee(3);return r[0]=t,r[1]=e,r[2]=n,r}function Ma(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Sa(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function Ra(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Un(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Hn(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function kn(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function Ia(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function La(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function Ca(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function Na(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function Oa(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function Ba(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function Pa(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function Kn(t,e){var n=e[0]-t[0],r=e[1]-t[1],s=e[2]-t[2];return Math.hypot(n,r,s)}function Yn(t,e){var n=e[0]-t[0],r=e[1]-t[1],s=e[2]-t[2];return n*n+r*r+s*s}function $n(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function Da(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Fa(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function Ua(t,e){var n=e[0],r=e[1],s=e[2],i=n*n+r*r+s*s;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function Gn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ha(t,e,n){var r=e[0],s=e[1],i=e[2],a=n[0],o=n[1],l=n[2];return t[0]=s*l-i*o,t[1]=i*a-r*l,t[2]=r*o-s*a,t}function ka(t,e,n,r){var s=e[0],i=e[1],a=e[2];return t[0]=s+r*(n[0]-s),t[1]=i+r*(n[1]-i),t[2]=a+r*(n[2]-a),t}function Ka(t,e,n,r,s,i){var a=i*i,o=a*(2*i-3)+1,l=a*(i-2)+i,c=a*(i-1),u=a*(3-2*i);return t[0]=e[0]*o+n[0]*l+r[0]*c+s[0]*u,t[1]=e[1]*o+n[1]*l+r[1]*c+s[1]*u,t[2]=e[2]*o+n[2]*l+r[2]*c+s[2]*u,t}function Ya(t,e,n,r,s,i){var a=1-i,o=a*a,l=i*i,c=o*a,u=3*i*o,h=3*l*a,f=l*i;return t[0]=e[0]*c+n[0]*u+r[0]*h+s[0]*f,t[1]=e[1]*c+n[1]*u+r[1]*h+s[1]*f,t[2]=e[2]*c+n[2]*u+r[2]*h+s[2]*f,t}function $a(t,e){e=e||1;var n=bt()*2*Math.PI,r=bt()*2-1,s=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*s,t[1]=Math.sin(n)*s,t[2]=r*e,t}function Ga(t,e,n){var r=e[0],s=e[1],i=e[2],a=n[3]*r+n[7]*s+n[11]*i+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*s+n[8]*i+n[12])/a,t[1]=(n[1]*r+n[5]*s+n[9]*i+n[13])/a,t[2]=(n[2]*r+n[6]*s+n[10]*i+n[14])/a,t}function za(t,e,n){var r=e[0],s=e[1],i=e[2];return t[0]=r*n[0]+s*n[3]+i*n[6],t[1]=r*n[1]+s*n[4]+i*n[7],t[2]=r*n[2]+s*n[5]+i*n[8],t}function Va(t,e,n){var r=n[0],s=n[1],i=n[2],a=n[3],o=e[0],l=e[1],c=e[2],u=s*c-i*l,h=i*o-r*c,f=r*l-s*o,p=s*f-i*h,m=i*u-r*f,v=r*h-s*u,d=a*2;return u*=d,h*=d,f*=d,p*=2,m*=2,v*=2,t[0]=o+u+p,t[1]=l+h+m,t[2]=c+f+v,t}function ja(t,e,n,r){var s=[],i=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],i[0]=s[0],i[1]=s[1]*Math.cos(r)-s[2]*Math.sin(r),i[2]=s[1]*Math.sin(r)+s[2]*Math.cos(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function qa(t,e,n,r){var s=[],i=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],i[0]=s[2]*Math.sin(r)+s[0]*Math.cos(r),i[1]=s[1],i[2]=s[2]*Math.cos(r)-s[0]*Math.sin(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function Wa(t,e,n,r){var s=[],i=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],i[0]=s[0]*Math.cos(r)-s[1]*Math.sin(r),i[1]=s[0]*Math.sin(r)+s[1]*Math.cos(r),i[2]=s[2],t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function Xa(t,e){var n=t[0],r=t[1],s=t[2],i=e[0],a=e[1],o=e[2],l=Math.sqrt(n*n+r*r+s*s),c=Math.sqrt(i*i+a*a+o*o),u=l*c,h=u&&Gn(t,e)/u;return Math.acos(Math.min(Math.max(h,-1),1))}function Qa(t){return t[0]=0,t[1]=0,t[2]=0,t}function Za(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Ja(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function eo(t,e){var n=t[0],r=t[1],s=t[2],i=e[0],a=e[1],o=e[2];return Math.abs(n-i)<=k*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-a)<=k*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(s-o)<=k*Math.max(1,Math.abs(s),Math.abs(o))}var to=Un,no=Hn,ro=kn,so=Kn,io=Yn,ao=Fn,oo=$n,lo=function(){var t=Dn();return function(e,n,r,s,i,a){var o,l;for(n||(n=3),r||(r=0),s?l=Math.min(s*n+r,e.length):l=e.length,o=r;o<l;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],i(t,t,a),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}}();var bl=Y.fromValues(0,1,0);var zn=class{constructor(e,n){this.projectionMatrix=e,this.viewMatrix=n}resize(e=void 0,n=void 0){return this}},uo=Math.PI/3,yt=class extends zn{constructor(e=uo,n=.1,r=1e3){super(ie.create(),ie.create());this.fieldOfView=Number(e),this.clippingPlane={near:Number(n),far:Number(r)}}resize(e=void 0,n=void 0){let r=typeof e=="undefined"?1:e/n,{near:s,far:i}=this.clippingPlane;return ie.perspective(this.projectionMatrix,this.fieldOfView,r,s,i),this}};var Vn=Math.PI/180,gt=class{constructor(e={locky:!1}){this.locky=e.locky,this.position=Y.create(),this.forward=Y.fromValues(0,0,-1),this.right=Y.fromValues(1,0,0),this.up=Y.fromValues(0,1,0),this.forwardAmount=0,this.rightAmount=0,this.upAmount=0,this.pitch=0,this.yaw=-90}look(e,n,r=1){return r*=1e3,this.pitch=Math.min(89.9,Math.max(-89.9,this.pitch+n*r)),this.yaw=(this.yaw+e*r)%360,this}move(e,n=0,r=0,s=1){return this.forwardAmount+=e*s,this.rightAmount+=n*s,this.upAmount+=r*s,this}apply(e){let{position:n,forward:r,right:s,up:i,forwardAmount:a,rightAmount:o,upAmount:l,pitch:c,yaw:u}=this,h=u*Vn,f=c*Vn,p=Math.cos(h),m=Math.cos(f),v=Math.sin(h),d=Math.sin(f),x=p*m,L=d,y=v*m;Y.normalize(r,Y.set(r,x,this.locky?0:L,y)),Y.normalize(s,Y.cross(s,r,i));let T=Y.create();Y.scale(T,r,a),Y.add(n,n,T),Y.scale(T,s,o),Y.add(n,n,T),Y.scale(T,i,l),Y.add(n,n,T),this.forwardAmount=0,this.rightAmount=0,this.upAmount=0,this.locky&&Y.set(r,x,L,y);let M=Y.add(T,n,r);return ie.lookAt(e,n,M,i),e}};var yl=Symbol("nextAvailableEntityId");function pe(t){return typeof WebGL2RenderingContext!="undefined"&&t instanceof WebGL2RenderingContext}var jn=class{constructor(e,n){this.gl=e,this.target=n}data(e,n=void 0){let r=this.gl,s=this.target;if(typeof e=="number")r.bufferData(s,e,n||r.STATIC_DRAW);else{if(!ArrayBuffer.isView(e))throw new Error("Source data must be a typed array.");r.bufferData(s,e,n||r.STATIC_DRAW)}return this}subData(e,n=0,r=void 0,s=void 0){let i=this.gl,a=this.target;if(ArrayBuffer.isView(e))if(typeof r!="undefined")if(pe(i))i.bufferSubData(a,n,e,r,s);else{let o=s?e.subarray(r,r+s):e.subarray(r);i.bufferSubData(a,n,o)}else i.bufferSubData(a,n,e);else throw new Error("Source data must be a typed array.");return this}};var Ge=class{constructor(e,n,r,s){this.gl=e,this.target=n,this.handle=s,this.type=r,this.bindContext=new jn(e,this.target)}bind(e){return e.bindBuffer(this.target,this.handle),this.bindContext.gl=e,this.bindContext}},le={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,HALF_FLOAT:5131};var wl={[le.BYTE]:1,[le.UNSIGNED_BYTE]:1,[le.SHORT]:2,[le.UNSIGNED_SHORT]:2,[le.INT]:4,[le.UNSIGNED_INT]:4,[le.FLOAT]:4,[le.HALF_FLOAT]:2};function co(t,e){let n=[],r=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let s=0;s<r;++s){let i=t.getActiveUniform(e,s);if(!i)break;n.push(i)}return n}function ho(t,e){let n=[],r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let s=0;s<r;++s){let i=t.getActiveAttrib(e,s);!i||n.push(i)}return n}function ze(t,e){switch(e){case t.FLOAT:case t.INT:case t.UNSIGNED_INT:case t.BOOL:return 1;case t.FLOAT_VEC2:case t.INT_VEC2:case t.BOOL_VEC2:return 2;case t.FLOAT_VEC3:case t.INT_VEC3:case t.BOOL_VEC3:return 3;case t.FLOAT_VEC4:case t.INT_VEC4:case t.BOOL_VEC4:return 4;case t.FLOAT_MAT2:return 4;case t.FLOAT_MAT3:return 9;case t.FLOAT_MAT4:return 16;default:throw new Error("Invalid vertex attribute type.")}}function fo(t,e){switch(e){case t.FLOAT:case t.FLOAT_VEC2:case t.FLOAT_VEC3:case t.FLOAT_VEC4:return po}if(pe(t)){let n=t;switch(e){case t.INT:case t.INT_VEC2:case t.INT_VEC3:case t.INT_VEC4:case t.BOOL:case t.BOOL_VEC2:case t.BOOL_VEC3:case t.BOOL_VEC4:return mo;case t.FLOAT_MAT2:return Eo;case t.FLOAT_MAT3:return vo;case t.FLOAT_MAT4:return Ao;case n.UNSIGNED_INT:case n.UNSIGNED_INT_VEC2:case n.UNSIGNED_INT_VEC3:case n.UNSIGNED_INT_VEC4:return _o}}throw new Error("Cannot find attribute function for gl enum.")}function po(t,e,n,r,s=!1,i=0,a=0,o=void 0){if(this.bindBuffer(this.ARRAY_BUFFER,e),this.enableVertexAttribArray(t),this.vertexAttribPointer(t,n,r,s,i,a),o!==void 0){if(!pe(this))throw new Error("Cannot use attribute divisor in WebGL 1.");this.vertexAttribDivisor(t,o)}}function mo(t,e,n,r,s=!1,i=0,a=0,o=void 0){if(!pe(this))throw new Error("Cannot use attribute divisor in WebGL 1.");let l=this;l.bindBuffer(l.ARRAY_BUFFER,e),l.enableVertexAttribArray(t),l.vertexAttribIPointer(t,n,r,i,a),o!==void 0&&l.vertexAttribDivisor(t,o)}function _o(t,e,n,r,s=!1,i=0,a=0,o=void 0){if(!pe(this))throw new Error("Cannot use attribute divisor in WebGL 1.");let l=this;l.bindBuffer(l.ARRAY_BUFFER,e),l.enableVertexAttribArray(t),l.vertexAttribIPointer(t,n,r,i,a),o!==void 0&&l.vertexAttribDivisor(t,o)}function Eo(t,e,n,r,s=!1,i=0,a=0,o=void 0){let l=ze(this,this.FLOAT_MAT2),c=l*l;wt(c,l,t,e,n,r,s,i,a,o)}function vo(t,e,n,r,s=!1,i=0,a=0,o=void 0){let l=ze(this,this.FLOAT_MAT3),c=l*l;wt(c,l,t,e,n,r,s,i,a,o)}function Ao(t,e,n,r,s=!1,i=0,a=0,o=void 0){let l=ze(this,this.FLOAT_MAT4),c=l*l;wt(c,l,t,e,n,r,s,i,a,o)}function wt(t,e,n,r,s,i,a,o,l,c){if(!pe(this))throw new Error("Cannot use attribute divisor in WebGL 1.");let u=this;u.bindBuffer(u.ARRAY_BUFFER,r);let h=s/e,f=t*s,p=o/e;for(let m=0;m<e;++m){let v=n+m;u.enableVertexAttribArray(v),u.vertexAttribPointer(v,h,i,a,f,l+p*m),c!==void 0&&u.vertexAttribDivisor(v,c)}}function xo(t,e){let n={},r=ho(t,e);for(let s of r){let i=s.name,a=s.size,o=s.type,l=t.getAttribLocation(e,i),c=fo(t,o),u=ze(t,o);n[i]={type:o,length:a,location:l,size:u,applier:c,set value([h,f,p,m,v,d,x]){this.applier(this.location,h,f,p,m,v,d,x)}}}return n}function bo(t,e,n,r,s=void 0){s?(t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,s),t.drawElements(e,r,t.UNSIGNED_SHORT,n)):t.drawArrays(e,n,r)}function yo(t,e){let n=t;switch(e){case n.FLOAT:return n.uniform1f;case n.FLOAT_VEC2:return n.uniform2fv;case n.FLOAT_VEC3:return n.uniform3fv;case n.FLOAT_VEC4:return n.uniform4fv;case n.INT:return n.uniform1i;case n.INT_VEC2:return n.uniform2iv;case n.INT_VEC3:return n.uniform3iv;case n.INT_VEC4:return n.uniform4iv;case n.BOOL:return n.uniform1i;case n.BOOL_VEC2:return n.uniform2iv;case n.BOOL_VEC3:return n.uniform3iv;case n.BOOL_VEC4:return n.uniform4iv;case n.FLOAT_MAT2:return go;case n.FLOAT_MAT3:return wo;case n.FLOAT_MAT4:return To;case n.SAMPLER_2D:case n.SAMPLER_CUBE:return n.uniform1i}if(pe(t)){let r=t;switch(e){case r.UNSIGNED_INT:return r.uniform1ui;case r.UNSIGNED_INT_VEC2:return r.uniform2uiv;case r.UNSIGNED_INT_VEC3:return r.uniform3uiv;case r.UNSIGNED_INT_VEC4:return r.uniform4uiv;case r.FLOAT_MAT2x3:return Mo;case r.FLOAT_MAT2x4:return So;case r.FLOAT_MAT3x2:return Ro;case r.FLOAT_MAT3x4:return Io;case r.FLOAT_MAT4x2:return Lo;case r.FLOAT_MAT4x3:return Co;case r.SAMPLER_3D:case r.SAMPLER_2D_SHADOW:case r.SAMPLER_2D_ARRAY:case r.SAMPLER_2D_ARRAY_SHADOW:case r.SAMPLER_CUBE_SHADOW:case r.INT_SAMPLER_2D:case r.INT_SAMPLER_3D:case r.INT_SAMPLER_CUBE:case r.INT_SAMPLER_2D_ARRAY:case r.UNSIGNED_INT_SAMPLER_2D:case r.UNSIGNED_INT_SAMPLER_3D:case r.UNSIGNED_INT_SAMPLER_CUBE:case r.UNSIGNED_INT_SAMPLER_2D_ARRAY:return r.uniform1i}}throw new Error("Cannot find uniform function for gl enum.")}function go(t,e){this.uniformMatrix2fv(t,!1,e)}function wo(t,e){this.uniformMatrix3fv(t,!1,e)}function To(t,e){this.uniformMatrix4fv(t,!1,e)}function Mo(t,e){this.uniformMatrix2x3fv(t,!1,e)}function So(t,e){this.uniformMatrix2x4fv(t,!1,e)}function Ro(t,e){this.uniformMatrix3x2fv(t,!1,e)}function Io(t,e){this.uniformMatrix3x4fv(t,!1,e)}function Lo(t,e){this.uniformMatrix4x2fv(t,!1,e)}function Co(t,e){this.uniformMatrix4x3fv(t,!1,e)}function No(t,e){let n={},r=co(t,e);for(let s of r){let i=s.name,a=s.size,o=s.type,l=t.getUniformLocation(e,i),c=yo(t,o);n[i]={type:o,length:a,location:l,applier:c,set value(u){this.applier.call(t,this.location,u)}}}return n}var Ae=class{constructor(e,n){this.handle=n,this.activeUniforms=No(e,n),this.activeAttributes=xo(e,n),this.drawContext=new qn(e,this)}bind(e){return e.useProgram(this.handle),this.drawContext.gl=e,this.drawContext}},qn=class{constructor(e,n){this.gl=e,this.parent=n}uniform(e,n){let r=this.parent.activeUniforms;if(e in r){let s=r[e],i=s.location;s.applier.call(this.gl,i,n)}return this}attribute(e,n,r,s=!1,i=0,a=0){let o=this.gl,l=this.parent.activeAttributes;if(e in l){let c=l[e],u=c.location,h=c.size;r?(o.bindBuffer(o.ARRAY_BUFFER,r),o.vertexAttribPointer(u,h,n,s,i,a),o.enableVertexAttribArray(u)):o.disableVertexAttribArray(u)}return this}draw(e,n,r,s,i=null){return bo(e,n,r,s,i),this.parent}};var Wn=`#version 300 es

in vec3 a_position;
in vec2 a_texcoord;
in vec3 a_normal;

out vec2 v_texcoord;

uniform mat4 u_model;
uniform mat4 u_view;
uniform mat4 u_projection;

void main() {
    gl_Position = u_projection * u_view * u_model * vec4(a_position, 1.0);
    v_texcoord = a_texcoord;
}
`,Xn=`#version 300 es

precision highp float;

in vec2 v_texcoord;

out vec4 out_FragColor;

uniform vec4 u_color;

void main() {
    out_FragColor = u_color;
}
`;function Qn(t,e=1,n=1,r=1,s=8,i=1,a=!1,o=0,l=Math.PI*2){return Oo(t,e,n,r,s,i,o,l),a||(e>0&&Zn(t,!0,e,n,r,s,o,l),n>0&&Zn(t,!1,e,n,r,s,o,l)),t}function Oo(t,e,n,r,s,i,a,o){let l=r/2,c=(n-e)/r,u=[],h=Y.create();for(let f=0;f<=i;++f){let p=[],m=f/i,v=m*(n-e)+e;for(let d=0;d<=s;++d){let x=d/s,L=x*o+a,y=Math.sin(L),T=Math.cos(L);h[0]=v*y,h[1]=-m*r+l,h[2]=v*T,t.position.push(h[0],h[1],h[2]),h[0]=y,h[1]=c,h[2]=T,Y.normalize(h,h),t.normal.push(h[0],h[1],h[2]),h[0]=x,h[1]=1-m,t.texcoord.push(m[0],m[1]);let M=++t.vertexCount;p.push(M)}u.push(p)}for(let f=0;f<s;++f)for(let p=0;p<i;++p){let m=u[p][f],v=u[p+1][f],d=u[p+1][f+1],x=u[p][f+1];t.indices.push(m,v,x),t.indices.push(v,d,x)}return t}function Zn(t,e,n,r,s,i,a,o){let l=s/2,c=e?1:-1,u=e?n:r,h=t.vertexCount;for(let m=1;m<=i;++m)t.position.push(0,l*c,0),t.normal.push(0,c,0),t.texcoord.push(.5,.5),++t.vertexCount;let f=Y.create(),p=t.vertexCount;for(let m=0;m<=i;++m){let d=m/i*o+a,x=Math.cos(d),L=Math.sin(d);f[0]=u*L,f[1]=l*c,f[2]=u*x,t.position.push(f[0],f[1],f[2]),t.normal.push(0,c,0),f[0]=x*.5+.5,f[1]=L*.5*c+.5,t.texcoord.push(f[0],f[1]),++t.vertexCount}for(let m=0;m<i;++m){let v=h+m,d=p+m;e?t.indices.push(d,d+1,v):t.indices.push(d+1,d,v)}return t}var Tt=class{constructor(...e){this.systems=e,this.callbacks=[]}async load(e){for(let n of this.systems){let r=await n(e);this.callbacks.push(r)}return this}update(e){for(let n of this.systems)n(e);return this}};function Mt(t,e){let n=t.components;if(e in n)return n[e];{let r={};return n[e]=r,r}}function Bo(t,e,n){let r=n.name,s=Mt(t,r),i=n.new();return s[e]=i,i}function Po(t,e,n){let r=n.name,s=Mt(t,r),i=s[e];return delete s[e],i}var Jn=Symbol("nextAvailableEntityId");function Do(t){return++t[Jn]}var St=class{constructor(){this.components={},this[Jn]=1,this.queue=[]}flush(){for(;this.queue.length>0;){let[e,...n]=this.queue.shift();switch(e){case"attach":{let[r,s]=n;this.attachImmediately(r,s)}break;case"detach":{let[r,s]=n;this.detachImmediately(r,s)}break}}}create(...e){let n=Do(this);for(let r of e)this.attach(n,r);return n}delete(e){for(let n of Object.values(this.components))e in n&&delete n[e]}attach(e,n){this.queue.push(["attach",e,n])}attachImmediately(e,n){return Bo(this,e,n)}detach(e,n){this.queue.push(["detach",e,n])}detachImmediately(e,n){return Po(this,e,n)}get(e,n){let r=n.name,s=Mt(this,r);return s?null:s[e]||null}};var Rt=class{constructor(e=0,n=[],r=[],s=[],i=[]){this.vertexCount=e,this.indices=n,this.position=r,this.texcoord=s,this.normal=i}};window.addEventListener("DOMContentLoaded",Fo);async function Fo(){await oe.connectInputs(se),await oe.preloadAssetPack(),await oe.preloadAssets(Rn);let t={deltaTime:0,now:0,systemManager:new Tt,entityManager:new St};await Uo(t)}async function Uo(t){let e=oe.getDisplayPort(),n=oe.getInputPort(),r=t.entityManager,s=t.systemManager,i=n.getContext("axisbutton"),a=e.canvas.getContext("webgl2"),o=new yt,l=new gt;e.canvas.addEventListener("click",()=>{e.focus(),e.canvas.requestPointerLock()});let c=Ko(Qn(new Rt,.5,1,10),ko([Wn,Xn],{u_color:[1,0,.5,1],u_model:ie.create(),u_view:o.viewMatrix,u_projection:o.projectionMatrix})),u={};e.addEventListener("frame",h=>{let{deltaTime:f,now:p}=h.detail,m=f/60;i.poll(p),o.resize(e.width,e.height),Ho(m,l),l.apply(o.viewMatrix);let v=c.uniforms.u_model;ie.rotateX(v,v,.01),Vo(u,a,e,[c])})}function Ho(t,e){let n=se.MoveForward.value-se.MoveBackward.value,r=se.MoveRight.value-se.MoveLeft.value,s=se.MoveDown.value-se.MoveUp.value;e.move(n,r,s,t);let i=se.CursorX.delta,a=-se.CursorY.delta;e.look(i,a,t)}function ko(t,e){return{shaders:t,uniforms:e}}function Ko(t,e){return{geometry:t,material:e}}function er(t,e,n=()=>null){if(e in t)return t[e];{let r=n();return t[e]=r,r}}function Yo(t,e,n){let r=er(t,"bufferInfos",()=>new Map);if(r.has(n))return r.get(n);{let s=Ge.createBufferInfo(e,{a_position:{buffer:n.position},a_texcoord:{buffer:n.texcoord,size:2},a_normal:{buffer:n.normal}},{buffer:n.indices});return r.set(n,s),s}}function $o(t,e,n){let r=er(t,"bufferInfos",()=>new Map);if(r.has(n))return r.get(n);{let s=e.createProgram();Ae.linkProgramShaders(e,s,n.shaders);let i=Ae.createProgramInfo(e,s);return r.set(n,i),i}}function Go(t,e,n,r){let s=Yo(t,e,n),i=$o(t,e,r);return{bufferInfo:s,programInfo:i,uniforms:{...r.uniforms}}}function zo(t,e,n){return n&&n.geometry&&n.material?Go(t,n.geometry,n.material):null}function Vo(t,e,n,r=[]){e.viewport(0,0,n.width,n.height),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT);for(let s of r.map(i=>zo(t,e,i))){if(!s)continue;let{programInfo:i,bufferInfo:a,uniforms:o}=s;e.useProgram(i.handle),Ae.bindProgramAttributes(e,i,a),Ae.bindProgramUniforms(e,i,o),Ge.drawBufferInfo(e,a)}}})();
//# sourceMappingURL=main.js.map
