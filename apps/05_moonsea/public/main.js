(()=>{var es=Object.create,Xe=Object.defineProperty,ts=Object.getPrototypeOf,rs=Object.prototype.hasOwnProperty,ns=Object.getOwnPropertyNames,is=Object.getOwnPropertyDescriptor;var ss=e=>Xe(e,"__esModule",{value:!0});var as=(e,t)=>()=>(e&&(t=e(e=0)),t),Se=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ce=(e,t)=>{for(var r in t)Xe(e,r,{get:t[r],enumerable:!0})},os=(e,t,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of ns(t))!rs.call(e,n)&&n!=="default"&&Xe(e,n,{get:()=>t[n],enumerable:!(r=is(t,n))||r.enumerable});return e},ls=e=>os(ss(Xe(e!=null?es(ts(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var rn={};Ce(rn,{basename:()=>cn,default:()=>ro,delimiter:()=>ln,dirname:()=>hn,extname:()=>un,isAbsolute:()=>Kt,join:()=>sn,normalize:()=>Yt,relative:()=>an,resolve:()=>nt,sep:()=>on});function nn(e,t){for(var r=0,n=e.length-1;n>=0;n--){var i=e[n];i==="."?e.splice(n,1):i===".."?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}function nt(){for(var e="",t=!1,r=arguments.length-1;r>=-1&&!t;r--){var n=r>=0?arguments[r]:"/";if(typeof n!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!n)continue;e=n+"/"+e,t=n.charAt(0)==="/"}return e=nn(kt(e.split("/"),function(i){return!!i}),!t).join("/"),(t?"/":"")+e||"."}function Yt(e){var t=Kt(e),r=to(e,-1)==="/";return e=nn(kt(e.split("/"),function(n){return!!n}),!t).join("/"),!e&&!t&&(e="."),e&&r&&(e+="/"),(t?"/":"")+e}function Kt(e){return e.charAt(0)==="/"}function sn(){var e=Array.prototype.slice.call(arguments,0);return Yt(kt(e,function(t,r){if(typeof t!="string")throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))}function an(e,t){e=nt(e).substr(1),t=nt(t).substr(1);function r(c){for(var h=0;h<c.length&&c[h]==="";h++);for(var u=c.length-1;u>=0&&c[u]==="";u--);return h>u?[]:c.slice(h,u-h+1)}for(var n=r(e.split("/")),i=r(t.split("/")),s=Math.min(n.length,i.length),a=s,o=0;o<s;o++)if(n[o]!==i[o]){a=o;break}for(var l=[],o=a;o<n.length;o++)l.push("..");return l=l.concat(i.slice(a)),l.join("/")}function hn(e){var t=Ht(e),r=t[0],n=t[1];return!r&&!n?".":(n&&(n=n.substr(0,n.length-1)),r+n)}function cn(e,t){var r=Ht(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r}function un(e){return Ht(e)[3]}function kt(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}var eo,Ht,on,ln,ro,to,fn=as(()=>{eo=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,Ht=function(e){return eo.exec(e).slice(1)};on="/",ln=":";ro={extname:un,basename:cn,dirname:hn,sep:on,delimiter:ln,relative:an,join:sn,isAbsolute:Kt,normalize:Yt,resolve:nt};to="ab".substr(-1)==="b"?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)}});var st=Se((Ju,it)=>{var Me=(fn(),rn);Me&&Me.default?it.exports=Me.default:Me&&(it.exports=Me);if(Me)for(let e in Me)it.exports[e]=Me[e]});var $e=Se((ef,pn)=>{"use strict";var no=st(),me="\\\\/",dn=`[^${me}]`,ge="\\.",io="\\+",so="\\?",at="\\/",ao="(?=.)",vn="[^/]",$t=`(?:${at}|$)`,mn=`(?:^|${at})`,Vt=`${ge}{1,2}${$t}`,oo=`(?!${ge})`,lo=`(?!${mn}${Vt})`,ho=`(?!${ge}{0,1}${$t})`,co=`(?!${Vt})`,uo=`[^.${at}]`,fo=`${vn}*?`,xn={DOT_LITERAL:ge,PLUS_LITERAL:io,QMARK_LITERAL:so,SLASH_LITERAL:at,ONE_CHAR:ao,QMARK:vn,END_ANCHOR:$t,DOTS_SLASH:Vt,NO_DOT:oo,NO_DOTS:lo,NO_DOT_SLASH:ho,NO_DOTS_SLASH:co,QMARK_NO_DOT:uo,STAR:fo,START_ANCHOR:mn},po={...xn,SLASH_LITERAL:`[${me}]`,QMARK:dn,STAR:`${dn}*?`,DOTS_SLASH:`${ge}{1,2}(?:[${me}]|$)`,NO_DOT:`(?!${ge})`,NO_DOTS:`(?!(?:^|[${me}])${ge}{1,2}(?:[${me}]|$))`,NO_DOT_SLASH:`(?!${ge}{0,1}(?:[${me}]|$))`,NO_DOTS_SLASH:`(?!${ge}{1,2}(?:[${me}]|$))`,QMARK_NO_DOT:`[^.${me}]`,START_ANCHOR:`(?:^|[${me}])`,END_ANCHOR:`(?:[${me}]|$)`},vo={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};pn.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:vo,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:no.sep,extglobChars(e){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${e.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(e){return e===!0?po:xn}}});var ot=Se(ne=>{"use strict";var mo=st(),xo=!1,{REGEX_BACKSLASH:_o,REGEX_REMOVE_BACKSLASH:go,REGEX_SPECIAL_CHARS:Eo,REGEX_SPECIAL_CHARS_GLOBAL:yo}=$e();ne.isObject=e=>e!==null&&typeof e=="object"&&!Array.isArray(e);ne.hasRegexChars=e=>Eo.test(e);ne.isRegexChar=e=>e.length===1&&ne.hasRegexChars(e);ne.escapeRegex=e=>e.replace(yo,"\\$1");ne.toPosixSlashes=e=>e.replace(_o,"/");ne.removeBackslashes=e=>e.replace(go,t=>t==="\\"?"":t);ne.supportsLookbehinds=()=>{let e=process.version.slice(1).split(".").map(Number);return e.length===3&&e[0]>=9||e[0]===8&&e[1]>=10};ne.isWindows=e=>e&&typeof e.windows=="boolean"?e.windows:xo===!0||mo.sep==="\\";ne.escapeLast=(e,t,r)=>{let n=e.lastIndexOf(t,r);return n===-1?e:e[n-1]==="\\"?ne.escapeLast(e,t,n-1):`${e.slice(0,n)}\\${e.slice(n)}`};ne.removePrefix=(e,t={})=>{let r=e;return r.startsWith("./")&&(r=r.slice(2),t.prefix="./"),r};ne.wrapOutput=(e,t={},r={})=>{let n=r.contains?"":"^",i=r.contains?"":"$",s=`${n}(?:${e})${i}`;return t.negated===!0&&(s=`(?:^(?!${s}).*$)`),s}});var Tn=Se((rf,_n)=>{"use strict";var gn=ot(),{CHAR_ASTERISK:Gt,CHAR_AT:Ao,CHAR_BACKWARD_SLASH:Ve,CHAR_COMMA:wo,CHAR_DOT:jt,CHAR_EXCLAMATION_MARK:qt,CHAR_FORWARD_SLASH:En,CHAR_LEFT_CURLY_BRACE:Wt,CHAR_LEFT_PARENTHESES:Xt,CHAR_LEFT_SQUARE_BRACKET:Mo,CHAR_PLUS:To,CHAR_QUESTION_MARK:yn,CHAR_RIGHT_CURLY_BRACE:bo,CHAR_RIGHT_PARENTHESES:An,CHAR_RIGHT_SQUARE_BRACKET:So}=$e(),wn=e=>e===En||e===Ve,Mn=e=>{e.isPrefix!==!0&&(e.depth=e.isGlobstar?Infinity:1)},Ro=(e,t)=>{let r=t||{},n=e.length-1,i=r.parts===!0||r.scanToEnd===!0,s=[],a=[],o=[],l=e,c=-1,h=0,u=0,p=!1,d=!1,v=!1,m=!1,f=!1,y=!1,C=!1,A=!1,E=!1,w=!1,b=0,F,M,O={value:"",depth:0,isGlob:!1},B=()=>c>=n,g=()=>l.charCodeAt(c+1),D=()=>(F=M,l.charCodeAt(++c));for(;c<n;){M=D();let j;if(M===Ve){C=O.backslashes=!0,M=D(),M===Wt&&(y=!0);continue}if(y===!0||M===Wt){for(b++;B()!==!0&&(M=D());){if(M===Ve){C=O.backslashes=!0,D();continue}if(M===Wt){b++;continue}if(y!==!0&&M===jt&&(M=D())===jt){if(p=O.isBrace=!0,v=O.isGlob=!0,w=!0,i===!0)continue;break}if(y!==!0&&M===wo){if(p=O.isBrace=!0,v=O.isGlob=!0,w=!0,i===!0)continue;break}if(M===bo&&(b--,b===0)){y=!1,p=O.isBrace=!0,w=!0;break}}if(i===!0)continue;break}if(M===En){if(s.push(c),a.push(O),O={value:"",depth:0,isGlob:!1},w===!0)continue;if(F===jt&&c===h+1){h+=2;continue}u=c+1;continue}if(r.noext!==!0&&(M===To||M===Ao||M===Gt||M===yn||M===qt)===!0&&g()===Xt){if(v=O.isGlob=!0,m=O.isExtglob=!0,w=!0,M===qt&&c===h&&(E=!0),i===!0){for(;B()!==!0&&(M=D());){if(M===Ve){C=O.backslashes=!0,M=D();continue}if(M===An){v=O.isGlob=!0,w=!0;break}}continue}break}if(M===Gt){if(F===Gt&&(f=O.isGlobstar=!0),v=O.isGlob=!0,w=!0,i===!0)continue;break}if(M===yn){if(v=O.isGlob=!0,w=!0,i===!0)continue;break}if(M===Mo){for(;B()!==!0&&(j=D());){if(j===Ve){C=O.backslashes=!0,D();continue}if(j===So){d=O.isBracket=!0,v=O.isGlob=!0,w=!0;break}}if(i===!0)continue;break}if(r.nonegate!==!0&&M===qt&&c===h){A=O.negated=!0,h++;continue}if(r.noparen!==!0&&M===Xt){if(v=O.isGlob=!0,i===!0){for(;B()!==!0&&(M=D());){if(M===Xt){C=O.backslashes=!0,M=D();continue}if(M===An){w=!0;break}}continue}break}if(v===!0){if(w=!0,i===!0)continue;break}}r.noext===!0&&(m=!1,v=!1);let N=l,P="",x="";h>0&&(P=l.slice(0,h),l=l.slice(h),u-=h),N&&v===!0&&u>0?(N=l.slice(0,u),x=l.slice(u)):v===!0?(N="",x=l):N=l,N&&N!==""&&N!=="/"&&N!==l&&wn(N.charCodeAt(N.length-1))&&(N=N.slice(0,-1)),r.unescape===!0&&(x&&(x=gn.removeBackslashes(x)),N&&C===!0&&(N=gn.removeBackslashes(N)));let _={prefix:P,input:e,start:h,base:N,glob:x,isBrace:p,isBracket:d,isGlob:v,isExtglob:m,isGlobstar:f,negated:A,negatedExtglob:E};if(r.tokens===!0&&(_.maxDepth=0,wn(M)||a.push(O),_.tokens=a),r.parts===!0||r.tokens===!0){let j;for(let k=0;k<s.length;k++){let Q=j?j+1:h,Z=s[k],ee=e.slice(Q,Z);r.tokens&&(k===0&&h!==0?(a[k].isPrefix=!0,a[k].value=P):a[k].value=ee,Mn(a[k]),_.maxDepth+=a[k].depth),(k!==0||ee!=="")&&o.push(ee),j=Z}if(j&&j+1<e.length){let k=e.slice(j+1);o.push(k),r.tokens&&(a[a.length-1].value=k,Mn(a[a.length-1]),_.maxDepth+=a[a.length-1].depth)}_.slashes=s,_.parts=o}return _};_n.exports=Ro});var Ln=Se((nf,bn)=>{"use strict";var lt=$e(),se=ot(),{MAX_LENGTH:ht,POSIX_REGEX_SOURCE:Lo,REGEX_NON_SPECIAL_CHARS:Co,REGEX_SPECIAL_CHARS_BACKREF:Io,REPLACEMENTS:Sn}=lt,Oo=(e,t)=>{if(typeof t.expandRange=="function")return t.expandRange(...e,t);e.sort();let r=`[${e.join("-")}]`;try{new RegExp(r)}catch(n){return e.map(i=>se.escapeRegex(i)).join("..")}return r},Ne=(e,t)=>`Missing ${e}: "${t}" - use "\\\\${t}" to match literal characters`,Rn=(e,t)=>{if(typeof e!="string")throw new TypeError("Expected a string");e=Sn[e]||e;let r={...t},n=typeof r.maxLength=="number"?Math.min(ht,r.maxLength):ht,i=e.length;if(i>n)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${n}`);let s={type:"bos",value:"",output:r.prepend||""},a=[s],o=r.capture?"":"?:",l=se.isWindows(t),c=lt.globChars(l),h=lt.extglobChars(c),{DOT_LITERAL:u,PLUS_LITERAL:p,SLASH_LITERAL:d,ONE_CHAR:v,DOTS_SLASH:m,NO_DOT:f,NO_DOT_SLASH:y,NO_DOTS_SLASH:C,QMARK:A,QMARK_NO_DOT:E,STAR:w,START_ANCHOR:b}=c,F=L=>`(${o}(?:(?!${b}${L.dot?m:u}).)*?)`,M=r.dot?"":f,O=r.dot?A:E,B=r.bash===!0?F(r):w;r.capture&&(B=`(${B})`),typeof r.noext=="boolean"&&(r.noextglob=r.noext);let g={input:e,index:-1,start:0,dot:r.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:a};e=se.removePrefix(e,g),i=e.length;let D=[],N=[],P=[],x=s,_,j=()=>g.index===i-1,k=g.peek=(L=1)=>e[g.index+L],Q=g.advance=()=>e[++g.index]||"",Z=()=>e.slice(g.index+1),ee=(L="",V=0)=>{g.consumed+=L,g.index+=V},fe=L=>{g.output+=L.output!=null?L.output:L.value,ee(L.value)},He=()=>{let L=1;for(;k()==="!"&&(k(2)!=="("||k(3)==="?");)Q(),g.start++,L++;return L%2==0?!1:(g.negated=!0,g.start++,!0)},ye=L=>{g[L]++,P.push(L)},pe=L=>{g[L]--,P.pop()},U=L=>{if(x.type==="globstar"){let V=g.braces>0&&(L.type==="comma"||L.type==="brace"),T=L.extglob===!0||D.length&&(L.type==="pipe"||L.type==="paren");L.type!=="slash"&&L.type!=="paren"&&!V&&!T&&(g.output=g.output.slice(0,-x.output.length),x.type="star",x.value="*",x.output=B,g.output+=x.output)}if(D.length&&L.type!=="paren"&&(D[D.length-1].inner+=L.value),(L.value||L.output)&&fe(L),x&&x.type==="text"&&L.type==="text"){x.value+=L.value,x.output=(x.output||"")+L.value;return}L.prev=x,a.push(L),x=L},be=(L,V)=>{let T={...h[V],conditions:1,inner:""};T.prev=x,T.parens=g.parens,T.output=g.output;let z=(r.capture?"(":"")+T.open;ye("parens"),U({type:L,value:V,output:g.output?"":v}),U({type:"paren",extglob:!0,value:Q(),output:z}),D.push(T)},qe=L=>{let V=L.close+(r.capture?")":""),T;if(L.type==="negate"){let z=B;L.inner&&L.inner.length>1&&L.inner.includes("/")&&(z=F(r)),(z!==B||j()||/^\)+$/.test(Z()))&&(V=L.close=`)$))${z}`),L.inner.includes("*")&&(T=Z())&&/^\.[^\\/.]+$/.test(T)&&(V=L.close=`)${T})${z})`),L.prev.type==="bos"&&(g.negatedExtglob=!0)}U({type:"paren",extglob:!0,value:_,output:V}),pe("parens")};if(r.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(e)){let L=!1,V=e.replace(Io,(T,z,q,re,X,At)=>re==="\\"?(L=!0,T):re==="?"?z?z+re+(X?A.repeat(X.length):""):At===0?O+(X?A.repeat(X.length):""):A.repeat(q.length):re==="."?u.repeat(q.length):re==="*"?z?z+re+(X?B:""):B:z?T:`\\${T}`);return L===!0&&(r.unescape===!0?V=V.replace(/\\/g,""):V=V.replace(/\\+/g,T=>T.length%2==0?"\\\\":T?"\\":"")),V===e&&r.contains===!0?(g.output=e,g):(g.output=se.wrapOutput(V,g,t),g)}for(;!j();){if(_=Q(),_==="\0")continue;if(_==="\\"){let T=k();if(T==="/"&&r.bash!==!0||T==="."||T===";")continue;if(!T){_+="\\",U({type:"text",value:_});continue}let z=/^\\+/.exec(Z()),q=0;if(z&&z[0].length>2&&(q=z[0].length,g.index+=q,q%2!=0&&(_+="\\")),r.unescape===!0?_=Q():_+=Q(),g.brackets===0){U({type:"text",value:_});continue}}if(g.brackets>0&&(_!=="]"||x.value==="["||x.value==="[^")){if(r.posix!==!1&&_===":"){let T=x.value.slice(1);if(T.includes("[")&&(x.posix=!0,T.includes(":"))){let z=x.value.lastIndexOf("["),q=x.value.slice(0,z),re=x.value.slice(z+2),X=Lo[re];if(X){x.value=q+X,g.backtrack=!0,Q(),!s.output&&a.indexOf(x)===1&&(s.output=v);continue}}}(_==="["&&k()!==":"||_==="-"&&k()==="]")&&(_=`\\${_}`),_==="]"&&(x.value==="["||x.value==="[^")&&(_=`\\${_}`),r.posix===!0&&_==="!"&&x.value==="["&&(_="^"),x.value+=_,fe({value:_});continue}if(g.quotes===1&&_!=='"'){_=se.escapeRegex(_),x.value+=_,fe({value:_});continue}if(_==='"'){g.quotes=g.quotes===1?0:1,r.keepQuotes===!0&&U({type:"text",value:_});continue}if(_==="("){ye("parens"),U({type:"paren",value:_});continue}if(_===")"){if(g.parens===0&&r.strictBrackets===!0)throw new SyntaxError(Ne("opening","("));let T=D[D.length-1];if(T&&g.parens===T.parens+1){qe(D.pop());continue}U({type:"paren",value:_,output:g.parens?")":"\\)"}),pe("parens");continue}if(_==="["){if(r.nobracket===!0||!Z().includes("]")){if(r.nobracket!==!0&&r.strictBrackets===!0)throw new SyntaxError(Ne("closing","]"));_=`\\${_}`}else ye("brackets");U({type:"bracket",value:_});continue}if(_==="]"){if(r.nobracket===!0||x&&x.type==="bracket"&&x.value.length===1){U({type:"text",value:_,output:`\\${_}`});continue}if(g.brackets===0){if(r.strictBrackets===!0)throw new SyntaxError(Ne("opening","["));U({type:"text",value:_,output:`\\${_}`});continue}pe("brackets");let T=x.value.slice(1);if(x.posix!==!0&&T[0]==="^"&&!T.includes("/")&&(_=`/${_}`),x.value+=_,fe({value:_}),r.literalBrackets===!1||se.hasRegexChars(T))continue;let z=se.escapeRegex(x.value);if(g.output=g.output.slice(0,-x.value.length),r.literalBrackets===!0){g.output+=z,x.value=z;continue}x.value=`(${o}${z}|${x.value})`,g.output+=x.value;continue}if(_==="{"&&r.nobrace!==!0){ye("braces");let T={type:"brace",value:_,output:"(",outputIndex:g.output.length,tokensIndex:g.tokens.length};N.push(T),U(T);continue}if(_==="}"){let T=N[N.length-1];if(r.nobrace===!0||!T){U({type:"text",value:_,output:_});continue}let z=")";if(T.dots===!0){let q=a.slice(),re=[];for(let X=q.length-1;X>=0&&(a.pop(),q[X].type!=="brace");X--)q[X].type!=="dots"&&re.unshift(q[X].value);z=Oo(re,r),g.backtrack=!0}if(T.comma!==!0&&T.dots!==!0){let q=g.output.slice(0,T.outputIndex),re=g.tokens.slice(T.tokensIndex);T.value=T.output="\\{",_=z="\\}",g.output=q;for(let X of re)g.output+=X.output||X.value}U({type:"brace",value:_,output:z}),pe("braces"),N.pop();continue}if(_==="|"){D.length>0&&D[D.length-1].conditions++,U({type:"text",value:_});continue}if(_===","){let T=_,z=N[N.length-1];z&&P[P.length-1]==="braces"&&(z.comma=!0,T="|"),U({type:"comma",value:_,output:T});continue}if(_==="/"){if(x.type==="dot"&&g.index===g.start+1){g.start=g.index+1,g.consumed="",g.output="",a.pop(),x=s;continue}U({type:"slash",value:_,output:d});continue}if(_==="."){if(g.braces>0&&x.type==="dot"){x.value==="."&&(x.output=u);let T=N[N.length-1];x.type="dots",x.output+=_,x.value+=_,T.dots=!0;continue}if(g.braces+g.parens===0&&x.type!=="bos"&&x.type!=="slash"){U({type:"text",value:_,output:u});continue}U({type:"dot",value:_,output:u});continue}if(_==="?"){if(!(x&&x.value==="(")&&r.noextglob!==!0&&k()==="("&&k(2)!=="?"){be("qmark",_);continue}if(x&&x.type==="paren"){let z=k(),q=_;if(z==="<"&&!se.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(x.value==="("&&!/[!=<:]/.test(z)||z==="<"&&!/<([!=]|\w+>)/.test(Z()))&&(q=`\\${_}`),U({type:"text",value:_,output:q});continue}if(r.dot!==!0&&(x.type==="slash"||x.type==="bos")){U({type:"qmark",value:_,output:E});continue}U({type:"qmark",value:_,output:A});continue}if(_==="!"){if(r.noextglob!==!0&&k()==="("&&(k(2)!=="?"||!/[!=<:]/.test(k(3)))){be("negate",_);continue}if(r.nonegate!==!0&&g.index===0){He();continue}}if(_==="+"){if(r.noextglob!==!0&&k()==="("&&k(2)!=="?"){be("plus",_);continue}if(x&&x.value==="("||r.regex===!1){U({type:"plus",value:_,output:p});continue}if(x&&(x.type==="bracket"||x.type==="paren"||x.type==="brace")||g.parens>0){U({type:"plus",value:_});continue}U({type:"plus",value:p});continue}if(_==="@"){if(r.noextglob!==!0&&k()==="("&&k(2)!=="?"){U({type:"at",extglob:!0,value:_,output:""});continue}U({type:"text",value:_});continue}if(_!=="*"){(_==="$"||_==="^")&&(_=`\\${_}`);let T=Co.exec(Z());T&&(_+=T[0],g.index+=T[0].length),U({type:"text",value:_});continue}if(x&&(x.type==="globstar"||x.star===!0)){x.type="star",x.star=!0,x.value+=_,x.output=B,g.backtrack=!0,g.globstar=!0,ee(_);continue}let L=Z();if(r.noextglob!==!0&&/^\([^?]/.test(L)){be("star",_);continue}if(x.type==="star"){if(r.noglobstar===!0){ee(_);continue}let T=x.prev,z=T.prev,q=T.type==="slash"||T.type==="bos",re=z&&(z.type==="star"||z.type==="globstar");if(r.bash===!0&&(!q||L[0]&&L[0]!=="/")){U({type:"star",value:_,output:""});continue}let X=g.braces>0&&(T.type==="comma"||T.type==="brace"),At=D.length&&(T.type==="pipe"||T.type==="paren");if(!q&&T.type!=="paren"&&!X&&!At){U({type:"star",value:_,output:""});continue}for(;L.slice(0,3)==="/**";){let We=e[g.index+4];if(We&&We!=="/")break;L=L.slice(3),ee("/**",3)}if(T.type==="bos"&&j()){x.type="globstar",x.value+=_,x.output=F(r),g.output=x.output,g.globstar=!0,ee(_);continue}if(T.type==="slash"&&T.prev.type!=="bos"&&!re&&j()){g.output=g.output.slice(0,-(T.output+x.output).length),T.output=`(?:${T.output}`,x.type="globstar",x.output=F(r)+(r.strictSlashes?")":"|$)"),x.value+=_,g.globstar=!0,g.output+=T.output+x.output,ee(_);continue}if(T.type==="slash"&&T.prev.type!=="bos"&&L[0]==="/"){let We=L[1]!==void 0?"|$":"";g.output=g.output.slice(0,-(T.output+x.output).length),T.output=`(?:${T.output}`,x.type="globstar",x.output=`${F(r)}${d}|${d}${We})`,x.value+=_,g.output+=T.output+x.output,g.globstar=!0,ee(_+Q()),U({type:"slash",value:"/",output:""});continue}if(T.type==="bos"&&L[0]==="/"){x.type="globstar",x.value+=_,x.output=`(?:^|${d}|${F(r)}${d})`,g.output=x.output,g.globstar=!0,ee(_+Q()),U({type:"slash",value:"/",output:""});continue}g.output=g.output.slice(0,-x.output.length),x.type="globstar",x.output=F(r),x.value+=_,g.output+=x.output,g.globstar=!0,ee(_);continue}let V={type:"star",value:_,output:B};if(r.bash===!0){V.output=".*?",(x.type==="bos"||x.type==="slash")&&(V.output=M+V.output),U(V);continue}if(x&&(x.type==="bracket"||x.type==="paren")&&r.regex===!0){V.output=_,U(V);continue}(g.index===g.start||x.type==="slash"||x.type==="dot")&&(x.type==="dot"?(g.output+=y,x.output+=y):r.dot===!0?(g.output+=C,x.output+=C):(g.output+=M,x.output+=M),k()!=="*"&&(g.output+=v,x.output+=v)),U(V)}for(;g.brackets>0;){if(r.strictBrackets===!0)throw new SyntaxError(Ne("closing","]"));g.output=se.escapeLast(g.output,"["),pe("brackets")}for(;g.parens>0;){if(r.strictBrackets===!0)throw new SyntaxError(Ne("closing",")"));g.output=se.escapeLast(g.output,"("),pe("parens")}for(;g.braces>0;){if(r.strictBrackets===!0)throw new SyntaxError(Ne("closing","}"));g.output=se.escapeLast(g.output,"{"),pe("braces")}if(r.strictSlashes!==!0&&(x.type==="star"||x.type==="bracket")&&U({type:"maybe_slash",value:"",output:`${d}?`}),g.backtrack===!0){g.output="";for(let L of g.tokens)g.output+=L.output!=null?L.output:L.value,L.suffix&&(g.output+=L.suffix)}return g};Rn.fastpaths=(e,t)=>{let r={...t},n=typeof r.maxLength=="number"?Math.min(ht,r.maxLength):ht,i=e.length;if(i>n)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${n}`);e=Sn[e]||e;let s=se.isWindows(t),{DOT_LITERAL:a,SLASH_LITERAL:o,ONE_CHAR:l,DOTS_SLASH:c,NO_DOT:h,NO_DOTS:u,NO_DOTS_SLASH:p,STAR:d,START_ANCHOR:v}=lt.globChars(s),m=r.dot?u:h,f=r.dot?p:h,y=r.capture?"":"?:",C={negated:!1,prefix:""},A=r.bash===!0?".*?":d;r.capture&&(A=`(${A})`);let E=M=>M.noglobstar===!0?A:`(${y}(?:(?!${v}${M.dot?c:a}).)*?)`,w=M=>{switch(M){case"*":return`${m}${l}${A}`;case".*":return`${a}${l}${A}`;case"*.*":return`${m}${A}${a}${l}${A}`;case"*/*":return`${m}${A}${o}${l}${f}${A}`;case"**":return m+E(r);case"**/*":return`(?:${m}${E(r)}${o})?${f}${l}${A}`;case"**/*.*":return`(?:${m}${E(r)}${o})?${f}${A}${a}${l}${A}`;case"**/.*":return`(?:${m}${E(r)}${o})?${a}${l}${A}`;default:{let O=/^(.*?)\.(\w+)$/.exec(M);if(!O)return;let B=w(O[1]);return B?B+a+O[2]:void 0}}},b=se.removePrefix(e,C),F=w(b);return F&&r.strictSlashes!==!0&&(F+=`${o}?`),F};bn.exports=Rn});var In=Se((sf,Cn)=>{"use strict";var No=st(),Fo=Tn(),Qt=Ln(),Zt=ot(),Do=$e(),Po=e=>e&&typeof e=="object"&&!Array.isArray(e),W=(e,t,r=!1)=>{if(Array.isArray(e)){let h=e.map(p=>W(p,t,r));return p=>{for(let d of h){let v=d(p);if(v)return v}return!1}}let n=Po(e)&&e.tokens&&e.input;if(e===""||typeof e!="string"&&!n)throw new TypeError("Expected pattern to be a non-empty string");let i=t||{},s=Zt.isWindows(t),a=n?W.compileRe(e,t):W.makeRe(e,t,!1,!0),o=a.state;delete a.state;let l=()=>!1;if(i.ignore){let h={...t,ignore:null,onMatch:null,onResult:null};l=W(i.ignore,h,r)}let c=(h,u=!1)=>{let{isMatch:p,match:d,output:v}=W.test(h,a,t,{glob:e,posix:s}),m={glob:e,state:o,regex:a,posix:s,input:h,output:v,match:d,isMatch:p};return typeof i.onResult=="function"&&i.onResult(m),p===!1?(m.isMatch=!1,u?m:!1):l(h)?(typeof i.onIgnore=="function"&&i.onIgnore(m),m.isMatch=!1,u?m:!1):(typeof i.onMatch=="function"&&i.onMatch(m),u?m:!0)};return r&&(c.state=o),c};W.test=(e,t,r,{glob:n,posix:i}={})=>{if(typeof e!="string")throw new TypeError("Expected input to be a string");if(e==="")return{isMatch:!1,output:""};let s=r||{},a=s.format||(i?Zt.toPosixSlashes:null),o=e===n,l=o&&a?a(e):e;return o===!1&&(l=a?a(e):e,o=l===n),(o===!1||s.capture===!0)&&(s.matchBase===!0||s.basename===!0?o=W.matchBase(e,t,r,i):o=t.exec(l)),{isMatch:Boolean(o),match:o,output:l}};W.matchBase=(e,t,r,n=Zt.isWindows(r))=>(t instanceof RegExp?t:W.makeRe(t,r)).test(No.basename(e));W.isMatch=(e,t,r)=>W(t,r)(e);W.parse=(e,t)=>Array.isArray(e)?e.map(r=>W.parse(r,t)):Qt(e,{...t,fastpaths:!1});W.scan=(e,t)=>Fo(e,t);W.compileRe=(e,t,r=!1,n=!1)=>{if(r===!0)return e.output;let i=t||{},s=i.contains?"":"^",a=i.contains?"":"$",o=`${s}(?:${e.output})${a}`;e&&e.negated===!0&&(o=`^(?!${o}).*$`);let l=W.toRegex(o,t);return n===!0&&(l.state=e),l};W.makeRe=(e,t={},r=!1,n=!1)=>{if(!e||typeof e!="string")throw new TypeError("Expected a non-empty string");let i={negated:!1,fastpaths:!0};return t.fastpaths!==!1&&(e[0]==="."||e[0]==="*")&&(i.output=Qt.fastpaths(e,t)),i.output||(i=Qt(e,t)),W.compileRe(i,t,r,n)};W.toRegex=(e,t)=>{try{let r=t||{};return new RegExp(e,r.flags||(r.nocase?"i":""))}catch(r){if(t&&t.debug===!0)throw r;return/$^/}};W.constants=Do;Cn.exports=W});var Nn=Se((af,On)=>{"use strict";On.exports=In()});var hs=`<div class="container">
  <label class="hidden" id="title">display-port</label>
  <label class="hidden" id="fps">00</label>
  <label class="hidden" id="dimension">0x0</label>
  <div class="content">
    <canvas> Oh no! Your browser does not support canvas. </canvas>
    <slot id="inner"></slot>
  </div>
  <slot name="frame"></slot>
</div>
`,cs=`:host {
  display: inline-block;
  color: #555555;
}

.container {
  display: flex;
  position: relative;
  width: 100%;
  height: 100%;
}

.content {
  position: relative;
  margin: auto;
}

.content > *:not(canvas) {
  width: 100%;
  height: 100%;
}

canvas {
  background: #000000;
  image-rendering: pixelated;
}

label {
  position: absolute;
  font-family: monospace;
  color: currentColor;
}

#inner {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: 0;
  left: 0;
  pointer-events: none;
}

#title {
  left: 0.5rem;
  top: 0.5rem;
}

#fps {
  right: 0.5rem;
  top: 0.5rem;
}

#dimension {
  left: 0.5rem;
  bottom: 0.5rem;
}

.hidden {
  display: none;
}

:host([debug]) .container {
  outline: 6px dashed rgba(0, 0, 0, 0.1);
  outline-offset: -4px;
  background-color: rgba(0, 0, 0, 0.1);
}

:host([mode='noscale']) canvas {
  margin: 0;
  top: 0;
  left: 0;
}

:host([mode='stretch']) canvas,
:host([mode='scale']) canvas {
  width: 100%;
  height: 100%;
}

:host([mode='fit']),
:host([mode='scale']),
:host([mode='center']),
:host([mode='stretch']),
:host([mode='fill']) {
  width: 100%;
  height: 100%;
}

:host([full]) {
  width: 100vw !important;
  height: 100vh !important;
}

:host([disabled]) {
  display: none;
}

slot {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  pointer-events: none;
}

::slotted(*) {
  pointer-events: auto;
}
`,br="noscale",wt="fit",Sr="scale",Rr="fill",Lr="stretch",us=300,fs=150,ps=wt,ds=200,Cr=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=hs,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=cs,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("display-port",this)}static get observedAttributes(){return["debug","disabled","width","height","onframe","id","class"]}get mode(){return this.getAttribute("mode")}set mode(t){this.setAttribute("mode",t)}get debug(){return this._debug}set debug(t){this.toggleAttribute("debug",t)}get disabled(){return this._disabled}set disabled(t){this.toggleAttribute("disabled",t)}get width(){return this._width}set width(t){this.setAttribute("width",String(t))}get height(){return this._height}set height(t){this.setAttribute("height",String(t))}get onframe(){return this._onframe}set onframe(t){this._onframe&&this.removeEventListener("frame",this._onframe),this._onframe=t,this._onframe&&this.addEventListener("frame",t)}constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._canvasElement=this.shadowRoot.querySelector("canvas"),this._contentElement=this.shadowRoot.querySelector(".content"),this._innerElement=this.shadowRoot.querySelector("#inner"),this._titleElement=this.shadowRoot.querySelector("#title"),this._fpsElement=this.shadowRoot.querySelector("#fps"),this._dimensionElement=this.shadowRoot.querySelector("#dimension"),this._debug=!1,this._disabled=!1,this._width=us,this._height=fs,this._onframe=void 0,this._animationRequestHandle=0,this._prevAnimationFrameTime=0,this._resizeTimeoutHandle=0,this._resizeCanvasWidth=0,this._resizeCanvasHeight=0,this.update=this.update.bind(this),this.onDelayCanvasResize=this.onDelayCanvasResize.bind(this)}get canvas(){return this._canvasElement}connectedCallback(){Ie(this,"mode"),Ie(this,"debug"),Ie(this,"disabled"),Ie(this,"width"),Ie(this,"height"),Ie(this,"onframe"),this.hasAttribute("mode")||this.setAttribute("mode",ps),this.hasAttribute("tabindex")||this.setAttribute("tabindex","0"),this.updateCanvasSize(!0),this.resume()}disconnectedCallback(){this.pause()}attributeChangedCallback(t,r,n){switch(t){case"debug":this._debug=n!==null;break;case"disabled":this._disabled=n!==null;break;case"width":this._width=Number(n);break;case"height":this._height=Number(n);break;case"onframe":this.onframe=new Function("event","with(document){with(this){"+n+"}}").bind(this);break}switch(t){case"disabled":n?(this.update(0),this.pause()):this.resume();break;case"id":case"class":this._titleElement.innerHTML=`display-port${this.className?"."+this.className:""}${this.hasAttribute("id")?"#"+this.getAttribute("id"):""}`;break;case"debug":this._titleElement.classList.toggle("hidden",n),this._fpsElement.classList.toggle("hidden",n),this._dimensionElement.classList.toggle("hidden",n);break}}getContext(t="2d",r=void 0){return this._canvasElement.getContext(t,r)}pause(){cancelAnimationFrame(this._animationRequestHandle)}resume(){this._animationRequestHandle=requestAnimationFrame(this.update)}update(t){this._animationRequestHandle=requestAnimationFrame(this.update),this.updateCanvasSize(!1);let r=t-this._prevAnimationFrameTime;if(this._prevAnimationFrameTime=t,this._debug){let n=r<=0?"--":String(Math.round(1e3/r)).padStart(2,"0");if(this._fpsElement.textContent!==n&&(this._fpsElement.textContent=n),this.mode===br){let s=`${this._width}x${this._height}`;this._dimensionElement.textContent!==s&&(this._dimensionElement.textContent=s)}else{let s=`${this._width}x${this._height}|${this.shadowRoot.host.clientWidth}x${this.shadowRoot.host.clientHeight}`;this._dimensionElement.textContent!==s&&(this._dimensionElement.textContent=s)}}this.dispatchEvent(new CustomEvent("frame",{detail:{now:t,prevTime:this._prevAnimationFrameTime,deltaTime:r,canvas:this._canvasElement},bubbles:!1,composed:!0}))}onDelayCanvasResize(){this._resizeTimeoutHandle=0,this.updateCanvasSize(!0)}delayCanvasResize(t,r){(t!==this._resizeCanvasWidth||r!==this._resizeCanvasHeight)&&(this._resizeCanvasWidth=t,this._resizeCanvasHeight=r,this._resizeTimeoutHandle&&clearTimeout(this._resizeTimeoutHandle),this._resizeTimeoutHandle=setTimeout(this.onDelayCanvasResize,ds))}updateCanvasSize(t=!0){let r=this.shadowRoot.host.getBoundingClientRect(),n=r.width,i=r.height,s=this._canvasElement,a=this._width,o=this._height,l=this.mode;if(l===Lr||l===Rr)a=n,o=i;else if(l!==br&&(n<a||i<o||l===wt||l==Sr)){let h=n/a,u=i/o;h<u?(a=n,o=o*h):(a=a*u,o=i)}if(a=Math.floor(a),o=Math.floor(o),typeof t=="undefined"&&(t=s.clientWidth!==a||s.clientHeight!==o),!t){this.delayCanvasResize(a,o);return}let c=Math.min(a/this._width,o/this._height)*.5;if(this._innerElement.style.fontSize=`font-size: ${c}em`,t){l===Sr?(s.width=this._width,s.height=this._height):l!==Lr&&(s.width=a,s.height=o);let h=this._contentElement.style;h.width=`${a}px`,h.height=`${o}px`,(l===wt||l===Rr)&&(this._width=a,this._height=o),this.dispatchEvent(new CustomEvent("resize",{detail:{width:a,height:o},bubbles:!1,composed:!0}))}}};Cr.define();function Ie(e,t){if(Object.prototype.hasOwnProperty.call(e,t)){let r=e[t];delete e[t],e[t]=r}}var Mt=class{get polling(){return performance.now()-this._lastPollingTime<1e3}get value(){return 0}get size(){return this._size}constructor(t){this._size=t,this._lastPollingTime=Number.MIN_SAFE_INTEGER}resize(t){this._size=t}getState(t){throw new Error("Missing implementation.")}onUpdate(t,r,n){throw new Error("Missing implementation.")}onStatus(t,r){throw new Error("Missing implementation.")}onPoll(t){this._lastPollingTime=t}onBind(t,r={}){t>=this._size&&this.resize(t+1)}onUnbind(){this.resize(0)}},ke=class extends Mt{static createAxisBindingState(){return{value:0,delta:0,inverted:!1}}get delta(){return this._delta}get value(){return this._value}constructor(t=0){super(t);let r=new Array;for(let n=0;n<t;++n)r.push(this.constructor.createAxisBindingState());this._state=r,this._value=0,this._delta=0}resize(t){let r=this._state,n=r.length,i;if(t<=n)i=r.slice(0,t);else{i=r;for(let s=n;s<t;++s)i.push(this.constructor.createAxisBindingState())}this._state=i,super.resize(t)}getState(t){return this._state[t].value}onPoll(t){let r=this._state,n=0,i=0,s=r.length;for(let a=0;a<s;++a){let o=r[a];n+=o.value*(o.inverted?-1:1),i+=o.delta,r[a].delta=0}this._value=n,this._delta=i,super.onPoll(t)}onUpdate(t,r,n){typeof r=="undefined"?this.onAxisChange(t,n):this.onAxisMove(t,r,n)}onStatus(t,r){this.onAxisStatus(t,r)}onBind(t,r={}){super.onBind(t,r);let{inverted:n=!1}=r,i=this._state;i[t].inverted=n}onAxisMove(t,r,n){let i=this._state[t];i.value=r,i.delta+=n}onAxisChange(t,r){let n=this._state[t];n.value+=r,n.delta+=r}onAxisStatus(t,r){let n=this._state[t],i=n.value;n.value=r,n.delta=r-i}},vs=241,Ir=254,ms=239,Re=1,Tt=2,bt=4,St=8,Rt=16,Qe=class extends Mt{get pressed(){return this._pressed}get repeated(){return this._repeated}get released(){return this._released}get down(){return this._down}get value(){return this._value}constructor(t=0){super(t);this._state=new Uint8Array(t),this._value=0,this._down=!1,this._pressed=!1,this._repeated=!1,this._released=!1}resize(t){let r=this._state,n=r.length,i;t<=n?i=r.slice(0,t):(i=new Uint8Array(t),i.set(r)),this._state=i,super.resize(t)}getState(t){let r=this._state[t],n=r&Rt?-1:1;return(r&Re?1:0)*n}onPoll(t){let r=this._state,n=0,i=0,s=0,a=0,o=0,l=r.length;for(let c=0;c<l;++c){let h=r[c],u=h&Re,p=h&Rt;i|=u,s|=h&Tt,a|=h&bt,o|=h&St,n+=(u?1:0)*(p?-1:1),r[c]&=vs}this._value=n,this._down=i!==0,this._pressed=s!==0,this._repeated=a!==0,this._released=o!==0,super.onPoll(t)}onUpdate(t,r,n){n>0?this.onButtonPressed(t):this.onButtonReleased(t)}onStatus(t,r){this.onButtonStatus(t,r!==0)}onBind(t,r={}){super.onBind(t,r);let{inverted:n=!1}=r,i=this._state;n?i[t]|=Rt:i[t]&=ms}onButtonPressed(t){let r=this._state,n=r[t];n&Re||(n|=Tt,n|=Re),n|=bt,r[t]=n}onButtonReleased(t){let r=this._state,n=r[t];n&Re&&(n|=St,n&=Ir),r[t]=n}onButtonStatus(t,r){let n=this._state,i=n[t],s=Boolean(i&Re);r?i|=Re:i&=Ir,s&&!r&&(i|=St),!s&&r&&(i|=Tt,i|=bt),n[t]=i}};var Or=class{get polling(){return this.ref?this.ref.polling:!1}get value(){return this.ref?this.ref.value:0}constructor(t){this.name=t,this.ref=null}register(t){throw new Error("Unsupported operation.")}getState(t){return this.ref?this.ref.getState(t):0}},S=class{static parse(t){t=t.trim();let r=t.indexOf(".");if(r<0)throw new Error("Missing device separator for key code.");let n=t.substring(0,r);if(n.length<0)throw new Error("Missing device for key code.");let i=t.substring(r+1);if(i.length<0)throw new Error("Missing code for key code.");return new S(n,i)}constructor(t,r){this.device=t,this.code=r}toString(){return`${this.device}.${this.code}`}};function Nr(e,t){return new S(e,t)}function xs(e){return"device"in e&&"code"in e}var I="Keyboard",he="Mouse",_s=new S(I,"KeyA"),gs=new S(I,"KeyB"),Es=new S(I,"KeyC"),ys=new S(I,"KeyD"),As=new S(I,"KeyE"),ws=new S(I,"KeyF"),Ms=new S(I,"KeyG"),Ts=new S(I,"KeyH"),bs=new S(I,"KeyI"),Ss=new S(I,"KeyJ"),Rs=new S(I,"KeyK"),Ls=new S(I,"KeyL"),Cs=new S(I,"KeyM"),Is=new S(I,"KeyN"),Os=new S(I,"KeyO"),Ns=new S(I,"KeyP"),Fs=new S(I,"KeyQ"),Ds=new S(I,"KeyR"),Ps=new S(I,"KeyS"),Bs=new S(I,"KeyT"),Us=new S(I,"KeyU"),zs=new S(I,"KeyV"),Hs=new S(I,"KeyW"),ks=new S(I,"KeyX"),Ks=new S(I,"KeyY"),Ys=new S(I,"KeyZ"),$s=new S(I,"Digit0"),Vs=new S(I,"Digit1"),Gs=new S(I,"Digit2"),js=new S(I,"Digit3"),qs=new S(I,"Digit4"),Ws=new S(I,"Digit5"),Xs=new S(I,"Digit6"),Qs=new S(I,"Digit7"),Zs=new S(I,"Digit8"),Js=new S(I,"Digit9"),ea=new S(I,"Minus"),ta=new S(I,"Equal"),ra=new S(I,"BracketLeft"),na=new S(I,"BracketRight"),ia=new S(I,"Semicolon"),sa=new S(I,"Quote"),aa=new S(I,"Backquote"),oa=new S(I,"Backslash"),la=new S(I,"Comma"),ha=new S(I,"Period"),ca=new S(I,"Slash"),ua=new S(I,"Escape"),fa=new S(I,"Space"),pa=new S(I,"CapsLock"),da=new S(I,"Backspace"),va=new S(I,"Delete"),ma=new S(I,"Tab"),xa=new S(I,"Enter"),_a=new S(I,"ArrowUp"),ga=new S(I,"ArrowDown"),Ea=new S(I,"ArrowLeft"),ya=new S(I,"ArrowRight"),Aa=new S(he,"Button0"),wa=new S(he,"Button1"),Ma=new S(he,"Button2"),Ta=new S(he,"Button3"),ba=new S(he,"Button4"),Sa=new S(he,"PosX"),Ra=new S(he,"PosY"),La=new S(he,"WheelX"),Ca=new S(he,"WheelY"),Ia=new S(he,"WheelZ"),Ae=Object.freeze({__proto__:null,from:Nr,isKeyCode:xs,KEYBOARD:I,MOUSE:he,KEY_A:_s,KEY_B:gs,KEY_C:Es,KEY_D:ys,KEY_E:As,KEY_F:ws,KEY_G:Ms,KEY_H:Ts,KEY_I:bs,KEY_J:Ss,KEY_K:Rs,KEY_L:Ls,KEY_M:Cs,KEY_N:Is,KEY_O:Os,KEY_P:Ns,KEY_Q:Fs,KEY_R:Ds,KEY_S:Ps,KEY_T:Bs,KEY_U:Us,KEY_V:zs,KEY_W:Hs,KEY_X:ks,KEY_Y:Ks,KEY_Z:Ys,DIGIT_0:$s,DIGIT_1:Vs,DIGIT_2:Gs,DIGIT_3:js,DIGIT_4:qs,DIGIT_5:Ws,DIGIT_6:Xs,DIGIT_7:Qs,DIGIT_8:Zs,DIGIT_9:Js,MINUS:ea,EQUAL:ta,BRACKET_LEFT:ra,BRACKET_RIGHT:na,SEMICOLON:ia,QUOTE:sa,BACKQUOTE:aa,BACKSLASH:oa,COMMA:la,PERIOD:ha,SLASH:ca,ESCAPE:ua,SPACE:fa,CAPS_LOCK:pa,BACKSPACE:da,DELETE:va,TAB:ma,ENTER:xa,ARROW_UP:_a,ARROW_DOWN:ga,ARROW_LEFT:Ea,ARROW_RIGHT:ya,MOUSE_BUTTON_0:Aa,MOUSE_BUTTON_1:wa,MOUSE_BUTTON_2:Ma,MOUSE_BUTTON_3:Ta,MOUSE_BUTTON_4:ba,MOUSE_POS_X:Sa,MOUSE_POS_Y:Ra,MOUSE_WHEEL_X:La,MOUSE_WHEEL_Y:Ca,MOUSE_WHEEL_Z:Ia});function Na(e){Array.isArray(e)||(e=[e]);let t=[];for(let r of e){let n;try{n=S.parse(r)}catch(i){let s=Oa(r).toUpperCase();if(!(s in Ae))throw new Error("Invalid key code string - "+i);n=Ae[s]}t.push(n)}return t}function Oa(e){return e.replace(/([a-z]|(?:[A-Z0-9]+))([A-Z0-9]|$)/g,function(t,r,n){return r+(n&&"_"+n)}).toLowerCase()}var we=class extends Or{static fromBind(t,r,n,i=void 0){return new we(t,Nr(r,n),i)}static fromString(t,...r){let n=Na(r);return new we(t,n)}get pressed(){return this.ref?this.ref.pressed:!1}get repeated(){return this.ref?this.ref.repeated:!1}get released(){return this.ref?this.ref.released:!1}get down(){return this.ref?this.ref.down:!1}constructor(t,r,n=void 0){super(t);this.keyCodes=Array.isArray(r)?r:[r],this.opts=n}register(t){let r=this.name,n=this.opts;for(let i of this.keyCodes)t.bindButton(r,i.device,i.code,n);return this.ref=t.getButton(r),this}};var Lt=class{static isAxis(t){return!1}static isButton(t){return!1}constructor(t,r){if(!r)throw new Error(`Missing event target for device ${t}.`);this.name=t,this.eventTarget=r,this.listeners={input:[]}}setEventTarget(t){if(!t)throw new Error(`Missing event target for device ${this.name}.`);this.eventTarget=t}destroy(){let t=this.listeners;for(let r in t)t[r].length=0}addEventListener(t,r){let n=this.listeners;t in n?n[t].push(r):n[t]=[r]}removeEventListener(t,r){let n=this.listeners;if(t in n){let i=n[t],s=i.indexOf(r);s>=0&&i.splice(s,1)}}dispatchInputEvent(t){let r=0;for(let n of this.listeners.input)r|=n(t);return Boolean(r)}},Fr=class extends Lt{static isAxis(t){return!1}static isButton(t){return!0}constructor(t,r,n={}){super(t,r);let{ignoreRepeat:i=!0}=n;this.ignoreRepeat=i,this._eventObject={target:r,device:t,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),r.addEventListener("keydown",this.onKeyDown),r.addEventListener("keyup",this.onKeyUp)}setEventTarget(t){this.eventTarget&&this.destroy(),super.setEventTarget(t),t.addEventListener("keydown",this.onKeyDown),t.addEventListener("keyup",this.onKeyUp)}destroy(){let t=this.eventTarget;t.removeEventListener("keydown",this.onKeyDown),t.removeEventListener("keyup",this.onKeyUp),super.destroy()}onKeyDown(t){if(t.repeat&&this.ignoreRepeat)return t.preventDefault(),t.stopPropagation(),!1;let r=this._eventObject;if(r.code=t.code,r.event="pressed",r.value=1,r.control=t.ctrlKey,r.shift=t.shiftKey,r.alt=t.altKey,this.dispatchInputEvent(r))return t.preventDefault(),t.stopPropagation(),!1}onKeyUp(t){let r=this._eventObject;if(r.code=t.code,r.event="released",r.value=1,r.control=t.ctrlKey,r.shift=t.shiftKey,r.alt=t.altKey,this.dispatchInputEvent(r))return t.preventDefault(),t.stopPropagation(),!1}},Ct=10,It=100,Dr=class extends Lt{static isAxis(t){return t==="PosX"||t==="PosY"||t==="WheelX"||t==="WheelY"||t==="WheelZ"}static isButton(t){return!this.isAxis(t)}constructor(t,r,n={}){super(t,r);let{eventsOnFocus:i=!0}=n;this.eventsOnFocus=i,this.canvasTarget=this.getCanvasFromEventTarget(r),this._downHasFocus=!1,this._eventObject={target:r,device:t,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this._positionObject={target:r,device:t,code:"",event:"move",value:0,movement:0},this._wheelObject={target:r,device:t,code:"",event:"wheel",movement:0},this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onWheel=this.onWheel.bind(this),r.addEventListener("mousedown",this.onMouseDown),r.addEventListener("contextmenu",this.onContextMenu),r.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}setEventTarget(t){this.eventTarget&&this.destroy(),super.setEventTarget(t),this.canvasTarget=this.getCanvasFromEventTarget(t),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("contextmenu",this.onContextMenu),t.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}destroy(){let t=this.eventTarget;t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("contextmenu",this.onContextMenu),t.removeEventListener("wheel",this.onWheel),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),super.destroy()}setPointerLock(t=!0){t?this.eventTarget.requestPointerLock():this.eventTarget.exitPointerLock()}hasPointerLock(){return document.pointerLockElement===this.eventTarget}onMouseDown(t){this._downHasFocus=!0;let r=this._eventObject;if(r.code="Button"+t.button,r.event="pressed",r.value=1,r.control=t.ctrlKey,r.shift=t.shiftKey,r.alt=t.altKey,this.dispatchInputEvent(r)&&document.activeElement===this.eventTarget)return t.preventDefault(),t.stopPropagation(),!1}onContextMenu(t){return t.preventDefault(),t.stopPropagation(),!1}onWheel(t){let r,n,i;switch(t.deltaMode){case WheelEvent.DOM_DELTA_LINE:r=t.deltaX*Ct,n=t.deltaY*Ct,i=t.deltaZ*Ct;break;case WheelEvent.DOM_DELTA_PAGE:r=t.deltaX*It,n=t.deltaY*It,i=t.deltaZ*It;break;case WheelEvent.DOM_DELTA_PIXEL:default:r=t.deltaX,n=t.deltaY,i=t.deltaZ;break}let s=0,a=this._wheelObject;if(a.code="WheelX",a.movement=r,s|=this.dispatchInputEvent(a),a.code="WheelY",a.movement=n,s|=this.dispatchInputEvent(a),a.code="WheelZ",a.movement=i,s|=this.dispatchInputEvent(a),s)return t.preventDefault(),t.stopPropagation(),!1}onMouseUp(t){if(!this._downHasFocus)return;this._downHasFocus=!1;let r=this._eventObject;if(r.code="Button"+t.button,r.event="released",r.value=1,r.control=t.ctrlKey,r.shift=t.shiftKey,r.alt=t.altKey,this.dispatchInputEvent(r))return t.preventDefault(),t.stopPropagation(),!1}onMouseMove(t){if(this.eventsOnFocus&&document.activeElement!==this.eventTarget)return;let r=this.canvasTarget,{clientWidth:n,clientHeight:i}=r,s=r.getBoundingClientRect(),a=t.movementX/n,o=t.movementY/i,l=(t.clientX-s.left)/n,c=(t.clientY-s.top)/i,h=this._positionObject;h.code="PosX",h.value=l,h.movement=a,this.dispatchInputEvent(h),h.code="PosY",h.value=c,h.movement=o,this.dispatchInputEvent(h)}getCanvasFromEventTarget(t){return t instanceof HTMLCanvasElement?t:t.canvas||t.querySelector("canvas")||t.shadowRoot&&t.shadowRoot.querySelector("canvas")||t}},Fa=`<kbd>
  <span id="name"><slot></slot></span>
  <span id="value" class="hidden"></span>
</kbd>
`,Da=`kbd {
  position: relative;
  display: inline-block;
  border-radius: 3px;
  border: 1px solid #888888;
  font-size: 0.85em;
  font-weight: 700;
  text-rendering: optimizeLegibility;
  line-height: 12px;
  height: 14px;
  padding: 2px 4px;
  color: #444444;
  background-color: #eeeeee;
  box-shadow: inset 0 -3px 0 #aaaaaa;
  overflow: hidden;
}

kbd:empty::after {
  content: '<?>';
  opacity: 0.6;
}

.disabled {
  opacity: 0.6;
  box-shadow: none;
  background-color: #aaaaaa;
}

.hidden {
  display: none;
}

#value {
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  font-size: 0.85em;
  padding: 0 4px;
  padding-top: 2px;
  color: #cccccc;
  background-color: #333333;
  box-shadow: inset 0 3px 0 #222222;
}
`,Ot=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=Fa,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Da,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("input-code",this)}static get observedAttributes(){return["name","value","disabled"]}get disabled(){return this._disabled}set disabled(t){this.toggleAttribute("disabled",t)}get value(){return this._value}set value(t){this.setAttribute("value",t)}get name(){return this._name}set name(t){this.setAttribute("name",t)}constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._name="",this._value="",this._disabled=!1,this._kbdElement=this.shadowRoot.querySelector("kbd"),this._nameElement=this.shadowRoot.querySelector("#name"),this._valueElement=this.shadowRoot.querySelector("#value")}attributeChangedCallback(t,r,n){switch(t){case"name":this._name=n,this._nameElement.textContent=n;break;case"value":this._value=n,n!==null?(this._valueElement.classList.toggle("hidden",!1),this._valueElement.textContent=n,this._kbdElement.style.paddingRight=`${this._valueElement.clientWidth+4}px`):this._valueElement.classList.toggle("hidden",!0);break;case"disabled":this._disabled=n!==null,this._kbdElement.classList.toggle("disabled",n!==null);break}}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"name")){let t=this.name;delete this.name,this.name=t}if(Object.prototype.hasOwnProperty.call(this,"value")){let t=this.value;delete this.value,this.value=t}if(Object.prototype.hasOwnProperty.call(this,"disabled")){let t=this.disabled;delete this.disabled,this.disabled=t}}};Ot.define();var Pa=`<table>
  <thead>
    <tr class="tableHeader">
      <th colspan="3">
        <span class="tableTitle">
          <label id="title"> input-source </label>
          <span id="slotContainer">
            <slot></slot>
          </span>
          <p>
            <label for="poll">poll</label>
            <output id="poll"></output>
          </p>
          <p>
            <label for="focus">focus</label>
            <output id="focus"></output>
          </p>
        </span>
      </th>
    </tr>
    <tr class="colHeader">
      <th>name</th>
      <th>value</th>
      <th>key</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
`,Ba=`:host {
  display: block;
}

table {
  border-collapse: collapse;
  font-family: monospace;
}

table,
th,
td {
  border: 1px solid #666666;
}

th,
td {
  padding: 5px 10px;
}

td {
  text-align: center;
}

thead th {
  padding: 0;
}

.colHeader > th {
  font-size: 0.8em;
  padding: 0 10px;
  letter-spacing: 3px;
  background-color: #aaaaaa;
  color: #666666;
}

tbody output {
  border-radius: 0.3em;
  padding: 3px;
}

tr:not(.primary) .name,
tr:not(.primary) .value {
  opacity: 0.3;
}

tr:nth-child(2n) {
  background-color: #eeeeee;
}

.tableHeader {
  color: #666666;
}

.tableTitle {
  display: flex;
  flex-direction: row;
  align-items: center;
  padding: 4px;
}

#slotContainer {
  flex: 1;
}

p {
  display: inline;
  margin: 0;
  padding: 0;
  padding-right: 10px;
}

#poll:empty::after,
#focus:empty::after {
  content: '\u2717';
  color: #ff0000;
}
`,Pr=class{constructor(t){this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null,this.pollable=t}get running(){return this.animationFrameHandle!==null}start(){let t=this.animationFrameHandle;t&&cancelAnimationFrame(t),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}stop(){let t=this.animationFrameHandle;t&&cancelAnimationFrame(t),this.animationFrameHandle=null}onAnimationFrame(t){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.pollable.onPoll(t)}},Br=class{constructor(t){this.onInput=this.onInput.bind(this),this.onPoll=this.onPoll.bind(this),this.bindings=t}onPoll(t){for(let r of this.bindings.getInputs())r.onPoll(t)}onInput(t){let{device:r,code:n,event:i,value:s,movement:a,control:o,shift:l,alt:c}=t,h=this.bindings.getBindings(r,n);switch(i){case"pressed":for(let{input:u,index:p}of h)u.onUpdate(p,1,1);break;case"released":for(let{input:u,index:p}of h)u.onUpdate(p,0,-1);break;case"move":for(let{input:u,index:p}of h)u.onUpdate(p,s,a);break;case"wheel":for(let{input:u,index:p}of h)u.onUpdate(p,void 0,a);break}return h.length>0}},Nt=class{constructor(t,r,n,i){this.device=t,this.code=r,this.input=n,this.index=i}},Ur=class{constructor(){this.bindingMap={},this.inputMap=new Map}clear(){for(let t of this.inputMap.keys())t.onUnbind();this.inputMap.clear(),this.bindingMap={}}bind(t,r,n,i={}){let s,a=this.inputMap;if(a.has(t)){let l=a.get(t),c=t.size;t.onBind(c,i),s=new Nt(r,n,t,c),l.push(s)}else{let l=[];a.set(t,l);let c=0;t.onBind(c,i),s=new Nt(r,n,t,c),l.push(s)}let o=this.bindingMap;r in o?n in o[r]?o[r][n].push(s):o[r][n]=[s]:o[r]={[n]:[s]}}unbind(t){let r=this.inputMap;if(r.has(t)){let n=this.bindingMap,i=r.get(t);for(let s of i){let{device:a,code:o}=s,l=n[a][o],c=l.indexOf(s);l.splice(c,1)}i.length=0,t.onUnbind(),r.delete(t)}}isBound(t){return this.inputMap.has(t)}getInputs(){return this.inputMap.keys()}getBindingsByInput(t){return this.inputMap.get(t)}getBindings(t,r){let n=this.bindingMap;if(t in n){let i=n[t];if(r in i)return i[r]}return[]}},zr=class{constructor(t,r={}){this.inputs={},this.devices=[new Dr("Mouse",t),new Fr("Keyboard",t)],this.bindings=new Ur,this.adapter=new Br(this.bindings),this.autopoller=new Pr(this.adapter),this.eventTarget=t,this.anyButton=new Qe(1),this.anyButtonDevice="",this.anyButtonCode="",this.anyAxis=new ke(1),this.anyAxisDevice="",this.anyAxisCode="",this.listeners={bind:[],unbind:[],focus:[],blur:[]},this.onInput=this.onInput.bind(this),this.onEventTargetBlur=this.onEventTargetBlur.bind(this),this.onEventTargetFocus=this.onEventTargetFocus.bind(this),t.addEventListener("focus",this.onEventTargetFocus),t.addEventListener("blur",this.onEventTargetBlur);for(let n of this.devices)n.addEventListener("input",this.onInput)}get autopoll(){return this.autopoller.running}set autopoll(t=void 0){this.toggleAutoPoll(t)}destroy(){let t=this.listeners;for(let n in t)t[n].length=0;this.autopoller.running&&this.autopoller.stop();for(let n of this.devices)n.removeEventListener("input",this.onInput),n.destroy();let r=this.eventTarget;r.removeEventListener("focus",this.onEventTargetFocus),r.removeEventListener("blur",this.onEventTargetBlur)}setEventTarget(t){let r=this.eventTarget;r.removeEventListener("focus",this.onEventTargetFocus),r.removeEventListener("blur",this.onEventTargetBlur),this.eventTarget=t;for(let n of this.devices)n.setEventTarget(t);t.addEventListener("focus",this.onEventTargetFocus),t.addEventListener("blur",this.onEventTargetBlur)}toggleAutoPoll(t=void 0){let r=this.autopoller.running,n=typeof t=="undefined"?!r:Boolean(t);n!==r&&(n?this.autopoller.start():this.autopoller.stop())}addEventListener(t,r){let n=this.listeners;t in n?n[t].push(r):n[t]=[r]}removeEventListener(t,r){let n=this.listeners;if(t in n){let i=n[t],s=i.indexOf(r);s>=0&&i.splice(s,1)}}dispatchEvent(t){let{type:r}=t,n=0;for(let i of this.listeners[r])n|=i(t);return Boolean(n)}poll(t=performance.now()){if(this.autopoller.running)throw new Error("Should not manually poll() while autopolling.");this.onPoll(t)}onInput(t){let r=this.adapter.onInput(t);switch(t.event){case"pressed":this.anyButtonDevice=t.device,this.anyButtonCode=t.code,this.anyButton.onUpdate(0,1,1);break;case"released":this.anyButtonDevice=t.device,this.anyButtonCode=t.code,this.anyButton.onUpdate(0,0,-1);break;case"move":case"wheel":this.anyAxisDevice=t.device,this.anyAxisCode=t.code,this.anyAxis.onUpdate(0,t.value,t.movement);break}return r}onPoll(t){this.adapter.onPoll(t),this.anyButton.onPoll(t),this.anyAxis.onPoll(t)}onBind(){this.dispatchEvent({type:"bind"})}onUnbind(){this.dispatchEvent({type:"unbind"})}onEventTargetFocus(){this.dispatchEvent({type:"focus"})}onEventTargetBlur(){for(let t of this.bindings.getInputs())t.onStatus(0,0);this.anyButton.onStatus(0,0),this.anyAxis.onStatus(0,0),this.dispatchEvent({type:"blur"})}bindBindings(t){for(let r of t)r.register(this)}bindButton(t,r,n,i=void 0){let s;this.hasButton(t)?s=this.getButton(t):(s=new Qe(1),this.inputs[t]=s),this.bindings.bind(s,r,n,i),this.onBind()}bindAxis(t,r,n,i=void 0){let s;this.hasAxis(t)?s=this.getAxis(t):(s=new ke(1),this.inputs[t]=s),this.bindings.bind(s,r,n,i),this.onBind()}bindAxisButtons(t,r,n,i){let s;this.hasAxis(t)?s=this.getAxis(t):(s=new ke(2),this.inputs[t]=s),this.bindings.bind(s,r,i),this.bindings.bind(s,r,n,{inverted:!0}),this.onBind()}unbindButton(t){if(this.hasButton(t)){let r=this.getButton(t);delete this.inputs[t],this.bindings.unbind(r),this.onUnbind()}}unbindAxis(t){if(this.hasAxis(t)){let r=this.getAxis(t);delete this.inputs[t],this.bindings.unbind(r),this.onUnbind()}}getInput(t){return this.inputs[t]}getButton(t){return this.inputs[t]}getAxis(t){return this.inputs[t]}hasButton(t){return t in this.inputs&&this.inputs[t]instanceof Qe}hasAxis(t){return t in this.inputs&&this.inputs[t]instanceof ke}isButtonDown(t){return this.inputs[t].down}isButtonPressed(t){return this.inputs[t].pressed}isButtonReleased(t){return this.inputs[t].released}getInputValue(t){return this.inputs[t].value}getButtonValue(t){return this.inputs[t].value}getAxisValue(t){return this.inputs[t].value}getAxisDelta(t){return this.inputs[t].delta}isAnyButtonDown(t=void 0){if(typeof t=="undefined")return this.anyButton.down;{let r=this.inputs;for(let n of t)if(r[n].down)return!0}return!1}isAnyButtonPressed(t=void 0){if(typeof t=="undefined")return this.anyButton.pressed;{let r=this.inputs;for(let n of t)if(r[n].pressed)return!0}return!1}isAnyButtonReleased(t=void 0){if(typeof t=="undefined")return this.anyButton.released;{let r=this.inputs;for(let n of t)if(r[n].released)return!0}return!1}getAnyAxisValue(t=void 0){if(typeof t=="undefined")return this.anyAxis.value;{let r=this.inputs;for(let n of t){let i=r[n];if(i.value)return i.value}}return 0}getAnyAxisDelta(t=void 0){if(typeof t=="undefined")return this.anyAxis.delta;{let r=this.inputs;for(let n of t){let i=r[n];if(i.delta)return i.delta}}return 0}getLastButtonDevice(){return this.anyButtonDevice}getLastButtonCode(){return this.anyButtonCode}getLastAxisDevice(){return this.anyAxisDevice}getLastAxisCode(){return this.anyAxisCode}getMouse(){return this.devices[0]}getKeyboard(){return this.devices[1]}},Hr=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=Pa,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Ba,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("input-port",this)}static get observedAttributes(){return["autopoll","for"]}get autopoll(){return this._autopoll}set autopoll(t){this.toggleAttribute("autopoll",t)}get for(){return this._for}set for(t){this.setAttribute("for",t)}constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._titleElement=this.shadowRoot.querySelector("#title"),this._pollElement=this.shadowRoot.querySelector("#poll"),this._focusElement=this.shadowRoot.querySelector("#focus"),this._bodyElement=this.shadowRoot.querySelector("tbody"),this._outputElements={},this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null;let t=this;this._for="",this._eventTarget=t,this._autopoll=!1,this._context=null,this.onInputContextBind=this.onInputContextBind.bind(this),this.onInputContextUnbind=this.onInputContextUnbind.bind(this),this.onInputContextFocus=this.onInputContextFocus.bind(this),this.onInputContextBlur=this.onInputContextBlur.bind(this)}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"for")){let t=this.for;delete this.for,this.for=t}if(Object.prototype.hasOwnProperty.call(this,"autopoll")){let t=this.autopoll;delete this.autopoll,this.autopoll=t}this.updateTable(),this.updateTableValues(),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}disconnectedCallback(){this._context&&(this._context.removeEventListener("bind",this.onInputContextBind),this._context.removeEventListener("unbind",this.onInputContextUnbind),this._context.removeEventListener("blur",this.onInputContextBlur),this._context.removeEventListener("focus",this.onInputContextFocus),this._context.destroy(),this._context=null)}attributeChangedCallback(t,r,n){switch(t){case"for":{this._for=n;let i,s;n?(i=document.getElementById(n),s=`${i.tagName.toLowerCase()}#${n}`):(i=this,s="input-port"),this._eventTarget=i,this._context&&this._context.setEventTarget(this._eventTarget),this._titleElement.innerHTML=`for ${s}`}break;case"autopoll":this._autopoll=n!==null,this._context&&this._context.toggleAutoPoll(this._autopoll);break}}onAnimationFrame(){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.updateTableValues(),this.updatePollStatus()}onInputContextBind(){this.updateTable()}onInputContextUnbind(){this.updateTable()}onInputContextFocus(){this._focusElement.innerHTML="\u2713"}onInputContextBlur(){this._focusElement.innerHTML=""}getContext(t="axisbutton",r=void 0){switch(t){case"axisbutton":return this._context||(this._context=new zr(this._eventTarget,r),this._context.addEventListener("bind",this.onInputContextBind),this._context.addEventListener("unbind",this.onInputContextUnbind),this._context.addEventListener("blur",this.onInputContextBlur),this._context.addEventListener("focus",this.onInputContextFocus),this._autopoll&&this._context.toggleAutoPoll(!0)),this._context;default:throw new Error(`Input context id '${t}' is not supported.`)}}updateTable(){if(this.isConnected)if(this._context){let t=this._context,r=t.inputs,n=t.bindings,i={},s=[];for(let a of Object.keys(r)){let o=r[a],l=!0;for(let c of n.getBindingsByInput(o)){let h=Ua(`${o.constructor.name}.${a}`,`${c.device}.${c.code}`,0,l);s.push(h),l&&(i[a]=h.querySelector("output"),l=!1)}}this._outputElements=i,this._bodyElement.innerHTML="";for(let a of s)this._bodyElement.appendChild(a)}else{this._outputElements={},this._bodyElement.innerHTML="";return}else return}updateTableValues(){if(this.isConnected)if(this._context){let r=this._context.inputs;for(let n of Object.keys(this._outputElements)){let i=this._outputElements[n],s=r[n].value;i.innerText=Number(s).toFixed(2)}}else{for(let t of Object.keys(this._outputElements)){let r=this._outputElements[t];r.innerText="---"}return}else return}updatePollStatus(){if(this.isConnected)if(this._context){let r=this._context.inputs;for(let n of Object.values(r))if(!n.polling){this._pollElement.innerHTML="";return}this._pollElement.innerHTML="\u2713"}else{this._pollElement.innerHTML="-";return}else return}};Hr.define();function Ua(e,t,r,n=!0){let i=document.createElement("tr");n&&i.classList.add("primary");{let s=document.createElement("td");s.textContent=e,s.classList.add("name"),i.appendChild(s)}{let s=document.createElement("td"),a=document.createElement("output");n?a.innerText=Number(r).toFixed(2):a.innerText="---",a.classList.add("value"),s.appendChild(a),i.appendChild(s)}{let s=document.createElement("td");s.classList.add("key");let a=new Ot;a.innerText=t,s.appendChild(a),i.appendChild(s)}return i}var qu=Symbol("keyboardSource");var Wu=Symbol("mouseSource");var kr={},za=function(e,t,r,n,i){var s=new Worker(kr[t]||(kr[t]=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))));return s.onerror=function(a){return i(a.error,null)},s.onmessage=function(a){return i(null,a.data)},s.postMessage(r,n),s},te=Uint8Array,de=Uint16Array,Ke=Uint32Array,Ft=new te([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Dt=new te([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Kr=new te([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Yr=function(e,t){for(var r=new de(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var i=new Ke(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)i[s]=s-r[n]<<5|n;return[r,i]},$r=Yr(Ft,2),Pt=$r[0],Ha=$r[1];Pt[28]=258,Ha[258]=28;var Vr=Yr(Dt,0),Gr=Vr[0],Qu=Vr[1],Ze=new de(32768);for(var G=0;G<32768;++G)_e=(G&43690)>>>1|(G&21845)<<1,_e=(_e&52428)>>>2|(_e&13107)<<2,_e=(_e&61680)>>>4|(_e&3855)<<4,Ze[G]=((_e&65280)>>>8|(_e&255)<<8)>>>1;var _e,Oe=function(e,t,r){for(var n=e.length,i=0,s=new de(t);i<n;++i)++s[e[i]-1];var a=new de(t);for(i=0;i<t;++i)a[i]=a[i-1]+s[i-1]<<1;var o;if(r){o=new de(1<<t);var l=15-t;for(i=0;i<n;++i)if(e[i])for(var c=i<<4|e[i],h=t-e[i],u=a[e[i]-1]++<<h,p=u|(1<<h)-1;u<=p;++u)o[Ze[u]>>>l]=c}else for(o=new de(n),i=0;i<n;++i)e[i]&&(o[i]=Ze[a[e[i]-1]++]>>>15-e[i]);return o},Ye=new te(288);for(var G=0;G<144;++G)Ye[G]=8;for(var G=144;G<256;++G)Ye[G]=9;for(var G=256;G<280;++G)Ye[G]=7;for(var G=280;G<288;++G)Ye[G]=8;var jr=new te(32);for(var G=0;G<32;++G)jr[G]=5;var qr=Oe(Ye,9,1);var Wr=Oe(jr,5,1),Je=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},le=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(t&7)&r},et=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(t&7)},Xr=function(e){return(e/8|0)+(e&7&&1)},tt=function(e,t,r){(t==null||t<0)&&(t=0),(r==null||r>e.length)&&(r=e.length);var n=new(e instanceof de?de:e instanceof Ke?Ke:te)(r-t);return n.set(e.subarray(t,r)),n},Qr=function(e,t,r){var n=e.length;if(!n||r&&!r.l&&n<5)return t||new te(0);var i=!t||r,s=!r||r.i;r||(r={}),t||(t=new te(n*3));var a=function(U){var be=t.length;if(U>be){var qe=new te(Math.max(be*2,U));qe.set(t),t=qe}},o=r.f||0,l=r.p||0,c=r.b||0,h=r.l,u=r.d,p=r.m,d=r.n,v=n*8;do{if(!h){r.f=o=le(e,l,1);var m=le(e,l+1,3);if(l+=3,m)if(m==1)h=qr,u=Wr,p=9,d=5;else if(m==2){var A=le(e,l,31)+257,E=le(e,l+10,15)+4,w=A+le(e,l+5,31)+1;l+=14;for(var b=new te(w),F=new te(19),M=0;M<E;++M)F[Kr[M]]=le(e,l+M*3,7);l+=E*3;for(var O=Je(F),B=(1<<O)-1,g=Oe(F,O,1),M=0;M<w;){var D=g[le(e,l,B)];l+=D&15;var f=D>>>4;if(f<16)b[M++]=f;else{var N=0,P=0;for(f==16?(P=3+le(e,l,3),l+=2,N=b[M-1]):f==17?(P=3+le(e,l,7),l+=3):f==18&&(P=11+le(e,l,127),l+=7);P--;)b[M++]=N}}var x=b.subarray(0,A),_=b.subarray(A);p=Je(x),d=Je(_),h=Oe(x,p,1),u=Oe(_,d,1)}else throw"invalid block type";else{var f=Xr(l)+4,y=e[f-4]|e[f-3]<<8,C=f+y;if(C>n){if(s)throw"unexpected EOF";break}i&&a(c+y),t.set(e.subarray(f,C),c),r.b=c+=y,r.p=l=C*8;continue}if(l>v){if(s)throw"unexpected EOF";break}}i&&a(c+131072);for(var j=(1<<p)-1,k=(1<<d)-1,Q=l;;Q=l){var N=h[et(e,l)&j],Z=N>>>4;if(l+=N&15,l>v){if(s)throw"unexpected EOF";break}if(!N)throw"invalid length/literal";if(Z<256)t[c++]=Z;else if(Z==256){Q=l,h=null;break}else{var ee=Z-254;if(Z>264){var M=Z-257,fe=Ft[M];ee=le(e,l,(1<<fe)-1)+Pt[M],l+=fe}var He=u[et(e,l)&k],ye=He>>>4;if(!He)throw"invalid distance";l+=He&15;var _=Gr[ye];if(ye>3){var fe=Dt[ye];_+=et(e,l)&(1<<fe)-1,l+=fe}if(l>v){if(s)throw"unexpected EOF";break}i&&a(c+131072);for(var pe=c+ee;c<pe;c+=4)t[c]=t[c-_],t[c+1]=t[c+1-_],t[c+2]=t[c+2-_],t[c+3]=t[c+3-_];c=pe}}r.l=h,r.p=Q,r.b=c,h&&(o=1,r.m=p,r.d=u,r.n=d)}while(!o);return c==t.length?t:tt(t,0,c)};var ka=new te(0);var Ka=function(e,t){var r={};for(var n in e)r[n]=e[n];for(var n in t)r[n]=t[n];return r},Zr=function(e,t,r){for(var n=e(),i=e.toString(),s=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/ /g,"").split(","),a=0;a<n.length;++a){var o=n[a],l=s[a];if(typeof o=="function"){t+=";"+l+"=";var c=o.toString();if(o.prototype)if(c.indexOf("[native code]")!=-1){var h=c.indexOf(" ",8)+1;t+=c.slice(h,c.indexOf("(",h))}else{t+=c;for(var u in o.prototype)t+=";"+l+".prototype."+u+"="+o.prototype[u].toString()}else t+=c}else r[l]=o}return[t,r]},rt=[],Ya=function(e){var t=[];for(var r in e)(e[r]instanceof te||e[r]instanceof de||e[r]instanceof Ke)&&t.push((e[r]=new e[r].constructor(e[r])).buffer);return t},$a=function(e,t,r,n){var i;if(!rt[r]){for(var s="",a={},o=e.length-1,l=0;l<o;++l)i=Zr(e[l],s,a),s=i[0],a=i[1];rt[r]=Zr(e[o],s,a)}var c=Ka({},rt[r][1]);return za(rt[r][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",r,c,Ya(c),n)},Va=function(){return[te,de,Ke,Ft,Dt,Kr,Pt,Gr,qr,Wr,Ze,Oe,Je,le,et,Xr,tt,Qr,Bt,Jr,en]};var Jr=function(e){return postMessage(e,[e.buffer])},en=function(e){return e&&e.size&&new te(e.size)},Ga=function(e,t,r,n,i,s){var a=$a(r,n,i,function(o,l){a.terminate(),s(o,l)});return a.postMessage([e,t],t.consume?[e.buffer]:[]),function(){a.terminate()}};var ve=function(e,t){return e[t]|e[t+1]<<8},ce=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0},Ut=function(e,t){return ce(e,t)+ce(e,t+4)*4294967296};function ja(e,t,r){if(r||(r=t,t={}),typeof r!="function")throw"no callback";return Ga(e,t,[Va],function(n){return Jr(Bt(n.data[0],en(n.data[1])))},1,r)}function Bt(e,t){return Qr(e,t)}var Zu=typeof TextEncoder!="undefined"&&new TextEncoder,zt=typeof TextDecoder!="undefined"&&new TextDecoder,qa=0;try{zt.decode(ka,{stream:!0}),qa=1}catch(e){}var Wa=function(e){for(var t="",r=0;;){var n=e[r++],i=(n>127)+(n>223)+(n>239);if(r+i>e.length)return[t,tt(e,r-1)];i?i==3?(n=((n&15)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,t+=String.fromCharCode(55296|n>>10,56320|n&1023)):i&1?t+=String.fromCharCode((n&31)<<6|e[r++]&63):t+=String.fromCharCode((n&15)<<12|(e[r++]&63)<<6|e[r++]&63):t+=String.fromCharCode(n)}};function Xa(e,t){if(t){for(var r="",n=0;n<e.length;n+=16384)r+=String.fromCharCode.apply(null,e.subarray(n,n+16384));return r}else{if(zt)return zt.decode(e);var i=Wa(e),s=i[0],a=i[1];if(a.length)throw"invalid utf-8 data";return s}}var Qa=function(e,t){return t+30+ve(e,t+26)+ve(e,t+28)},Ja=function(e,t,r){var n=ve(e,t+28),i=Xa(e.subarray(t+46,t+46+n),!(ve(e,t+8)&2048)),s=t+46+n,a=ce(e,t+20),o=r&&a==4294967295?Za(e,s):[a,ce(e,t+24),ce(e,t+42)],l=o[0],c=o[1],h=o[2];return[ve(e,t+10),l,c,i,s+ve(e,t+30)+ve(e,t+32),h]},Za=function(e,t){for(;ve(e,t)!=1;t+=4+ve(e,t+2));return[Ut(e,t+12),Ut(e,t+4),Ut(e,t+20)]};function tn(e,t){if(typeof t!="function")throw"no callback";for(var r=[],n=function(){for(var p=0;p<r.length;++p)r[p]()},i={},s=e.length-22;ce(e,s)!=101010256;--s)if(!s||e.length-s>65558){t("invalid zip file",null);return}var a=ve(e,s+8);a||t(null,{});var o=a,l=ce(e,s+16),c=l==4294967295;if(c){if(s=ce(e,s-12),ce(e,s)!=101075792){t("invalid zip file",null);return}o=a=ce(e,s+32),l=ce(e,s+48)}for(var h=function(p){var d=Ja(e,l,c),v=d[0],m=d[1],f=d[2],y=d[3],C=d[4],A=d[5],E=Qa(e,A);l=C;var w=function(F,M){F?(n(),t(F,null)):(i[y]=M,--a||t(null,i))};if(!v)w(null,tt(e,E,E+m));else if(v==8){var b=e.subarray(E,E+m);if(m<32e4)try{w(null,Bt(b,new te(f)))}catch(F){w(F,null)}else r.push(ja(b,{size:f},w))}else w("unknown compression type "+v,null)},u=0;u<o;++u)h(u);return n}var Fn=ls(Nn()),Dn=class{constructor(){this._buffers={}}clear(){this._buffers={}}put(t,r){this._buffers[t]=r}get(t){return this._buffers[t]}keys(){return Object.keys(this._buffers)}},Bo="",Uo="",zo=5e3;function Pn(e){return this.test(e)}function Ho(e,t){console.error(e,t)}var ct=class extends HTMLElement{static createFileMatcher(t){if(typeof t=="string"){let r=(0,Fn.makeRe)(t),n=Pn.bind(r);return n.key=t,n}else if(t instanceof RegExp){let r=t,n=Pn.bind(r);return n.key=t.source,n}else throw new Error("Filter must be either a RegExp or glob string.")}static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=Bo,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Uo,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("asset-pack",ct)}static get observedAttributes(){return["src"]}set src(t){this.setAttribute("src",t)}get src(){return this._src}constructor(){super();let t=this.attachShadow({mode:"open"});t.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),t.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._src="",this._files=new Dn,this._cache={},this._loading={},this.onLoad=this.onLoad.bind(this),this.loaded=!1}get files(){return this._files}cacheAsset(t,r,n={}){let{ephemeral:i}=n,s=this._cache[t],a=this._loading[t];this._cache[t]=r,this.dispatchEvent(new CustomEvent("cache",{composed:!0,bubbles:!1,detail:{uri:t,current:r}})),a&&(a.resolve(r),delete this._loading[r]),i&&this._cache[r]===r&&(s?this._cache[r]=s:delete this._cache[r])}async loadAsset(t,r=zo){let n=this._cache[t];if(n)return n;if(t in this._loading)return this._loading[t].promise;{let i=new Bn(r);return this._loading[t]=i,i.promise}}clearAssets(){for(let t of Object.values(this._loading))t.reject(new Error("Stop loading to clear all assets."));this._loading={},this._cache={}}deleteAsset(t){t in this._loading&&(this._loading[t].reject(new Error("Stop loading to delete asset.")),delete this._loading[t]),t in this._cache&&delete this._cache[t]}getAsset(t){return this._cache[t]}getAssetURIs(){return Object.keys(this._cache)}hasAsset(t){let r=this._cache[t];return r?Boolean(r):!1}isAssetCached(t){return t in this._cache}isAssetLoading(t){return t in this._loading}connectedCallback(){ko(this,"src")}attributeChangedCallback(t,r,n){switch(t){case"src":this._src=n,n&&(this.loaded=!1,fetch(n).then(this.onLoad).catch(i=>Ho("Failed to load asset pack:",i)));break}}async onLoad(t){let r=await t.arrayBuffer();await new Promise((n,i)=>{tn(new Uint8Array(r),(s,a)=>{if(s)i(s);else{let o=this._files;Promise.all(Object.entries(a).map(([l,c])=>(o.put(l,c),this.cacheAsset(l,c)))).then(()=>n()).catch(i)}})}),this.dispatchEvent(new CustomEvent("load",{composed:!0})),this.loaded=!0}};ct.define();function ko(e,t){if(Object.prototype.hasOwnProperty.call(e,t)){let r=e[t];delete e[t],e[t]=r}}var Bn=class{constructor(t){this._resolve=null,this._reject=null,this._reason=null,this._value=null,this._timeoutHandle=t>0?setTimeout(()=>{this.reject(`Asset loading exceeded timeout of ${t} ms.`)},t):null,this._promise=new Promise((r,n)=>{this._value?r(this._value):this._resolve=r,this._reason?n(this._reason):this._reject=n})}get promise(){return this._promise}resolve(t){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._resolve?this._resolve(t):this._value=t}reject(t){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._reject?this._reject(t):this._reason=t}};window.addEventListener("error",ut,!0);window.addEventListener("unhandledrejection",ut,!0);function ut(e){typeof e=="object"?e instanceof PromiseRejectionEvent?ut(e.reason):e instanceof ErrorEvent?ut(e.error):e instanceof Error?window.alert(e.stack):window.alert(JSON.stringify(e)):window.alert(e)}function Jt(e){return typeof WebGL2RenderingContext!="undefined"&&e instanceof WebGL2RenderingContext}var er=class{constructor(t,r){this.gl=t,this.target=r}data(t,r=void 0){let n=this.gl,i=this.target;if(typeof t=="number")n.bufferData(i,t,r||n.STATIC_DRAW);else{if(!ArrayBuffer.isView(t))throw new Error("Source data must be a typed array.");n.bufferData(i,t,r||n.STATIC_DRAW)}return this}subData(t,r=0,n=void 0,i=void 0){let s=this.gl,a=this.target;if(!ArrayBuffer.isView(t))throw new Error("Source data must be a typed array.");if(n)if(Jt(s))s.bufferSubData(a,r,t,n,i);else{let o=i?t.subarray(n,n+i):t.subarray(n);s.bufferSubData(a,r,o)}else s.bufferSubData(a,r,t);return this}},Un=class{constructor(t,r,n=void 0){this.dataContext=new er(t,r),this.handle=n||t.createBuffer(),t.bindBuffer(r,this.handle)}get gl(){return this.dataContext.gl}get target(){return this.dataContext.target}data(t,r=void 0){return this.dataContext.data(t,r),this}subData(t,r=0,n=void 0,i=void 0){return this.dataContext.subData(t,r,n,i),this}build(){return this.handle}},zn=class{constructor(t,r,n,i){this.gl=t,this.target=r,this.handle=i,this.type=n,this.bindContext=new er(t,this.target)}bind(t){return t.bindBuffer(this.target,this.handle),this.bindContext.gl=t,this.bindContext}};function Ko(e,t,r){let n=Hn(e,t);return new n(r)}function Yo(e,t,r,n=void 0){let i=e.createBuffer();if(e.bindBuffer(t,i),!ArrayBuffer.isView(r))throw new Error("Source data must be a typed array.");return e.bufferData(t,r,n||e.STATIC_DRAW),i}function Hn(e,t){switch(t){case e.BYTE:return Int8Array;case e.UNSIGNED_BYTE:return Uint8Array;case e.SHORT:return Int16Array;case e.UNSIGNED_SHORT:return Uint16Array;case e.INT:return Int32Array;case e.UNSIGNED_INT:return Uint32Array;case e.FLOAT:return Float32Array;default:throw new Error("Cannot find valid typed array for buffer type.")}}function tr(e,t){switch(t){case Int8Array:return e.BYTE;case Uint8Array:return e.UNSIGNED_BYTE;case Int16Array:return e.SHORT;case Uint16Array:return e.UNSIGNED_SHORT;case Int32Array:return e.INT;case Uint32Array:return e.UNSIGNED_INT;case Float32Array:return e.FLOAT;default:throw new Error("Cannot find valid buffer type for typed array.")}}function $o(e,t,r){return e.bindBuffer(t,r),e.getBufferParameter(t,e.BUFFER_USAGE)}var Te=Object.freeze({__proto__:null,createBufferSource:Ko,createBuffer:Yo,getBufferTypedArray:Hn,getTypedArrayBufferType:tr,getBufferUsage:$o}),Ee=class{constructor(t,r,n=void 0){this.bufferBuilder=new Un(t,r,n),this.bufferType=t.FLOAT}get gl(){return this.bufferBuilder.gl}get handle(){return this.bufferBuilder.handle}get target(){return this.bufferBuilder.target}data(t,r=void 0){if(this.bufferBuilder.data(t,r),typeof t!="number"){let n=t.constructor;this.bufferType=tr(this.gl,n)}return this}subData(t,r=void 0,n=void 0,i=void 0){this.bufferBuilder.subData(t,r,n,i);let s=t.constructor;return this.bufferType=tr(this.gl,s),this}build(){let t=this.bufferBuilder.build(),r=this.gl,n=this.target,i=this.bufferType;return new zn(r,n,i,t)}};function Vo(e,t){switch(t){case e.FLOAT:return e.uniform1f;case e.FLOAT_VEC2:return e.uniform2fv;case e.FLOAT_VEC3:return e.uniform3fv;case e.FLOAT_VEC4:return e.uniform4fv;case e.INT:return e.uniform1i;case e.INT_VEC2:return e.uniform2iv;case e.INT_VEC3:return e.uniform3iv;case e.INT_VEC4:return e.uniform4iv;case e.BOOL:return e.uniform1i;case e.BOOL_VEC2:return e.uniform2iv;case e.BOOL_VEC3:return e.uniform3iv;case e.BOOL_VEC4:return e.uniform4iv;case e.FLOAT_MAT2:return kn;case e.FLOAT_MAT3:return Kn;case e.FLOAT_MAT4:return Yn;case e.SAMPLER_2D:case e.SAMPLER_CUBE:return e.uniform1i}if(Jt(e))switch(t){case e.UNSIGNED_INT:return e.uniform1ui;case e.UNSIGNED_INT_VEC2:return e.uniform2uiv;case e.UNSIGNED_INT_VEC3:return e.uniform3uiv;case e.UNSIGNED_INT_VEC4:return e.uniform4uiv;case e.FLOAT_MAT2x3:return $n;case e.FLOAT_MAT2x4:return Vn;case e.FLOAT_MAT3x2:return Gn;case e.FLOAT_MAT3x4:return jn;case e.FLOAT_MAT4x2:return qn;case e.FLOAT_MAT4x3:return Wn;case e.SAMPLER_3D:case e.SAMPLER_2D_SHADOW:case e.SAMPLER_2D_ARRAY:case e.SAMPLER_2D_ARRAY_SHADOW:case e.SAMPLER_CUBE_SHADOW:case e.INT_SAMPLER_2D:case e.INT_SAMPLER_3D:case e.INT_SAMPLER_CUBE:case e.INT_SAMPLER_2D_ARRAY:case e.UNSIGNED_INT_SAMPLER_2D:case e.UNSIGNED_INT_SAMPLER_3D:case e.UNSIGNED_INT_SAMPLER_CUBE:case e.UNSIGNED_INT_SAMPLER_2D_ARRAY:return e.uniform1i}throw new Error("Cannot find uniform function for gl enum.")}function Go(e,t){switch(t){case e.FLOAT:return e.uniform1fv;case e.FLOAT_VEC2:return e.uniform2fv;case e.FLOAT_VEC3:return e.uniform3fv;case e.FLOAT_VEC4:return e.uniform4fv;case e.INT:return e.uniform1iv;case e.INT_VEC2:return e.uniform2iv;case e.INT_VEC3:return e.uniform3iv;case e.INT_VEC4:return e.uniform4iv;case e.BOOL:return e.uniform1iv;case e.BOOL_VEC2:return e.uniform2iv;case e.BOOL_VEC3:return e.uniform3iv;case e.BOOL_VEC4:return e.uniform4iv;case e.FLOAT_MAT2:return kn;case e.FLOAT_MAT3:return Kn;case e.FLOAT_MAT4:return Yn;case e.SAMPLER_2D:case e.SAMPLER_CUBE:return e.uniform1iv}if(Jt(e))switch(t){case e.UNSIGNED_INT:return e.uniform1uiv;case e.UNSIGNED_INT_VEC2:return e.uniform2uiv;case e.UNSIGNED_INT_VEC3:return e.uniform3uiv;case e.UNSIGNED_INT_VEC4:return e.uniform4uiv;case e.FLOAT_MAT2x3:return $n;case e.FLOAT_MAT2x4:return Vn;case e.FLOAT_MAT3x2:return Gn;case e.FLOAT_MAT3x4:return jn;case e.FLOAT_MAT4x2:return qn;case e.FLOAT_MAT4x3:return Wn;case e.SAMPLER_3D:case e.SAMPLER_2D_SHADOW:case e.SAMPLER_2D_ARRAY:case e.SAMPLER_2D_ARRAY_SHADOW:case e.SAMPLER_CUBE_SHADOW:case e.INT_SAMPLER_2D:case e.INT_SAMPLER_3D:case e.INT_SAMPLER_CUBE:case e.INT_SAMPLER_2D_ARRAY:case e.UNSIGNED_INT_SAMPLER_2D:case e.UNSIGNED_INT_SAMPLER_3D:case e.UNSIGNED_INT_SAMPLER_CUBE:case e.UNSIGNED_INT_SAMPLER_2D_ARRAY:return e.uniform1iv}throw new Error("Cannot find array uniform function for gl enum.")}function kn(e,t){this.uniformMatrix2fv(e,!1,t)}function Kn(e,t){this.uniformMatrix3fv(e,!1,t)}function Yn(e,t){this.uniformMatrix4fv(e,!1,t)}function $n(e,t){this.uniformMatrix2x3fv(e,!1,t)}function Vn(e,t){this.uniformMatrix2x4fv(e,!1,t)}function Gn(e,t){this.uniformMatrix3x2fv(e,!1,t)}function jn(e,t){this.uniformMatrix3x4fv(e,!1,t)}function qn(e,t){this.uniformMatrix4x2fv(e,!1,t)}function Wn(e,t){this.uniformMatrix4x3fv(e,!1,t)}function jo(e,t){let r=[],n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;++i){let s=e.getActiveUniform(t,i);if(!s)break;r.push(s)}return r}function qo(e,t){let r=[],n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<n;++i){let s=e.getActiveAttrib(t,i);!s||r.push(s)}return r}function Wo(e,t){let r={},n=jo(e,t);for(let i of n){let s=i.name,a=i.size,o=i.type,l=e.getUniformLocation(t,s),c;a<=1?c=Vo(e,o):c=Go(e,o),r[s]={type:o,length:a,location:l,set:c}}return r}function Xo(e,t){switch(t){case e.FLOAT:return 1;case e.FLOAT_VEC2:return 2;case e.FLOAT_VEC3:return 3;case e.FLOAT_VEC4:return 4;case e.FLOAT_MAT2:return 4;case e.FLOAT_MAT3:return 9;case e.FLOAT_MAT4:return 16;default:throw new Error("Invalid vertex attribute type.")}}function Qo(e,t){let r={},n=qo(e,t);for(let i of n){let s=i.name,a=i.size,o=i.type,l=e.getAttribLocation(t,s),c=Xo(e,o);r[s]={type:o,length:a,location:l,size:c}}return r}function Zo(e,t,r){let n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)||(console.error(e.getShaderInfoLog(n)+`
Failed to compile shader:
${r}`),e.deleteShader(n)),n}function Jo(e,t,r){for(let i of r)e.attachShader(t,i);e.linkProgram(t);for(let i of r)e.detachShader(t,i),e.deleteShader(i);return e.getProgramParameter(t,e.LINK_STATUS)||(console.error(e.getProgramInfoLog(t)),e.deleteProgram(t)),t}function el(e,t,r,n,i=void 0){i?(e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,i),e.drawElements(t,n,e.UNSIGNED_SHORT,r)):e.drawArrays(t,r,n)}var Xn=class{constructor(t,r){this.handle=r,this.activeUniforms=Wo(t,r),this.activeAttributes=Qo(t,r),this.drawContext=new Qn(t,this)}bind(t){return t.useProgram(this.handle),this.drawContext.gl=t,this.drawContext}},Qn=class{constructor(t,r){this.gl=t,this.parent=r}uniform(t,r){let n=this.parent.activeUniforms;if(t in n){let i=n[t],s=i.location;i.set.call(this.gl,s,r)}return this}attribute(t,r,n,i=!1,s=0,a=0){let o=this.gl,l=this.parent.activeAttributes;if(t in l){let c=l[t],h=c.location,u=c.size;n?(o.bindBuffer(o.ARRAY_BUFFER,n),o.vertexAttribPointer(h,u,r,i,s,a),o.enableVertexAttribArray(h)):o.disableVertexAttribArray(h)}return this}draw(t,r,n,i,s=null){return el(t,r,n,i,s),this.parent}},Zn=class{constructor(t,r=void 0){this.handle=r||t.createProgram(),this.shaders=[],this.gl=t}shader(t,r){let n=this.gl,i=Zo(n,t,r);return this.shaders.push(i),this}link(){let t=this.gl;return Jo(t,this.handle,this.shaders),this.shaders.length=0,this.handle}},Le=class{constructor(t,r=void 0){this.programBuilder=new Zn(t,r)}get gl(){return this.programBuilder.gl}get handle(){return this.programBuilder.handle}get shaders(){return this.programBuilder.shaders}shader(t,r){return this.programBuilder.shader(t,r),this}link(){let t=this.programBuilder.link();return new Xn(this.gl,t)}};var H=1e-6,$=typeof Float32Array!="undefined"?Float32Array:Array,ie=Math.random;var ff=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});function Jn(){var e=new $(9);return $!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}var Y={};Ce(Y,{add:()=>Pl,adjoint:()=>ll,clone:()=>rl,copy:()=>nl,create:()=>tl,determinant:()=>hl,equals:()=>Hl,exactEquals:()=>zl,frob:()=>Dl,fromQuat:()=>Sl,fromQuat2:()=>Al,fromRotation:()=>_l,fromRotationTranslation:()=>ri,fromRotationTranslationScale:()=>Tl,fromRotationTranslationScaleOrigin:()=>bl,fromScaling:()=>xl,fromTranslation:()=>ml,fromValues:()=>il,fromXRotation:()=>gl,fromYRotation:()=>El,fromZRotation:()=>yl,frustum:()=>Rl,getRotation:()=>Ml,getScaling:()=>ni,getTranslation:()=>wl,identity:()=>ei,invert:()=>ol,lookAt:()=>Ol,mul:()=>kl,multiply:()=>ti,multiplyScalar:()=>Bl,multiplyScalarAndAdd:()=>Ul,ortho:()=>Il,perspective:()=>Ll,perspectiveFromFieldOfView:()=>Cl,rotate:()=>fl,rotateX:()=>pl,rotateY:()=>dl,rotateZ:()=>vl,scale:()=>ul,set:()=>sl,str:()=>Fl,sub:()=>Kl,subtract:()=>ii,targetTo:()=>Nl,translate:()=>cl,transpose:()=>al});function tl(){var e=new $(16);return $!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function rl(e){var t=new $(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function nl(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function il(e,t,r,n,i,s,a,o,l,c,h,u,p,d,v,m){var f=new $(16);return f[0]=e,f[1]=t,f[2]=r,f[3]=n,f[4]=i,f[5]=s,f[6]=a,f[7]=o,f[8]=l,f[9]=c,f[10]=h,f[11]=u,f[12]=p,f[13]=d,f[14]=v,f[15]=m,f}function sl(e,t,r,n,i,s,a,o,l,c,h,u,p,d,v,m,f){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=s,e[5]=a,e[6]=o,e[7]=l,e[8]=c,e[9]=h,e[10]=u,e[11]=p,e[12]=d,e[13]=v,e[14]=m,e[15]=f,e}function ei(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function al(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],s=t[6],a=t[7],o=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=s,e[11]=t[14],e[12]=i,e[13]=a,e[14]=o}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function ol(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8],u=t[9],p=t[10],d=t[11],v=t[12],m=t[13],f=t[14],y=t[15],C=r*o-n*a,A=r*l-i*a,E=r*c-s*a,w=n*l-i*o,b=n*c-s*o,F=i*c-s*l,M=h*m-u*v,O=h*f-p*v,B=h*y-d*v,g=u*f-p*m,D=u*y-d*m,N=p*y-d*f,P=C*N-A*D+E*g+w*B-b*O+F*M;return P?(P=1/P,e[0]=(o*N-l*D+c*g)*P,e[1]=(i*D-n*N-s*g)*P,e[2]=(m*F-f*b+y*w)*P,e[3]=(p*b-u*F-d*w)*P,e[4]=(l*B-a*N-c*O)*P,e[5]=(r*N-i*B+s*O)*P,e[6]=(f*E-v*F-y*A)*P,e[7]=(h*F-p*E+d*A)*P,e[8]=(a*D-o*B+c*M)*P,e[9]=(n*B-r*D-s*M)*P,e[10]=(v*b-m*E+y*C)*P,e[11]=(u*E-h*b-d*C)*P,e[12]=(o*O-a*g-l*M)*P,e[13]=(r*g-n*O+i*M)*P,e[14]=(m*A-v*w-f*C)*P,e[15]=(h*w-u*A+p*C)*P,e):null}function ll(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8],u=t[9],p=t[10],d=t[11],v=t[12],m=t[13],f=t[14],y=t[15];return e[0]=o*(p*y-d*f)-u*(l*y-c*f)+m*(l*d-c*p),e[1]=-(n*(p*y-d*f)-u*(i*y-s*f)+m*(i*d-s*p)),e[2]=n*(l*y-c*f)-o*(i*y-s*f)+m*(i*c-s*l),e[3]=-(n*(l*d-c*p)-o*(i*d-s*p)+u*(i*c-s*l)),e[4]=-(a*(p*y-d*f)-h*(l*y-c*f)+v*(l*d-c*p)),e[5]=r*(p*y-d*f)-h*(i*y-s*f)+v*(i*d-s*p),e[6]=-(r*(l*y-c*f)-a*(i*y-s*f)+v*(i*c-s*l)),e[7]=r*(l*d-c*p)-a*(i*d-s*p)+h*(i*c-s*l),e[8]=a*(u*y-d*m)-h*(o*y-c*m)+v*(o*d-c*u),e[9]=-(r*(u*y-d*m)-h*(n*y-s*m)+v*(n*d-s*u)),e[10]=r*(o*y-c*m)-a*(n*y-s*m)+v*(n*c-s*o),e[11]=-(r*(o*d-c*u)-a*(n*d-s*u)+h*(n*c-s*o)),e[12]=-(a*(u*f-p*m)-h*(o*f-l*m)+v*(o*p-l*u)),e[13]=r*(u*f-p*m)-h*(n*f-i*m)+v*(n*p-i*u),e[14]=-(r*(o*f-l*m)-a*(n*f-i*m)+v*(n*l-i*o)),e[15]=r*(o*p-l*u)-a*(n*p-i*u)+h*(n*l-i*o),e}function hl(e){var t=e[0],r=e[1],n=e[2],i=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],h=e[9],u=e[10],p=e[11],d=e[12],v=e[13],m=e[14],f=e[15],y=t*a-r*s,C=t*o-n*s,A=t*l-i*s,E=r*o-n*a,w=r*l-i*a,b=n*l-i*o,F=c*v-h*d,M=c*m-u*d,O=c*f-p*d,B=h*m-u*v,g=h*f-p*v,D=u*f-p*m;return y*D-C*g+A*B+E*O-w*M+b*F}function ti(e,t,r){var n=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],u=t[8],p=t[9],d=t[10],v=t[11],m=t[12],f=t[13],y=t[14],C=t[15],A=r[0],E=r[1],w=r[2],b=r[3];return e[0]=A*n+E*o+w*u+b*m,e[1]=A*i+E*l+w*p+b*f,e[2]=A*s+E*c+w*d+b*y,e[3]=A*a+E*h+w*v+b*C,A=r[4],E=r[5],w=r[6],b=r[7],e[4]=A*n+E*o+w*u+b*m,e[5]=A*i+E*l+w*p+b*f,e[6]=A*s+E*c+w*d+b*y,e[7]=A*a+E*h+w*v+b*C,A=r[8],E=r[9],w=r[10],b=r[11],e[8]=A*n+E*o+w*u+b*m,e[9]=A*i+E*l+w*p+b*f,e[10]=A*s+E*c+w*d+b*y,e[11]=A*a+E*h+w*v+b*C,A=r[12],E=r[13],w=r[14],b=r[15],e[12]=A*n+E*o+w*u+b*m,e[13]=A*i+E*l+w*p+b*f,e[14]=A*s+E*c+w*d+b*y,e[15]=A*a+E*h+w*v+b*C,e}function cl(e,t,r){var n=r[0],i=r[1],s=r[2],a,o,l,c,h,u,p,d,v,m,f,y;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*s+t[12],e[13]=t[1]*n+t[5]*i+t[9]*s+t[13],e[14]=t[2]*n+t[6]*i+t[10]*s+t[14],e[15]=t[3]*n+t[7]*i+t[11]*s+t[15]):(a=t[0],o=t[1],l=t[2],c=t[3],h=t[4],u=t[5],p=t[6],d=t[7],v=t[8],m=t[9],f=t[10],y=t[11],e[0]=a,e[1]=o,e[2]=l,e[3]=c,e[4]=h,e[5]=u,e[6]=p,e[7]=d,e[8]=v,e[9]=m,e[10]=f,e[11]=y,e[12]=a*n+h*i+v*s+t[12],e[13]=o*n+u*i+m*s+t[13],e[14]=l*n+p*i+f*s+t[14],e[15]=c*n+d*i+y*s+t[15]),e}function ul(e,t,r){var n=r[0],i=r[1],s=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function fl(e,t,r,n){var i=n[0],s=n[1],a=n[2],o=Math.hypot(i,s,a),l,c,h,u,p,d,v,m,f,y,C,A,E,w,b,F,M,O,B,g,D,N,P,x;return o<H?null:(o=1/o,i*=o,s*=o,a*=o,l=Math.sin(r),c=Math.cos(r),h=1-c,u=t[0],p=t[1],d=t[2],v=t[3],m=t[4],f=t[5],y=t[6],C=t[7],A=t[8],E=t[9],w=t[10],b=t[11],F=i*i*h+c,M=s*i*h+a*l,O=a*i*h-s*l,B=i*s*h-a*l,g=s*s*h+c,D=a*s*h+i*l,N=i*a*h+s*l,P=s*a*h-i*l,x=a*a*h+c,e[0]=u*F+m*M+A*O,e[1]=p*F+f*M+E*O,e[2]=d*F+y*M+w*O,e[3]=v*F+C*M+b*O,e[4]=u*B+m*g+A*D,e[5]=p*B+f*g+E*D,e[6]=d*B+y*g+w*D,e[7]=v*B+C*g+b*D,e[8]=u*N+m*P+A*x,e[9]=p*N+f*P+E*x,e[10]=d*N+y*P+w*x,e[11]=v*N+C*P+b*x,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function pl(e,t,r){var n=Math.sin(r),i=Math.cos(r),s=t[4],a=t[5],o=t[6],l=t[7],c=t[8],h=t[9],u=t[10],p=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*i+c*n,e[5]=a*i+h*n,e[6]=o*i+u*n,e[7]=l*i+p*n,e[8]=c*i-s*n,e[9]=h*i-a*n,e[10]=u*i-o*n,e[11]=p*i-l*n,e}function dl(e,t,r){var n=Math.sin(r),i=Math.cos(r),s=t[0],a=t[1],o=t[2],l=t[3],c=t[8],h=t[9],u=t[10],p=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i-c*n,e[1]=a*i-h*n,e[2]=o*i-u*n,e[3]=l*i-p*n,e[8]=s*n+c*i,e[9]=a*n+h*i,e[10]=o*n+u*i,e[11]=l*n+p*i,e}function vl(e,t,r){var n=Math.sin(r),i=Math.cos(r),s=t[0],a=t[1],o=t[2],l=t[3],c=t[4],h=t[5],u=t[6],p=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i+c*n,e[1]=a*i+h*n,e[2]=o*i+u*n,e[3]=l*i+p*n,e[4]=c*i-s*n,e[5]=h*i-a*n,e[6]=u*i-o*n,e[7]=p*i-l*n,e}function ml(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function xl(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function _l(e,t,r){var n=r[0],i=r[1],s=r[2],a=Math.hypot(n,i,s),o,l,c;return a<H?null:(a=1/a,n*=a,i*=a,s*=a,o=Math.sin(t),l=Math.cos(t),c=1-l,e[0]=n*n*c+l,e[1]=i*n*c+s*o,e[2]=s*n*c-i*o,e[3]=0,e[4]=n*i*c-s*o,e[5]=i*i*c+l,e[6]=s*i*c+n*o,e[7]=0,e[8]=n*s*c+i*o,e[9]=i*s*c-n*o,e[10]=s*s*c+l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function gl(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function El(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function yl(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ri(e,t,r){var n=t[0],i=t[1],s=t[2],a=t[3],o=n+n,l=i+i,c=s+s,h=n*o,u=n*l,p=n*c,d=i*l,v=i*c,m=s*c,f=a*o,y=a*l,C=a*c;return e[0]=1-(d+m),e[1]=u+C,e[2]=p-y,e[3]=0,e[4]=u-C,e[5]=1-(h+m),e[6]=v+f,e[7]=0,e[8]=p+y,e[9]=v-f,e[10]=1-(h+d),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function Al(e,t){var r=new $(3),n=-t[0],i=-t[1],s=-t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],u=n*n+i*i+s*s+a*a;return u>0?(r[0]=(o*a+h*n+l*s-c*i)*2/u,r[1]=(l*a+h*i+c*n-o*s)*2/u,r[2]=(c*a+h*s+o*i-l*n)*2/u):(r[0]=(o*a+h*n+l*s-c*i)*2,r[1]=(l*a+h*i+c*n-o*s)*2,r[2]=(c*a+h*s+o*i-l*n)*2),ri(e,t,r),e}function wl(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function ni(e,t){var r=t[0],n=t[1],i=t[2],s=t[4],a=t[5],o=t[6],l=t[8],c=t[9],h=t[10];return e[0]=Math.hypot(r,n,i),e[1]=Math.hypot(s,a,o),e[2]=Math.hypot(l,c,h),e}function Ml(e,t){var r=new $(3);ni(r,t);var n=1/r[0],i=1/r[1],s=1/r[2],a=t[0]*n,o=t[1]*i,l=t[2]*s,c=t[4]*n,h=t[5]*i,u=t[6]*s,p=t[8]*n,d=t[9]*i,v=t[10]*s,m=a+h+v,f=0;return m>0?(f=Math.sqrt(m+1)*2,e[3]=.25*f,e[0]=(u-d)/f,e[1]=(p-l)/f,e[2]=(o-c)/f):a>h&&a>v?(f=Math.sqrt(1+a-h-v)*2,e[3]=(u-d)/f,e[0]=.25*f,e[1]=(o+c)/f,e[2]=(p+l)/f):h>v?(f=Math.sqrt(1+h-a-v)*2,e[3]=(p-l)/f,e[0]=(o+c)/f,e[1]=.25*f,e[2]=(u+d)/f):(f=Math.sqrt(1+v-a-h)*2,e[3]=(o-c)/f,e[0]=(p+l)/f,e[1]=(u+d)/f,e[2]=.25*f),e}function Tl(e,t,r,n){var i=t[0],s=t[1],a=t[2],o=t[3],l=i+i,c=s+s,h=a+a,u=i*l,p=i*c,d=i*h,v=s*c,m=s*h,f=a*h,y=o*l,C=o*c,A=o*h,E=n[0],w=n[1],b=n[2];return e[0]=(1-(v+f))*E,e[1]=(p+A)*E,e[2]=(d-C)*E,e[3]=0,e[4]=(p-A)*w,e[5]=(1-(u+f))*w,e[6]=(m+y)*w,e[7]=0,e[8]=(d+C)*b,e[9]=(m-y)*b,e[10]=(1-(u+v))*b,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function bl(e,t,r,n,i){var s=t[0],a=t[1],o=t[2],l=t[3],c=s+s,h=a+a,u=o+o,p=s*c,d=s*h,v=s*u,m=a*h,f=a*u,y=o*u,C=l*c,A=l*h,E=l*u,w=n[0],b=n[1],F=n[2],M=i[0],O=i[1],B=i[2],g=(1-(m+y))*w,D=(d+E)*w,N=(v-A)*w,P=(d-E)*b,x=(1-(p+y))*b,_=(f+C)*b,j=(v+A)*F,k=(f-C)*F,Q=(1-(p+m))*F;return e[0]=g,e[1]=D,e[2]=N,e[3]=0,e[4]=P,e[5]=x,e[6]=_,e[7]=0,e[8]=j,e[9]=k,e[10]=Q,e[11]=0,e[12]=r[0]+M-(g*M+P*O+j*B),e[13]=r[1]+O-(D*M+x*O+k*B),e[14]=r[2]+B-(N*M+_*O+Q*B),e[15]=1,e}function Sl(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],a=r+r,o=n+n,l=i+i,c=r*a,h=n*a,u=n*o,p=i*a,d=i*o,v=i*l,m=s*a,f=s*o,y=s*l;return e[0]=1-u-v,e[1]=h+y,e[2]=p-f,e[3]=0,e[4]=h-y,e[5]=1-c-v,e[6]=d+m,e[7]=0,e[8]=p+f,e[9]=d-m,e[10]=1-c-u,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Rl(e,t,r,n,i,s,a){var o=1/(r-t),l=1/(i-n),c=1/(s-a);return e[0]=s*2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s*2*l,e[6]=0,e[7]=0,e[8]=(r+t)*o,e[9]=(i+n)*l,e[10]=(a+s)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*s*2*c,e[15]=0,e}function Ll(e,t,r,n,i){var s=1/Math.tan(t/2),a;return e[0]=s/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==Infinity?(a=1/(n-i),e[10]=(i+n)*a,e[14]=2*i*n*a):(e[10]=-1,e[14]=-2*n),e}function Cl(e,t,r,n){var i=Math.tan(t.upDegrees*Math.PI/180),s=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),o=Math.tan(t.rightDegrees*Math.PI/180),l=2/(a+o),c=2/(i+s);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-((a-o)*l*.5),e[9]=(i-s)*c*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e}function Il(e,t,r,n,i,s,a){var o=1/(t-r),l=1/(n-i),c=1/(s-a);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+r)*o,e[13]=(i+n)*l,e[14]=(a+s)*c,e[15]=1,e}function Ol(e,t,r,n){var i,s,a,o,l,c,h,u,p,d,v=t[0],m=t[1],f=t[2],y=n[0],C=n[1],A=n[2],E=r[0],w=r[1],b=r[2];return Math.abs(v-E)<H&&Math.abs(m-w)<H&&Math.abs(f-b)<H?ei(e):(h=v-E,u=m-w,p=f-b,d=1/Math.hypot(h,u,p),h*=d,u*=d,p*=d,i=C*p-A*u,s=A*h-y*p,a=y*u-C*h,d=Math.hypot(i,s,a),d?(d=1/d,i*=d,s*=d,a*=d):(i=0,s=0,a=0),o=u*a-p*s,l=p*i-h*a,c=h*s-u*i,d=Math.hypot(o,l,c),d?(d=1/d,o*=d,l*=d,c*=d):(o=0,l=0,c=0),e[0]=i,e[1]=o,e[2]=h,e[3]=0,e[4]=s,e[5]=l,e[6]=u,e[7]=0,e[8]=a,e[9]=c,e[10]=p,e[11]=0,e[12]=-(i*v+s*m+a*f),e[13]=-(o*v+l*m+c*f),e[14]=-(h*v+u*m+p*f),e[15]=1,e)}function Nl(e,t,r,n){var i=t[0],s=t[1],a=t[2],o=n[0],l=n[1],c=n[2],h=i-r[0],u=s-r[1],p=a-r[2],d=h*h+u*u+p*p;d>0&&(d=1/Math.sqrt(d),h*=d,u*=d,p*=d);var v=l*p-c*u,m=c*h-o*p,f=o*u-l*h;return d=v*v+m*m+f*f,d>0&&(d=1/Math.sqrt(d),v*=d,m*=d,f*=d),e[0]=v,e[1]=m,e[2]=f,e[3]=0,e[4]=u*f-p*m,e[5]=p*v-h*f,e[6]=h*m-u*v,e[7]=0,e[8]=h,e[9]=u,e[10]=p,e[11]=0,e[12]=i,e[13]=s,e[14]=a,e[15]=1,e}function Fl(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function Dl(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function Pl(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function ii(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function Bl(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function Ul(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e}function zl(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Hl(e,t){var r=e[0],n=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],h=e[8],u=e[9],p=e[10],d=e[11],v=e[12],m=e[13],f=e[14],y=e[15],C=t[0],A=t[1],E=t[2],w=t[3],b=t[4],F=t[5],M=t[6],O=t[7],B=t[8],g=t[9],D=t[10],N=t[11],P=t[12],x=t[13],_=t[14],j=t[15];return Math.abs(r-C)<=H*Math.max(1,Math.abs(r),Math.abs(C))&&Math.abs(n-A)<=H*Math.max(1,Math.abs(n),Math.abs(A))&&Math.abs(i-E)<=H*Math.max(1,Math.abs(i),Math.abs(E))&&Math.abs(s-w)<=H*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(a-b)<=H*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(o-F)<=H*Math.max(1,Math.abs(o),Math.abs(F))&&Math.abs(l-M)<=H*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(c-O)<=H*Math.max(1,Math.abs(c),Math.abs(O))&&Math.abs(h-B)<=H*Math.max(1,Math.abs(h),Math.abs(B))&&Math.abs(u-g)<=H*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(p-D)<=H*Math.max(1,Math.abs(p),Math.abs(D))&&Math.abs(d-N)<=H*Math.max(1,Math.abs(d),Math.abs(N))&&Math.abs(v-P)<=H*Math.max(1,Math.abs(v),Math.abs(P))&&Math.abs(m-x)<=H*Math.max(1,Math.abs(m),Math.abs(x))&&Math.abs(f-_)<=H*Math.max(1,Math.abs(f),Math.abs(_))&&Math.abs(y-j)<=H*Math.max(1,Math.abs(y),Math.abs(j))}var kl=ti,Kl=ii;var J={};Ce(J,{add:()=>hc,calculateW:()=>Zh,clone:()=>sc,conjugate:()=>rc,copy:()=>oc,create:()=>vr,dot:()=>gi,equals:()=>vc,exactEquals:()=>dc,exp:()=>yi,fromEuler:()=>nc,fromMat3:()=>Mi,fromValues:()=>ac,getAngle:()=>qh,getAxisAngle:()=>jh,identity:()=>Gh,invert:()=>tc,len:()=>fc,length:()=>Ti,lerp:()=>uc,ln:()=>Ai,mul:()=>cc,multiply:()=>Ei,normalize:()=>mr,pow:()=>Jh,random:()=>ec,rotateX:()=>Wh,rotateY:()=>Xh,rotateZ:()=>Qh,rotationTo:()=>mc,scale:()=>wi,set:()=>lc,setAxes:()=>_c,setAxisAngle:()=>_i,slerp:()=>xt,sqlerp:()=>xc,sqrLen:()=>pc,squaredLength:()=>bi,str:()=>ic});var K={};Ce(K,{add:()=>Gl,angle:()=>fh,bezier:()=>ih,ceil:()=>jl,clone:()=>Yl,copy:()=>$l,create:()=>ft,cross:()=>Ge,dist:()=>Eh,distance:()=>hi,div:()=>gh,divide:()=>li,dot:()=>dt,equals:()=>mh,exactEquals:()=>vh,floor:()=>ql,forEach:()=>wh,fromValues:()=>pt,hermite:()=>nh,inverse:()=>th,len:()=>nr,length:()=>si,lerp:()=>rh,max:()=>Xl,min:()=>Wl,mul:()=>_h,multiply:()=>oi,negate:()=>eh,normalize:()=>rr,random:()=>sh,rotateX:()=>hh,rotateY:()=>ch,rotateZ:()=>uh,round:()=>Ql,scale:()=>Zl,scaleAndAdd:()=>Jl,set:()=>Vl,sqrDist:()=>yh,sqrLen:()=>Ah,squaredDistance:()=>ci,squaredLength:()=>ui,str:()=>dh,sub:()=>xh,subtract:()=>ai,transformMat3:()=>oh,transformMat4:()=>ah,transformQuat:()=>lh,zero:()=>ph});function ft(){var e=new $(3);return $!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Yl(e){var t=new $(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function si(e){var t=e[0],r=e[1],n=e[2];return Math.hypot(t,r,n)}function pt(e,t,r){var n=new $(3);return n[0]=e,n[1]=t,n[2]=r,n}function $l(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Vl(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e}function Gl(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function ai(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function oi(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function li(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function jl(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function ql(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function Wl(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e}function Xl(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e}function Ql(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function Zl(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function Jl(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e}function hi(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.hypot(r,n,i)}function ci(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return r*r+n*n+i*i}function ui(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}function eh(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function th(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function rr(e,t){var r=t[0],n=t[1],i=t[2],s=r*r+n*n+i*i;return s>0&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e}function dt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Ge(e,t,r){var n=t[0],i=t[1],s=t[2],a=r[0],o=r[1],l=r[2];return e[0]=i*l-s*o,e[1]=s*a-n*l,e[2]=n*o-i*a,e}function rh(e,t,r,n){var i=t[0],s=t[1],a=t[2];return e[0]=i+n*(r[0]-i),e[1]=s+n*(r[1]-s),e[2]=a+n*(r[2]-a),e}function nh(e,t,r,n,i,s){var a=s*s,o=a*(2*s-3)+1,l=a*(s-2)+s,c=a*(s-1),h=a*(3-2*s);return e[0]=t[0]*o+r[0]*l+n[0]*c+i[0]*h,e[1]=t[1]*o+r[1]*l+n[1]*c+i[1]*h,e[2]=t[2]*o+r[2]*l+n[2]*c+i[2]*h,e}function ih(e,t,r,n,i,s){var a=1-s,o=a*a,l=s*s,c=o*a,h=3*s*o,u=3*l*a,p=l*s;return e[0]=t[0]*c+r[0]*h+n[0]*u+i[0]*p,e[1]=t[1]*c+r[1]*h+n[1]*u+i[1]*p,e[2]=t[2]*c+r[2]*h+n[2]*u+i[2]*p,e}function sh(e,t){t=t||1;var r=ie()*2*Math.PI,n=ie()*2-1,i=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*i,e[1]=Math.sin(r)*i,e[2]=n*t,e}function ah(e,t,r){var n=t[0],i=t[1],s=t[2],a=r[3]*n+r[7]*i+r[11]*s+r[15];return a=a||1,e[0]=(r[0]*n+r[4]*i+r[8]*s+r[12])/a,e[1]=(r[1]*n+r[5]*i+r[9]*s+r[13])/a,e[2]=(r[2]*n+r[6]*i+r[10]*s+r[14])/a,e}function oh(e,t,r){var n=t[0],i=t[1],s=t[2];return e[0]=n*r[0]+i*r[3]+s*r[6],e[1]=n*r[1]+i*r[4]+s*r[7],e[2]=n*r[2]+i*r[5]+s*r[8],e}function lh(e,t,r){var n=r[0],i=r[1],s=r[2],a=r[3],o=t[0],l=t[1],c=t[2],h=i*c-s*l,u=s*o-n*c,p=n*l-i*o,d=i*p-s*u,v=s*h-n*p,m=n*u-i*h,f=a*2;return h*=f,u*=f,p*=f,d*=2,v*=2,m*=2,e[0]=o+h+d,e[1]=l+u+v,e[2]=c+p+m,e}function hh(e,t,r,n){var i=[],s=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],s[0]=i[0],s[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),s[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function ch(e,t,r,n){var i=[],s=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],s[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),s[1]=i[1],s[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function uh(e,t,r,n){var i=[],s=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],s[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),s[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),s[2]=i[2],e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function fh(e,t){var r=e[0],n=e[1],i=e[2],s=t[0],a=t[1],o=t[2],l=Math.sqrt(r*r+n*n+i*i),c=Math.sqrt(s*s+a*a+o*o),h=l*c,u=h&&dt(e,t)/h;return Math.acos(Math.min(Math.max(u,-1),1))}function ph(e){return e[0]=0,e[1]=0,e[2]=0,e}function dh(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function vh(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function mh(e,t){var r=e[0],n=e[1],i=e[2],s=t[0],a=t[1],o=t[2];return Math.abs(r-s)<=H*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-a)<=H*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-o)<=H*Math.max(1,Math.abs(i),Math.abs(o))}var xh=ai,_h=oi,gh=li,Eh=hi,yh=ci,nr=si,Ah=ui,wh=function(){var e=ft();return function(t,r,n,i,s,a){var o,l;for(r||(r=3),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,o=n;o<l;o+=r)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],s(e,e,a),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2];return t}}();var xe={};Ce(xe,{add:()=>lr,ceil:()=>Mh,clone:()=>ir,copy:()=>ar,create:()=>fi,cross:()=>Oh,dist:()=>kh,distance:()=>mi,div:()=>Hh,divide:()=>vi,dot:()=>ur,equals:()=>dr,exactEquals:()=>pr,floor:()=>Th,forEach:()=>Vh,fromValues:()=>sr,inverse:()=>Ih,len:()=>Yh,length:()=>vt,lerp:()=>fr,max:()=>Sh,min:()=>bh,mul:()=>zh,multiply:()=>di,negate:()=>Ch,normalize:()=>cr,random:()=>Nh,round:()=>Rh,scale:()=>hr,scaleAndAdd:()=>Lh,set:()=>or,sqrDist:()=>Kh,sqrLen:()=>$h,squaredDistance:()=>xi,squaredLength:()=>mt,str:()=>Bh,sub:()=>Uh,subtract:()=>pi,transformMat4:()=>Fh,transformQuat:()=>Dh,zero:()=>Ph});function fi(){var e=new $(4);return $!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function ir(e){var t=new $(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function sr(e,t,r,n){var i=new $(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function ar(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function or(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}function lr(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function pi(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function di(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function vi(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function Mh(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function Th(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function bh(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e}function Sh(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e}function Rh(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function hr(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function Lh(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e}function mi(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],s=t[3]-e[3];return Math.hypot(r,n,i,s)}function xi(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],s=t[3]-e[3];return r*r+n*n+i*i+s*s}function vt(e){var t=e[0],r=e[1],n=e[2],i=e[3];return Math.hypot(t,r,n,i)}function mt(e){var t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}function Ch(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function Ih(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function cr(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],a=r*r+n*n+i*i+s*s;return a>0&&(a=1/Math.sqrt(a)),e[0]=r*a,e[1]=n*a,e[2]=i*a,e[3]=s*a,e}function ur(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Oh(e,t,r,n){var i=r[0]*n[1]-r[1]*n[0],s=r[0]*n[2]-r[2]*n[0],a=r[0]*n[3]-r[3]*n[0],o=r[1]*n[2]-r[2]*n[1],l=r[1]*n[3]-r[3]*n[1],c=r[2]*n[3]-r[3]*n[2],h=t[0],u=t[1],p=t[2],d=t[3];return e[0]=u*c-p*l+d*o,e[1]=-(h*c)+p*a-d*s,e[2]=h*l-u*a+d*i,e[3]=-(h*o)+u*s-p*i,e}function fr(e,t,r,n){var i=t[0],s=t[1],a=t[2],o=t[3];return e[0]=i+n*(r[0]-i),e[1]=s+n*(r[1]-s),e[2]=a+n*(r[2]-a),e[3]=o+n*(r[3]-o),e}function Nh(e,t){t=t||1;var r,n,i,s,a,o;do r=ie()*2-1,n=ie()*2-1,a=r*r+n*n;while(a>=1);do i=ie()*2-1,s=ie()*2-1,o=i*i+s*s;while(o>=1);var l=Math.sqrt((1-a)/o);return e[0]=t*r,e[1]=t*n,e[2]=t*i*l,e[3]=t*s*l,e}function Fh(e,t,r){var n=t[0],i=t[1],s=t[2],a=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*s+r[12]*a,e[1]=r[1]*n+r[5]*i+r[9]*s+r[13]*a,e[2]=r[2]*n+r[6]*i+r[10]*s+r[14]*a,e[3]=r[3]*n+r[7]*i+r[11]*s+r[15]*a,e}function Dh(e,t,r){var n=t[0],i=t[1],s=t[2],a=r[0],o=r[1],l=r[2],c=r[3],h=c*n+o*s-l*i,u=c*i+l*n-a*s,p=c*s+a*i-o*n,d=-a*n-o*i-l*s;return e[0]=h*c+d*-a+u*-l-p*-o,e[1]=u*c+d*-o+p*-a-h*-l,e[2]=p*c+d*-l+h*-o-u*-a,e[3]=t[3],e}function Ph(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function Bh(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function pr(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function dr(e,t){var r=e[0],n=e[1],i=e[2],s=e[3],a=t[0],o=t[1],l=t[2],c=t[3];return Math.abs(r-a)<=H*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-o)<=H*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-l)<=H*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(s-c)<=H*Math.max(1,Math.abs(s),Math.abs(c))}var Uh=pi,zh=di,Hh=vi,kh=mi,Kh=xi,Yh=vt,$h=mt,Vh=function(){var e=fi();return function(t,r,n,i,s,a){var o,l;for(r||(r=4),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,o=n;o<l;o+=r)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],e[3]=t[o+3],s(e,e,a),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2],t[o+3]=e[3];return t}}();function vr(){var e=new $(4);return $!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Gh(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function _i(e,t,r){r=r*.5;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function jh(e,t){var r=Math.acos(t[3])*2,n=Math.sin(r/2);return n>H?(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n):(e[0]=1,e[1]=0,e[2]=0),r}function qh(e,t){var r=gi(e,t);return Math.acos(2*r*r-1)}function Ei(e,t,r){var n=t[0],i=t[1],s=t[2],a=t[3],o=r[0],l=r[1],c=r[2],h=r[3];return e[0]=n*h+a*o+i*c-s*l,e[1]=i*h+a*l+s*o-n*c,e[2]=s*h+a*c+n*l-i*o,e[3]=a*h-n*o-i*l-s*c,e}function Wh(e,t,r){r*=.5;var n=t[0],i=t[1],s=t[2],a=t[3],o=Math.sin(r),l=Math.cos(r);return e[0]=n*l+a*o,e[1]=i*l+s*o,e[2]=s*l-i*o,e[3]=a*l-n*o,e}function Xh(e,t,r){r*=.5;var n=t[0],i=t[1],s=t[2],a=t[3],o=Math.sin(r),l=Math.cos(r);return e[0]=n*l-s*o,e[1]=i*l+a*o,e[2]=s*l+n*o,e[3]=a*l-i*o,e}function Qh(e,t,r){r*=.5;var n=t[0],i=t[1],s=t[2],a=t[3],o=Math.sin(r),l=Math.cos(r);return e[0]=n*l+i*o,e[1]=i*l-n*o,e[2]=s*l+a*o,e[3]=a*l-s*o,e}function Zh(e,t){var r=t[0],n=t[1],i=t[2];return e[0]=r,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),e}function yi(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],a=Math.sqrt(r*r+n*n+i*i),o=Math.exp(s),l=a>0?o*Math.sin(a)/a:0;return e[0]=r*l,e[1]=n*l,e[2]=i*l,e[3]=o*Math.cos(a),e}function Ai(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],a=Math.sqrt(r*r+n*n+i*i),o=a>0?Math.atan2(a,s)/a:0;return e[0]=r*o,e[1]=n*o,e[2]=i*o,e[3]=.5*Math.log(r*r+n*n+i*i+s*s),e}function Jh(e,t,r){return Ai(e,t),wi(e,e,r),yi(e,e),e}function xt(e,t,r,n){var i=t[0],s=t[1],a=t[2],o=t[3],l=r[0],c=r[1],h=r[2],u=r[3],p,d,v,m,f;return d=i*l+s*c+a*h+o*u,d<0&&(d=-d,l=-l,c=-c,h=-h,u=-u),1-d>H?(p=Math.acos(d),v=Math.sin(p),m=Math.sin((1-n)*p)/v,f=Math.sin(n*p)/v):(m=1-n,f=n),e[0]=m*i+f*l,e[1]=m*s+f*c,e[2]=m*a+f*h,e[3]=m*o+f*u,e}function ec(e){var t=ie(),r=ie(),n=ie(),i=Math.sqrt(1-t),s=Math.sqrt(t);return e[0]=i*Math.sin(2*Math.PI*r),e[1]=i*Math.cos(2*Math.PI*r),e[2]=s*Math.sin(2*Math.PI*n),e[3]=s*Math.cos(2*Math.PI*n),e}function tc(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],a=r*r+n*n+i*i+s*s,o=a?1/a:0;return e[0]=-r*o,e[1]=-n*o,e[2]=-i*o,e[3]=s*o,e}function rc(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function Mi(e,t){var r=t[0]+t[4]+t[8],n;if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);var s=(i+1)%3,a=(i+2)%3;n=Math.sqrt(t[i*3+i]-t[s*3+s]-t[a*3+a]+1),e[i]=.5*n,n=.5/n,e[3]=(t[s*3+a]-t[a*3+s])*n,e[s]=(t[s*3+i]+t[i*3+s])*n,e[a]=(t[a*3+i]+t[i*3+a])*n}return e}function nc(e,t,r,n){var i=.5*Math.PI/180;t*=i,r*=i,n*=i;var s=Math.sin(t),a=Math.cos(t),o=Math.sin(r),l=Math.cos(r),c=Math.sin(n),h=Math.cos(n);return e[0]=s*l*h-a*o*c,e[1]=a*o*h+s*l*c,e[2]=a*l*c-s*o*h,e[3]=a*l*h+s*o*c,e}function ic(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var sc=ir,ac=sr,oc=ar,lc=or,hc=lr,cc=Ei,wi=hr,gi=ur,uc=fr,Ti=vt,fc=Ti,bi=mt,pc=bi,mr=cr,dc=pr,vc=dr,mc=function(){var e=ft(),t=pt(1,0,0),r=pt(0,1,0);return function(n,i,s){var a=dt(i,s);return a<-.999999?(Ge(e,t,i),nr(e)<1e-6&&Ge(e,r,i),rr(e,e),_i(n,e,Math.PI),n):a>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(Ge(e,i,s),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+a,mr(n,n))}}(),xc=function(){var e=vr(),t=vr();return function(r,n,i,s,a,o){return xt(e,n,a,o),xt(t,i,s,o),xt(r,e,t,2*o*(1-o)),r}}(),_c=function(){var e=Jn();return function(t,r,n,i){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],mr(t,Mi(t,e))}}();var Fe={};Ce(Fe,{add:()=>wc,angle:()=>Yc,ceil:()=>Mc,clone:()=>gc,copy:()=>yc,create:()=>Si,cross:()=>Dc,dist:()=>Zc,distance:()=>Ii,div:()=>Qc,divide:()=>Ci,dot:()=>Fc,equals:()=>jc,exactEquals:()=>Gc,floor:()=>Tc,forEach:()=>tu,fromValues:()=>Ec,inverse:()=>Oc,len:()=>qc,length:()=>Ni,lerp:()=>Pc,max:()=>Sc,min:()=>bc,mul:()=>Xc,multiply:()=>Li,negate:()=>Ic,normalize:()=>Nc,random:()=>Bc,rotate:()=>Kc,round:()=>Rc,scale:()=>Lc,scaleAndAdd:()=>Cc,set:()=>Ac,sqrDist:()=>Jc,sqrLen:()=>eu,squaredDistance:()=>Oi,squaredLength:()=>Fi,str:()=>Vc,sub:()=>Wc,subtract:()=>Ri,transformMat2:()=>Uc,transformMat2d:()=>zc,transformMat3:()=>Hc,transformMat4:()=>kc,zero:()=>$c});function Si(){var e=new $(2);return $!=Float32Array&&(e[0]=0,e[1]=0),e}function gc(e){var t=new $(2);return t[0]=e[0],t[1]=e[1],t}function Ec(e,t){var r=new $(2);return r[0]=e,r[1]=t,r}function yc(e,t){return e[0]=t[0],e[1]=t[1],e}function Ac(e,t,r){return e[0]=t,e[1]=r,e}function wc(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function Ri(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function Li(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function Ci(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function Mc(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function Tc(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function bc(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}function Sc(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}function Rc(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function Lc(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function Cc(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e}function Ii(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.hypot(r,n)}function Oi(e,t){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function Ni(e){var t=e[0],r=e[1];return Math.hypot(t,r)}function Fi(e){var t=e[0],r=e[1];return t*t+r*r}function Ic(e,t){return e[0]=-t[0],e[1]=-t[1],e}function Oc(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function Nc(e,t){var r=t[0],n=t[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e}function Fc(e,t){return e[0]*t[0]+e[1]*t[1]}function Dc(e,t,r){var n=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=n,e}function Pc(e,t,r,n){var i=t[0],s=t[1];return e[0]=i+n*(r[0]-i),e[1]=s+n*(r[1]-s),e}function Bc(e,t){t=t||1;var r=ie()*2*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e}function Uc(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e}function zc(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e}function Hc(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e}function kc(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e}function Kc(e,t,r,n){var i=t[0]-r[0],s=t[1]-r[1],a=Math.sin(n),o=Math.cos(n);return e[0]=i*o-s*a+r[0],e[1]=i*a+s*o+r[1],e}function Yc(e,t){var r=e[0],n=e[1],i=t[0],s=t[1],a=Math.sqrt(r*r+n*n)*Math.sqrt(i*i+s*s),o=a&&(r*i+n*s)/a;return Math.acos(Math.min(Math.max(o,-1),1))}function $c(e){return e[0]=0,e[1]=0,e}function Vc(e){return"vec2("+e[0]+", "+e[1]+")"}function Gc(e,t){return e[0]===t[0]&&e[1]===t[1]}function jc(e,t){var r=e[0],n=e[1],i=t[0],s=t[1];return Math.abs(r-i)<=H*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-s)<=H*Math.max(1,Math.abs(n),Math.abs(s))}var qc=Ni,Wc=Ri,Xc=Li,Qc=Ci,Zc=Ii,Jc=Oi,eu=Fi,tu=function(){var e=Si();return function(t,r,n,i,s,a){var o,l;for(r||(r=2),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,o=n;o<l;o+=r)e[0]=t[o],e[1]=t[o+1],s(e,e,a),t[o]=e[0],t[o+1]=e[1];return t}}();var ae={red(e){return e>>16&255},redf(e){return(e>>16&255)/255},green(e){return e>>8&255},greenf(e){return(e>>8&255)/255},blue(e){return e&255},bluef(e){return(e&255)/255},alpha(e){return e>>24&255},alphaf(e){return(e>>24&255)/255},hexf(e,t,r,n=1){let i=Math.floor(Math.max(Math.min(e,1),0)*255),s=Math.floor(Math.max(Math.min(t,1),0)*255),a=Math.floor(Math.max(Math.min(r,1),0)*255);return(Math.floor(Math.max(Math.min(n,1),0)*255)&255)<<24|(i&255)<<16|(s&255)<<8|a&255},mix(e=0,t=16777215,r=.5){if(t<e){let u=e;e=t,t=u}let n=this.redf(e),i=this.greenf(e),s=this.bluef(e),a=this.alphaf(e),o=(this.redf(t)-n)*r+n,l=(this.greenf(t)-i)*r+i,c=(this.bluef(t)-s)*r+s,h=(this.alphaf(t)-a)*r+a;return h<.01&&(h=void 0),this.hexf(o,l,c,h)}};var Sf=K.fromValues(0,1,0);var Di=class{constructor(t,r){this.projectionMatrix=t,this.viewMatrix=r}resize(t=void 0,r=void 0){return this}},Rf=Math.PI/3;var xr=class extends Di{constructor(t=void 0,r=void 0,n=void 0,i=void 0,s=-1e3,a=1e3){super(Y.create(),Y.create());this.orthoBounds={left:typeof t=="undefined"?void 0:Number(t),top:typeof r=="undefined"?void 0:Number(r),right:typeof n=="undefined"?void 0:Number(n),bottom:typeof i=="undefined"?void 0:Number(i)},this.clippingPlane={near:Number(s),far:Number(a)}}resize(t=void 0,r=void 0){let{near:n,far:i}=this.clippingPlane,{left:s,top:a,right:o,bottom:l}=this.orthoBounds,c=this.projectionMatrix,h=typeof t!="undefined",u=typeof s!="undefined";if(h)if(u){let p=t/r;Y.ortho(c,s*p,o*p,l,a,n,i)}else Y.ortho(c,0,t,r,0,n,i);else u?Y.ortho(c,s,o,l,a,n,i):Y.ortho(c,-1,1,1,-1,-1,1);return this}},Lf=Math.PI/180;var _r=class{constructor(t,r=t.canvas,n=new xr){this.gl=t,this.canvas=r,this.camera=n,this.projectionViewMatrix=Y.create(),this.modelMatrix=Y.create(),this.colorVector=K.create(),this.depthFloat=0,this.opacityFloat=1,this.transformStack=[],this.transformMatrix=Y.create(),this.translationVector=K.create(),this.rotationQuat=J.create(),this.scaleVector=K.fromValues(1,1,1),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA)}reset(){this.resize(),this.clear(0,0,0,1),this.setColorVector(1,1,1),this.setDepthFloat(0),this.setOpacityFloat(1),this.resetTransform(),this.transformStack.length=0}resize(){let t=this.gl,r=t.canvas.width,n=t.canvas.height;t.viewport(0,0,r,n);let i=this.camera;i.resize(r,n);let s=this.projectionViewMatrix;Y.mul(s,i.projectionMatrix,i.viewMatrix)}clear(t,r,n,i=1){let s=this.gl;s.clearColor(t,r,n,i),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT)}setColorVector(t,r,n){return K.set(this.colorVector,t,r,n),this}setColor(t){return this.setColorVector(ae.redf(t),ae.greenf(t),ae.bluef(t))}setDepthFloat(t){return this.depthFloat=t,this}setOpacityFloat(t){return this.opacityFloat=t,this}setTranslation(t,r,n=0){return K.set(this.translationVector,t,r,n),this}setRotation(t,r,n){return J.fromEuler(this.rotationQuat,t,r,n),this}setScale(t,r){return K.set(this.scaleVector,t,r,1),this}resetTransform(){K.zero(this.translationVector),J.identity(this.rotationQuat),K.set(this.scaleVector,1,1,1)}pushTransform(){let t=Y.fromRotationTranslationScale(Y.create(),this.rotationQuat,this.translationVector,this.scaleVector);this.transformStack.push(t),this.resetTransform()}popTransform(){let t=this.transformStack.pop();Y.getRotation(this.rotationQuat,t),Y.getTranslation(this.translationVector,t),Y.getScaling(this.scaleVector,t)}applyTransform(t){for(let r=this.transformStack.length-1;r>=0;--r)Y.mul(t,this.transformStack[r],t);return Y.mul(t,Y.fromRotationTranslationScale(this.transformMatrix,this.rotationQuat,this.translationVector,this.scaleVector),t),t}};var ru=`
attribute vec2 a_position;

uniform mat4 u_projection_view;
uniform mat4 u_model;

void main() {
    gl_Position = u_projection_view * u_model * vec4(a_position.xy, 0.0, 1.0);
}`,nu=`
precision mediump float;

uniform vec3 u_color;
uniform float u_opacity_inv;

void main() {
    gl_FragColor = vec4(u_color.rgb, 1.0 - u_opacity_inv);
}`,Pi=16,Bi=(()=>{let e=[],t=Pi,r=Math.PI*2/t,n=1,i=0,s,a;for(let o=0;o<=t;++o)s=Math.cos(o*r),a=Math.sin(o*r),e.push(0,0),e.push(n,i),e.push(s,a),n=s,i=a;return e})(),iu=Math.trunc(Bi.length/2),Ui=(()=>{let e=[],t=Pi,r=Math.PI*2/t,n=1,i=0,s,a;for(let o=0;o<=t;++o)s=Math.cos(o*r),a=Math.sin(o*r),e.push(n,i),e.push(s,a),n=s,i=a;return e})(),su=Math.trunc(Ui.length/2),_t=[0,0,1,0,0,1,1,1,1,0,0,1],au=[0,0,1,1],gr=class extends _r{constructor(t,r=void 0,n=void 0){super(t,r,n);this.shapeProgram=new Le(t).shader(t.VERTEX_SHADER,ru).shader(t.FRAGMENT_SHADER,nu).link(),this.meshQuad=new Ee(t,t.ARRAY_BUFFER).data(Te.createBufferSource(t,t.FLOAT,_t)).build(),this.meshLine=new Ee(t,t.ARRAY_BUFFER).data(Te.createBufferSource(t,t.FLOAT,au)).build(),this.meshCircle=new Ee(t,t.ARRAY_BUFFER).data(Te.createBufferSource(t,t.FLOAT,Bi)).build(),this.meshLineCircle=new Ee(t,t.ARRAY_BUFFER).data(Te.createBufferSource(t,t.FLOAT,Ui)).build()}resize(){super.resize(),this.shapeProgram.bind(this.gl).uniform("u_projection_view",this.projectionViewMatrix)}setColorVector(t,r,n){return super.setColorVector(t,r,n),this.shapeProgram.bind(this.gl).uniform("u_color",this.colorVector),this}setOpacityFloat(t){return super.setOpacityFloat(t),this.shapeProgram.bind(this.gl).uniform("u_opacity_inv",1-this.opacityFloat),this}drawLine(t=0,r=0,n=t+16,i=r){let s=this.gl,a=this.depthFloat,o=n-t,l=i-r,c=this.modelMatrix;return Y.fromRotationTranslationScale(c,J.create(),K.fromValues(t,r,a),K.fromValues(o,l,1)),this.applyTransform(c),this.shapeProgram.bind(s).attribute("a_position",s.FLOAT,this.meshLine.handle).uniform("u_model",c).draw(s,s.LINES,0,2),this}drawRay(t=0,r=0,n=0,i=16){let s=Math.PI*n/180;return this.drawLine(t,r,t+Math.cos(s)*i,r+Math.sin(s)*i)}drawBox(t=0,r=0,n=8,i=n){return this.drawBoxImpl(this.gl.TRIANGLES,t,r,this.depthFloat,n,i)}drawLineBox(t=0,r=0,n=8,i=n){return this.drawBoxImpl(this.gl.LINE_LOOP,t,r,this.depthFloat,n,i)}drawRect(t=0,r=0,n=16,i=16){let s=(n-t)/2,a=(i-r)/2;return this.drawBox(t+s,r+a,s,a)}drawLineRect(t=0,r=0,n=16,i=16){let s=(n-t)/2,a=(i-r)/2;return this.drawLineBox(t+s,r+a,s,a)}drawCircle(t=0,r=0,n=8){return this.drawCircleImpl(this.meshCircle,iu,this.gl.TRIANGLES,t,r,this.depthFloat,n)}drawLineCircle(t=0,r=0,n=8){return this.drawCircleImpl(this.meshLineCircle,su,this.gl.LINE_LOOP,t,r,this.depthFloat,n)}drawBoxImpl(t,r,n,i,s,a){let o=this.gl,l=this.modelMatrix;return Y.fromRotationTranslationScaleOrigin(l,J.create(),K.fromValues(r,n,i),K.fromValues(s*2,a*2,1),K.fromValues(.5,.5,0)),this.applyTransform(l),this.shapeProgram.bind(o).attribute("a_position",o.FLOAT,this.meshQuad.handle).uniform("u_model",l).draw(o,t,0,6),this}drawCircleImpl(t,r,n,i,s,a,o){let l=this.gl,c=this.modelMatrix;return Y.fromRotationTranslationScale(c,J.create(),K.fromValues(i,s,a),K.fromValues(o,o,1)),this.applyTransform(c),this.shapeProgram.bind(l).attribute("a_position",l.FLOAT,t.handle).uniform("u_model",c).draw(l,n,0,r),this}};var ou=`
attribute vec2 a_position;
attribute vec2 a_texcoord;

varying vec2 v_texcoord;

uniform mat4 u_projection_view;
uniform mat4 u_model;

void main() {
    vec4 position = u_projection_view * u_model
        * vec4(a_position.xy, 0.0, 1.0);
    v_texcoord = a_texcoord;
    gl_Position = position;
}`,lu=`
precision mediump float;

varying vec2 v_texcoord;

uniform sampler2D u_texture;
uniform vec2 u_texture_size;
uniform vec4 u_sprite;
uniform vec3 u_color;
uniform float u_opacity_inv;

void main() {
    float spriteWidth = u_sprite.z - u_sprite.x;
    float spriteHeight = u_sprite.w - u_sprite.y;
    vec2 texcoord = vec2(
        (u_sprite.x / u_texture_size.x) + v_texcoord.x * (spriteWidth / u_texture_size.x),
        (u_sprite.y / u_texture_size.y) + v_texcoord.y * (spriteHeight / u_texture_size.y));
    vec4 texcolor = texture2D(u_texture, texcoord);
    if (texcolor.a <= 0.0) discard;
    gl_FragColor = vec4(
        texcolor.r * u_color.r,
        texcolor.g * u_color.g,
        texcolor.b * u_color.b,
        texcolor.a * (1.0 - u_opacity_inv));
}`,Er=class extends gr{constructor(t,r=void 0,n=void 0){super(t,r,n);this.texturedProgram=new Le(t).shader(t.VERTEX_SHADER,ou).shader(t.FRAGMENT_SHADER,lu).link(),this.meshQuadTextured={position:new Ee(t,t.ARRAY_BUFFER).data(Te.createBufferSource(t,t.FLOAT,_t)).build(),texcoord:new Ee(t,t.ARRAY_BUFFER).data(Te.createBufferSource(t,t.FLOAT,_t)).build()},this.spriteVector=xe.fromValues(0,0,1,1),this.textureSize=Fe.fromValues(1,1),this.textureHandle=null,this.textureList=new Array(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS))}resize(){super.resize(),this.texturedProgram.bind(this.gl).uniform("u_projection_view",this.projectionViewMatrix)}setColorVector(t,r,n){return super.setColorVector(t,r,n),this.texturedProgram.bind(this.gl).uniform("u_color",this.colorVector),this}setOpacityFloat(t){return super.setOpacityFloat(t),this.texturedProgram.bind(this.gl).uniform("u_opacity_inv",1-this.opacityFloat),this}setTextureImage(t,r){let n=this.textureList,i=n.length;if(t<0||t>=i)throw new Error(`Invalid texture unit - must be within range [0, ${i-1}]`);let s=this.gl,a=n[t];a&&cu(s,a.handle);let o=hu(s,r);return n[t]=o,s.activeTexture(s.TEXTURE0+t),s.bindTexture(s.TEXTURE_2D,o.handle),this}drawTexturedBox(t=0,r=0,n=0,i=void 0,s=void 0,a=0,o=0,l=void 0,c=void 0){let{width:h,height:u}=this.textureList[t];Fe.set(this.textureSize,h,u),typeof l=="undefined"&&(l=h),typeof c=="undefined"&&(c=u),xe.set(this.spriteVector,a,o,l,c);let p=l-a,d=c-o,v=!1;typeof i=="undefined"?i=p/2:v=!0,typeof s=="undefined"&&(v?s=i:s=d/2);let m=i*2,f=s*2,y=m/p,C=f/d;return this.drawTexturedQuadImpl(t,r,n,this.depthFloat,y,C)}drawTexturedRect(t=0,r=0,n=0,i=void 0,s=void 0,a=0,o=0,l=void 0,c=void 0){let{width:h,height:u}=this.textureList[t];typeof l=="undefined"&&(l=h),typeof c=="undefined"&&(c=u),Fe.set(this.textureSize,h,u),xe.set(this.spriteVector,a,o,l,c),typeof i=="undefined"&&(i=r+h),typeof s=="undefined"&&(s=n+u);let p=i-r,d=s-n,v=l-a,m=c-o,f=p/v,y=d/m,C=r+v/2*f,A=n+m/2*y;return this.drawTexturedQuadImpl(t,C,A,this.depthFloat,f,y)}drawTexturedQuadImpl(t,r,n,i,s,a){let o=this.gl,l=this.spriteVector,c=l[2]-l[0],h=l[3]-l[1],u=this.modelMatrix;Y.fromRotationTranslationScaleOrigin(u,J.fromEuler(J.create(),0,0,0),K.fromValues(r-c/2,n-h/2,i),K.fromValues(s,a,1),K.fromValues(c/2,h/2,0)),Y.scale(u,u,K.fromValues(c,h,1)),this.applyTransform(u);let p=this.meshQuadTextured,d=this.textureSize;return this.texturedProgram.bind(o).attribute("a_position",o.FLOAT,p.position.handle).attribute("a_texcoord",o.FLOAT,p.texcoord.handle).uniform("u_model",u).uniform("u_texture",t).uniform("u_sprite",l).uniform("u_texture_size",d).draw(o,o.TRIANGLES,0,6),this}};function hu(e,t){if(!(t instanceof Image))throw new Error(`Not a valid image ${t}.`);let r=0,n=e.RGBA,i=e.RGBA,s=e.UNSIGNED_BYTE,a=e.createTexture();return e.bindTexture(e.TEXTURE_2D,a),e.texImage2D(e.TEXTURE_2D,r,n,i,s,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),{handle:a,width:t.width,height:t.height}}function cu(e,t){e.deleteTexture(t)}var uu=`
attribute vec2 a_position;

varying vec2 v_position;

uniform mat4 u_projection_view;
uniform mat4 u_model;

void main() {
    gl_Position = u_projection_view * u_model * vec4(a_position.xy, 0.0, 1.0);
    v_position = a_position;
}`,fu=`
precision mediump float;

varying vec2 v_position;

uniform vec3 u_color;
uniform float u_opacity_inv;

uniform vec3 u_color_from;
uniform vec3 u_color_to;

uniform vec4 u_gradient_rect;

void main() {
    // float fx = (gl_FragCoord.x - u_gradient_rect.x) / u_gradient_rect.z;
    float fy = (gl_FragCoord.y - u_gradient_rect.y) / u_gradient_rect.w;
    gl_FragColor = vec4(mix(u_color_to, u_color_from, fy), 1.0 - u_opacity_inv);
}`,yr=class extends Er{constructor(t,r=void 0,n=void 0){super(t,r,n);this.gradientProgram=new Le(t).shader(t.VERTEX_SHADER,uu).shader(t.FRAGMENT_SHADER,fu).link(),this.gradientColor=K.create(),this.gradientVector=xe.create()}resize(){super.resize(),this.gradientProgram.bind(this.gl).uniform("u_projection_view",this.projectionViewMatrix)}setColorVector(t,r,n){return super.setColorVector(t,r,n),this.gradientProgram.bind(this.gl).uniform("u_color",this.colorVector),this}setOpacityFloat(t){return super.setOpacityFloat(t),this.gradientProgram.bind(this.gl).uniform("u_opacity_inv",1-this.opacityFloat),this}drawGradientRect(t=16777215,r=0,n=0,i=0,s=this.canvas.width,a=this.canvas.height){let o=(s-n)/2,l=(a-i)/2,c=n+o,h=i+l,u=this.depthFloat,p=this.gl,d=this.modelMatrix;return Y.fromRotationTranslationScaleOrigin(d,J.fromEuler(J.create(),0,0,0),K.fromValues(c,h,u),K.fromValues(o*2,l*2,1),K.fromValues(.5,.5,0)),this.applyTransform(d),this.gradientProgram.bind(p).attribute("a_position",p.FLOAT,this.meshQuad.handle).uniform("u_model",d).uniform("u_color_from",K.set(this.gradientColor,ae.redf(t),ae.greenf(t),ae.bluef(t))).uniform("u_color_to",K.set(this.gradientColor,ae.redf(r),ae.greenf(r),ae.bluef(r))).uniform("u_gradient_rect",xe.set(this.gradientVector,n,this.canvas.height-a,o*2,l*2)).draw(p,p.TRIANGLES,0,6),this}};var Ar=class extends yr{constructor(t,r=void 0,n=void 0){super(t,r,n);this.bmFontMap={}}setBMFontTexture(t,r,n){let i={};for(let s of n.chars){let a=s.x,o=s.y,l=a+s.width,c=o+s.height;i[s.id]={u:a,v:o,s:l,t:c}}this.bmFontMap[t]=i,this.setTextureImage(t,r)}drawText(t,r,n,i){let s=n,a=13,o=18;for(let l=0;l<r.length;++l){let c=r.charAt(l);if(c===`
`){i+=o,n=s;continue}else if(c===" "){n+=a;continue}else{n+=a;let h=r.charCodeAt(l),{u,v:p,s:d,t:v}=this.bmFontMap[t][h],m=d-u,f=v-p;this.drawTexturedBox(t,n,i,m/2,f/2,u,p,d,v)}}}};var wr=class{next(){return 0}},zi=class extends wr{next(){return Math.random()}},Hi=class extends wr{constructor(t){super();this.seed=t,this.a=t}next(){var t=this.a+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}},R=class{static get RAND(){let t=new this;return this.next=this.next.bind(this),this.choose=this.choose.bind(this),this.range=this.range.bind(this),this.rangeInt=this.rangeInt.bind(this),this.sign=this.sign.bind(this),Object.defineProperty(this,"RAND",{value:t}),t}constructor(t=void 0){typeof t=="number"?this.generator=new Hi(t):t?this.generator=t:this.generator=new zi,this.next=this.next.bind(this),this.choose=this.choose.bind(this),this.range=this.range.bind(this),this.rangeInt=this.rangeInt.bind(this),this.sign=this.sign.bind(this)}static next(){return this.RAND.next()}next(){return this.generator.next()}static choose(t){return this.RAND.choose(t)}choose(t){return t[Math.floor(this.generator.next()*t.length)]}static range(t,r){return this.RAND.range(t,r)}range(t,r){return(r-t)*this.generator.next()+t}static rangeInt(t,r){return this.RAND.rangeInt(t,r)}rangeInt(t,r){return Math.trunc(this.range(t,r))}static sign(){return this.RAND.sign()}sign(){return this.generator.next()<.5?-1:1}};var pu=5,du=4,vu=3,mu=2,xu=1,_u=0,Qf={[pu]:je("#7F8C8D"),[du]:je("#2ECC71"),[vu]:je("#4794C8"),[mu]:je("#F39C12"),[xu]:je("#C0392B"),[_u]:[""]};function je(e){return[`background: ${e}`,"border-radius: 0.5em","color: white","font-weight: bold","padding: 2px 0.5em"]}var Zf=Symbol("level"),Jf=Symbol("domain");var De=0,gu=class{constructor(t){this._heap=[],this._comparator=t}get size(){return this._heap.length}clear(){this._heap.length=0}push(...t){for(let r of t)this._heap.push(r),this._shiftUp()}pop(){let t=this.peek(),r=Eu(this);return r>De&&this._swap(De,r),this._heap.pop(),this._shiftDown(),t}replace(t){let r=this.peek();return this._heap[De]=t,this._shiftDown(),r}peek(){return this._heap[De]}_compare(t,r){return this._comparator(this._heap[t],this._heap[r])}_swap(t,r){let n=this._heap[t];this._heap[t]=this._heap[r],this._heap[r]=n}_shiftUp(){let t=this._heap.length-1,r;for(;t>De&&this._compare(t,r=yu(t));)this._swap(t,r),t=r}_shiftDown(){let t=this._heap.length,r=De,n,i=ki(r),s=i<t,a=Ki(r),o=a<t;for(;s&&this._compare(i,r)||o&&this._compare(a,r);)n=o&&this._compare(a,i)?a:i,this._swap(r,n),r=n,i=ki(r),s=i<t,a=Ki(r),o=a<t}values(){return this._heap}[Symbol.iterator](){return this._heap[Symbol.iterator]()}};function Eu(e){return e._heap.length-1}function yu(e){return(e+1>>>1)-1}function ki(e){return(e<<1)+1}function Ki(e){return e+1<<1}function gt(e,t,r){return Math.min(r,Math.max(t,e))}var e0=Math.PI/180,t0=180/Math.PI;var Au=5e3;function Pe(e,t){for(let r of t)r instanceof oe&&r.register(e)}async function Be(e){let t=[];for(let r of e)r instanceof oe&&t.push(r.load());await Promise.all(t)}var oe=class{constructor(t,r=null,n=null){this.uri=t,this.source=r,this.loader=n,this.parent=null,this._cacheCurrent=null,this._cacheOptions=void 0,this._loadResolves=[],this._loadRejects=[]}get current(){if(!this.parent)throw new Error(`Cannot resolve unregistered asset ref for '${this.uri}'.`);return this.parent.getAsset(this.uri)}async load(t=Au){let r=this.parent,n=this.uri;if(r){if(r.isAssetLoading(n))return await r.loadAsset(n,t);if(r.isAssetCached(n))return r.getAsset(n);{let i=this.loader,s=this.source,[a,o]=await Promise.all([r.loadAsset(n,t),wu(r,n,s,i,t)]);return a}}else return await Promise.race([new Promise((s,a)=>{this._loadResolves.push(s),this._loadRejects.push(a)}),new Promise((s,a)=>setTimeout(()=>{this._loadResolves.length>0?a(new Error("Timeout reached while waiting for asset ref binding.")):s(this.current)},t))])}cache(t,r=void 0){if(!this.parent){this._cacheCurrent=t,this._cacheOptions=r;return}this.parent.cacheAsset(this.uri,t,r)}register(t){if(this.parent=t,this._cacheCurrent){let r=this._cacheCurrent,n=this._cacheOptions;this._cacheCurrent=null,this._cacheOptions=null,this.cache(r,n)}if(this._loadResolves.length>0){let r=this._loadResolves,n=this._loadRejects;this._loadResolves=[],this._loadRejects=[],this.load().then(i=>{for(let s of r)s(i)}).catch(i=>{for(let s of n)s(i)})}}};async function wu(e,t,r,n,i){let s=null;if(r?typeof r=="function"?s=await r():typeof r=="string"?s=await e.loadAsset(r,i):s=r:s=t,n){if(typeof s!="string"&&!(s instanceof Uint8Array))throw new Error("Unable to load from source - must be either a string or Uint8Array.");s=await n(s)}s&&s!==t&&e.cacheAsset(t,s)}async function ue(e,t=void 0){if(typeof e=="string"){let o=await(await fetch(e)).arrayBuffer();if(typeof t=="undefined"){let l=e.lastIndexOf(".");if(l<0)throw new Error("Cannot load from url - unknown image type.");t="image/"+e.slice(l+1)}return ue(o,t)}else if(!(e instanceof ArrayBuffer||ArrayBuffer.isView(e)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let r=e;typeof t=="undefined"&&(t="image/png");let n=new Blob([r],{type:t}),i=URL.createObjectURL(n),s=new Image;return new Promise((a,o)=>{s.addEventListener("load",()=>{a(s)}),s.addEventListener("error",l=>{o(l)}),s.src=i})}var Yi=[16448250],$i=8550580,Vi=11845350,Mr=[11837670,13484018],Mu=40,Tu=12,bu=4,Su=6,Ru=8,Ue={StarImage:new oe("star.png","res/star.png",ue),BlurStrokeImage:new oe("blur_stroke.png","res/blur_stroke.png",ue),CircleImage:new oe("circle.png","res/circle.png",ue),CloudImage:new oe("cloud.png","res/cloud.png",ue)};async function Gi(e){Pe(e.assets,Object.values(Ue)),await Be(Object.values(Ue))}function ji(e){let{display:t}=e,r=t.canvas,n=e.display.width,i=e.display.height,s=[];for(let h=0;h<Mu;++h){let u=Lu(n,i);s.push(u)}let a=[];for(let h=0;h<Tu;++h)a.push(Cu(n,i));let o=[];for(let h=0;h<bu;++h)o.push(Iu(n,i));let l=[];for(let h=0;h<Su;++h)l.push(Ou(n,i));let c=[];for(let h=0;h<Ru;++h)c.push(Nu(n,i));return{stars:s,streaks:a,bigStreaks:o,shades:l,clouds:c}}function qi(e,t,r){let n=e,i=t.display.canvas,s=t.display.width,a=t.display.height,{streaks:o,bigStreaks:l,clouds:c}=r;for(let h of o)if(h.progress+=n/50*h.speed,h.progress>h.y*2+h.length){let u=R.range(-s/2,s);h.x=u,h.y=a,h.progress=0,h.speed=R.range(.1,2),h.opacity=R.range(.1,.3),h.radius=R.range(.5,1),h.length=R.range(1,2)}for(let h of l)if(h.progress+=n/50*h.speed,h.progress>h.y*2+h.length){let u=R.range(-s/2,s);h.x=u,h.y=a,h.progress=0,h.speed=R.range(.1,.5),h.opacity=R.range(.1,.5),h.radius=R.range(.5,1)*3,h.length=R.range(1,2)*3}for(let h of c)h.progress+=n/100*h.speed,h.progress>s-h.x+300&&(h.w=R.range(2,4),h.h=R.range(.2,1),h.x=-s,h.y=R.range(0,a*.6),h.progress=0,h.speed=R.range(.5,3))}function Wi(e,t,r){let n=t.now,i=t.display.canvas,s=t.display.width,a=t.display.height,{shades:o,streaks:l,bigStreaks:c,stars:h,clouds:u}=r;e.drawGradientRect($i,Vi,0,0,s,a);for(let f of o)e.setColor(f.color),e.setScale(s/16,f.height/16),e.setTranslation(f.x,f.y),e.drawCircle(),e.resetTransform();e.setTextureImage(2,Ue.BlurStrokeImage.current),e.setRotation(0,0,-45);for(let f of l){let y=f.progress/100;e.setColor(f.color),e.setOpacityFloat(Math.min(y,f.opacity)),e.setScale(f.length,f.radius),e.setTranslation(f.x,f.y),e.drawTexturedBox(2,f.progress)}for(let f of c){let y=f.progress/100;e.setColor(f.color),e.setOpacityFloat(Math.min(y,f.opacity)),e.setScale(f.length,f.radius),e.setTranslation(f.x,f.y),e.drawTexturedBox(2,f.progress)}e.setOpacityFloat(1),e.resetTransform();let p=n/400%s,d=n/400%a;e.setTextureImage(0,Ue.StarImage.current);for(let f of h){e.setColor(f.color),e.setOpacityFloat(f.opacity);let y=Math.sin(n/500*f.wiggleSpeed+f.wiggleOffset)+1,C=(f.x+p)%s,A=(f.y+d)%a;e.drawTexturedBox(0,C,a-A,16*f.scale,16*f.scale+y*f.scale*8)}e.setOpacityFloat(1),e.setColor(Yi[0]),e.setTextureImage(3,Ue.CircleImage.current),e.drawTexturedBox(3,s*.66,200);let v=Ue.CloudImage.current;e.setTextureImage(4,v);let m=-v.height/2;for(let f of u){let y=f.x+f.progress;e.setColor(f.highlight),e.setScale(f.w*1.2,f.h*1.2),e.setTranslation(y,f.y);let C=y/s;e.drawTexturedBox(4,10*(-C*2+1),m),e.setColor(f.lowlight),e.setScale(f.w,f.h),e.setTranslation(y,f.y),e.drawTexturedBox(4,0,m)}e.resetTransform()}function Lu(e,t){return{x:R.rangeInt(0,e),y:R.rangeInt(0,t),scale:R.range(.1,.4),opacity:R.range(.3,1),color:R.choose(Yi),wiggleSpeed:R.range(.8,1.2),wiggleOffset:R.range(0,2)}}function Cu(e,t){let r=R.range(-e/2,e),n=R.range(0,t),i;n<e*.6?i=Mr[0]:i=Mr[1];let s=R.range(1,2);return{x:r,y:n,color:i,progress:R.range(0,t),speed:R.range(.1,1.5),opacity:R.range(.1,.3),radius:R.range(.5,1)*s,length:R.range(1,2)*s}}function Iu(e,t){let r=R.range(-e/2,e),n=R.rangeInt(0,t),i=Mr[1];return{x:r,y:n,color:i,progress:0,speed:R.range(.1,.5),opacity:R.range(.1,.5),radius:R.range(.5,1)*3,length:R.range(1,2)*3}}function Ou(e,t){let r=R.range(0,e),n=R.range(0,t),i=ae.mix(Vi,$i,gt(n/t-.06,0,1)),s=R.range(50,80);return{x:r,y:n,opacity:1,color:i,height:s}}function Nu(e,t){let r=R.range(0,e),n=R.range(0,t*.6),i=R.range(2,4),s=R.range(.2,1);return{x:r,y:n,w:i,h:s,highlight:16777215,lowlight:14741247,progress:0,speed:R.range(.5,3)}}var Fu=[10665701,5472705,4998547],Et=[4815292,3696037,1789849,1591177],Du=60,Pu=40,Bu=10,Uu=8,yt={Wave1Image:new oe("wave1.png","res/wave1.png",ue),Wave2Image:new oe("wave2.png","res/wave2.png",ue)};async function Xi(e){Pe(e.assets,Object.values(yt)),await Be(Object.values(yt))}function Qi(e){let{display:t}=e,r=t.canvas,n=e.display.width,i=e.display.height,s=[];for(let c=0;c<Du;++c)s.push(zu(n,i));let a=[];for(let c=0;c<Pu;++c)a.push(Hu(n,i));let o=[];for(let c=0;c<Bu;++c)o.push(ku(n,i));let l=[];for(let c=0;c<Uu;++c)l.push(Ku(n,i));return{sparkles:s,foams:a,columns:o,rows:l}}function Zi(e,t,r){let n=e,i=t.display.canvas,s=t.display.width,a=t.display.height}function Ji(e,t,r){let n=t.now,i=t.display.canvas,s=t.display.width,a=t.display.height,{columns:o,rows:l,sparkles:c,foams:h}=r,u=i.height-200;e.setColor(16777215),e.drawGradientRect(4815292,1789849,0,u,s,a),e.setOpacityFloat(.6);for(let f of o)e.setColor(f.color),e.drawRect(f.x,u,f.x+f.width,i.height);e.setOpacityFloat(1);for(let f of l)e.setColor(f.color),e.setScale(f.height,1),e.setTranslation(f.x,f.y),e.drawCircle();e.resetTransform();let p=10,d=i.height-150,v=d-u;e.setRotation(0,0,45);for(let f of c){e.setColor(16777215);let y=(Math.sin(n/1e3+f.sparkleOffset)+1)/2;e.setOpacityFloat(y);let C=10*(Math.sin(n/5e3+f.sparkleOffset)+1)/2;e.setTranslation(f.x+C,f.y,p);let A=(u-f.y)/v;e.setScale(.5+A,.5+A),e.drawBox()}e.setOpacityFloat(1),e.resetTransform();let m=i.height-u;for(let f of h){e.setColor(16777215);let y=gt((Math.sin(n/1e3+f.opacity)+1)/2*2,0,1);e.setOpacityFloat(y);let C=100*(Math.sin(n/5e3+f.opacity)+1)/2;e.setTranslation(f.x+C,f.y,p);let A=(f.y-d)/m;e.setScale(.1+A,(.1+A)*.5);let E;switch(f.wave){case 0:E=yt.Wave1Image.current;break;default:case 1:E=yt.Wave2Image.current;break}e.setTextureImage(5,E),e.drawTexturedBox(5)}e.setOpacityFloat(1),e.resetTransform()}function zu(e,t){let r=R.range(0,e),n=R.range(t-190,t-150);return{x:r,y:n,sparkleOffset:R.range(0,Math.PI*2)}}function Hu(e,t){let r=R.range(0,e),n=R.range(t-150,t),i=R.choose([0,1]);return{x:r,y:n,wave:i,opacity:R.range(0,Math.PI*2)}}function ku(e,t){let r=R.range(0,e),n=R.choose(Fu),i=R.range(50,100);return{x:r,color:n,width:i}}function Ku(e,t){let r=R.range(0,e),n=R.range(t-190,t-20),i=R.range(20,60),s;if(R.next()<.6){let a=(n-(t-190))/200;a<.3?s=Et[0]:a<.6?s=Et[1]:s=Et[2]}else s=R.choose(Et);return{x:r,y:n,color:s,height:i}}var Tr={FishImage:new oe("fish_shadow.png","res/fish_shadow.png",ue)},ze={MoveLeft:new we("moveLeft",[Ae.KEY_A,Ae.ARROW_LEFT]),MoveRight:new we("moveRight",[Ae.KEY_D,Ae.ARROW_RIGHT]),Fish:new we("fish",[Ae.SPACE])};window.addEventListener("DOMContentLoaded",Yu);async function Yu(){let e=document.querySelector("#display"),t=document.querySelector("#inputs").getContext("axisbutton"),r=document.querySelector("#assets"),n=new Promise((i,s)=>{r.addEventListener("load",i),r.addEventListener("error",s)});r.src="res.pack",await n,await $u({display:e,inputs:t,assets:r,deltaTime:0,now:0})}async function $u(e){let{display:t}=e,r=t.canvas,n=new Ar(r.getContext("webgl")),i=t.width,s=t.height;Pe(e.assets,Object.values(Tr)),await Be(Object.values(Tr)),e.inputs.bindBindings(Object.values(ze)),await Gi(e),await Xi(e);let a=ji(e),o=Qi(e),l=[];for(let p=0;p<6;++p){let d=R.range(0,i),v=R.range(s-100,s),m=R.range(0,Math.PI*2);l.push({x:d,y:v,offset:m,size:R.range(.3,.5),speed:R.range(1,3)*R.sign()})}let c=[];for(let p=0;p<10;++p)c.push({x:0,y:0,age:0});let h={x:0,y:r.height-100},u={chargeTime:0,fishing:!1,fishSpotX:0,fishSpotY:0};t.addEventListener("frame",p=>{let{deltaTime:d,now:v}=p.detail;i=e.display.width,s=e.display.height,e.inputs.poll(v);let m=1;d*=m,v*=m,e.deltaTime=d,e.now=v,qi(d,e,a),Zi(d,e,o);for(let E of l)if(E.x+=(.2+(Math.sin(v/1e3+E.offset)+1)/2)*E.speed,E.x>i&&(E.x=0,E.y=R.range(s-100,s)),E.x<0&&(E.x=i,E.y=R.range(s-100,s)),Math.floor(v/10+E.y*10)%400==0&&Math.random()<.1){let w=null;for(let b of c)b.age<=0&&(w=b);w&&(w.x=E.x,w.y=E.y,w.age=R.range(5e3,1e4))}for(let E of c)E.age>0&&(E.age-=d);let f=ze.MoveRight.value-ze.MoveLeft.value;if(h.x+=f*d/10,h.y=r.height-160,u.fishing)ze.Fish.pressed&&(u.fishing=!1);else if(ze.Fish.down?u.chargeTime+=d:ze.Fish.released&&u.chargeTime>0&&(u.chargeTime=0,u.fishing=!0),u.chargeTime>0){let E=u.chargeTime/10;u.fishSpotX=h.x-E,u.fishSpotY=h.y+60+E/4}n.resize(),n.reset(),n.setTranslation(0,0,-10),n.pushTransform(),Wi(n,e,a),Ji(n,e,o),n.popTransform(),n.setTextureImage(6,Tr.FishImage.current),n.setColor(3355443);for(let E of l){n.pushTransform();let w=Math.sin(E.x/5+E.y),b=Math.cos(E.x/20);n.setTranslation(E.x,E.y+b*4),n.setOpacityFloat(.5),n.setRotation(0,0,90+w*4+(E.speed<0?180:0)),n.setScale(E.size,E.size+(b+1)/2*.1),n.drawTexturedBox(6,0,20),n.popTransform()}n.setOpacityFloat(1),n.resetTransform(),n.setColor(16777215);for(let E of c){if(E.age<=0)continue;let w=E.age/1e4;n.setTranslation(E.x,E.y,10);let b=(1-w)*.9;n.setScale(2+b*2,.5+b),n.setOpacityFloat(w),n.drawLineCircle();let F=(1-w)*.5;n.setScale(1+F*2,.1+F),n.drawLineCircle()}n.setOpacityFloat(1),n.resetTransform(),n.setColor(7493698);let y=Math.sin(v/400)*2,C=80,A=20;n.drawBox(h.x,h.y+y,C,A),n.setColor(5192490),n.drawRect(h.x-C,h.y+A-5-y,h.x+C,h.y+A+5),n.resetTransform(),u.fishing?n.setColor(65450):n.setColor(16777215),n.drawCircle(h.x,h.y-80),n.setColor(16777215),n.drawLineBox(u.fishSpotX,u.fishSpotY)})}})();
//# sourceMappingURL=main.js.map
