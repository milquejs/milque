(()=>{var ks=Object.create,ct=Object.defineProperty,Hs=Object.getPrototypeOf,zs=Object.prototype.hasOwnProperty,Ys=Object.getOwnPropertyNames,Gs=Object.getOwnPropertyDescriptor;var Vs=e=>ct(e,"__esModule",{value:!0});var Ks=(e,t)=>()=>(e&&(t=e(e=0)),t),Pe=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Fe=(e,t)=>{for(var r in t)ct(e,r,{get:t[r],enumerable:!0})},$s=(e,t,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Ys(t))!zs.call(e,n)&&n!=="default"&&ct(e,n,{get:()=>t[n],enumerable:!(r=Gs(t,n))||r.enumerable});return e},Ws=e=>$s(Vs(ct(e!=null?ks(Hs(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var dn={};Fe(dn,{basename:()=>yn,default:()=>So,delimiter:()=>gn,dirname:()=>En,extname:()=>An,isAbsolute:()=>Jt,join:()=>mn,normalize:()=>er,relative:()=>xn,resolve:()=>ft,sep:()=>_n});function vn(e,t){for(var r=0,n=e.length-1;n>=0;n--){var i=e[n];i==="."?e.splice(n,1):i===".."?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}function ft(){for(var e="",t=!1,r=arguments.length-1;r>=-1&&!t;r--){var n=r>=0?arguments[r]:"/";if(typeof n!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!n)continue;e=n+"/"+e,t=n.charAt(0)==="/"}return e=vn(Zt(e.split("/"),function(i){return!!i}),!t).join("/"),(t?"/":"")+e||"."}function er(e){var t=Jt(e),r=bo(e,-1)==="/";return e=vn(Zt(e.split("/"),function(n){return!!n}),!t).join("/"),!e&&!t&&(e="."),e&&r&&(e+="/"),(t?"/":"")+e}function Jt(e){return e.charAt(0)==="/"}function mn(){var e=Array.prototype.slice.call(arguments,0);return er(Zt(e,function(t,r){if(typeof t!="string")throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))}function xn(e,t){e=ft(e).substr(1),t=ft(t).substr(1);function r(c){for(var h=0;h<c.length&&c[h]==="";h++);for(var f=c.length-1;f>=0&&c[f]==="";f--);return h>f?[]:c.slice(h,f-h+1)}for(var n=r(e.split("/")),i=r(t.split("/")),s=Math.min(n.length,i.length),a=s,o=0;o<s;o++)if(n[o]!==i[o]){a=o;break}for(var l=[],o=a;o<n.length;o++)l.push("..");return l=l.concat(i.slice(a)),l.join("/")}function En(e){var t=Qt(e),r=t[0],n=t[1];return!r&&!n?".":(n&&(n=n.substr(0,n.length-1)),r+n)}function yn(e,t){var r=Qt(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r}function An(e){return Qt(e)[3]}function Zt(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}var Mo,Qt,_n,gn,So,bo,wn=Ks(()=>{Mo=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,Qt=function(e){return Mo.exec(e).slice(1)};_n="/",gn=":";So={extname:An,basename:yn,dirname:En,sep:_n,delimiter:gn,relative:xn,join:mn,isAbsolute:Jt,normalize:er,resolve:ft};bo="ab".substr(-1)==="b"?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)}});var pt=Pe((f0,ut)=>{var Oe=(wn(),dn);Oe&&Oe.default?ut.exports=Oe.default:Oe&&(ut.exports=Oe);if(Oe)for(let e in Oe)ut.exports[e]=Oe[e]});var Xe=Pe((u0,Tn)=>{"use strict";var Ro=pt(),ge="\\\\/",Mn=`[^${ge}]`,Se="\\.",Io="\\+",Lo="\\?",dt="\\/",Co="(?=.)",bn="[^/]",tr=`(?:${dt}|$)`,Sn=`(?:^|${dt})`,rr=`${Se}{1,2}${tr}`,Oo=`(?!${Se})`,No=`(?!${Sn}${rr})`,Bo=`(?!${Se}{0,1}${tr})`,Po=`(?!${rr})`,Fo=`[^.${dt}]`,Do=`${bn}*?`,Rn={DOT_LITERAL:Se,PLUS_LITERAL:Io,QMARK_LITERAL:Lo,SLASH_LITERAL:dt,ONE_CHAR:Co,QMARK:bn,END_ANCHOR:tr,DOTS_SLASH:rr,NO_DOT:Oo,NO_DOTS:No,NO_DOT_SLASH:Bo,NO_DOTS_SLASH:Po,QMARK_NO_DOT:Fo,STAR:Do,START_ANCHOR:Sn},Uo={...Rn,SLASH_LITERAL:`[${ge}]`,QMARK:Mn,STAR:`${Mn}*?`,DOTS_SLASH:`${Se}{1,2}(?:[${ge}]|$)`,NO_DOT:`(?!${Se})`,NO_DOTS:`(?!(?:^|[${ge}])${Se}{1,2}(?:[${ge}]|$))`,NO_DOT_SLASH:`(?!${Se}{0,1}(?:[${ge}]|$))`,NO_DOTS_SLASH:`(?!${Se}{1,2}(?:[${ge}]|$))`,QMARK_NO_DOT:`[^.${ge}]`,START_ANCHOR:`(?:^|[${ge}])`,END_ANCHOR:`(?:[${ge}]|$)`},ko={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};Tn.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:ko,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:Ro.sep,extglobChars(e){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${e.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(e){return e===!0?Uo:Rn}}});var vt=Pe(le=>{"use strict";var Ho=pt(),zo=!1,{REGEX_BACKSLASH:Yo,REGEX_REMOVE_BACKSLASH:Go,REGEX_SPECIAL_CHARS:Vo,REGEX_SPECIAL_CHARS_GLOBAL:Ko}=Xe();le.isObject=e=>e!==null&&typeof e=="object"&&!Array.isArray(e);le.hasRegexChars=e=>Vo.test(e);le.isRegexChar=e=>e.length===1&&le.hasRegexChars(e);le.escapeRegex=e=>e.replace(Ko,"\\$1");le.toPosixSlashes=e=>e.replace(Yo,"/");le.removeBackslashes=e=>e.replace(Go,t=>t==="\\"?"":t);le.supportsLookbehinds=()=>{let e=process.version.slice(1).split(".").map(Number);return e.length===3&&e[0]>=9||e[0]===8&&e[1]>=10};le.isWindows=e=>e&&typeof e.windows=="boolean"?e.windows:zo===!0||Ho.sep==="\\";le.escapeLast=(e,t,r)=>{let n=e.lastIndexOf(t,r);return n===-1?e:e[n-1]==="\\"?le.escapeLast(e,t,n-1):`${e.slice(0,n)}\\${e.slice(n)}`};le.removePrefix=(e,t={})=>{let r=e;return r.startsWith("./")&&(r=r.slice(2),t.prefix="./"),r};le.wrapOutput=(e,t={},r={})=>{let n=r.contains?"":"^",i=r.contains?"":"$",s=`${n}(?:${e})${i}`;return t.negated===!0&&(s=`(?:^(?!${s}).*$)`),s}});var Fn=Pe((d0,In)=>{"use strict";var Ln=vt(),{CHAR_ASTERISK:nr,CHAR_AT:$o,CHAR_BACKWARD_SLASH:Qe,CHAR_COMMA:Wo,CHAR_DOT:ir,CHAR_EXCLAMATION_MARK:sr,CHAR_FORWARD_SLASH:Cn,CHAR_LEFT_CURLY_BRACE:ar,CHAR_LEFT_PARENTHESES:or,CHAR_LEFT_SQUARE_BRACKET:jo,CHAR_PLUS:qo,CHAR_QUESTION_MARK:On,CHAR_RIGHT_CURLY_BRACE:Xo,CHAR_RIGHT_PARENTHESES:Nn,CHAR_RIGHT_SQUARE_BRACKET:Qo}=Xe(),Bn=e=>e===Cn||e===Qe,Pn=e=>{e.isPrefix!==!0&&(e.depth=e.isGlobstar?Infinity:1)},Zo=(e,t)=>{let r=t||{},n=e.length-1,i=r.parts===!0||r.scanToEnd===!0,s=[],a=[],o=[],l=e,c=-1,h=0,f=0,u=!1,p=!1,d=!1,m=!1,v=!1,y=!1,L=!1,w=!1,b=!1,T=!1,x=0,O,A,I={value:"",depth:0,isGlob:!1},F=()=>c>=n,_=()=>l.charCodeAt(c+1),D=()=>(O=A,l.charCodeAt(++c));for(;c<n;){A=D();let j;if(A===Qe){L=I.backslashes=!0,A=D(),A===ar&&(y=!0);continue}if(y===!0||A===ar){for(x++;F()!==!0&&(A=D());){if(A===Qe){L=I.backslashes=!0,D();continue}if(A===ar){x++;continue}if(y!==!0&&A===ir&&(A=D())===ir){if(u=I.isBrace=!0,d=I.isGlob=!0,T=!0,i===!0)continue;break}if(y!==!0&&A===Wo){if(u=I.isBrace=!0,d=I.isGlob=!0,T=!0,i===!0)continue;break}if(A===Xo&&(x--,x===0)){y=!1,u=I.isBrace=!0,T=!0;break}}if(i===!0)continue;break}if(A===Cn){if(s.push(c),a.push(I),I={value:"",depth:0,isGlob:!1},T===!0)continue;if(O===ir&&c===h+1){h+=2;continue}f=c+1;continue}if(r.noext!==!0&&(A===qo||A===$o||A===nr||A===On||A===sr)===!0&&_()===or){if(d=I.isGlob=!0,m=I.isExtglob=!0,T=!0,A===sr&&c===h&&(b=!0),i===!0){for(;F()!==!0&&(A=D());){if(A===Qe){L=I.backslashes=!0,A=D();continue}if(A===Nn){d=I.isGlob=!0,T=!0;break}}continue}break}if(A===nr){if(O===nr&&(v=I.isGlobstar=!0),d=I.isGlob=!0,T=!0,i===!0)continue;break}if(A===On){if(d=I.isGlob=!0,T=!0,i===!0)continue;break}if(A===jo){for(;F()!==!0&&(j=D());){if(j===Qe){L=I.backslashes=!0,D();continue}if(j===Qo){p=I.isBracket=!0,d=I.isGlob=!0,T=!0;break}}if(i===!0)continue;break}if(r.nonegate!==!0&&A===sr&&c===h){w=I.negated=!0,h++;continue}if(r.noparen!==!0&&A===or){if(d=I.isGlob=!0,i===!0){for(;F()!==!0&&(A=D());){if(A===or){L=I.backslashes=!0,A=D();continue}if(A===Nn){T=!0;break}}continue}break}if(d===!0){if(T=!0,i===!0)continue;break}}r.noext===!0&&(m=!1,d=!1);let P=l,B="",g="";h>0&&(B=l.slice(0,h),l=l.slice(h),f-=h),P&&d===!0&&f>0?(P=l.slice(0,f),g=l.slice(f)):d===!0?(P="",g=l):P=l,P&&P!==""&&P!=="/"&&P!==l&&Bn(P.charCodeAt(P.length-1))&&(P=P.slice(0,-1)),r.unescape===!0&&(g&&(g=Ln.removeBackslashes(g)),P&&L===!0&&(P=Ln.removeBackslashes(P)));let E={prefix:B,input:e,start:h,base:P,glob:g,isBrace:u,isBracket:p,isGlob:d,isExtglob:m,isGlobstar:v,negated:w,negatedExtglob:b};if(r.tokens===!0&&(E.maxDepth=0,Bn(A)||a.push(I),E.tokens=a),r.parts===!0||r.tokens===!0){let j;for(let z=0;z<s.length;z++){let ee=j?j+1:h,te=s[z],ie=e.slice(ee,te);r.tokens&&(z===0&&h!==0?(a[z].isPrefix=!0,a[z].value=B):a[z].value=ie,Pn(a[z]),E.maxDepth+=a[z].depth),(z!==0||ie!=="")&&o.push(ie),j=te}if(j&&j+1<e.length){let z=e.slice(j+1);o.push(z),r.tokens&&(a[a.length-1].value=z,Pn(a[a.length-1]),E.maxDepth+=a[a.length-1].depth)}E.slashes=s,E.parts=o}return E};In.exports=Zo});var Hn=Pe((v0,Dn)=>{"use strict";var mt=Xe(),he=vt(),{MAX_LENGTH:xt,POSIX_REGEX_SOURCE:Jo,REGEX_NON_SPECIAL_CHARS:el,REGEX_SPECIAL_CHARS_BACKREF:tl,REPLACEMENTS:Un}=mt,rl=(e,t)=>{if(typeof t.expandRange=="function")return t.expandRange(...e,t);e.sort();let r=`[${e.join("-")}]`;try{new RegExp(r)}catch(n){return e.map(i=>he.escapeRegex(i)).join("..")}return r},Ye=(e,t)=>`Missing ${e}: "${t}" - use "\\\\${t}" to match literal characters`,kn=(e,t)=>{if(typeof e!="string")throw new TypeError("Expected a string");e=Un[e]||e;let r={...t},n=typeof r.maxLength=="number"?Math.min(xt,r.maxLength):xt,i=e.length;if(i>n)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${n}`);let s={type:"bos",value:"",output:r.prepend||""},a=[s],o=r.capture?"":"?:",l=he.isWindows(t),c=mt.globChars(l),h=mt.extglobChars(c),{DOT_LITERAL:f,PLUS_LITERAL:u,SLASH_LITERAL:p,ONE_CHAR:d,DOTS_SLASH:m,NO_DOT:v,NO_DOT_SLASH:y,NO_DOTS_SLASH:L,QMARK:w,QMARK_NO_DOT:b,STAR:T,START_ANCHOR:x}=c,O=C=>`(${o}(?:(?!${x}${C.dot?m:f}).)*?)`,A=r.dot?"":v,I=r.dot?w:b,F=r.bash===!0?O(r):T;r.capture&&(F=`(${F})`),typeof r.noext=="boolean"&&(r.noextglob=r.noext);let _={input:e,index:-1,start:0,dot:r.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:a};e=he.removePrefix(e,_),i=e.length;let D=[],P=[],B=[],g=s,E,j=()=>_.index===i-1,z=_.peek=(C=1)=>e[_.index+C],ee=_.advance=()=>e[++_.index]||"",te=()=>e.slice(_.index+1),ie=(C="",$=0)=>{_.consumed+=C,_.index+=$},xe=C=>{_.output+=C.output!=null?C.output:C.value,ie(C.value)},je=()=>{let C=1;for(;z()==="!"&&(z(2)!=="("||z(3)==="?");)ee(),_.start++,C++;return C%2==0?!1:(_.negated=!0,_.start++,!0)},Ce=C=>{_[C]++,B.push(C)},_e=C=>{_[C]--,B.pop()},k=C=>{if(g.type==="globstar"){let $=_.braces>0&&(C.type==="comma"||C.type==="brace"),M=C.extglob===!0||D.length&&(C.type==="pipe"||C.type==="paren");C.type!=="slash"&&C.type!=="paren"&&!$&&!M&&(_.output=_.output.slice(0,-g.output.length),g.type="star",g.value="*",g.output=F,_.output+=g.output)}if(D.length&&C.type!=="paren"&&(D[D.length-1].inner+=C.value),(C.value||C.output)&&xe(C),g&&g.type==="text"&&C.type==="text"){g.value+=C.value,g.output=(g.output||"")+C.value;return}C.prev=g,a.push(C),g=C},Be=(C,$)=>{let M={...h[$],conditions:1,inner:""};M.prev=g,M.parens=_.parens,M.output=_.output;let H=(r.capture?"(":"")+M.open;Ce("parens"),k({type:C,value:$,output:_.output?"":d}),k({type:"paren",extglob:!0,value:ee(),output:H}),D.push(M)},ot=C=>{let $=C.close+(r.capture?")":""),M;if(C.type==="negate"){let H=F;C.inner&&C.inner.length>1&&C.inner.includes("/")&&(H=O(r)),(H!==F||j()||/^\)+$/.test(te()))&&($=C.close=`)$))${H}`),C.inner.includes("*")&&(M=te())&&/^\.[^\\/.]+$/.test(M)&&($=C.close=`)${M})${H})`),C.prev.type==="bos"&&(_.negatedExtglob=!0)}k({type:"paren",extglob:!0,value:E,output:$}),_e("parens")};if(r.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(e)){let C=!1,$=e.replace(tl,(M,H,q,oe,Q,kt)=>oe==="\\"?(C=!0,M):oe==="?"?H?H+oe+(Q?w.repeat(Q.length):""):kt===0?I+(Q?w.repeat(Q.length):""):w.repeat(q.length):oe==="."?f.repeat(q.length):oe==="*"?H?H+oe+(Q?F:""):F:H?M:`\\${M}`);return C===!0&&(r.unescape===!0?$=$.replace(/\\/g,""):$=$.replace(/\\+/g,M=>M.length%2==0?"\\\\":M?"\\":"")),$===e&&r.contains===!0?(_.output=e,_):(_.output=he.wrapOutput($,_,t),_)}for(;!j();){if(E=ee(),E==="\0")continue;if(E==="\\"){let M=z();if(M==="/"&&r.bash!==!0||M==="."||M===";")continue;if(!M){E+="\\",k({type:"text",value:E});continue}let H=/^\\+/.exec(te()),q=0;if(H&&H[0].length>2&&(q=H[0].length,_.index+=q,q%2!=0&&(E+="\\")),r.unescape===!0?E=ee():E+=ee(),_.brackets===0){k({type:"text",value:E});continue}}if(_.brackets>0&&(E!=="]"||g.value==="["||g.value==="[^")){if(r.posix!==!1&&E===":"){let M=g.value.slice(1);if(M.includes("[")&&(g.posix=!0,M.includes(":"))){let H=g.value.lastIndexOf("["),q=g.value.slice(0,H),oe=g.value.slice(H+2),Q=Jo[oe];if(Q){g.value=q+Q,_.backtrack=!0,ee(),!s.output&&a.indexOf(g)===1&&(s.output=d);continue}}}(E==="["&&z()!==":"||E==="-"&&z()==="]")&&(E=`\\${E}`),E==="]"&&(g.value==="["||g.value==="[^")&&(E=`\\${E}`),r.posix===!0&&E==="!"&&g.value==="["&&(E="^"),g.value+=E,xe({value:E});continue}if(_.quotes===1&&E!=='"'){E=he.escapeRegex(E),g.value+=E,xe({value:E});continue}if(E==='"'){_.quotes=_.quotes===1?0:1,r.keepQuotes===!0&&k({type:"text",value:E});continue}if(E==="("){Ce("parens"),k({type:"paren",value:E});continue}if(E===")"){if(_.parens===0&&r.strictBrackets===!0)throw new SyntaxError(Ye("opening","("));let M=D[D.length-1];if(M&&_.parens===M.parens+1){ot(D.pop());continue}k({type:"paren",value:E,output:_.parens?")":"\\)"}),_e("parens");continue}if(E==="["){if(r.nobracket===!0||!te().includes("]")){if(r.nobracket!==!0&&r.strictBrackets===!0)throw new SyntaxError(Ye("closing","]"));E=`\\${E}`}else Ce("brackets");k({type:"bracket",value:E});continue}if(E==="]"){if(r.nobracket===!0||g&&g.type==="bracket"&&g.value.length===1){k({type:"text",value:E,output:`\\${E}`});continue}if(_.brackets===0){if(r.strictBrackets===!0)throw new SyntaxError(Ye("opening","["));k({type:"text",value:E,output:`\\${E}`});continue}_e("brackets");let M=g.value.slice(1);if(g.posix!==!0&&M[0]==="^"&&!M.includes("/")&&(E=`/${E}`),g.value+=E,xe({value:E}),r.literalBrackets===!1||he.hasRegexChars(M))continue;let H=he.escapeRegex(g.value);if(_.output=_.output.slice(0,-g.value.length),r.literalBrackets===!0){_.output+=H,g.value=H;continue}g.value=`(${o}${H}|${g.value})`,_.output+=g.value;continue}if(E==="{"&&r.nobrace!==!0){Ce("braces");let M={type:"brace",value:E,output:"(",outputIndex:_.output.length,tokensIndex:_.tokens.length};P.push(M),k(M);continue}if(E==="}"){let M=P[P.length-1];if(r.nobrace===!0||!M){k({type:"text",value:E,output:E});continue}let H=")";if(M.dots===!0){let q=a.slice(),oe=[];for(let Q=q.length-1;Q>=0&&(a.pop(),q[Q].type!=="brace");Q--)q[Q].type!=="dots"&&oe.unshift(q[Q].value);H=rl(oe,r),_.backtrack=!0}if(M.comma!==!0&&M.dots!==!0){let q=_.output.slice(0,M.outputIndex),oe=_.tokens.slice(M.tokensIndex);M.value=M.output="\\{",E=H="\\}",_.output=q;for(let Q of oe)_.output+=Q.output||Q.value}k({type:"brace",value:E,output:H}),_e("braces"),P.pop();continue}if(E==="|"){D.length>0&&D[D.length-1].conditions++,k({type:"text",value:E});continue}if(E===","){let M=E,H=P[P.length-1];H&&B[B.length-1]==="braces"&&(H.comma=!0,M="|"),k({type:"comma",value:E,output:M});continue}if(E==="/"){if(g.type==="dot"&&_.index===_.start+1){_.start=_.index+1,_.consumed="",_.output="",a.pop(),g=s;continue}k({type:"slash",value:E,output:p});continue}if(E==="."){if(_.braces>0&&g.type==="dot"){g.value==="."&&(g.output=f);let M=P[P.length-1];g.type="dots",g.output+=E,g.value+=E,M.dots=!0;continue}if(_.braces+_.parens===0&&g.type!=="bos"&&g.type!=="slash"){k({type:"text",value:E,output:f});continue}k({type:"dot",value:E,output:f});continue}if(E==="?"){if(!(g&&g.value==="(")&&r.noextglob!==!0&&z()==="("&&z(2)!=="?"){Be("qmark",E);continue}if(g&&g.type==="paren"){let H=z(),q=E;if(H==="<"&&!he.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(g.value==="("&&!/[!=<:]/.test(H)||H==="<"&&!/<([!=]|\w+>)/.test(te()))&&(q=`\\${E}`),k({type:"text",value:E,output:q});continue}if(r.dot!==!0&&(g.type==="slash"||g.type==="bos")){k({type:"qmark",value:E,output:b});continue}k({type:"qmark",value:E,output:w});continue}if(E==="!"){if(r.noextglob!==!0&&z()==="("&&(z(2)!=="?"||!/[!=<:]/.test(z(3)))){Be("negate",E);continue}if(r.nonegate!==!0&&_.index===0){je();continue}}if(E==="+"){if(r.noextglob!==!0&&z()==="("&&z(2)!=="?"){Be("plus",E);continue}if(g&&g.value==="("||r.regex===!1){k({type:"plus",value:E,output:u});continue}if(g&&(g.type==="bracket"||g.type==="paren"||g.type==="brace")||_.parens>0){k({type:"plus",value:E});continue}k({type:"plus",value:u});continue}if(E==="@"){if(r.noextglob!==!0&&z()==="("&&z(2)!=="?"){k({type:"at",extglob:!0,value:E,output:""});continue}k({type:"text",value:E});continue}if(E!=="*"){(E==="$"||E==="^")&&(E=`\\${E}`);let M=el.exec(te());M&&(E+=M[0],_.index+=M[0].length),k({type:"text",value:E});continue}if(g&&(g.type==="globstar"||g.star===!0)){g.type="star",g.star=!0,g.value+=E,g.output=F,_.backtrack=!0,_.globstar=!0,ie(E);continue}let C=te();if(r.noextglob!==!0&&/^\([^?]/.test(C)){Be("star",E);continue}if(g.type==="star"){if(r.noglobstar===!0){ie(E);continue}let M=g.prev,H=M.prev,q=M.type==="slash"||M.type==="bos",oe=H&&(H.type==="star"||H.type==="globstar");if(r.bash===!0&&(!q||C[0]&&C[0]!=="/")){k({type:"star",value:E,output:""});continue}let Q=_.braces>0&&(M.type==="comma"||M.type==="brace"),kt=D.length&&(M.type==="pipe"||M.type==="paren");if(!q&&M.type!=="paren"&&!Q&&!kt){k({type:"star",value:E,output:""});continue}for(;C.slice(0,3)==="/**";){let lt=e[_.index+4];if(lt&&lt!=="/")break;C=C.slice(3),ie("/**",3)}if(M.type==="bos"&&j()){g.type="globstar",g.value+=E,g.output=O(r),_.output=g.output,_.globstar=!0,ie(E);continue}if(M.type==="slash"&&M.prev.type!=="bos"&&!oe&&j()){_.output=_.output.slice(0,-(M.output+g.output).length),M.output=`(?:${M.output}`,g.type="globstar",g.output=O(r)+(r.strictSlashes?")":"|$)"),g.value+=E,_.globstar=!0,_.output+=M.output+g.output,ie(E);continue}if(M.type==="slash"&&M.prev.type!=="bos"&&C[0]==="/"){let lt=C[1]!==void 0?"|$":"";_.output=_.output.slice(0,-(M.output+g.output).length),M.output=`(?:${M.output}`,g.type="globstar",g.output=`${O(r)}${p}|${p}${lt})`,g.value+=E,_.output+=M.output+g.output,_.globstar=!0,ie(E+ee()),k({type:"slash",value:"/",output:""});continue}if(M.type==="bos"&&C[0]==="/"){g.type="globstar",g.value+=E,g.output=`(?:^|${p}|${O(r)}${p})`,_.output=g.output,_.globstar=!0,ie(E+ee()),k({type:"slash",value:"/",output:""});continue}_.output=_.output.slice(0,-g.output.length),g.type="globstar",g.output=O(r),g.value+=E,_.output+=g.output,_.globstar=!0,ie(E);continue}let $={type:"star",value:E,output:F};if(r.bash===!0){$.output=".*?",(g.type==="bos"||g.type==="slash")&&($.output=A+$.output),k($);continue}if(g&&(g.type==="bracket"||g.type==="paren")&&r.regex===!0){$.output=E,k($);continue}(_.index===_.start||g.type==="slash"||g.type==="dot")&&(g.type==="dot"?(_.output+=y,g.output+=y):r.dot===!0?(_.output+=L,g.output+=L):(_.output+=A,g.output+=A),z()!=="*"&&(_.output+=d,g.output+=d)),k($)}for(;_.brackets>0;){if(r.strictBrackets===!0)throw new SyntaxError(Ye("closing","]"));_.output=he.escapeLast(_.output,"["),_e("brackets")}for(;_.parens>0;){if(r.strictBrackets===!0)throw new SyntaxError(Ye("closing",")"));_.output=he.escapeLast(_.output,"("),_e("parens")}for(;_.braces>0;){if(r.strictBrackets===!0)throw new SyntaxError(Ye("closing","}"));_.output=he.escapeLast(_.output,"{"),_e("braces")}if(r.strictSlashes!==!0&&(g.type==="star"||g.type==="bracket")&&k({type:"maybe_slash",value:"",output:`${p}?`}),_.backtrack===!0){_.output="";for(let C of _.tokens)_.output+=C.output!=null?C.output:C.value,C.suffix&&(_.output+=C.suffix)}return _};kn.fastpaths=(e,t)=>{let r={...t},n=typeof r.maxLength=="number"?Math.min(xt,r.maxLength):xt,i=e.length;if(i>n)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${n}`);e=Un[e]||e;let s=he.isWindows(t),{DOT_LITERAL:a,SLASH_LITERAL:o,ONE_CHAR:l,DOTS_SLASH:c,NO_DOT:h,NO_DOTS:f,NO_DOTS_SLASH:u,STAR:p,START_ANCHOR:d}=mt.globChars(s),m=r.dot?f:h,v=r.dot?u:h,y=r.capture?"":"?:",L={negated:!1,prefix:""},w=r.bash===!0?".*?":p;r.capture&&(w=`(${w})`);let b=A=>A.noglobstar===!0?w:`(${y}(?:(?!${d}${A.dot?c:a}).)*?)`,T=A=>{switch(A){case"*":return`${m}${l}${w}`;case".*":return`${a}${l}${w}`;case"*.*":return`${m}${w}${a}${l}${w}`;case"*/*":return`${m}${w}${o}${l}${v}${w}`;case"**":return m+b(r);case"**/*":return`(?:${m}${b(r)}${o})?${v}${l}${w}`;case"**/*.*":return`(?:${m}${b(r)}${o})?${v}${w}${a}${l}${w}`;case"**/.*":return`(?:${m}${b(r)}${o})?${a}${l}${w}`;default:{let I=/^(.*?)\.(\w+)$/.exec(A);if(!I)return;let F=T(I[1]);return F?F+a+I[2]:void 0}}},x=he.removePrefix(e,L),O=T(x);return O&&r.strictSlashes!==!0&&(O+=`${o}?`),O};Dn.exports=kn});var Yn=Pe((m0,zn)=>{"use strict";var nl=pt(),il=Fn(),lr=Hn(),cr=vt(),sl=Xe(),al=e=>e&&typeof e=="object"&&!Array.isArray(e),X=(e,t,r=!1)=>{if(Array.isArray(e)){let h=e.map(u=>X(u,t,r));return u=>{for(let p of h){let d=p(u);if(d)return d}return!1}}let n=al(e)&&e.tokens&&e.input;if(e===""||typeof e!="string"&&!n)throw new TypeError("Expected pattern to be a non-empty string");let i=t||{},s=cr.isWindows(t),a=n?X.compileRe(e,t):X.makeRe(e,t,!1,!0),o=a.state;delete a.state;let l=()=>!1;if(i.ignore){let h={...t,ignore:null,onMatch:null,onResult:null};l=X(i.ignore,h,r)}let c=(h,f=!1)=>{let{isMatch:u,match:p,output:d}=X.test(h,a,t,{glob:e,posix:s}),m={glob:e,state:o,regex:a,posix:s,input:h,output:d,match:p,isMatch:u};return typeof i.onResult=="function"&&i.onResult(m),u===!1?(m.isMatch=!1,f?m:!1):l(h)?(typeof i.onIgnore=="function"&&i.onIgnore(m),m.isMatch=!1,f?m:!1):(typeof i.onMatch=="function"&&i.onMatch(m),f?m:!0)};return r&&(c.state=o),c};X.test=(e,t,r,{glob:n,posix:i}={})=>{if(typeof e!="string")throw new TypeError("Expected input to be a string");if(e==="")return{isMatch:!1,output:""};let s=r||{},a=s.format||(i?cr.toPosixSlashes:null),o=e===n,l=o&&a?a(e):e;return o===!1&&(l=a?a(e):e,o=l===n),(o===!1||s.capture===!0)&&(s.matchBase===!0||s.basename===!0?o=X.matchBase(e,t,r,i):o=t.exec(l)),{isMatch:Boolean(o),match:o,output:l}};X.matchBase=(e,t,r,n=cr.isWindows(r))=>(t instanceof RegExp?t:X.makeRe(t,r)).test(nl.basename(e));X.isMatch=(e,t,r)=>X(t,r)(e);X.parse=(e,t)=>Array.isArray(e)?e.map(r=>X.parse(r,t)):lr(e,{...t,fastpaths:!1});X.scan=(e,t)=>il(e,t);X.compileRe=(e,t,r=!1,n=!1)=>{if(r===!0)return e.output;let i=t||{},s=i.contains?"":"^",a=i.contains?"":"$",o=`${s}(?:${e.output})${a}`;e&&e.negated===!0&&(o=`^(?!${o}).*$`);let l=X.toRegex(o,t);return n===!0&&(l.state=e),l};X.makeRe=(e,t={},r=!1,n=!1)=>{if(!e||typeof e!="string")throw new TypeError("Expected a non-empty string");let i={negated:!1,fastpaths:!0};return t.fastpaths!==!1&&(e[0]==="."||e[0]==="*")&&(i.output=lr.fastpaths(e,t)),i.output||(i=lr(e,t)),X.compileRe(i,t,r,n)};X.toRegex=(e,t)=>{try{let r=t||{};return new RegExp(e,r.flags||(r.nocase?"i":""))}catch(r){if(t&&t.debug===!0)throw r;return/$^/}};X.constants=sl;zn.exports=X});var Vn=Pe((x0,Gn)=>{"use strict";Gn.exports=Yn()});var js=`<div class="container">
  <label class="hidden" id="title">display-port</label>
  <label class="hidden" id="fps">00</label>
  <label class="hidden" id="dimension">0x0</label>
  <div class="content">
    <canvas> Oh no! Your browser does not support canvas. </canvas>
    <slot id="inner"></slot>
  </div>
  <slot name="frame"></slot>
</div>
`,qs=`:host {
  display: inline-block;
  color: #555555;
}

.container {
  display: flex;
  position: relative;
  width: 100%;
  height: 100%;
}

.content {
  position: relative;
  margin: auto;
}

.content > *:not(canvas) {
  width: 100%;
  height: 100%;
}

canvas {
  background: #000000;
  image-rendering: pixelated;
}

label {
  position: absolute;
  font-family: monospace;
  color: currentColor;
}

#inner {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: 0;
  left: 0;
  pointer-events: none;
}

#title {
  left: 0.5rem;
  top: 0.5rem;
}

#fps {
  right: 0.5rem;
  top: 0.5rem;
}

#dimension {
  left: 0.5rem;
  bottom: 0.5rem;
}

.hidden {
  display: none;
}

:host([debug]) .container {
  outline: 6px dashed rgba(0, 0, 0, 0.1);
  outline-offset: -4px;
  background-color: rgba(0, 0, 0, 0.1);
}

:host([mode='noscale']) canvas {
  margin: 0;
  top: 0;
  left: 0;
}

:host([mode='stretch']) canvas,
:host([mode='scale']) canvas {
  width: 100%;
  height: 100%;
}

:host([mode='fit']),
:host([mode='scale']),
:host([mode='center']),
:host([mode='stretch']),
:host([mode='fill']) {
  width: 100%;
  height: 100%;
}

:host([full]) {
  width: 100vw !important;
  height: 100vh !important;
}

:host([disabled]) {
  display: none;
}

slot {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  pointer-events: none;
}

::slotted(*) {
  pointer-events: auto;
}
`,Zr="noscale",Ht="fit",Jr="scale",en="fill",tn="stretch",Xs=300,Qs=150,Zs=Ht,Js=200,rn=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=js,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=qs,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("display-port",this)}static get observedAttributes(){return["debug","disabled","width","height","onframe","id","class"]}get mode(){return this.getAttribute("mode")}set mode(t){this.setAttribute("mode",t)}get debug(){return this._debug}set debug(t){this.toggleAttribute("debug",t)}get disabled(){return this._disabled}set disabled(t){this.toggleAttribute("disabled",t)}get width(){return this._width}set width(t){this.setAttribute("width",String(t))}get height(){return this._height}set height(t){this.setAttribute("height",String(t))}get onframe(){return this._onframe}set onframe(t){this._onframe&&this.removeEventListener("frame",this._onframe),this._onframe=t,this._onframe&&this.addEventListener("frame",t)}constructor(){super();let t=this.attachShadow({mode:"open"});t.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),t.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._canvasElement=t.querySelector("canvas"),this._contentElement=t.querySelector(".content"),this._innerElement=t.querySelector("#inner"),this._titleElement=t.querySelector("#title"),this._fpsElement=t.querySelector("#fps"),this._dimensionElement=t.querySelector("#dimension"),this._debug=!1,this._disabled=!1,this._width=Xs,this._height=Qs,this._onframe=void 0,this._animationRequestHandle=0,this._prevAnimationFrameTime=0,this._resizeTimeoutHandle=0,this._resizeCanvasWidth=0,this._resizeCanvasHeight=0,this._frameEvent=new CustomEvent("frame",{composed:!0,bubbles:!1,detail:{now:0,prevTime:0,deltaTime:0,canvas:this._canvasElement}}),this._resizeEvent=new CustomEvent("resize",{composed:!0,bubbles:!1,detail:{width:0,height:0}}),this.update=this.update.bind(this),this.onDelayCanvasResize=this.onDelayCanvasResize.bind(this)}get canvas(){return this._canvasElement}connectedCallback(){ze(this,"mode"),ze(this,"debug"),ze(this,"disabled"),ze(this,"width"),ze(this,"height"),ze(this,"onframe"),this.hasAttribute("mode")||this.setAttribute("mode",Zs),this.hasAttribute("tabindex")||this.setAttribute("tabindex","0"),this.updateCanvasSize(!0),this.resume()}disconnectedCallback(){this.pause()}attributeChangedCallback(t,r,n){switch(t){case"debug":this._debug=n!==null;break;case"disabled":this._disabled=n!==null;break;case"width":this._width=Number(n);break;case"height":this._height=Number(n);break;case"onframe":this.onframe=new Function("event","with(document){with(this){"+n+"}}").bind(this);break}switch(t){case"disabled":n?(this.update(0),this.pause()):this.resume();break;case"id":case"class":this._titleElement.innerHTML=`display-port${this.className?"."+this.className:""}${this.hasAttribute("id")?"#"+this.getAttribute("id"):""}`;break;case"debug":this._titleElement.classList.toggle("hidden",n),this._fpsElement.classList.toggle("hidden",n),this._dimensionElement.classList.toggle("hidden",n);break}}getContext(t="2d",r=void 0){return this._canvasElement.getContext(t,r)}pause(){cancelAnimationFrame(this._animationRequestHandle)}resume(){this._animationRequestHandle=requestAnimationFrame(this.update)}update(t){this._animationRequestHandle=requestAnimationFrame(this.update),this.updateCanvasSize(!1);let r=t-this._prevAnimationFrameTime;if(this._prevAnimationFrameTime=t,this._debug){let s=r<=0?"--":String(Math.round(1e3/r)).padStart(2,"0");if(this._fpsElement.textContent!==s&&(this._fpsElement.textContent=s),this.mode===Zr){let o=`${this._width}x${this._height}`;this._dimensionElement.textContent!==o&&(this._dimensionElement.textContent=o)}else{let o=`${this._width}x${this._height}|${this.shadowRoot.host.clientWidth}x${this.shadowRoot.host.clientHeight}`;this._dimensionElement.textContent!==o&&(this._dimensionElement.textContent=o)}}let i=this._frameEvent.detail;i.now=t,i.prevTime=this._prevAnimationFrameTime,i.deltaTime=r,this.dispatchEvent(this._frameEvent)}onDelayCanvasResize(){this._resizeTimeoutHandle=0,this.updateCanvasSize(!0)}delayCanvasResize(t,r){(t!==this._resizeCanvasWidth||r!==this._resizeCanvasHeight)&&(this._resizeCanvasWidth=t,this._resizeCanvasHeight=r,this._resizeTimeoutHandle&&clearTimeout(this._resizeTimeoutHandle),this._resizeTimeoutHandle=setTimeout(this.onDelayCanvasResize,Js))}updateCanvasSize(t=!0){let r=this.shadowRoot.host.getBoundingClientRect(),n=r.width,i=r.height,s=this._canvasElement,a=this._width,o=this._height,l=this.mode;if(l===tn||l===en)a=n,o=i;else if(l!==Zr&&(n<a||i<o||l===Ht||l==Jr)){let h=n/a,f=i/o;h<f?(a=n,o=o*h):(a=a*f,o=i)}if(a=Math.floor(a),o=Math.floor(o),typeof t=="undefined"&&(t=s.clientWidth!==a||s.clientHeight!==o),!t){this.delayCanvasResize(a,o);return}let c=Math.min(a/this._width,o/this._height)*.5;if(this._innerElement.style.fontSize=`font-size: ${c}em`,t){l===Jr?(s.width=this._width,s.height=this._height):l!==tn&&(s.width=a,s.height=o);let h=this._contentElement.style;h.width=`${a}px`,h.height=`${o}px`,(l===Ht||l===en)&&(this._width=a,this._height=o);let u=this._resizeEvent.detail;u.width=a,u.height=o,this.dispatchEvent(this._resizeEvent)}}};rn.define();function ze(e,t){if(Object.prototype.hasOwnProperty.call(e,t)){let r=e[t];delete e[t],e[t]=r}}var zt=class{get polling(){return performance.now()-this._lastPollingTime<1e3}get value(){return 0}get size(){return this._size}constructor(t){this._size=t,this._lastPollingTime=Number.MIN_SAFE_INTEGER}resize(t){this._size=t}getState(t){throw new Error("Missing implementation.")}onUpdate(t,r,n){throw new Error("Missing implementation.")}onStatus(t,r){throw new Error("Missing implementation.")}onPoll(t){this._lastPollingTime=t}onBind(t,r={}){t>=this._size&&this.resize(t+1)}onUnbind(){this.resize(0)}},qe=class extends zt{static createAxisBindingState(){return{value:0,delta:0,inverted:!1}}get delta(){return this._delta}get value(){return this._value}constructor(t=0){super(t);let r=new Array;for(let n=0;n<t;++n)r.push(this.constructor.createAxisBindingState());this._state=r,this._value=0,this._delta=0}resize(t){let r=this._state,n=r.length,i;if(t<=n)i=r.slice(0,t);else{i=r;for(let s=n;s<t;++s)i.push(this.constructor.createAxisBindingState())}this._state=i,super.resize(t)}getState(t){return this._state[t].value}onPoll(t){let r=this._state,n=0,i=0,s=r.length;for(let a=0;a<s;++a){let o=r[a];n+=o.value*(o.inverted?-1:1),i+=o.delta,r[a].delta=0}this._value=n,this._delta=i,super.onPoll(t)}onUpdate(t,r,n){typeof r=="undefined"?this.onAxisChange(t,n):this.onAxisMove(t,r,n)}onStatus(t,r){this.onAxisStatus(t,r)}onBind(t,r={}){super.onBind(t,r);let{inverted:n=!1}=r,i=this._state;i[t].inverted=n}onAxisMove(t,r,n){let i=this._state[t];i.value=r,i.delta+=n}onAxisChange(t,r){let n=this._state[t];n.value+=r,n.delta+=r}onAxisStatus(t,r){let n=this._state[t],i=n.value;n.value=r,n.delta=r-i}},ea=241,nn=254,ta=239,De=1,Yt=2,Gt=4,Vt=8,Kt=16,ht=class extends zt{get pressed(){return this._pressed}get repeated(){return this._repeated}get released(){return this._released}get down(){return this._down}get value(){return this._value}constructor(t=0){super(t);this._state=new Uint8Array(t),this._value=0,this._down=!1,this._pressed=!1,this._repeated=!1,this._released=!1}resize(t){let r=this._state,n=r.length,i;t<=n?i=r.slice(0,t):(i=new Uint8Array(t),i.set(r)),this._state=i,super.resize(t)}getState(t){let r=this._state[t],n=r&Kt?-1:1;return(r&De?1:0)*n}onPoll(t){let r=this._state,n=0,i=0,s=0,a=0,o=0,l=r.length;for(let c=0;c<l;++c){let h=r[c],f=h&De,u=h&Kt;i|=f,s|=h&Yt,a|=h&Gt,o|=h&Vt,n+=(f?1:0)*(u?-1:1),r[c]&=ea}this._value=n,this._down=i!==0,this._pressed=s!==0,this._repeated=a!==0,this._released=o!==0,super.onPoll(t)}onUpdate(t,r,n){n>0?this.onButtonPressed(t):this.onButtonReleased(t)}onStatus(t,r){this.onButtonStatus(t,r!==0)}onBind(t,r={}){super.onBind(t,r);let{inverted:n=!1}=r,i=this._state;n?i[t]|=Kt:i[t]&=ta}onButtonPressed(t){let r=this._state,n=r[t];n&De||(n|=Yt,n|=De),n|=Gt,r[t]=n}onButtonReleased(t){let r=this._state,n=r[t];n&De&&(n|=Vt,n&=nn),r[t]=n}onButtonStatus(t,r){let n=this._state,i=n[t],s=Boolean(i&De);r?i|=De:i&=nn,s&&!r&&(i|=Vt),!s&&r&&(i|=Yt,i|=Gt),n[t]=i}},R=class{static parse(t){t=t.trim();let r=t.indexOf(".");if(r<0)throw new Error("Missing device separator for key code.");let n=t.substring(0,r);if(n.length<0)throw new Error("Missing device for key code.");let i=t.substring(r+1);if(i.length<0)throw new Error("Missing code for key code.");return new R(n,i)}constructor(t,r){this.device=t,this.code=r}toString(){return`${this.device}.${this.code}`}};function sn(e,t){return new R(e,t)}function ra(e){return"device"in e&&"code"in e}var N="Keyboard",pe="Mouse",na=new R(N,"KeyA"),ia=new R(N,"KeyB"),sa=new R(N,"KeyC"),aa=new R(N,"KeyD"),oa=new R(N,"KeyE"),la=new R(N,"KeyF"),ca=new R(N,"KeyG"),ha=new R(N,"KeyH"),fa=new R(N,"KeyI"),ua=new R(N,"KeyJ"),pa=new R(N,"KeyK"),da=new R(N,"KeyL"),va=new R(N,"KeyM"),ma=new R(N,"KeyN"),xa=new R(N,"KeyO"),_a=new R(N,"KeyP"),ga=new R(N,"KeyQ"),Ea=new R(N,"KeyR"),ya=new R(N,"KeyS"),Aa=new R(N,"KeyT"),wa=new R(N,"KeyU"),Ta=new R(N,"KeyV"),Ma=new R(N,"KeyW"),ba=new R(N,"KeyX"),Sa=new R(N,"KeyY"),Ra=new R(N,"KeyZ"),Ia=new R(N,"Digit0"),La=new R(N,"Digit1"),Ca=new R(N,"Digit2"),Oa=new R(N,"Digit3"),Na=new R(N,"Digit4"),Ba=new R(N,"Digit5"),Pa=new R(N,"Digit6"),Fa=new R(N,"Digit7"),Da=new R(N,"Digit8"),Ua=new R(N,"Digit9"),ka=new R(N,"Minus"),Ha=new R(N,"Equal"),za=new R(N,"BracketLeft"),Ya=new R(N,"BracketRight"),Ga=new R(N,"Semicolon"),Va=new R(N,"Quote"),Ka=new R(N,"Backquote"),$a=new R(N,"Backslash"),Wa=new R(N,"Comma"),ja=new R(N,"Period"),qa=new R(N,"Slash"),Xa=new R(N,"Escape"),Qa=new R(N,"Space"),Za=new R(N,"CapsLock"),Ja=new R(N,"Backspace"),eo=new R(N,"Delete"),to=new R(N,"Tab"),ro=new R(N,"Enter"),no=new R(N,"ArrowUp"),io=new R(N,"ArrowDown"),so=new R(N,"ArrowLeft"),ao=new R(N,"ArrowRight"),oo=new R(pe,"Button0"),lo=new R(pe,"Button1"),co=new R(pe,"Button2"),ho=new R(pe,"Button3"),fo=new R(pe,"Button4"),uo=new R(pe,"PosX"),po=new R(pe,"PosY"),vo=new R(pe,"WheelX"),mo=new R(pe,"WheelY"),xo=new R(pe,"WheelZ"),Me=Object.freeze({__proto__:null,from:sn,isKeyCode:ra,KEYBOARD:N,MOUSE:pe,KEY_A:na,KEY_B:ia,KEY_C:sa,KEY_D:aa,KEY_E:oa,KEY_F:la,KEY_G:ca,KEY_H:ha,KEY_I:fa,KEY_J:ua,KEY_K:pa,KEY_L:da,KEY_M:va,KEY_N:ma,KEY_O:xa,KEY_P:_a,KEY_Q:ga,KEY_R:Ea,KEY_S:ya,KEY_T:Aa,KEY_U:wa,KEY_V:Ta,KEY_W:Ma,KEY_X:ba,KEY_Y:Sa,KEY_Z:Ra,DIGIT_0:Ia,DIGIT_1:La,DIGIT_2:Ca,DIGIT_3:Oa,DIGIT_4:Na,DIGIT_5:Ba,DIGIT_6:Pa,DIGIT_7:Fa,DIGIT_8:Da,DIGIT_9:Ua,MINUS:ka,EQUAL:Ha,BRACKET_LEFT:za,BRACKET_RIGHT:Ya,SEMICOLON:Ga,QUOTE:Va,BACKQUOTE:Ka,BACKSLASH:$a,COMMA:Wa,PERIOD:ja,SLASH:qa,ESCAPE:Xa,SPACE:Qa,CAPS_LOCK:Za,BACKSPACE:Ja,DELETE:eo,TAB:to,ENTER:ro,ARROW_UP:no,ARROW_DOWN:io,ARROW_LEFT:so,ARROW_RIGHT:ao,MOUSE_BUTTON_0:oo,MOUSE_BUTTON_1:lo,MOUSE_BUTTON_2:co,MOUSE_BUTTON_3:ho,MOUSE_BUTTON_4:fo,MOUSE_POS_X:uo,MOUSE_POS_Y:po,MOUSE_WHEEL_X:vo,MOUSE_WHEEL_Y:mo,MOUSE_WHEEL_Z:xo}),an=class{get polling(){return this.ref?this.ref.polling:!1}get value(){return!this.ref||this.disabled?0:this.ref.value}constructor(t){this.name=t,this.ref=null,this.disabled=!1}register(t){throw new Error("Unsupported operation.")}disable(t=!0){return this.disabled=t,this}getState(t){return!this.ref||this.disabled?0:this.ref.getState(t)}};function go(e){Array.isArray(e)||(e=[e]);let t=[];for(let r of e){let n;try{n=R.parse(r)}catch(i){let s=_o(r).toUpperCase();if(!(s in Me))throw new Error("Invalid key code string - "+i);n=Me[s]}t.push(n)}return t}function _o(e){return e.replace(/([a-z]|(?:[A-Z0-9]+))([A-Z0-9]|$)/g,function(t,r,n){return r+(n&&"_"+n)}).toLowerCase()}var be=class extends an{static fromBind(t,r,n,i=void 0){return new be(t,sn(r,n),i)}static fromString(t,...r){let n=go(r);return new be(t,n)}get pressed(){return!this.ref||this.disabled?!1:this.ref.pressed}get repeated(){return!this.ref||this.disabled?!1:this.ref.repeated}get released(){return!this.ref||this.disabled?!1:this.ref.released}get down(){return!this.ref||this.disabled?!1:this.ref.down}constructor(t,r,n=void 0){super(t);this.keyCodes=Array.isArray(r)?r:[r],this.opts=n}register(t){let r=this.name,n=this.opts;for(let i of this.keyCodes)t.bindButton(r,i.device,i.code,n);return this.ref=t.getButton(r),this}};var $t=class{static isAxis(t){return!1}static isButton(t){return!1}constructor(t,r){if(!r)throw new Error(`Missing event target for device ${t}.`);this.name=t,this.eventTarget=r,this.listeners={input:[]}}setEventTarget(t){if(!t)throw new Error(`Missing event target for device ${this.name}.`);this.eventTarget=t}destroy(){let t=this.listeners;for(let r in t)t[r].length=0}addEventListener(t,r){let n=this.listeners;t in n?n[t].push(r):n[t]=[r]}removeEventListener(t,r){let n=this.listeners;if(t in n){let i=n[t],s=i.indexOf(r);s>=0&&i.splice(s,1)}}dispatchInputEvent(t){let r=0;for(let n of this.listeners.input)r|=n(t);return Boolean(r)}},on=class extends $t{static isAxis(t){return!1}static isButton(t){return!0}constructor(t,r,n={}){super(t,r);let{ignoreRepeat:i=!0}=n;this.ignoreRepeat=i,this._eventObject={target:r,device:t,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),r.addEventListener("keydown",this.onKeyDown),r.addEventListener("keyup",this.onKeyUp)}setEventTarget(t){this.eventTarget&&this.destroy(),super.setEventTarget(t),t.addEventListener("keydown",this.onKeyDown),t.addEventListener("keyup",this.onKeyUp)}destroy(){let t=this.eventTarget;t.removeEventListener("keydown",this.onKeyDown),t.removeEventListener("keyup",this.onKeyUp),super.destroy()}onKeyDown(t){if(t.repeat&&this.ignoreRepeat)return t.preventDefault(),t.stopPropagation(),!1;let r=this._eventObject;if(r.code=t.code,r.event="pressed",r.value=1,r.control=t.ctrlKey,r.shift=t.shiftKey,r.alt=t.altKey,this.dispatchInputEvent(r))return t.preventDefault(),t.stopPropagation(),!1}onKeyUp(t){let r=this._eventObject;if(r.code=t.code,r.event="released",r.value=1,r.control=t.ctrlKey,r.shift=t.shiftKey,r.alt=t.altKey,this.dispatchInputEvent(r))return t.preventDefault(),t.stopPropagation(),!1}},Wt=10,jt=100,ln=class extends $t{static isAxis(t){return t==="PosX"||t==="PosY"||t==="WheelX"||t==="WheelY"||t==="WheelZ"}static isButton(t){return!this.isAxis(t)}constructor(t,r,n={}){super(t,r);let{eventsOnFocus:i=!0}=n;this.eventsOnFocus=i,this.canvasTarget=this.getCanvasFromEventTarget(r),this._downHasFocus=!1,this._eventObject={target:r,device:t,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this._positionObject={target:r,device:t,code:"",event:"move",value:0,movement:0},this._wheelObject={target:r,device:t,code:"",event:"wheel",movement:0},this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onWheel=this.onWheel.bind(this),r.addEventListener("mousedown",this.onMouseDown),r.addEventListener("contextmenu",this.onContextMenu),r.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}setEventTarget(t){this.eventTarget&&this.destroy(),super.setEventTarget(t),this.canvasTarget=this.getCanvasFromEventTarget(t),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("contextmenu",this.onContextMenu),t.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}destroy(){let t=this.eventTarget;t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("contextmenu",this.onContextMenu),t.removeEventListener("wheel",this.onWheel),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),super.destroy()}setPointerLock(t=!0){t?this.eventTarget.requestPointerLock():this.eventTarget.exitPointerLock()}hasPointerLock(){return document.pointerLockElement===this.eventTarget}onMouseDown(t){this._downHasFocus=!0;let r=this._eventObject;if(r.code="Button"+t.button,r.event="pressed",r.value=1,r.control=t.ctrlKey,r.shift=t.shiftKey,r.alt=t.altKey,this.dispatchInputEvent(r)&&document.activeElement===this.eventTarget)return t.preventDefault(),t.stopPropagation(),!1}onContextMenu(t){return t.preventDefault(),t.stopPropagation(),!1}onWheel(t){let r,n,i;switch(t.deltaMode){case WheelEvent.DOM_DELTA_LINE:r=t.deltaX*Wt,n=t.deltaY*Wt,i=t.deltaZ*Wt;break;case WheelEvent.DOM_DELTA_PAGE:r=t.deltaX*jt,n=t.deltaY*jt,i=t.deltaZ*jt;break;case WheelEvent.DOM_DELTA_PIXEL:default:r=t.deltaX,n=t.deltaY,i=t.deltaZ;break}let s=0,a=this._wheelObject;if(a.code="WheelX",a.movement=r,s|=this.dispatchInputEvent(a),a.code="WheelY",a.movement=n,s|=this.dispatchInputEvent(a),a.code="WheelZ",a.movement=i,s|=this.dispatchInputEvent(a),s)return t.preventDefault(),t.stopPropagation(),!1}onMouseUp(t){if(!this._downHasFocus)return;this._downHasFocus=!1;let r=this._eventObject;if(r.code="Button"+t.button,r.event="released",r.value=1,r.control=t.ctrlKey,r.shift=t.shiftKey,r.alt=t.altKey,this.dispatchInputEvent(r))return t.preventDefault(),t.stopPropagation(),!1}onMouseMove(t){if(this.eventsOnFocus&&document.activeElement!==this.eventTarget)return;let r=this.canvasTarget,{clientWidth:n,clientHeight:i}=r,s=r.getBoundingClientRect(),a=t.movementX/n,o=t.movementY/i,l=(t.clientX-s.left)/n,c=(t.clientY-s.top)/i,h=this._positionObject;h.code="PosX",h.value=l,h.movement=a,this.dispatchInputEvent(h),h.code="PosY",h.value=c,h.movement=o,this.dispatchInputEvent(h)}getCanvasFromEventTarget(t){return t instanceof HTMLCanvasElement?t:t.canvas||t.querySelector("canvas")||t.shadowRoot&&t.shadowRoot.querySelector("canvas")||t}},Eo=`<kbd>
  <span id="name"><slot></slot></span>
  <span id="value" class="hidden"></span>
</kbd>
`,yo=`kbd {
  position: relative;
  display: inline-block;
  border-radius: 3px;
  border: 1px solid #888888;
  font-size: 0.85em;
  font-weight: 700;
  text-rendering: optimizeLegibility;
  line-height: 12px;
  height: 14px;
  padding: 2px 4px;
  color: #444444;
  background-color: #eeeeee;
  box-shadow: inset 0 -3px 0 #aaaaaa;
  overflow: hidden;
}

kbd:empty::after {
  content: '<?>';
  opacity: 0.6;
}

.disabled {
  opacity: 0.6;
  box-shadow: none;
  background-color: #aaaaaa;
}

.hidden {
  display: none;
}

#value {
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  font-size: 0.85em;
  padding: 0 4px;
  padding-top: 2px;
  color: #cccccc;
  background-color: #333333;
  box-shadow: inset 0 3px 0 #222222;
}
`,qt=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=Eo,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=yo,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("input-code",this)}static get observedAttributes(){return["name","value","disabled"]}get disabled(){return this._disabled}set disabled(t){this.toggleAttribute("disabled",t)}get value(){return this._value}set value(t){this.setAttribute("value",t)}get name(){return this._name}set name(t){this.setAttribute("name",t)}constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._name="",this._value="",this._disabled=!1,this._kbdElement=this.shadowRoot.querySelector("kbd"),this._nameElement=this.shadowRoot.querySelector("#name"),this._valueElement=this.shadowRoot.querySelector("#value")}attributeChangedCallback(t,r,n){switch(t){case"name":this._name=n,this._nameElement.textContent=n;break;case"value":this._value=n,n!==null?(this._valueElement.classList.toggle("hidden",!1),this._valueElement.textContent=n,this._kbdElement.style.paddingRight=`${this._valueElement.clientWidth+4}px`):this._valueElement.classList.toggle("hidden",!0);break;case"disabled":this._disabled=n!==null,this._kbdElement.classList.toggle("disabled",n!==null);break}}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"name")){let t=this.name;delete this.name,this.name=t}if(Object.prototype.hasOwnProperty.call(this,"value")){let t=this.value;delete this.value,this.value=t}if(Object.prototype.hasOwnProperty.call(this,"disabled")){let t=this.disabled;delete this.disabled,this.disabled=t}}};qt.define();var Ao=`<table>
  <thead>
    <tr class="tableHeader">
      <th colspan="3">
        <span class="tableTitle">
          <label id="title"> input-source </label>
          <span id="slotContainer">
            <slot></slot>
          </span>
          <p>
            <label for="poll">poll</label>
            <output id="poll"></output>
          </p>
          <p>
            <label for="focus">focus</label>
            <output id="focus"></output>
          </p>
        </span>
      </th>
    </tr>
    <tr class="colHeader">
      <th>name</th>
      <th>value</th>
      <th>key</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
`,wo=`:host {
  display: block;
}

table {
  border-collapse: collapse;
  font-family: monospace;
}

table,
th,
td {
  border: 1px solid #666666;
}

th,
td {
  padding: 5px 10px;
}

td {
  text-align: center;
}

thead th {
  padding: 0;
}

.colHeader > th {
  font-size: 0.8em;
  padding: 0 10px;
  letter-spacing: 3px;
  background-color: #aaaaaa;
  color: #666666;
}

tbody output {
  border-radius: 0.3em;
  padding: 3px;
}

tr:not(.primary) .name,
tr:not(.primary) .value {
  opacity: 0.3;
}

tr:nth-child(2n) {
  background-color: #eeeeee;
}

.tableHeader {
  color: #666666;
}

.tableTitle {
  display: flex;
  flex-direction: row;
  align-items: center;
  padding: 4px;
}

#slotContainer {
  flex: 1;
}

p {
  display: inline;
  margin: 0;
  padding: 0;
  padding-right: 10px;
}

#poll:empty::after,
#focus:empty::after {
  content: '\u2717';
  color: #ff0000;
}
`,cn=class{constructor(t){this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null,this.pollable=t}get running(){return this.animationFrameHandle!==null}start(){let t=this.animationFrameHandle;t&&cancelAnimationFrame(t),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}stop(){let t=this.animationFrameHandle;t&&cancelAnimationFrame(t),this.animationFrameHandle=null}onAnimationFrame(t){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.pollable.onPoll(t)}},hn=class{constructor(t){this.onInput=this.onInput.bind(this),this.onPoll=this.onPoll.bind(this),this.bindings=t}onPoll(t){for(let r of this.bindings.getInputs())r.onPoll(t)}onInput(t){let{device:r,code:n,event:i,value:s,movement:a,control:o,shift:l,alt:c}=t,h=this.bindings.getBindings(r,n);switch(i){case"pressed":for(let{input:f,index:u}of h)f.onUpdate(u,1,1);break;case"released":for(let{input:f,index:u}of h)f.onUpdate(u,0,-1);break;case"move":for(let{input:f,index:u}of h)f.onUpdate(u,s,a);break;case"wheel":for(let{input:f,index:u}of h)f.onUpdate(u,void 0,a);break}return h.length>0}},Xt=class{constructor(t,r,n,i){this.device=t,this.code=r,this.input=n,this.index=i}},fn=class{constructor(){this.bindingMap={},this.inputMap=new Map}clear(){for(let t of this.inputMap.keys())t.onUnbind();this.inputMap.clear(),this.bindingMap={}}bind(t,r,n,i={inverted:!1}){let s,a=this.inputMap;if(a.has(t)){let l=a.get(t),c=t.size;t.onBind(c,i),s=new Xt(r,n,t,c),l.push(s)}else{let l=[];a.set(t,l);let c=0;t.onBind(c,i),s=new Xt(r,n,t,c),l.push(s)}let o=this.bindingMap;r in o?n in o[r]?o[r][n].push(s):o[r][n]=[s]:o[r]={[n]:[s]}}unbind(t){let r=this.inputMap;if(r.has(t)){let n=this.bindingMap,i=r.get(t);for(let s of i){let{device:a,code:o}=s,l=n[a][o],c=l.indexOf(s);l.splice(c,1)}i.length=0,t.onUnbind(),r.delete(t)}}isBound(t){return this.inputMap.has(t)}getInputs(){return this.inputMap.keys()}getBindingsByInput(t){return this.inputMap.get(t)}getBindings(t,r){let n=this.bindingMap;if(t in n){let i=n[t];if(r in i)return i[r]}return[]}},un=class{constructor(t,r={}){this.inputs={},this.devices=[new ln("Mouse",t),new on("Keyboard",t)],this.bindings=new fn,this.adapter=new hn(this.bindings),this.autopoller=new cn(this.adapter),this.eventTarget=t,this.anyButton=new ht(1),this.anyButtonDevice="",this.anyButtonCode="",this.anyAxis=new qe(1),this.anyAxisDevice="",this.anyAxisCode="",this.listeners={bind:[],unbind:[],focus:[],blur:[]},this.onInput=this.onInput.bind(this),this.onEventTargetBlur=this.onEventTargetBlur.bind(this),this.onEventTargetFocus=this.onEventTargetFocus.bind(this),t.addEventListener("focus",this.onEventTargetFocus),t.addEventListener("blur",this.onEventTargetBlur);for(let n of this.devices)n.addEventListener("input",this.onInput)}get autopoll(){return this.autopoller.running}set autopoll(t){this.toggleAutoPoll(t)}destroy(){let t=this.listeners;for(let n in t)t[n].length=0;this.autopoller.running&&this.autopoller.stop();for(let n of this.devices)n.removeEventListener("input",this.onInput),n.destroy();let r=this.eventTarget;r.removeEventListener("focus",this.onEventTargetFocus),r.removeEventListener("blur",this.onEventTargetBlur)}setEventTarget(t){let r=this.eventTarget;r.removeEventListener("focus",this.onEventTargetFocus),r.removeEventListener("blur",this.onEventTargetBlur),this.eventTarget=t;for(let n of this.devices)n.setEventTarget(t);t.addEventListener("focus",this.onEventTargetFocus),t.addEventListener("blur",this.onEventTargetBlur)}toggleAutoPoll(t=void 0){let r=this.autopoller.running,n=typeof t=="undefined"?!r:Boolean(t);n!==r&&(n?this.autopoller.start():this.autopoller.stop())}addEventListener(t,r){let n=this.listeners;t in n?n[t].push(r):n[t]=[r]}removeEventListener(t,r){let n=this.listeners;if(t in n){let i=n[t],s=i.indexOf(r);s>=0&&i.splice(s,1)}}dispatchEvent(t){let{type:r}=t,n=0;for(let i of this.listeners[r])n|=i(t)?1:0;return Boolean(n)}poll(t=performance.now()){if(this.autopoller.running)throw new Error("Should not manually poll() while autopolling.");this.onPoll(t)}onInput(t){let r=this.adapter.onInput(t);switch(t.event){case"pressed":this.anyButtonDevice=t.device,this.anyButtonCode=t.code,this.anyButton.onUpdate(0,1,1);break;case"released":this.anyButtonDevice=t.device,this.anyButtonCode=t.code,this.anyButton.onUpdate(0,0,-1);break;case"move":case"wheel":this.anyAxisDevice=t.device,this.anyAxisCode=t.code,this.anyAxis.onUpdate(0,t.value,t.movement);break}return r}onPoll(t){this.adapter.onPoll(t),this.anyButton.onPoll(t),this.anyAxis.onPoll(t)}onBind(){this.dispatchEvent({type:"bind"})}onUnbind(){this.dispatchEvent({type:"unbind"})}onEventTargetFocus(){this.dispatchEvent({type:"focus"})}onEventTargetBlur(){for(let t of this.bindings.getInputs())t.onStatus(0,0);this.anyButton.onStatus(0,0),this.anyAxis.onStatus(0,0),this.dispatchEvent({type:"blur"})}bindBindings(t){for(let r of t)r.register(this)}bindButton(t,r,n,i=void 0){let s;this.hasButton(t)?s=this.getButton(t):(s=new ht(1),this.inputs[t]=s),this.bindings.bind(s,r,n,i),this.onBind()}bindAxis(t,r,n,i=void 0){let s;this.hasAxis(t)?s=this.getAxis(t):(s=new qe(1),this.inputs[t]=s),this.bindings.bind(s,r,n,i),this.onBind()}bindAxisButtons(t,r,n,i){let s;this.hasAxis(t)?s=this.getAxis(t):(s=new qe(2),this.inputs[t]=s),this.bindings.bind(s,r,i),this.bindings.bind(s,r,n,{inverted:!0}),this.onBind()}unbindButton(t){if(this.hasButton(t)){let r=this.getButton(t);delete this.inputs[t],this.bindings.unbind(r),this.onUnbind()}}unbindAxis(t){if(this.hasAxis(t)){let r=this.getAxis(t);delete this.inputs[t],this.bindings.unbind(r),this.onUnbind()}}getInput(t){return this.inputs[t]}getButton(t){return this.inputs[t]}getAxis(t){return this.inputs[t]}hasButton(t){return t in this.inputs&&this.inputs[t]instanceof ht}hasAxis(t){return t in this.inputs&&this.inputs[t]instanceof qe}isButtonDown(t){return this.inputs[t].down}isButtonPressed(t){return this.inputs[t].pressed}isButtonReleased(t){return this.inputs[t].released}getInputValue(t){return this.inputs[t].value}getButtonValue(t){return this.inputs[t].value}getAxisValue(t){return this.inputs[t].value}getAxisDelta(t){return this.inputs[t].delta}isAnyButtonDown(t=void 0){if(typeof t=="undefined")return this.anyButton.down;{let r=this.inputs;for(let n of t)if(r[n].down)return!0}return!1}isAnyButtonPressed(t=void 0){if(typeof t=="undefined")return this.anyButton.pressed;{let r=this.inputs;for(let n of t)if(r[n].pressed)return!0}return!1}isAnyButtonReleased(t=void 0){if(typeof t=="undefined")return this.anyButton.released;{let r=this.inputs;for(let n of t)if(r[n].released)return!0}return!1}getAnyAxisValue(t=void 0){if(typeof t=="undefined")return this.anyAxis.value;{let r=this.inputs;for(let n of t){let i=r[n];if(i.value)return i.value}}return 0}getAnyAxisDelta(t=void 0){if(typeof t=="undefined")return this.anyAxis.delta;{let r=this.inputs;for(let n of t){let i=r[n];if(i.delta)return i.delta}}return 0}getLastButtonDevice(){return this.anyButtonDevice}getLastButtonCode(){return this.anyButtonCode}getLastAxisDevice(){return this.anyAxisDevice}getLastAxisCode(){return this.anyAxisCode}getMouse(){return this.devices[0]}getKeyboard(){return this.devices[1]}},pn=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=Ao,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=wo,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("input-port",this)}static get observedAttributes(){return["autopoll","for"]}get autopoll(){return this._autopoll}set autopoll(t){this.toggleAttribute("autopoll",t)}get for(){return this._for}set for(t){this.setAttribute("for",t)}constructor(){super();let t=this.attachShadow({mode:"open"});t.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),t.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._titleElement=t.querySelector("#title"),this._pollElement=t.querySelector("#poll"),this._focusElement=t.querySelector("#focus"),this._bodyElement=t.querySelector("tbody"),this._outputElements={},this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null;let r=this;this._for="",this._eventTarget=r,this._autopoll=!1,this._context=null,this.onInputContextBind=this.onInputContextBind.bind(this),this.onInputContextUnbind=this.onInputContextUnbind.bind(this),this.onInputContextFocus=this.onInputContextFocus.bind(this),this.onInputContextBlur=this.onInputContextBlur.bind(this)}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"for")){let t=this.for;delete this.for,this.for=t}if(Object.prototype.hasOwnProperty.call(this,"autopoll")){let t=this.autopoll;delete this.autopoll,this.autopoll=t}this.updateTable(),this.updateTableValues(),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}disconnectedCallback(){let t=this._context;t&&(t.removeEventListener("bind",this.onInputContextBind),t.removeEventListener("unbind",this.onInputContextUnbind),t.removeEventListener("blur",this.onInputContextBlur),t.removeEventListener("focus",this.onInputContextFocus),t.destroy(),this._context=null)}attributeChangedCallback(t,r,n){switch(t){case"for":{this._for=n;let i,s;n?(i=document.getElementById(n),s=`${i.tagName.toLowerCase()}#${n}`):(i=this,s="input-port"),this._eventTarget=i,this._context&&this._context.setEventTarget(this._eventTarget),this._titleElement.innerHTML=`for ${s}`}break;case"autopoll":this._autopoll=n!==null,this._context&&this._context.toggleAutoPoll(this._autopoll);break}}onAnimationFrame(){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.updateTableValues(),this.updatePollStatus()}onInputContextBind(){return this.updateTable(),!0}onInputContextUnbind(){return this.updateTable(),!0}onInputContextFocus(){return this._focusElement.innerHTML="\u2713",!0}onInputContextBlur(){return this._focusElement.innerHTML="",!0}getContext(t="axisbutton",r=void 0){switch(t){case"axisbutton":if(!this._context){let n=new un(this._eventTarget,r);n.addEventListener("bind",this.onInputContextBind),n.addEventListener("unbind",this.onInputContextUnbind),n.addEventListener("blur",this.onInputContextBlur),n.addEventListener("focus",this.onInputContextFocus),this._autopoll&&n.toggleAutoPoll(!0),this._context=n}return this._context;default:throw new Error(`Input context id '${t}' is not supported.`)}}updateTable(){if(this.isConnected)if(this._context){let t=this._context,r=t.inputs,n=t.bindings,i={},s=[];for(let a of Object.keys(r)){let o=r[a],l=!0;for(let c of n.getBindingsByInput(o)){let h=To(`${o.constructor.name}.${a}`,`${c.device}.${c.code}`,0,l);s.push(h),l&&(i[a]=h.querySelector("output"),l=!1)}}this._outputElements=i,this._bodyElement.innerHTML="";for(let a of s)this._bodyElement.appendChild(a)}else{this._outputElements={},this._bodyElement.innerHTML="";return}else return}updateTableValues(){if(this.isConnected)if(this._context){let r=this._context.inputs;for(let n of Object.keys(this._outputElements)){let i=this._outputElements[n],s=r[n].value;i.innerText=Number(s).toFixed(2)}}else{for(let t of Object.keys(this._outputElements)){let r=this._outputElements[t];r.innerText="---"}return}else return}updatePollStatus(){if(this.isConnected)if(this._context){let r=this._context.inputs;for(let n of Object.values(r))if(!n.polling){this._pollElement.innerHTML="";return}this._pollElement.innerHTML="\u2713"}else{this._pollElement.innerHTML="-";return}else return}};pn.define();function To(e,t,r,n=!0){let i=document.createElement("tr");n&&i.classList.add("primary");{let s=document.createElement("td");s.textContent=e,s.classList.add("name"),i.appendChild(s)}{let s=document.createElement("td"),a=document.createElement("output");n?a.innerText=Number(r).toFixed(2):a.innerText="---",a.classList.add("value"),s.appendChild(a),i.appendChild(s)}{let s=document.createElement("td");s.classList.add("key");let a=new qt;a.innerText=t,s.appendChild(a),i.appendChild(s)}return i}var c0=Symbol("keyboardSource");var h0=Symbol("mouseSource");var Al=Ws(Vn());var Kn={},ol=function(e,t,r,n,i){var s=new Worker(Kn[t]||(Kn[t]=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))));return s.onerror=function(a){return i(a.error,null)},s.onmessage=function(a){return i(null,a.data)},s.postMessage(r,n),s},se=Uint8Array,Ee=Uint16Array,Ze=Uint32Array,hr=new se([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fr=new se([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),$n=new se([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Wn=function(e,t){for(var r=new Ee(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var i=new Ze(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)i[s]=s-r[n]<<5|n;return[r,i]},jn=Wn(hr,2),ur=jn[0],ll=jn[1];ur[28]=258,ll[258]=28;var qn=Wn(fr,0),Xn=qn[0],g0=qn[1],_t=new Ee(32768);for(var W=0;W<32768;++W)Re=(W&43690)>>>1|(W&21845)<<1,Re=(Re&52428)>>>2|(Re&13107)<<2,Re=(Re&61680)>>>4|(Re&3855)<<4,_t[W]=((Re&65280)>>>8|(Re&255)<<8)>>>1;var Re,Ge=function(e,t,r){for(var n=e.length,i=0,s=new Ee(t);i<n;++i)++s[e[i]-1];var a=new Ee(t);for(i=0;i<t;++i)a[i]=a[i-1]+s[i-1]<<1;var o;if(r){o=new Ee(1<<t);var l=15-t;for(i=0;i<n;++i)if(e[i])for(var c=i<<4|e[i],h=t-e[i],f=a[e[i]-1]++<<h,u=f|(1<<h)-1;f<=u;++f)o[_t[f]>>>l]=c}else for(o=new Ee(n),i=0;i<n;++i)e[i]&&(o[i]=_t[a[e[i]-1]++]>>>15-e[i]);return o},Je=new se(288);for(var W=0;W<144;++W)Je[W]=8;for(var W=144;W<256;++W)Je[W]=9;for(var W=256;W<280;++W)Je[W]=7;for(var W=280;W<288;++W)Je[W]=8;var Qn=new se(32);for(var W=0;W<32;++W)Qn[W]=5;var Zn=Ge(Je,9,1);var Jn=Ge(Qn,5,1),gt=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},fe=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(t&7)&r},Et=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(t&7)},ei=function(e){return(e/8|0)+(e&7&&1)},yt=function(e,t,r){(t==null||t<0)&&(t=0),(r==null||r>e.length)&&(r=e.length);var n=new(e instanceof Ee?Ee:e instanceof Ze?Ze:se)(r-t);return n.set(e.subarray(t,r)),n},ti=function(e,t,r){var n=e.length;if(!n||r&&!r.l&&n<5)return t||new se(0);var i=!t||r,s=!r||r.i;r||(r={}),t||(t=new se(n*3));var a=function(k){var Be=t.length;if(k>Be){var ot=new se(Math.max(Be*2,k));ot.set(t),t=ot}},o=r.f||0,l=r.p||0,c=r.b||0,h=r.l,f=r.d,u=r.m,p=r.n,d=n*8;do{if(!h){r.f=o=fe(e,l,1);var m=fe(e,l+1,3);if(l+=3,m)if(m==1)h=Zn,f=Jn,u=9,p=5;else if(m==2){var w=fe(e,l,31)+257,b=fe(e,l+10,15)+4,T=w+fe(e,l+5,31)+1;l+=14;for(var x=new se(T),O=new se(19),A=0;A<b;++A)O[$n[A]]=fe(e,l+A*3,7);l+=b*3;for(var I=gt(O),F=(1<<I)-1,_=Ge(O,I,1),A=0;A<T;){var D=_[fe(e,l,F)];l+=D&15;var v=D>>>4;if(v<16)x[A++]=v;else{var P=0,B=0;for(v==16?(B=3+fe(e,l,3),l+=2,P=x[A-1]):v==17?(B=3+fe(e,l,7),l+=3):v==18&&(B=11+fe(e,l,127),l+=7);B--;)x[A++]=P}}var g=x.subarray(0,w),E=x.subarray(w);u=gt(g),p=gt(E),h=Ge(g,u,1),f=Ge(E,p,1)}else throw"invalid block type";else{var v=ei(l)+4,y=e[v-4]|e[v-3]<<8,L=v+y;if(L>n){if(s)throw"unexpected EOF";break}i&&a(c+y),t.set(e.subarray(v,L),c),r.b=c+=y,r.p=l=L*8;continue}if(l>d){if(s)throw"unexpected EOF";break}}i&&a(c+131072);for(var j=(1<<u)-1,z=(1<<p)-1,ee=l;;ee=l){var P=h[Et(e,l)&j],te=P>>>4;if(l+=P&15,l>d){if(s)throw"unexpected EOF";break}if(!P)throw"invalid length/literal";if(te<256)t[c++]=te;else if(te==256){ee=l,h=null;break}else{var ie=te-254;if(te>264){var A=te-257,xe=hr[A];ie=fe(e,l,(1<<xe)-1)+ur[A],l+=xe}var je=f[Et(e,l)&z],Ce=je>>>4;if(!je)throw"invalid distance";l+=je&15;var E=Xn[Ce];if(Ce>3){var xe=fr[Ce];E+=Et(e,l)&(1<<xe)-1,l+=xe}if(l>d){if(s)throw"unexpected EOF";break}i&&a(c+131072);for(var _e=c+ie;c<_e;c+=4)t[c]=t[c-E],t[c+1]=t[c+1-E],t[c+2]=t[c+2-E],t[c+3]=t[c+3-E];c=_e}}r.l=h,r.p=ee,r.b=c,h&&(o=1,r.m=u,r.d=f,r.n=p)}while(!o);return c==t.length?t:yt(t,0,c)};var cl=new se(0);var hl=function(e,t){var r={};for(var n in e)r[n]=e[n];for(var n in t)r[n]=t[n];return r},ri=function(e,t,r){for(var n=e(),i=e.toString(),s=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/ /g,"").split(","),a=0;a<n.length;++a){var o=n[a],l=s[a];if(typeof o=="function"){t+=";"+l+"=";var c=o.toString();if(o.prototype)if(c.indexOf("[native code]")!=-1){var h=c.indexOf(" ",8)+1;t+=c.slice(h,c.indexOf("(",h))}else{t+=c;for(var f in o.prototype)t+=";"+l+".prototype."+f+"="+o.prototype[f].toString()}else t+=c}else r[l]=o}return[t,r]},At=[],fl=function(e){var t=[];for(var r in e)(e[r]instanceof se||e[r]instanceof Ee||e[r]instanceof Ze)&&t.push((e[r]=new e[r].constructor(e[r])).buffer);return t},ul=function(e,t,r,n){var i;if(!At[r]){for(var s="",a={},o=e.length-1,l=0;l<o;++l)i=ri(e[l],s,a),s=i[0],a=i[1];At[r]=ri(e[o],s,a)}var c=hl({},At[r][1]);return ol(At[r][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",r,c,fl(c),n)},pl=function(){return[se,Ee,Ze,hr,fr,$n,ur,Xn,Zn,Jn,_t,Ge,gt,fe,Et,ei,yt,ti,pr,ni,ii]};var ni=function(e){return postMessage(e,[e.buffer])},ii=function(e){return e&&e.size&&new se(e.size)},dl=function(e,t,r,n,i,s){var a=ul(r,n,i,function(o,l){a.terminate(),s(o,l)});return a.postMessage([e,t],t.consume?[e.buffer]:[]),function(){a.terminate()}};var ye=function(e,t){return e[t]|e[t+1]<<8},de=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0},dr=function(e,t){return de(e,t)+de(e,t+4)*4294967296};function vl(e,t,r){if(r||(r=t,t={}),typeof r!="function")throw"no callback";return dl(e,t,[pl],function(n){return ni(pr(n.data[0],ii(n.data[1])))},1,r)}function pr(e,t){return ti(e,t)}var E0=typeof TextEncoder!="undefined"&&new TextEncoder,vr=typeof TextDecoder!="undefined"&&new TextDecoder,ml=0;try{vr.decode(cl,{stream:!0}),ml=1}catch(e){}var xl=function(e){for(var t="",r=0;;){var n=e[r++],i=(n>127)+(n>223)+(n>239);if(r+i>e.length)return[t,yt(e,r-1)];i?i==3?(n=((n&15)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,t+=String.fromCharCode(55296|n>>10,56320|n&1023)):i&1?t+=String.fromCharCode((n&31)<<6|e[r++]&63):t+=String.fromCharCode((n&15)<<12|(e[r++]&63)<<6|e[r++]&63):t+=String.fromCharCode(n)}};function _l(e,t){if(t){for(var r="",n=0;n<e.length;n+=16384)r+=String.fromCharCode.apply(null,e.subarray(n,n+16384));return r}else{if(vr)return vr.decode(e);var i=xl(e),s=i[0],a=i[1];if(a.length)throw"invalid utf-8 data";return s}}var gl=function(e,t){return t+30+ye(e,t+26)+ye(e,t+28)},yl=function(e,t,r){var n=ye(e,t+28),i=_l(e.subarray(t+46,t+46+n),!(ye(e,t+8)&2048)),s=t+46+n,a=de(e,t+20),o=r&&a==4294967295?El(e,s):[a,de(e,t+24),de(e,t+42)],l=o[0],c=o[1],h=o[2];return[ye(e,t+10),l,c,i,s+ye(e,t+30)+ye(e,t+32),h]},El=function(e,t){for(;ye(e,t)!=1;t+=4+ye(e,t+2));return[dr(e,t+12),dr(e,t+4),dr(e,t+20)]};function mr(e,t){if(typeof t!="function")throw"no callback";for(var r=[],n=function(){for(var u=0;u<r.length;++u)r[u]()},i={},s=e.length-22;de(e,s)!=101010256;--s)if(!s||e.length-s>65558){t("invalid zip file",null);return}var a=ye(e,s+8);a||t(null,{});var o=a,l=de(e,s+16),c=l==4294967295;if(c){if(s=de(e,s-12),de(e,s)!=101075792){t("invalid zip file",null);return}o=a=de(e,s+32),l=de(e,s+48)}for(var h=function(u){var p=yl(e,l,c),d=p[0],m=p[1],v=p[2],y=p[3],L=p[4],w=p[5],b=gl(e,w);l=L;var T=function(O,A){O?(n(),t(O,null)):(i[y]=A,--a||t(null,i))};if(!d)T(null,yt(e,b,b+m));else if(d==8){var x=e.subarray(b,b+m);if(m<32e4)try{T(null,pr(x,new se(v)))}catch(O){T(O,null)}else r.push(vl(x,{size:v},T))}else T("unknown compression type "+d,null)},f=0;f<o;++f)h(f);return n}var wl=/^([_\w\d]+)\:\/\//,si=5e3;async function Tl(e,t,r,n,i=si){let{cache:s,loadings:a}=e;if(t in s)return s[t];let o;if(t in a){if(o=a[t],o.active)return a[t].promise}else o=new xr(i),a[t]=o;let l=[o.promise];return wl.test(r)?l.push(ai(e,r,i).then(c=>n(c)).then(c=>Ve(e,t,c))):l.push(fetch(r).then(c=>c.arrayBuffer()).then(c=>n(c)).then(c=>Ve(e,t,c))),await Promise.race(l)}function Ve(e,t,r){let{cache:n,loadings:i}=e;return n[t]=r,t in i&&(i[t].resolve(r),delete i[t]),r}function Ml(e,t){let{cache:r,loadings:n}=e;t in n&&(n[t].reject(new Error("Stop loading to delete asset.")),delete n[t]),t in r&&delete r[t]}async function ai(e,t,r=si){let{cache:n,loadings:i}=e;if(t in n)return n[t];if(t in i)return i[t].promise;{let s=new xr(r);return i[t]=s,s.promise}}function bl(e,t){let{defaults:r}=e;for(let n of r)if(n.glob.test(t))return _r(e,n.uri);return null}function _r(e,t){return e.cache[t]}function Sl(e){return Object.keys(e.cache)}var xr=class{constructor(t){this.active=!1,this._resolve=null,this._reject=null,this._reason=null,this._value=null,this._timeoutHandle=Number.isFinite(t)&&t>0?setTimeout(()=>{this.reject(`Asset loading exceeded timeout of ${t} ms.`)},t):null,this._promise=new Promise((r,n)=>{this._value?r(this._value):this._resolve=r,this._reason?n(this._reason):this._reject=n})}get promise(){return this._promise}resolve(t){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._resolve?this._resolve(t):this._value=t}reject(t){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._reject?this._reject(t):this._reason=t}},Z=class{constructor(t,r,n){this.uri=t,this.source=r,this.loader=n,this.store=null}get current(){return _r(this.store,this.uri)}set current(t){Ve(this.store,this.uri,t)}get default(){return bl(this.store,this.uri)}get loaded(){return ai(this.store,this.uri)}async preload(t,r=void 0,n=void 0){return this.store=t,typeof n!="undefined"?Ve(t,this.uri,n):await Tl(this.store,this.uri,this.source,this.loader,r),this}async unload(){return Ml(this.store,this.uri),this.store=null,this}},Rl=5e3,et={cache:{},loadings:{},defaults:[]};async function Il(e,t=void 0){let r="raw://",i=await(await fetch(e)).arrayBuffer();await new Promise((s,a)=>{mr(new Uint8Array(i),(o,l)=>{if(o)a(o);else{for(let[c,h]of Object.entries(l)){c=c.replaceAll("\\","/");let f=c.indexOf("/");f>=0&&(c=c.substring(f+1));let u=r+c;Ve(et,u,h),t&&t(h,u,c)}s()}})})}async function Ll(e,t){let n=await(await fetch(e)).arrayBuffer();await new Promise((i,s)=>{mr(new Uint8Array(n),(a,o)=>{if(a)s(a);else{for(let[l,c]of Object.entries(o))l=l.replaceAll("\\","/"),t(c,l);i()}})})}async function Cl(e,t=Rl){let r=[];for(let n of e)r.push(n.preload(et,t));await Promise.allSettled(r)}function Ol(e,t){return Ve(et,e,t)}function Nl(){return Sl(et)}function oi(e){return _r(et,e)}function Bl(e){return oi(e)}var J=Object.freeze({__proto__:null,loadAssetPackAsRaw:Il,loadAssetPack:Ll,loadAssetRefs:Cl,cache:Ol,keys:Nl,current:oi,get:Bl});window.addEventListener("error",wt,!0);window.addEventListener("unhandledrejection",wt,!0);function wt(e){typeof e=="object"?e instanceof PromiseRejectionEvent?wt(e.reason):e instanceof ErrorEvent?wt(e.error):e instanceof Error?window.alert(e.stack):window.alert(JSON.stringify(e)):window.alert(e)}var Pl=`
<slot></slot>
<div class="container"></div>`,Fl=`
slot, ::slotted(*) {
    display: none;
}

.outer {
    overflow: hidden;
}
.outer, .inner {
    display: inline-block;
    transform-origin: top left;
    transform: scale(0, 1);
    contain: content;
}
.inner {
    white-space: pre;
}

.container p {
    margin: 0;
}

.waveChild {
    display: inline-block;
    transform-origin: top left;
    animation-name: wavy;
    animation-duration: 300ms;
    animation-direction: alternate;
    animation-iteration-count: infinite;
    animation-timing-function: linear;
}
@keyframes wavy{
    from {
        transform: translateY(-6%);
    }
    to {
        transform: translateY(6%);
    }
}`,Dl=30,Ul=120,li=10,[kl,Hl]=(()=>{let e=[],t=[];for(let r=1;r<=li;++r){let n=r/li,i=n.toFixed(5);e.push({transform:`scale(${i},1)`});let s=(1/n).toFixed(5);t.push({transform:`scale(${s},1)`})}return[e,t]})(),ci=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=Pl,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Fl,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("dialogue-area",this)}get paused(){return this._paused}set paused(t){t?this.pause():this.play()}get autoplay(){return this.hasAttribute("autoplay")}set autoplay(t){this.toggleAttribute("autoplay",t)}constructor(){super();let t=this.attachShadow({mode:"open"});t.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),t.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._containerElement=t.querySelector(".container"),this._slotElement=t.querySelector("slot"),this._typeWriteQueue=[],this._typeWriteIndex=0,this._currentWaitTime=0,this._currentWaitTimeout=null,this._currentAnimations=[],this._paused=!0,this._eventFinish=new CustomEvent("finish",{composed:!0,bubbles:!1}),this.onSlotChange=this.onSlotChange.bind(this),this.onAnimationFinish=this.onAnimationFinish.bind(this),this.onWaitTimeout=this.onWaitTimeout.bind(this),this._slotElement.addEventListener("slotchange",this.onSlotChange)}connectedCallback(){zl(this,"autoplay")}disconnectedCallback(){this._containerElement.innerHTML=""}play(){this._paused=!1;for(let t of this._currentAnimations)t.play();this.step()}pause(){this._paused=!0;for(let t of this._currentAnimations)t.pause()}reset(){this._typeWriteIndex=0;for(let r of this._currentAnimations)r.cancel();this._currentAnimations.length=0,clearTimeout(this._currentWaitTimeout),this._currentWaitTimeout=null;let t=this._typeWriteQueue;for(let r of t){let n=r.children.item(0);r.style.removeProperty("transform"),n.style.removeProperty("transform")}}step(){if(this._currentAnimations.length>0||this._currentWaitTimeout||this._paused||this._typeWriteIndex>=this._typeWriteQueue.length)return;let t=Dl;if(this.hasAttribute("speed")){let c=Number(this.getAttribute("speed"));c>0?t/=c:t=0}if(t<=0){this.skip();return}let r=this._typeWriteQueue[this._typeWriteIndex],n=r.children.item(0);r.style.transform="scale(1,1)",n.style.transform="scale(1,1)";let s=n.textContent.length*t,a=(n.hasAttribute("data-p-wait")?Number(n.getAttribute("data-p-wait")):0)*t*4,o=r.animate(kl,s),l=n.animate(Hl,s);this._currentAnimations.push(o,l),this._currentWaitTime=a,this._typeWriteIndex+=1,l.addEventListener("finish",this.onAnimationFinish)}skip(){if(this._typeWriteIndex>=this._typeWriteQueue.length)return;let t=this._currentWaitTimeout;this._currentWaitTimeout=null,clearTimeout(t);let r=this._currentAnimations;this._currentAnimations.length=0;for(let s of r)s.finish();let n=this._typeWriteQueue,i=n.length;for(let s=this._typeWriteIndex;s<i;++s){let a=n[s],o=a.children.item(0);a.style.transform="scale(1,1)",o.style.transform="scale(1,1)"}this._typeWriteIndex=n.length}onSlotChange(){this.reset();let t=this._containerElement,r=Yl(this._slotElement);t.innerHTML="",t.appendChild(r);let n=t.querySelectorAll(".outer"),i=this._typeWriteQueue;i.length=0;let s=n.length;for(let a=0;a<s;++a){let o=n.item(a);i.push(o)}this._typeWriteIndex=0,this.hasAttribute("autoplay")&&this.play()}onAnimationFinish(){if(this._currentAnimations.length=0,this._typeWriteIndex>=this._typeWriteQueue.length){this.dispatchEvent(this._eventFinish);return}let t=this._currentWaitTime;t>0?(this._currentWaitTime=0,this._currentWaitTimeout=setTimeout(this.onWaitTimeout,t)):this.step()}onWaitTimeout(){this._currentWaitTimeout=null,this.step()}};ci.define();function zl(e,t){if(Object.prototype.hasOwnProperty.call(e,t)){let r=e[t];delete e[t],e[t]=r}}function Yl(e){let t=document.createDocumentFragment(),r=e.assignedNodes();for(let n of r){if(n=n.cloneNode(!0),n.nodeType===3){let s=n.textContent.split(/\s+/).filter(Boolean).map(o=>o+" "),a=document.createDocumentFragment();for(let o of s){let l=fi(o),c=gr(o,l);a.append(c)}n=a}else{let i=hi(n,/\s+/,!0);for(let{parent:s,node:a,content:o}of i){if(s.nodeName==="P-WAIT"){let c=gr("",Number(o.join("")));s.insertBefore(c,a)}else for(let c of o){let h=fi(c),f=gr(c,h);s.insertBefore(f,a)}s.removeChild(a)}}if(n instanceof Element){let i=[];n.nodeName==="P-WAVE"&&i.push(n);let s=n.querySelectorAll("p-wave"),a=s.length;for(let o=0;o<a;++o){let l=s.item(o);i.push(l)}for(let o of i){let l=hi(o,"",!1);for(let{parent:c,node:h,content:f}of l){let u=0;for(let p of f){let d=document.createElement("span");d.className="waveChild",d.textContent=p,d.style.animationDelay=`${u}ms`,u+=Ul,c.insertBefore(d,h)}c.removeChild(h)}}}t.append(n)}return t}function hi(e,t,r){let n=[],i=document.createTreeWalker(e,NodeFilter.SHOW_TEXT),s;for(;s=i.nextNode();){let o=s.textContent.split(t).filter(Boolean);r&&(o=o.map(c=>c+" "));let l={parent:s.parentNode,node:s,content:o};n.push(l)}return n}function fi(e){let t=/([\.\!\?\:\-]+)$/.exec(e),r=/([\,\;]+)$/.exec(e),n=0;if(t){let[i,s]=t;n+=s.length*2}if(r){let[i,s]=r;n+=s.length}return n}function gr(e,t){let r=document.createElement("span");r.className="outer";let n=document.createElement("span");return n.className="inner",r.append(n),t>0&&n.setAttribute("data-p-wait",String(t)),e&&(n.textContent=e),r}var Er=class{next(){return 0}},ui=class extends Er{next(){return Math.random()}},pi=class extends Er{constructor(t){super();this.seed=t,this.a=t}next(){var t=this.a+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}},S=class{static get RAND(){let t=new this;return this.next=this.next.bind(this),this.choose=this.choose.bind(this),this.range=this.range.bind(this),this.rangeInt=this.rangeInt.bind(this),this.sign=this.sign.bind(this),Object.defineProperty(this,"RAND",{value:t}),t}constructor(t=void 0){typeof t=="number"?this.generator=new pi(t):t?this.generator=t:this.generator=new ui,this.next=this.next.bind(this),this.choose=this.choose.bind(this),this.range=this.range.bind(this),this.rangeInt=this.rangeInt.bind(this),this.sign=this.sign.bind(this)}static next(){return this.RAND.next()}next(){return this.generator.next()}static choose(t){return this.RAND.choose(t)}choose(t){return t[Math.floor(this.generator.next()*t.length)]}static range(t,r){return this.RAND.range(t,r)}range(t,r){return(r-t)*this.generator.next()+t}static rangeInt(t,r){return this.RAND.rangeInt(t,r)}rangeInt(t,r){return Math.trunc(this.range(t,r))}static sign(){return this.RAND.sign()}sign(){return this.generator.next()<.5?-1:1}};var Ae={MoveLeft:new be("moveLeft",[Me.KEY_A,Me.ARROW_LEFT]),MoveRight:new be("moveRight",[Me.KEY_D,Me.ARROW_RIGHT]),Fish:new be("fish",[Me.KEY_Z]),FastForward:new be("fastForward",[Me.SPACE])};function di(e){e.bindBindings(Object.values(Ae))}async function ae(e,t=void 0){if(typeof e=="string"){let o=await(await fetch(e)).arrayBuffer();if(typeof t=="undefined"){let l=e.lastIndexOf(".");if(l<0)throw new Error("Cannot load from url - unknown image type.");t="image/"+e.slice(l+1)}return ae(o,t)}else if(!(e instanceof ArrayBuffer||ArrayBuffer.isView(e)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let r=e;typeof t=="undefined"&&(t="image/png");let n=new Blob([r],{type:t}),i=URL.createObjectURL(n),s=new Image;return new Promise((a,o)=>{s.addEventListener("load",()=>{a(s)}),s.addEventListener("error",l=>{o(l)}),s.src=i})}var yr=Symbol("audioContext"),Tt=class{static getAudioContext(){if(yr in this)return this[yr];{let t=new AudioContext;return Gl(t),this[yr]=t,t}}constructor(t,r){this.audioContext=t,this.audioBuffer=r,this._playing=!1,this._started=!1,this._pitch=0,this._loop=!1,this._gainNode=t.createGain(),this._panNode=t.createStereoPanner(),this._source=null,this.onAudioSourceEnded=this.onAudioSourceEnded.bind(this)}destroy(){this._source&&this._source.disconnect(),this._source=null,this._started=!1,this._playing=!1}onAudioSourceEnded(){console.log("END!"),this._playing=!1}setPitch(t){return this._pitch=t,this._source&&(this._source.detune.value=t*100),this}setGain(t){return this._gainNode.gain.value=t,this}setPan(t){return this._panNode.pan.value=t,this}setLoop(t){return this._loop=t,this._source&&(this._source.loop=t),this}play(){this._source&&this._source.disconnect();let t=this.audioContext,r=this.audioBuffer,n=t.createBufferSource();n.buffer=r,this._pitch&&(n.detune.value=this._pitch*100),this._loop&&(n.loop=this._loop);let i=n;i=i.connect(this._gainNode),i=i.connect(this._panNode),i.connect(t.destination),this._source=n,this._started=!0,this._playing=!0,n.addEventListener("ended",this.onAudioSourceEnded),n.start()}pause(){this._source.stop(),this._playing=!1}isStarted(){return this._started}isPlaying(){return this._playing}isPaused(){return this._started&&!this._playing}};function Gl(e){let t=()=>{e.state==="suspended"&&e.resume()};document.addEventListener("click",t)}async function Ar(e,t){if(typeof e=="string"){let a=await(await fetch(e)).arrayBuffer();return Ar(a,t)}else if(!(e instanceof ArrayBuffer||ArrayBuffer.isView(e)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let r=e,n=new ArrayBuffer(r.byteLength);return new Uint8Array(n).set(r),await t.decodeAudioData(n)}async function Mt(e){let t=Tt.getAudioContext(),r=await Ar(e,t);return new Tt(t,r)}var ue={CanoeImage:new Z("canoe","raw://canoe.png",ae),PierImage:new Z("pier","raw://pier.png",ae),PierLegImage:new Z("pierLeg","raw://pier_leg.png",ae),BucketImage:new Z("bucket","raw://bucket.png",ae),MusicBack:new Z("musicBack","raw://music_back.wav",Mt),MusicLayer1:new Z("musicLayer1","raw://music_1.wav",Mt),MusicLayer2:new Z("musicLayer2","raw://music_2.wav",Mt)};async function vi(){await J.loadAssetRefs(Object.values(ue))}function ve(e){return typeof WebGL2RenderingContext!="undefined"&&e instanceof WebGL2RenderingContext}var wr=class{constructor(t,r){this.gl=t,this.target=r}data(t,r=void 0){let n=this.gl,i=this.target;if(typeof t=="number")n.bufferData(i,t,r||n.STATIC_DRAW);else{if(!ArrayBuffer.isView(t))throw new Error("Source data must be a typed array.");n.bufferData(i,t,r||n.STATIC_DRAW)}return this}subData(t,r=0,n=void 0,i=void 0){let s=this.gl,a=this.target;if(ArrayBuffer.isView(t))if(typeof n!="undefined")if(ve(s))s.bufferSubData(a,r,t,n,i);else{let o=i?t.subarray(n,n+i):t.subarray(n);s.bufferSubData(a,r,o)}else s.bufferSubData(a,r,t);else throw new Error("Source data must be a typed array.");return this}},mi=class{constructor(t,r,n=void 0){this.dataContext=new wr(t,r),this.handle=n||t.createBuffer(),t.bindBuffer(r,this.handle)}get gl(){return this.dataContext.gl}get target(){return this.dataContext.target}data(t,r=void 0){return this.dataContext.data(t,r),this}subData(t,r=0,n=void 0,i=void 0){return this.dataContext.subData(t,r,n,i),this}build(){return this.handle}},xi=class{constructor(t,r,n,i){this.gl=t,this.target=r,this.handle=i,this.type=n,this.bindContext=new wr(t,this.target)}bind(t){return t.bindBuffer(this.target,this.handle),this.bindContext.gl=t,this.bindContext}},Ne={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,HALF_FLOAT:5131};function Vl(e,t){let r=[],n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;++i){let s=e.getActiveUniform(t,i);if(!s)break;r.push(s)}return r}function Kl(e,t){let r=[],n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<n;++i){let s=e.getActiveAttrib(t,i);!s||r.push(s)}return r}function bt(e,t){switch(t){case e.FLOAT:case e.INT:case e.UNSIGNED_INT:case e.BOOL:return 1;case e.FLOAT_VEC2:case e.INT_VEC2:case e.BOOL_VEC2:return 2;case e.FLOAT_VEC3:case e.INT_VEC3:case e.BOOL_VEC3:return 3;case e.FLOAT_VEC4:case e.INT_VEC4:case e.BOOL_VEC4:return 4;case e.FLOAT_MAT2:return 4;case e.FLOAT_MAT3:return 9;case e.FLOAT_MAT4:return 16;default:throw new Error("Invalid vertex attribute type.")}}function Zl(e,t){switch(t){case e.FLOAT:case e.FLOAT_VEC2:case e.FLOAT_VEC3:case e.FLOAT_VEC4:return $l}if(ve(e)){let r=e;switch(t){case e.INT:case e.INT_VEC2:case e.INT_VEC3:case e.INT_VEC4:case e.BOOL:case e.BOOL_VEC2:case e.BOOL_VEC3:case e.BOOL_VEC4:return Wl;case e.FLOAT_MAT2:return ql;case e.FLOAT_MAT3:return Xl;case e.FLOAT_MAT4:return Ql;case r.UNSIGNED_INT:case r.UNSIGNED_INT_VEC2:case r.UNSIGNED_INT_VEC3:case r.UNSIGNED_INT_VEC4:return jl}}throw new Error("Cannot find attribute function for gl enum.")}function $l(e,t,r,n,i=!1,s=0,a=0,o=void 0){if(this.bindBuffer(this.ARRAY_BUFFER,t),this.enableVertexAttribArray(e),this.vertexAttribPointer(e,r,n,i,s,a),o!==void 0){if(!ve(this))throw new Error("Cannot use attribute divisor in WebGL 1.");this.vertexAttribDivisor(e,o)}}function Wl(e,t,r,n,i=!1,s=0,a=0,o=void 0){if(!ve(this))throw new Error("Cannot use attribute divisor in WebGL 1.");let l=this;l.bindBuffer(l.ARRAY_BUFFER,t),l.enableVertexAttribArray(e),l.vertexAttribIPointer(e,r,n,s,a),o!==void 0&&l.vertexAttribDivisor(e,o)}function jl(e,t,r,n,i=!1,s=0,a=0,o=void 0){if(!ve(this))throw new Error("Cannot use attribute divisor in WebGL 1.");let l=this;l.bindBuffer(l.ARRAY_BUFFER,t),l.enableVertexAttribArray(e),l.vertexAttribIPointer(e,r,n,s,a),o!==void 0&&l.vertexAttribDivisor(e,o)}function ql(e,t,r,n,i=!1,s=0,a=0,o=void 0){let l=bt(this,this.FLOAT_MAT2),c=l*l;Tr(c,l,e,t,r,n,i,s,a,o)}function Xl(e,t,r,n,i=!1,s=0,a=0,o=void 0){let l=bt(this,this.FLOAT_MAT3),c=l*l;Tr(c,l,e,t,r,n,i,s,a,o)}function Ql(e,t,r,n,i=!1,s=0,a=0,o=void 0){let l=bt(this,this.FLOAT_MAT4),c=l*l;Tr(c,l,e,t,r,n,i,s,a,o)}function Tr(e,t,r,n,i,s,a,o,l,c){if(!ve(this))throw new Error("Cannot use attribute divisor in WebGL 1.");let h=this;h.bindBuffer(h.ARRAY_BUFFER,n);let f=i/t,u=e*i,p=o/t;for(let d=0;d<t;++d){let m=r+d;h.enableVertexAttribArray(m),h.vertexAttribPointer(m,f,s,a,u,l+p*d),c!==void 0&&h.vertexAttribDivisor(m,c)}}function Jl(e,t){let r={},n=Kl(e,t);for(let i of n){let s=i.name,a=i.size,o=i.type,l=e.getAttribLocation(t,s),c=Zl(e,o),h=bt(e,o);r[s]={type:o,length:a,location:l,size:h,applier:c,set value([f,u,p,d,m,v,y]){this.applier(this.location,f,u,p,d,m,v,y)}}}return r}function ec(e,t,r){let n=e.createShader(t);if(e.shaderSource(n,r),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){let s=e.getShaderInfoLog(n)+`
Failed to compile shader:
${r}`;throw e.deleteShader(n),new Error(s)}return n}async function tc(e,t,r){for(let s of r)e.attachShader(t,s);e.linkProgram(t);let n=e.getExtension("KHR_parallel_shader_compile");if(n){let s=1e3/60,a;do await new Promise((o,l)=>setTimeout(o,s)),a=e.getProgramParameter(t,n.COMPLETION_STATUS_KHR);while(!a)}for(let s of r)e.detachShader(t,s),e.deleteShader(s);if(!e.getProgramParameter(t,e.LINK_STATUS)){let s=e.getProgramInfoLog(t);throw e.deleteProgram(t),new Error(s)}return t}function rc(e,t,r,n,i=void 0){i?(e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,i),e.drawElements(t,n,e.UNSIGNED_SHORT,r)):e.drawArrays(t,r,n)}function uc(e,t){let r=e;switch(t){case r.FLOAT:return r.uniform1f;case r.FLOAT_VEC2:return r.uniform2fv;case r.FLOAT_VEC3:return r.uniform3fv;case r.FLOAT_VEC4:return r.uniform4fv;case r.INT:return r.uniform1i;case r.INT_VEC2:return r.uniform2iv;case r.INT_VEC3:return r.uniform3iv;case r.INT_VEC4:return r.uniform4iv;case r.BOOL:return r.uniform1i;case r.BOOL_VEC2:return r.uniform2iv;case r.BOOL_VEC3:return r.uniform3iv;case r.BOOL_VEC4:return r.uniform4iv;case r.FLOAT_MAT2:return nc;case r.FLOAT_MAT3:return ic;case r.FLOAT_MAT4:return sc;case r.SAMPLER_2D:case r.SAMPLER_CUBE:return r.uniform1i}if(ve(e)){let n=e;switch(t){case n.UNSIGNED_INT:return n.uniform1ui;case n.UNSIGNED_INT_VEC2:return n.uniform2uiv;case n.UNSIGNED_INT_VEC3:return n.uniform3uiv;case n.UNSIGNED_INT_VEC4:return n.uniform4uiv;case n.FLOAT_MAT2x3:return ac;case n.FLOAT_MAT2x4:return oc;case n.FLOAT_MAT3x2:return lc;case n.FLOAT_MAT3x4:return cc;case n.FLOAT_MAT4x2:return hc;case n.FLOAT_MAT4x3:return fc;case n.SAMPLER_3D:case n.SAMPLER_2D_SHADOW:case n.SAMPLER_2D_ARRAY:case n.SAMPLER_2D_ARRAY_SHADOW:case n.SAMPLER_CUBE_SHADOW:case n.INT_SAMPLER_2D:case n.INT_SAMPLER_3D:case n.INT_SAMPLER_CUBE:case n.INT_SAMPLER_2D_ARRAY:case n.UNSIGNED_INT_SAMPLER_2D:case n.UNSIGNED_INT_SAMPLER_3D:case n.UNSIGNED_INT_SAMPLER_CUBE:case n.UNSIGNED_INT_SAMPLER_2D_ARRAY:return n.uniform1i}}throw new Error("Cannot find uniform function for gl enum.")}function nc(e,t){this.uniformMatrix2fv(e,!1,t)}function ic(e,t){this.uniformMatrix3fv(e,!1,t)}function sc(e,t){this.uniformMatrix4fv(e,!1,t)}function ac(e,t){this.uniformMatrix2x3fv(e,!1,t)}function oc(e,t){this.uniformMatrix2x4fv(e,!1,t)}function lc(e,t){this.uniformMatrix3x2fv(e,!1,t)}function cc(e,t){this.uniformMatrix3x4fv(e,!1,t)}function hc(e,t){this.uniformMatrix4x2fv(e,!1,t)}function fc(e,t){this.uniformMatrix4x3fv(e,!1,t)}function pc(e,t){let r={},n=Vl(e,t);for(let i of n){let s=i.name,a=i.size,o=i.type,l=e.getUniformLocation(t,s),c=uc(e,o);r[s]={type:o,length:a,location:l,applier:c,set value(h){this.applier.call(e,this.location,h)}}}return r}function dc(e,t,r){if("handle"in r&&r.handle instanceof WebGLVertexArrayObject){if(!ve(e))throw new Error("Vertex array objects are only supported in WebGL 2.");let n=e,i=r;n.bindVertexArray(i.handle)}else{let n=r,i=t.attributes;for(let s in i){if(!(s in n.attributes))throw new Error(`Missing buffer for attribute '${s}'.`);let a=n.attributes[s],{location:o,applier:l}=i[a.name];l.call(e,o,a.buffer,a.size,a.type,a.normalize,a.stride,a.offset,a.divisor)}n.element&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n.element.buffer)}}function xc(e,t,r=void 0){let n=mc(e,t),i=vc(e,r),s;if(i)s=i.length;else{let a=Object.keys(n);if(a.length>0){let o=n[a[0]];s=Math.trunc(o.length/o.size)}else s=0}return{attributes:n,element:i,vertexCount:s}}function _c(e,t,r){if(!ve(e))throw new Error("Vertex array objects is only supported on WebGL2.");let n=e,i=n.createVertexArray();n.bindVertexArray(i);for(let s of r)dc(n,s,t);return n.bindVertexArray(null),{handle:i,element:t.element,vertexCount:t.vertexCount}}function gc(e,t,r=e.TRIANGLES,n=0,i=t.vertexCount,s=void 0){let a=t.element;if(a){let o=a.type;if(s!==void 0){if(!ve(e))throw new Error("Instanced element drawing is only supported on WebGL2.");e.drawElementsInstanced(r,i,o,n,s)}else e.drawElements(r,i,o,n)}else if(s!==void 0){if(!ve(e))throw new Error("Instanced array drawing is only supported on WebGL2.");e.drawArraysInstanced(r,n,i,s)}else e.drawArrays(r,n,i)}function vc(e,t=void 0){if(!t)return null;if(typeof t!="object")throw new Error("Element attribute options must be an object.");let{type:r=e.UNSIGNED_SHORT,buffer:n,usage:i=e.STATIC_DRAW,length:s}=t;if(n instanceof WebGLBuffer)e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n);else if(ArrayBuffer.isView(n)){let a=n;n=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n),e.bufferData(e.ELEMENT_ARRAY_BUFFER,a,i),r===void 0&&(r=tt(e,a)),s===void 0&&(s=a.length)}else if(Array.isArray(n)){let a=n;n=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(a),i),s===void 0&&(s=a.length)}else if(typeof n=="number"){let a=n;n=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n),e.bufferData(e.ELEMENT_ARRAY_BUFFER,a,i),s===void 0&&(s=a)}else throw new Error("Invalid buffer for element attribute options.");if(r===void 0&&(r=e.UNSIGNED_SHORT),s===void 0){let a=e.getBufferParameter(e.ELEMENT_ARRAY_BUFFER,e.BUFFER_SIZE);s=Math.trunc(a/St(e,r))}return Ec(n,r,s)}function mc(e,t){let r={};for(let n of Object.keys(t)){let i=t[n];if(!i)continue;if(typeof i!="object")throw new Error("Array attribute options must be an object.");let{name:s=n,buffer:a,size:o=3,type:l,normalize:c=!1,stride:h=0,offset:f=0,divisor:u=void 0,usage:p=e.STATIC_DRAW,length:d}=i;if(a instanceof WebGLBuffer)e.bindBuffer(e.ARRAY_BUFFER,a);else if(ArrayBuffer.isView(a)){let m=a;a=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,a),e.bufferData(e.ARRAY_BUFFER,m,p),l===void 0&&(l=tt(e,m)),d===void 0&&(d=m.length)}else if(Array.isArray(a)){let m=a;l===void 0&&(l=e.FLOAT),d===void 0&&(d=m.length),a=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,a);let v=Mr(e,l);e.bufferData(e.ARRAY_BUFFER,new v(m),p)}else if(typeof a=="number"){let m=a;a=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,a),e.bufferData(e.ARRAY_BUFFER,m,p),d===void 0&&(d=m)}else throw new Error("Invalid buffer for array attribute options.");if(l===void 0&&(l=e.FLOAT),d===void 0){let m=e.getBufferParameter(e.ARRAY_BUFFER,e.BUFFER_SIZE);d=Math.trunc(m/St(e,l))}o===void 0&&(o=yc(s,d)),r[s]=Ac(s,a,d,o,l,c,h,f,u)}return r}function yc(e,t){let r;if(e.includes("texcoord")?r=2:e.includes("color")?r=4:r=3,t%r!=0)throw new Error(`Could not determine vertex size - guessed ${r} but array length ${t} is not evenly divisible.`);return r}function Ec(e,t,r){return{buffer:e,type:t,length:r}}function Ac(e,t,r,n,i,s,a,o,l){return{name:e,buffer:t,length:r,size:n,type:i,normalize:s,stride:a,offset:o,divisor:l}}function wc(e,t,r){let n=Mr(e,t);return new n(r)}function Tc(e,t,r,n=e.STATIC_DRAW){if(!ArrayBuffer.isView(r))throw new Error("Source data must be a typed array.");let i=e.createBuffer();return e.bindBuffer(t,i),e.bufferData(t,r,n),i}function Mr(e,t){switch(t){case e.BYTE:return Int8Array;case e.UNSIGNED_BYTE:return Uint8Array;case e.SHORT:return Int16Array;case e.UNSIGNED_SHORT:return Uint16Array;case e.INT:return Int32Array;case e.UNSIGNED_INT:return Uint32Array;case e.FLOAT:return Float32Array;default:throw new Error(`Cannot find valid typed array for buffer type '${t}'.`)}}function tt(e,t){if(t instanceof Int8Array)return e.BYTE;if(t instanceof Uint8Array)return e.UNSIGNED_BYTE;if(t instanceof Int16Array)return e.SHORT;if(t instanceof Uint16Array)return e.UNSIGNED_SHORT;if(t instanceof Int32Array)return e.INT;if(t instanceof Uint32Array)return e.UNSIGNED_INT;if(t instanceof Float32Array)return e.FLOAT;throw new Error("Cannot find valid data type for buffer source.")}var Mc={[Ne.BYTE]:1,[Ne.UNSIGNED_BYTE]:1,[Ne.SHORT]:2,[Ne.UNSIGNED_SHORT]:2,[Ne.INT]:4,[Ne.UNSIGNED_INT]:4,[Ne.FLOAT]:4,[Ne.HALF_FLOAT]:2};function St(e,t){return Mc[t]}function bc(e,t){switch(t){case Int8Array:return e.BYTE;case Uint8Array:return e.UNSIGNED_BYTE;case Int16Array:return e.SHORT;case Uint16Array:return e.UNSIGNED_SHORT;case Int32Array:return e.INT;case Uint32Array:return e.UNSIGNED_INT;case Float32Array:return e.FLOAT;default:throw new Error("Cannot find valid buffer type for typed array.")}}function Sc(e,t,r){return e.bindBuffer(t,r),e.getBufferParameter(t,e.BUFFER_USAGE)}function _i(e,t,r){return e.bindBuffer(t,r),e.getBufferParameter(t,e.BUFFER_SIZE)}function Rc(e,t,r,n){return Math.trunc(_i(e,t,r)/St(e,n))}var Ie=Object.freeze({__proto__:null,createBufferSource:wc,createBuffer:Tc,getTypedArrayForBufferType:Mr,getBufferTypeForBufferSource:tt,getByteCountForBufferType:St,getBufferTypeForTypedArray:bc,getBufferUsage:Sc,getBufferByteCount:_i,getBufferLength:Rc,createBufferInfo:xc,createVertexArrayInfo:_c,drawBufferInfo:gc}),we=class{constructor(t,r,n=void 0){this.bufferBuilder=new mi(t,r,n),this.bufferType=t.FLOAT}get gl(){return this.bufferBuilder.gl}get handle(){return this.bufferBuilder.handle}get target(){return this.bufferBuilder.target}data(t,r=void 0){return this.bufferBuilder.data(t,r),typeof t!="number"&&(this.bufferType=tt(this.gl,t)),this}subData(t,r=void 0,n=void 0,i=void 0){return this.bufferBuilder.subData(t,r,n,i),this.bufferType=tt(this.gl,t),this}build(){let t=this.bufferBuilder.build(),r=this.gl,n=this.target,i=this.bufferType;return new xi(r,n,i,t)}},gi=class{constructor(t,r){this.handle=r,this.activeUniforms=pc(t,r),this.activeAttributes=Jl(t,r),this.drawContext=new Ei(t,this)}bind(t){return t.useProgram(this.handle),this.drawContext.gl=t,this.drawContext}},Ei=class{constructor(t,r){this.gl=t,this.parent=r}uniform(t,r){let n=this.parent.activeUniforms;if(t in n){let i=n[t],s=i.location;i.applier.call(this.gl,s,r)}return this}attribute(t,r,n,i=!1,s=0,a=0){let o=this.gl,l=this.parent.activeAttributes;if(t in l){let c=l[t],h=c.location,f=c.size;n?(o.bindBuffer(o.ARRAY_BUFFER,n),o.vertexAttribPointer(h,f,r,i,s,a),o.enableVertexAttribArray(h)):o.disableVertexAttribArray(h)}return this}draw(t,r,n,i,s=null){return rc(t,r,n,i,s),this.parent}},yi=class{constructor(t,r=void 0){this.handle=r||t.createProgram(),this.shaders=[],this.gl=t}shader(t,r){let n=this.gl,i=ec(n,t,r);return this.shaders.push(i),this}link(){let t=this.gl;return tc(t,this.handle,this.shaders),this.shaders.length=0,this.handle}},Ue=class{constructor(t,r=void 0){this.programBuilder=new yi(t,r)}get gl(){return this.programBuilder.gl}get handle(){return this.programBuilder.handle}get shaders(){return this.programBuilder.shaders}shader(t,r){return this.programBuilder.shader(t,r),this}link(){let t=this.programBuilder.link();return new gi(this.gl,t)}};var U=1e-6,K=typeof Float32Array!="undefined"?Float32Array:Array,ce=Math.random;var H0=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var rt={};Fe(rt,{add:()=>Qc,adjoint:()=>Dc,clone:()=>Lc,copy:()=>Cc,create:()=>br,determinant:()=>Uc,equals:()=>th,exactEquals:()=>eh,frob:()=>Xc,fromMat2d:()=>Kc,fromMat4:()=>Ic,fromQuat:()=>$c,fromRotation:()=>Gc,fromScaling:()=>Vc,fromTranslation:()=>Yc,fromValues:()=>Oc,identity:()=>Bc,invert:()=>Fc,mul:()=>rh,multiply:()=>Ai,multiplyScalar:()=>Zc,multiplyScalarAndAdd:()=>Jc,normalFromMat4:()=>Wc,projection:()=>jc,rotate:()=>Hc,scale:()=>zc,set:()=>Nc,str:()=>qc,sub:()=>nh,subtract:()=>wi,translate:()=>kc,transpose:()=>Pc});function br(){var e=new K(9);return K!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function Ic(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function Lc(e){var t=new K(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Cc(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Oc(e,t,r,n,i,s,a,o,l){var c=new K(9);return c[0]=e,c[1]=t,c[2]=r,c[3]=n,c[4]=i,c[5]=s,c[6]=a,c[7]=o,c[8]=l,c}function Nc(e,t,r,n,i,s,a,o,l,c){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=s,e[5]=a,e[6]=o,e[7]=l,e[8]=c,e}function Bc(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Pc(e,t){if(e===t){var r=t[1],n=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function Fc(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8],f=h*a-o*c,u=-h*s+o*l,p=c*s-a*l,d=r*f+n*u+i*p;return d?(d=1/d,e[0]=f*d,e[1]=(-h*n+i*c)*d,e[2]=(o*n-i*a)*d,e[3]=u*d,e[4]=(h*r-i*l)*d,e[5]=(-o*r+i*s)*d,e[6]=p*d,e[7]=(-c*r+n*l)*d,e[8]=(a*r-n*s)*d,e):null}function Dc(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8];return e[0]=a*h-o*c,e[1]=i*c-n*h,e[2]=n*o-i*a,e[3]=o*l-s*h,e[4]=r*h-i*l,e[5]=i*s-r*o,e[6]=s*c-a*l,e[7]=n*l-r*c,e[8]=r*a-n*s,e}function Uc(e){var t=e[0],r=e[1],n=e[2],i=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8];return t*(c*s-a*l)+r*(-c*i+a*o)+n*(l*i-s*o)}function Ai(e,t,r){var n=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],f=t[8],u=r[0],p=r[1],d=r[2],m=r[3],v=r[4],y=r[5],L=r[6],w=r[7],b=r[8];return e[0]=u*n+p*a+d*c,e[1]=u*i+p*o+d*h,e[2]=u*s+p*l+d*f,e[3]=m*n+v*a+y*c,e[4]=m*i+v*o+y*h,e[5]=m*s+v*l+y*f,e[6]=L*n+w*a+b*c,e[7]=L*i+w*o+b*h,e[8]=L*s+w*l+b*f,e}function kc(e,t,r){var n=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],f=t[8],u=r[0],p=r[1];return e[0]=n,e[1]=i,e[2]=s,e[3]=a,e[4]=o,e[5]=l,e[6]=u*n+p*a+c,e[7]=u*i+p*o+h,e[8]=u*s+p*l+f,e}function Hc(e,t,r){var n=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],f=t[8],u=Math.sin(r),p=Math.cos(r);return e[0]=p*n+u*a,e[1]=p*i+u*o,e[2]=p*s+u*l,e[3]=p*a-u*n,e[4]=p*o-u*i,e[5]=p*l-u*s,e[6]=c,e[7]=h,e[8]=f,e}function zc(e,t,r){var n=r[0],i=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Yc(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function Gc(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Vc(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Kc(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function $c(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],a=r+r,o=n+n,l=i+i,c=r*a,h=n*a,f=n*o,u=i*a,p=i*o,d=i*l,m=s*a,v=s*o,y=s*l;return e[0]=1-f-d,e[3]=h-y,e[6]=u+v,e[1]=h+y,e[4]=1-c-d,e[7]=p-m,e[2]=u-v,e[5]=p+m,e[8]=1-c-f,e}function Wc(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8],f=t[9],u=t[10],p=t[11],d=t[12],m=t[13],v=t[14],y=t[15],L=r*o-n*a,w=r*l-i*a,b=r*c-s*a,T=n*l-i*o,x=n*c-s*o,O=i*c-s*l,A=h*m-f*d,I=h*v-u*d,F=h*y-p*d,_=f*v-u*m,D=f*y-p*m,P=u*y-p*v,B=L*P-w*D+b*_+T*F-x*I+O*A;return B?(B=1/B,e[0]=(o*P-l*D+c*_)*B,e[1]=(l*F-a*P-c*I)*B,e[2]=(a*D-o*F+c*A)*B,e[3]=(i*D-n*P-s*_)*B,e[4]=(r*P-i*F+s*I)*B,e[5]=(n*F-r*D-s*A)*B,e[6]=(m*O-v*x+y*T)*B,e[7]=(v*b-d*O-y*w)*B,e[8]=(d*x-m*b+y*L)*B,e):null}function jc(e,t,r){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/r,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function qc(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function Xc(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}function Qc(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e}function wi(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e}function Zc(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e}function Jc(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e}function eh(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function th(e,t){var r=e[0],n=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],h=e[8],f=t[0],u=t[1],p=t[2],d=t[3],m=t[4],v=t[5],y=t[6],L=t[7],w=t[8];return Math.abs(r-f)<=U*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(n-u)<=U*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(i-p)<=U*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(s-d)<=U*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(a-m)<=U*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(o-v)<=U*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(l-y)<=U*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(c-L)<=U*Math.max(1,Math.abs(c),Math.abs(L))&&Math.abs(h-w)<=U*Math.max(1,Math.abs(h),Math.abs(w))}var rh=Ai,nh=wi;var V={};Fe(V,{add:()=>kh,adjoint:()=>fh,clone:()=>sh,copy:()=>ah,create:()=>ih,determinant:()=>uh,equals:()=>Gh,exactEquals:()=>Yh,frob:()=>Uh,fromQuat:()=>Lh,fromQuat2:()=>Mh,fromRotation:()=>yh,fromRotationTranslation:()=>bi,fromRotationTranslationScale:()=>Rh,fromRotationTranslationScaleOrigin:()=>Ih,fromScaling:()=>Eh,fromTranslation:()=>gh,fromValues:()=>oh,fromXRotation:()=>Ah,fromYRotation:()=>wh,fromZRotation:()=>Th,frustum:()=>Ch,getRotation:()=>Sh,getScaling:()=>Si,getTranslation:()=>bh,identity:()=>Ti,invert:()=>hh,lookAt:()=>Ph,mul:()=>Vh,multiply:()=>Mi,multiplyScalar:()=>Hh,multiplyScalarAndAdd:()=>zh,ortho:()=>Bh,perspective:()=>Oh,perspectiveFromFieldOfView:()=>Nh,rotate:()=>vh,rotateX:()=>mh,rotateY:()=>xh,rotateZ:()=>_h,scale:()=>dh,set:()=>lh,str:()=>Dh,sub:()=>Kh,subtract:()=>Ri,targetTo:()=>Fh,translate:()=>ph,transpose:()=>ch});function ih(){var e=new K(16);return K!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function sh(e){var t=new K(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function ah(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function oh(e,t,r,n,i,s,a,o,l,c,h,f,u,p,d,m){var v=new K(16);return v[0]=e,v[1]=t,v[2]=r,v[3]=n,v[4]=i,v[5]=s,v[6]=a,v[7]=o,v[8]=l,v[9]=c,v[10]=h,v[11]=f,v[12]=u,v[13]=p,v[14]=d,v[15]=m,v}function lh(e,t,r,n,i,s,a,o,l,c,h,f,u,p,d,m,v){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=s,e[5]=a,e[6]=o,e[7]=l,e[8]=c,e[9]=h,e[10]=f,e[11]=u,e[12]=p,e[13]=d,e[14]=m,e[15]=v,e}function Ti(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ch(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],s=t[6],a=t[7],o=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=s,e[11]=t[14],e[12]=i,e[13]=a,e[14]=o}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function hh(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8],f=t[9],u=t[10],p=t[11],d=t[12],m=t[13],v=t[14],y=t[15],L=r*o-n*a,w=r*l-i*a,b=r*c-s*a,T=n*l-i*o,x=n*c-s*o,O=i*c-s*l,A=h*m-f*d,I=h*v-u*d,F=h*y-p*d,_=f*v-u*m,D=f*y-p*m,P=u*y-p*v,B=L*P-w*D+b*_+T*F-x*I+O*A;return B?(B=1/B,e[0]=(o*P-l*D+c*_)*B,e[1]=(i*D-n*P-s*_)*B,e[2]=(m*O-v*x+y*T)*B,e[3]=(u*x-f*O-p*T)*B,e[4]=(l*F-a*P-c*I)*B,e[5]=(r*P-i*F+s*I)*B,e[6]=(v*b-d*O-y*w)*B,e[7]=(h*O-u*b+p*w)*B,e[8]=(a*D-o*F+c*A)*B,e[9]=(n*F-r*D-s*A)*B,e[10]=(d*x-m*b+y*L)*B,e[11]=(f*b-h*x-p*L)*B,e[12]=(o*I-a*_-l*A)*B,e[13]=(r*_-n*I+i*A)*B,e[14]=(m*w-d*T-v*L)*B,e[15]=(h*T-f*w+u*L)*B,e):null}function fh(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8],f=t[9],u=t[10],p=t[11],d=t[12],m=t[13],v=t[14],y=t[15];return e[0]=o*(u*y-p*v)-f*(l*y-c*v)+m*(l*p-c*u),e[1]=-(n*(u*y-p*v)-f*(i*y-s*v)+m*(i*p-s*u)),e[2]=n*(l*y-c*v)-o*(i*y-s*v)+m*(i*c-s*l),e[3]=-(n*(l*p-c*u)-o*(i*p-s*u)+f*(i*c-s*l)),e[4]=-(a*(u*y-p*v)-h*(l*y-c*v)+d*(l*p-c*u)),e[5]=r*(u*y-p*v)-h*(i*y-s*v)+d*(i*p-s*u),e[6]=-(r*(l*y-c*v)-a*(i*y-s*v)+d*(i*c-s*l)),e[7]=r*(l*p-c*u)-a*(i*p-s*u)+h*(i*c-s*l),e[8]=a*(f*y-p*m)-h*(o*y-c*m)+d*(o*p-c*f),e[9]=-(r*(f*y-p*m)-h*(n*y-s*m)+d*(n*p-s*f)),e[10]=r*(o*y-c*m)-a*(n*y-s*m)+d*(n*c-s*o),e[11]=-(r*(o*p-c*f)-a*(n*p-s*f)+h*(n*c-s*o)),e[12]=-(a*(f*v-u*m)-h*(o*v-l*m)+d*(o*u-l*f)),e[13]=r*(f*v-u*m)-h*(n*v-i*m)+d*(n*u-i*f),e[14]=-(r*(o*v-l*m)-a*(n*v-i*m)+d*(n*l-i*o)),e[15]=r*(o*u-l*f)-a*(n*u-i*f)+h*(n*l-i*o),e}function uh(e){var t=e[0],r=e[1],n=e[2],i=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],h=e[9],f=e[10],u=e[11],p=e[12],d=e[13],m=e[14],v=e[15],y=t*a-r*s,L=t*o-n*s,w=t*l-i*s,b=r*o-n*a,T=r*l-i*a,x=n*l-i*o,O=c*d-h*p,A=c*m-f*p,I=c*v-u*p,F=h*m-f*d,_=h*v-u*d,D=f*v-u*m;return y*D-L*_+w*F+b*I-T*A+x*O}function Mi(e,t,r){var n=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],f=t[8],u=t[9],p=t[10],d=t[11],m=t[12],v=t[13],y=t[14],L=t[15],w=r[0],b=r[1],T=r[2],x=r[3];return e[0]=w*n+b*o+T*f+x*m,e[1]=w*i+b*l+T*u+x*v,e[2]=w*s+b*c+T*p+x*y,e[3]=w*a+b*h+T*d+x*L,w=r[4],b=r[5],T=r[6],x=r[7],e[4]=w*n+b*o+T*f+x*m,e[5]=w*i+b*l+T*u+x*v,e[6]=w*s+b*c+T*p+x*y,e[7]=w*a+b*h+T*d+x*L,w=r[8],b=r[9],T=r[10],x=r[11],e[8]=w*n+b*o+T*f+x*m,e[9]=w*i+b*l+T*u+x*v,e[10]=w*s+b*c+T*p+x*y,e[11]=w*a+b*h+T*d+x*L,w=r[12],b=r[13],T=r[14],x=r[15],e[12]=w*n+b*o+T*f+x*m,e[13]=w*i+b*l+T*u+x*v,e[14]=w*s+b*c+T*p+x*y,e[15]=w*a+b*h+T*d+x*L,e}function ph(e,t,r){var n=r[0],i=r[1],s=r[2],a,o,l,c,h,f,u,p,d,m,v,y;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*s+t[12],e[13]=t[1]*n+t[5]*i+t[9]*s+t[13],e[14]=t[2]*n+t[6]*i+t[10]*s+t[14],e[15]=t[3]*n+t[7]*i+t[11]*s+t[15]):(a=t[0],o=t[1],l=t[2],c=t[3],h=t[4],f=t[5],u=t[6],p=t[7],d=t[8],m=t[9],v=t[10],y=t[11],e[0]=a,e[1]=o,e[2]=l,e[3]=c,e[4]=h,e[5]=f,e[6]=u,e[7]=p,e[8]=d,e[9]=m,e[10]=v,e[11]=y,e[12]=a*n+h*i+d*s+t[12],e[13]=o*n+f*i+m*s+t[13],e[14]=l*n+u*i+v*s+t[14],e[15]=c*n+p*i+y*s+t[15]),e}function dh(e,t,r){var n=r[0],i=r[1],s=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function vh(e,t,r,n){var i=n[0],s=n[1],a=n[2],o=Math.hypot(i,s,a),l,c,h,f,u,p,d,m,v,y,L,w,b,T,x,O,A,I,F,_,D,P,B,g;return o<U?null:(o=1/o,i*=o,s*=o,a*=o,l=Math.sin(r),c=Math.cos(r),h=1-c,f=t[0],u=t[1],p=t[2],d=t[3],m=t[4],v=t[5],y=t[6],L=t[7],w=t[8],b=t[9],T=t[10],x=t[11],O=i*i*h+c,A=s*i*h+a*l,I=a*i*h-s*l,F=i*s*h-a*l,_=s*s*h+c,D=a*s*h+i*l,P=i*a*h+s*l,B=s*a*h-i*l,g=a*a*h+c,e[0]=f*O+m*A+w*I,e[1]=u*O+v*A+b*I,e[2]=p*O+y*A+T*I,e[3]=d*O+L*A+x*I,e[4]=f*F+m*_+w*D,e[5]=u*F+v*_+b*D,e[6]=p*F+y*_+T*D,e[7]=d*F+L*_+x*D,e[8]=f*P+m*B+w*g,e[9]=u*P+v*B+b*g,e[10]=p*P+y*B+T*g,e[11]=d*P+L*B+x*g,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function mh(e,t,r){var n=Math.sin(r),i=Math.cos(r),s=t[4],a=t[5],o=t[6],l=t[7],c=t[8],h=t[9],f=t[10],u=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*i+c*n,e[5]=a*i+h*n,e[6]=o*i+f*n,e[7]=l*i+u*n,e[8]=c*i-s*n,e[9]=h*i-a*n,e[10]=f*i-o*n,e[11]=u*i-l*n,e}function xh(e,t,r){var n=Math.sin(r),i=Math.cos(r),s=t[0],a=t[1],o=t[2],l=t[3],c=t[8],h=t[9],f=t[10],u=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i-c*n,e[1]=a*i-h*n,e[2]=o*i-f*n,e[3]=l*i-u*n,e[8]=s*n+c*i,e[9]=a*n+h*i,e[10]=o*n+f*i,e[11]=l*n+u*i,e}function _h(e,t,r){var n=Math.sin(r),i=Math.cos(r),s=t[0],a=t[1],o=t[2],l=t[3],c=t[4],h=t[5],f=t[6],u=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i+c*n,e[1]=a*i+h*n,e[2]=o*i+f*n,e[3]=l*i+u*n,e[4]=c*i-s*n,e[5]=h*i-a*n,e[6]=f*i-o*n,e[7]=u*i-l*n,e}function gh(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Eh(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function yh(e,t,r){var n=r[0],i=r[1],s=r[2],a=Math.hypot(n,i,s),o,l,c;return a<U?null:(a=1/a,n*=a,i*=a,s*=a,o=Math.sin(t),l=Math.cos(t),c=1-l,e[0]=n*n*c+l,e[1]=i*n*c+s*o,e[2]=s*n*c-i*o,e[3]=0,e[4]=n*i*c-s*o,e[5]=i*i*c+l,e[6]=s*i*c+n*o,e[7]=0,e[8]=n*s*c+i*o,e[9]=i*s*c-n*o,e[10]=s*s*c+l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function Ah(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function wh(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Th(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function bi(e,t,r){var n=t[0],i=t[1],s=t[2],a=t[3],o=n+n,l=i+i,c=s+s,h=n*o,f=n*l,u=n*c,p=i*l,d=i*c,m=s*c,v=a*o,y=a*l,L=a*c;return e[0]=1-(p+m),e[1]=f+L,e[2]=u-y,e[3]=0,e[4]=f-L,e[5]=1-(h+m),e[6]=d+v,e[7]=0,e[8]=u+y,e[9]=d-v,e[10]=1-(h+p),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function Mh(e,t){var r=new K(3),n=-t[0],i=-t[1],s=-t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],f=n*n+i*i+s*s+a*a;return f>0?(r[0]=(o*a+h*n+l*s-c*i)*2/f,r[1]=(l*a+h*i+c*n-o*s)*2/f,r[2]=(c*a+h*s+o*i-l*n)*2/f):(r[0]=(o*a+h*n+l*s-c*i)*2,r[1]=(l*a+h*i+c*n-o*s)*2,r[2]=(c*a+h*s+o*i-l*n)*2),bi(e,t,r),e}function bh(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Si(e,t){var r=t[0],n=t[1],i=t[2],s=t[4],a=t[5],o=t[6],l=t[8],c=t[9],h=t[10];return e[0]=Math.hypot(r,n,i),e[1]=Math.hypot(s,a,o),e[2]=Math.hypot(l,c,h),e}function Sh(e,t){var r=new K(3);Si(r,t);var n=1/r[0],i=1/r[1],s=1/r[2],a=t[0]*n,o=t[1]*i,l=t[2]*s,c=t[4]*n,h=t[5]*i,f=t[6]*s,u=t[8]*n,p=t[9]*i,d=t[10]*s,m=a+h+d,v=0;return m>0?(v=Math.sqrt(m+1)*2,e[3]=.25*v,e[0]=(f-p)/v,e[1]=(u-l)/v,e[2]=(o-c)/v):a>h&&a>d?(v=Math.sqrt(1+a-h-d)*2,e[3]=(f-p)/v,e[0]=.25*v,e[1]=(o+c)/v,e[2]=(u+l)/v):h>d?(v=Math.sqrt(1+h-a-d)*2,e[3]=(u-l)/v,e[0]=(o+c)/v,e[1]=.25*v,e[2]=(f+p)/v):(v=Math.sqrt(1+d-a-h)*2,e[3]=(o-c)/v,e[0]=(u+l)/v,e[1]=(f+p)/v,e[2]=.25*v),e}function Rh(e,t,r,n){var i=t[0],s=t[1],a=t[2],o=t[3],l=i+i,c=s+s,h=a+a,f=i*l,u=i*c,p=i*h,d=s*c,m=s*h,v=a*h,y=o*l,L=o*c,w=o*h,b=n[0],T=n[1],x=n[2];return e[0]=(1-(d+v))*b,e[1]=(u+w)*b,e[2]=(p-L)*b,e[3]=0,e[4]=(u-w)*T,e[5]=(1-(f+v))*T,e[6]=(m+y)*T,e[7]=0,e[8]=(p+L)*x,e[9]=(m-y)*x,e[10]=(1-(f+d))*x,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function Ih(e,t,r,n,i){var s=t[0],a=t[1],o=t[2],l=t[3],c=s+s,h=a+a,f=o+o,u=s*c,p=s*h,d=s*f,m=a*h,v=a*f,y=o*f,L=l*c,w=l*h,b=l*f,T=n[0],x=n[1],O=n[2],A=i[0],I=i[1],F=i[2],_=(1-(m+y))*T,D=(p+b)*T,P=(d-w)*T,B=(p-b)*x,g=(1-(u+y))*x,E=(v+L)*x,j=(d+w)*O,z=(v-L)*O,ee=(1-(u+m))*O;return e[0]=_,e[1]=D,e[2]=P,e[3]=0,e[4]=B,e[5]=g,e[6]=E,e[7]=0,e[8]=j,e[9]=z,e[10]=ee,e[11]=0,e[12]=r[0]+A-(_*A+B*I+j*F),e[13]=r[1]+I-(D*A+g*I+z*F),e[14]=r[2]+F-(P*A+E*I+ee*F),e[15]=1,e}function Lh(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],a=r+r,o=n+n,l=i+i,c=r*a,h=n*a,f=n*o,u=i*a,p=i*o,d=i*l,m=s*a,v=s*o,y=s*l;return e[0]=1-f-d,e[1]=h+y,e[2]=u-v,e[3]=0,e[4]=h-y,e[5]=1-c-d,e[6]=p+m,e[7]=0,e[8]=u+v,e[9]=p-m,e[10]=1-c-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ch(e,t,r,n,i,s,a){var o=1/(r-t),l=1/(i-n),c=1/(s-a);return e[0]=s*2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s*2*l,e[6]=0,e[7]=0,e[8]=(r+t)*o,e[9]=(i+n)*l,e[10]=(a+s)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*s*2*c,e[15]=0,e}function Oh(e,t,r,n,i){var s=1/Math.tan(t/2),a;return e[0]=s/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==Infinity?(a=1/(n-i),e[10]=(i+n)*a,e[14]=2*i*n*a):(e[10]=-1,e[14]=-2*n),e}function Nh(e,t,r,n){var i=Math.tan(t.upDegrees*Math.PI/180),s=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),o=Math.tan(t.rightDegrees*Math.PI/180),l=2/(a+o),c=2/(i+s);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-((a-o)*l*.5),e[9]=(i-s)*c*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e}function Bh(e,t,r,n,i,s,a){var o=1/(t-r),l=1/(n-i),c=1/(s-a);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+r)*o,e[13]=(i+n)*l,e[14]=(a+s)*c,e[15]=1,e}function Ph(e,t,r,n){var i,s,a,o,l,c,h,f,u,p,d=t[0],m=t[1],v=t[2],y=n[0],L=n[1],w=n[2],b=r[0],T=r[1],x=r[2];return Math.abs(d-b)<U&&Math.abs(m-T)<U&&Math.abs(v-x)<U?Ti(e):(h=d-b,f=m-T,u=v-x,p=1/Math.hypot(h,f,u),h*=p,f*=p,u*=p,i=L*u-w*f,s=w*h-y*u,a=y*f-L*h,p=Math.hypot(i,s,a),p?(p=1/p,i*=p,s*=p,a*=p):(i=0,s=0,a=0),o=f*a-u*s,l=u*i-h*a,c=h*s-f*i,p=Math.hypot(o,l,c),p?(p=1/p,o*=p,l*=p,c*=p):(o=0,l=0,c=0),e[0]=i,e[1]=o,e[2]=h,e[3]=0,e[4]=s,e[5]=l,e[6]=f,e[7]=0,e[8]=a,e[9]=c,e[10]=u,e[11]=0,e[12]=-(i*d+s*m+a*v),e[13]=-(o*d+l*m+c*v),e[14]=-(h*d+f*m+u*v),e[15]=1,e)}function Fh(e,t,r,n){var i=t[0],s=t[1],a=t[2],o=n[0],l=n[1],c=n[2],h=i-r[0],f=s-r[1],u=a-r[2],p=h*h+f*f+u*u;p>0&&(p=1/Math.sqrt(p),h*=p,f*=p,u*=p);var d=l*u-c*f,m=c*h-o*u,v=o*f-l*h;return p=d*d+m*m+v*v,p>0&&(p=1/Math.sqrt(p),d*=p,m*=p,v*=p),e[0]=d,e[1]=m,e[2]=v,e[3]=0,e[4]=f*v-u*m,e[5]=u*d-h*v,e[6]=h*m-f*d,e[7]=0,e[8]=h,e[9]=f,e[10]=u,e[11]=0,e[12]=i,e[13]=s,e[14]=a,e[15]=1,e}function Dh(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function Uh(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function kh(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function Ri(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function Hh(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function zh(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e}function Yh(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Gh(e,t){var r=e[0],n=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],h=e[8],f=e[9],u=e[10],p=e[11],d=e[12],m=e[13],v=e[14],y=e[15],L=t[0],w=t[1],b=t[2],T=t[3],x=t[4],O=t[5],A=t[6],I=t[7],F=t[8],_=t[9],D=t[10],P=t[11],B=t[12],g=t[13],E=t[14],j=t[15];return Math.abs(r-L)<=U*Math.max(1,Math.abs(r),Math.abs(L))&&Math.abs(n-w)<=U*Math.max(1,Math.abs(n),Math.abs(w))&&Math.abs(i-b)<=U*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(s-T)<=U*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(a-x)<=U*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(o-O)<=U*Math.max(1,Math.abs(o),Math.abs(O))&&Math.abs(l-A)<=U*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(c-I)<=U*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(h-F)<=U*Math.max(1,Math.abs(h),Math.abs(F))&&Math.abs(f-_)<=U*Math.max(1,Math.abs(f),Math.abs(_))&&Math.abs(u-D)<=U*Math.max(1,Math.abs(u),Math.abs(D))&&Math.abs(p-P)<=U*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(d-B)<=U*Math.max(1,Math.abs(d),Math.abs(B))&&Math.abs(m-g)<=U*Math.max(1,Math.abs(m),Math.abs(g))&&Math.abs(v-E)<=U*Math.max(1,Math.abs(v),Math.abs(E))&&Math.abs(y-j)<=U*Math.max(1,Math.abs(y),Math.abs(j))}var Vh=Mi,Kh=Ri;var re={};Fe(re,{add:()=>pu,calculateW:()=>ru,clone:()=>cu,conjugate:()=>au,copy:()=>fu,create:()=>Hr,dot:()=>Gi,equals:()=>gu,exactEquals:()=>_u,exp:()=>Ki,fromEuler:()=>ou,fromMat3:()=>ji,fromValues:()=>hu,getAngle:()=>Zf,getAxisAngle:()=>Qf,identity:()=>Xf,invert:()=>su,len:()=>mu,length:()=>qi,lerp:()=>vu,ln:()=>$i,mul:()=>du,multiply:()=>Vi,normalize:()=>zr,pow:()=>nu,random:()=>iu,rotateX:()=>Jf,rotateY:()=>eu,rotateZ:()=>tu,rotationTo:()=>Eu,scale:()=>Wi,set:()=>uu,setAxes:()=>Au,setAxisAngle:()=>Yi,slerp:()=>Nt,sqlerp:()=>yu,sqrLen:()=>xu,squaredLength:()=>Xi,str:()=>lu});var G={};Fe(G,{add:()=>qh,angle:()=>mf,bezier:()=>lf,ceil:()=>Xh,clone:()=>$h,copy:()=>Wh,create:()=>Rt,cross:()=>nt,dist:()=>Tf,distance:()=>Ni,div:()=>wf,divide:()=>Oi,dot:()=>Lt,equals:()=>Ef,exactEquals:()=>gf,floor:()=>Qh,forEach:()=>Sf,fromValues:()=>It,hermite:()=>of,inverse:()=>sf,len:()=>Rr,length:()=>Ii,lerp:()=>af,max:()=>Jh,min:()=>Zh,mul:()=>Af,multiply:()=>Ci,negate:()=>nf,normalize:()=>Sr,random:()=>cf,rotateX:()=>pf,rotateY:()=>df,rotateZ:()=>vf,round:()=>ef,scale:()=>tf,scaleAndAdd:()=>rf,set:()=>jh,sqrDist:()=>Mf,sqrLen:()=>bf,squaredDistance:()=>Bi,squaredLength:()=>Pi,str:()=>_f,sub:()=>yf,subtract:()=>Li,transformMat3:()=>ff,transformMat4:()=>hf,transformQuat:()=>uf,zero:()=>xf});function Rt(){var e=new K(3);return K!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function $h(e){var t=new K(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Ii(e){var t=e[0],r=e[1],n=e[2];return Math.hypot(t,r,n)}function It(e,t,r){var n=new K(3);return n[0]=e,n[1]=t,n[2]=r,n}function Wh(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function jh(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e}function qh(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function Li(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function Ci(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function Oi(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function Xh(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function Qh(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function Zh(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e}function Jh(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e}function ef(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function tf(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function rf(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e}function Ni(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.hypot(r,n,i)}function Bi(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return r*r+n*n+i*i}function Pi(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}function nf(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function sf(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function Sr(e,t){var r=t[0],n=t[1],i=t[2],s=r*r+n*n+i*i;return s>0&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e}function Lt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function nt(e,t,r){var n=t[0],i=t[1],s=t[2],a=r[0],o=r[1],l=r[2];return e[0]=i*l-s*o,e[1]=s*a-n*l,e[2]=n*o-i*a,e}function af(e,t,r,n){var i=t[0],s=t[1],a=t[2];return e[0]=i+n*(r[0]-i),e[1]=s+n*(r[1]-s),e[2]=a+n*(r[2]-a),e}function of(e,t,r,n,i,s){var a=s*s,o=a*(2*s-3)+1,l=a*(s-2)+s,c=a*(s-1),h=a*(3-2*s);return e[0]=t[0]*o+r[0]*l+n[0]*c+i[0]*h,e[1]=t[1]*o+r[1]*l+n[1]*c+i[1]*h,e[2]=t[2]*o+r[2]*l+n[2]*c+i[2]*h,e}function lf(e,t,r,n,i,s){var a=1-s,o=a*a,l=s*s,c=o*a,h=3*s*o,f=3*l*a,u=l*s;return e[0]=t[0]*c+r[0]*h+n[0]*f+i[0]*u,e[1]=t[1]*c+r[1]*h+n[1]*f+i[1]*u,e[2]=t[2]*c+r[2]*h+n[2]*f+i[2]*u,e}function cf(e,t){t=t||1;var r=ce()*2*Math.PI,n=ce()*2-1,i=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*i,e[1]=Math.sin(r)*i,e[2]=n*t,e}function hf(e,t,r){var n=t[0],i=t[1],s=t[2],a=r[3]*n+r[7]*i+r[11]*s+r[15];return a=a||1,e[0]=(r[0]*n+r[4]*i+r[8]*s+r[12])/a,e[1]=(r[1]*n+r[5]*i+r[9]*s+r[13])/a,e[2]=(r[2]*n+r[6]*i+r[10]*s+r[14])/a,e}function ff(e,t,r){var n=t[0],i=t[1],s=t[2];return e[0]=n*r[0]+i*r[3]+s*r[6],e[1]=n*r[1]+i*r[4]+s*r[7],e[2]=n*r[2]+i*r[5]+s*r[8],e}function uf(e,t,r){var n=r[0],i=r[1],s=r[2],a=r[3],o=t[0],l=t[1],c=t[2],h=i*c-s*l,f=s*o-n*c,u=n*l-i*o,p=i*u-s*f,d=s*h-n*u,m=n*f-i*h,v=a*2;return h*=v,f*=v,u*=v,p*=2,d*=2,m*=2,e[0]=o+h+p,e[1]=l+f+d,e[2]=c+u+m,e}function pf(e,t,r,n){var i=[],s=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],s[0]=i[0],s[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),s[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function df(e,t,r,n){var i=[],s=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],s[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),s[1]=i[1],s[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function vf(e,t,r,n){var i=[],s=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],s[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),s[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),s[2]=i[2],e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function mf(e,t){var r=e[0],n=e[1],i=e[2],s=t[0],a=t[1],o=t[2],l=Math.sqrt(r*r+n*n+i*i),c=Math.sqrt(s*s+a*a+o*o),h=l*c,f=h&&Lt(e,t)/h;return Math.acos(Math.min(Math.max(f,-1),1))}function xf(e){return e[0]=0,e[1]=0,e[2]=0,e}function _f(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function gf(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function Ef(e,t){var r=e[0],n=e[1],i=e[2],s=t[0],a=t[1],o=t[2];return Math.abs(r-s)<=U*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-a)<=U*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-o)<=U*Math.max(1,Math.abs(i),Math.abs(o))}var yf=Li,Af=Ci,wf=Oi,Tf=Ni,Mf=Bi,Rr=Ii,bf=Pi,Sf=function(){var e=Rt();return function(t,r,n,i,s,a){var o,l;for(r||(r=3),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,o=n;o<l;o+=r)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],s(e,e,a),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2];return t}}();var Te={};Fe(Te,{add:()=>Nr,ceil:()=>Rf,clone:()=>Ir,copy:()=>Cr,create:()=>Fi,cross:()=>Ff,dist:()=>Kf,distance:()=>Hi,div:()=>Vf,divide:()=>ki,dot:()=>Fr,equals:()=>kr,exactEquals:()=>Ur,floor:()=>If,forEach:()=>qf,fromValues:()=>Lr,inverse:()=>Pf,len:()=>Wf,length:()=>Ct,lerp:()=>Dr,max:()=>Cf,min:()=>Lf,mul:()=>Gf,multiply:()=>Ui,negate:()=>Bf,normalize:()=>Pr,random:()=>Df,round:()=>Of,scale:()=>Br,scaleAndAdd:()=>Nf,set:()=>Or,sqrDist:()=>$f,sqrLen:()=>jf,squaredDistance:()=>zi,squaredLength:()=>Ot,str:()=>zf,sub:()=>Yf,subtract:()=>Di,transformMat4:()=>Uf,transformQuat:()=>kf,zero:()=>Hf});function Fi(){var e=new K(4);return K!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Ir(e){var t=new K(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Lr(e,t,r,n){var i=new K(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function Cr(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Or(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}function Nr(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function Di(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function Ui(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function ki(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function Rf(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function If(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function Lf(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e}function Cf(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e}function Of(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function Br(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function Nf(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e}function Hi(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],s=t[3]-e[3];return Math.hypot(r,n,i,s)}function zi(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],s=t[3]-e[3];return r*r+n*n+i*i+s*s}function Ct(e){var t=e[0],r=e[1],n=e[2],i=e[3];return Math.hypot(t,r,n,i)}function Ot(e){var t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}function Bf(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function Pf(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function Pr(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],a=r*r+n*n+i*i+s*s;return a>0&&(a=1/Math.sqrt(a)),e[0]=r*a,e[1]=n*a,e[2]=i*a,e[3]=s*a,e}function Fr(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Ff(e,t,r,n){var i=r[0]*n[1]-r[1]*n[0],s=r[0]*n[2]-r[2]*n[0],a=r[0]*n[3]-r[3]*n[0],o=r[1]*n[2]-r[2]*n[1],l=r[1]*n[3]-r[3]*n[1],c=r[2]*n[3]-r[3]*n[2],h=t[0],f=t[1],u=t[2],p=t[3];return e[0]=f*c-u*l+p*o,e[1]=-(h*c)+u*a-p*s,e[2]=h*l-f*a+p*i,e[3]=-(h*o)+f*s-u*i,e}function Dr(e,t,r,n){var i=t[0],s=t[1],a=t[2],o=t[3];return e[0]=i+n*(r[0]-i),e[1]=s+n*(r[1]-s),e[2]=a+n*(r[2]-a),e[3]=o+n*(r[3]-o),e}function Df(e,t){t=t||1;var r,n,i,s,a,o;do r=ce()*2-1,n=ce()*2-1,a=r*r+n*n;while(a>=1);do i=ce()*2-1,s=ce()*2-1,o=i*i+s*s;while(o>=1);var l=Math.sqrt((1-a)/o);return e[0]=t*r,e[1]=t*n,e[2]=t*i*l,e[3]=t*s*l,e}function Uf(e,t,r){var n=t[0],i=t[1],s=t[2],a=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*s+r[12]*a,e[1]=r[1]*n+r[5]*i+r[9]*s+r[13]*a,e[2]=r[2]*n+r[6]*i+r[10]*s+r[14]*a,e[3]=r[3]*n+r[7]*i+r[11]*s+r[15]*a,e}function kf(e,t,r){var n=t[0],i=t[1],s=t[2],a=r[0],o=r[1],l=r[2],c=r[3],h=c*n+o*s-l*i,f=c*i+l*n-a*s,u=c*s+a*i-o*n,p=-a*n-o*i-l*s;return e[0]=h*c+p*-a+f*-l-u*-o,e[1]=f*c+p*-o+u*-a-h*-l,e[2]=u*c+p*-l+h*-o-f*-a,e[3]=t[3],e}function Hf(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function zf(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function Ur(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function kr(e,t){var r=e[0],n=e[1],i=e[2],s=e[3],a=t[0],o=t[1],l=t[2],c=t[3];return Math.abs(r-a)<=U*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-o)<=U*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-l)<=U*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(s-c)<=U*Math.max(1,Math.abs(s),Math.abs(c))}var Yf=Di,Gf=Ui,Vf=ki,Kf=Hi,$f=zi,Wf=Ct,jf=Ot,qf=function(){var e=Fi();return function(t,r,n,i,s,a){var o,l;for(r||(r=4),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,o=n;o<l;o+=r)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],e[3]=t[o+3],s(e,e,a),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2],t[o+3]=e[3];return t}}();function Hr(){var e=new K(4);return K!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Xf(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Yi(e,t,r){r=r*.5;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function Qf(e,t){var r=Math.acos(t[3])*2,n=Math.sin(r/2);return n>U?(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n):(e[0]=1,e[1]=0,e[2]=0),r}function Zf(e,t){var r=Gi(e,t);return Math.acos(2*r*r-1)}function Vi(e,t,r){var n=t[0],i=t[1],s=t[2],a=t[3],o=r[0],l=r[1],c=r[2],h=r[3];return e[0]=n*h+a*o+i*c-s*l,e[1]=i*h+a*l+s*o-n*c,e[2]=s*h+a*c+n*l-i*o,e[3]=a*h-n*o-i*l-s*c,e}function Jf(e,t,r){r*=.5;var n=t[0],i=t[1],s=t[2],a=t[3],o=Math.sin(r),l=Math.cos(r);return e[0]=n*l+a*o,e[1]=i*l+s*o,e[2]=s*l-i*o,e[3]=a*l-n*o,e}function eu(e,t,r){r*=.5;var n=t[0],i=t[1],s=t[2],a=t[3],o=Math.sin(r),l=Math.cos(r);return e[0]=n*l-s*o,e[1]=i*l+a*o,e[2]=s*l+n*o,e[3]=a*l-i*o,e}function tu(e,t,r){r*=.5;var n=t[0],i=t[1],s=t[2],a=t[3],o=Math.sin(r),l=Math.cos(r);return e[0]=n*l+i*o,e[1]=i*l-n*o,e[2]=s*l+a*o,e[3]=a*l-s*o,e}function ru(e,t){var r=t[0],n=t[1],i=t[2];return e[0]=r,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),e}function Ki(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],a=Math.sqrt(r*r+n*n+i*i),o=Math.exp(s),l=a>0?o*Math.sin(a)/a:0;return e[0]=r*l,e[1]=n*l,e[2]=i*l,e[3]=o*Math.cos(a),e}function $i(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],a=Math.sqrt(r*r+n*n+i*i),o=a>0?Math.atan2(a,s)/a:0;return e[0]=r*o,e[1]=n*o,e[2]=i*o,e[3]=.5*Math.log(r*r+n*n+i*i+s*s),e}function nu(e,t,r){return $i(e,t),Wi(e,e,r),Ki(e,e),e}function Nt(e,t,r,n){var i=t[0],s=t[1],a=t[2],o=t[3],l=r[0],c=r[1],h=r[2],f=r[3],u,p,d,m,v;return p=i*l+s*c+a*h+o*f,p<0&&(p=-p,l=-l,c=-c,h=-h,f=-f),1-p>U?(u=Math.acos(p),d=Math.sin(u),m=Math.sin((1-n)*u)/d,v=Math.sin(n*u)/d):(m=1-n,v=n),e[0]=m*i+v*l,e[1]=m*s+v*c,e[2]=m*a+v*h,e[3]=m*o+v*f,e}function iu(e){var t=ce(),r=ce(),n=ce(),i=Math.sqrt(1-t),s=Math.sqrt(t);return e[0]=i*Math.sin(2*Math.PI*r),e[1]=i*Math.cos(2*Math.PI*r),e[2]=s*Math.sin(2*Math.PI*n),e[3]=s*Math.cos(2*Math.PI*n),e}function su(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],a=r*r+n*n+i*i+s*s,o=a?1/a:0;return e[0]=-r*o,e[1]=-n*o,e[2]=-i*o,e[3]=s*o,e}function au(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function ji(e,t){var r=t[0]+t[4]+t[8],n;if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);var s=(i+1)%3,a=(i+2)%3;n=Math.sqrt(t[i*3+i]-t[s*3+s]-t[a*3+a]+1),e[i]=.5*n,n=.5/n,e[3]=(t[s*3+a]-t[a*3+s])*n,e[s]=(t[s*3+i]+t[i*3+s])*n,e[a]=(t[a*3+i]+t[i*3+a])*n}return e}function ou(e,t,r,n){var i=.5*Math.PI/180;t*=i,r*=i,n*=i;var s=Math.sin(t),a=Math.cos(t),o=Math.sin(r),l=Math.cos(r),c=Math.sin(n),h=Math.cos(n);return e[0]=s*l*h-a*o*c,e[1]=a*o*h+s*l*c,e[2]=a*l*c-s*o*h,e[3]=a*l*h+s*o*c,e}function lu(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var cu=Ir,hu=Lr,fu=Cr,uu=Or,pu=Nr,du=Vi,Wi=Br,Gi=Fr,vu=Dr,qi=Ct,mu=qi,Xi=Ot,xu=Xi,zr=Pr,_u=Ur,gu=kr,Eu=function(){var e=Rt(),t=It(1,0,0),r=It(0,1,0);return function(n,i,s){var a=Lt(i,s);return a<-.999999?(nt(e,t,i),Rr(e)<1e-6&&nt(e,r,i),Sr(e,e),Yi(n,e,Math.PI),n):a>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(nt(e,i,s),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+a,zr(n,n))}}(),yu=function(){var e=Hr(),t=Hr();return function(r,n,i,s,a,o){return Nt(e,n,a,o),Nt(t,i,s,o),Nt(r,e,t,2*o*(1-o)),r}}(),Au=function(){var e=br();return function(t,r,n,i){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],zr(t,ji(t,e))}}();var Ke={};Fe(Ke,{add:()=>Su,angle:()=>Wu,ceil:()=>Ru,clone:()=>wu,copy:()=>Mu,create:()=>Qi,cross:()=>ku,dist:()=>rp,distance:()=>ts,div:()=>tp,divide:()=>es,dot:()=>Uu,equals:()=>Qu,exactEquals:()=>Xu,floor:()=>Iu,forEach:()=>sp,fromValues:()=>Tu,inverse:()=>Fu,len:()=>Zu,length:()=>ns,lerp:()=>Hu,max:()=>Cu,min:()=>Lu,mul:()=>ep,multiply:()=>Ji,negate:()=>Pu,normalize:()=>Du,random:()=>zu,rotate:()=>$u,round:()=>Ou,scale:()=>Nu,scaleAndAdd:()=>Bu,set:()=>bu,sqrDist:()=>np,sqrLen:()=>ip,squaredDistance:()=>rs,squaredLength:()=>is,str:()=>qu,sub:()=>Ju,subtract:()=>Zi,transformMat2:()=>Yu,transformMat2d:()=>Gu,transformMat3:()=>Vu,transformMat4:()=>Ku,zero:()=>ju});function Qi(){var e=new K(2);return K!=Float32Array&&(e[0]=0,e[1]=0),e}function wu(e){var t=new K(2);return t[0]=e[0],t[1]=e[1],t}function Tu(e,t){var r=new K(2);return r[0]=e,r[1]=t,r}function Mu(e,t){return e[0]=t[0],e[1]=t[1],e}function bu(e,t,r){return e[0]=t,e[1]=r,e}function Su(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function Zi(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function Ji(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function es(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function Ru(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function Iu(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function Lu(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}function Cu(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}function Ou(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function Nu(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function Bu(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e}function ts(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.hypot(r,n)}function rs(e,t){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function ns(e){var t=e[0],r=e[1];return Math.hypot(t,r)}function is(e){var t=e[0],r=e[1];return t*t+r*r}function Pu(e,t){return e[0]=-t[0],e[1]=-t[1],e}function Fu(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function Du(e,t){var r=t[0],n=t[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e}function Uu(e,t){return e[0]*t[0]+e[1]*t[1]}function ku(e,t,r){var n=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=n,e}function Hu(e,t,r,n){var i=t[0],s=t[1];return e[0]=i+n*(r[0]-i),e[1]=s+n*(r[1]-s),e}function zu(e,t){t=t||1;var r=ce()*2*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e}function Yu(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e}function Gu(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e}function Vu(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e}function Ku(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e}function $u(e,t,r,n){var i=t[0]-r[0],s=t[1]-r[1],a=Math.sin(n),o=Math.cos(n);return e[0]=i*o-s*a+r[0],e[1]=i*a+s*o+r[1],e}function Wu(e,t){var r=e[0],n=e[1],i=t[0],s=t[1],a=Math.sqrt(r*r+n*n)*Math.sqrt(i*i+s*s),o=a&&(r*i+n*s)/a;return Math.acos(Math.min(Math.max(o,-1),1))}function ju(e){return e[0]=0,e[1]=0,e}function qu(e){return"vec2("+e[0]+", "+e[1]+")"}function Xu(e,t){return e[0]===t[0]&&e[1]===t[1]}function Qu(e,t){var r=e[0],n=e[1],i=t[0],s=t[1];return Math.abs(r-i)<=U*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-s)<=U*Math.max(1,Math.abs(n),Math.abs(s))}var Zu=ns,Ju=Zi,ep=Ji,tp=es,rp=ts,np=rs,ip=is,sp=function(){var e=Qi();return function(t,r,n,i,s,a){var o,l;for(r||(r=2),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,o=n;o<l;o+=r)e[0]=t[o],e[1]=t[o+1],s(e,e,a),t[o]=e[0],t[o+1]=e[1];return t}}();var ne={red(e){return e>>16&255},redf(e){return(e>>16&255)/255},green(e){return e>>8&255},greenf(e){return(e>>8&255)/255},blue(e){return e&255},bluef(e){return(e&255)/255},alpha(e){return e>>24&255},alphaf(e){return(e>>24&255)/255},hexf(e,t,r,n=1){let i=Math.floor(Math.max(Math.min(e,1),0)*255),s=Math.floor(Math.max(Math.min(t,1),0)*255),a=Math.floor(Math.max(Math.min(r,1),0)*255);return(Math.floor(Math.max(Math.min(n,1),0)*255)&255)<<24|(i&255)<<16|(s&255)<<8|a&255},mix(e=0,t=16777215,r=.5){let n=this.redf(e),i=this.greenf(e),s=this.bluef(e),a=this.alphaf(e),o=(this.redf(t)-n)*r+n,l=(this.greenf(t)-i)*r+i,c=(this.bluef(t)-s)*r+s,h=(this.alphaf(t)-a)*r+a;return h<.01&&(h=void 0),this.hexf(o,l,c,h)}};var ed=G.fromValues(0,1,0);var ss=class{constructor(t,r){this.projectionMatrix=t,this.viewMatrix=r}resize(t=void 0,r=void 0){return this}},td=Math.PI/3;var Yr=class extends ss{constructor(t=void 0,r=void 0,n=void 0,i=void 0,s=-1e3,a=1e3){super(V.create(),V.create());this.orthoBounds={left:typeof t=="undefined"?void 0:Number(t),top:typeof r=="undefined"?void 0:Number(r),right:typeof n=="undefined"?void 0:Number(n),bottom:typeof i=="undefined"?void 0:Number(i)},this.clippingPlane={near:Number(s),far:Number(a)}}resize(t=void 0,r=void 0){let{near:n,far:i}=this.clippingPlane,{left:s,top:a,right:o,bottom:l}=this.orthoBounds,c=this.projectionMatrix,h=typeof t!="undefined",f=typeof s!="undefined";if(h)if(f){let u=t/r;V.ortho(c,s*u,o*u,l,a,n,i)}else V.ortho(c,0,t,r,0,n,i);else f?V.ortho(c,s,o,l,a,n,i):V.ortho(c,-1,1,1,-1,-1,1);return this}},rd=Math.PI/180;var Gr=class{constructor(t,r=t.canvas,n=new Yr){this.gl=t,this.canvas=r,this.camera=n,this.projectionViewMatrix=V.create(),this.modelMatrix=V.create(),this.colorVector=G.create(),this.depthFloat=0,this.opacityFloat=1,this.transformStack=[],this.transformMatrix=V.create(),this.translationVector=G.create(),this.rotationQuat=re.create(),this.scaleVector=G.fromValues(1,1,1),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA)}reset(){this.resize(),this.clear(0,0,0,1),this.setColorVector(1,1,1),this.setDepthFloat(0),this.setOpacityFloat(1),this.resetTransform(),this.transformStack.length=0}resize(){let t=this.gl,r=t.canvas.width,n=t.canvas.height;t.viewport(0,0,r,n);let i=this.camera;i.resize(r,n);let s=this.projectionViewMatrix;V.mul(s,i.projectionMatrix,i.viewMatrix)}clear(t,r,n,i=1){let s=this.gl;s.clearColor(t,r,n,i),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT)}setColorVector(t,r,n){return G.set(this.colorVector,t,r,n),this}setColor(t){return this.setColorVector(ne.redf(t),ne.greenf(t),ne.bluef(t))}setDepthFloat(t){return this.depthFloat=t,this}setOpacityFloat(t){return this.opacityFloat=t,this}setTranslation(t,r,n=0){return G.set(this.translationVector,t,r,n),this}setRotation(t,r,n){return re.fromEuler(this.rotationQuat,t,r,n),this}setScale(t,r){return G.set(this.scaleVector,t,r,1),this}resetTransform(){V.identity(this.transformMatrix),G.zero(this.translationVector),re.identity(this.rotationQuat),G.set(this.scaleVector,1,1,1)}pushTransform(){V.fromRotationTranslationScale(this.transformMatrix,this.rotationQuat,this.translationVector,this.scaleVector),this.transformStack.push(this.transformMatrix),this.transformMatrix=V.create(),this.resetTransform()}popTransform(){let t=this.transformStack.pop();V.getRotation(this.rotationQuat,t),V.getTranslation(this.translationVector,t),V.getScaling(this.scaleVector,t),this.transformMatrix=t}applyTransform(t){for(let r=this.transformStack.length-1;r>=0;--r)V.mul(t,this.transformStack[r],t);return V.mul(t,V.fromRotationTranslationScale(this.transformMatrix,this.rotationQuat,this.translationVector,this.scaleVector),t),t}};var ap=`
attribute vec2 a_position;

uniform mat4 u_projection_view;
uniform mat4 u_model;

void main() {
    gl_Position = u_projection_view * u_model * vec4(a_position.xy, 0.0, 1.0);
}`,op=`
precision mediump float;

uniform vec3 u_color;
uniform float u_opacity_inv;

void main() {
    gl_FragColor = vec4(u_color.rgb, 1.0 - u_opacity_inv);
}`,Vr=16,as=(()=>{let e=[],t=Vr,r=Math.PI*2/t,n=1,i=0,s,a;for(let o=0;o<=t;++o)s=Math.cos(o*r),a=Math.sin(o*r),e.push(0,0),e.push(n,i),e.push(s,a),n=s,i=a;return e})(),lp=Math.trunc(as.length/2),os=(()=>{let e=[],t=Vr,r=Math.PI*2/t,n=1,i=0,s,a;for(let o=0;o<=t;++o)s=Math.cos(o*r),a=Math.sin(o*r),e.push(n,i),e.push(s,a),n=s,i=a;return e})(),cp=Math.trunc(os.length/2),hp=Vr/2,ls=(()=>{let e=[],t=hp,r=Math.PI/t,n=1,i=0,s,a;for(let o=0;o<=t;++o)s=Math.cos(o*r),a=Math.sin(o*r),e.push(0,0),e.push(n,i),e.push(s,a),n=s,i=a;return e})(),fp=Math.trunc(ls.length/2),Bt=[0,0,1,0,0,1,1,1,1,0,0,1],up=[0,0,1,1],Kr=class extends Gr{constructor(t,r=void 0,n=void 0){super(t,r,n);this.shapeProgram=new Ue(t).shader(t.VERTEX_SHADER,ap).shader(t.FRAGMENT_SHADER,op).link(),this.meshQuad=new we(t,t.ARRAY_BUFFER).data(Ie.createBufferSource(t,t.FLOAT,Bt)).build(),this.meshLine=new we(t,t.ARRAY_BUFFER).data(Ie.createBufferSource(t,t.FLOAT,up)).build(),this.meshCircle=new we(t,t.ARRAY_BUFFER).data(Ie.createBufferSource(t,t.FLOAT,as)).build(),this.meshLineCircle=new we(t,t.ARRAY_BUFFER).data(Ie.createBufferSource(t,t.FLOAT,os)).build(),this.meshHalfCircle=new we(t,t.ARRAY_BUFFER).data(Ie.createBufferSource(t,t.FLOAT,ls)).build()}resize(){super.resize(),this.shapeProgram.bind(this.gl).uniform("u_projection_view",this.projectionViewMatrix)}setColorVector(t,r,n){return super.setColorVector(t,r,n),this.shapeProgram.bind(this.gl).uniform("u_color",this.colorVector),this}setOpacityFloat(t){return super.setOpacityFloat(t),this.shapeProgram.bind(this.gl).uniform("u_opacity_inv",1-this.opacityFloat),this}drawLine(t=0,r=0,n=t+16,i=r){let s=this.gl,a=this.depthFloat,o=n-t,l=i-r,c=this.modelMatrix;return V.fromRotationTranslationScale(c,re.create(),G.fromValues(t,r,a),G.fromValues(o,l,1)),this.applyTransform(c),this.shapeProgram.bind(s).attribute("a_position",s.FLOAT,this.meshLine.handle).uniform("u_model",c).draw(s,s.LINES,0,2),this}drawQuadratic(t=0,r=0,n=t+16,i=r,s=16,a=9){let o=n-t,l=i-r,c=o/2+t,h=l/2+r+s,f=[t,r,c,h,n,i];pp(f,f,a);let u=f.length;for(let p=2;p<=u-2;p+=2)this.drawLine(f[p-2],f[p-1],f[p],f[p+1])}drawRay(t=0,r=0,n=0,i=16){let s=Math.PI*n/180;return this.drawLine(t,r,t+Math.cos(s)*i,r+Math.sin(s)*i)}drawBox(t=0,r=0,n=8,i=n){return this.drawBoxImpl(this.gl.TRIANGLES,t,r,this.depthFloat,n,i)}drawLineBox(t=0,r=0,n=8,i=n){return this.drawBoxImpl(this.gl.LINE_LOOP,t,r,this.depthFloat,n,i)}drawRect(t=0,r=0,n=16,i=16){let s=(n-t)/2,a=(i-r)/2;return this.drawBox(t+s,r+a,s,a)}drawLineRect(t=0,r=0,n=16,i=16){let s=(n-t)/2,a=(i-r)/2;return this.drawLineBox(t+s,r+a,s,a)}drawCircle(t=0,r=0,n=8){return this.drawCircleImpl(this.meshCircle,lp,this.gl.TRIANGLES,t,r,this.depthFloat,n)}drawLineCircle(t=0,r=0,n=8){return this.drawCircleImpl(this.meshLineCircle,cp,this.gl.LINE_LOOP,t,r,this.depthFloat,n)}drawHalfCircle(t=0,r=0,n=8){return this.drawCircleImpl(this.meshHalfCircle,fp,this.gl.TRIANGLES,t,r,this.depthFloat,n)}drawBoxImpl(t,r,n,i,s,a){let o=this.gl,l=this.modelMatrix;return V.fromRotationTranslationScaleOrigin(l,re.create(),G.fromValues(r,n,i),G.fromValues(s*2,a*2,1),G.fromValues(.5,.5,0)),this.applyTransform(l),this.shapeProgram.bind(o).attribute("a_position",o.FLOAT,this.meshQuad.handle).uniform("u_model",l).draw(o,t,0,6),this}drawCircleImpl(t,r,n,i,s,a,o){let l=this.gl,c=this.modelMatrix;return V.fromRotationTranslationScale(c,re.create(),G.fromValues(i,s,a),G.fromValues(o,o,1)),this.applyTransform(c),this.shapeProgram.bind(l).attribute("a_position",l.FLOAT,t.handle).uniform("u_model",c).draw(l,n,0,r),this}};function pp(e,t,r){if(t.length<6)throw new Error("Cannot find quadratic points from less than 3 points.");let[n,i,s,a,o,l]=t,c=rt.fromValues(n*n,s*s,o*o,n,s,o,1,1,1),h=G.fromValues(i,a,l);rt.invert(c,c);let f=G.transformMat3(h,h,c);e.length=0,e.push(n,i);let u=o-n;for(let p=1;p<r-1;++p){let d=p/r,m=u*d+n,v=f[0]*m*m+f[1]*m+f[2];e.push(m,v)}return e.push(o,l),e}var dp=`
attribute vec2 a_position;
attribute vec2 a_texcoord;

varying vec2 v_texcoord;

uniform mat4 u_projection_view;
uniform mat4 u_model;

void main() {
    vec4 position = u_projection_view * u_model
        * vec4(a_position.xy, 0.0, 1.0);
    v_texcoord = a_texcoord;
    gl_Position = position;
}`,vp=`
precision mediump float;

varying vec2 v_texcoord;

uniform sampler2D u_texture;
uniform vec2 u_texture_size;
uniform vec4 u_sprite;
uniform vec3 u_color;
uniform float u_opacity_inv;

void main() {
    float spriteWidth = u_sprite.z - u_sprite.x;
    float spriteHeight = u_sprite.w - u_sprite.y;
    vec2 texcoord = vec2(
        (u_sprite.x / u_texture_size.x) + v_texcoord.x * (spriteWidth / u_texture_size.x),
        (u_sprite.y / u_texture_size.y) + v_texcoord.y * (spriteHeight / u_texture_size.y));
    vec4 texcolor = texture2D(u_texture, texcoord);
    if (texcolor.a <= 0.0) discard;
    gl_FragColor = vec4(
        texcolor.r * u_color.r,
        texcolor.g * u_color.g,
        texcolor.b * u_color.b,
        texcolor.a * (1.0 - u_opacity_inv));
}`,$r=class extends Kr{constructor(t,r=void 0,n=void 0){super(t,r,n);this.texturedProgram=new Ue(t).shader(t.VERTEX_SHADER,dp).shader(t.FRAGMENT_SHADER,vp).link(),this.meshQuadTextured={position:new we(t,t.ARRAY_BUFFER).data(Ie.createBufferSource(t,t.FLOAT,Bt)).build(),texcoord:new we(t,t.ARRAY_BUFFER).data(Ie.createBufferSource(t,t.FLOAT,Bt)).build()},this.spriteVector=Te.fromValues(0,0,1,1),this.textureSize=Ke.fromValues(1,1),this.textureHandle=null,this.textureList=new Array(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS))}resize(){super.resize(),this.texturedProgram.bind(this.gl).uniform("u_projection_view",this.projectionViewMatrix)}setColorVector(t,r,n){return super.setColorVector(t,r,n),this.texturedProgram.bind(this.gl).uniform("u_color",this.colorVector),this}setOpacityFloat(t){return super.setOpacityFloat(t),this.texturedProgram.bind(this.gl).uniform("u_opacity_inv",1-this.opacityFloat),this}setTextureImage(t,r){let n=this.textureList,i=n.length;if(t<0||t>=i)throw new Error(`Invalid texture unit - must be within range [0, ${i-1}]`);let s=this.gl,a=n[t];a&&xp(s,a.handle);let o=mp(s,r);return n[t]=o,s.activeTexture(s.TEXTURE0+t),s.bindTexture(s.TEXTURE_2D,o.handle),this}drawTexturedBox(t=0,r=0,n=0,i=void 0,s=void 0,a=0,o=0,l=void 0,c=void 0){let{width:h,height:f}=this.textureList[t];Ke.set(this.textureSize,h,f),typeof l=="undefined"&&(l=h),typeof c=="undefined"&&(c=f),Te.set(this.spriteVector,a,o,l,c);let u=l-a,p=c-o,d=!1;typeof i=="undefined"?i=u/2:d=!0,typeof s=="undefined"&&(d?s=i:s=p/2);let m=i*2,v=s*2,y=m/u,L=v/p;return this.drawTexturedQuadImpl(t,r,n,this.depthFloat,y,L)}drawTexturedRect(t=0,r=0,n=0,i=void 0,s=void 0,a=0,o=0,l=void 0,c=void 0){let{width:h,height:f}=this.textureList[t];typeof l=="undefined"&&(l=h),typeof c=="undefined"&&(c=f),Ke.set(this.textureSize,h,f),Te.set(this.spriteVector,a,o,l,c),typeof i=="undefined"&&(i=r+h),typeof s=="undefined"&&(s=n+f);let u=i-r,p=s-n,d=l-a,m=c-o,v=u/d,y=p/m,L=r+d/2*v,w=n+m/2*y;return this.drawTexturedQuadImpl(t,L,w,this.depthFloat,v,y)}drawTexturedQuadImpl(t,r,n,i,s,a){let o=this.gl,l=this.spriteVector,c=l[2]-l[0],h=l[3]-l[1],f=this.modelMatrix;V.fromRotationTranslationScaleOrigin(f,re.fromEuler(re.create(),0,0,0),G.fromValues(r-c/2,n-h/2,i),G.fromValues(s,a,1),G.fromValues(c/2,h/2,0)),V.scale(f,f,G.fromValues(c,h,1)),this.applyTransform(f);let u=this.meshQuadTextured,p=this.textureSize;return this.texturedProgram.bind(o).attribute("a_position",o.FLOAT,u.position.handle).attribute("a_texcoord",o.FLOAT,u.texcoord.handle).uniform("u_model",f).uniform("u_texture",t).uniform("u_sprite",l).uniform("u_texture_size",p).draw(o,o.TRIANGLES,0,6),this}};function mp(e,t){if(!(t instanceof Image))throw new Error(`Not a valid image ${t}.`);let r=0,n=e.RGBA,i=e.RGBA,s=e.UNSIGNED_BYTE,a=e.createTexture();return e.bindTexture(e.TEXTURE_2D,a),e.texImage2D(e.TEXTURE_2D,r,n,i,s,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),{handle:a,width:t.width,height:t.height}}function xp(e,t){e.deleteTexture(t)}var _p=`
attribute vec2 a_position;

varying vec2 v_position;

uniform mat4 u_projection_view;
uniform mat4 u_model;

void main() {
    gl_Position = u_projection_view * u_model * vec4(a_position.xy, 0.0, 1.0);
    v_position = a_position;
}`,gp=`
precision mediump float;

varying vec2 v_position;

uniform vec3 u_color;
uniform float u_opacity_inv;

uniform vec3 u_color_from;
uniform vec3 u_color_to;

uniform vec4 u_gradient_rect;

void main() {
    // float fx = (gl_FragCoord.x - u_gradient_rect.x) / u_gradient_rect.z;
    float fy = (gl_FragCoord.y - u_gradient_rect.y) / u_gradient_rect.w;
    gl_FragColor = vec4(mix(u_color_to, u_color_from, fy), 1.0 - u_opacity_inv);
}`,Wr=class extends $r{constructor(t,r=void 0,n=void 0){super(t,r,n);this.gradientProgram=new Ue(t).shader(t.VERTEX_SHADER,_p).shader(t.FRAGMENT_SHADER,gp).link(),this.gradientColor=G.create(),this.gradientVector=Te.create()}resize(){super.resize(),this.gradientProgram.bind(this.gl).uniform("u_projection_view",this.projectionViewMatrix)}setOpacityFloat(t){return super.setOpacityFloat(t),this.gradientProgram.bind(this.gl).uniform("u_opacity_inv",1-this.opacityFloat),this}drawGradientRect(t=16777215,r=0,n=0,i=0,s=this.canvas.width,a=this.canvas.height){let o=(s-n)/2,l=(a-i)/2,c=n+o,h=i+l,f=this.depthFloat,u=this.gl,p=this.modelMatrix;return V.fromRotationTranslationScaleOrigin(p,re.fromEuler(re.create(),0,0,0),G.fromValues(c,h,f),G.fromValues(o*2,l*2,1),G.fromValues(.5,.5,0)),this.applyTransform(p),this.gradientProgram.bind(u).attribute("a_position",u.FLOAT,this.meshQuad.handle).uniform("u_model",p).uniform("u_color_from",G.set(this.gradientColor,ne.redf(t),ne.greenf(t),ne.bluef(t))).uniform("u_color_to",G.set(this.gradientColor,ne.redf(r),ne.greenf(r),ne.bluef(r))).uniform("u_gradient_rect",Te.set(this.gradientVector,n,this.canvas.height-a,o*2,l*2)).draw(u,u.TRIANGLES,0,6),this}};var jr=class extends Wr{constructor(t,r=void 0,n=void 0){super(t,r,n);this.bmFontMap={}}setBMFontTexture(t,r,n){let i={};for(let s of n.chars){let a=s.x,o=s.y,l=a+s.width,c=o+s.height;i[s.id]={u:a,v:o,s:l,t:c}}this.bmFontMap[t]=i,this.setTextureImage(t,r)}drawText(t,r,n,i){let s=n,a=13,o=18;for(let l=0;l<r.length;++l){let c=r.charAt(l);if(c===`
`){i+=o,n=s;continue}else if(c===" "){n+=a;continue}else{n+=a;let h=r.charCodeAt(l),{u:f,v:u,s:p,t:d}=this.bmFontMap[t][h],m=p-f,v=d-u;this.drawTexturedBox(t,n,i,m/2,v/2,f,u,p,d)}}}};var Ep=5,yp=4,Ap=3,wp=2,Tp=1,Mp=0,wd={[Ep]:it("#7F8C8D"),[yp]:it("#2ECC71"),[Ap]:it("#4794C8"),[wp]:it("#F39C12"),[Tp]:it("#C0392B"),[Mp]:[""]};function it(e){return[`background: ${e}`,"border-radius: 0.5em","color: white","font-weight: bold","padding: 2px 0.5em"]}var Td=Symbol("level"),Md=Symbol("domain");var $e=0,bp=class{constructor(t){this._heap=[],this._comparator=t}get size(){return this._heap.length}clear(){this._heap.length=0}push(...t){for(let r of t)this._heap.push(r),this._shiftUp()}pop(){let t=this.peek(),r=Sp(this);return r>$e&&this._swap($e,r),this._heap.pop(),this._shiftDown(),t}replace(t){let r=this.peek();return this._heap[$e]=t,this._shiftDown(),r}peek(){return this._heap[$e]}_compare(t,r){return this._comparator(this._heap[t],this._heap[r])}_swap(t,r){let n=this._heap[t];this._heap[t]=this._heap[r],this._heap[r]=n}_shiftUp(){let t=this._heap.length-1,r;for(;t>$e&&this._compare(t,r=Rp(t));)this._swap(t,r),t=r}_shiftDown(){let t=this._heap.length,r=$e,n,i=cs(r),s=i<t,a=hs(r),o=a<t;for(;s&&this._compare(i,r)||o&&this._compare(a,r);)n=o&&this._compare(a,i)?a:i,this._swap(r,n),r=n,i=cs(r),s=i<t,a=hs(r),o=a<t}values(){return this._heap}[Symbol.iterator](){return this._heap[Symbol.iterator]()}};function Sp(e){return e._heap.length-1}function Rp(e){return(e+1>>>1)-1}function cs(e){return(e<<1)+1}function hs(e){return e+1<<1}function Le(e,t,r){return Math.min(r,Math.max(t,e))}var bd=Math.PI/180,Sd=180/Math.PI;var me=[{stars:[16774367],skies:[11007231,15377902],streaks:[8766926,6591951],clouds:[[13693691,16508880]],columns:[13300991,13303795,6011098],rows:[13300991,6011098,13303795],seas:[3902694,13303795]},{stars:[16777215],skies:[16555445,16774359],streaks:[16178095,16776936],clouds:[[16777215,16776936],[16777215,16776936],[16777215,16776936],[12748716,10973587]],columns:[16777215,16777215,16777215,15724741,8151940],rows:[16776935,12163267,12028345],seas:[16776935,12028345]},{stars:[16448250],skies:[8550580,11845350],streaks:[11837670,13484018],clouds:[[16777215,14741247]],columns:[10665701,5472705,4998547],rows:[4815292,3696037,1789849,1591177],seas:[4815292,1789849]}];function Pt(e,t){let r=e/t;return Math.floor(r*me.length)}function Ft(e,t){let r=t/me.length;return e%r/r}function ke(e,t,r,n){let i=me[e],s=me[e>=me.length-1?0:e+1];return ne.mix(i[r][n],s[r][n],t)}function He(e,t,r,n){let i=me[e],s=me[e>=me.length-1?0:e+1],a=Math.floor(r*i[n].length),o=Math.floor(r*s[n].length),l=i[n][a],c=s[n][o];return ne.mix(l,c,t)}function fs(e,t,r,n){let i=me[e],s=me[e>=me.length-1?0:e+1],a=Math.floor(r*i[n].length),o=Math.floor(r*s[n].length),l=i[n][a],c=s[n][o],h=[];for(let f=0;f<l.length;++f)h.push(ne.mix(l[f],c[f],t));return h}var Ip=40,Lp=12,Cp=4,Op=6,Np=8,st={StarImage:new Z("star.png","raw://star.png",ae),BlurStrokeImage:new Z("blur_stroke.png","raw://blur_stroke.png",ae),CircleImage:new Z("circle.png","raw://circle.png",ae),CloudImage:new Z("cloud.png","raw://cloud.png",ae)};async function us(e){await J.loadAssetRefs(Object.values(st))}function ps(e){let t=e.display.width,r=e.display.height;return{stars:at(()=>Bp(t,r),Ip),streaks:at(()=>Pp(t,r),Lp),bigStreaks:at(()=>Fp(t,r),Cp),shades:at(()=>Dp(t,r),Op),clouds:at(()=>Up(t,r),Np)}}function at(e,t){let r=[];for(let n=0;n<t;++n)r.push(e());return r}function ds(e,t,r){let n=e,i=t.display.width,s=t.display.height,{streaks:a,bigStreaks:o,clouds:l}=r;for(let c of a)if(c.progress+=n/50*c.speed,c.progress>c.y*2+c.length){let h=S.range(-i/2,i);c.x=h,c.y=s,c.progress=0,c.speed=S.range(.1,2),c.opacity=S.range(.1,.3),c.radius=S.range(.5,1),c.length=S.range(1,2)}for(let c of o)if(c.progress+=n/50*c.speed,c.progress>c.y*2+c.length){let h=S.range(-i/2,i);c.x=h,c.y=s,c.progress=0,c.speed=S.range(.1,.5),c.opacity=S.range(.1,.5),c.radius=S.range(.5,1)*3,c.length=S.range(1,2)*3}for(let c of l)c.progress+=n/100*c.speed,c.progress>i-c.x+300&&(c.w=S.range(2,4),c.h=S.range(.2,1),c.x=-i,c.y=S.range(0,s*.6),c.progress=0,c.speed=S.range(.5,3))}function vs(e,t,r){let n=t.now,i=t.display.width,s=t.display.height,{shades:a,streaks:o,bigStreaks:l,stars:c,clouds:h}=r,f=6e4,u=n%f,p=Pt(u,f),d=Ft(u,f),m=ke(p,d,"skies",0),v=ke(p,d,"skies",1);e.drawGradientRect(m,v,0,0,i,s);for(let x of a){let O=ne.mix(m,v,Le(x.y/s-.06,0,1));e.setColor(O),e.setScale(i/16,x.height/16),e.setTranslation(x.x,x.y),e.drawCircle(),e.resetTransform()}e.setTextureImage(2,st.BlurStrokeImage.current),e.setRotation(0,0,-45);for(let x of o){let O=x.progress/100,A=He(p,d,x.spicy,"streaks");e.setColor(A),e.setOpacityFloat(Math.min(O,x.opacity)),e.setScale(x.length,x.radius),e.setTranslation(x.x,x.y),e.drawTexturedBox(2,x.progress)}for(let x of l){let O=x.progress/100,A=He(p,d,x.spicy,"streaks");e.setColor(A),e.setOpacityFloat(Math.min(O,x.opacity)),e.setScale(x.length,x.radius),e.setTranslation(x.x,x.y),e.drawTexturedBox(2,x.progress)}e.setOpacityFloat(1),e.resetTransform();let y=n/400%i,L=n/400%s;e.setTextureImage(0,st.StarImage.current);for(let x of c){let O=He(p,d,x.spicy,"stars");e.setColor(O),e.setOpacityFloat(x.opacity);let A=Math.sin(n/500*x.wiggleSpeed+x.wiggleOffset)+1,I=(x.x+y)%i,F=(x.y+L)%s;e.drawTexturedBox(0,I,s-F,16*x.scale,16*x.scale+A*x.scale*8)}e.setOpacityFloat(1);let w=ke(p,d,"stars",0);e.setColor(w),e.setTextureImage(3,st.CircleImage.current),e.drawTexturedBox(3,i*.66,200);let b=st.CloudImage.current;e.setTextureImage(4,b);let T=-b.height/2;for(let x of h){let[O,A]=fs(p,d,x.spicy,"clouds"),I=x.x+x.progress;e.setColor(O),e.setScale(x.w*1.2,x.h*1.2),e.setTranslation(I,x.y);let F=I/i;e.drawTexturedBox(4,10*(-F*2+1),T),e.setColor(A),e.setScale(x.w,x.h),e.setTranslation(I,x.y),e.drawTexturedBox(4,0,T)}e.resetTransform()}function Bp(e,t){return{x:S.rangeInt(0,e),y:S.rangeInt(0,t),scale:S.range(.1,.4),opacity:S.range(.3,1),wiggleSpeed:S.range(.8,1.2),wiggleOffset:S.range(0,2),spicy:S.next()}}function Pp(e,t){let r=S.range(-e/2,e),n=S.range(0,t),i;n<e*.6?i=0:i=.99;let s=S.range(1,2);return{x:r,y:n,spicy:i,progress:S.range(0,t),speed:S.range(.1,1.5),opacity:S.range(.1,.3),radius:S.range(.5,1)*s,length:S.range(1,2)*s}}function Fp(e,t){let r=S.range(-e/2,e),n=S.rangeInt(0,t);return{x:r,y:n,spicy:.99,progress:0,speed:S.range(.1,.5),opacity:S.range(.1,.5),radius:S.range(.5,1)*3,length:S.range(1,2)*3}}function Dp(e,t){let r=S.range(0,e),n=S.range(0,t),i=S.range(50,80);return{x:r,y:n,opacity:1,height:i}}function Up(e,t){let r=S.range(0,e),n=S.range(0,t*.6),i=S.range(2,4),s=S.range(.2,1);return{x:r,y:n,w:i,h:s,spicy:S.next(),progress:0,speed:S.range(.5,3)}}var kp=60,Hp=40,zp=10,Yp=8,qr={Wave1Image:new Z("wave1.png","raw://wave1.png",ae),Wave2Image:new Z("wave2.png","raw://wave2.png",ae)};async function ms(e){await J.loadAssetRefs(Object.values(qr))}function xs(e){let t=e.display.width,r=e.display.height;return{sparkles:Dt(()=>Gp(t,r),kp),foams:Dt(()=>Vp(t,r),Hp),columns:Dt(()=>Kp(t,r),zp),rows:Dt(()=>$p(t,r),Yp)}}function Dt(e,t){let r=[];for(let n=0;n<t;++n)r.push(e());return r}function _s(e,t,r){}function gs(e,t,r){let n=t.now,i=t.display.canvas,s=t.display.width,a=t.display.height,{columns:o,rows:l,sparkles:c,foams:h}=r,f=6e4,u=n%f,p=Pt(u,f),d=Ft(u,f),m=i.height-200,v=ke(p,d,"seas",0),y=ke(p,d,"seas",1);e.drawGradientRect(v,y,0,m,s,a),e.setOpacityFloat(.6);for(let x of o){let O=He(p,d,x.spicy,"columns");e.setColor(O),e.drawRect(x.x,m,x.x+x.width,i.height)}e.setOpacityFloat(1);for(let x of l){let O=He(p,d,x.spicy,"rows");e.setColor(O),e.setScale(x.height,1),e.setTranslation(x.x,x.y),e.drawCircle()}e.resetTransform();let L=10,w=i.height-150,b=w-m;e.setRotation(0,0,45);for(let x of c){e.setColor(16777215);let O=(Math.sin(n/1e3+x.sparkleOffset)+1)/2;e.setOpacityFloat(O);let A=10*(Math.sin(n/5e3+x.sparkleOffset)+1)/2;e.setTranslation(x.x+A,x.y,L);let I=(m-x.y)/b;e.setScale(.5+I,.5+I),e.drawBox()}e.setOpacityFloat(1),e.resetTransform();let T=i.height-m;for(let x of h){e.setColor(16777215);let O=Le((Math.sin(n/1e3+x.opacity)+1)/2*2,0,1);e.setOpacityFloat(O);let A=100*(Math.sin(n/5e3+x.opacity)+1)/2;e.setTranslation(x.x+A,x.y,L);let I=(x.y-w)/T;e.setScale(.1+I,(.1+I)*.5);let F;switch(x.wave){case 0:F=qr.Wave1Image.current;break;default:case 1:F=qr.Wave2Image.current;break}e.setTextureImage(5,F),e.drawTexturedBox(5)}e.setOpacityFloat(1),e.resetTransform()}function Gp(e,t){let r=S.range(0,e),n=S.range(t-190,t-150);return{x:r,y:n,sparkleOffset:S.range(0,Math.PI*2)}}function Vp(e,t){let r=S.range(0,e),n=S.range(t-150,t),i=S.choose([0,1]);return{x:r,y:n,wave:i,opacity:S.range(0,Math.PI*2)}}function Kp(e,t){let r=S.range(0,e),n=S.range(50,100);return{x:r,width:n,spicy:S.next()}}function $p(e,t){let r=S.range(0,e),n=S.range(t-190,t-20),i=S.range(20,60),s;if(S.next()<.6){let a=(n-(t-190))/200;a<.3?s=0:a<.6?s=.4:s=.9}else s=S.next();return{x:r,y:n,height:i,spicy:s}}var Wp={};async function Es(e){await J.loadAssetRefs(Object.values(Wp))}function ys(e){let t=[];for(let r=0;r<10;++r)t.push({x:0,y:0,startTime:0,dead:!1});return{ripples:t}}function As(e,t,r){for(let n of r.ripples){if(n.dead)continue;t.now-n.startTime>Ut&&(n.dead=!0)}}function ws(e,t,r){let n=t.now;for(let i of r.ripples)i.dead||We(e,i.x,i.y,i.startTime,n,!1)}function Ts(e,t,r,n){let i=null;for(let s of e.ripples)if(s.dead){i=s;break}return i&&(i.x=t,i.y=r,i.startTime=n,i.dead=!1),i}var Ut=8e3;function We(e,t,r,n,i,s=!1){let a=i-n;if(s)a%=Ut;else if(a>=Ut)return;let o=1-a/Ut,l=(1-o)*.9,c=(1-o)*.5;e.setColor(16777215),e.setTranslation(t,r,10),e.setScale(2+l*2,.5+l),e.setOpacityFloat(o),e.drawLineCircle(),e.setScale(1+c*2,.1+c),e.drawLineCircle(),e.setOpacityFloat(1),e.resetTransform()}var jp={};async function Ms(e){await J.loadAssetRefs(Object.values(jp))}var qp=4,Xp=.6,Xr=800,Qp=100,Zp=1e3,Y={IDLE:0,POWERING:1,CASTING:2,PLOPPING:3,BOBBING:4,NIBBLING:5,BITING:6,REELING:7,CAUGHT:8};function bs(e){let t=e.display.width,r=e.display.height,n=t-200,i=r-200;return{fishingState:Y.IDLE,headX:n,headY:i,bobX:n,bobY:i,castingStartTime:0,castingPowerX:-10,castingPowerY:10,nibblingStartTime:0,bitingStartTime:0,hookedItem:null}}function Jp(e){return 2e3}function Ss(e,t,r){let n=e,i=t.display.canvas,s=t.display.width,o=t.display.height-60;switch(r.fishingState){case Y.IDLE:break;case Y.POWERING:r.bobX=r.headX,r.bobY=r.headY;break;case Y.CASTING:{r.castingPowerY-=Xp;let h=r.castingPowerX,f=r.castingPowerY*-1;r.bobX+=h,r.bobY+=f,r.bobY>=o&&(r.bobY=o,r.fishingState=Y.PLOPPING)}break;case Y.PLOPPING:r.fishingState=Y.BOBBING;break;case Y.BOBBING:break;case Y.NIBBLING:t.now-r.nibblingStartTime>Zp&&(r.fishingState=Y.BOBBING);break;case Y.BITING:{let h=t.now-r.bitingStartTime,f=Jp(r.hookedItem);h>f&&(r.hookedItem=null,r.fishingState=Y.BOBBING)}break;case Y.REELING:let l=r.headX-r.bobX,c=r.headY-r.bobY;Math.abs(l)>qp?(r.bobX+=l*.2,r.bobY+=c*.2):(r.fishingState=Y.CAUGHT,r.bobX=r.headX,r.bobY=r.headY);break;case Y.CAUGHT:r.fishingState=Y.IDLE;break}e0(t,r)}function e0(e,t){switch(t.fishingState){case Y.IDLE:Ae.Fish.pressed&&(t.fishingState=Y.POWERING,t.castingStartTime=e.now);break;case Y.POWERING:if(Ae.Fish.released){let r=e.now-t.castingStartTime,n=Le(r,Qp,Xr)/Xr;t.castingPowerX=-15*n,t.castingPowerY=15*n,t.fishingState=Y.CASTING}break;case Y.CASTING:case Y.PLOPPING:case Y.BOBBING:case Y.NIBBLING:case Y.BITING:Ae.Fish.pressed&&(t.fishingState=Y.REELING);break;case Y.REELING:case Y.CAUGHT:break}}function Rs(e,t,r){let n=t.now,i=t.display.canvas,s=t.display.width,a=t.display.height;if(e.setDepthFloat(50),r.fishingState===Y.IDLE)return;let o=r.bobX,l=r.bobY,c=1;if(r.fishingState===Y.BOBBING){let u=Math.sin(n/500);l+=2-u*2,c=Le((u+1)*.5,.5,1)}let h=Math.max(o,r.headX)-Math.min(o,r.headX);e.setColor(0),h>4&&(r.fishingState===Y.REELING?e.drawLine(r.headX,r.headY,o,l):e.drawQuadratic(r.headX,r.headY,o,l,Le(40-h/60,0,40)));let f=0;r.fishingState===Y.POWERING&&(f=Le((n-r.castingStartTime)/Xr,0,1)*20),e.setOpacityFloat(c),e.setColor(16777215),e.drawCircle(o+f,l+f/2),e.setColor(16711680),e.drawHalfCircle(o+f,l+f/2),e.setOpacityFloat(1),r.fishingState===Y.BOBBING&&(e.setColor(16777215),e.setTranslation(0,0,50),e.pushTransform(),We(e,o,r.bobY,0,n,!0),e.popTransform(),e.resetTransform()),r.hookedItem}var Qr=class{constructor(t,r){this.name=t,this.factory=r}create(){return this.factory()}delete(t){}};var Is={FishImage:new Z("fishShadow","raw://fish_shadow.png",ae)},t0=new Qr("fish",()=>({x:0,y:0,offset:0,size:0,speed:0}));async function Ls(e){await J.loadAssetRefs(Object.values(Is))}function Cs(e){let t=e.display.width,r=e.display.height,n=[];for(let i=0;i<6;++i){let s=t0.create();s.x=S.range(0,t),s.y=S.range(r-100,r),s.offset=S.range(0,Math.PI*2),s.size=S.range(.3,.5),s.speed=S.range(1,3)*S.sign(),n.push(s)}return{fishes:n}}function Os(e,t,r,n){let i=t.display.width,s=t.display.height,a=t.now,{fishes:o}=r;for(let l of o)l.x+=(.2+(Math.sin(a/1e3+l.offset)+1)/2)*l.speed,l.x>i&&(l.x=0,l.y=S.range(s-100,s)),l.x<0&&(l.x=i,l.y=S.range(s-100,s)),Math.floor(a/10+l.y*10)%400==0&&Math.random()<.1&&Ts(n,l.x,l.y-5,a)}function Ns(e,t,r){e.setTextureImage(6,Is.FishImage.current),e.setColor(3355443);for(let n of r.fishes){e.pushTransform();let i=Math.sin(n.x/5+n.y),s=Math.cos(n.x/20);e.setTranslation(n.x,n.y+s*4),e.setOpacityFloat(.5),e.setRotation(0,0,90+i*4+(n.speed<0?180:0)),e.setScale(n.size,n.size+(s+1)/2*.1),e.drawTexturedBox(6,0,20),e.popTransform()}e.setOpacityFloat(1),e.resetTransform()}var r0={};async function Bs(e){await J.loadAssetRefs(Object.values(r0))}function Ps(e){return{player:{x:e.display.width-100,y:0,motionX:0}}}function Fs(e,t,r,n){let i=t.display.width,s=t.display.height,a=r.player,l=1-.4,c=Ae.MoveRight.value-Ae.MoveLeft.value;a.motionX+=c*e*.1,a.motionX*=l,a.x+=a.motionX,a.y=s-200,n.headX=a.x,n.headY=a.y,(n.fishingState===Y.IDLE||n.fishingState===Y.POWERING)&&(n.bobX=a.x,n.bobY-a.y),a.x>i-10?a.x=i-10:a.x<i-130&&(a.x=i-130)}function Ds(e,t,r){let n=r.player;e.setColor(65450),e.drawCircle(n.x,n.y),e.pushTransform(),e.setTranslation(n.x,n.y+75),e.setScale(3,1),e.setColor(3355443),e.setOpacityFloat(.3),e.drawCircle(),e.setOpacityFloat(1),e.popTransform()}function Us(){let e=document.querySelector("#display"),t=document.querySelector("#inputs").getContext("axisbutton");return{display:e,inputs:t,assets:J,now:0,deltaTime:0}}window.addEventListener("DOMContentLoaded",n0);async function n0(){let e=Us();await J.loadAssetPackAsRaw("res.pack"),await i0(e)}async function i0(e){let{display:t}=e,r=t.canvas,n=new jr(r.getContext("webgl")),i=t.width,s=t.height;di(e.inputs),await vi(),await us(e),await ms(e),await Ms(e),await Ls(e),await Es(e),await Bs(e);let a=ps(e),o=xs(e),l=bs(e),c=ys(e),h=Cs(e),f=Ps(e),u={progression:0};t.addEventListener("frame",p=>{let{deltaTime:d,now:m}=p.detail;i=e.display.width,s=e.display.height,e.inputs.poll(m),s0(u);let v=Ae.FastForward.down?30:1;d*=v,m*=v,e.deltaTime=d,e.now=m,ds(d,e,a),_s(d,e,o),Ss(d,e,l),As(d,e,c),Os(d,e,h,c),Fs(d,e,f,l),n.resize(),n.reset(),n.setTranslation(0,0,-10),n.pushTransform(),vs(n,e,a),gs(n,e,o),n.popTransform(),Ns(n,e,h),ws(n,e,c),n.setTranslation(i-50,s-110),n.setScale(20,3),n.setColor(3355443),n.setOpacityFloat(.3),n.drawCircle(),n.setOpacityFloat(1),n.resetTransform(),n.setColor(16777215),We(n,i-180,s-113,3e3,m,!0),We(n,i-100,s-92,5e3,m,!0),n.setTranslation(0,0,20),n.setColor(10057562),n.setTextureImage(8,ue.PierLegImage.current),n.drawTexturedBox(8,i-100,s-110,10,20),n.drawTexturedBox(8,i-180,s-120,8,10,0,30),n.setTextureImage(7,ue.PierImage.current),n.drawTexturedRect(7,i-ue.PierImage.current.width,s-140,i,s-100),n.resetTransform(),n.setTranslation(0,0,30),n.setTextureImage(9,ue.BucketImage.current),n.setColor(12833752),n.drawTexturedBox(9,i-140,s-140,15),Ds(n,e,f),Rs(n,e,l),n.resetTransform()})}function s0(e){if(!ue.MusicBack.current.isPlaying()&&(ue.MusicBack.current.setGain(.4).play(),!ue.MusicLayer1.current.isPlaying()&&!ue.MusicLayer2.current.isPlaying())){let t=S.rangeInt(4,6);e.progression+=t,e.progression<8&&S.next()<e.progression/10?(ue.MusicLayer1.current.setGain(.6).play(),e.progression+=S.rangeInt(-4,4)):e.progression>8&&(ue.MusicLayer2.current.setGain(.6).play(),e.progression/=2)}}})();
//# sourceMappingURL=main.js.map
