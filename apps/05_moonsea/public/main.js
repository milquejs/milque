(()=>{var qi=Object.create,ut=Object.defineProperty,Xi=Object.getPrototypeOf,Qi=Object.prototype.hasOwnProperty,Zi=Object.getOwnPropertyNames,Ji=Object.getOwnPropertyDescriptor;var ea=e=>ut(e,"__esModule",{value:!0});var ta=(e,t)=>()=>(e&&(t=e(e=0)),t),Ne=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),De=(e,t)=>{for(var r in t)ut(e,r,{get:t[r],enumerable:!0})},ra=(e,t,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Zi(t))!Qi.call(e,n)&&n!=="default"&&ut(e,n,{get:()=>t[n],enumerable:!(r=Ji(t,n))||r.enumerable});return e},na=e=>ra(ea(ut(e!=null?qi(Xi(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var En={};De(En,{basename:()=>bn,default:()=>Fo,delimiter:()=>Mn,dirname:()=>Tn,extname:()=>Rn,isAbsolute:()=>Jt,join:()=>An,normalize:()=>er,relative:()=>Sn,resolve:()=>dt,sep:()=>wn});function gn(e,t){for(var r=0,n=e.length-1;n>=0;n--){var s=e[n];s==="."?e.splice(n,1):s===".."?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}function dt(){for(var e="",t=!1,r=arguments.length-1;r>=-1&&!t;r--){var n=r>=0?arguments[r]:"/";if(typeof n!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!n)continue;e=n+"/"+e,t=n.charAt(0)==="/"}return e=gn(Zt(e.split("/"),function(s){return!!s}),!t).join("/"),(t?"/":"")+e||"."}function er(e){var t=Jt(e),r=Bo(e,-1)==="/";return e=gn(Zt(e.split("/"),function(n){return!!n}),!t).join("/"),!e&&!t&&(e="."),e&&r&&(e+="/"),(t?"/":"")+e}function Jt(e){return e.charAt(0)==="/"}function An(){var e=Array.prototype.slice.call(arguments,0);return er(Zt(e,function(t,r){if(typeof t!="string")throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))}function Sn(e,t){e=dt(e).substr(1),t=dt(t).substr(1);function r(c){for(var h=0;h<c.length&&c[h]==="";h++);for(var f=c.length-1;f>=0&&c[f]==="";f--);return h>f?[]:c.slice(h,f-h+1)}for(var n=r(e.split("/")),s=r(t.split("/")),i=Math.min(n.length,s.length),a=i,o=0;o<i;o++)if(n[o]!==s[o]){a=o;break}for(var l=[],o=a;o<n.length;o++)l.push("..");return l=l.concat(s.slice(a)),l.join("/")}function Tn(e){var t=Qt(e),r=t[0],n=t[1];return!r&&!n?".":(n&&(n=n.substr(0,n.length-1)),r+n)}function bn(e,t){var r=Qt(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r}function Rn(e){return Qt(e)[3]}function Zt(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}var Do,Qt,wn,Mn,Fo,Bo,In=ta(()=>{Do=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,Qt=function(e){return Do.exec(e).slice(1)};wn="/",Mn=":";Fo={extname:Rn,basename:bn,dirname:Tn,sep:wn,delimiter:Mn,relative:Sn,join:An,isAbsolute:Jt,normalize:er,resolve:dt};Bo="ab".substr(-1)==="b"?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)}});var vt=Ne((Up,mt)=>{var Le=(In(),En);Le&&Le.default?mt.exports=Le.default:Le&&(mt.exports=Le);if(Le)for(let e in Le)mt.exports[e]=Le[e]});var Je=Ne((Hp,Ln)=>{"use strict";var Uo=vt(),ve="\\\\/",Cn=`[^${ve}]`,Se="\\.",Ho="\\+",ko="\\?",xt="\\/",zo="(?=.)",On="[^/]",tr=`(?:${xt}|$)`,Pn=`(?:^|${xt})`,rr=`${Se}{1,2}${tr}`,Go=`(?!${Se})`,jo=`(?!${Pn}${rr})`,Yo=`(?!${Se}{0,1}${tr})`,Ko=`(?!${rr})`,$o=`[^.${xt}]`,Vo=`${On}*?`,Nn={DOT_LITERAL:Se,PLUS_LITERAL:Ho,QMARK_LITERAL:ko,SLASH_LITERAL:xt,ONE_CHAR:zo,QMARK:On,END_ANCHOR:tr,DOTS_SLASH:rr,NO_DOT:Go,NO_DOTS:jo,NO_DOT_SLASH:Yo,NO_DOTS_SLASH:Ko,QMARK_NO_DOT:$o,STAR:Vo,START_ANCHOR:Pn},Wo={...Nn,SLASH_LITERAL:`[${ve}]`,QMARK:Cn,STAR:`${Cn}*?`,DOTS_SLASH:`${Se}{1,2}(?:[${ve}]|$)`,NO_DOT:`(?!${Se})`,NO_DOTS:`(?!(?:^|[${ve}])${Se}{1,2}(?:[${ve}]|$))`,NO_DOT_SLASH:`(?!${Se}{0,1}(?:[${ve}]|$))`,NO_DOTS_SLASH:`(?!${Se}{1,2}(?:[${ve}]|$))`,QMARK_NO_DOT:`[^.${ve}]`,START_ANCHOR:`(?:^|[${ve}])`,END_ANCHOR:`(?:[${ve}]|$)`},qo={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};Ln.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:qo,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:Uo.sep,extglobChars(e){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${e.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(e){return e===!0?Wo:Nn}}});var yt=Ne(se=>{"use strict";var Xo=vt(),Qo=!1,{REGEX_BACKSLASH:Zo,REGEX_REMOVE_BACKSLASH:Jo,REGEX_SPECIAL_CHARS:el,REGEX_SPECIAL_CHARS_GLOBAL:tl}=Je();se.isObject=e=>e!==null&&typeof e=="object"&&!Array.isArray(e);se.hasRegexChars=e=>el.test(e);se.isRegexChar=e=>e.length===1&&se.hasRegexChars(e);se.escapeRegex=e=>e.replace(tl,"\\$1");se.toPosixSlashes=e=>e.replace(Zo,"/");se.removeBackslashes=e=>e.replace(Jo,t=>t==="\\"?"":t);se.supportsLookbehinds=()=>{let e=process.version.slice(1).split(".").map(Number);return e.length===3&&e[0]>=9||e[0]===8&&e[1]>=10};se.isWindows=e=>e&&typeof e.windows=="boolean"?e.windows:Qo===!0||Xo.sep==="\\";se.escapeLast=(e,t,r)=>{let n=e.lastIndexOf(t,r);return n===-1?e:e[n-1]==="\\"?se.escapeLast(e,t,n-1):`${e.slice(0,n)}\\${e.slice(n)}`};se.removePrefix=(e,t={})=>{let r=e;return r.startsWith("./")&&(r=r.slice(2),t.prefix="./"),r};se.wrapOutput=(e,t={},r={})=>{let n=r.contains?"":"^",s=r.contains?"":"$",i=`${n}(?:${e})${s}`;return t.negated===!0&&(i=`(?:^(?!${i}).*$)`),i}});var Gn=Ne((zp,Dn)=>{"use strict";var Bn=yt(),{CHAR_ASTERISK:nr,CHAR_AT:rl,CHAR_BACKWARD_SLASH:et,CHAR_COMMA:nl,CHAR_DOT:sr,CHAR_EXCLAMATION_MARK:ir,CHAR_FORWARD_SLASH:Fn,CHAR_LEFT_CURLY_BRACE:ar,CHAR_LEFT_PARENTHESES:or,CHAR_LEFT_SQUARE_BRACKET:sl,CHAR_PLUS:il,CHAR_QUESTION_MARK:Un,CHAR_RIGHT_CURLY_BRACE:al,CHAR_RIGHT_PARENTHESES:Hn,CHAR_RIGHT_SQUARE_BRACKET:ol}=Je(),kn=e=>e===Fn||e===et,zn=e=>{e.isPrefix!==!0&&(e.depth=e.isGlobstar?Infinity:1)},ll=(e,t)=>{let r=t||{},n=e.length-1,s=r.parts===!0||r.scanToEnd===!0,i=[],a=[],o=[],l=e,c=-1,h=0,f=0,u=!1,p=!1,m=!1,v=!1,d=!1,E=!1,I=!1,g=!1,T=!1,w=!1,b=0,D,A,C={value:"",depth:0,isGlob:!1},B=()=>c>=n,x=()=>l.charCodeAt(c+1),N=()=>(D=A,l.charCodeAt(++c));for(;c<n;){A=N();let $;if(A===et){I=C.backslashes=!0,A=N(),A===ar&&(E=!0);continue}if(E===!0||A===ar){for(b++;B()!==!0&&(A=N());){if(A===et){I=C.backslashes=!0,N();continue}if(A===ar){b++;continue}if(E!==!0&&A===sr&&(A=N())===sr){if(u=C.isBrace=!0,m=C.isGlob=!0,w=!0,s===!0)continue;break}if(E!==!0&&A===nl){if(u=C.isBrace=!0,m=C.isGlob=!0,w=!0,s===!0)continue;break}if(A===al&&(b--,b===0)){E=!1,u=C.isBrace=!0,w=!0;break}}if(s===!0)continue;break}if(A===Fn){if(i.push(c),a.push(C),C={value:"",depth:0,isGlob:!1},w===!0)continue;if(D===sr&&c===h+1){h+=2;continue}f=c+1;continue}if(r.noext!==!0&&(A===il||A===rl||A===nr||A===Un||A===ir)===!0&&x()===or){if(m=C.isGlob=!0,v=C.isExtglob=!0,w=!0,A===ir&&c===h&&(T=!0),s===!0){for(;B()!==!0&&(A=N());){if(A===et){I=C.backslashes=!0,A=N();continue}if(A===Hn){m=C.isGlob=!0,w=!0;break}}continue}break}if(A===nr){if(D===nr&&(d=C.isGlobstar=!0),m=C.isGlob=!0,w=!0,s===!0)continue;break}if(A===Un){if(m=C.isGlob=!0,w=!0,s===!0)continue;break}if(A===sl){for(;B()!==!0&&($=N());){if($===et){I=C.backslashes=!0,N();continue}if($===ol){p=C.isBracket=!0,m=C.isGlob=!0,w=!0;break}}if(s===!0)continue;break}if(r.nonegate!==!0&&A===ir&&c===h){g=C.negated=!0,h++;continue}if(r.noparen!==!0&&A===or){if(m=C.isGlob=!0,s===!0){for(;B()!==!0&&(A=N());){if(A===or){I=C.backslashes=!0,A=N();continue}if(A===Hn){w=!0;break}}continue}break}if(m===!0){if(w=!0,s===!0)continue;break}}r.noext===!0&&(v=!1,m=!1);let P=l,O="",y="";h>0&&(O=l.slice(0,h),l=l.slice(h),f-=h),P&&m===!0&&f>0?(P=l.slice(0,f),y=l.slice(f)):m===!0?(P="",y=l):P=l,P&&P!==""&&P!=="/"&&P!==l&&kn(P.charCodeAt(P.length-1))&&(P=P.slice(0,-1)),r.unescape===!0&&(y&&(y=Bn.removeBackslashes(y)),P&&I===!0&&(P=Bn.removeBackslashes(P)));let _={prefix:O,input:e,start:h,base:P,glob:y,isBrace:u,isBracket:p,isGlob:m,isExtglob:v,isGlobstar:d,negated:g,negatedExtglob:T};if(r.tokens===!0&&(_.maxDepth=0,kn(A)||a.push(C),_.tokens=a),r.parts===!0||r.tokens===!0){let $;for(let k=0;k<i.length;k++){let Q=$?$+1:h,Z=i[k],ee=e.slice(Q,Z);r.tokens&&(k===0&&h!==0?(a[k].isPrefix=!0,a[k].value=O):a[k].value=ee,zn(a[k]),_.maxDepth+=a[k].depth),(k!==0||ee!=="")&&o.push(ee),$=Z}if($&&$+1<e.length){let k=e.slice($+1);o.push(k),r.tokens&&(a[a.length-1].value=k,zn(a[a.length-1]),_.maxDepth+=a[a.length-1].depth)}_.slashes=i,_.parts=o}return _};Dn.exports=ll});var $n=Ne((Gp,jn)=>{"use strict";var _t=Je(),ae=yt(),{MAX_LENGTH:Et,POSIX_REGEX_SOURCE:cl,REGEX_NON_SPECIAL_CHARS:hl,REGEX_SPECIAL_CHARS_BACKREF:fl,REPLACEMENTS:Yn}=_t,ul=(e,t)=>{if(typeof t.expandRange=="function")return t.expandRange(...e,t);e.sort();let r=`[${e.join("-")}]`;try{new RegExp(r)}catch(n){return e.map(s=>ae.escapeRegex(s)).join("..")}return r},Ge=(e,t)=>`Missing ${e}: "${t}" - use "\\\\${t}" to match literal characters`,Kn=(e,t)=>{if(typeof e!="string")throw new TypeError("Expected a string");e=Yn[e]||e;let r={...t},n=typeof r.maxLength=="number"?Math.min(Et,r.maxLength):Et,s=e.length;if(s>n)throw new SyntaxError(`Input length: ${s}, exceeds maximum allowed length: ${n}`);let i={type:"bos",value:"",output:r.prepend||""},a=[i],o=r.capture?"":"?:",l=ae.isWindows(t),c=_t.globChars(l),h=_t.extglobChars(c),{DOT_LITERAL:f,PLUS_LITERAL:u,SLASH_LITERAL:p,ONE_CHAR:m,DOTS_SLASH:v,NO_DOT:d,NO_DOT_SLASH:E,NO_DOTS_SLASH:I,QMARK:g,QMARK_NO_DOT:T,STAR:w,START_ANCHOR:b}=c,D=R=>`(${o}(?:(?!${b}${R.dot?v:f}).)*?)`,A=r.dot?"":d,C=r.dot?g:T,B=r.bash===!0?D(r):w;r.capture&&(B=`(${B})`),typeof r.noext=="boolean"&&(r.noextglob=r.noext);let x={input:e,index:-1,start:0,dot:r.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:a};e=ae.removePrefix(e,x),s=e.length;let N=[],P=[],O=[],y=i,_,$=()=>x.index===s-1,k=x.peek=(R=1)=>e[x.index+R],Q=x.advance=()=>e[++x.index]||"",Z=()=>e.slice(x.index+1),ee=(R="",Y=0)=>{x.consumed+=R,x.index+=Y},de=R=>{x.output+=R.output!=null?R.output:R.value,ee(R.value)},Qe=()=>{let R=1;for(;k()==="!"&&(k(2)!=="("||k(3)==="?");)Q(),x.start++,R++;return R%2==0?!1:(x.negated=!0,x.start++,!0)},Ie=R=>{x[R]++,O.push(R)},me=R=>{x[R]--,O.pop()},U=R=>{if(y.type==="globstar"){let Y=x.braces>0&&(R.type==="comma"||R.type==="brace"),S=R.extglob===!0||N.length&&(R.type==="pipe"||R.type==="paren");R.type!=="slash"&&R.type!=="paren"&&!Y&&!S&&(x.output=x.output.slice(0,-y.output.length),y.type="star",y.value="*",y.output=B,x.output+=y.output)}if(N.length&&R.type!=="paren"&&(N[N.length-1].inner+=R.value),(R.value||R.output)&&de(R),y&&y.type==="text"&&R.type==="text"){y.value+=R.value,y.output=(y.output||"")+R.value;return}R.prev=y,a.push(R),y=R},Pe=(R,Y)=>{let S={...h[Y],conditions:1,inner:""};S.prev=y,S.parens=x.parens,S.output=x.output;let H=(r.capture?"(":"")+S.open;Ie("parens"),U({type:R,value:Y,output:x.output?"":m}),U({type:"paren",extglob:!0,value:Q(),output:H}),N.push(S)},ht=R=>{let Y=R.close+(r.capture?")":""),S;if(R.type==="negate"){let H=B;R.inner&&R.inner.length>1&&R.inner.includes("/")&&(H=D(r)),(H!==B||$()||/^\)+$/.test(Z()))&&(Y=R.close=`)$))${H}`),R.inner.includes("*")&&(S=Z())&&/^\.[^\\/.]+$/.test(S)&&(Y=R.close=`)${S})${H})`),R.prev.type==="bos"&&(x.negatedExtglob=!0)}U({type:"paren",extglob:!0,value:_,output:Y}),me("parens")};if(r.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(e)){let R=!1,Y=e.replace(fl,(S,H,V,ne,q,Ht)=>ne==="\\"?(R=!0,S):ne==="?"?H?H+ne+(q?g.repeat(q.length):""):Ht===0?C+(q?g.repeat(q.length):""):g.repeat(V.length):ne==="."?f.repeat(V.length):ne==="*"?H?H+ne+(q?B:""):B:H?S:`\\${S}`);return R===!0&&(r.unescape===!0?Y=Y.replace(/\\/g,""):Y=Y.replace(/\\+/g,S=>S.length%2==0?"\\\\":S?"\\":"")),Y===e&&r.contains===!0?(x.output=e,x):(x.output=ae.wrapOutput(Y,x,t),x)}for(;!$();){if(_=Q(),_==="\0")continue;if(_==="\\"){let S=k();if(S==="/"&&r.bash!==!0||S==="."||S===";")continue;if(!S){_+="\\",U({type:"text",value:_});continue}let H=/^\\+/.exec(Z()),V=0;if(H&&H[0].length>2&&(V=H[0].length,x.index+=V,V%2!=0&&(_+="\\")),r.unescape===!0?_=Q():_+=Q(),x.brackets===0){U({type:"text",value:_});continue}}if(x.brackets>0&&(_!=="]"||y.value==="["||y.value==="[^")){if(r.posix!==!1&&_===":"){let S=y.value.slice(1);if(S.includes("[")&&(y.posix=!0,S.includes(":"))){let H=y.value.lastIndexOf("["),V=y.value.slice(0,H),ne=y.value.slice(H+2),q=cl[ne];if(q){y.value=V+q,x.backtrack=!0,Q(),!i.output&&a.indexOf(y)===1&&(i.output=m);continue}}}(_==="["&&k()!==":"||_==="-"&&k()==="]")&&(_=`\\${_}`),_==="]"&&(y.value==="["||y.value==="[^")&&(_=`\\${_}`),r.posix===!0&&_==="!"&&y.value==="["&&(_="^"),y.value+=_,de({value:_});continue}if(x.quotes===1&&_!=='"'){_=ae.escapeRegex(_),y.value+=_,de({value:_});continue}if(_==='"'){x.quotes=x.quotes===1?0:1,r.keepQuotes===!0&&U({type:"text",value:_});continue}if(_==="("){Ie("parens"),U({type:"paren",value:_});continue}if(_===")"){if(x.parens===0&&r.strictBrackets===!0)throw new SyntaxError(Ge("opening","("));let S=N[N.length-1];if(S&&x.parens===S.parens+1){ht(N.pop());continue}U({type:"paren",value:_,output:x.parens?")":"\\)"}),me("parens");continue}if(_==="["){if(r.nobracket===!0||!Z().includes("]")){if(r.nobracket!==!0&&r.strictBrackets===!0)throw new SyntaxError(Ge("closing","]"));_=`\\${_}`}else Ie("brackets");U({type:"bracket",value:_});continue}if(_==="]"){if(r.nobracket===!0||y&&y.type==="bracket"&&y.value.length===1){U({type:"text",value:_,output:`\\${_}`});continue}if(x.brackets===0){if(r.strictBrackets===!0)throw new SyntaxError(Ge("opening","["));U({type:"text",value:_,output:`\\${_}`});continue}me("brackets");let S=y.value.slice(1);if(y.posix!==!0&&S[0]==="^"&&!S.includes("/")&&(_=`/${_}`),y.value+=_,de({value:_}),r.literalBrackets===!1||ae.hasRegexChars(S))continue;let H=ae.escapeRegex(y.value);if(x.output=x.output.slice(0,-y.value.length),r.literalBrackets===!0){x.output+=H,y.value=H;continue}y.value=`(${o}${H}|${y.value})`,x.output+=y.value;continue}if(_==="{"&&r.nobrace!==!0){Ie("braces");let S={type:"brace",value:_,output:"(",outputIndex:x.output.length,tokensIndex:x.tokens.length};P.push(S),U(S);continue}if(_==="}"){let S=P[P.length-1];if(r.nobrace===!0||!S){U({type:"text",value:_,output:_});continue}let H=")";if(S.dots===!0){let V=a.slice(),ne=[];for(let q=V.length-1;q>=0&&(a.pop(),V[q].type!=="brace");q--)V[q].type!=="dots"&&ne.unshift(V[q].value);H=ul(ne,r),x.backtrack=!0}if(S.comma!==!0&&S.dots!==!0){let V=x.output.slice(0,S.outputIndex),ne=x.tokens.slice(S.tokensIndex);S.value=S.output="\\{",_=H="\\}",x.output=V;for(let q of ne)x.output+=q.output||q.value}U({type:"brace",value:_,output:H}),me("braces"),P.pop();continue}if(_==="|"){N.length>0&&N[N.length-1].conditions++,U({type:"text",value:_});continue}if(_===","){let S=_,H=P[P.length-1];H&&O[O.length-1]==="braces"&&(H.comma=!0,S="|"),U({type:"comma",value:_,output:S});continue}if(_==="/"){if(y.type==="dot"&&x.index===x.start+1){x.start=x.index+1,x.consumed="",x.output="",a.pop(),y=i;continue}U({type:"slash",value:_,output:p});continue}if(_==="."){if(x.braces>0&&y.type==="dot"){y.value==="."&&(y.output=f);let S=P[P.length-1];y.type="dots",y.output+=_,y.value+=_,S.dots=!0;continue}if(x.braces+x.parens===0&&y.type!=="bos"&&y.type!=="slash"){U({type:"text",value:_,output:f});continue}U({type:"dot",value:_,output:f});continue}if(_==="?"){if(!(y&&y.value==="(")&&r.noextglob!==!0&&k()==="("&&k(2)!=="?"){Pe("qmark",_);continue}if(y&&y.type==="paren"){let H=k(),V=_;if(H==="<"&&!ae.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(y.value==="("&&!/[!=<:]/.test(H)||H==="<"&&!/<([!=]|\w+>)/.test(Z()))&&(V=`\\${_}`),U({type:"text",value:_,output:V});continue}if(r.dot!==!0&&(y.type==="slash"||y.type==="bos")){U({type:"qmark",value:_,output:T});continue}U({type:"qmark",value:_,output:g});continue}if(_==="!"){if(r.noextglob!==!0&&k()==="("&&(k(2)!=="?"||!/[!=<:]/.test(k(3)))){Pe("negate",_);continue}if(r.nonegate!==!0&&x.index===0){Qe();continue}}if(_==="+"){if(r.noextglob!==!0&&k()==="("&&k(2)!=="?"){Pe("plus",_);continue}if(y&&y.value==="("||r.regex===!1){U({type:"plus",value:_,output:u});continue}if(y&&(y.type==="bracket"||y.type==="paren"||y.type==="brace")||x.parens>0){U({type:"plus",value:_});continue}U({type:"plus",value:u});continue}if(_==="@"){if(r.noextglob!==!0&&k()==="("&&k(2)!=="?"){U({type:"at",extglob:!0,value:_,output:""});continue}U({type:"text",value:_});continue}if(_!=="*"){(_==="$"||_==="^")&&(_=`\\${_}`);let S=hl.exec(Z());S&&(_+=S[0],x.index+=S[0].length),U({type:"text",value:_});continue}if(y&&(y.type==="globstar"||y.star===!0)){y.type="star",y.star=!0,y.value+=_,y.output=B,x.backtrack=!0,x.globstar=!0,ee(_);continue}let R=Z();if(r.noextglob!==!0&&/^\([^?]/.test(R)){Pe("star",_);continue}if(y.type==="star"){if(r.noglobstar===!0){ee(_);continue}let S=y.prev,H=S.prev,V=S.type==="slash"||S.type==="bos",ne=H&&(H.type==="star"||H.type==="globstar");if(r.bash===!0&&(!V||R[0]&&R[0]!=="/")){U({type:"star",value:_,output:""});continue}let q=x.braces>0&&(S.type==="comma"||S.type==="brace"),Ht=N.length&&(S.type==="pipe"||S.type==="paren");if(!V&&S.type!=="paren"&&!q&&!Ht){U({type:"star",value:_,output:""});continue}for(;R.slice(0,3)==="/**";){let ft=e[x.index+4];if(ft&&ft!=="/")break;R=R.slice(3),ee("/**",3)}if(S.type==="bos"&&$()){y.type="globstar",y.value+=_,y.output=D(r),x.output=y.output,x.globstar=!0,ee(_);continue}if(S.type==="slash"&&S.prev.type!=="bos"&&!ne&&$()){x.output=x.output.slice(0,-(S.output+y.output).length),S.output=`(?:${S.output}`,y.type="globstar",y.output=D(r)+(r.strictSlashes?")":"|$)"),y.value+=_,x.globstar=!0,x.output+=S.output+y.output,ee(_);continue}if(S.type==="slash"&&S.prev.type!=="bos"&&R[0]==="/"){let ft=R[1]!==void 0?"|$":"";x.output=x.output.slice(0,-(S.output+y.output).length),S.output=`(?:${S.output}`,y.type="globstar",y.output=`${D(r)}${p}|${p}${ft})`,y.value+=_,x.output+=S.output+y.output,x.globstar=!0,ee(_+Q()),U({type:"slash",value:"/",output:""});continue}if(S.type==="bos"&&R[0]==="/"){y.type="globstar",y.value+=_,y.output=`(?:^|${p}|${D(r)}${p})`,x.output=y.output,x.globstar=!0,ee(_+Q()),U({type:"slash",value:"/",output:""});continue}x.output=x.output.slice(0,-y.output.length),y.type="globstar",y.output=D(r),y.value+=_,x.output+=y.output,x.globstar=!0,ee(_);continue}let Y={type:"star",value:_,output:B};if(r.bash===!0){Y.output=".*?",(y.type==="bos"||y.type==="slash")&&(Y.output=A+Y.output),U(Y);continue}if(y&&(y.type==="bracket"||y.type==="paren")&&r.regex===!0){Y.output=_,U(Y);continue}(x.index===x.start||y.type==="slash"||y.type==="dot")&&(y.type==="dot"?(x.output+=E,y.output+=E):r.dot===!0?(x.output+=I,y.output+=I):(x.output+=A,y.output+=A),k()!=="*"&&(x.output+=m,y.output+=m)),U(Y)}for(;x.brackets>0;){if(r.strictBrackets===!0)throw new SyntaxError(Ge("closing","]"));x.output=ae.escapeLast(x.output,"["),me("brackets")}for(;x.parens>0;){if(r.strictBrackets===!0)throw new SyntaxError(Ge("closing",")"));x.output=ae.escapeLast(x.output,"("),me("parens")}for(;x.braces>0;){if(r.strictBrackets===!0)throw new SyntaxError(Ge("closing","}"));x.output=ae.escapeLast(x.output,"{"),me("braces")}if(r.strictSlashes!==!0&&(y.type==="star"||y.type==="bracket")&&U({type:"maybe_slash",value:"",output:`${p}?`}),x.backtrack===!0){x.output="";for(let R of x.tokens)x.output+=R.output!=null?R.output:R.value,R.suffix&&(x.output+=R.suffix)}return x};Kn.fastpaths=(e,t)=>{let r={...t},n=typeof r.maxLength=="number"?Math.min(Et,r.maxLength):Et,s=e.length;if(s>n)throw new SyntaxError(`Input length: ${s}, exceeds maximum allowed length: ${n}`);e=Yn[e]||e;let i=ae.isWindows(t),{DOT_LITERAL:a,SLASH_LITERAL:o,ONE_CHAR:l,DOTS_SLASH:c,NO_DOT:h,NO_DOTS:f,NO_DOTS_SLASH:u,STAR:p,START_ANCHOR:m}=_t.globChars(i),v=r.dot?f:h,d=r.dot?u:h,E=r.capture?"":"?:",I={negated:!1,prefix:""},g=r.bash===!0?".*?":p;r.capture&&(g=`(${g})`);let T=A=>A.noglobstar===!0?g:`(${E}(?:(?!${m}${A.dot?c:a}).)*?)`,w=A=>{switch(A){case"*":return`${v}${l}${g}`;case".*":return`${a}${l}${g}`;case"*.*":return`${v}${g}${a}${l}${g}`;case"*/*":return`${v}${g}${o}${l}${d}${g}`;case"**":return v+T(r);case"**/*":return`(?:${v}${T(r)}${o})?${d}${l}${g}`;case"**/*.*":return`(?:${v}${T(r)}${o})?${d}${g}${a}${l}${g}`;case"**/.*":return`(?:${v}${T(r)}${o})?${a}${l}${g}`;default:{let C=/^(.*?)\.(\w+)$/.exec(A);if(!C)return;let B=w(C[1]);return B?B+a+C[2]:void 0}}},b=ae.removePrefix(e,I),D=w(b);return D&&r.strictSlashes!==!0&&(D+=`${o}?`),D};jn.exports=Kn});var Wn=Ne((jp,Vn)=>{"use strict";var pl=vt(),dl=Gn(),lr=$n(),cr=yt(),ml=Je(),vl=e=>e&&typeof e=="object"&&!Array.isArray(e),W=(e,t,r=!1)=>{if(Array.isArray(e)){let h=e.map(u=>W(u,t,r));return u=>{for(let p of h){let m=p(u);if(m)return m}return!1}}let n=vl(e)&&e.tokens&&e.input;if(e===""||typeof e!="string"&&!n)throw new TypeError("Expected pattern to be a non-empty string");let s=t||{},i=cr.isWindows(t),a=n?W.compileRe(e,t):W.makeRe(e,t,!1,!0),o=a.state;delete a.state;let l=()=>!1;if(s.ignore){let h={...t,ignore:null,onMatch:null,onResult:null};l=W(s.ignore,h,r)}let c=(h,f=!1)=>{let{isMatch:u,match:p,output:m}=W.test(h,a,t,{glob:e,posix:i}),v={glob:e,state:o,regex:a,posix:i,input:h,output:m,match:p,isMatch:u};return typeof s.onResult=="function"&&s.onResult(v),u===!1?(v.isMatch=!1,f?v:!1):l(h)?(typeof s.onIgnore=="function"&&s.onIgnore(v),v.isMatch=!1,f?v:!1):(typeof s.onMatch=="function"&&s.onMatch(v),f?v:!0)};return r&&(c.state=o),c};W.test=(e,t,r,{glob:n,posix:s}={})=>{if(typeof e!="string")throw new TypeError("Expected input to be a string");if(e==="")return{isMatch:!1,output:""};let i=r||{},a=i.format||(s?cr.toPosixSlashes:null),o=e===n,l=o&&a?a(e):e;return o===!1&&(l=a?a(e):e,o=l===n),(o===!1||i.capture===!0)&&(i.matchBase===!0||i.basename===!0?o=W.matchBase(e,t,r,s):o=t.exec(l)),{isMatch:Boolean(o),match:o,output:l}};W.matchBase=(e,t,r,n=cr.isWindows(r))=>(t instanceof RegExp?t:W.makeRe(t,r)).test(pl.basename(e));W.isMatch=(e,t,r)=>W(t,r)(e);W.parse=(e,t)=>Array.isArray(e)?e.map(r=>W.parse(r,t)):lr(e,{...t,fastpaths:!1});W.scan=(e,t)=>dl(e,t);W.compileRe=(e,t,r=!1,n=!1)=>{if(r===!0)return e.output;let s=t||{},i=s.contains?"":"^",a=s.contains?"":"$",o=`${i}(?:${e.output})${a}`;e&&e.negated===!0&&(o=`^(?!${o}).*$`);let l=W.toRegex(o,t);return n===!0&&(l.state=e),l};W.makeRe=(e,t={},r=!1,n=!1)=>{if(!e||typeof e!="string")throw new TypeError("Expected a non-empty string");let s={negated:!1,fastpaths:!0};return t.fastpaths!==!1&&(e[0]==="."||e[0]==="*")&&(s.output=lr.fastpaths(e,t)),s.output||(s=lr(e,t)),W.compileRe(s,t,r,n)};W.toRegex=(e,t)=>{try{let r=t||{};return new RegExp(e,r.flags||(r.nocase?"i":""))}catch(r){if(t&&t.debug===!0)throw r;return/$^/}};W.constants=ml;Vn.exports=W});var Xn=Ne((Yp,qn)=>{"use strict";qn.exports=Wn()});var sa=`<div class="container">
  <label class="hidden" id="title">display-port</label>
  <label class="hidden" id="fps">00</label>
  <label class="hidden" id="dimension">0x0</label>
  <div class="content">
    <canvas> Oh no! Your browser does not support canvas. </canvas>
    <slot id="inner"></slot>
  </div>
  <slot name="frame"></slot>
</div>
`,ia=`:host {
  display: inline-block;
  color: #555555;
}

.container {
  display: flex;
  position: relative;
  width: 100%;
  height: 100%;
}

.content {
  position: relative;
  margin: auto;
}

.content > *:not(canvas) {
  width: 100%;
  height: 100%;
}

canvas {
  background: #000000;
  image-rendering: pixelated;
}

label {
  position: absolute;
  font-family: monospace;
  color: currentColor;
}

#inner {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: 0;
  left: 0;
  pointer-events: none;
}

#title {
  left: 0.5rem;
  top: 0.5rem;
}

#fps {
  right: 0.5rem;
  top: 0.5rem;
}

#dimension {
  left: 0.5rem;
  bottom: 0.5rem;
}

.hidden {
  display: none;
}

:host([debug]) .container {
  outline: 6px dashed rgba(0, 0, 0, 0.1);
  outline-offset: -4px;
  background-color: rgba(0, 0, 0, 0.1);
}

:host([mode='noscale']) canvas {
  margin: 0;
  top: 0;
  left: 0;
}

:host([mode='stretch']) canvas,
:host([mode='scale']) canvas {
  width: 100%;
  height: 100%;
}

:host([mode='fit']),
:host([mode='scale']),
:host([mode='center']),
:host([mode='stretch']),
:host([mode='fill']) {
  width: 100%;
  height: 100%;
}

:host([full]) {
  width: 100vw !important;
  height: 100vh !important;
}

:host([disabled]) {
  display: none;
}

slot {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  pointer-events: none;
}

::slotted(*) {
  pointer-events: auto;
}
`,sn="noscale",kt="fit",an="scale",on="fill",ln="stretch",aa=300,oa=150,la=kt,ca=200,cn=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=sa,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=ia,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("display-port",this)}static get observedAttributes(){return["debug","disabled","width","height","onframe","id","class"]}get mode(){return this.getAttribute("mode")}set mode(t){this.setAttribute("mode",t)}get debug(){return this._debug}set debug(t){this.toggleAttribute("debug",t)}get disabled(){return this._disabled}set disabled(t){this.toggleAttribute("disabled",t)}get width(){return this._width}set width(t){this.setAttribute("width",String(t))}get height(){return this._height}set height(t){this.setAttribute("height",String(t))}get onframe(){return this._onframe}set onframe(t){this._onframe&&this.removeEventListener("frame",this._onframe),this._onframe=t,this._onframe&&this.addEventListener("frame",t)}constructor(){super();let t=this.attachShadow({mode:"open"});t.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),t.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._canvasElement=t.querySelector("canvas"),this._contentElement=t.querySelector(".content"),this._innerElement=t.querySelector("#inner"),this._titleElement=t.querySelector("#title"),this._fpsElement=t.querySelector("#fps"),this._dimensionElement=t.querySelector("#dimension"),this._debug=!1,this._disabled=!1,this._width=aa,this._height=oa,this._onframe=void 0,this._animationRequestHandle=0,this._prevAnimationFrameTime=0,this._resizeTimeoutHandle=0,this._resizeCanvasWidth=0,this._resizeCanvasHeight=0,this._frameEvent=new CustomEvent("frame",{composed:!0,bubbles:!1,detail:{now:0,prevTime:0,deltaTime:0,canvas:this._canvasElement}}),this._resizeEvent=new CustomEvent("resize",{composed:!0,bubbles:!1,detail:{width:0,height:0}}),this.update=this.update.bind(this),this.onDelayCanvasResize=this.onDelayCanvasResize.bind(this)}get canvas(){return this._canvasElement}connectedCallback(){ze(this,"mode"),ze(this,"debug"),ze(this,"disabled"),ze(this,"width"),ze(this,"height"),ze(this,"onframe"),this.hasAttribute("mode")||this.setAttribute("mode",la),this.hasAttribute("tabindex")||this.setAttribute("tabindex","0"),this.updateCanvasSize(!0),this.resume()}disconnectedCallback(){this.pause()}attributeChangedCallback(t,r,n){switch(t){case"debug":this._debug=n!==null;break;case"disabled":this._disabled=n!==null;break;case"width":this._width=Number(n);break;case"height":this._height=Number(n);break;case"onframe":this.onframe=new Function("event","with(document){with(this){"+n+"}}").bind(this);break}switch(t){case"disabled":n?(this.update(0),this.pause()):this.resume();break;case"id":case"class":this._titleElement.innerHTML=`display-port${this.className?"."+this.className:""}${this.hasAttribute("id")?"#"+this.getAttribute("id"):""}`;break;case"debug":this._titleElement.classList.toggle("hidden",n),this._fpsElement.classList.toggle("hidden",n),this._dimensionElement.classList.toggle("hidden",n);break}}getContext(t="2d",r=void 0){return this._canvasElement.getContext(t,r)}pause(){cancelAnimationFrame(this._animationRequestHandle)}resume(){this._animationRequestHandle=requestAnimationFrame(this.update)}update(t){this._animationRequestHandle=requestAnimationFrame(this.update),this.updateCanvasSize(!1);let r=t-this._prevAnimationFrameTime;if(this._prevAnimationFrameTime=t,this._debug){let i=r<=0?"--":String(Math.round(1e3/r)).padStart(2,"0");if(this._fpsElement.textContent!==i&&(this._fpsElement.textContent=i),this.mode===sn){let o=`${this._width}x${this._height}`;this._dimensionElement.textContent!==o&&(this._dimensionElement.textContent=o)}else{let o=`${this._width}x${this._height}|${this.shadowRoot.host.clientWidth}x${this.shadowRoot.host.clientHeight}`;this._dimensionElement.textContent!==o&&(this._dimensionElement.textContent=o)}}let s=this._frameEvent.detail;s.now=t,s.prevTime=this._prevAnimationFrameTime,s.deltaTime=r,this.dispatchEvent(this._frameEvent)}onDelayCanvasResize(){this._resizeTimeoutHandle=0,this.updateCanvasSize(!0)}delayCanvasResize(t,r){(t!==this._resizeCanvasWidth||r!==this._resizeCanvasHeight)&&(this._resizeCanvasWidth=t,this._resizeCanvasHeight=r,this._resizeTimeoutHandle&&clearTimeout(this._resizeTimeoutHandle),this._resizeTimeoutHandle=setTimeout(this.onDelayCanvasResize,ca))}updateCanvasSize(t=!0){let r=this.shadowRoot.host.getBoundingClientRect(),n=r.width,s=r.height,i=this._canvasElement,a=this._width,o=this._height,l=this.mode;if(l===ln||l===on)a=n,o=s;else if(l!==sn&&(n<a||s<o||l===kt||l==an)){let h=n/a,f=s/o;h<f?(a=n,o=o*h):(a=a*f,o=s)}if(a=Math.floor(a),o=Math.floor(o),typeof t=="undefined"&&(t=i.clientWidth!==a||i.clientHeight!==o),!t){this.delayCanvasResize(a,o);return}let c=Math.min(a/this._width,o/this._height)*.5;if(this._innerElement.style.fontSize=`font-size: ${c}em`,t){l===an?(i.width=this._width,i.height=this._height):l!==ln&&(i.width=a,i.height=o);let h=this._contentElement.style;h.width=`${a}px`,h.height=`${o}px`,(l===kt||l===on)&&(this._width=a,this._height=o);let u=this._resizeEvent.detail;u.width=a,u.height=o,this.dispatchEvent(this._resizeEvent)}}};cn.define();function ze(e,t){if(Object.prototype.hasOwnProperty.call(e,t)){let r=e[t];delete e[t],e[t]=r}}var zt=class{get polling(){return performance.now()-this._lastPollingTime<1e3}get value(){return 0}get size(){return this._size}constructor(t){this._size=t,this._lastPollingTime=Number.MIN_SAFE_INTEGER}resize(t){this._size=t}getState(t){throw new Error("Missing implementation.")}onUpdate(t,r,n){throw new Error("Missing implementation.")}onStatus(t,r){throw new Error("Missing implementation.")}onPoll(t){this._lastPollingTime=t}onBind(t,r={}){t>=this._size&&this.resize(t+1)}onUnbind(){this.resize(0)}},Ze=class extends zt{static createAxisBindingState(){return{value:0,delta:0,inverted:!1}}get delta(){return this._delta}get value(){return this._value}constructor(t=0){super(t);let r=new Array;for(let n=0;n<t;++n)r.push(this.constructor.createAxisBindingState());this._state=r,this._value=0,this._delta=0}resize(t){let r=this._state,n=r.length,s;if(t<=n)s=r.slice(0,t);else{s=r;for(let i=n;i<t;++i)s.push(this.constructor.createAxisBindingState())}this._state=s,super.resize(t)}getState(t){return this._state[t].value}onPoll(t){let r=this._state,n=0,s=0,i=r.length;for(let a=0;a<i;++a){let o=r[a];n+=o.value*(o.inverted?-1:1),s+=o.delta,r[a].delta=0}this._value=n,this._delta=s,super.onPoll(t)}onUpdate(t,r,n){typeof r=="undefined"?this.onAxisChange(t,n):this.onAxisMove(t,r,n)}onStatus(t,r){this.onAxisStatus(t,r)}onBind(t,r={}){super.onBind(t,r);let{inverted:n=!1}=r,s=this._state;s[t].inverted=n}onAxisMove(t,r,n){let s=this._state[t];s.value=r,s.delta+=n}onAxisChange(t,r){let n=this._state[t];n.value+=r,n.delta+=r}onAxisStatus(t,r){let n=this._state[t],s=n.value;n.value=r,n.delta=r-s}},ha=241,hn=254,fa=239,Be=1,Gt=2,jt=4,Yt=8,Kt=16,pt=class extends zt{get pressed(){return this._pressed}get repeated(){return this._repeated}get released(){return this._released}get down(){return this._down}get value(){return this._value}constructor(t=0){super(t);this._state=new Uint8Array(t),this._value=0,this._down=!1,this._pressed=!1,this._repeated=!1,this._released=!1}resize(t){let r=this._state,n=r.length,s;t<=n?s=r.slice(0,t):(s=new Uint8Array(t),s.set(r)),this._state=s,super.resize(t)}getState(t){let r=this._state[t],n=r&Kt?-1:1;return(r&Be?1:0)*n}onPoll(t){let r=this._state,n=0,s=0,i=0,a=0,o=0,l=r.length;for(let c=0;c<l;++c){let h=r[c],f=h&Be,u=h&Kt;s|=f,i|=h&Gt,a|=h&jt,o|=h&Yt,n+=(f?1:0)*(u?-1:1),r[c]&=ha}this._value=n,this._down=s!==0,this._pressed=i!==0,this._repeated=a!==0,this._released=o!==0,super.onPoll(t)}onUpdate(t,r,n){n>0?this.onButtonPressed(t):this.onButtonReleased(t)}onStatus(t,r){this.onButtonStatus(t,r!==0)}onBind(t,r={}){super.onBind(t,r);let{inverted:n=!1}=r,s=this._state;n?s[t]|=Kt:s[t]&=fa}onButtonPressed(t){let r=this._state,n=r[t];n&Be||(n|=Gt,n|=Be),n|=jt,r[t]=n}onButtonReleased(t){let r=this._state,n=r[t];n&Be&&(n|=Yt,n&=hn),r[t]=n}onButtonStatus(t,r){let n=this._state,s=n[t],i=Boolean(s&Be);r?s|=Be:s&=hn,i&&!r&&(s|=Yt),!i&&r&&(s|=Gt,s|=jt),n[t]=s}},M=class{static parse(t){t=t.trim();let r=t.indexOf(".");if(r<0)throw new Error("Missing device separator for key code.");let n=t.substring(0,r);if(n.length<0)throw new Error("Missing device for key code.");let s=t.substring(r+1);if(s.length<0)throw new Error("Missing code for key code.");return new M(n,s)}constructor(t,r){this.device=t,this.code=r}toString(){return`${this.device}.${this.code}`}};function fn(e,t){return new M(e,t)}function ua(e){return"device"in e&&"code"in e}var L="Keyboard",ue="Mouse",pa=new M(L,"KeyA"),da=new M(L,"KeyB"),ma=new M(L,"KeyC"),va=new M(L,"KeyD"),xa=new M(L,"KeyE"),ya=new M(L,"KeyF"),_a=new M(L,"KeyG"),Ea=new M(L,"KeyH"),ga=new M(L,"KeyI"),Aa=new M(L,"KeyJ"),Sa=new M(L,"KeyK"),wa=new M(L,"KeyL"),Ma=new M(L,"KeyM"),Ta=new M(L,"KeyN"),ba=new M(L,"KeyO"),Ra=new M(L,"KeyP"),Ia=new M(L,"KeyQ"),La=new M(L,"KeyR"),Ca=new M(L,"KeyS"),Oa=new M(L,"KeyT"),Pa=new M(L,"KeyU"),Na=new M(L,"KeyV"),Da=new M(L,"KeyW"),Ba=new M(L,"KeyX"),Fa=new M(L,"KeyY"),Ua=new M(L,"KeyZ"),Ha=new M(L,"Digit0"),ka=new M(L,"Digit1"),za=new M(L,"Digit2"),Ga=new M(L,"Digit3"),ja=new M(L,"Digit4"),Ya=new M(L,"Digit5"),Ka=new M(L,"Digit6"),$a=new M(L,"Digit7"),Va=new M(L,"Digit8"),Wa=new M(L,"Digit9"),qa=new M(L,"Minus"),Xa=new M(L,"Equal"),Qa=new M(L,"BracketLeft"),Za=new M(L,"BracketRight"),Ja=new M(L,"Semicolon"),eo=new M(L,"Quote"),to=new M(L,"Backquote"),ro=new M(L,"Backslash"),no=new M(L,"Comma"),so=new M(L,"Period"),io=new M(L,"Slash"),ao=new M(L,"Escape"),oo=new M(L,"Space"),lo=new M(L,"CapsLock"),co=new M(L,"Backspace"),ho=new M(L,"Delete"),fo=new M(L,"Tab"),uo=new M(L,"Enter"),po=new M(L,"ArrowUp"),mo=new M(L,"ArrowDown"),vo=new M(L,"ArrowLeft"),xo=new M(L,"ArrowRight"),yo=new M(ue,"Button0"),_o=new M(ue,"Button1"),Eo=new M(ue,"Button2"),go=new M(ue,"Button3"),Ao=new M(ue,"Button4"),So=new M(ue,"PosX"),wo=new M(ue,"PosY"),Mo=new M(ue,"WheelX"),To=new M(ue,"WheelY"),bo=new M(ue,"WheelZ"),ge=Object.freeze({__proto__:null,from:fn,isKeyCode:ua,KEYBOARD:L,MOUSE:ue,KEY_A:pa,KEY_B:da,KEY_C:ma,KEY_D:va,KEY_E:xa,KEY_F:ya,KEY_G:_a,KEY_H:Ea,KEY_I:ga,KEY_J:Aa,KEY_K:Sa,KEY_L:wa,KEY_M:Ma,KEY_N:Ta,KEY_O:ba,KEY_P:Ra,KEY_Q:Ia,KEY_R:La,KEY_S:Ca,KEY_T:Oa,KEY_U:Pa,KEY_V:Na,KEY_W:Da,KEY_X:Ba,KEY_Y:Fa,KEY_Z:Ua,DIGIT_0:Ha,DIGIT_1:ka,DIGIT_2:za,DIGIT_3:Ga,DIGIT_4:ja,DIGIT_5:Ya,DIGIT_6:Ka,DIGIT_7:$a,DIGIT_8:Va,DIGIT_9:Wa,MINUS:qa,EQUAL:Xa,BRACKET_LEFT:Qa,BRACKET_RIGHT:Za,SEMICOLON:Ja,QUOTE:eo,BACKQUOTE:to,BACKSLASH:ro,COMMA:no,PERIOD:so,SLASH:io,ESCAPE:ao,SPACE:oo,CAPS_LOCK:lo,BACKSPACE:co,DELETE:ho,TAB:fo,ENTER:uo,ARROW_UP:po,ARROW_DOWN:mo,ARROW_LEFT:vo,ARROW_RIGHT:xo,MOUSE_BUTTON_0:yo,MOUSE_BUTTON_1:_o,MOUSE_BUTTON_2:Eo,MOUSE_BUTTON_3:go,MOUSE_BUTTON_4:Ao,MOUSE_POS_X:So,MOUSE_POS_Y:wo,MOUSE_WHEEL_X:Mo,MOUSE_WHEEL_Y:To,MOUSE_WHEEL_Z:bo}),un=class{get polling(){return this.ref?this.ref.polling:!1}get value(){return!this.ref||this.disabled?0:this.ref.value}constructor(t){this.name=t,this.ref=null,this.disabled=!1}register(t){throw new Error("Unsupported operation.")}disable(t=!0){return this.disabled=t,this}getState(t){return!this.ref||this.disabled?0:this.ref.getState(t)}};function Io(e){Array.isArray(e)||(e=[e]);let t=[];for(let r of e){let n;try{n=M.parse(r)}catch(s){let i=Ro(r).toUpperCase();if(!(i in ge))throw new Error("Invalid key code string - "+s);n=ge[i]}t.push(n)}return t}function Ro(e){return e.replace(/([a-z]|(?:[A-Z0-9]+))([A-Z0-9]|$)/g,function(t,r,n){return r+(n&&"_"+n)}).toLowerCase()}var Ae=class extends un{static fromBind(t,r,n,s=void 0){return new Ae(t,fn(r,n),s)}static fromString(t,...r){let n=Io(r);return new Ae(t,n)}get pressed(){return!this.ref||this.disabled?!1:this.ref.pressed}get repeated(){return!this.ref||this.disabled?!1:this.ref.repeated}get released(){return!this.ref||this.disabled?!1:this.ref.released}get down(){return!this.ref||this.disabled?!1:this.ref.down}constructor(t,r,n=void 0){super(t);this.keyCodes=Array.isArray(r)?r:[r],this.opts=n}register(t){let r=this.name,n=this.opts;for(let s of this.keyCodes)t.bindButton(r,s.device,s.code,n);return this.ref=t.getButton(r),this}};var $t=class{static isAxis(t){return!1}static isButton(t){return!1}constructor(t,r){if(!r)throw new Error(`Missing event target for device ${t}.`);this.name=t,this.eventTarget=r,this.listeners={input:[]}}setEventTarget(t){if(!t)throw new Error(`Missing event target for device ${this.name}.`);this.eventTarget=t}destroy(){let t=this.listeners;for(let r in t)t[r].length=0}addEventListener(t,r){let n=this.listeners;t in n?n[t].push(r):n[t]=[r]}removeEventListener(t,r){let n=this.listeners;if(t in n){let s=n[t],i=s.indexOf(r);i>=0&&s.splice(i,1)}}dispatchInputEvent(t){let r=0;for(let n of this.listeners.input)r|=n(t);return Boolean(r)}},pn=class extends $t{static isAxis(t){return!1}static isButton(t){return!0}constructor(t,r,n={}){super(t,r);let{ignoreRepeat:s=!0}=n;this.ignoreRepeat=s,this._eventObject={target:r,device:t,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),r.addEventListener("keydown",this.onKeyDown),r.addEventListener("keyup",this.onKeyUp)}setEventTarget(t){this.eventTarget&&this.destroy(),super.setEventTarget(t),t.addEventListener("keydown",this.onKeyDown),t.addEventListener("keyup",this.onKeyUp)}destroy(){let t=this.eventTarget;t.removeEventListener("keydown",this.onKeyDown),t.removeEventListener("keyup",this.onKeyUp),super.destroy()}onKeyDown(t){if(t.repeat&&this.ignoreRepeat)return t.preventDefault(),t.stopPropagation(),!1;let r=this._eventObject;if(r.code=t.code,r.event="pressed",r.value=1,r.control=t.ctrlKey,r.shift=t.shiftKey,r.alt=t.altKey,this.dispatchInputEvent(r))return t.preventDefault(),t.stopPropagation(),!1}onKeyUp(t){let r=this._eventObject;if(r.code=t.code,r.event="released",r.value=1,r.control=t.ctrlKey,r.shift=t.shiftKey,r.alt=t.altKey,this.dispatchInputEvent(r))return t.preventDefault(),t.stopPropagation(),!1}},Vt=10,Wt=100,dn=class extends $t{static isAxis(t){return t==="PosX"||t==="PosY"||t==="WheelX"||t==="WheelY"||t==="WheelZ"}static isButton(t){return!this.isAxis(t)}constructor(t,r,n={}){super(t,r);let{eventsOnFocus:s=!0}=n;this.eventsOnFocus=s,this.canvasTarget=this.getCanvasFromEventTarget(r),this._downHasFocus=!1,this._eventObject={target:r,device:t,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this._positionObject={target:r,device:t,code:"",event:"move",value:0,movement:0},this._wheelObject={target:r,device:t,code:"",event:"wheel",movement:0},this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onWheel=this.onWheel.bind(this),r.addEventListener("mousedown",this.onMouseDown),r.addEventListener("contextmenu",this.onContextMenu),r.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}setEventTarget(t){this.eventTarget&&this.destroy(),super.setEventTarget(t),this.canvasTarget=this.getCanvasFromEventTarget(t),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("contextmenu",this.onContextMenu),t.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}destroy(){let t=this.eventTarget;t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("contextmenu",this.onContextMenu),t.removeEventListener("wheel",this.onWheel),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),super.destroy()}setPointerLock(t=!0){t?this.eventTarget.requestPointerLock():this.eventTarget.exitPointerLock()}hasPointerLock(){return document.pointerLockElement===this.eventTarget}onMouseDown(t){this._downHasFocus=!0;let r=this._eventObject;if(r.code="Button"+t.button,r.event="pressed",r.value=1,r.control=t.ctrlKey,r.shift=t.shiftKey,r.alt=t.altKey,this.dispatchInputEvent(r)&&document.activeElement===this.eventTarget)return t.preventDefault(),t.stopPropagation(),!1}onContextMenu(t){return t.preventDefault(),t.stopPropagation(),!1}onWheel(t){let r,n,s;switch(t.deltaMode){case WheelEvent.DOM_DELTA_LINE:r=t.deltaX*Vt,n=t.deltaY*Vt,s=t.deltaZ*Vt;break;case WheelEvent.DOM_DELTA_PAGE:r=t.deltaX*Wt,n=t.deltaY*Wt,s=t.deltaZ*Wt;break;case WheelEvent.DOM_DELTA_PIXEL:default:r=t.deltaX,n=t.deltaY,s=t.deltaZ;break}let i=0,a=this._wheelObject;if(a.code="WheelX",a.movement=r,i|=this.dispatchInputEvent(a),a.code="WheelY",a.movement=n,i|=this.dispatchInputEvent(a),a.code="WheelZ",a.movement=s,i|=this.dispatchInputEvent(a),i)return t.preventDefault(),t.stopPropagation(),!1}onMouseUp(t){if(!this._downHasFocus)return;this._downHasFocus=!1;let r=this._eventObject;if(r.code="Button"+t.button,r.event="released",r.value=1,r.control=t.ctrlKey,r.shift=t.shiftKey,r.alt=t.altKey,this.dispatchInputEvent(r))return t.preventDefault(),t.stopPropagation(),!1}onMouseMove(t){if(this.eventsOnFocus&&document.activeElement!==this.eventTarget)return;let r=this.canvasTarget,{clientWidth:n,clientHeight:s}=r,i=r.getBoundingClientRect(),a=t.movementX/n,o=t.movementY/s,l=(t.clientX-i.left)/n,c=(t.clientY-i.top)/s,h=this._positionObject;h.code="PosX",h.value=l,h.movement=a,this.dispatchInputEvent(h),h.code="PosY",h.value=c,h.movement=o,this.dispatchInputEvent(h)}getCanvasFromEventTarget(t){return t instanceof HTMLCanvasElement?t:t.canvas||t.querySelector("canvas")||t.shadowRoot&&t.shadowRoot.querySelector("canvas")||t}},Lo=`<kbd>
  <span id="name"><slot></slot></span>
  <span id="value" class="hidden"></span>
</kbd>
`,Co=`kbd {
  position: relative;
  display: inline-block;
  border-radius: 3px;
  border: 1px solid #888888;
  font-size: 0.85em;
  font-weight: 700;
  text-rendering: optimizeLegibility;
  line-height: 12px;
  height: 14px;
  padding: 2px 4px;
  color: #444444;
  background-color: #eeeeee;
  box-shadow: inset 0 -3px 0 #aaaaaa;
  overflow: hidden;
}

kbd:empty::after {
  content: '<?>';
  opacity: 0.6;
}

.disabled {
  opacity: 0.6;
  box-shadow: none;
  background-color: #aaaaaa;
}

.hidden {
  display: none;
}

#value {
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  font-size: 0.85em;
  padding: 0 4px;
  padding-top: 2px;
  color: #cccccc;
  background-color: #333333;
  box-shadow: inset 0 3px 0 #222222;
}
`,qt=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=Lo,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Co,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("input-code",this)}static get observedAttributes(){return["name","value","disabled"]}get disabled(){return this._disabled}set disabled(t){this.toggleAttribute("disabled",t)}get value(){return this._value}set value(t){this.setAttribute("value",t)}get name(){return this._name}set name(t){this.setAttribute("name",t)}constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._name="",this._value="",this._disabled=!1,this._kbdElement=this.shadowRoot.querySelector("kbd"),this._nameElement=this.shadowRoot.querySelector("#name"),this._valueElement=this.shadowRoot.querySelector("#value")}attributeChangedCallback(t,r,n){switch(t){case"name":this._name=n,this._nameElement.textContent=n;break;case"value":this._value=n,n!==null?(this._valueElement.classList.toggle("hidden",!1),this._valueElement.textContent=n,this._kbdElement.style.paddingRight=`${this._valueElement.clientWidth+4}px`):this._valueElement.classList.toggle("hidden",!0);break;case"disabled":this._disabled=n!==null,this._kbdElement.classList.toggle("disabled",n!==null);break}}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"name")){let t=this.name;delete this.name,this.name=t}if(Object.prototype.hasOwnProperty.call(this,"value")){let t=this.value;delete this.value,this.value=t}if(Object.prototype.hasOwnProperty.call(this,"disabled")){let t=this.disabled;delete this.disabled,this.disabled=t}}};qt.define();var Oo=`<table>
  <thead>
    <tr class="tableHeader">
      <th colspan="3">
        <span class="tableTitle">
          <label id="title"> input-source </label>
          <span id="slotContainer">
            <slot></slot>
          </span>
          <p>
            <label for="poll">poll</label>
            <output id="poll"></output>
          </p>
          <p>
            <label for="focus">focus</label>
            <output id="focus"></output>
          </p>
        </span>
      </th>
    </tr>
    <tr class="colHeader">
      <th>name</th>
      <th>value</th>
      <th>key</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
`,Po=`:host {
  display: block;
}

table {
  border-collapse: collapse;
  font-family: monospace;
}

table,
th,
td {
  border: 1px solid #666666;
}

th,
td {
  padding: 5px 10px;
}

td {
  text-align: center;
}

thead th {
  padding: 0;
}

.colHeader > th {
  font-size: 0.8em;
  padding: 0 10px;
  letter-spacing: 3px;
  background-color: #aaaaaa;
  color: #666666;
}

tbody output {
  border-radius: 0.3em;
  padding: 3px;
}

tr:not(.primary) .name,
tr:not(.primary) .value {
  opacity: 0.3;
}

tr:nth-child(2n) {
  background-color: #eeeeee;
}

.tableHeader {
  color: #666666;
}

.tableTitle {
  display: flex;
  flex-direction: row;
  align-items: center;
  padding: 4px;
}

#slotContainer {
  flex: 1;
}

p {
  display: inline;
  margin: 0;
  padding: 0;
  padding-right: 10px;
}

#poll:empty::after,
#focus:empty::after {
  content: '\u2717';
  color: #ff0000;
}
`,mn=class{constructor(t){this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null,this.pollable=t}get running(){return this.animationFrameHandle!==null}start(){let t=this.animationFrameHandle;t&&cancelAnimationFrame(t),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}stop(){let t=this.animationFrameHandle;t&&cancelAnimationFrame(t),this.animationFrameHandle=null}onAnimationFrame(t){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.pollable.onPoll(t)}},vn=class{constructor(t){this.onInput=this.onInput.bind(this),this.onPoll=this.onPoll.bind(this),this.bindings=t}onPoll(t){for(let r of this.bindings.getInputs())r.onPoll(t)}onInput(t){let{device:r,code:n,event:s,value:i,movement:a,control:o,shift:l,alt:c}=t,h=this.bindings.getBindings(r,n);switch(s){case"pressed":for(let{input:f,index:u}of h)f.onUpdate(u,1,1);break;case"released":for(let{input:f,index:u}of h)f.onUpdate(u,0,-1);break;case"move":for(let{input:f,index:u}of h)f.onUpdate(u,i,a);break;case"wheel":for(let{input:f,index:u}of h)f.onUpdate(u,void 0,a);break}return h.length>0}},Xt=class{constructor(t,r,n,s){this.device=t,this.code=r,this.input=n,this.index=s}},xn=class{constructor(){this.bindingMap={},this.inputMap=new Map}clear(){for(let t of this.inputMap.keys())t.onUnbind();this.inputMap.clear(),this.bindingMap={}}bind(t,r,n,s={inverted:!1}){let i,a=this.inputMap;if(a.has(t)){let l=a.get(t),c=t.size;t.onBind(c,s),i=new Xt(r,n,t,c),l.push(i)}else{let l=[];a.set(t,l);let c=0;t.onBind(c,s),i=new Xt(r,n,t,c),l.push(i)}let o=this.bindingMap;r in o?n in o[r]?o[r][n].push(i):o[r][n]=[i]:o[r]={[n]:[i]}}unbind(t){let r=this.inputMap;if(r.has(t)){let n=this.bindingMap,s=r.get(t);for(let i of s){let{device:a,code:o}=i,l=n[a][o],c=l.indexOf(i);l.splice(c,1)}s.length=0,t.onUnbind(),r.delete(t)}}isBound(t){return this.inputMap.has(t)}getInputs(){return this.inputMap.keys()}getBindingsByInput(t){return this.inputMap.get(t)}getBindings(t,r){let n=this.bindingMap;if(t in n){let s=n[t];if(r in s)return s[r]}return[]}},yn=class{constructor(t,r={}){this.inputs={},this.devices=[new dn("Mouse",t),new pn("Keyboard",t)],this.bindings=new xn,this.adapter=new vn(this.bindings),this.autopoller=new mn(this.adapter),this.eventTarget=t,this.anyButton=new pt(1),this.anyButtonDevice="",this.anyButtonCode="",this.anyAxis=new Ze(1),this.anyAxisDevice="",this.anyAxisCode="",this.listeners={bind:[],unbind:[],focus:[],blur:[]},this.onInput=this.onInput.bind(this),this.onEventTargetBlur=this.onEventTargetBlur.bind(this),this.onEventTargetFocus=this.onEventTargetFocus.bind(this),t.addEventListener("focus",this.onEventTargetFocus),t.addEventListener("blur",this.onEventTargetBlur);for(let n of this.devices)n.addEventListener("input",this.onInput)}get autopoll(){return this.autopoller.running}set autopoll(t){this.toggleAutoPoll(t)}destroy(){let t=this.listeners;for(let n in t)t[n].length=0;this.autopoller.running&&this.autopoller.stop();for(let n of this.devices)n.removeEventListener("input",this.onInput),n.destroy();let r=this.eventTarget;r.removeEventListener("focus",this.onEventTargetFocus),r.removeEventListener("blur",this.onEventTargetBlur)}setEventTarget(t){let r=this.eventTarget;r.removeEventListener("focus",this.onEventTargetFocus),r.removeEventListener("blur",this.onEventTargetBlur),this.eventTarget=t;for(let n of this.devices)n.setEventTarget(t);t.addEventListener("focus",this.onEventTargetFocus),t.addEventListener("blur",this.onEventTargetBlur)}toggleAutoPoll(t=void 0){let r=this.autopoller.running,n=typeof t=="undefined"?!r:Boolean(t);n!==r&&(n?this.autopoller.start():this.autopoller.stop())}addEventListener(t,r){let n=this.listeners;t in n?n[t].push(r):n[t]=[r]}removeEventListener(t,r){let n=this.listeners;if(t in n){let s=n[t],i=s.indexOf(r);i>=0&&s.splice(i,1)}}dispatchEvent(t){let{type:r}=t,n=0;for(let s of this.listeners[r])n|=s(t)?1:0;return Boolean(n)}poll(t=performance.now()){if(this.autopoller.running)throw new Error("Should not manually poll() while autopolling.");this.onPoll(t)}onInput(t){let r=this.adapter.onInput(t);switch(t.event){case"pressed":this.anyButtonDevice=t.device,this.anyButtonCode=t.code,this.anyButton.onUpdate(0,1,1);break;case"released":this.anyButtonDevice=t.device,this.anyButtonCode=t.code,this.anyButton.onUpdate(0,0,-1);break;case"move":case"wheel":this.anyAxisDevice=t.device,this.anyAxisCode=t.code,this.anyAxis.onUpdate(0,t.value,t.movement);break}return r}onPoll(t){this.adapter.onPoll(t),this.anyButton.onPoll(t),this.anyAxis.onPoll(t)}onBind(){this.dispatchEvent({type:"bind"})}onUnbind(){this.dispatchEvent({type:"unbind"})}onEventTargetFocus(){this.dispatchEvent({type:"focus"})}onEventTargetBlur(){for(let t of this.bindings.getInputs())t.onStatus(0,0);this.anyButton.onStatus(0,0),this.anyAxis.onStatus(0,0),this.dispatchEvent({type:"blur"})}bindBindings(t){for(let r of t)r.register(this)}bindButton(t,r,n,s=void 0){let i;this.hasButton(t)?i=this.getButton(t):(i=new pt(1),this.inputs[t]=i),this.bindings.bind(i,r,n,s),this.onBind()}bindAxis(t,r,n,s=void 0){let i;this.hasAxis(t)?i=this.getAxis(t):(i=new Ze(1),this.inputs[t]=i),this.bindings.bind(i,r,n,s),this.onBind()}bindAxisButtons(t,r,n,s){let i;this.hasAxis(t)?i=this.getAxis(t):(i=new Ze(2),this.inputs[t]=i),this.bindings.bind(i,r,s),this.bindings.bind(i,r,n,{inverted:!0}),this.onBind()}unbindButton(t){if(this.hasButton(t)){let r=this.getButton(t);delete this.inputs[t],this.bindings.unbind(r),this.onUnbind()}}unbindAxis(t){if(this.hasAxis(t)){let r=this.getAxis(t);delete this.inputs[t],this.bindings.unbind(r),this.onUnbind()}}getInput(t){return this.inputs[t]}getButton(t){return this.inputs[t]}getAxis(t){return this.inputs[t]}hasButton(t){return t in this.inputs&&this.inputs[t]instanceof pt}hasAxis(t){return t in this.inputs&&this.inputs[t]instanceof Ze}isButtonDown(t){return this.inputs[t].down}isButtonPressed(t){return this.inputs[t].pressed}isButtonReleased(t){return this.inputs[t].released}getInputValue(t){return this.inputs[t].value}getButtonValue(t){return this.inputs[t].value}getAxisValue(t){return this.inputs[t].value}getAxisDelta(t){return this.inputs[t].delta}isAnyButtonDown(t=void 0){if(typeof t=="undefined")return this.anyButton.down;{let r=this.inputs;for(let n of t)if(r[n].down)return!0}return!1}isAnyButtonPressed(t=void 0){if(typeof t=="undefined")return this.anyButton.pressed;{let r=this.inputs;for(let n of t)if(r[n].pressed)return!0}return!1}isAnyButtonReleased(t=void 0){if(typeof t=="undefined")return this.anyButton.released;{let r=this.inputs;for(let n of t)if(r[n].released)return!0}return!1}getAnyAxisValue(t=void 0){if(typeof t=="undefined")return this.anyAxis.value;{let r=this.inputs;for(let n of t){let s=r[n];if(s.value)return s.value}}return 0}getAnyAxisDelta(t=void 0){if(typeof t=="undefined")return this.anyAxis.delta;{let r=this.inputs;for(let n of t){let s=r[n];if(s.delta)return s.delta}}return 0}getLastButtonDevice(){return this.anyButtonDevice}getLastButtonCode(){return this.anyButtonCode}getLastAxisDevice(){return this.anyAxisDevice}getLastAxisCode(){return this.anyAxisCode}getMouse(){return this.devices[0]}getKeyboard(){return this.devices[1]}},_n=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=Oo,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Po,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("input-port",this)}static get observedAttributes(){return["autopoll","for"]}get autopoll(){return this._autopoll}set autopoll(t){this.toggleAttribute("autopoll",t)}get for(){return this._for}set for(t){this.setAttribute("for",t)}constructor(){super();let t=this.attachShadow({mode:"open"});t.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),t.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._titleElement=t.querySelector("#title"),this._pollElement=t.querySelector("#poll"),this._focusElement=t.querySelector("#focus"),this._bodyElement=t.querySelector("tbody"),this._outputElements={},this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null;let r=this;this._for="",this._eventTarget=r,this._autopoll=!1,this._context=null,this.onInputContextBind=this.onInputContextBind.bind(this),this.onInputContextUnbind=this.onInputContextUnbind.bind(this),this.onInputContextFocus=this.onInputContextFocus.bind(this),this.onInputContextBlur=this.onInputContextBlur.bind(this)}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"for")){let t=this.for;delete this.for,this.for=t}if(Object.prototype.hasOwnProperty.call(this,"autopoll")){let t=this.autopoll;delete this.autopoll,this.autopoll=t}this.updateTable(),this.updateTableValues(),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}disconnectedCallback(){let t=this._context;t&&(t.removeEventListener("bind",this.onInputContextBind),t.removeEventListener("unbind",this.onInputContextUnbind),t.removeEventListener("blur",this.onInputContextBlur),t.removeEventListener("focus",this.onInputContextFocus),t.destroy(),this._context=null)}attributeChangedCallback(t,r,n){switch(t){case"for":{this._for=n;let s,i;n?(s=document.getElementById(n),i=`${s.tagName.toLowerCase()}#${n}`):(s=this,i="input-port"),this._eventTarget=s,this._context&&this._context.setEventTarget(this._eventTarget),this._titleElement.innerHTML=`for ${i}`}break;case"autopoll":this._autopoll=n!==null,this._context&&this._context.toggleAutoPoll(this._autopoll);break}}onAnimationFrame(){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.updateTableValues(),this.updatePollStatus()}onInputContextBind(){return this.updateTable(),!0}onInputContextUnbind(){return this.updateTable(),!0}onInputContextFocus(){return this._focusElement.innerHTML="\u2713",!0}onInputContextBlur(){return this._focusElement.innerHTML="",!0}getContext(t="axisbutton",r=void 0){switch(t){case"axisbutton":if(!this._context){let n=new yn(this._eventTarget,r);n.addEventListener("bind",this.onInputContextBind),n.addEventListener("unbind",this.onInputContextUnbind),n.addEventListener("blur",this.onInputContextBlur),n.addEventListener("focus",this.onInputContextFocus),this._autopoll&&n.toggleAutoPoll(!0),this._context=n}return this._context;default:throw new Error(`Input context id '${t}' is not supported.`)}}updateTable(){if(this.isConnected)if(this._context){let t=this._context,r=t.inputs,n=t.bindings,s={},i=[];for(let a of Object.keys(r)){let o=r[a],l=!0;for(let c of n.getBindingsByInput(o)){let h=No(`${o.constructor.name}.${a}`,`${c.device}.${c.code}`,0,l);i.push(h),l&&(s[a]=h.querySelector("output"),l=!1)}}this._outputElements=s,this._bodyElement.innerHTML="";for(let a of i)this._bodyElement.appendChild(a)}else{this._outputElements={},this._bodyElement.innerHTML="";return}else return}updateTableValues(){if(this.isConnected)if(this._context){let r=this._context.inputs;for(let n of Object.keys(this._outputElements)){let s=this._outputElements[n],i=r[n].value;s.innerText=Number(i).toFixed(2)}}else{for(let t of Object.keys(this._outputElements)){let r=this._outputElements[t];r.innerText="---"}return}else return}updatePollStatus(){if(this.isConnected)if(this._context){let r=this._context.inputs;for(let n of Object.values(r))if(!n.polling){this._pollElement.innerHTML="";return}this._pollElement.innerHTML="\u2713"}else{this._pollElement.innerHTML="-";return}else return}};_n.define();function No(e,t,r,n=!0){let s=document.createElement("tr");n&&s.classList.add("primary");{let i=document.createElement("td");i.textContent=e,i.classList.add("name"),s.appendChild(i)}{let i=document.createElement("td"),a=document.createElement("output");n?a.innerText=Number(r).toFixed(2):a.innerText="---",a.classList.add("value"),i.appendChild(a),s.appendChild(i)}{let i=document.createElement("td");i.classList.add("key");let a=new qt;a.innerText=t,i.appendChild(a),s.appendChild(i)}return s}var Bp=Symbol("keyboardSource");var Fp=Symbol("mouseSource");var us=na(Xn());var Qn={},xl=function(e,t,r,n,s){var i=new Worker(Qn[t]||(Qn[t]=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))));return i.onerror=function(a){return s(a.error,null)},i.onmessage=function(a){return s(null,a.data)},i.postMessage(r,n),i},te=Uint8Array,xe=Uint16Array,tt=Uint32Array,hr=new te([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fr=new te([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Zn=new te([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Jn=function(e,t){for(var r=new xe(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var s=new tt(r[30]),n=1;n<30;++n)for(var i=r[n];i<r[n+1];++i)s[i]=i-r[n]<<5|n;return[r,s]},es=Jn(hr,2),ur=es[0],yl=es[1];ur[28]=258,yl[258]=28;var ts=Jn(fr,0),rs=ts[0],$p=ts[1],gt=new xe(32768);for(var K=0;K<32768;++K)we=(K&43690)>>>1|(K&21845)<<1,we=(we&52428)>>>2|(we&13107)<<2,we=(we&61680)>>>4|(we&3855)<<4,gt[K]=((we&65280)>>>8|(we&255)<<8)>>>1;var we,je=function(e,t,r){for(var n=e.length,s=0,i=new xe(t);s<n;++s)++i[e[s]-1];var a=new xe(t);for(s=0;s<t;++s)a[s]=a[s-1]+i[s-1]<<1;var o;if(r){o=new xe(1<<t);var l=15-t;for(s=0;s<n;++s)if(e[s])for(var c=s<<4|e[s],h=t-e[s],f=a[e[s]-1]++<<h,u=f|(1<<h)-1;f<=u;++f)o[gt[f]>>>l]=c}else for(o=new xe(n),s=0;s<n;++s)e[s]&&(o[s]=gt[a[e[s]-1]++]>>>15-e[s]);return o},rt=new te(288);for(var K=0;K<144;++K)rt[K]=8;for(var K=144;K<256;++K)rt[K]=9;for(var K=256;K<280;++K)rt[K]=7;for(var K=280;K<288;++K)rt[K]=8;var ns=new te(32);for(var K=0;K<32;++K)ns[K]=5;var ss=je(rt,9,1);var is=je(ns,5,1),At=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},ce=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(t&7)&r},St=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(t&7)},as=function(e){return(e/8|0)+(e&7&&1)},wt=function(e,t,r){(t==null||t<0)&&(t=0),(r==null||r>e.length)&&(r=e.length);var n=new(e instanceof xe?xe:e instanceof tt?tt:te)(r-t);return n.set(e.subarray(t,r)),n},os=function(e,t,r){var n=e.length;if(!n||r&&!r.l&&n<5)return t||new te(0);var s=!t||r,i=!r||r.i;r||(r={}),t||(t=new te(n*3));var a=function(U){var Pe=t.length;if(U>Pe){var ht=new te(Math.max(Pe*2,U));ht.set(t),t=ht}},o=r.f||0,l=r.p||0,c=r.b||0,h=r.l,f=r.d,u=r.m,p=r.n,m=n*8;do{if(!h){r.f=o=ce(e,l,1);var v=ce(e,l+1,3);if(l+=3,v)if(v==1)h=ss,f=is,u=9,p=5;else if(v==2){var g=ce(e,l,31)+257,T=ce(e,l+10,15)+4,w=g+ce(e,l+5,31)+1;l+=14;for(var b=new te(w),D=new te(19),A=0;A<T;++A)D[Zn[A]]=ce(e,l+A*3,7);l+=T*3;for(var C=At(D),B=(1<<C)-1,x=je(D,C,1),A=0;A<w;){var N=x[ce(e,l,B)];l+=N&15;var d=N>>>4;if(d<16)b[A++]=d;else{var P=0,O=0;for(d==16?(O=3+ce(e,l,3),l+=2,P=b[A-1]):d==17?(O=3+ce(e,l,7),l+=3):d==18&&(O=11+ce(e,l,127),l+=7);O--;)b[A++]=P}}var y=b.subarray(0,g),_=b.subarray(g);u=At(y),p=At(_),h=je(y,u,1),f=je(_,p,1)}else throw"invalid block type";else{var d=as(l)+4,E=e[d-4]|e[d-3]<<8,I=d+E;if(I>n){if(i)throw"unexpected EOF";break}s&&a(c+E),t.set(e.subarray(d,I),c),r.b=c+=E,r.p=l=I*8;continue}if(l>m){if(i)throw"unexpected EOF";break}}s&&a(c+131072);for(var $=(1<<u)-1,k=(1<<p)-1,Q=l;;Q=l){var P=h[St(e,l)&$],Z=P>>>4;if(l+=P&15,l>m){if(i)throw"unexpected EOF";break}if(!P)throw"invalid length/literal";if(Z<256)t[c++]=Z;else if(Z==256){Q=l,h=null;break}else{var ee=Z-254;if(Z>264){var A=Z-257,de=hr[A];ee=ce(e,l,(1<<de)-1)+ur[A],l+=de}var Qe=f[St(e,l)&k],Ie=Qe>>>4;if(!Qe)throw"invalid distance";l+=Qe&15;var _=rs[Ie];if(Ie>3){var de=fr[Ie];_+=St(e,l)&(1<<de)-1,l+=de}if(l>m){if(i)throw"unexpected EOF";break}s&&a(c+131072);for(var me=c+ee;c<me;c+=4)t[c]=t[c-_],t[c+1]=t[c+1-_],t[c+2]=t[c+2-_],t[c+3]=t[c+3-_];c=me}}r.l=h,r.p=Q,r.b=c,h&&(o=1,r.m=u,r.d=f,r.n=p)}while(!o);return c==t.length?t:wt(t,0,c)};var _l=new te(0);var El=function(e,t){var r={};for(var n in e)r[n]=e[n];for(var n in t)r[n]=t[n];return r},ls=function(e,t,r){for(var n=e(),s=e.toString(),i=s.slice(s.indexOf("[")+1,s.lastIndexOf("]")).replace(/ /g,"").split(","),a=0;a<n.length;++a){var o=n[a],l=i[a];if(typeof o=="function"){t+=";"+l+"=";var c=o.toString();if(o.prototype)if(c.indexOf("[native code]")!=-1){var h=c.indexOf(" ",8)+1;t+=c.slice(h,c.indexOf("(",h))}else{t+=c;for(var f in o.prototype)t+=";"+l+".prototype."+f+"="+o.prototype[f].toString()}else t+=c}else r[l]=o}return[t,r]},Mt=[],gl=function(e){var t=[];for(var r in e)(e[r]instanceof te||e[r]instanceof xe||e[r]instanceof tt)&&t.push((e[r]=new e[r].constructor(e[r])).buffer);return t},Al=function(e,t,r,n){var s;if(!Mt[r]){for(var i="",a={},o=e.length-1,l=0;l<o;++l)s=ls(e[l],i,a),i=s[0],a=s[1];Mt[r]=ls(e[o],i,a)}var c=El({},Mt[r][1]);return xl(Mt[r][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",r,c,gl(c),n)},Sl=function(){return[te,xe,tt,hr,fr,Zn,ur,rs,ss,is,gt,je,At,ce,St,as,wt,os,pr,cs,hs]};var cs=function(e){return postMessage(e,[e.buffer])},hs=function(e){return e&&e.size&&new te(e.size)},wl=function(e,t,r,n,s,i){var a=Al(r,n,s,function(o,l){a.terminate(),i(o,l)});return a.postMessage([e,t],t.consume?[e.buffer]:[]),function(){a.terminate()}};var ye=function(e,t){return e[t]|e[t+1]<<8},pe=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0},dr=function(e,t){return pe(e,t)+pe(e,t+4)*4294967296};function Ml(e,t,r){if(r||(r=t,t={}),typeof r!="function")throw"no callback";return wl(e,t,[Sl],function(n){return cs(pr(n.data[0],hs(n.data[1])))},1,r)}function pr(e,t){return os(e,t)}var Vp=typeof TextEncoder!="undefined"&&new TextEncoder,mr=typeof TextDecoder!="undefined"&&new TextDecoder,Tl=0;try{mr.decode(_l,{stream:!0}),Tl=1}catch(e){}var bl=function(e){for(var t="",r=0;;){var n=e[r++],s=(n>127)+(n>223)+(n>239);if(r+s>e.length)return[t,wt(e,r-1)];s?s==3?(n=((n&15)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,t+=String.fromCharCode(55296|n>>10,56320|n&1023)):s&1?t+=String.fromCharCode((n&31)<<6|e[r++]&63):t+=String.fromCharCode((n&15)<<12|(e[r++]&63)<<6|e[r++]&63):t+=String.fromCharCode(n)}};function Rl(e,t){if(t){for(var r="",n=0;n<e.length;n+=16384)r+=String.fromCharCode.apply(null,e.subarray(n,n+16384));return r}else{if(mr)return mr.decode(e);var s=bl(e),i=s[0],a=s[1];if(a.length)throw"invalid utf-8 data";return i}}var Il=function(e,t){return t+30+ye(e,t+26)+ye(e,t+28)},Cl=function(e,t,r){var n=ye(e,t+28),s=Rl(e.subarray(t+46,t+46+n),!(ye(e,t+8)&2048)),i=t+46+n,a=pe(e,t+20),o=r&&a==4294967295?Ll(e,i):[a,pe(e,t+24),pe(e,t+42)],l=o[0],c=o[1],h=o[2];return[ye(e,t+10),l,c,s,i+ye(e,t+30)+ye(e,t+32),h]},Ll=function(e,t){for(;ye(e,t)!=1;t+=4+ye(e,t+2));return[dr(e,t+12),dr(e,t+4),dr(e,t+20)]};function fs(e,t){if(typeof t!="function")throw"no callback";for(var r=[],n=function(){for(var u=0;u<r.length;++u)r[u]()},s={},i=e.length-22;pe(e,i)!=101010256;--i)if(!i||e.length-i>65558){t("invalid zip file",null);return}var a=ye(e,i+8);a||t(null,{});var o=a,l=pe(e,i+16),c=l==4294967295;if(c){if(i=pe(e,i-12),pe(e,i)!=101075792){t("invalid zip file",null);return}o=a=pe(e,i+32),l=pe(e,i+48)}for(var h=function(u){var p=Cl(e,l,c),m=p[0],v=p[1],d=p[2],E=p[3],I=p[4],g=p[5],T=Il(e,g);l=I;var w=function(D,A){D?(n(),t(D,null)):(s[E]=A,--a||t(null,s))};if(!m)w(null,wt(e,T,T+v));else if(m==8){var b=e.subarray(T,T+v);if(v<32e4)try{w(null,pr(b,new te(d)))}catch(D){w(D,null)}else r.push(Ml(b,{size:d},w))}else w("unknown compression type "+m,null)},f=0;f<o;++f)h(f);return n}var nt=class{constructor(t){let r;typeof t=="object"&&t instanceof nt?r=t.source:r=String(t),this.source=r,this._re=(0,us.makeRe)(r)}test(t){return this._re.test(t)}},Ol=/^([_\w\d]+)\:\/\//,vr=5e3,he={cache:{},loadings:{},defaults:[]};async function ps(e,t,r,n=vr){let{cache:s,loadings:i}=he;if(e in s)return s[e];let a;if(e in i){if(a=i[e],a.active)return i[e].promise}else a=new yr(n),i[e]=a;let o=[a.promise];return Ol.test(t)?o.push(xr(t,n).then(l=>r(l)).then(l=>Ye(e,l))):o.push(fetch(t).then(l=>l.arrayBuffer()).then(l=>r(l)).then(l=>Ye(e,l))),await Promise.race(o)}async function Pl(e,t=void 0){let r="raw://",s=await(await fetch(e)).arrayBuffer();await new Promise((i,a)=>{fs(new Uint8Array(s),(o,l)=>{if(o)a(o);else{for(let[c,h]of Object.entries(l)){c=c.replaceAll("\\","/");let f=c.indexOf("/");f>=0&&(c=c.substring(f+1));let u=r+c;Ye(u,h),t&&t(h,u,c)}i()}})})}async function Nl(e,t=vr){let r=[];for(let n of e)r.push(n.load(t));await Promise.allSettled(r)}function Ye(e,t){let{cache:r,loadings:n}=he;return r[e]=t,e in n&&(n[e].resolve(t),delete n[e]),t}function Dl(e,t){let{defaults:r}=he;typeof e=="string"&&(e=new nt(e));let n=`__default://[${r.length}]`;Ye(n,t),r.push(new ds(e,n))}function Bl(e){let{cache:t,loadings:r}=he;e in r&&(r[e].reject(new Error("Stop loading to delete asset.")),delete r[e]),e in t&&delete t[e]}function Fl(e=void 0,t={preserveDefault:!1}){let{preserveDefault:r}=t;typeof e=="string"&&(e=new nt(e));let{cache:n,loadings:s,defaults:i}=he;for(let[a,o]of Object.entries(s))(!e||e.test(a))&&(o.reject(new Error("Stop loading to clear all assets.")),delete s[a]);for(let a of Object.keys(n))(!e||e.test(a))&&delete n[a];r||(i.length=0)}async function xr(e,t=vr){let{cache:r,loadings:n}=he;if(e in r)return r[e];if(e in n)return n[e].promise;{let s=new yr(t);return n[e]=s,s.promise}}function _r(e){let{defaults:t}=he;for(let r of t)if(r.glob.test(e))return Tt(r.uri);return null}function Tt(e){return he.cache[e]}function ms(e){return Tt(e)||_r(e)}function Ul(e){return Boolean(he.cache[e])}function Hl(){return Object.keys(he.cache)}function kl(e){return e in he.cache}function zl(e){return e in he.loadings}function Gl(e,t){}var ds=class{constructor(t,r){this.glob=t,this.uri=r}},yr=class{constructor(t){this.active=!1,this._resolve=null,this._reject=null,this._reason=null,this._value=null,this._timeoutHandle=Number.isFinite(t)&&t>0?setTimeout(()=>{this.reject(`Asset loading exceeded timeout of ${t} ms.`)},t):null,this._promise=new Promise((r,n)=>{this._value?r(this._value):this._resolve=r,this._reason?n(this._reason):this._reject=n})}get promise(){return this._promise}resolve(t){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._resolve?this._resolve(t):this._value=t}reject(t){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._reject?this._reject(t):this._reason=t}},Ke=Object.freeze({__proto__:null,load:ps,loadAssetPack:Pl,loadAssetRefs:Nl,cache:Ye,cacheDefault:Dl,unload:Bl,clear:Fl,getLoaded:xr,getDefault:_r,getCurrent:Tt,get:ms,has:Ul,keys:Hl,isAssetCached:kl,isAssetLoading:zl,on:Gl}),X=class{constructor(t,r,n){this.uri=t,this.source=r,this.loader=n}get value(){return ms(this.uri)}get current(){return Tt(this.uri)}get loaded(){return xr(this.uri)}get default(){return _r(this.uri)}async load(t=void 0){return await ps(this.uri,this.source,this.loader,t),this}cache(t){return Ye(this.uri,t),this}};window.addEventListener("error",bt,!0);window.addEventListener("unhandledrejection",bt,!0);function bt(e){typeof e=="object"?e instanceof PromiseRejectionEvent?bt(e.reason):e instanceof ErrorEvent?bt(e.error):e instanceof Error?window.alert(e.stack):window.alert(JSON.stringify(e)):window.alert(e)}var jl=`
<slot></slot>
<div class="container"></div>`,Yl=`
slot, ::slotted(*) {
    display: none;
}

.outer {
    overflow: hidden;
}
.outer, .inner {
    display: inline-block;
    transform-origin: top left;
    transform: scale(0, 1);
    contain: content;
}
.inner {
    white-space: pre;
}

.container p {
    margin: 0;
}

.waveChild {
    display: inline-block;
    transform-origin: top left;
    animation-name: wavy;
    animation-duration: 300ms;
    animation-direction: alternate;
    animation-iteration-count: infinite;
    animation-timing-function: linear;
}
@keyframes wavy{
    from {
        transform: translateY(-6%);
    }
    to {
        transform: translateY(6%);
    }
}`,Kl=30,$l=120,vs=10,[Vl,Wl]=(()=>{let e=[],t=[];for(let r=1;r<=vs;++r){let n=r/vs,s=n.toFixed(5);e.push({transform:`scale(${s},1)`});let i=(1/n).toFixed(5);t.push({transform:`scale(${i},1)`})}return[e,t]})(),xs=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=jl,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Yl,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("dialogue-area",this)}get paused(){return this._paused}set paused(t){t?this.pause():this.play()}get autoplay(){return this.hasAttribute("autoplay")}set autoplay(t){this.toggleAttribute("autoplay",t)}constructor(){super();let t=this.attachShadow({mode:"open"});t.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),t.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._containerElement=t.querySelector(".container"),this._slotElement=t.querySelector("slot"),this._typeWriteQueue=[],this._typeWriteIndex=0,this._currentWaitTime=0,this._currentWaitTimeout=null,this._currentAnimations=[],this._paused=!0,this._eventFinish=new CustomEvent("finish",{composed:!0,bubbles:!1}),this.onSlotChange=this.onSlotChange.bind(this),this.onAnimationFinish=this.onAnimationFinish.bind(this),this.onWaitTimeout=this.onWaitTimeout.bind(this),this._slotElement.addEventListener("slotchange",this.onSlotChange)}connectedCallback(){ql(this,"autoplay")}disconnectedCallback(){this._containerElement.innerHTML=""}play(){this._paused=!1;for(let t of this._currentAnimations)t.play();this.step()}pause(){this._paused=!0;for(let t of this._currentAnimations)t.pause()}reset(){this._typeWriteIndex=0;for(let r of this._currentAnimations)r.cancel();this._currentAnimations.length=0,clearTimeout(this._currentWaitTimeout),this._currentWaitTimeout=null;let t=this._typeWriteQueue;for(let r of t){let n=r.children.item(0);r.style.removeProperty("transform"),n.style.removeProperty("transform")}}step(){if(this._currentAnimations.length>0||this._currentWaitTimeout||this._paused||this._typeWriteIndex>=this._typeWriteQueue.length)return;let t=Kl;if(this.hasAttribute("speed")){let c=Number(this.getAttribute("speed"));c>0?t/=c:t=0}if(t<=0){this.skip();return}let r=this._typeWriteQueue[this._typeWriteIndex],n=r.children.item(0);r.style.transform="scale(1,1)",n.style.transform="scale(1,1)";let i=n.textContent.length*t,a=(n.hasAttribute("data-p-wait")?Number(n.getAttribute("data-p-wait")):0)*t*4,o=r.animate(Vl,i),l=n.animate(Wl,i);this._currentAnimations.push(o,l),this._currentWaitTime=a,this._typeWriteIndex+=1,l.addEventListener("finish",this.onAnimationFinish)}skip(){if(this._typeWriteIndex>=this._typeWriteQueue.length)return;let t=this._currentWaitTimeout;this._currentWaitTimeout=null,clearTimeout(t);let r=this._currentAnimations;this._currentAnimations.length=0;for(let i of r)i.finish();let n=this._typeWriteQueue,s=n.length;for(let i=this._typeWriteIndex;i<s;++i){let a=n[i],o=a.children.item(0);a.style.transform="scale(1,1)",o.style.transform="scale(1,1)"}this._typeWriteIndex=n.length}onSlotChange(){this.reset();let t=this._containerElement,r=Xl(this._slotElement);t.innerHTML="",t.appendChild(r);let n=t.querySelectorAll(".outer"),s=this._typeWriteQueue;s.length=0;let i=n.length;for(let a=0;a<i;++a){let o=n.item(a);s.push(o)}this._typeWriteIndex=0,this.hasAttribute("autoplay")&&this.play()}onAnimationFinish(){if(this._currentAnimations.length=0,this._typeWriteIndex>=this._typeWriteQueue.length){this.dispatchEvent(this._eventFinish);return}let t=this._currentWaitTime;t>0?(this._currentWaitTime=0,this._currentWaitTimeout=setTimeout(this.onWaitTimeout,t)):this.step()}onWaitTimeout(){this._currentWaitTimeout=null,this.step()}};xs.define();function ql(e,t){if(Object.prototype.hasOwnProperty.call(e,t)){let r=e[t];delete e[t],e[t]=r}}function Xl(e){let t=document.createDocumentFragment(),r=e.assignedNodes();for(let n of r){if(n=n.cloneNode(!0),n.nodeType===3){let i=n.textContent.split(/\s+/).filter(Boolean).map(o=>o+" "),a=document.createDocumentFragment();for(let o of i){let l=_s(o),c=Er(o,l);a.append(c)}n=a}else{let s=ys(n,/\s+/,!0);for(let{parent:i,node:a,content:o}of s){if(i.nodeName==="P-WAIT"){let c=Er("",Number(o.join("")));i.insertBefore(c,a)}else for(let c of o){let h=_s(c),f=Er(c,h);i.insertBefore(f,a)}i.removeChild(a)}}if(n instanceof Element){let s=[];n.nodeName==="P-WAVE"&&s.push(n);let i=n.querySelectorAll("p-wave"),a=i.length;for(let o=0;o<a;++o){let l=i.item(o);s.push(l)}for(let o of s){let l=ys(o,"",!1);for(let{parent:c,node:h,content:f}of l){let u=0;for(let p of f){let m=document.createElement("span");m.className="waveChild",m.textContent=p,m.style.animationDelay=`${u}ms`,u+=$l,c.insertBefore(m,h)}c.removeChild(h)}}}t.append(n)}return t}function ys(e,t,r){let n=[],s=document.createTreeWalker(e,NodeFilter.SHOW_TEXT),i;for(;i=s.nextNode();){let o=i.textContent.split(t).filter(Boolean);r&&(o=o.map(c=>c+" "));let l={parent:i.parentNode,node:i,content:o};n.push(l)}return n}function _s(e){let t=/([\.\!\?\:\-]+)$/.exec(e),r=/([\,\;]+)$/.exec(e),n=0;if(t){let[s,i]=t;n+=i.length*2}if(r){let[s,i]=r;n+=i.length}return n}function Er(e,t){let r=document.createElement("span");r.className="outer";let n=document.createElement("span");return n.className="inner",r.append(n),t>0&&n.setAttribute("data-p-wait",String(t)),e&&(n.textContent=e),r}function Es(){let e=document.querySelector("#display"),t=document.querySelector("#inputs").getContext("axisbutton");return{display:e,inputs:t,assets:Ke,now:0,deltaTime:0}}var st={MoveLeft:new Ae("moveLeft",[ge.KEY_A,ge.ARROW_LEFT]),MoveRight:new Ae("moveRight",[ge.KEY_D,ge.ARROW_RIGHT]),Fish:new Ae("fish",[ge.KEY_Z]),FastForward:new Ae("fastForward",[ge.SPACE])};function gs(e){e.bindBindings(Object.values(st))}async function re(e,t=void 0){if(typeof e=="string"){let o=await(await fetch(e)).arrayBuffer();if(typeof t=="undefined"){let l=e.lastIndexOf(".");if(l<0)throw new Error("Cannot load from url - unknown image type.");t="image/"+e.slice(l+1)}return re(o,t)}else if(!(e instanceof ArrayBuffer||ArrayBuffer.isView(e)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let r=e;typeof t=="undefined"&&(t="image/png");let n=new Blob([r],{type:t}),s=URL.createObjectURL(n),i=new Image;return new Promise((a,o)=>{i.addEventListener("load",()=>{a(i)}),i.addEventListener("error",l=>{o(l)}),i.src=s})}var gr=Symbol("audioContext"),Rt=class{static getAudioContext(){if(gr in this)return this[gr];{let t=new AudioContext;return Ql(t),this[gr]=t,t}}constructor(t,r){this.audioContext=t,this.audioBuffer=r,this._playing=!1,this._started=!1,this._pitch=0,this._loop=!1,this._gainNode=t.createGain(),this._panNode=t.createStereoPanner(),this._source=null,this.onAudioSourceEnded=this.onAudioSourceEnded.bind(this)}destroy(){this._source&&this._source.disconnect(),this._source=null,this._started=!1,this._playing=!1}onAudioSourceEnded(){console.log("END!"),this._playing=!1}setPitch(t){return this._pitch=t,this._source&&(this._source.detune.value=t*100),this}setGain(t){return this._gainNode.gain.value=t,this}setPan(t){return this._panNode.pan.value=t,this}setLoop(t){return this._loop=t,this._source&&(this._source.loop=t),this}play(){this._source&&this._source.disconnect();let t=this.audioContext,r=this.audioBuffer,n=t.createBufferSource();n.buffer=r,this._pitch&&(n.detune.value=this._pitch*100),this._loop&&(n.loop=this._loop);let s=n;s=s.connect(this._gainNode),s=s.connect(this._panNode),s.connect(t.destination),this._source=n,this._started=!0,this._playing=!0,n.addEventListener("ended",this.onAudioSourceEnded),n.start()}pause(){this._source.stop(),this._playing=!1}isStarted(){return this._started}isPlaying(){return this._playing}isPaused(){return this._started&&!this._playing}};function Ql(e){let t=()=>{e.state==="suspended"&&e.resume()};document.addEventListener("click",t)}async function Ar(e,t){if(typeof e=="string"){let a=await(await fetch(e)).arrayBuffer();return Ar(a,t)}else if(!(e instanceof ArrayBuffer||ArrayBuffer.isView(e)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let r=e,n=new ArrayBuffer(r.byteLength);return new Uint8Array(n).set(r),await t.decodeAudioData(n)}async function It(e){let t=Rt.getAudioContext(),r=await Ar(e,t);return new Rt(t,r)}var fe={CanoeImage:new X("canoe","raw://canoe.png",re),PierImage:new X("pier","raw://pier.png",re),PierLegImage:new X("pierLeg","raw://pier_leg.png",re),BucketImage:new X("bucket","raw://bucket.png",re),MusicBack:new X("musicBack","raw://music_back.wav",It),MusicLayer1:new X("musicLayer1","raw://music_1.wav",It),MusicLayer2:new X("musicLayer2","raw://music_2.wav",It)};async function As(){await Ke.loadAssetRefs(Object.values(fe))}var it=class extends Promise{constructor(){super((t,r)=>t());this._completed=!1,this._resolved=!1,this._resolve=null,this._reject=null,this._promise=new Promise((t,r)=>{this._completed?this._resolved?t(this._resolve):r(this._reject):(this._resolve=t,this._reject=r)})}get pending(){return!this._completed}resolve(t){this._completed||(this._completed=!0,this._resolve?this._resolve(t):(this._resolved=!0,this._resolve=t,this._reject=null))}reject(t){this._completed||(this._completed=!0,this._reject?this._reject(t):(this._resolved=!1,this._resolve=null,this._reject=t))}then(t=void 0,r=void 0){return this._promise.then(t,r)}catch(t=void 0){return this._promise.catch(t)}finally(t=void 0){return this._promise.finally(t)}};var Jl=Symbol("beforeEffects"),_d=Symbol("afterEffects");function Me(e,t){let r=$e(e);e[Jl][r]=t}var ec=Symbol("refs");function Sr(e){let t=$e(e),r={__ready:!1,__current:null,get current(){if(!this.__ready)throw new Error("Ref is not yet ready. Try awaiting on owning system before access.");return this.__current},set current(n){this.__ready=!0,this.__current=n}};return e[ec][t]=r,r}function at(e,t,r=t.name){if(!e||!e.__manager__.systems.has(r))throw new Error("System not yet registered. Try preloading the system.");let n=Sr(e);return e.__manager__.getSystemContext(t,r).__ready__.then(s=>{n.current=s}),n}function Te(e,t,r=t.name){if(!e||!e.__manager__.systems.has(r))throw new Error("System not yet loaded. Try await on system before access.");return e.__manager__.getSystemContext(t,r).state}function Fe(e,t,r){Me(e,()=>{let n=e.__manager__.events;return n.addEventListener(t,r),()=>{n.removeEventListener(t,r)}})}function $e(e){return e.__handle__++}function Ts(e,t,r=t.name){return r}function bs(e,t){Fe(e,"systemUpdate",t)}async function Ve(e,t,r=t.name){return await e.__manager__.getSystemContext(t,r).__ready__.then()}async function Rs(e,t){return new Promise((r,n)=>{let s=()=>{let a=document.querySelector(t);a?r(a):window.requestAnimationFrame(s)},i=()=>{window.removeEventListener("DOMContentLoaded",i);let a=document.querySelector(t);a?r(a):window.requestAnimationFrame(s)};document.readyState!=="loading"?i():window.addEventListener("DOMContentLoaded",i)})}function be(e){return Te(e,We).element}function Is(e,t){let r=Te(e,We);Me(e,()=>{let n=i=>{if(!!r.loaded)try{t(i)}catch(a){console.error(a)}},s=r.element;return s.addEventListener("frame",n),()=>{s.removeEventListener("frame",n)}})}async function We(e,t="display-port"){let n={element:await Rs(e,t),loaded:!1};return Fe(e,"loadEnd",()=>{n.loaded=!0}),n}function wr(e){return typeof WebGL2RenderingContext!="undefined"&&e instanceof WebGL2RenderingContext}var Mr=class{constructor(t,r){this.gl=t,this.target=r}data(t,r=void 0){let n=this.gl,s=this.target;if(typeof t=="number")n.bufferData(s,t,r||n.STATIC_DRAW);else{if(!ArrayBuffer.isView(t))throw new Error("Source data must be a typed array.");n.bufferData(s,t,r||n.STATIC_DRAW)}return this}subData(t,r=0,n=void 0,s=void 0){let i=this.gl,a=this.target;if(!ArrayBuffer.isView(t))throw new Error("Source data must be a typed array.");if(n)if(wr(i))i.bufferSubData(a,r,t,n,s);else{let o=s?t.subarray(n,n+s):t.subarray(n);i.bufferSubData(a,r,o)}else i.bufferSubData(a,r,t);return this}},Ls=class{constructor(t,r,n=void 0){this.dataContext=new Mr(t,r),this.handle=n||t.createBuffer(),t.bindBuffer(r,this.handle)}get gl(){return this.dataContext.gl}get target(){return this.dataContext.target}data(t,r=void 0){return this.dataContext.data(t,r),this}subData(t,r=0,n=void 0,s=void 0){return this.dataContext.subData(t,r,n,s),this}build(){return this.handle}},Cs=class{constructor(t,r,n,s){this.gl=t,this.target=r,this.handle=s,this.type=n,this.bindContext=new Mr(t,this.target)}bind(t){return t.bindBuffer(this.target,this.handle),this.bindContext.gl=t,this.bindContext}};function nc(e,t,r){let n=Os(e,t);return new n(r)}function sc(e,t,r,n=void 0){let s=e.createBuffer();if(e.bindBuffer(t,s),!ArrayBuffer.isView(r))throw new Error("Source data must be a typed array.");return e.bufferData(t,r,n||e.STATIC_DRAW),s}function Os(e,t){switch(t){case e.BYTE:return Int8Array;case e.UNSIGNED_BYTE:return Uint8Array;case e.SHORT:return Int16Array;case e.UNSIGNED_SHORT:return Uint16Array;case e.INT:return Int32Array;case e.UNSIGNED_INT:return Uint32Array;case e.FLOAT:return Float32Array;default:throw new Error("Cannot find valid typed array for buffer type.")}}function Tr(e,t){switch(t){case Int8Array:return e.BYTE;case Uint8Array:return e.UNSIGNED_BYTE;case Int16Array:return e.SHORT;case Uint16Array:return e.UNSIGNED_SHORT;case Int32Array:return e.INT;case Uint32Array:return e.UNSIGNED_INT;case Float32Array:return e.FLOAT;default:throw new Error("Cannot find valid buffer type for typed array.")}}function ic(e,t,r){return e.bindBuffer(t,r),e.getBufferParameter(t,e.BUFFER_USAGE)}var Re=Object.freeze({__proto__:null,createBufferSource:nc,createBuffer:sc,getBufferTypedArray:Os,getTypedArrayBufferType:Tr,getBufferUsage:ic}),_e=class{constructor(t,r,n=void 0){this.bufferBuilder=new Ls(t,r,n),this.bufferType=t.FLOAT}get gl(){return this.bufferBuilder.gl}get handle(){return this.bufferBuilder.handle}get target(){return this.bufferBuilder.target}data(t,r=void 0){if(this.bufferBuilder.data(t,r),typeof t!="number"){let n=t.constructor;this.bufferType=Tr(this.gl,n)}return this}subData(t,r=void 0,n=void 0,s=void 0){this.bufferBuilder.subData(t,r,n,s);let i=t.constructor;return this.bufferType=Tr(this.gl,i),this}build(){let t=this.bufferBuilder.build(),r=this.gl,n=this.target,s=this.bufferType;return new Cs(r,n,s,t)}};function ac(e,t){switch(t){case e.FLOAT:return e.uniform1f;case e.FLOAT_VEC2:return e.uniform2fv;case e.FLOAT_VEC3:return e.uniform3fv;case e.FLOAT_VEC4:return e.uniform4fv;case e.INT:return e.uniform1i;case e.INT_VEC2:return e.uniform2iv;case e.INT_VEC3:return e.uniform3iv;case e.INT_VEC4:return e.uniform4iv;case e.BOOL:return e.uniform1i;case e.BOOL_VEC2:return e.uniform2iv;case e.BOOL_VEC3:return e.uniform3iv;case e.BOOL_VEC4:return e.uniform4iv;case e.FLOAT_MAT2:return Ps;case e.FLOAT_MAT3:return Ns;case e.FLOAT_MAT4:return Ds;case e.SAMPLER_2D:case e.SAMPLER_CUBE:return e.uniform1i}if(wr(e))switch(t){case e.UNSIGNED_INT:return e.uniform1ui;case e.UNSIGNED_INT_VEC2:return e.uniform2uiv;case e.UNSIGNED_INT_VEC3:return e.uniform3uiv;case e.UNSIGNED_INT_VEC4:return e.uniform4uiv;case e.FLOAT_MAT2x3:return Bs;case e.FLOAT_MAT2x4:return Fs;case e.FLOAT_MAT3x2:return Us;case e.FLOAT_MAT3x4:return Hs;case e.FLOAT_MAT4x2:return ks;case e.FLOAT_MAT4x3:return zs;case e.SAMPLER_3D:case e.SAMPLER_2D_SHADOW:case e.SAMPLER_2D_ARRAY:case e.SAMPLER_2D_ARRAY_SHADOW:case e.SAMPLER_CUBE_SHADOW:case e.INT_SAMPLER_2D:case e.INT_SAMPLER_3D:case e.INT_SAMPLER_CUBE:case e.INT_SAMPLER_2D_ARRAY:case e.UNSIGNED_INT_SAMPLER_2D:case e.UNSIGNED_INT_SAMPLER_3D:case e.UNSIGNED_INT_SAMPLER_CUBE:case e.UNSIGNED_INT_SAMPLER_2D_ARRAY:return e.uniform1i}throw new Error("Cannot find uniform function for gl enum.")}function oc(e,t){switch(t){case e.FLOAT:return e.uniform1fv;case e.FLOAT_VEC2:return e.uniform2fv;case e.FLOAT_VEC3:return e.uniform3fv;case e.FLOAT_VEC4:return e.uniform4fv;case e.INT:return e.uniform1iv;case e.INT_VEC2:return e.uniform2iv;case e.INT_VEC3:return e.uniform3iv;case e.INT_VEC4:return e.uniform4iv;case e.BOOL:return e.uniform1iv;case e.BOOL_VEC2:return e.uniform2iv;case e.BOOL_VEC3:return e.uniform3iv;case e.BOOL_VEC4:return e.uniform4iv;case e.FLOAT_MAT2:return Ps;case e.FLOAT_MAT3:return Ns;case e.FLOAT_MAT4:return Ds;case e.SAMPLER_2D:case e.SAMPLER_CUBE:return e.uniform1iv}if(wr(e))switch(t){case e.UNSIGNED_INT:return e.uniform1uiv;case e.UNSIGNED_INT_VEC2:return e.uniform2uiv;case e.UNSIGNED_INT_VEC3:return e.uniform3uiv;case e.UNSIGNED_INT_VEC4:return e.uniform4uiv;case e.FLOAT_MAT2x3:return Bs;case e.FLOAT_MAT2x4:return Fs;case e.FLOAT_MAT3x2:return Us;case e.FLOAT_MAT3x4:return Hs;case e.FLOAT_MAT4x2:return ks;case e.FLOAT_MAT4x3:return zs;case e.SAMPLER_3D:case e.SAMPLER_2D_SHADOW:case e.SAMPLER_2D_ARRAY:case e.SAMPLER_2D_ARRAY_SHADOW:case e.SAMPLER_CUBE_SHADOW:case e.INT_SAMPLER_2D:case e.INT_SAMPLER_3D:case e.INT_SAMPLER_CUBE:case e.INT_SAMPLER_2D_ARRAY:case e.UNSIGNED_INT_SAMPLER_2D:case e.UNSIGNED_INT_SAMPLER_3D:case e.UNSIGNED_INT_SAMPLER_CUBE:case e.UNSIGNED_INT_SAMPLER_2D_ARRAY:return e.uniform1iv}throw new Error("Cannot find array uniform function for gl enum.")}function Ps(e,t){this.uniformMatrix2fv(e,!1,t)}function Ns(e,t){this.uniformMatrix3fv(e,!1,t)}function Ds(e,t){this.uniformMatrix4fv(e,!1,t)}function Bs(e,t){this.uniformMatrix2x3fv(e,!1,t)}function Fs(e,t){this.uniformMatrix2x4fv(e,!1,t)}function Us(e,t){this.uniformMatrix3x2fv(e,!1,t)}function Hs(e,t){this.uniformMatrix3x4fv(e,!1,t)}function ks(e,t){this.uniformMatrix4x2fv(e,!1,t)}function zs(e,t){this.uniformMatrix4x3fv(e,!1,t)}function lc(e,t){let r=[],n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let s=0;s<n;++s){let i=e.getActiveUniform(t,s);if(!i)break;r.push(i)}return r}function cc(e,t){let r=[],n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let s=0;s<n;++s){let i=e.getActiveAttrib(t,s);!i||r.push(i)}return r}function hc(e,t){let r={},n=lc(e,t);for(let s of n){let i=s.name,a=s.size,o=s.type,l=e.getUniformLocation(t,i),c;a<=1?c=ac(e,o):c=oc(e,o),r[i]={type:o,length:a,location:l,set:c}}return r}function fc(e,t){switch(t){case e.FLOAT:return 1;case e.FLOAT_VEC2:return 2;case e.FLOAT_VEC3:return 3;case e.FLOAT_VEC4:return 4;case e.FLOAT_MAT2:return 4;case e.FLOAT_MAT3:return 9;case e.FLOAT_MAT4:return 16;default:throw new Error("Invalid vertex attribute type.")}}function uc(e,t){let r={},n=cc(e,t);for(let s of n){let i=s.name,a=s.size,o=s.type,l=e.getAttribLocation(t,i),c=fc(e,o);r[i]={type:o,length:a,location:l,size:c}}return r}function pc(e,t,r){let n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)||(console.error(e.getShaderInfoLog(n)+`
Failed to compile shader:
${r}`),e.deleteShader(n)),n}function dc(e,t,r){for(let s of r)e.attachShader(t,s);e.linkProgram(t);for(let s of r)e.detachShader(t,s),e.deleteShader(s);return e.getProgramParameter(t,e.LINK_STATUS)||(console.error(e.getProgramInfoLog(t)),e.deleteProgram(t)),t}function mc(e,t,r,n,s=void 0){s?(e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,s),e.drawElements(t,n,e.UNSIGNED_SHORT,r)):e.drawArrays(t,r,n)}var Gs=class{constructor(t,r){this.handle=r,this.activeUniforms=hc(t,r),this.activeAttributes=uc(t,r),this.drawContext=new js(t,this)}bind(t){return t.useProgram(this.handle),this.drawContext.gl=t,this.drawContext}},js=class{constructor(t,r){this.gl=t,this.parent=r}uniform(t,r){let n=this.parent.activeUniforms;if(t in n){let s=n[t],i=s.location;s.set.call(this.gl,i,r)}return this}attribute(t,r,n,s=!1,i=0,a=0){let o=this.gl,l=this.parent.activeAttributes;if(t in l){let c=l[t],h=c.location,f=c.size;n?(o.bindBuffer(o.ARRAY_BUFFER,n),o.vertexAttribPointer(h,f,r,s,i,a),o.enableVertexAttribArray(h)):o.disableVertexAttribArray(h)}return this}draw(t,r,n,s,i=null){return mc(t,r,n,s,i),this.parent}},Ys=class{constructor(t,r=void 0){this.handle=r||t.createProgram(),this.shaders=[],this.gl=t}shader(t,r){let n=this.gl,s=pc(n,t,r);return this.shaders.push(s),this}link(){let t=this.gl;return dc(t,this.handle,this.shaders),this.shaders.length=0,this.handle}},Ue=class{constructor(t,r=void 0){this.programBuilder=new Ys(t,r)}get gl(){return this.programBuilder.gl}get handle(){return this.programBuilder.handle}get shaders(){return this.programBuilder.shaders}shader(t,r){return this.programBuilder.shader(t,r),this}link(){let t=this.programBuilder.link();return new Gs(this.gl,t)}};var F=1e-6,j=typeof Float32Array!="undefined"?Float32Array:Array,ie=Math.random;var i0=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var ot={};De(ot,{add:()=>Uc,adjoint:()=>wc,clone:()=>xc,copy:()=>yc,create:()=>br,determinant:()=>Mc,equals:()=>Gc,exactEquals:()=>zc,frob:()=>Fc,fromMat2d:()=>Oc,fromMat4:()=>vc,fromQuat:()=>Pc,fromRotation:()=>Lc,fromScaling:()=>Cc,fromTranslation:()=>Ic,fromValues:()=>_c,identity:()=>gc,invert:()=>Sc,mul:()=>jc,multiply:()=>Ks,multiplyScalar:()=>Hc,multiplyScalarAndAdd:()=>kc,normalFromMat4:()=>Nc,projection:()=>Dc,rotate:()=>bc,scale:()=>Rc,set:()=>Ec,str:()=>Bc,sub:()=>Yc,subtract:()=>$s,translate:()=>Tc,transpose:()=>Ac});function br(){var e=new j(9);return j!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function vc(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function xc(e){var t=new j(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function yc(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function _c(e,t,r,n,s,i,a,o,l){var c=new j(9);return c[0]=e,c[1]=t,c[2]=r,c[3]=n,c[4]=s,c[5]=i,c[6]=a,c[7]=o,c[8]=l,c}function Ec(e,t,r,n,s,i,a,o,l,c){return e[0]=t,e[1]=r,e[2]=n,e[3]=s,e[4]=i,e[5]=a,e[6]=o,e[7]=l,e[8]=c,e}function gc(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Ac(e,t){if(e===t){var r=t[1],n=t[2],s=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=s}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function Sc(e,t){var r=t[0],n=t[1],s=t[2],i=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8],f=h*a-o*c,u=-h*i+o*l,p=c*i-a*l,m=r*f+n*u+s*p;return m?(m=1/m,e[0]=f*m,e[1]=(-h*n+s*c)*m,e[2]=(o*n-s*a)*m,e[3]=u*m,e[4]=(h*r-s*l)*m,e[5]=(-o*r+s*i)*m,e[6]=p*m,e[7]=(-c*r+n*l)*m,e[8]=(a*r-n*i)*m,e):null}function wc(e,t){var r=t[0],n=t[1],s=t[2],i=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8];return e[0]=a*h-o*c,e[1]=s*c-n*h,e[2]=n*o-s*a,e[3]=o*l-i*h,e[4]=r*h-s*l,e[5]=s*i-r*o,e[6]=i*c-a*l,e[7]=n*l-r*c,e[8]=r*a-n*i,e}function Mc(e){var t=e[0],r=e[1],n=e[2],s=e[3],i=e[4],a=e[5],o=e[6],l=e[7],c=e[8];return t*(c*i-a*l)+r*(-c*s+a*o)+n*(l*s-i*o)}function Ks(e,t,r){var n=t[0],s=t[1],i=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],f=t[8],u=r[0],p=r[1],m=r[2],v=r[3],d=r[4],E=r[5],I=r[6],g=r[7],T=r[8];return e[0]=u*n+p*a+m*c,e[1]=u*s+p*o+m*h,e[2]=u*i+p*l+m*f,e[3]=v*n+d*a+E*c,e[4]=v*s+d*o+E*h,e[5]=v*i+d*l+E*f,e[6]=I*n+g*a+T*c,e[7]=I*s+g*o+T*h,e[8]=I*i+g*l+T*f,e}function Tc(e,t,r){var n=t[0],s=t[1],i=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],f=t[8],u=r[0],p=r[1];return e[0]=n,e[1]=s,e[2]=i,e[3]=a,e[4]=o,e[5]=l,e[6]=u*n+p*a+c,e[7]=u*s+p*o+h,e[8]=u*i+p*l+f,e}function bc(e,t,r){var n=t[0],s=t[1],i=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],f=t[8],u=Math.sin(r),p=Math.cos(r);return e[0]=p*n+u*a,e[1]=p*s+u*o,e[2]=p*i+u*l,e[3]=p*a-u*n,e[4]=p*o-u*s,e[5]=p*l-u*i,e[6]=c,e[7]=h,e[8]=f,e}function Rc(e,t,r){var n=r[0],s=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=s*t[3],e[4]=s*t[4],e[5]=s*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Ic(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function Lc(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Cc(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Oc(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function Pc(e,t){var r=t[0],n=t[1],s=t[2],i=t[3],a=r+r,o=n+n,l=s+s,c=r*a,h=n*a,f=n*o,u=s*a,p=s*o,m=s*l,v=i*a,d=i*o,E=i*l;return e[0]=1-f-m,e[3]=h-E,e[6]=u+d,e[1]=h+E,e[4]=1-c-m,e[7]=p-v,e[2]=u-d,e[5]=p+v,e[8]=1-c-f,e}function Nc(e,t){var r=t[0],n=t[1],s=t[2],i=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8],f=t[9],u=t[10],p=t[11],m=t[12],v=t[13],d=t[14],E=t[15],I=r*o-n*a,g=r*l-s*a,T=r*c-i*a,w=n*l-s*o,b=n*c-i*o,D=s*c-i*l,A=h*v-f*m,C=h*d-u*m,B=h*E-p*m,x=f*d-u*v,N=f*E-p*v,P=u*E-p*d,O=I*P-g*N+T*x+w*B-b*C+D*A;return O?(O=1/O,e[0]=(o*P-l*N+c*x)*O,e[1]=(l*B-a*P-c*C)*O,e[2]=(a*N-o*B+c*A)*O,e[3]=(s*N-n*P-i*x)*O,e[4]=(r*P-s*B+i*C)*O,e[5]=(n*B-r*N-i*A)*O,e[6]=(v*D-d*b+E*w)*O,e[7]=(d*T-m*D-E*g)*O,e[8]=(m*b-v*T+E*I)*O,e):null}function Dc(e,t,r){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/r,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function Bc(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function Fc(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}function Uc(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e}function $s(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e}function Hc(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e}function kc(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e}function zc(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function Gc(e,t){var r=e[0],n=e[1],s=e[2],i=e[3],a=e[4],o=e[5],l=e[6],c=e[7],h=e[8],f=t[0],u=t[1],p=t[2],m=t[3],v=t[4],d=t[5],E=t[6],I=t[7],g=t[8];return Math.abs(r-f)<=F*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(n-u)<=F*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(s-p)<=F*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(i-m)<=F*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(a-v)<=F*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(o-d)<=F*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(l-E)<=F*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(c-I)<=F*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(h-g)<=F*Math.max(1,Math.abs(h),Math.abs(g))}var jc=Ks,Yc=$s;var G={};De(G,{add:()=>Th,adjoint:()=>Zc,clone:()=>$c,copy:()=>Vc,create:()=>Kc,determinant:()=>Jc,equals:()=>Lh,exactEquals:()=>Ih,frob:()=>Mh,fromQuat:()=>xh,fromQuat2:()=>uh,fromRotation:()=>lh,fromRotationTranslation:()=>qs,fromRotationTranslationScale:()=>mh,fromRotationTranslationScaleOrigin:()=>vh,fromScaling:()=>oh,fromTranslation:()=>ah,fromValues:()=>Wc,fromXRotation:()=>ch,fromYRotation:()=>hh,fromZRotation:()=>fh,frustum:()=>yh,getRotation:()=>dh,getScaling:()=>Xs,getTranslation:()=>ph,identity:()=>Vs,invert:()=>Qc,lookAt:()=>Ah,mul:()=>Ch,multiply:()=>Ws,multiplyScalar:()=>bh,multiplyScalarAndAdd:()=>Rh,ortho:()=>gh,perspective:()=>_h,perspectiveFromFieldOfView:()=>Eh,rotate:()=>rh,rotateX:()=>nh,rotateY:()=>sh,rotateZ:()=>ih,scale:()=>th,set:()=>qc,str:()=>wh,sub:()=>Oh,subtract:()=>Qs,targetTo:()=>Sh,translate:()=>eh,transpose:()=>Xc});function Kc(){var e=new j(16);return j!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function $c(e){var t=new j(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Vc(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Wc(e,t,r,n,s,i,a,o,l,c,h,f,u,p,m,v){var d=new j(16);return d[0]=e,d[1]=t,d[2]=r,d[3]=n,d[4]=s,d[5]=i,d[6]=a,d[7]=o,d[8]=l,d[9]=c,d[10]=h,d[11]=f,d[12]=u,d[13]=p,d[14]=m,d[15]=v,d}function qc(e,t,r,n,s,i,a,o,l,c,h,f,u,p,m,v,d){return e[0]=t,e[1]=r,e[2]=n,e[3]=s,e[4]=i,e[5]=a,e[6]=o,e[7]=l,e[8]=c,e[9]=h,e[10]=f,e[11]=u,e[12]=p,e[13]=m,e[14]=v,e[15]=d,e}function Vs(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Xc(e,t){if(e===t){var r=t[1],n=t[2],s=t[3],i=t[6],a=t[7],o=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=i,e[11]=t[14],e[12]=s,e[13]=a,e[14]=o}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function Qc(e,t){var r=t[0],n=t[1],s=t[2],i=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8],f=t[9],u=t[10],p=t[11],m=t[12],v=t[13],d=t[14],E=t[15],I=r*o-n*a,g=r*l-s*a,T=r*c-i*a,w=n*l-s*o,b=n*c-i*o,D=s*c-i*l,A=h*v-f*m,C=h*d-u*m,B=h*E-p*m,x=f*d-u*v,N=f*E-p*v,P=u*E-p*d,O=I*P-g*N+T*x+w*B-b*C+D*A;return O?(O=1/O,e[0]=(o*P-l*N+c*x)*O,e[1]=(s*N-n*P-i*x)*O,e[2]=(v*D-d*b+E*w)*O,e[3]=(u*b-f*D-p*w)*O,e[4]=(l*B-a*P-c*C)*O,e[5]=(r*P-s*B+i*C)*O,e[6]=(d*T-m*D-E*g)*O,e[7]=(h*D-u*T+p*g)*O,e[8]=(a*N-o*B+c*A)*O,e[9]=(n*B-r*N-i*A)*O,e[10]=(m*b-v*T+E*I)*O,e[11]=(f*T-h*b-p*I)*O,e[12]=(o*C-a*x-l*A)*O,e[13]=(r*x-n*C+s*A)*O,e[14]=(v*g-m*w-d*I)*O,e[15]=(h*w-f*g+u*I)*O,e):null}function Zc(e,t){var r=t[0],n=t[1],s=t[2],i=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8],f=t[9],u=t[10],p=t[11],m=t[12],v=t[13],d=t[14],E=t[15];return e[0]=o*(u*E-p*d)-f*(l*E-c*d)+v*(l*p-c*u),e[1]=-(n*(u*E-p*d)-f*(s*E-i*d)+v*(s*p-i*u)),e[2]=n*(l*E-c*d)-o*(s*E-i*d)+v*(s*c-i*l),e[3]=-(n*(l*p-c*u)-o*(s*p-i*u)+f*(s*c-i*l)),e[4]=-(a*(u*E-p*d)-h*(l*E-c*d)+m*(l*p-c*u)),e[5]=r*(u*E-p*d)-h*(s*E-i*d)+m*(s*p-i*u),e[6]=-(r*(l*E-c*d)-a*(s*E-i*d)+m*(s*c-i*l)),e[7]=r*(l*p-c*u)-a*(s*p-i*u)+h*(s*c-i*l),e[8]=a*(f*E-p*v)-h*(o*E-c*v)+m*(o*p-c*f),e[9]=-(r*(f*E-p*v)-h*(n*E-i*v)+m*(n*p-i*f)),e[10]=r*(o*E-c*v)-a*(n*E-i*v)+m*(n*c-i*o),e[11]=-(r*(o*p-c*f)-a*(n*p-i*f)+h*(n*c-i*o)),e[12]=-(a*(f*d-u*v)-h*(o*d-l*v)+m*(o*u-l*f)),e[13]=r*(f*d-u*v)-h*(n*d-s*v)+m*(n*u-s*f),e[14]=-(r*(o*d-l*v)-a*(n*d-s*v)+m*(n*l-s*o)),e[15]=r*(o*u-l*f)-a*(n*u-s*f)+h*(n*l-s*o),e}function Jc(e){var t=e[0],r=e[1],n=e[2],s=e[3],i=e[4],a=e[5],o=e[6],l=e[7],c=e[8],h=e[9],f=e[10],u=e[11],p=e[12],m=e[13],v=e[14],d=e[15],E=t*a-r*i,I=t*o-n*i,g=t*l-s*i,T=r*o-n*a,w=r*l-s*a,b=n*l-s*o,D=c*m-h*p,A=c*v-f*p,C=c*d-u*p,B=h*v-f*m,x=h*d-u*m,N=f*d-u*v;return E*N-I*x+g*B+T*C-w*A+b*D}function Ws(e,t,r){var n=t[0],s=t[1],i=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],f=t[8],u=t[9],p=t[10],m=t[11],v=t[12],d=t[13],E=t[14],I=t[15],g=r[0],T=r[1],w=r[2],b=r[3];return e[0]=g*n+T*o+w*f+b*v,e[1]=g*s+T*l+w*u+b*d,e[2]=g*i+T*c+w*p+b*E,e[3]=g*a+T*h+w*m+b*I,g=r[4],T=r[5],w=r[6],b=r[7],e[4]=g*n+T*o+w*f+b*v,e[5]=g*s+T*l+w*u+b*d,e[6]=g*i+T*c+w*p+b*E,e[7]=g*a+T*h+w*m+b*I,g=r[8],T=r[9],w=r[10],b=r[11],e[8]=g*n+T*o+w*f+b*v,e[9]=g*s+T*l+w*u+b*d,e[10]=g*i+T*c+w*p+b*E,e[11]=g*a+T*h+w*m+b*I,g=r[12],T=r[13],w=r[14],b=r[15],e[12]=g*n+T*o+w*f+b*v,e[13]=g*s+T*l+w*u+b*d,e[14]=g*i+T*c+w*p+b*E,e[15]=g*a+T*h+w*m+b*I,e}function eh(e,t,r){var n=r[0],s=r[1],i=r[2],a,o,l,c,h,f,u,p,m,v,d,E;return t===e?(e[12]=t[0]*n+t[4]*s+t[8]*i+t[12],e[13]=t[1]*n+t[5]*s+t[9]*i+t[13],e[14]=t[2]*n+t[6]*s+t[10]*i+t[14],e[15]=t[3]*n+t[7]*s+t[11]*i+t[15]):(a=t[0],o=t[1],l=t[2],c=t[3],h=t[4],f=t[5],u=t[6],p=t[7],m=t[8],v=t[9],d=t[10],E=t[11],e[0]=a,e[1]=o,e[2]=l,e[3]=c,e[4]=h,e[5]=f,e[6]=u,e[7]=p,e[8]=m,e[9]=v,e[10]=d,e[11]=E,e[12]=a*n+h*s+m*i+t[12],e[13]=o*n+f*s+v*i+t[13],e[14]=l*n+u*s+d*i+t[14],e[15]=c*n+p*s+E*i+t[15]),e}function th(e,t,r){var n=r[0],s=r[1],i=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*s,e[5]=t[5]*s,e[6]=t[6]*s,e[7]=t[7]*s,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function rh(e,t,r,n){var s=n[0],i=n[1],a=n[2],o=Math.hypot(s,i,a),l,c,h,f,u,p,m,v,d,E,I,g,T,w,b,D,A,C,B,x,N,P,O,y;return o<F?null:(o=1/o,s*=o,i*=o,a*=o,l=Math.sin(r),c=Math.cos(r),h=1-c,f=t[0],u=t[1],p=t[2],m=t[3],v=t[4],d=t[5],E=t[6],I=t[7],g=t[8],T=t[9],w=t[10],b=t[11],D=s*s*h+c,A=i*s*h+a*l,C=a*s*h-i*l,B=s*i*h-a*l,x=i*i*h+c,N=a*i*h+s*l,P=s*a*h+i*l,O=i*a*h-s*l,y=a*a*h+c,e[0]=f*D+v*A+g*C,e[1]=u*D+d*A+T*C,e[2]=p*D+E*A+w*C,e[3]=m*D+I*A+b*C,e[4]=f*B+v*x+g*N,e[5]=u*B+d*x+T*N,e[6]=p*B+E*x+w*N,e[7]=m*B+I*x+b*N,e[8]=f*P+v*O+g*y,e[9]=u*P+d*O+T*y,e[10]=p*P+E*O+w*y,e[11]=m*P+I*O+b*y,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function nh(e,t,r){var n=Math.sin(r),s=Math.cos(r),i=t[4],a=t[5],o=t[6],l=t[7],c=t[8],h=t[9],f=t[10],u=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=i*s+c*n,e[5]=a*s+h*n,e[6]=o*s+f*n,e[7]=l*s+u*n,e[8]=c*s-i*n,e[9]=h*s-a*n,e[10]=f*s-o*n,e[11]=u*s-l*n,e}function sh(e,t,r){var n=Math.sin(r),s=Math.cos(r),i=t[0],a=t[1],o=t[2],l=t[3],c=t[8],h=t[9],f=t[10],u=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*s-c*n,e[1]=a*s-h*n,e[2]=o*s-f*n,e[3]=l*s-u*n,e[8]=i*n+c*s,e[9]=a*n+h*s,e[10]=o*n+f*s,e[11]=l*n+u*s,e}function ih(e,t,r){var n=Math.sin(r),s=Math.cos(r),i=t[0],a=t[1],o=t[2],l=t[3],c=t[4],h=t[5],f=t[6],u=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*s+c*n,e[1]=a*s+h*n,e[2]=o*s+f*n,e[3]=l*s+u*n,e[4]=c*s-i*n,e[5]=h*s-a*n,e[6]=f*s-o*n,e[7]=u*s-l*n,e}function ah(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function oh(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function lh(e,t,r){var n=r[0],s=r[1],i=r[2],a=Math.hypot(n,s,i),o,l,c;return a<F?null:(a=1/a,n*=a,s*=a,i*=a,o=Math.sin(t),l=Math.cos(t),c=1-l,e[0]=n*n*c+l,e[1]=s*n*c+i*o,e[2]=i*n*c-s*o,e[3]=0,e[4]=n*s*c-i*o,e[5]=s*s*c+l,e[6]=i*s*c+n*o,e[7]=0,e[8]=n*i*c+s*o,e[9]=s*i*c-n*o,e[10]=i*i*c+l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function ch(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function hh(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function fh(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function qs(e,t,r){var n=t[0],s=t[1],i=t[2],a=t[3],o=n+n,l=s+s,c=i+i,h=n*o,f=n*l,u=n*c,p=s*l,m=s*c,v=i*c,d=a*o,E=a*l,I=a*c;return e[0]=1-(p+v),e[1]=f+I,e[2]=u-E,e[3]=0,e[4]=f-I,e[5]=1-(h+v),e[6]=m+d,e[7]=0,e[8]=u+E,e[9]=m-d,e[10]=1-(h+p),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function uh(e,t){var r=new j(3),n=-t[0],s=-t[1],i=-t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],f=n*n+s*s+i*i+a*a;return f>0?(r[0]=(o*a+h*n+l*i-c*s)*2/f,r[1]=(l*a+h*s+c*n-o*i)*2/f,r[2]=(c*a+h*i+o*s-l*n)*2/f):(r[0]=(o*a+h*n+l*i-c*s)*2,r[1]=(l*a+h*s+c*n-o*i)*2,r[2]=(c*a+h*i+o*s-l*n)*2),qs(e,t,r),e}function ph(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Xs(e,t){var r=t[0],n=t[1],s=t[2],i=t[4],a=t[5],o=t[6],l=t[8],c=t[9],h=t[10];return e[0]=Math.hypot(r,n,s),e[1]=Math.hypot(i,a,o),e[2]=Math.hypot(l,c,h),e}function dh(e,t){var r=new j(3);Xs(r,t);var n=1/r[0],s=1/r[1],i=1/r[2],a=t[0]*n,o=t[1]*s,l=t[2]*i,c=t[4]*n,h=t[5]*s,f=t[6]*i,u=t[8]*n,p=t[9]*s,m=t[10]*i,v=a+h+m,d=0;return v>0?(d=Math.sqrt(v+1)*2,e[3]=.25*d,e[0]=(f-p)/d,e[1]=(u-l)/d,e[2]=(o-c)/d):a>h&&a>m?(d=Math.sqrt(1+a-h-m)*2,e[3]=(f-p)/d,e[0]=.25*d,e[1]=(o+c)/d,e[2]=(u+l)/d):h>m?(d=Math.sqrt(1+h-a-m)*2,e[3]=(u-l)/d,e[0]=(o+c)/d,e[1]=.25*d,e[2]=(f+p)/d):(d=Math.sqrt(1+m-a-h)*2,e[3]=(o-c)/d,e[0]=(u+l)/d,e[1]=(f+p)/d,e[2]=.25*d),e}function mh(e,t,r,n){var s=t[0],i=t[1],a=t[2],o=t[3],l=s+s,c=i+i,h=a+a,f=s*l,u=s*c,p=s*h,m=i*c,v=i*h,d=a*h,E=o*l,I=o*c,g=o*h,T=n[0],w=n[1],b=n[2];return e[0]=(1-(m+d))*T,e[1]=(u+g)*T,e[2]=(p-I)*T,e[3]=0,e[4]=(u-g)*w,e[5]=(1-(f+d))*w,e[6]=(v+E)*w,e[7]=0,e[8]=(p+I)*b,e[9]=(v-E)*b,e[10]=(1-(f+m))*b,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function vh(e,t,r,n,s){var i=t[0],a=t[1],o=t[2],l=t[3],c=i+i,h=a+a,f=o+o,u=i*c,p=i*h,m=i*f,v=a*h,d=a*f,E=o*f,I=l*c,g=l*h,T=l*f,w=n[0],b=n[1],D=n[2],A=s[0],C=s[1],B=s[2],x=(1-(v+E))*w,N=(p+T)*w,P=(m-g)*w,O=(p-T)*b,y=(1-(u+E))*b,_=(d+I)*b,$=(m+g)*D,k=(d-I)*D,Q=(1-(u+v))*D;return e[0]=x,e[1]=N,e[2]=P,e[3]=0,e[4]=O,e[5]=y,e[6]=_,e[7]=0,e[8]=$,e[9]=k,e[10]=Q,e[11]=0,e[12]=r[0]+A-(x*A+O*C+$*B),e[13]=r[1]+C-(N*A+y*C+k*B),e[14]=r[2]+B-(P*A+_*C+Q*B),e[15]=1,e}function xh(e,t){var r=t[0],n=t[1],s=t[2],i=t[3],a=r+r,o=n+n,l=s+s,c=r*a,h=n*a,f=n*o,u=s*a,p=s*o,m=s*l,v=i*a,d=i*o,E=i*l;return e[0]=1-f-m,e[1]=h+E,e[2]=u-d,e[3]=0,e[4]=h-E,e[5]=1-c-m,e[6]=p+v,e[7]=0,e[8]=u+d,e[9]=p-v,e[10]=1-c-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function yh(e,t,r,n,s,i,a){var o=1/(r-t),l=1/(s-n),c=1/(i-a);return e[0]=i*2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i*2*l,e[6]=0,e[7]=0,e[8]=(r+t)*o,e[9]=(s+n)*l,e[10]=(a+i)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*i*2*c,e[15]=0,e}function _h(e,t,r,n,s){var i=1/Math.tan(t/2),a;return e[0]=i/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,s!=null&&s!==Infinity?(a=1/(n-s),e[10]=(s+n)*a,e[14]=2*s*n*a):(e[10]=-1,e[14]=-2*n),e}function Eh(e,t,r,n){var s=Math.tan(t.upDegrees*Math.PI/180),i=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),o=Math.tan(t.rightDegrees*Math.PI/180),l=2/(a+o),c=2/(s+i);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-((a-o)*l*.5),e[9]=(s-i)*c*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e}function gh(e,t,r,n,s,i,a){var o=1/(t-r),l=1/(n-s),c=1/(i-a);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+r)*o,e[13]=(s+n)*l,e[14]=(a+i)*c,e[15]=1,e}function Ah(e,t,r,n){var s,i,a,o,l,c,h,f,u,p,m=t[0],v=t[1],d=t[2],E=n[0],I=n[1],g=n[2],T=r[0],w=r[1],b=r[2];return Math.abs(m-T)<F&&Math.abs(v-w)<F&&Math.abs(d-b)<F?Vs(e):(h=m-T,f=v-w,u=d-b,p=1/Math.hypot(h,f,u),h*=p,f*=p,u*=p,s=I*u-g*f,i=g*h-E*u,a=E*f-I*h,p=Math.hypot(s,i,a),p?(p=1/p,s*=p,i*=p,a*=p):(s=0,i=0,a=0),o=f*a-u*i,l=u*s-h*a,c=h*i-f*s,p=Math.hypot(o,l,c),p?(p=1/p,o*=p,l*=p,c*=p):(o=0,l=0,c=0),e[0]=s,e[1]=o,e[2]=h,e[3]=0,e[4]=i,e[5]=l,e[6]=f,e[7]=0,e[8]=a,e[9]=c,e[10]=u,e[11]=0,e[12]=-(s*m+i*v+a*d),e[13]=-(o*m+l*v+c*d),e[14]=-(h*m+f*v+u*d),e[15]=1,e)}function Sh(e,t,r,n){var s=t[0],i=t[1],a=t[2],o=n[0],l=n[1],c=n[2],h=s-r[0],f=i-r[1],u=a-r[2],p=h*h+f*f+u*u;p>0&&(p=1/Math.sqrt(p),h*=p,f*=p,u*=p);var m=l*u-c*f,v=c*h-o*u,d=o*f-l*h;return p=m*m+v*v+d*d,p>0&&(p=1/Math.sqrt(p),m*=p,v*=p,d*=p),e[0]=m,e[1]=v,e[2]=d,e[3]=0,e[4]=f*d-u*v,e[5]=u*m-h*d,e[6]=h*v-f*m,e[7]=0,e[8]=h,e[9]=f,e[10]=u,e[11]=0,e[12]=s,e[13]=i,e[14]=a,e[15]=1,e}function wh(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function Mh(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function Th(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function Qs(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function bh(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function Rh(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e}function Ih(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Lh(e,t){var r=e[0],n=e[1],s=e[2],i=e[3],a=e[4],o=e[5],l=e[6],c=e[7],h=e[8],f=e[9],u=e[10],p=e[11],m=e[12],v=e[13],d=e[14],E=e[15],I=t[0],g=t[1],T=t[2],w=t[3],b=t[4],D=t[5],A=t[6],C=t[7],B=t[8],x=t[9],N=t[10],P=t[11],O=t[12],y=t[13],_=t[14],$=t[15];return Math.abs(r-I)<=F*Math.max(1,Math.abs(r),Math.abs(I))&&Math.abs(n-g)<=F*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(s-T)<=F*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(i-w)<=F*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(a-b)<=F*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(o-D)<=F*Math.max(1,Math.abs(o),Math.abs(D))&&Math.abs(l-A)<=F*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(c-C)<=F*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(h-B)<=F*Math.max(1,Math.abs(h),Math.abs(B))&&Math.abs(f-x)<=F*Math.max(1,Math.abs(f),Math.abs(x))&&Math.abs(u-N)<=F*Math.max(1,Math.abs(u),Math.abs(N))&&Math.abs(p-P)<=F*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(m-O)<=F*Math.max(1,Math.abs(m),Math.abs(O))&&Math.abs(v-y)<=F*Math.max(1,Math.abs(v),Math.abs(y))&&Math.abs(d-_)<=F*Math.max(1,Math.abs(d),Math.abs(_))&&Math.abs(E-$)<=F*Math.max(1,Math.abs(E),Math.abs($))}var Ch=Ws,Oh=Qs;var J={};De(J,{add:()=>eu,calculateW:()=>jf,clone:()=>Xf,conjugate:()=>Vf,copy:()=>Zf,create:()=>zr,dot:()=>ui,equals:()=>au,exactEquals:()=>iu,exp:()=>di,fromEuler:()=>Wf,fromMat3:()=>xi,fromValues:()=>Qf,getAngle:()=>Hf,getAxisAngle:()=>Uf,identity:()=>Ff,invert:()=>$f,len:()=>nu,length:()=>yi,lerp:()=>ru,ln:()=>mi,mul:()=>tu,multiply:()=>pi,normalize:()=>Gr,pow:()=>Yf,random:()=>Kf,rotateX:()=>kf,rotateY:()=>zf,rotateZ:()=>Gf,rotationTo:()=>ou,scale:()=>vi,set:()=>Jf,setAxes:()=>cu,setAxisAngle:()=>fi,slerp:()=>Dt,sqlerp:()=>lu,sqrLen:()=>su,squaredLength:()=>_i,str:()=>qf});var z={};De(z,{add:()=>Bh,angle:()=>rf,bezier:()=>Wh,ceil:()=>Fh,clone:()=>Ph,copy:()=>Nh,create:()=>Lt,cross:()=>lt,dist:()=>ff,distance:()=>ri,div:()=>hf,divide:()=>ti,dot:()=>Ot,equals:()=>of,exactEquals:()=>af,floor:()=>Uh,forEach:()=>df,fromValues:()=>Ct,hermite:()=>Vh,inverse:()=>Kh,len:()=>Ir,length:()=>Zs,lerp:()=>$h,max:()=>kh,min:()=>Hh,mul:()=>cf,multiply:()=>ei,negate:()=>Yh,normalize:()=>Rr,random:()=>qh,rotateX:()=>Jh,rotateY:()=>ef,rotateZ:()=>tf,round:()=>zh,scale:()=>Gh,scaleAndAdd:()=>jh,set:()=>Dh,sqrDist:()=>uf,sqrLen:()=>pf,squaredDistance:()=>ni,squaredLength:()=>si,str:()=>sf,sub:()=>lf,subtract:()=>Js,transformMat3:()=>Qh,transformMat4:()=>Xh,transformQuat:()=>Zh,zero:()=>nf});function Lt(){var e=new j(3);return j!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Ph(e){var t=new j(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Zs(e){var t=e[0],r=e[1],n=e[2];return Math.hypot(t,r,n)}function Ct(e,t,r){var n=new j(3);return n[0]=e,n[1]=t,n[2]=r,n}function Nh(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Dh(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e}function Bh(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function Js(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function ei(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function ti(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function Fh(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function Uh(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function Hh(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e}function kh(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e}function zh(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function Gh(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function jh(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e}function ri(e,t){var r=t[0]-e[0],n=t[1]-e[1],s=t[2]-e[2];return Math.hypot(r,n,s)}function ni(e,t){var r=t[0]-e[0],n=t[1]-e[1],s=t[2]-e[2];return r*r+n*n+s*s}function si(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}function Yh(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function Kh(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function Rr(e,t){var r=t[0],n=t[1],s=t[2],i=r*r+n*n+s*s;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e}function Ot(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function lt(e,t,r){var n=t[0],s=t[1],i=t[2],a=r[0],o=r[1],l=r[2];return e[0]=s*l-i*o,e[1]=i*a-n*l,e[2]=n*o-s*a,e}function $h(e,t,r,n){var s=t[0],i=t[1],a=t[2];return e[0]=s+n*(r[0]-s),e[1]=i+n*(r[1]-i),e[2]=a+n*(r[2]-a),e}function Vh(e,t,r,n,s,i){var a=i*i,o=a*(2*i-3)+1,l=a*(i-2)+i,c=a*(i-1),h=a*(3-2*i);return e[0]=t[0]*o+r[0]*l+n[0]*c+s[0]*h,e[1]=t[1]*o+r[1]*l+n[1]*c+s[1]*h,e[2]=t[2]*o+r[2]*l+n[2]*c+s[2]*h,e}function Wh(e,t,r,n,s,i){var a=1-i,o=a*a,l=i*i,c=o*a,h=3*i*o,f=3*l*a,u=l*i;return e[0]=t[0]*c+r[0]*h+n[0]*f+s[0]*u,e[1]=t[1]*c+r[1]*h+n[1]*f+s[1]*u,e[2]=t[2]*c+r[2]*h+n[2]*f+s[2]*u,e}function qh(e,t){t=t||1;var r=ie()*2*Math.PI,n=ie()*2-1,s=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*s,e[1]=Math.sin(r)*s,e[2]=n*t,e}function Xh(e,t,r){var n=t[0],s=t[1],i=t[2],a=r[3]*n+r[7]*s+r[11]*i+r[15];return a=a||1,e[0]=(r[0]*n+r[4]*s+r[8]*i+r[12])/a,e[1]=(r[1]*n+r[5]*s+r[9]*i+r[13])/a,e[2]=(r[2]*n+r[6]*s+r[10]*i+r[14])/a,e}function Qh(e,t,r){var n=t[0],s=t[1],i=t[2];return e[0]=n*r[0]+s*r[3]+i*r[6],e[1]=n*r[1]+s*r[4]+i*r[7],e[2]=n*r[2]+s*r[5]+i*r[8],e}function Zh(e,t,r){var n=r[0],s=r[1],i=r[2],a=r[3],o=t[0],l=t[1],c=t[2],h=s*c-i*l,f=i*o-n*c,u=n*l-s*o,p=s*u-i*f,m=i*h-n*u,v=n*f-s*h,d=a*2;return h*=d,f*=d,u*=d,p*=2,m*=2,v*=2,e[0]=o+h+p,e[1]=l+f+m,e[2]=c+u+v,e}function Jh(e,t,r,n){var s=[],i=[];return s[0]=t[0]-r[0],s[1]=t[1]-r[1],s[2]=t[2]-r[2],i[0]=s[0],i[1]=s[1]*Math.cos(n)-s[2]*Math.sin(n),i[2]=s[1]*Math.sin(n)+s[2]*Math.cos(n),e[0]=i[0]+r[0],e[1]=i[1]+r[1],e[2]=i[2]+r[2],e}function ef(e,t,r,n){var s=[],i=[];return s[0]=t[0]-r[0],s[1]=t[1]-r[1],s[2]=t[2]-r[2],i[0]=s[2]*Math.sin(n)+s[0]*Math.cos(n),i[1]=s[1],i[2]=s[2]*Math.cos(n)-s[0]*Math.sin(n),e[0]=i[0]+r[0],e[1]=i[1]+r[1],e[2]=i[2]+r[2],e}function tf(e,t,r,n){var s=[],i=[];return s[0]=t[0]-r[0],s[1]=t[1]-r[1],s[2]=t[2]-r[2],i[0]=s[0]*Math.cos(n)-s[1]*Math.sin(n),i[1]=s[0]*Math.sin(n)+s[1]*Math.cos(n),i[2]=s[2],e[0]=i[0]+r[0],e[1]=i[1]+r[1],e[2]=i[2]+r[2],e}function rf(e,t){var r=e[0],n=e[1],s=e[2],i=t[0],a=t[1],o=t[2],l=Math.sqrt(r*r+n*n+s*s),c=Math.sqrt(i*i+a*a+o*o),h=l*c,f=h&&Ot(e,t)/h;return Math.acos(Math.min(Math.max(f,-1),1))}function nf(e){return e[0]=0,e[1]=0,e[2]=0,e}function sf(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function af(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function of(e,t){var r=e[0],n=e[1],s=e[2],i=t[0],a=t[1],o=t[2];return Math.abs(r-i)<=F*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-a)<=F*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(s-o)<=F*Math.max(1,Math.abs(s),Math.abs(o))}var lf=Js,cf=ei,hf=ti,ff=ri,uf=ni,Ir=Zs,pf=si,df=function(){var e=Lt();return function(t,r,n,s,i,a){var o,l;for(r||(r=3),n||(n=0),s?l=Math.min(s*r+n,t.length):l=t.length,o=n;o<l;o+=r)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],i(e,e,a),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2];return t}}();var Ee={};De(Ee,{add:()=>Nr,ceil:()=>mf,clone:()=>Lr,copy:()=>Or,create:()=>ii,cross:()=>Sf,dist:()=>Of,distance:()=>ci,div:()=>Cf,divide:()=>li,dot:()=>Fr,equals:()=>kr,exactEquals:()=>Hr,floor:()=>vf,forEach:()=>Bf,fromValues:()=>Cr,inverse:()=>Af,len:()=>Nf,length:()=>Pt,lerp:()=>Ur,max:()=>yf,min:()=>xf,mul:()=>Lf,multiply:()=>oi,negate:()=>gf,normalize:()=>Br,random:()=>wf,round:()=>_f,scale:()=>Dr,scaleAndAdd:()=>Ef,set:()=>Pr,sqrDist:()=>Pf,sqrLen:()=>Df,squaredDistance:()=>hi,squaredLength:()=>Nt,str:()=>Rf,sub:()=>If,subtract:()=>ai,transformMat4:()=>Mf,transformQuat:()=>Tf,zero:()=>bf});function ii(){var e=new j(4);return j!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Lr(e){var t=new j(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Cr(e,t,r,n){var s=new j(4);return s[0]=e,s[1]=t,s[2]=r,s[3]=n,s}function Or(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Pr(e,t,r,n,s){return e[0]=t,e[1]=r,e[2]=n,e[3]=s,e}function Nr(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function ai(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function oi(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function li(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function mf(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function vf(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function xf(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e}function yf(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e}function _f(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function Dr(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function Ef(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e}function ci(e,t){var r=t[0]-e[0],n=t[1]-e[1],s=t[2]-e[2],i=t[3]-e[3];return Math.hypot(r,n,s,i)}function hi(e,t){var r=t[0]-e[0],n=t[1]-e[1],s=t[2]-e[2],i=t[3]-e[3];return r*r+n*n+s*s+i*i}function Pt(e){var t=e[0],r=e[1],n=e[2],s=e[3];return Math.hypot(t,r,n,s)}function Nt(e){var t=e[0],r=e[1],n=e[2],s=e[3];return t*t+r*r+n*n+s*s}function gf(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function Af(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function Br(e,t){var r=t[0],n=t[1],s=t[2],i=t[3],a=r*r+n*n+s*s+i*i;return a>0&&(a=1/Math.sqrt(a)),e[0]=r*a,e[1]=n*a,e[2]=s*a,e[3]=i*a,e}function Fr(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Sf(e,t,r,n){var s=r[0]*n[1]-r[1]*n[0],i=r[0]*n[2]-r[2]*n[0],a=r[0]*n[3]-r[3]*n[0],o=r[1]*n[2]-r[2]*n[1],l=r[1]*n[3]-r[3]*n[1],c=r[2]*n[3]-r[3]*n[2],h=t[0],f=t[1],u=t[2],p=t[3];return e[0]=f*c-u*l+p*o,e[1]=-(h*c)+u*a-p*i,e[2]=h*l-f*a+p*s,e[3]=-(h*o)+f*i-u*s,e}function Ur(e,t,r,n){var s=t[0],i=t[1],a=t[2],o=t[3];return e[0]=s+n*(r[0]-s),e[1]=i+n*(r[1]-i),e[2]=a+n*(r[2]-a),e[3]=o+n*(r[3]-o),e}function wf(e,t){t=t||1;var r,n,s,i,a,o;do r=ie()*2-1,n=ie()*2-1,a=r*r+n*n;while(a>=1);do s=ie()*2-1,i=ie()*2-1,o=s*s+i*i;while(o>=1);var l=Math.sqrt((1-a)/o);return e[0]=t*r,e[1]=t*n,e[2]=t*s*l,e[3]=t*i*l,e}function Mf(e,t,r){var n=t[0],s=t[1],i=t[2],a=t[3];return e[0]=r[0]*n+r[4]*s+r[8]*i+r[12]*a,e[1]=r[1]*n+r[5]*s+r[9]*i+r[13]*a,e[2]=r[2]*n+r[6]*s+r[10]*i+r[14]*a,e[3]=r[3]*n+r[7]*s+r[11]*i+r[15]*a,e}function Tf(e,t,r){var n=t[0],s=t[1],i=t[2],a=r[0],o=r[1],l=r[2],c=r[3],h=c*n+o*i-l*s,f=c*s+l*n-a*i,u=c*i+a*s-o*n,p=-a*n-o*s-l*i;return e[0]=h*c+p*-a+f*-l-u*-o,e[1]=f*c+p*-o+u*-a-h*-l,e[2]=u*c+p*-l+h*-o-f*-a,e[3]=t[3],e}function bf(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function Rf(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function Hr(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function kr(e,t){var r=e[0],n=e[1],s=e[2],i=e[3],a=t[0],o=t[1],l=t[2],c=t[3];return Math.abs(r-a)<=F*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-o)<=F*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(s-l)<=F*Math.max(1,Math.abs(s),Math.abs(l))&&Math.abs(i-c)<=F*Math.max(1,Math.abs(i),Math.abs(c))}var If=ai,Lf=oi,Cf=li,Of=ci,Pf=hi,Nf=Pt,Df=Nt,Bf=function(){var e=ii();return function(t,r,n,s,i,a){var o,l;for(r||(r=4),n||(n=0),s?l=Math.min(s*r+n,t.length):l=t.length,o=n;o<l;o+=r)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],e[3]=t[o+3],i(e,e,a),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2],t[o+3]=e[3];return t}}();function zr(){var e=new j(4);return j!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Ff(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function fi(e,t,r){r=r*.5;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function Uf(e,t){var r=Math.acos(t[3])*2,n=Math.sin(r/2);return n>F?(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n):(e[0]=1,e[1]=0,e[2]=0),r}function Hf(e,t){var r=ui(e,t);return Math.acos(2*r*r-1)}function pi(e,t,r){var n=t[0],s=t[1],i=t[2],a=t[3],o=r[0],l=r[1],c=r[2],h=r[3];return e[0]=n*h+a*o+s*c-i*l,e[1]=s*h+a*l+i*o-n*c,e[2]=i*h+a*c+n*l-s*o,e[3]=a*h-n*o-s*l-i*c,e}function kf(e,t,r){r*=.5;var n=t[0],s=t[1],i=t[2],a=t[3],o=Math.sin(r),l=Math.cos(r);return e[0]=n*l+a*o,e[1]=s*l+i*o,e[2]=i*l-s*o,e[3]=a*l-n*o,e}function zf(e,t,r){r*=.5;var n=t[0],s=t[1],i=t[2],a=t[3],o=Math.sin(r),l=Math.cos(r);return e[0]=n*l-i*o,e[1]=s*l+a*o,e[2]=i*l+n*o,e[3]=a*l-s*o,e}function Gf(e,t,r){r*=.5;var n=t[0],s=t[1],i=t[2],a=t[3],o=Math.sin(r),l=Math.cos(r);return e[0]=n*l+s*o,e[1]=s*l-n*o,e[2]=i*l+a*o,e[3]=a*l-i*o,e}function jf(e,t){var r=t[0],n=t[1],s=t[2];return e[0]=r,e[1]=n,e[2]=s,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-s*s)),e}function di(e,t){var r=t[0],n=t[1],s=t[2],i=t[3],a=Math.sqrt(r*r+n*n+s*s),o=Math.exp(i),l=a>0?o*Math.sin(a)/a:0;return e[0]=r*l,e[1]=n*l,e[2]=s*l,e[3]=o*Math.cos(a),e}function mi(e,t){var r=t[0],n=t[1],s=t[2],i=t[3],a=Math.sqrt(r*r+n*n+s*s),o=a>0?Math.atan2(a,i)/a:0;return e[0]=r*o,e[1]=n*o,e[2]=s*o,e[3]=.5*Math.log(r*r+n*n+s*s+i*i),e}function Yf(e,t,r){return mi(e,t),vi(e,e,r),di(e,e),e}function Dt(e,t,r,n){var s=t[0],i=t[1],a=t[2],o=t[3],l=r[0],c=r[1],h=r[2],f=r[3],u,p,m,v,d;return p=s*l+i*c+a*h+o*f,p<0&&(p=-p,l=-l,c=-c,h=-h,f=-f),1-p>F?(u=Math.acos(p),m=Math.sin(u),v=Math.sin((1-n)*u)/m,d=Math.sin(n*u)/m):(v=1-n,d=n),e[0]=v*s+d*l,e[1]=v*i+d*c,e[2]=v*a+d*h,e[3]=v*o+d*f,e}function Kf(e){var t=ie(),r=ie(),n=ie(),s=Math.sqrt(1-t),i=Math.sqrt(t);return e[0]=s*Math.sin(2*Math.PI*r),e[1]=s*Math.cos(2*Math.PI*r),e[2]=i*Math.sin(2*Math.PI*n),e[3]=i*Math.cos(2*Math.PI*n),e}function $f(e,t){var r=t[0],n=t[1],s=t[2],i=t[3],a=r*r+n*n+s*s+i*i,o=a?1/a:0;return e[0]=-r*o,e[1]=-n*o,e[2]=-s*o,e[3]=i*o,e}function Vf(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function xi(e,t){var r=t[0]+t[4]+t[8],n;if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var s=0;t[4]>t[0]&&(s=1),t[8]>t[s*3+s]&&(s=2);var i=(s+1)%3,a=(s+2)%3;n=Math.sqrt(t[s*3+s]-t[i*3+i]-t[a*3+a]+1),e[s]=.5*n,n=.5/n,e[3]=(t[i*3+a]-t[a*3+i])*n,e[i]=(t[i*3+s]+t[s*3+i])*n,e[a]=(t[a*3+s]+t[s*3+a])*n}return e}function Wf(e,t,r,n){var s=.5*Math.PI/180;t*=s,r*=s,n*=s;var i=Math.sin(t),a=Math.cos(t),o=Math.sin(r),l=Math.cos(r),c=Math.sin(n),h=Math.cos(n);return e[0]=i*l*h-a*o*c,e[1]=a*o*h+i*l*c,e[2]=a*l*c-i*o*h,e[3]=a*l*h+i*o*c,e}function qf(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var Xf=Lr,Qf=Cr,Zf=Or,Jf=Pr,eu=Nr,tu=pi,vi=Dr,ui=Fr,ru=Ur,yi=Pt,nu=yi,_i=Nt,su=_i,Gr=Br,iu=Hr,au=kr,ou=function(){var e=Lt(),t=Ct(1,0,0),r=Ct(0,1,0);return function(n,s,i){var a=Ot(s,i);return a<-.999999?(lt(e,t,s),Ir(e)<1e-6&&lt(e,r,s),Rr(e,e),fi(n,e,Math.PI),n):a>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(lt(e,s,i),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+a,Gr(n,n))}}(),lu=function(){var e=zr(),t=zr();return function(r,n,s,i,a,o){return Dt(e,n,a,o),Dt(t,s,i,o),Dt(r,e,t,2*o*(1-o)),r}}(),cu=function(){var e=br();return function(t,r,n,s){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=s[0],e[4]=s[1],e[7]=s[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],Gr(t,xi(t,e))}}();var qe={};De(qe,{add:()=>du,angle:()=>Nu,ceil:()=>mu,clone:()=>hu,copy:()=>uu,create:()=>Ei,cross:()=>Tu,dist:()=>ju,distance:()=>wi,div:()=>Gu,divide:()=>Si,dot:()=>Mu,equals:()=>Uu,exactEquals:()=>Fu,floor:()=>vu,forEach:()=>$u,fromValues:()=>fu,inverse:()=>Su,len:()=>Hu,length:()=>Ti,lerp:()=>bu,max:()=>yu,min:()=>xu,mul:()=>zu,multiply:()=>Ai,negate:()=>Au,normalize:()=>wu,random:()=>Ru,rotate:()=>Pu,round:()=>_u,scale:()=>Eu,scaleAndAdd:()=>gu,set:()=>pu,sqrDist:()=>Yu,sqrLen:()=>Ku,squaredDistance:()=>Mi,squaredLength:()=>bi,str:()=>Bu,sub:()=>ku,subtract:()=>gi,transformMat2:()=>Iu,transformMat2d:()=>Lu,transformMat3:()=>Cu,transformMat4:()=>Ou,zero:()=>Du});function Ei(){var e=new j(2);return j!=Float32Array&&(e[0]=0,e[1]=0),e}function hu(e){var t=new j(2);return t[0]=e[0],t[1]=e[1],t}function fu(e,t){var r=new j(2);return r[0]=e,r[1]=t,r}function uu(e,t){return e[0]=t[0],e[1]=t[1],e}function pu(e,t,r){return e[0]=t,e[1]=r,e}function du(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function gi(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function Ai(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function Si(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function mu(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function vu(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function xu(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}function yu(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}function _u(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function Eu(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function gu(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e}function wi(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.hypot(r,n)}function Mi(e,t){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function Ti(e){var t=e[0],r=e[1];return Math.hypot(t,r)}function bi(e){var t=e[0],r=e[1];return t*t+r*r}function Au(e,t){return e[0]=-t[0],e[1]=-t[1],e}function Su(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function wu(e,t){var r=t[0],n=t[1],s=r*r+n*n;return s>0&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e}function Mu(e,t){return e[0]*t[0]+e[1]*t[1]}function Tu(e,t,r){var n=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=n,e}function bu(e,t,r,n){var s=t[0],i=t[1];return e[0]=s+n*(r[0]-s),e[1]=i+n*(r[1]-i),e}function Ru(e,t){t=t||1;var r=ie()*2*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e}function Iu(e,t,r){var n=t[0],s=t[1];return e[0]=r[0]*n+r[2]*s,e[1]=r[1]*n+r[3]*s,e}function Lu(e,t,r){var n=t[0],s=t[1];return e[0]=r[0]*n+r[2]*s+r[4],e[1]=r[1]*n+r[3]*s+r[5],e}function Cu(e,t,r){var n=t[0],s=t[1];return e[0]=r[0]*n+r[3]*s+r[6],e[1]=r[1]*n+r[4]*s+r[7],e}function Ou(e,t,r){var n=t[0],s=t[1];return e[0]=r[0]*n+r[4]*s+r[12],e[1]=r[1]*n+r[5]*s+r[13],e}function Pu(e,t,r,n){var s=t[0]-r[0],i=t[1]-r[1],a=Math.sin(n),o=Math.cos(n);return e[0]=s*o-i*a+r[0],e[1]=s*a+i*o+r[1],e}function Nu(e,t){var r=e[0],n=e[1],s=t[0],i=t[1],a=Math.sqrt(r*r+n*n)*Math.sqrt(s*s+i*i),o=a&&(r*s+n*i)/a;return Math.acos(Math.min(Math.max(o,-1),1))}function Du(e){return e[0]=0,e[1]=0,e}function Bu(e){return"vec2("+e[0]+", "+e[1]+")"}function Fu(e,t){return e[0]===t[0]&&e[1]===t[1]}function Uu(e,t){var r=e[0],n=e[1],s=t[0],i=t[1];return Math.abs(r-s)<=F*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-i)<=F*Math.max(1,Math.abs(n),Math.abs(i))}var Hu=Ti,ku=gi,zu=Ai,Gu=Si,ju=wi,Yu=Mi,Ku=bi,$u=function(){var e=Ei();return function(t,r,n,s,i,a){var o,l;for(r||(r=2),n||(n=0),s?l=Math.min(s*r+n,t.length):l=t.length,o=n;o<l;o+=r)e[0]=t[o],e[1]=t[o+1],i(e,e,a),t[o]=e[0],t[o+1]=e[1];return t}}();var oe={red(e){return e>>16&255},redf(e){return(e>>16&255)/255},green(e){return e>>8&255},greenf(e){return(e>>8&255)/255},blue(e){return e&255},bluef(e){return(e&255)/255},alpha(e){return e>>24&255},alphaf(e){return(e>>24&255)/255},hexf(e,t,r,n=1){let s=Math.floor(Math.max(Math.min(e,1),0)*255),i=Math.floor(Math.max(Math.min(t,1),0)*255),a=Math.floor(Math.max(Math.min(r,1),0)*255);return(Math.floor(Math.max(Math.min(n,1),0)*255)&255)<<24|(s&255)<<16|(i&255)<<8|a&255},mix(e=0,t=16777215,r=.5){let n=this.redf(e),s=this.greenf(e),i=this.bluef(e),a=this.alphaf(e),o=(this.redf(t)-n)*r+n,l=(this.greenf(t)-s)*r+s,c=(this.bluef(t)-i)*r+i,h=(this.alphaf(t)-a)*r+a;return h<.01&&(h=void 0),this.hexf(o,l,c,h)}};var _0=z.fromValues(0,1,0);var Ri=class{constructor(t,r){this.projectionMatrix=t,this.viewMatrix=r}resize(t=void 0,r=void 0){return this}},E0=Math.PI/3;var jr=class extends Ri{constructor(t=void 0,r=void 0,n=void 0,s=void 0,i=-1e3,a=1e3){super(G.create(),G.create());this.orthoBounds={left:typeof t=="undefined"?void 0:Number(t),top:typeof r=="undefined"?void 0:Number(r),right:typeof n=="undefined"?void 0:Number(n),bottom:typeof s=="undefined"?void 0:Number(s)},this.clippingPlane={near:Number(i),far:Number(a)}}resize(t=void 0,r=void 0){let{near:n,far:s}=this.clippingPlane,{left:i,top:a,right:o,bottom:l}=this.orthoBounds,c=this.projectionMatrix,h=typeof t!="undefined",f=typeof i!="undefined";if(h)if(f){let u=t/r;G.ortho(c,i*u,o*u,l,a,n,s)}else G.ortho(c,0,t,r,0,n,s);else f?G.ortho(c,i,o,l,a,n,s):G.ortho(c,-1,1,1,-1,-1,1);return this}},g0=Math.PI/180;var Yr=class{constructor(t,r=t.canvas,n=new jr){this.gl=t,this.canvas=r,this.camera=n,this.projectionViewMatrix=G.create(),this.modelMatrix=G.create(),this.colorVector=z.create(),this.depthFloat=0,this.opacityFloat=1,this.transformStack=[],this.transformMatrix=G.create(),this.translationVector=z.create(),this.rotationQuat=J.create(),this.scaleVector=z.fromValues(1,1,1),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA)}reset(){this.resize(),this.clear(0,0,0,1),this.setColorVector(1,1,1),this.setDepthFloat(0),this.setOpacityFloat(1),this.resetTransform(),this.transformStack.length=0}resize(){let t=this.gl,r=t.canvas.width,n=t.canvas.height;t.viewport(0,0,r,n);let s=this.camera;s.resize(r,n);let i=this.projectionViewMatrix;G.mul(i,s.projectionMatrix,s.viewMatrix)}clear(t,r,n,s=1){let i=this.gl;i.clearColor(t,r,n,s),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT)}setColorVector(t,r,n){return z.set(this.colorVector,t,r,n),this}setColor(t){return this.setColorVector(oe.redf(t),oe.greenf(t),oe.bluef(t))}setDepthFloat(t){return this.depthFloat=t,this}setOpacityFloat(t){return this.opacityFloat=t,this}setTranslation(t,r,n=0){return z.set(this.translationVector,t,r,n),this}setRotation(t,r,n){return J.fromEuler(this.rotationQuat,t,r,n),this}setScale(t,r){return z.set(this.scaleVector,t,r,1),this}resetTransform(){G.identity(this.transformMatrix),z.zero(this.translationVector),J.identity(this.rotationQuat),z.set(this.scaleVector,1,1,1)}pushTransform(){G.fromRotationTranslationScale(this.transformMatrix,this.rotationQuat,this.translationVector,this.scaleVector),this.transformStack.push(this.transformMatrix),this.transformMatrix=G.create(),this.resetTransform()}popTransform(){let t=this.transformStack.pop();G.getRotation(this.rotationQuat,t),G.getTranslation(this.translationVector,t),G.getScaling(this.scaleVector,t),this.transformMatrix=t}applyTransform(t){for(let r=this.transformStack.length-1;r>=0;--r)G.mul(t,this.transformStack[r],t);return G.mul(t,G.fromRotationTranslationScale(this.transformMatrix,this.rotationQuat,this.translationVector,this.scaleVector),t),t}};var Vu=`
attribute vec2 a_position;

uniform mat4 u_projection_view;
uniform mat4 u_model;

void main() {
    gl_Position = u_projection_view * u_model * vec4(a_position.xy, 0.0, 1.0);
}`,Wu=`
precision mediump float;

uniform vec3 u_color;
uniform float u_opacity_inv;

void main() {
    gl_FragColor = vec4(u_color.rgb, 1.0 - u_opacity_inv);
}`,Kr=16,Ii=(()=>{let e=[],t=Kr,r=Math.PI*2/t,n=1,s=0,i,a;for(let o=0;o<=t;++o)i=Math.cos(o*r),a=Math.sin(o*r),e.push(0,0),e.push(n,s),e.push(i,a),n=i,s=a;return e})(),qu=Math.trunc(Ii.length/2),Li=(()=>{let e=[],t=Kr,r=Math.PI*2/t,n=1,s=0,i,a;for(let o=0;o<=t;++o)i=Math.cos(o*r),a=Math.sin(o*r),e.push(n,s),e.push(i,a),n=i,s=a;return e})(),Xu=Math.trunc(Li.length/2),Qu=Kr/2,Ci=(()=>{let e=[],t=Qu,r=Math.PI/t,n=1,s=0,i,a;for(let o=0;o<=t;++o)i=Math.cos(o*r),a=Math.sin(o*r),e.push(0,0),e.push(n,s),e.push(i,a),n=i,s=a;return e})(),Zu=Math.trunc(Ci.length/2),Bt=[0,0,1,0,0,1,1,1,1,0,0,1],Ju=[0,0,1,1],$r=class extends Yr{constructor(t,r=void 0,n=void 0){super(t,r,n);this.shapeProgram=new Ue(t).shader(t.VERTEX_SHADER,Vu).shader(t.FRAGMENT_SHADER,Wu).link(),this.meshQuad=new _e(t,t.ARRAY_BUFFER).data(Re.createBufferSource(t,t.FLOAT,Bt)).build(),this.meshLine=new _e(t,t.ARRAY_BUFFER).data(Re.createBufferSource(t,t.FLOAT,Ju)).build(),this.meshCircle=new _e(t,t.ARRAY_BUFFER).data(Re.createBufferSource(t,t.FLOAT,Ii)).build(),this.meshLineCircle=new _e(t,t.ARRAY_BUFFER).data(Re.createBufferSource(t,t.FLOAT,Li)).build(),this.meshHalfCircle=new _e(t,t.ARRAY_BUFFER).data(Re.createBufferSource(t,t.FLOAT,Ci)).build()}resize(){super.resize(),this.shapeProgram.bind(this.gl).uniform("u_projection_view",this.projectionViewMatrix)}setColorVector(t,r,n){return super.setColorVector(t,r,n),this.shapeProgram.bind(this.gl).uniform("u_color",this.colorVector),this}setOpacityFloat(t){return super.setOpacityFloat(t),this.shapeProgram.bind(this.gl).uniform("u_opacity_inv",1-this.opacityFloat),this}drawLine(t=0,r=0,n=t+16,s=r){let i=this.gl,a=this.depthFloat,o=n-t,l=s-r,c=this.modelMatrix;return G.fromRotationTranslationScale(c,J.create(),z.fromValues(t,r,a),z.fromValues(o,l,1)),this.applyTransform(c),this.shapeProgram.bind(i).attribute("a_position",i.FLOAT,this.meshLine.handle).uniform("u_model",c).draw(i,i.LINES,0,2),this}drawQuadratic(t=0,r=0,n=t+16,s=r,i=16,a=9){let o=n-t,l=s-r,c=o/2+t,h=l/2+r+i,f=[t,r,c,h,n,s];ep(f,f,a);let u=f.length;for(let p=2;p<=u-2;p+=2)this.drawLine(f[p-2],f[p-1],f[p],f[p+1])}drawRay(t=0,r=0,n=0,s=16){let i=Math.PI*n/180;return this.drawLine(t,r,t+Math.cos(i)*s,r+Math.sin(i)*s)}drawBox(t=0,r=0,n=8,s=n){return this.drawBoxImpl(this.gl.TRIANGLES,t,r,this.depthFloat,n,s)}drawLineBox(t=0,r=0,n=8,s=n){return this.drawBoxImpl(this.gl.LINE_LOOP,t,r,this.depthFloat,n,s)}drawRect(t=0,r=0,n=16,s=16){let i=(n-t)/2,a=(s-r)/2;return this.drawBox(t+i,r+a,i,a)}drawLineRect(t=0,r=0,n=16,s=16){let i=(n-t)/2,a=(s-r)/2;return this.drawLineBox(t+i,r+a,i,a)}drawCircle(t=0,r=0,n=8){return this.drawCircleImpl(this.meshCircle,qu,this.gl.TRIANGLES,t,r,this.depthFloat,n)}drawLineCircle(t=0,r=0,n=8){return this.drawCircleImpl(this.meshLineCircle,Xu,this.gl.LINE_LOOP,t,r,this.depthFloat,n)}drawHalfCircle(t=0,r=0,n=8){return this.drawCircleImpl(this.meshHalfCircle,Zu,this.gl.TRIANGLES,t,r,this.depthFloat,n)}drawBoxImpl(t,r,n,s,i,a){let o=this.gl,l=this.modelMatrix;return G.fromRotationTranslationScaleOrigin(l,J.create(),z.fromValues(r,n,s),z.fromValues(i*2,a*2,1),z.fromValues(.5,.5,0)),this.applyTransform(l),this.shapeProgram.bind(o).attribute("a_position",o.FLOAT,this.meshQuad.handle).uniform("u_model",l).draw(o,t,0,6),this}drawCircleImpl(t,r,n,s,i,a,o){let l=this.gl,c=this.modelMatrix;return G.fromRotationTranslationScale(c,J.create(),z.fromValues(s,i,a),z.fromValues(o,o,1)),this.applyTransform(c),this.shapeProgram.bind(l).attribute("a_position",l.FLOAT,t.handle).uniform("u_model",c).draw(l,n,0,r),this}};function ep(e,t,r){if(t.length<6)throw new Error("Cannot find quadratic points from less than 3 points.");let[n,s,i,a,o,l]=t,c=ot.fromValues(n*n,i*i,o*o,n,i,o,1,1,1),h=z.fromValues(s,a,l);ot.invert(c,c);let f=z.transformMat3(h,h,c);e.length=0,e.push(n,s);let u=o-n;for(let p=1;p<r-1;++p){let m=p/r,v=u*m+n,d=f[0]*v*v+f[1]*v+f[2];e.push(v,d)}return e.push(o,l),e}var tp=`
attribute vec2 a_position;
attribute vec2 a_texcoord;

varying vec2 v_texcoord;

uniform mat4 u_projection_view;
uniform mat4 u_model;

void main() {
    vec4 position = u_projection_view * u_model
        * vec4(a_position.xy, 0.0, 1.0);
    v_texcoord = a_texcoord;
    gl_Position = position;
}`,rp=`
precision mediump float;

varying vec2 v_texcoord;

uniform sampler2D u_texture;
uniform vec2 u_texture_size;
uniform vec4 u_sprite;
uniform vec3 u_color;
uniform float u_opacity_inv;

void main() {
    float spriteWidth = u_sprite.z - u_sprite.x;
    float spriteHeight = u_sprite.w - u_sprite.y;
    vec2 texcoord = vec2(
        (u_sprite.x / u_texture_size.x) + v_texcoord.x * (spriteWidth / u_texture_size.x),
        (u_sprite.y / u_texture_size.y) + v_texcoord.y * (spriteHeight / u_texture_size.y));
    vec4 texcolor = texture2D(u_texture, texcoord);
    if (texcolor.a <= 0.0) discard;
    gl_FragColor = vec4(
        texcolor.r * u_color.r,
        texcolor.g * u_color.g,
        texcolor.b * u_color.b,
        texcolor.a * (1.0 - u_opacity_inv));
}`,Vr=class extends $r{constructor(t,r=void 0,n=void 0){super(t,r,n);this.texturedProgram=new Ue(t).shader(t.VERTEX_SHADER,tp).shader(t.FRAGMENT_SHADER,rp).link(),this.meshQuadTextured={position:new _e(t,t.ARRAY_BUFFER).data(Re.createBufferSource(t,t.FLOAT,Bt)).build(),texcoord:new _e(t,t.ARRAY_BUFFER).data(Re.createBufferSource(t,t.FLOAT,Bt)).build()},this.spriteVector=Ee.fromValues(0,0,1,1),this.textureSize=qe.fromValues(1,1),this.textureHandle=null,this.textureList=new Array(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS))}resize(){super.resize(),this.texturedProgram.bind(this.gl).uniform("u_projection_view",this.projectionViewMatrix)}setColorVector(t,r,n){return super.setColorVector(t,r,n),this.texturedProgram.bind(this.gl).uniform("u_color",this.colorVector),this}setOpacityFloat(t){return super.setOpacityFloat(t),this.texturedProgram.bind(this.gl).uniform("u_opacity_inv",1-this.opacityFloat),this}setTextureImage(t,r){let n=this.textureList,s=n.length;if(t<0||t>=s)throw new Error(`Invalid texture unit - must be within range [0, ${s-1}]`);let i=this.gl,a=n[t];a&&sp(i,a.handle);let o=np(i,r);return n[t]=o,i.activeTexture(i.TEXTURE0+t),i.bindTexture(i.TEXTURE_2D,o.handle),this}drawTexturedBox(t=0,r=0,n=0,s=void 0,i=void 0,a=0,o=0,l=void 0,c=void 0){let{width:h,height:f}=this.textureList[t];qe.set(this.textureSize,h,f),typeof l=="undefined"&&(l=h),typeof c=="undefined"&&(c=f),Ee.set(this.spriteVector,a,o,l,c);let u=l-a,p=c-o,m=!1;typeof s=="undefined"?s=u/2:m=!0,typeof i=="undefined"&&(m?i=s:i=p/2);let v=s*2,d=i*2,E=v/u,I=d/p;return this.drawTexturedQuadImpl(t,r,n,this.depthFloat,E,I)}drawTexturedRect(t=0,r=0,n=0,s=void 0,i=void 0,a=0,o=0,l=void 0,c=void 0){let{width:h,height:f}=this.textureList[t];typeof l=="undefined"&&(l=h),typeof c=="undefined"&&(c=f),qe.set(this.textureSize,h,f),Ee.set(this.spriteVector,a,o,l,c),typeof s=="undefined"&&(s=r+h),typeof i=="undefined"&&(i=n+f);let u=s-r,p=i-n,m=l-a,v=c-o,d=u/m,E=p/v,I=r+m/2*d,g=n+v/2*E;return this.drawTexturedQuadImpl(t,I,g,this.depthFloat,d,E)}drawTexturedQuadImpl(t,r,n,s,i,a){let o=this.gl,l=this.spriteVector,c=l[2]-l[0],h=l[3]-l[1],f=this.modelMatrix;G.fromRotationTranslationScaleOrigin(f,J.fromEuler(J.create(),0,0,0),z.fromValues(r-c/2,n-h/2,s),z.fromValues(i,a,1),z.fromValues(c/2,h/2,0)),G.scale(f,f,z.fromValues(c,h,1)),this.applyTransform(f);let u=this.meshQuadTextured,p=this.textureSize;return this.texturedProgram.bind(o).attribute("a_position",o.FLOAT,u.position.handle).attribute("a_texcoord",o.FLOAT,u.texcoord.handle).uniform("u_model",f).uniform("u_texture",t).uniform("u_sprite",l).uniform("u_texture_size",p).draw(o,o.TRIANGLES,0,6),this}};function np(e,t){if(!(t instanceof Image))throw new Error(`Not a valid image ${t}.`);let r=0,n=e.RGBA,s=e.RGBA,i=e.UNSIGNED_BYTE,a=e.createTexture();return e.bindTexture(e.TEXTURE_2D,a),e.texImage2D(e.TEXTURE_2D,r,n,s,i,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),{handle:a,width:t.width,height:t.height}}function sp(e,t){e.deleteTexture(t)}var ip=`
attribute vec2 a_position;

varying vec2 v_position;

uniform mat4 u_projection_view;
uniform mat4 u_model;

void main() {
    gl_Position = u_projection_view * u_model * vec4(a_position.xy, 0.0, 1.0);
    v_position = a_position;
}`,ap=`
precision mediump float;

varying vec2 v_position;

uniform vec3 u_color;
uniform float u_opacity_inv;

uniform vec3 u_color_from;
uniform vec3 u_color_to;

uniform vec4 u_gradient_rect;

void main() {
    // float fx = (gl_FragCoord.x - u_gradient_rect.x) / u_gradient_rect.z;
    float fy = (gl_FragCoord.y - u_gradient_rect.y) / u_gradient_rect.w;
    gl_FragColor = vec4(mix(u_color_to, u_color_from, fy), 1.0 - u_opacity_inv);
}`,Wr=class extends Vr{constructor(t,r=void 0,n=void 0){super(t,r,n);this.gradientProgram=new Ue(t).shader(t.VERTEX_SHADER,ip).shader(t.FRAGMENT_SHADER,ap).link(),this.gradientColor=z.create(),this.gradientVector=Ee.create()}resize(){super.resize(),this.gradientProgram.bind(this.gl).uniform("u_projection_view",this.projectionViewMatrix)}setColorVector(t,r,n){return super.setColorVector(t,r,n),this.gradientProgram.bind(this.gl).uniform("u_color",this.colorVector),this}setOpacityFloat(t){return super.setOpacityFloat(t),this.gradientProgram.bind(this.gl).uniform("u_opacity_inv",1-this.opacityFloat),this}drawGradientRect(t=16777215,r=0,n=0,s=0,i=this.canvas.width,a=this.canvas.height){let o=(i-n)/2,l=(a-s)/2,c=n+o,h=s+l,f=this.depthFloat,u=this.gl,p=this.modelMatrix;return G.fromRotationTranslationScaleOrigin(p,J.fromEuler(J.create(),0,0,0),z.fromValues(c,h,f),z.fromValues(o*2,l*2,1),z.fromValues(.5,.5,0)),this.applyTransform(p),this.gradientProgram.bind(u).attribute("a_position",u.FLOAT,this.meshQuad.handle).uniform("u_model",p).uniform("u_color_from",z.set(this.gradientColor,oe.redf(t),oe.greenf(t),oe.bluef(t))).uniform("u_color_to",z.set(this.gradientColor,oe.redf(r),oe.greenf(r),oe.bluef(r))).uniform("u_gradient_rect",Ee.set(this.gradientVector,n,this.canvas.height-a,o*2,l*2)).draw(u,u.TRIANGLES,0,6),this}};var qr=class extends Wr{constructor(t,r=void 0,n=void 0){super(t,r,n);this.bmFontMap={}}setBMFontTexture(t,r,n){let s={};for(let i of n.chars){let a=i.x,o=i.y,l=a+i.width,c=o+i.height;s[i.id]={u:a,v:o,s:l,t:c}}this.bmFontMap[t]=s,this.setTextureImage(t,r)}drawText(t,r,n,s){let i=n,a=13,o=18;for(let l=0;l<r.length;++l){let c=r.charAt(l);if(c===`
`){s+=o,n=i;continue}else if(c===" "){n+=a;continue}else{n+=a;let h=r.charCodeAt(l),{u:f,v:u,s:p,t:m}=this.bmFontMap[t][h],v=p-f,d=m-u;this.drawTexturedBox(t,n,s,v/2,d/2,f,u,p,m)}}}};function le(e,t,r){let n=at(e,Xr);Me(e,()=>{let s=n.current,i=op(t,r);return s.listeners.push(i),s.listeners.sort(lp),()=>{let a=s.listeners.indexOf(i);a>=0&&s.listeners.splice(a,1)}})}function op(e,t){return{index:e,callback:t}}function lp(e,t){return e.index-t.index}async function Xr(e){await Ve(e,We);let t=[];return Is(e,r=>{let{deltaTime:n}=r.detail;for(let{callback:s}of t)s(n)}),{listeners:t}}function Ce(e){return Te(e,Oi).renderer}async function Oi(e){await Ve(e,Xr),await Ve(e,We);let r=be(e).canvas;return{renderer:new qr(r.getContext("webgl"))}}function cp(){return{init:[],loop:[],first:!0}}function He(e,t){let r=Te(e,hp),n=$e(e),s=`${Ts(e,e.current)}.${n}`;s in r.listeners||(r.listeners[s]=cp()),r.listeners[s].loop.push(t)}async function hp(e){let t={listeners:{},loaded:!1};Fe(e,"loadEnd",()=>{t.loaded=!0});let r=-1;return bs(e,()=>{if(!t.loaded)return;let n=performance.now();r<0&&(r=n-1);let s=n-r;r=n;for(let i of Object.values(t.listeners))if(i.first){for(let a of i.init)a();i.first=!1}else for(let a of i.loop)a(s)}),t}var Qr=class{next(){return 0}},Pi=class extends Qr{next(){return Math.random()}},Ni=class extends Qr{constructor(t){super();this.seed=t,this.a=t}next(){var t=this.a+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}},Oe=class{static get RAND(){let t=new this;return this.next=this.next.bind(this),this.choose=this.choose.bind(this),this.range=this.range.bind(this),this.rangeInt=this.rangeInt.bind(this),this.sign=this.sign.bind(this),Object.defineProperty(this,"RAND",{value:t}),t}constructor(t=void 0){typeof t=="number"?this.generator=new Ni(t):t?this.generator=t:this.generator=new Pi,this.next=this.next.bind(this),this.choose=this.choose.bind(this),this.range=this.range.bind(this),this.rangeInt=this.rangeInt.bind(this),this.sign=this.sign.bind(this)}static next(){return this.RAND.next()}next(){return this.generator.next()}static choose(t){return this.RAND.choose(t)}choose(t){return t[Math.floor(this.generator.next()*t.length)]}static range(t,r){return this.RAND.range(t,r)}range(t,r){return(r-t)*this.generator.next()+t}static rangeInt(t,r){return this.RAND.rangeInt(t,r)}rangeInt(t,r){return Math.trunc(this.range(t,r))}static sign(){return this.RAND.sign()}sign(){return this.generator.next()<.5?-1:1}};var ke=class{constructor(t,r){this.name=t,this.factory=r}create(){return this.factory()}createAll(t=[],r=1){for(let n=0;n<r;++n){let s=this.create();t.push(s)}return t}destroy(t){}destroyAll(t){for(let r of t)this.destroy(r)}};var Di=0,Zr=1,Jr=2;var Bi=5,Fi=6;var Ui=8;function fp(){return{x:0,y:0,startTime:0,dead:!1}}var h1=new ke("ripple",fp);var en=8e3;function Ut(e,t,r,n,s,i=!1){let a=s-n;if(i)a%=en;else if(a>=en)return;let o=1-a/en,l=(1-o)*.9,c=(1-o)*.5;e.setColor(16777215),e.setTranslation(t,r,10),e.setScale(2+l*2,.5+l),e.setOpacityFloat(o),e.drawLineCircle(),e.setScale(1+c*2,.1+c),e.drawLineCircle(),e.setOpacityFloat(1),e.resetTransform()}var R1=new X("fishShadow","raw://fish_shadow.png",re),I1=new ke("fish",()=>({x:0,y:0,offset:0,size:0,speed:0})),L1=[0,Math.PI*2];var up=5,pp=4,dp=3,mp=2,vp=1,xp=0,O1={[up]:ct("#7F8C8D"),[pp]:ct("#2ECC71"),[dp]:ct("#4794C8"),[mp]:ct("#F39C12"),[vp]:ct("#C0392B"),[xp]:[""]};function ct(e){return[`background: ${e}`,"border-radius: 0.5em","color: white","font-weight: bold","padding: 2px 0.5em"]}var P1=Symbol("level"),N1=Symbol("domain");var Xe=0,yp=class{constructor(t){this._heap=[],this._comparator=t}get size(){return this._heap.length}clear(){this._heap.length=0}push(...t){for(let r of t)this._heap.push(r),this._shiftUp()}pop(){let t=this.peek(),r=_p(this);return r>Xe&&this._swap(Xe,r),this._heap.pop(),this._shiftDown(),t}replace(t){let r=this.peek();return this._heap[Xe]=t,this._shiftDown(),r}peek(){return this._heap[Xe]}_compare(t,r){return this._comparator(this._heap[t],this._heap[r])}_swap(t,r){let n=this._heap[t];this._heap[t]=this._heap[r],this._heap[r]=n}_shiftUp(){let t=this._heap.length-1,r;for(;t>Xe&&this._compare(t,r=Ep(t));)this._swap(t,r),t=r}_shiftDown(){let t=this._heap.length,r=Xe,n,s=ki(r),i=s<t,a=zi(r),o=a<t;for(;i&&this._compare(s,r)||o&&this._compare(a,r);)n=o&&this._compare(a,s)?a:s,this._swap(r,n),r=n,s=ki(r),i=s<t,a=zi(r),o=a<t}values(){return this._heap}[Symbol.iterator](){return this._heap[Symbol.iterator]()}};function _p(e){return e._heap.length-1}function Ep(e){return(e+1>>>1)-1}function ki(e){return(e<<1)+1}function zi(e){return e+1<<1}var D1=Math.PI/180,B1=180/Math.PI;var J1={StarImage:new X("star.png","raw://star.png",re),BlurStrokeImage:new X("blur_stroke.png","raw://blur_stroke.png",re),CircleImage:new X("circle.png","raw://circle.png",re),CloudImage:new X("cloud.png","raw://cloud.png",re)};var um={Wave1Image:new X("wave1.png","raw://wave1.png",re),Wave2Image:new X("wave2.png","raw://wave2.png",re)};var Nm=new ke("player",()=>({x:0,y:0,motionX:0}));var tn=Symbol("internal"),Tp=Symbol("manager");function bp(e,t,r,n,s){return{state:null,global:s,current:r,name:e,args:n,ready:new it,dead:new it,[Tp]:t,[tn]:{handle:1,before:{},after:{}}}}var rn=class{constructor(){this.contexts=new Map,this.sharedState=null}async start(t,r=void 0){let n=this.contexts;typeof r!="undefined"&&(this.sharedState?Object.assign(this.sharedState,r):this.sharedState=r);let s=this.sharedState;for(let i of t)await ji(n,s,i,i.name,[]);Rp()}async stop(){let t=this.contexts,r=Array.from(this.contexts.values()).reverse();Ip(t);for(let n of r)await Yi(t,n);this.sharedState=null}async subStart(t,r=t.name,n=[]){let s=this.contexts,i=this.sharedState,a=ji(s,i,t,r,n);await Ki(a)}async subStop(t,r=t.name){let n=this.contexts,s=n.get(r);$i(s),Yi(n,s)}getSystemContext(t,r=t.name){return this.contexts.get(r)}};async function ji(e,t,r,n,s){if(typeof n=="undefined"&&(n=r.name||`UnnamedSystem${String(e.size).padStart(3,"0")}`),e.has(n))throw new Error(`Cannot use system that already exists with same name '${n}'.`);let i=bp(n,this,r,s,t);e.set(n,i);let a=i.ready,o=i.dead;try{let l=await i.current(i,...i.args);i.state=l,a.resolve(i)}catch(l){return a.reject(l),o.reject(new Error("System failed to create.")),null}return i}async function Yi(e,t){let r=t.name;e.delete(r);let n=t.dead;if(!n.pending)return;let s=t.ready;if(s.pending){let i=new Error("System destroyed before finishing create.");s.reject(i),n.reject(i);return}n.resolve(t)}async function Rp(e){for(let t of e)await Ki(t)}async function Ki(e){let t=e[tn],r=t.before,n=t.after;t.before={};for(let s of Object.keys(r)){let i=r[s];try{let a=await i();typeof a=="function"&&(n[s]=a)}catch(a){console.error(a)}}}async function Ip(e){let t=Array.from(e.values()).reverse();for(let r of t)await $i(r)}async function $i(e){let t=e[tn],r=t.after;t.after={},t.before={};let n=Object.values(r).reverse();for(let s of n)try{await s()}catch(i){console.error(i)}}var nn=class{constructor(){this.listeners={},this.eventQueue=[],this.dispatchEvent=this.dispatchEvent.bind(this),this.flushEvents=this.flushEvents.bind(this)}addEventListener(t,r){let n;return t in this.listeners?n=this.listeners[t]:(n=[],this.listeners[t]=n),n.push(r),this}removeEventListener(t,r){if(!(t in this.listeners))return;let n=this.listeners[t],s=n.indexOf(r);return n.splice(s,1),this}clearEventListeners(t){this.listeners[t]=[]}clearEvents(){this.eventQueue.length=0}dispatchEvent(t){this.eventQueue.push(t)}flushEvents(t=1e3){let r=t,n=this.eventQueue,s=this.listeners;for(;n.length>0&&r>0;){r--;let i=n.shift(),a=i.type;if(a in s){let o=s[a];for(let l of o)if(l(i))break}}}};function Vi(e){e.global.events=new nn}async function Wi(){let e=new rn;await e.start([Vi]),console.log("READY!"),await e.stop(),console.log("STOPED")}window.addEventListener("DOMContentLoaded",Cp);async function Cp(){await Wi()}async function Cv(e){let t=Es(),r=Ce(e),n=be(e);gs(t.inputs),await As();let s={progression:0};return He(e,()=>{let i=performance.now();t.inputs.poll(i),Op(s)}),le(e,Di,i=>{r.resize(),r.reset()}),le(e,Zr-.5,()=>{r.setTranslation(0,0,-10),r.pushTransform()}),le(e,Jr+.5,()=>{r.popTransform()}),le(e,Bi,i=>{let a=n.width,o=n.height,l=st.FastForward.down?30:1,c=performance.now()*l;r.setTranslation(a-50,o-110),r.setScale(20,3),r.setColor(3355443),r.setOpacityFloat(.3),r.drawCircle(),r.setOpacityFloat(1),r.resetTransform(),r.setColor(16777215),Ut(r,a-180,o-113,3e3,c,!0),Ut(r,a-100,o-92,5e3,c,!0),r.setTranslation(0,0,20),r.setColor(10057562),r.setTextureImage(8,fe.PierLegImage.current),r.drawTexturedBox(8,a-100,o-110,10,20),r.drawTexturedBox(8,a-180,o-120,8,10,0,30),r.setTextureImage(7,fe.PierImage.current),r.drawTexturedRect(7,a-fe.PierImage.current.width,o-140,a,o-100),r.resetTransform()}),le(e,Fi,i=>{let a=n.width,o=n.height;r.setTranslation(0,0,30),r.setTextureImage(9,fe.BucketImage.current),r.setColor(12833752),r.drawTexturedBox(9,a-140,o-140,15)}),le(e,Ui+.5,()=>{r.resetTransform()}),e}function Op(e){if(!fe.MusicBack.current.isPlaying()&&(fe.MusicBack.current.setGain(.4).play(),!fe.MusicLayer1.current.isPlaying()&&!fe.MusicLayer2.current.isPlaying())){let t=Oe.rangeInt(4,6);e.progression+=t,e.progression<8&&Oe.next()<e.progression/10?(fe.MusicLayer1.current.setGain(.6).play(),e.progression+=Oe.rangeInt(-4,4)):e.progression>8&&(fe.MusicLayer2.current.setGain(.6).play(),e.progression/=2)}}})();
//# sourceMappingURL=main.js.map
