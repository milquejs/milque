(()=>{var ia=Object.create,ut=Object.defineProperty;var sa=Object.getOwnPropertyDescriptor;var aa=Object.getOwnPropertyNames;var oa=Object.getPrototypeOf,la=Object.prototype.hasOwnProperty;var ca=e=>ut(e,"__esModule",{value:!0});var ha=(e,t)=>()=>(e&&(t=e(e=0)),t),Pe=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Fe=(e,t)=>{for(var n in t)ut(e,n,{get:t[n],enumerable:!0})},fa=(e,t,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of aa(t))!la.call(e,r)&&r!=="default"&&ut(e,r,{get:()=>t[r],enumerable:!(n=sa(t,r))||n.enumerable});return e},ua=e=>fa(ca(ut(e!=null?ia(oa(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var Nr={};Fe(Nr,{basename:()=>Cr,default:()=>Vo,delimiter:()=>Rr,dirname:()=>Ir,extname:()=>Lr,isAbsolute:()=>an,join:()=>Tr,normalize:()=>sn,relative:()=>Mr,resolve:()=>vt,sep:()=>Sr});function br(e,t){for(var n=0,r=e.length-1;r>=0;r--){var i=e[r];i==="."?e.splice(r,1):i===".."?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function vt(){for(var e="",t=!1,n=arguments.length-1;n>=-1&&!t;n--){var r=n>=0?arguments[n]:"/";if(typeof r!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!r)continue;e=r+"/"+e,t=r.charAt(0)==="/"}return e=br(on(e.split("/"),function(i){return!!i}),!t).join("/"),(t?"/":"")+e||"."}function sn(e){var t=an(e),n=Ko(e,-1)==="/";return e=br(on(e.split("/"),function(r){return!!r}),!t).join("/"),!e&&!t&&(e="."),e&&n&&(e+="/"),(t?"/":"")+e}function an(e){return e.charAt(0)==="/"}function Tr(){var e=Array.prototype.slice.call(arguments,0);return sn(on(e,function(t,n){if(typeof t!="string")throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))}function Mr(e,t){e=vt(e).substr(1),t=vt(t).substr(1);function n(c){for(var h=0;h<c.length&&c[h]==="";h++);for(var f=c.length-1;f>=0&&c[f]==="";f--);return h>f?[]:c.slice(h,f-h+1)}for(var r=n(e.split("/")),i=n(t.split("/")),s=Math.min(r.length,i.length),a=s,o=0;o<s;o++)if(r[o]!==i[o]){a=o;break}for(var l=[],o=a;o<r.length;o++)l.push("..");return l=l.concat(i.slice(a)),l.join("/")}function Ir(e){var t=rn(e),n=t[0],r=t[1];return!n&&!r?".":(r&&(r=r.substr(0,r.length-1)),n+r)}function Cr(e,t){var n=rn(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n}function Lr(e){return rn(e)[3]}function on(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}var $o,rn,Sr,Rr,Vo,Ko,Or=ha(()=>{$o=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,rn=function(e){return $o.exec(e).slice(1)};Sr="/",Rr=":";Vo={extname:Lr,basename:Cr,dirname:Ir,sep:Sr,delimiter:Rr,relative:Mr,join:Tr,isAbsolute:an,normalize:sn,resolve:vt};Ko="ab".substr(-1)==="b"?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}});var gt=Pe((Rd,xt)=>{var Ue=(Or(),Nr);if(Ue&&Ue.default){xt.exports=Ue.default;for(let e in Ue)xt.exports[e]=Ue[e]}else Ue&&(xt.exports=Ue)});var Je=Pe((Id,Ur)=>{"use strict";var Wo=gt(),_e="\\\\/",Br=`[^${_e}]`,Se="\\.",jo="\\+",qo="\\?",yt="\\/",Xo="(?=.)",Pr="[^/]",ln=`(?:${yt}|$)`,Fr=`(?:^|${yt})`,cn=`${Se}{1,2}${ln}`,Qo=`(?!${Se})`,Zo=`(?!${Fr}${cn})`,Jo=`(?!${Se}{0,1}${ln})`,el=`(?!${cn})`,tl=`[^.${yt}]`,nl=`${Pr}*?`,Dr={DOT_LITERAL:Se,PLUS_LITERAL:jo,QMARK_LITERAL:qo,SLASH_LITERAL:yt,ONE_CHAR:Xo,QMARK:Pr,END_ANCHOR:ln,DOTS_SLASH:cn,NO_DOT:Qo,NO_DOTS:Zo,NO_DOT_SLASH:Jo,NO_DOTS_SLASH:el,QMARK_NO_DOT:tl,STAR:nl,START_ANCHOR:Fr},rl={...Dr,SLASH_LITERAL:`[${_e}]`,QMARK:Br,STAR:`${Br}*?`,DOTS_SLASH:`${Se}{1,2}(?:[${_e}]|$)`,NO_DOT:`(?!${Se})`,NO_DOTS:`(?!(?:^|[${_e}])${Se}{1,2}(?:[${_e}]|$))`,NO_DOT_SLASH:`(?!${Se}{0,1}(?:[${_e}]|$))`,NO_DOTS_SLASH:`(?!${Se}{1,2}(?:[${_e}]|$))`,QMARK_NO_DOT:`[^.${_e}]`,START_ANCHOR:`(?:^|[${_e}])`,END_ANCHOR:`(?:[${_e}]|$)`},il={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};Ur.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:il,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:Wo.sep,extglobChars(e){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${e.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(e){return e===!0?rl:Dr}}});var _t=Pe(oe=>{"use strict";var sl=gt(),al=!1,{REGEX_BACKSLASH:ol,REGEX_REMOVE_BACKSLASH:ll,REGEX_SPECIAL_CHARS:cl,REGEX_SPECIAL_CHARS_GLOBAL:hl}=Je();oe.isObject=e=>e!==null&&typeof e=="object"&&!Array.isArray(e);oe.hasRegexChars=e=>cl.test(e);oe.isRegexChar=e=>e.length===1&&oe.hasRegexChars(e);oe.escapeRegex=e=>e.replace(hl,"\\$1");oe.toPosixSlashes=e=>e.replace(ol,"/");oe.removeBackslashes=e=>e.replace(ll,t=>t==="\\"?"":t);oe.supportsLookbehinds=()=>{let e=process.version.slice(1).split(".").map(Number);return e.length===3&&e[0]>=9||e[0]===8&&e[1]>=10};oe.isWindows=e=>e&&typeof e.windows=="boolean"?e.windows:al===!0||sl.sep==="\\";oe.escapeLast=(e,t,n)=>{let r=e.lastIndexOf(t,n);return r===-1?e:e[r-1]==="\\"?oe.escapeLast(e,t,r-1):`${e.slice(0,r)}\\${e.slice(r)}`};oe.removePrefix=(e,t={})=>{let n=e;return n.startsWith("./")&&(n=n.slice(2),t.prefix="./"),n};oe.wrapOutput=(e,t={},n={})=>{let r=n.contains?"":"^",i=n.contains?"":"$",s=`${r}(?:${e})${i}`;return t.negated===!0&&(s=`(?:^(?!${s}).*$)`),s}});var Kr=Pe((Ld,Vr)=>{"use strict";var kr=_t(),{CHAR_ASTERISK:hn,CHAR_AT:fl,CHAR_BACKWARD_SLASH:et,CHAR_COMMA:ul,CHAR_DOT:fn,CHAR_EXCLAMATION_MARK:un,CHAR_FORWARD_SLASH:Hr,CHAR_LEFT_CURLY_BRACE:pn,CHAR_LEFT_PARENTHESES:dn,CHAR_LEFT_SQUARE_BRACKET:pl,CHAR_PLUS:dl,CHAR_QUESTION_MARK:zr,CHAR_RIGHT_CURLY_BRACE:ml,CHAR_RIGHT_PARENTHESES:Yr,CHAR_RIGHT_SQUARE_BRACKET:vl}=Je(),Gr=e=>e===Hr||e===et,$r=e=>{e.isPrefix!==!0&&(e.depth=e.isGlobstar?Infinity:1)},xl=(e,t)=>{let n=t||{},r=e.length-1,i=n.parts===!0||n.scanToEnd===!0,s=[],a=[],o=[],l=e,c=-1,h=0,f=0,u=!1,p=!1,d=!1,v=!1,m=!1,E=!1,C=!1,w=!1,S=!1,T=!1,g=0,N,A,M={value:"",depth:0,isGlob:!1},B=()=>c>=r,x=()=>l.charCodeAt(c+1),F=()=>(N=A,l.charCodeAt(++c));for(;c<r;){A=F();let j;if(A===et){C=M.backslashes=!0,A=F(),A===pn&&(E=!0);continue}if(E===!0||A===pn){for(g++;B()!==!0&&(A=F());){if(A===et){C=M.backslashes=!0,F();continue}if(A===pn){g++;continue}if(E!==!0&&A===fn&&(A=F())===fn){if(u=M.isBrace=!0,d=M.isGlob=!0,T=!0,i===!0)continue;break}if(E!==!0&&A===ul){if(u=M.isBrace=!0,d=M.isGlob=!0,T=!0,i===!0)continue;break}if(A===ml&&(g--,g===0)){E=!1,u=M.isBrace=!0,T=!0;break}}if(i===!0)continue;break}if(A===Hr){if(s.push(c),a.push(M),M={value:"",depth:0,isGlob:!1},T===!0)continue;if(N===fn&&c===h+1){h+=2;continue}f=c+1;continue}if(n.noext!==!0&&(A===dl||A===fl||A===hn||A===zr||A===un)===!0&&x()===dn){if(d=M.isGlob=!0,v=M.isExtglob=!0,T=!0,A===un&&c===h&&(S=!0),i===!0){for(;B()!==!0&&(A=F());){if(A===et){C=M.backslashes=!0,A=F();continue}if(A===Yr){d=M.isGlob=!0,T=!0;break}}continue}break}if(A===hn){if(N===hn&&(m=M.isGlobstar=!0),d=M.isGlob=!0,T=!0,i===!0)continue;break}if(A===zr){if(d=M.isGlob=!0,T=!0,i===!0)continue;break}if(A===pl){for(;B()!==!0&&(j=F());){if(j===et){C=M.backslashes=!0,F();continue}if(j===vl){p=M.isBracket=!0,d=M.isGlob=!0,T=!0;break}}if(i===!0)continue;break}if(n.nonegate!==!0&&A===un&&c===h){w=M.negated=!0,h++;continue}if(n.noparen!==!0&&A===dn){if(d=M.isGlob=!0,i===!0){for(;B()!==!0&&(A=F());){if(A===dn){C=M.backslashes=!0,A=F();continue}if(A===Yr){T=!0;break}}continue}break}if(d===!0){if(T=!0,i===!0)continue;break}}n.noext===!0&&(v=!1,d=!1);let D=l,P="",y="";h>0&&(P=l.slice(0,h),l=l.slice(h),f-=h),D&&d===!0&&f>0?(D=l.slice(0,f),y=l.slice(f)):d===!0?(D="",y=l):D=l,D&&D!==""&&D!=="/"&&D!==l&&Gr(D.charCodeAt(D.length-1))&&(D=D.slice(0,-1)),n.unescape===!0&&(y&&(y=kr.removeBackslashes(y)),D&&C===!0&&(D=kr.removeBackslashes(D)));let _={prefix:P,input:e,start:h,base:D,glob:y,isBrace:u,isBracket:p,isGlob:d,isExtglob:v,isGlobstar:m,negated:w,negatedExtglob:S};if(n.tokens===!0&&(_.maxDepth=0,Gr(A)||a.push(M),_.tokens=a),n.parts===!0||n.tokens===!0){let j;for(let z=0;z<s.length;z++){let J=j?j+1:h,ee=s[z],re=e.slice(J,ee);n.tokens&&(z===0&&h!==0?(a[z].isPrefix=!0,a[z].value=P):a[z].value=re,$r(a[z]),_.maxDepth+=a[z].depth),(z!==0||re!=="")&&o.push(re),j=ee}if(j&&j+1<e.length){let z=e.slice(j+1);o.push(z),n.tokens&&(a[a.length-1].value=z,$r(a[a.length-1]),_.maxDepth+=a[a.length-1].depth)}_.slashes=s,_.parts=o}return _};Vr.exports=xl});var qr=Pe((Nd,jr)=>{"use strict";var Et=Je(),fe=_t(),{MAX_LENGTH:At,POSIX_REGEX_SOURCE:gl,REGEX_NON_SPECIAL_CHARS:yl,REGEX_SPECIAL_CHARS_BACKREF:_l,REPLACEMENTS:Wr}=Et,El=(e,t)=>{if(typeof t.expandRange=="function")return t.expandRange(...e,t);e.sort();let n=`[${e.join("-")}]`;try{new RegExp(n)}catch(r){return e.map(i=>fe.escapeRegex(i)).join("..")}return n},Ge=(e,t)=>`Missing ${e}: "${t}" - use "\\\\${t}" to match literal characters`,mn=(e,t)=>{if(typeof e!="string")throw new TypeError("Expected a string");e=Wr[e]||e;let n={...t},r=typeof n.maxLength=="number"?Math.min(At,n.maxLength):At,i=e.length;if(i>r)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${r}`);let s={type:"bos",value:"",output:n.prepend||""},a=[s],o=n.capture?"":"?:",l=fe.isWindows(t),c=Et.globChars(l),h=Et.extglobChars(c),{DOT_LITERAL:f,PLUS_LITERAL:u,SLASH_LITERAL:p,ONE_CHAR:d,DOTS_SLASH:v,NO_DOT:m,NO_DOT_SLASH:E,NO_DOTS_SLASH:C,QMARK:w,QMARK_NO_DOT:S,STAR:T,START_ANCHOR:g}=c,N=L=>`(${o}(?:(?!${g}${L.dot?v:f}).)*?)`,A=n.dot?"":m,M=n.dot?w:S,B=n.bash===!0?N(n):T;n.capture&&(B=`(${B})`),typeof n.noext=="boolean"&&(n.noextglob=n.noext);let x={input:e,index:-1,start:0,dot:n.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:a};e=fe.removePrefix(e,x),i=e.length;let F=[],D=[],P=[],y=s,_,j=()=>x.index===i-1,z=x.peek=(L=1)=>e[x.index+L],J=x.advance=()=>e[++x.index]||"",ee=()=>e.slice(x.index+1),re=(L="",K=0)=>{x.consumed+=L,x.index+=K},ge=L=>{x.output+=L.output!=null?L.output:L.value,re(L.value)},qe=()=>{let L=1;for(;z()==="!"&&(z(2)!=="("||z(3)==="?");)J(),x.start++,L++;return L%2==0?!1:(x.negated=!0,x.start++,!0)},Le=L=>{x[L]++,P.push(L)},ye=L=>{x[L]--,P.pop()},k=L=>{if(y.type==="globstar"){let K=x.braces>0&&(L.type==="comma"||L.type==="brace"),b=L.extglob===!0||F.length&&(L.type==="pipe"||L.type==="paren");L.type!=="slash"&&L.type!=="paren"&&!K&&!b&&(x.output=x.output.slice(0,-y.output.length),y.type="star",y.value="*",y.output=B,x.output+=y.output)}if(F.length&&L.type!=="paren"&&(F[F.length-1].inner+=L.value),(L.value||L.output)&&ge(L),y&&y.type==="text"&&L.type==="text"){y.value+=L.value,y.output=(y.output||"")+L.value;return}L.prev=y,a.push(L),y=L},Be=(L,K)=>{let b={...h[K],conditions:1,inner:""};b.prev=y,b.parens=x.parens,b.output=x.output;let H=(n.capture?"(":"")+b.open;Le("parens"),k({type:L,value:K,output:x.output?"":d}),k({type:"paren",extglob:!0,value:J(),output:H}),F.push(b)},ht=L=>{let K=L.close+(n.capture?")":""),b;if(L.type==="negate"){let H=B;if(L.inner&&L.inner.length>1&&L.inner.includes("/")&&(H=N(n)),(H!==B||j()||/^\)+$/.test(ee()))&&(K=L.close=`)$))${H}`),L.inner.includes("*")&&(b=ee())&&/^\.[^\\/.]+$/.test(b)){let q=mn(b,{...t,fastpaths:!1}).output;K=L.close=`)${q})${H})`}L.prev.type==="bos"&&(x.negatedExtglob=!0)}k({type:"paren",extglob:!0,value:_,output:K}),ye("parens")};if(n.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(e)){let L=!1,K=e.replace(_l,(b,H,q,se,Z,Vt)=>se==="\\"?(L=!0,b):se==="?"?H?H+se+(Z?w.repeat(Z.length):""):Vt===0?M+(Z?w.repeat(Z.length):""):w.repeat(q.length):se==="."?f.repeat(q.length):se==="*"?H?H+se+(Z?B:""):B:H?b:`\\${b}`);return L===!0&&(n.unescape===!0?K=K.replace(/\\/g,""):K=K.replace(/\\+/g,b=>b.length%2==0?"\\\\":b?"\\":"")),K===e&&n.contains===!0?(x.output=e,x):(x.output=fe.wrapOutput(K,x,t),x)}for(;!j();){if(_=J(),_==="\0")continue;if(_==="\\"){let b=z();if(b==="/"&&n.bash!==!0||b==="."||b===";")continue;if(!b){_+="\\",k({type:"text",value:_});continue}let H=/^\\+/.exec(ee()),q=0;if(H&&H[0].length>2&&(q=H[0].length,x.index+=q,q%2!=0&&(_+="\\")),n.unescape===!0?_=J():_+=J(),x.brackets===0){k({type:"text",value:_});continue}}if(x.brackets>0&&(_!=="]"||y.value==="["||y.value==="[^")){if(n.posix!==!1&&_===":"){let b=y.value.slice(1);if(b.includes("[")&&(y.posix=!0,b.includes(":"))){let H=y.value.lastIndexOf("["),q=y.value.slice(0,H),se=y.value.slice(H+2),Z=gl[se];if(Z){y.value=q+Z,x.backtrack=!0,J(),!s.output&&a.indexOf(y)===1&&(s.output=d);continue}}}(_==="["&&z()!==":"||_==="-"&&z()==="]")&&(_=`\\${_}`),_==="]"&&(y.value==="["||y.value==="[^")&&(_=`\\${_}`),n.posix===!0&&_==="!"&&y.value==="["&&(_="^"),y.value+=_,ge({value:_});continue}if(x.quotes===1&&_!=='"'){_=fe.escapeRegex(_),y.value+=_,ge({value:_});continue}if(_==='"'){x.quotes=x.quotes===1?0:1,n.keepQuotes===!0&&k({type:"text",value:_});continue}if(_==="("){Le("parens"),k({type:"paren",value:_});continue}if(_===")"){if(x.parens===0&&n.strictBrackets===!0)throw new SyntaxError(Ge("opening","("));let b=F[F.length-1];if(b&&x.parens===b.parens+1){ht(F.pop());continue}k({type:"paren",value:_,output:x.parens?")":"\\)"}),ye("parens");continue}if(_==="["){if(n.nobracket===!0||!ee().includes("]")){if(n.nobracket!==!0&&n.strictBrackets===!0)throw new SyntaxError(Ge("closing","]"));_=`\\${_}`}else Le("brackets");k({type:"bracket",value:_});continue}if(_==="]"){if(n.nobracket===!0||y&&y.type==="bracket"&&y.value.length===1){k({type:"text",value:_,output:`\\${_}`});continue}if(x.brackets===0){if(n.strictBrackets===!0)throw new SyntaxError(Ge("opening","["));k({type:"text",value:_,output:`\\${_}`});continue}ye("brackets");let b=y.value.slice(1);if(y.posix!==!0&&b[0]==="^"&&!b.includes("/")&&(_=`/${_}`),y.value+=_,ge({value:_}),n.literalBrackets===!1||fe.hasRegexChars(b))continue;let H=fe.escapeRegex(y.value);if(x.output=x.output.slice(0,-y.value.length),n.literalBrackets===!0){x.output+=H,y.value=H;continue}y.value=`(${o}${H}|${y.value})`,x.output+=y.value;continue}if(_==="{"&&n.nobrace!==!0){Le("braces");let b={type:"brace",value:_,output:"(",outputIndex:x.output.length,tokensIndex:x.tokens.length};D.push(b),k(b);continue}if(_==="}"){let b=D[D.length-1];if(n.nobrace===!0||!b){k({type:"text",value:_,output:_});continue}let H=")";if(b.dots===!0){let q=a.slice(),se=[];for(let Z=q.length-1;Z>=0&&(a.pop(),q[Z].type!=="brace");Z--)q[Z].type!=="dots"&&se.unshift(q[Z].value);H=El(se,n),x.backtrack=!0}if(b.comma!==!0&&b.dots!==!0){let q=x.output.slice(0,b.outputIndex),se=x.tokens.slice(b.tokensIndex);b.value=b.output="\\{",_=H="\\}",x.output=q;for(let Z of se)x.output+=Z.output||Z.value}k({type:"brace",value:_,output:H}),ye("braces"),D.pop();continue}if(_==="|"){F.length>0&&F[F.length-1].conditions++,k({type:"text",value:_});continue}if(_===","){let b=_,H=D[D.length-1];H&&P[P.length-1]==="braces"&&(H.comma=!0,b="|"),k({type:"comma",value:_,output:b});continue}if(_==="/"){if(y.type==="dot"&&x.index===x.start+1){x.start=x.index+1,x.consumed="",x.output="",a.pop(),y=s;continue}k({type:"slash",value:_,output:p});continue}if(_==="."){if(x.braces>0&&y.type==="dot"){y.value==="."&&(y.output=f);let b=D[D.length-1];y.type="dots",y.output+=_,y.value+=_,b.dots=!0;continue}if(x.braces+x.parens===0&&y.type!=="bos"&&y.type!=="slash"){k({type:"text",value:_,output:f});continue}k({type:"dot",value:_,output:f});continue}if(_==="?"){if(!(y&&y.value==="(")&&n.noextglob!==!0&&z()==="("&&z(2)!=="?"){Be("qmark",_);continue}if(y&&y.type==="paren"){let H=z(),q=_;if(H==="<"&&!fe.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(y.value==="("&&!/[!=<:]/.test(H)||H==="<"&&!/<([!=]|\w+>)/.test(ee()))&&(q=`\\${_}`),k({type:"text",value:_,output:q});continue}if(n.dot!==!0&&(y.type==="slash"||y.type==="bos")){k({type:"qmark",value:_,output:S});continue}k({type:"qmark",value:_,output:w});continue}if(_==="!"){if(n.noextglob!==!0&&z()==="("&&(z(2)!=="?"||!/[!=<:]/.test(z(3)))){Be("negate",_);continue}if(n.nonegate!==!0&&x.index===0){qe();continue}}if(_==="+"){if(n.noextglob!==!0&&z()==="("&&z(2)!=="?"){Be("plus",_);continue}if(y&&y.value==="("||n.regex===!1){k({type:"plus",value:_,output:u});continue}if(y&&(y.type==="bracket"||y.type==="paren"||y.type==="brace")||x.parens>0){k({type:"plus",value:_});continue}k({type:"plus",value:u});continue}if(_==="@"){if(n.noextglob!==!0&&z()==="("&&z(2)!=="?"){k({type:"at",extglob:!0,value:_,output:""});continue}k({type:"text",value:_});continue}if(_!=="*"){(_==="$"||_==="^")&&(_=`\\${_}`);let b=yl.exec(ee());b&&(_+=b[0],x.index+=b[0].length),k({type:"text",value:_});continue}if(y&&(y.type==="globstar"||y.star===!0)){y.type="star",y.star=!0,y.value+=_,y.output=B,x.backtrack=!0,x.globstar=!0,re(_);continue}let L=ee();if(n.noextglob!==!0&&/^\([^?]/.test(L)){Be("star",_);continue}if(y.type==="star"){if(n.noglobstar===!0){re(_);continue}let b=y.prev,H=b.prev,q=b.type==="slash"||b.type==="bos",se=H&&(H.type==="star"||H.type==="globstar");if(n.bash===!0&&(!q||L[0]&&L[0]!=="/")){k({type:"star",value:_,output:""});continue}let Z=x.braces>0&&(b.type==="comma"||b.type==="brace"),Vt=F.length&&(b.type==="pipe"||b.type==="paren");if(!q&&b.type!=="paren"&&!Z&&!Vt){k({type:"star",value:_,output:""});continue}for(;L.slice(0,3)==="/**";){let ft=e[x.index+4];if(ft&&ft!=="/")break;L=L.slice(3),re("/**",3)}if(b.type==="bos"&&j()){y.type="globstar",y.value+=_,y.output=N(n),x.output=y.output,x.globstar=!0,re(_);continue}if(b.type==="slash"&&b.prev.type!=="bos"&&!se&&j()){x.output=x.output.slice(0,-(b.output+y.output).length),b.output=`(?:${b.output}`,y.type="globstar",y.output=N(n)+(n.strictSlashes?")":"|$)"),y.value+=_,x.globstar=!0,x.output+=b.output+y.output,re(_);continue}if(b.type==="slash"&&b.prev.type!=="bos"&&L[0]==="/"){let ft=L[1]!==void 0?"|$":"";x.output=x.output.slice(0,-(b.output+y.output).length),b.output=`(?:${b.output}`,y.type="globstar",y.output=`${N(n)}${p}|${p}${ft})`,y.value+=_,x.output+=b.output+y.output,x.globstar=!0,re(_+J()),k({type:"slash",value:"/",output:""});continue}if(b.type==="bos"&&L[0]==="/"){y.type="globstar",y.value+=_,y.output=`(?:^|${p}|${N(n)}${p})`,x.output=y.output,x.globstar=!0,re(_+J()),k({type:"slash",value:"/",output:""});continue}x.output=x.output.slice(0,-y.output.length),y.type="globstar",y.output=N(n),y.value+=_,x.output+=y.output,x.globstar=!0,re(_);continue}let K={type:"star",value:_,output:B};if(n.bash===!0){K.output=".*?",(y.type==="bos"||y.type==="slash")&&(K.output=A+K.output),k(K);continue}if(y&&(y.type==="bracket"||y.type==="paren")&&n.regex===!0){K.output=_,k(K);continue}(x.index===x.start||y.type==="slash"||y.type==="dot")&&(y.type==="dot"?(x.output+=E,y.output+=E):n.dot===!0?(x.output+=C,y.output+=C):(x.output+=A,y.output+=A),z()!=="*"&&(x.output+=d,y.output+=d)),k(K)}for(;x.brackets>0;){if(n.strictBrackets===!0)throw new SyntaxError(Ge("closing","]"));x.output=fe.escapeLast(x.output,"["),ye("brackets")}for(;x.parens>0;){if(n.strictBrackets===!0)throw new SyntaxError(Ge("closing",")"));x.output=fe.escapeLast(x.output,"("),ye("parens")}for(;x.braces>0;){if(n.strictBrackets===!0)throw new SyntaxError(Ge("closing","}"));x.output=fe.escapeLast(x.output,"{"),ye("braces")}if(n.strictSlashes!==!0&&(y.type==="star"||y.type==="bracket")&&k({type:"maybe_slash",value:"",output:`${p}?`}),x.backtrack===!0){x.output="";for(let L of x.tokens)x.output+=L.output!=null?L.output:L.value,L.suffix&&(x.output+=L.suffix)}return x};mn.fastpaths=(e,t)=>{let n={...t},r=typeof n.maxLength=="number"?Math.min(At,n.maxLength):At,i=e.length;if(i>r)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${r}`);e=Wr[e]||e;let s=fe.isWindows(t),{DOT_LITERAL:a,SLASH_LITERAL:o,ONE_CHAR:l,DOTS_SLASH:c,NO_DOT:h,NO_DOTS:f,NO_DOTS_SLASH:u,STAR:p,START_ANCHOR:d}=Et.globChars(s),v=n.dot?f:h,m=n.dot?u:h,E=n.capture?"":"?:",C={negated:!1,prefix:""},w=n.bash===!0?".*?":p;n.capture&&(w=`(${w})`);let S=A=>A.noglobstar===!0?w:`(${E}(?:(?!${d}${A.dot?c:a}).)*?)`,T=A=>{switch(A){case"*":return`${v}${l}${w}`;case".*":return`${a}${l}${w}`;case"*.*":return`${v}${w}${a}${l}${w}`;case"*/*":return`${v}${w}${o}${l}${m}${w}`;case"**":return v+S(n);case"**/*":return`(?:${v}${S(n)}${o})?${m}${l}${w}`;case"**/*.*":return`(?:${v}${S(n)}${o})?${m}${w}${a}${l}${w}`;case"**/.*":return`(?:${v}${S(n)}${o})?${a}${l}${w}`;default:{let M=/^(.*?)\.(\w+)$/.exec(A);if(!M)return;let B=T(M[1]);return B?B+a+M[2]:void 0}}},g=fe.removePrefix(e,C),N=T(g);return N&&n.strictSlashes!==!0&&(N+=`${o}?`),N};jr.exports=mn});var Qr=Pe((Od,Xr)=>{"use strict";var Al=gt(),wl=Kr(),vn=qr(),xn=_t(),bl=Je(),Tl=e=>e&&typeof e=="object"&&!Array.isArray(e),Q=(e,t,n=!1)=>{if(Array.isArray(e)){let h=e.map(u=>Q(u,t,n));return u=>{for(let p of h){let d=p(u);if(d)return d}return!1}}let r=Tl(e)&&e.tokens&&e.input;if(e===""||typeof e!="string"&&!r)throw new TypeError("Expected pattern to be a non-empty string");let i=t||{},s=xn.isWindows(t),a=r?Q.compileRe(e,t):Q.makeRe(e,t,!1,!0),o=a.state;delete a.state;let l=()=>!1;if(i.ignore){let h={...t,ignore:null,onMatch:null,onResult:null};l=Q(i.ignore,h,n)}let c=(h,f=!1)=>{let{isMatch:u,match:p,output:d}=Q.test(h,a,t,{glob:e,posix:s}),v={glob:e,state:o,regex:a,posix:s,input:h,output:d,match:p,isMatch:u};return typeof i.onResult=="function"&&i.onResult(v),u===!1?(v.isMatch=!1,f?v:!1):l(h)?(typeof i.onIgnore=="function"&&i.onIgnore(v),v.isMatch=!1,f?v:!1):(typeof i.onMatch=="function"&&i.onMatch(v),f?v:!0)};return n&&(c.state=o),c};Q.test=(e,t,n,{glob:r,posix:i}={})=>{if(typeof e!="string")throw new TypeError("Expected input to be a string");if(e==="")return{isMatch:!1,output:""};let s=n||{},a=s.format||(i?xn.toPosixSlashes:null),o=e===r,l=o&&a?a(e):e;return o===!1&&(l=a?a(e):e,o=l===r),(o===!1||s.capture===!0)&&(s.matchBase===!0||s.basename===!0?o=Q.matchBase(e,t,n,i):o=t.exec(l)),{isMatch:Boolean(o),match:o,output:l}};Q.matchBase=(e,t,n,r=xn.isWindows(n))=>(t instanceof RegExp?t:Q.makeRe(t,n)).test(Al.basename(e));Q.isMatch=(e,t,n)=>Q(t,n)(e);Q.parse=(e,t)=>Array.isArray(e)?e.map(n=>Q.parse(n,t)):vn(e,{...t,fastpaths:!1});Q.scan=(e,t)=>wl(e,t);Q.compileRe=(e,t,n=!1,r=!1)=>{if(n===!0)return e.output;let i=t||{},s=i.contains?"":"^",a=i.contains?"":"$",o=`${s}(?:${e.output})${a}`;e&&e.negated===!0&&(o=`^(?!${o}).*$`);let l=Q.toRegex(o,t);return r===!0&&(l.state=e),l};Q.makeRe=(e,t={},n=!1,r=!1)=>{if(!e||typeof e!="string")throw new TypeError("Expected a non-empty string");let i={negated:!1,fastpaths:!0};return t.fastpaths!==!1&&(e[0]==="."||e[0]==="*")&&(i.output=vn.fastpaths(e,t)),i.output||(i=vn(e,t)),Q.compileRe(i,t,n,r)};Q.toRegex=(e,t)=>{try{let n=t||{};return new RegExp(e,n.flags||(n.nocase?"i":""))}catch(n){if(t&&t.debug===!0)throw n;return/$^/}};Q.constants=bl;Xr.exports=Q});var Jr=Pe((Bd,Zr)=>{"use strict";Zr.exports=Qr()});var pa=`
<div class="container">
  <label class="hidden" id="title">display-port</label>
  <label class="hidden" id="fps">00</label>
  <label class="hidden" id="dimension">0x0</label>
  <div class="content">
    <slot id="inner">
      <canvas>
        Oh no! Your browser does not support canvas.
      </canvas>
    </slot>
    <slot name="overlay"></slot>
  </div>
  <slot name="frame"></slot>
</div>`,da=`
:host {
  display: inline-block;
  color: #555555;
}

.container {
  display: flex;
  position: relative;
  width: 100%;
  height: 100%;
}

.content {
  position: relative;
  margin: auto;
  overflow: hidden;
}

.content > *:not(canvas) {
  width: 100%;
  height: 100%;
}

canvas {
  background: #000000;
  image-rendering: pixelated;
}

label {
  position: absolute;
  font-family: monospace;
  color: currentColor;
}

#inner {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: 0;
  left: 0;
  pointer-events: none;
}

#title {
  left: 0.5rem;
  top: 0.5rem;
}

#fps {
  right: 0.5rem;
  top: 0.5rem;
}

#dimension {
  left: 0.5rem;
  bottom: 0.5rem;
}

.hidden {
  display: none;
}

:host([debug]) .container {
  outline: 6px dashed rgba(0, 0, 0, 0.1);
  outline-offset: -4px;
  background-color: rgba(0, 0, 0, 0.1);
}

:host([mode='noscale']) canvas {
  margin: 0;
  top: 0;
  left: 0;
}

:host([mode='stretch']) canvas,
:host([mode='scale']) canvas {
  width: 100%;
  height: 100%;
}

:host([mode='fit']),
:host([mode='scale']),
:host([mode='center']),
:host([mode='stretch']),
:host([mode='fill']) {
  width: 100%;
  height: 100%;
}

:host([full]) {
  width: 100vw !important;
  height: 100vh !important;
}

:host([disabled]) {
  display: none;
}

slot {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  pointer-events: none;
}

::slotted(*) {
  pointer-events: auto;
}`,sr="noscale";var Kt="fit",ar="scale",or="fill",lr="stretch",cr=300,hr=150,fr=Kt,ma=200,Xe=class extends HTMLElement{static create(t={}){let{root:n=document.body,id:r=void 0,mode:i=fr,width:s=cr,height:a=hr,debug:o=!1}=t||{},l=new Xe;return l.id=r,l.mode=i,l.width=s,l.height=a,l.debug=o,n.appendChild(l),l}static define(t=window.customElements){t.define("display-port",this)}static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=pa,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=da,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static get observedAttributes(){return["debug","disabled","width","height","onframe","id","class"]}get mode(){return this.getAttribute("mode")}set mode(t){this.setAttribute("mode",t)}get debug(){return this._debug}set debug(t){this.toggleAttribute("debug",t)}get disabled(){return this._disabled}set disabled(t){this.toggleAttribute("disabled",t)}get width(){return this._width}set width(t){this.setAttribute("width",String(t))}get height(){return this._height}set height(t){this.setAttribute("height",String(t))}get onframe(){return this._onframe}set onframe(t){this._onframe&&this.removeEventListener("frame",this._onframe),this._onframe=t,this._onframe&&this.addEventListener("frame",t)}constructor(){super();let t=this.attachShadow({mode:"open"});t.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),t.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._canvasElement=null,this._contentElement=t.querySelector(".content"),this._innerElement=t.querySelector("#inner"),this._titleElement=t.querySelector("#title"),this._fpsElement=t.querySelector("#fps"),this._dimensionElement=t.querySelector("#dimension"),this._debug=!1,this._disabled=!1,this._width=cr,this._height=hr,this._onframe=void 0,this._animationRequestHandle=0,this._prevAnimationFrameTime=0,this._resizeTimeoutHandle=0,this._resizeCanvasWidth=0,this._resizeCanvasHeight=0,this._frameEvent=new CustomEvent("frame",{composed:!0,bubbles:!1,detail:{now:0,prevTime:0,deltaTime:0,canvas:this._canvasElement}}),this._resizeEvent=new CustomEvent("resize",{composed:!0,bubbles:!1,detail:{width:0,height:0}}),this.update=this.update.bind(this),this.onDelayCanvasResize=this.onDelayCanvasResize.bind(this),this.onSlotChange=this.onSlotChange.bind(this)}get canvas(){return this._canvasElement}connectedCallback(){Ye(this,"mode"),Ye(this,"debug"),Ye(this,"disabled"),Ye(this,"width"),Ye(this,"height"),Ye(this,"onframe"),this.hasAttribute("mode")||this.setAttribute("mode",fr),this.hasAttribute("tabindex")||this.setAttribute("tabindex","0"),this._innerElement.addEventListener("slotchange",this.onSlotChange),this._canvasElement=this._innerElement.querySelector("canvas"),this._canvasElement&&(this.updateCanvasSize(!0),this.resume())}disconnectedCallback(){this._innerElement.removeEventListener("slotchange",this.onSlotChange),this.pause()}attributeChangedCallback(t,n,r){switch(t){case"debug":this._debug=r!==null;break;case"disabled":this._disabled=r!==null;break;case"width":this._width=Number(r);break;case"height":this._height=Number(r);break;case"onframe":this.onframe=new Function("event","with(document){with(this){"+r+"}}").bind(this);break}switch(t){case"disabled":r?(this.update(0),this.pause()):this.resume();break;case"id":case"class":this._titleElement.innerHTML=`display-port${this.className?"."+this.className:""}${this.hasAttribute("id")?"#"+this.getAttribute("id"):""}`;break;case"debug":this._titleElement.classList.toggle("hidden",r),this._fpsElement.classList.toggle("hidden",r),this._dimensionElement.classList.toggle("hidden",r);break}}onSlotChange(t){let i=t.target.assignedElements({flatten:!0}).find(s=>s instanceof HTMLCanvasElement);if(!i)throw new Error("No valid canvas element found for display.");this._canvasElement=i,this.updateCanvasSize(!0),this.resume()}getContext(t="2d",n=void 0){return this._canvasElement.getContext(t,n)}pause(){window.cancelAnimationFrame(this._animationRequestHandle)}resume(){this._animationRequestHandle=window.requestAnimationFrame(this.update)}update(t){this._animationRequestHandle=window.requestAnimationFrame(this.update),this.updateCanvasSize(!1);let n=t-this._prevAnimationFrameTime;if(this._prevAnimationFrameTime=t,this._debug){let s=n<=0?"--":String(Math.round(1e3/n)).padStart(2,"0");if(this._fpsElement.textContent!==s&&(this._fpsElement.textContent=s),this.mode===sr){let o=`${this._width}x${this._height}`;this._dimensionElement.textContent!==o&&(this._dimensionElement.textContent=o)}else{let o=`${this._width}x${this._height}|${this.shadowRoot.host.clientWidth}x${this.shadowRoot.host.clientHeight}`;this._dimensionElement.textContent!==o&&(this._dimensionElement.textContent=o)}}let i=this._frameEvent.detail;i.now=t,i.prevTime=this._prevAnimationFrameTime,i.deltaTime=n,this.dispatchEvent(this._frameEvent)}onDelayCanvasResize(){this._resizeTimeoutHandle=null,this.updateCanvasSize(!0)}delayCanvasResize(t,n){(t!==this._resizeCanvasWidth||n!==this._resizeCanvasHeight)&&(this._resizeCanvasWidth=t,this._resizeCanvasHeight=n,this._resizeTimeoutHandle&&window.clearTimeout(this._resizeTimeoutHandle),this._resizeTimeoutHandle=window.setTimeout(this.onDelayCanvasResize,ma))}updateCanvasSize(t=!0){let n=this.shadowRoot.host.getBoundingClientRect(),r=n.width,i=n.height,s=this._canvasElement,a=this._width,o=this._height,l=this.mode;if(l===lr||l===or)a=r,o=i;else if(l!==sr&&(r<a||i<o||l===Kt||l==ar)){let h=r/a,f=i/o;h<f?(a=r,o=o*h):(a=a*f,o=i)}if(a=Math.floor(a),o=Math.floor(o),typeof t=="undefined"&&(t=s.clientWidth!==a||s.clientHeight!==o),!t){this.delayCanvasResize(a,o);return}let c=Math.min(a/this._width,o/this._height)*.5;if(this._innerElement.style.fontSize=`font-size: ${c}em`,t){l===ar?(s.width=this._width,s.height=this._height):l!==lr&&(s.width=a,s.height=o);let h=this._contentElement.style;h.width=`${a}px`,h.height=`${o}px`,(l===Kt||l===or)&&(this._width=a,this._height=o);let u=this._resizeEvent.detail;u.width=a,u.height=o,this.dispatchEvent(this._resizeEvent)}}};function Ye(e,t){if(Object.prototype.hasOwnProperty.call(e,t)){let n=e[t];delete e[t],e[t]=n}}var va=`<div class="container">
  <div class="padding"></div>
  <div class="innerContainer">
    <div class="padding"></div>
    <slot><canvas>Oh no! Your browser does not support canvas.</canvas></slot>
    <div class="padding"></div>
  </div>
  <div class="padding"></div>
</div>`,xa=`
:host {
  display: inline-block;
  flex: 1;
  --width: 300px;
  --height: 150px;
}
:host([scaling="noscale"]) {
  width: var(--width);
  height: var(--height);
}
:host([sizing="viewport"]) {
    position: fixed;
    top: 0;
    left: 0;
}
.container {
  position: relative;
  display: flex;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
.innerContainer {
  display: flex;
  flex-direction: column;
}
.padding {
  flex: 1;
}`,ur="scale",ga="conatiner",pr=300,dr=150,pt=class extends HTMLElement{static create(t={}){let{root:n=document.body,id:r=void 0,scaling:i=ur,sizing:s=ga,width:a=pr,height:o=dr}=t||{};window.customElements.get("flex-canvas")||window.customElements.define("flex-canvas",pt);let l=new pt;return l.id=r,l.scaling=i,l.sizing=s,l.width=a,l.height=o,n.appendChild(l),l}static define(t=window.customElements){t.define("flex-canvas",this)}static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=va,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=xa,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static get observedAttributes(){return["sizing","width","height","resize-delay"]}get scaling(){return this.getAttribute("scaling")}set scaling(t){this.setAttribute("scaling",t)}get sizing(){return this._sizing}set sizing(t){this.setAttribute("sizing",String(t))}get resizeDelay(){return this._resizeDelay}set resizeDelay(t){this.setAttribute("resize-delay",String(t))}get width(){return this._width}set width(t){this.setAttribute("width",String(t))}get height(){return this._height}set height(t){this.setAttribute("height",String(t))}get canvas(){return this.canvasElement}constructor(){super();let t=this.attachShadow({mode:"open"});t.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),t.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._sizing="none",this._width=pr,this._height=dr,this._resizeDelay=0,this.animationFrameHandle=0,this.resizeTimeoutHandle=0,this.resizeCanvasWidth=0,this.resizeCanvasHeight=0,this.canvasSlotElement=t.querySelector("slot"),this.canvasElement=null,this.onResize=this.onResize.bind(this),this.onAnimationFrame=this.onAnimationFrame.bind(this),this.onSlotChange=this.onSlotChange.bind(this)}connectedCallback(){Qe(this,"scaling"),Qe(this,"sizing"),Qe(this,"width"),Qe(this,"height"),Qe(this,"resize-delay"),this.hasAttribute("scaling")||this.setAttribute("scaling",ur),this.hasAttribute("tabindex")||this.setAttribute("tabindex","0"),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.canvasSlotElement.addEventListener("slotchange",this.onSlotChange),this.canvasElement||this.setCanvasElement(this.canvasSlotElement.querySelector("canvas"))}disconnectedCallback(){cancelAnimationFrame(this.animationFrameHandle),this.animationFrameHandle=null,this.canvasSlotElement.removeEventListener("slotchange",this.onSlotChange)}attributeChangedCallback(t,n,r){switch(t){case"sizing":switch(this._sizing=String(r),this._sizing){case"none":this.style.removeProperty("width"),this.style.removeProperty("height");break;case"container":this.style.setProperty("width","100%"),this.style.setProperty("height","100%");break;case"viewport":this.style.setProperty("width","100vw"),this.style.setProperty("height","100vh");break;default:let[i,s]=this._sizing.split(" ");i&&s&&(this.style.setProperty("width",i),this.style.setProperty("height",s));break}break;case"width":this._width=Number(r),this.canvasElement&&(this.canvasElement.width=this._width);break;case"height":this._height=Number(r),this.canvasElement&&(this.canvasElement.height=this._height);break;case"resize-delay":this._resizeDelay=Number(r);break}}onAnimationFrame(t){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),!(this.clientWidth===this.resizeCanvasWidth&&this.clientHeight===this.resizeCanvasHeight)&&(this.resizeCanvasWidth=this.clientWidth,this.resizeCanvasHeight=this.clientHeight,this._resizeDelay>0?this.resizeTimeoutHandle||(this.resizeTimeoutHandle=window.setTimeout(this.onResize,this._resizeDelay)):this.onResize())}onResize(){window.clearTimeout(this.resizeTimeoutHandle),this.resizeTimeoutHandle=null;let t=this.canvasElement;if(!t)return;let n=this.scaling,r=this.getBoundingClientRect(),i=r.width,s=r.height,a=this._width,o=this._height,l=i/a,c=s/o;n==="noscale"&&(this.style.setProperty("--width",`${a}px`),this.style.setProperty("--height",`${o}px`)),n==="scale"&&(l<c?(t.style.setProperty("width",`${Math.floor(i)}px`),t.style.setProperty("height",`${Math.floor(o*l)}px`)):(t.style.setProperty("width",`${Math.floor(a*c)}px`),t.style.setProperty("height",`${Math.floor(s)}px`))),n==="stretch"&&(t.style.setProperty("width",`${Math.floor(i)}px`),t.style.setProperty("height",`${Math.floor(s)}px`)),n==="fit"&&(l<c?(a=Math.floor(i),o=Math.floor(o*l),t.style.setProperty("width",`${a}px`),t.style.setProperty("height",`${o}px`)):(a=Math.floor(a*c),o=Math.floor(s),t.style.setProperty("width",`${a}px`),t.style.setProperty("height",`${o}px`)),t.width!==a&&(t.width=a),t.height!==o&&(t.height=o)),n==="fill"&&(l<c?(a=Math.floor(i),o=Math.floor(s),t.style.setProperty("width",`${a}px`),t.style.setProperty("height",`${o}px`)):(a=Math.floor(i),o=Math.floor(s),t.style.setProperty("width",`${a}px`),t.style.setProperty("height",`${o}px`)),t.width!==a&&(t.width=a),t.height!==o&&(t.height=o))}onSlotChange(t){let i=t.target.assignedElements({flatten:!0}).find(s=>s instanceof HTMLCanvasElement);i&&this.setCanvasElement(i)}setCanvasElement(t){t.width=this._width,t.height=this._height,t.style.imageRendering="pixelated",this.canvasElement=t}getContext(t="2d",n=void 0){return this.canvasElement.getContext(t,n)}};function Qe(e,t){if(Object.prototype.hasOwnProperty.call(e,t)){let n=e[t];delete e[t],e[t]=n}}var Wt=class{get polling(){return performance.now()-this._lastPollingTime<1e3}get value(){return 0}get size(){return this._size}constructor(t){this._size=t,this._lastPollingTime=Number.MIN_SAFE_INTEGER}resize(t){this._size=t}getState(t){throw new Error("Missing implementation.")}onUpdate(t,n,r){throw new Error("Missing implementation.")}onStatus(t,n){throw new Error("Missing implementation.")}onPoll(t){this._lastPollingTime=t}onBind(t,n=void 0){t>=this._size&&this.resize(t+1)}onUnbind(){this.resize(0)}},Ze=class extends Wt{static createAxisBindingState(){return{value:0,delta:0,inverted:!1}}get delta(){return this._delta}get value(){return this._value}constructor(t=0){super(t);let n=new Array,r=this.constructor;for(let i=0;i<t;++i)n.push(r.createAxisBindingState());this._state=n,this._value=0,this._delta=0}resize(t){let n=this._state,r=n.length,i;if(t<=r)i=n.slice(0,t);else{i=n;let s=this.constructor;for(let a=r;a<t;++a)i.push(s.createAxisBindingState())}this._state=i,super.resize(t)}getState(t){return this._state[t].value}onPoll(t){let n=this._state,r=0,i=0,s=n.length;for(let a=0;a<s;++a){let o=n[a];r+=o.value*(o.inverted?-1:1),i+=o.delta,n[a].delta=0}this._value=r,this._delta=i,super.onPoll(t)}onUpdate(t,n,r){typeof n=="undefined"?this.onAxisChange(t,r):this.onAxisMove(t,n,r)}onStatus(t,n){this.onAxisStatus(t,n)}onBind(t,n=void 0){super.onBind(t,n);let{inverted:r=!1}=n||{},i=this._state;i[t].inverted=r}onAxisMove(t,n,r){let i=this._state[t];i.value=n,i.delta+=r}onAxisChange(t,n){let r=this._state[t];r.value+=n,r.delta+=n}onAxisStatus(t,n){let r=this._state[t],i=r.value;r.value=n,r.delta=n-i}},ya=241,mr=254,_a=239,De=1,jt=2,qt=4,Xt=8,Qt=16,dt=class extends Wt{get pressed(){return this._pressed}get repeated(){return this._repeated}get released(){return this._released}get down(){return this._down}get value(){return this._value}constructor(t=0){super(t);this._state=new Uint8Array(t),this._value=0,this._down=!1,this._pressed=!1,this._repeated=!1,this._released=!1}resize(t){let n=this._state,r=n.length,i;t<=r?i=n.slice(0,t):(i=new Uint8Array(t),i.set(n)),this._state=i,super.resize(t)}getState(t){let n=this._state[t],r=n&Qt?-1:1;return(n&De?1:0)*r}onPoll(t){let n=this._state,r=0,i=0,s=0,a=0,o=0,l=n.length;for(let c=0;c<l;++c){let h=n[c],f=h&De,u=h&Qt;i|=f,s|=h&jt,a|=h&qt,o|=h&Xt,r+=(f?1:0)*(u?-1:1),n[c]&=ya}this._value=r,this._down=i!==0,this._pressed=s!==0,this._repeated=a!==0,this._released=o!==0,super.onPoll(t)}onUpdate(t,n,r){r>0?this.onButtonPressed(t):this.onButtonReleased(t)}onStatus(t,n){this.onButtonStatus(t,n!==0)}onBind(t,n={inverted:!1}){super.onBind(t,n);let{inverted:r=!1}=n,i=this._state;r?i[t]|=Qt:i[t]&=_a}onButtonPressed(t){let n=this._state,r=n[t];r&De||(r|=jt,r|=De),r|=qt,n[t]=r}onButtonReleased(t){let n=this._state,r=n[t];r&De&&(r|=Xt,r&=mr),n[t]=r}onButtonStatus(t,n){let r=this._state,i=r[t],s=Boolean(i&De);n?i|=De:i&=mr,s&&!n&&(i|=Xt),!s&&n&&(i|=jt,i|=qt),r[t]=i}},I=class{static parse(t){t=t.trim();let n=t.indexOf(".");if(n<0)throw new Error("Missing device separator for key code.");let r=t.substring(0,n);if(r.length<0)throw new Error("Missing device for key code.");let i=t.substring(n+1);if(i.length<0)throw new Error("Missing code for key code.");return new I(r,i)}constructor(t,n){this.device=t,this.code=n}toString(){return`${this.device}.${this.code}`}};function vr(e,t){return new I(e,t)}function Ea(e){return"device"in e&&"code"in e}var O="Keyboard",de="Mouse",Aa=new I(O,"KeyA"),wa=new I(O,"KeyB"),ba=new I(O,"KeyC"),Ta=new I(O,"KeyD"),Ma=new I(O,"KeyE"),Sa=new I(O,"KeyF"),Ra=new I(O,"KeyG"),Ia=new I(O,"KeyH"),Ca=new I(O,"KeyI"),La=new I(O,"KeyJ"),Na=new I(O,"KeyK"),Oa=new I(O,"KeyL"),Ba=new I(O,"KeyM"),Pa=new I(O,"KeyN"),Fa=new I(O,"KeyO"),Da=new I(O,"KeyP"),Ua=new I(O,"KeyQ"),ka=new I(O,"KeyR"),Ha=new I(O,"KeyS"),za=new I(O,"KeyT"),Ya=new I(O,"KeyU"),Ga=new I(O,"KeyV"),$a=new I(O,"KeyW"),Va=new I(O,"KeyX"),Ka=new I(O,"KeyY"),Wa=new I(O,"KeyZ"),ja=new I(O,"Digit0"),qa=new I(O,"Digit1"),Xa=new I(O,"Digit2"),Qa=new I(O,"Digit3"),Za=new I(O,"Digit4"),Ja=new I(O,"Digit5"),eo=new I(O,"Digit6"),to=new I(O,"Digit7"),no=new I(O,"Digit8"),ro=new I(O,"Digit9"),io=new I(O,"Minus"),so=new I(O,"Equal"),ao=new I(O,"BracketLeft"),oo=new I(O,"BracketRight"),lo=new I(O,"Semicolon"),co=new I(O,"Quote"),ho=new I(O,"Backquote"),fo=new I(O,"Backslash"),uo=new I(O,"Comma"),po=new I(O,"Period"),mo=new I(O,"Slash"),vo=new I(O,"Escape"),xo=new I(O,"Space"),go=new I(O,"CapsLock"),yo=new I(O,"Backspace"),_o=new I(O,"Delete"),Eo=new I(O,"Tab"),Ao=new I(O,"Enter"),wo=new I(O,"ArrowUp"),bo=new I(O,"ArrowDown"),To=new I(O,"ArrowLeft"),Mo=new I(O,"ArrowRight"),So=new I(de,"Button0"),Ro=new I(de,"Button1"),Io=new I(de,"Button2"),Co=new I(de,"Button3"),Lo=new I(de,"Button4"),No=new I(de,"PosX"),Oo=new I(de,"PosY"),Bo=new I(de,"WheelX"),Po=new I(de,"WheelY"),Fo=new I(de,"WheelZ"),Te=Object.freeze({__proto__:null,ARROW_DOWN:bo,ARROW_LEFT:To,ARROW_RIGHT:Mo,ARROW_UP:wo,BACKQUOTE:ho,BACKSLASH:fo,BACKSPACE:yo,BRACKET_LEFT:ao,BRACKET_RIGHT:oo,CAPS_LOCK:go,COMMA:uo,DELETE:_o,DIGIT_0:ja,DIGIT_1:qa,DIGIT_2:Xa,DIGIT_3:Qa,DIGIT_4:Za,DIGIT_5:Ja,DIGIT_6:eo,DIGIT_7:to,DIGIT_8:no,DIGIT_9:ro,ENTER:Ao,EQUAL:so,ESCAPE:vo,KEYBOARD:O,KEY_A:Aa,KEY_B:wa,KEY_C:ba,KEY_D:Ta,KEY_E:Ma,KEY_F:Sa,KEY_G:Ra,KEY_H:Ia,KEY_I:Ca,KEY_J:La,KEY_K:Na,KEY_L:Oa,KEY_M:Ba,KEY_N:Pa,KEY_O:Fa,KEY_P:Da,KEY_Q:Ua,KEY_R:ka,KEY_S:Ha,KEY_T:za,KEY_U:Ya,KEY_V:Ga,KEY_W:$a,KEY_X:Va,KEY_Y:Ka,KEY_Z:Wa,MINUS:io,MOUSE:de,MOUSE_BUTTON_0:So,MOUSE_BUTTON_1:Ro,MOUSE_BUTTON_2:Io,MOUSE_BUTTON_3:Co,MOUSE_BUTTON_4:Lo,MOUSE_POS_X:No,MOUSE_POS_Y:Oo,MOUSE_WHEEL_X:Bo,MOUSE_WHEEL_Y:Po,MOUSE_WHEEL_Z:Fo,PERIOD:po,QUOTE:co,SEMICOLON:lo,SLASH:mo,SPACE:xo,TAB:Eo,from:vr,isKeyCode:Ea}),xr=class{constructor(t){this.name=t,this.current=null}bindKeys(t){throw new Error("Unsupported operation.")}get(t){throw new Error("Unsupported operation.")}};function Do(e){Array.isArray(e)||(e=[e]);let t=[];for(let n of e){let r;try{r=I.parse(n)}catch(i){let s=Uo(n).toUpperCase();if(!(s in Te))throw new Error("Invalid key code string - "+i);r=Te[s]}t.push(r)}return t}function Uo(e){return e.replace(/([a-z]|(?:[A-Z0-9]+))([A-Z0-9]|$)/g,function(t,n,r){return n+(r&&"_"+r)}).toLowerCase()}var Me=class extends xr{static fromBind(t,n,r,i=void 0){return new Me(t,vr(n,r),i)}static fromString(t,...n){let r=Do(n);return new Me(t,r)}constructor(t,n,r=void 0){super(t);this.keyCodes=Array.isArray(n)?n:[n],this.opts=r,this.current=null}bindKeys(t){let n=this.name,r=this.opts;for(let i of this.keyCodes)t.bindButton(n,i.device,i.code,r);return this.current=t.getButton(n),this}get(t){let n=this.name;t.hasButton(n)||this.bindKeys(t);let r=t.getButton(n);return this.current=r,r}};var Zt=class{static isAxis(t){return!1}static isButton(t){return!1}constructor(t,n){if(!n)throw new Error(`Missing event target for device ${t}.`);this.name=t,this.eventTarget=n,this.listeners={input:[]}}setEventTarget(t){if(!t)throw new Error(`Missing event target for device ${this.name}.`);this.eventTarget=t}destroy(){let t=this.listeners;for(let n in t)t[n].length=0}addEventListener(t,n){let r=this.listeners;t in r?r[t].push(n):r[t]=[n]}removeEventListener(t,n){let r=this.listeners;if(t in r){let i=r[t],s=i.indexOf(n);s>=0&&i.splice(s,1)}}dispatchInputEvent(t){let n=0;for(let r of this.listeners.input)n|=r(t);return Boolean(n)}},gr=class extends Zt{static isAxis(t){return!1}static isButton(t){return!0}constructor(t,n,r={}){super(t,n);let{ignoreRepeat:i=!0}=r;this.ignoreRepeat=i,this._eventObject={target:n,device:t,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),n.addEventListener("keydown",this.onKeyDown),n.addEventListener("keyup",this.onKeyUp)}setEventTarget(t){this.eventTarget&&this.destroy(),super.setEventTarget(t),t.addEventListener("keydown",this.onKeyDown),t.addEventListener("keyup",this.onKeyUp)}destroy(){let t=this.eventTarget;t.removeEventListener("keydown",this.onKeyDown),t.removeEventListener("keyup",this.onKeyUp),super.destroy()}onKeyDown(t){if(t.repeat&&this.ignoreRepeat)return t.preventDefault(),t.stopPropagation(),!1;let n=this._eventObject;if(n.code=t.code,n.event="pressed",n.value=1,n.control=t.ctrlKey,n.shift=t.shiftKey,n.alt=t.altKey,this.dispatchInputEvent(n))return t.preventDefault(),t.stopPropagation(),!1}onKeyUp(t){let n=this._eventObject;if(n.code=t.code,n.event="released",n.value=1,n.control=t.ctrlKey,n.shift=t.shiftKey,n.alt=t.altKey,this.dispatchInputEvent(n))return t.preventDefault(),t.stopPropagation(),!1}},Jt=10,en=100,yr=class extends Zt{static isAxis(t){return t==="PosX"||t==="PosY"||t==="WheelX"||t==="WheelY"||t==="WheelZ"}static isButton(t){return!this.isAxis(t)}constructor(t,n,r={}){super(t,n);let{eventsOnFocus:i=!0}=r;this.eventsOnFocus=i,this.canvasTarget=this.getCanvasFromEventTarget(n),this._downHasFocus=!1,this._eventObject={target:n,device:t,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this._positionObject={target:n,device:t,code:"",event:"move",value:0,movement:0},this._wheelObject={target:n,device:t,code:"",event:"wheel",movement:0},this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onWheel=this.onWheel.bind(this),n.addEventListener("mousedown",this.onMouseDown),n.addEventListener("contextmenu",this.onContextMenu),n.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}setEventTarget(t){this.eventTarget&&this.destroy(),super.setEventTarget(t),this.canvasTarget=this.getCanvasFromEventTarget(t),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("contextmenu",this.onContextMenu),t.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}destroy(){let t=this.eventTarget;t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("contextmenu",this.onContextMenu),t.removeEventListener("wheel",this.onWheel),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),super.destroy()}setPointerLock(t=!0){t?this.eventTarget.requestPointerLock():this.eventTarget.exitPointerLock()}hasPointerLock(){return document.pointerLockElement===this.eventTarget}onMouseDown(t){this._downHasFocus=!0;let n=this._eventObject;if(n.code="Button"+t.button,n.event="pressed",n.value=1,n.control=t.ctrlKey,n.shift=t.shiftKey,n.alt=t.altKey,this.dispatchInputEvent(n)&&document.activeElement===this.eventTarget)return t.preventDefault(),t.stopPropagation(),!1}onContextMenu(t){return t.preventDefault(),t.stopPropagation(),!1}onWheel(t){let n,r,i;switch(t.deltaMode){case WheelEvent.DOM_DELTA_LINE:n=t.deltaX*Jt,r=t.deltaY*Jt,i=t.deltaZ*Jt;break;case WheelEvent.DOM_DELTA_PAGE:n=t.deltaX*en,r=t.deltaY*en,i=t.deltaZ*en;break;case WheelEvent.DOM_DELTA_PIXEL:default:n=t.deltaX,r=t.deltaY,i=t.deltaZ;break}let s=0,a=this._wheelObject;if(a.code="WheelX",a.movement=n,s|=this.dispatchInputEvent(a),a.code="WheelY",a.movement=r,s|=this.dispatchInputEvent(a),a.code="WheelZ",a.movement=i,s|=this.dispatchInputEvent(a),s)return t.preventDefault(),t.stopPropagation(),!1}onMouseUp(t){if(!this._downHasFocus)return;this._downHasFocus=!1;let n=this._eventObject;if(n.code="Button"+t.button,n.event="released",n.value=1,n.control=t.ctrlKey,n.shift=t.shiftKey,n.alt=t.altKey,this.dispatchInputEvent(n))return t.preventDefault(),t.stopPropagation(),!1}onMouseMove(t){if(this.eventsOnFocus&&document.activeElement!==this.eventTarget)return;let n=this.canvasTarget,{clientWidth:r,clientHeight:i}=n,s=n.getBoundingClientRect(),a=t.movementX/r,o=t.movementY/i,l=(t.clientX-s.left)/r,c=(t.clientY-s.top)/i,h=this._positionObject;h.code="PosX",h.value=l,h.movement=a,this.dispatchInputEvent(h),h.code="PosY",h.value=c,h.movement=o,this.dispatchInputEvent(h)}getCanvasFromEventTarget(t){return t instanceof HTMLCanvasElement?t:t.canvas||t.querySelector("canvas")||t.shadowRoot&&t.shadowRoot.querySelector("canvas")||t}},ko=`<kbd>
  <span id="name"><slot></slot></span>
  <span id="value" class="hidden"></span>
</kbd>
`,Ho=`kbd {
  position: relative;
  display: inline-block;
  border-radius: 3px;
  border: 1px solid #888888;
  font-size: 0.85em;
  font-weight: 700;
  text-rendering: optimizeLegibility;
  line-height: 12px;
  height: 14px;
  padding: 2px 4px;
  color: #444444;
  background-color: #eeeeee;
  box-shadow: inset 0 -3px 0 #aaaaaa;
  overflow: hidden;
}

kbd:empty::after {
  content: '<?>';
  opacity: 0.6;
}

.disabled {
  opacity: 0.6;
  box-shadow: none;
  background-color: #aaaaaa;
}

.hidden {
  display: none;
}

#value {
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  font-size: 0.85em;
  padding: 0 4px;
  padding-top: 2px;
  color: #cccccc;
  background-color: #333333;
  box-shadow: inset 0 3px 0 #222222;
}
`,tn=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=ko,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Ho,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("input-code",this)}static get observedAttributes(){return["name","value","disabled"]}get disabled(){return this._disabled}set disabled(t){this.toggleAttribute("disabled",t)}get value(){return this._value}set value(t){this.setAttribute("value",t)}get name(){return this._name}set name(t){this.setAttribute("name",t)}constructor(){super();let t=this.constructor,n=this.attachShadow({mode:"open"});n.appendChild(t[Symbol.for("templateNode")].content.cloneNode(!0)),n.appendChild(t[Symbol.for("styleNode")].cloneNode(!0)),this._name="",this._value="",this._disabled=!1,this._kbdElement=n.querySelector("kbd"),this._nameElement=n.querySelector("#name"),this._valueElement=n.querySelector("#value")}attributeChangedCallback(t,n,r){switch(t){case"name":this._name=r,this._nameElement.textContent=r;break;case"value":this._value=r,r!==null?(this._valueElement.classList.toggle("hidden",!1),this._valueElement.textContent=r,this._kbdElement.style.paddingRight=`${this._valueElement.clientWidth+4}px`):this._valueElement.classList.toggle("hidden",!0);break;case"disabled":this._disabled=r!==null,this._kbdElement.classList.toggle("disabled",r!==null);break}}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"name")){let t=this.name;delete this.name,this.name=t}if(Object.prototype.hasOwnProperty.call(this,"value")){let t=this.value;delete this.value,this.value=t}if(Object.prototype.hasOwnProperty.call(this,"disabled")){let t=this.disabled;delete this.disabled,this.disabled=t}}};tn.define();var zo=`<table>
  <thead>
    <tr class="tableHeader">
      <th colspan="3">
        <span class="tableTitle">
          <label id="title"> input-source </label>
          <span id="slotContainer">
            <slot></slot>
          </span>
          <p>
            <label for="poll">poll</label>
            <output id="poll"></output>
          </p>
          <p>
            <label for="focus">focus</label>
            <output id="focus"></output>
          </p>
        </span>
      </th>
    </tr>
    <tr class="colHeader">
      <th>name</th>
      <th>value</th>
      <th>key</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
`,Yo=`:host {
  display: block;
}

table {
  border-collapse: collapse;
  font-family: monospace;
}

table,
th,
td {
  border: 1px solid #666666;
}

th,
td {
  padding: 5px 10px;
}

td {
  text-align: center;
}

thead th {
  padding: 0;
}

.colHeader > th {
  font-size: 0.8em;
  padding: 0 10px;
  letter-spacing: 3px;
  background-color: #aaaaaa;
  color: #666666;
}

tbody output {
  border-radius: 0.3em;
  padding: 3px;
}

tr:not(.primary) .name,
tr:not(.primary) .value {
  opacity: 0.3;
}

tr:nth-child(2n) {
  background-color: #eeeeee;
}

.tableHeader {
  color: #666666;
}

.tableTitle {
  display: flex;
  flex-direction: row;
  align-items: center;
  padding: 4px;
}

#slotContainer {
  flex: 1;
}

p {
  display: inline;
  margin: 0;
  padding: 0;
  padding-right: 10px;
}

#poll:empty::after,
#focus:empty::after {
  content: '\u2717';
  color: #ff0000;
}
`,_r=class{constructor(t){this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null,this.pollable=t}get running(){return this.animationFrameHandle!==null}start(){let t=this.animationFrameHandle;t&&cancelAnimationFrame(t),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}stop(){let t=this.animationFrameHandle;t&&cancelAnimationFrame(t),this.animationFrameHandle=null}onAnimationFrame(t){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.pollable.onPoll(t)}},Er=class{constructor(t){this.onInput=this.onInput.bind(this),this.onPoll=this.onPoll.bind(this),this.bindings=t}onPoll(t){for(let n of this.bindings.getInputs())n.onPoll(t)}onInput(t){let{device:n,code:r,event:i,value:s,movement:a,control:o,shift:l,alt:c}=t,h=this.bindings.getBindings(n,r);switch(i){case"pressed":for(let{input:f,index:u}of h)f.onUpdate(u,1,1);break;case"released":for(let{input:f,index:u}of h)f.onUpdate(u,0,-1);break;case"move":for(let{input:f,index:u}of h)f.onUpdate(u,s,a);break;case"wheel":for(let{input:f,index:u}of h)f.onUpdate(u,void 0,a);break}return h.length>0}},nn=class{constructor(t,n,r,i){this.device=t,this.code=n,this.input=r,this.index=i}},Ar=class{constructor(){this.bindingMap={},this.inputMap=new Map}clear(){for(let t of this.inputMap.keys())t.onUnbind();this.inputMap.clear(),this.bindingMap={}}bind(t,n,r,i={inverted:!1}){let s,a=this.inputMap;if(a.has(t)){let l=a.get(t),c=t.size;t.onBind(c,i),s=new nn(n,r,t,c),l.push(s)}else{let l=[];a.set(t,l);let c=0;t.onBind(c,i),s=new nn(n,r,t,c),l.push(s)}let o=this.bindingMap;n in o?r in o[n]?o[n][r].push(s):o[n][r]=[s]:o[n]={[r]:[s]}}unbind(t){let n=this.inputMap;if(n.has(t)){let r=this.bindingMap,i=n.get(t);for(let s of i){let{device:a,code:o}=s,l=r[a][o],c=l.indexOf(s);l.splice(c,1)}i.length=0,t.onUnbind(),n.delete(t)}}isBound(t){return this.inputMap.has(t)}getInputs(){return this.inputMap.keys()}getBindingsByInput(t){return this.inputMap.get(t)}getBindings(t,n){let r=this.bindingMap;if(t in r){let i=r[t];if(n in i)return i[n]}return[]}},wr=class{constructor(t,n=void 0){this.inputs={},this.devices=[new yr("Mouse",t),new gr("Keyboard",t)],this.bindings=new Ar,this.adapter=new Er(this.bindings),this.autopoller=new _r(this.adapter),this.eventTarget=t,this.anyButton=new dt(1),this.anyButtonDevice="",this.anyButtonCode="",this.anyAxis=new Ze(1),this.anyAxisDevice="",this.anyAxisCode="",this.listeners={bind:[],unbind:[],focus:[],blur:[]},this.onInput=this.onInput.bind(this),this.onEventTargetBlur=this.onEventTargetBlur.bind(this),this.onEventTargetFocus=this.onEventTargetFocus.bind(this),t.addEventListener("focus",this.onEventTargetFocus),t.addEventListener("blur",this.onEventTargetBlur);for(let r of this.devices)r.addEventListener("input",this.onInput)}get autopoll(){return this.autopoller.running}set autopoll(t){this.toggleAutoPoll(t)}destroy(){let t=this.listeners;for(let r in t)t[r].length=0;this.autopoller.running&&this.autopoller.stop();for(let r of this.devices)r.removeEventListener("input",this.onInput),r.destroy();let n=this.eventTarget;n.removeEventListener("focus",this.onEventTargetFocus),n.removeEventListener("blur",this.onEventTargetBlur)}setEventTarget(t){let n=this.eventTarget;n.removeEventListener("focus",this.onEventTargetFocus),n.removeEventListener("blur",this.onEventTargetBlur),this.eventTarget=t;for(let r of this.devices)r.setEventTarget(t);t.addEventListener("focus",this.onEventTargetFocus),t.addEventListener("blur",this.onEventTargetBlur)}toggleAutoPoll(t=void 0){let n=this.autopoller.running,r=typeof t=="undefined"?!n:Boolean(t);r!==n&&(r?this.autopoller.start():this.autopoller.stop())}addEventListener(t,n){let r=this.listeners;t in r?r[t].push(n):r[t]=[n]}removeEventListener(t,n){let r=this.listeners;if(t in r){let i=r[t],s=i.indexOf(n);s>=0&&i.splice(s,1)}}dispatchEvent(t){let{type:n}=t,r=0;for(let i of this.listeners[n])r|=i(t)?1:0;return Boolean(r)}poll(t=performance.now()){if(this.autopoller.running)throw new Error("Should not manually poll() while autopolling.");this.onPoll(t)}onInput(t){let n=this.adapter.onInput(t);switch(t.event){case"pressed":this.anyButtonDevice=t.device,this.anyButtonCode=t.code,this.anyButton.onUpdate(0,1,1);break;case"released":this.anyButtonDevice=t.device,this.anyButtonCode=t.code,this.anyButton.onUpdate(0,0,-1);break;case"move":case"wheel":this.anyAxisDevice=t.device,this.anyAxisCode=t.code,this.anyAxis.onUpdate(0,t.value,t.movement);break}return n}onPoll(t){this.adapter.onPoll(t),this.anyButton.onPoll(t),this.anyAxis.onPoll(t)}onBind(){this.dispatchEvent({type:"bind"})}onUnbind(){this.dispatchEvent({type:"unbind"})}onEventTargetFocus(){this.dispatchEvent({type:"focus"})}onEventTargetBlur(){for(let t of this.bindings.getInputs())t.onStatus(0,0);this.anyButton.onStatus(0,0),this.anyAxis.onStatus(0,0),this.dispatchEvent({type:"blur"})}bindKeys(t){if(Array.isArray(t))for(let n of t)n.bindKeys(this);else if(typeof t.bindKeys=="function")t.bindKeys(this);else{t=Object.values(t);for(let n of t)n.bindKeys(this)}}bindButton(t,n,r,i=void 0){let s;this.hasButton(t)?s=this.getButton(t):(s=new dt(1),this.inputs[t]=s),this.bindings.bind(s,n,r,i),this.onBind()}bindAxis(t,n,r,i=void 0){let s;this.hasAxis(t)?s=this.getAxis(t):(s=new Ze(1),this.inputs[t]=s),this.bindings.bind(s,n,r,i),this.onBind()}bindAxisButtons(t,n,r,i){let s;this.hasAxis(t)?s=this.getAxis(t):(s=new Ze(2),this.inputs[t]=s),this.bindings.bind(s,n,i),this.bindings.bind(s,n,r,{inverted:!0}),this.onBind()}unbindButton(t){if(this.hasButton(t)){let n=this.getButton(t);delete this.inputs[t],this.bindings.unbind(n),this.onUnbind()}}unbindAxis(t){if(this.hasAxis(t)){let n=this.getAxis(t);delete this.inputs[t],this.bindings.unbind(n),this.onUnbind()}}getInput(t){return this.inputs[t]}getButton(t){return this.inputs[t]}getAxis(t){return this.inputs[t]}hasButton(t){return t in this.inputs&&this.inputs[t]instanceof dt}hasAxis(t){return t in this.inputs&&this.inputs[t]instanceof Ze}isButtonDown(t){return this.inputs[t].down}isButtonPressed(t){return this.inputs[t].pressed}isButtonReleased(t){return this.inputs[t].released}getInputValue(t){return this.inputs[t].value}getButtonValue(t){return this.inputs[t].value}getAxisValue(t){return this.inputs[t].value}getAxisDelta(t){return this.inputs[t].delta}isAnyButtonDown(t=void 0){if(typeof t=="undefined")return this.anyButton.down;{let n=this.inputs;for(let r of t)if(n[r].down)return!0}return!1}isAnyButtonPressed(t=void 0){if(typeof t=="undefined")return this.anyButton.pressed;{let n=this.inputs;for(let r of t)if(n[r].pressed)return!0}return!1}isAnyButtonReleased(t=void 0){if(typeof t=="undefined")return this.anyButton.released;{let n=this.inputs;for(let r of t)if(n[r].released)return!0}return!1}getAnyAxisValue(t=void 0){if(typeof t=="undefined")return this.anyAxis.value;{let n=this.inputs;for(let r of t){let i=n[r];if(i.value)return i.value}}return 0}getAnyAxisDelta(t=void 0){if(typeof t=="undefined")return this.anyAxis.delta;{let n=this.inputs;for(let r of t){let i=n[r];if(i.delta)return i.delta}}return 0}getLastButtonDevice(){return this.anyButtonDevice}getLastButtonCode(){return this.anyButtonCode}getLastAxisDevice(){return this.anyAxisDevice}getLastAxisCode(){return this.anyAxisCode}getMouse(){return this.devices[0]}getKeyboard(){return this.devices[1]}},mt=class extends HTMLElement{static create(t={}){let{root:n=document.body,id:r=void 0,for:i=void 0,autopoll:s=!1}=t||{},a=new mt;return a.id=r,a.for=i,a.autopoll=s,n.appendChild(a),a}static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=zo,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Yo,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("input-port",this)}static get observedAttributes(){return["autopoll","for"]}get autopoll(){return this._autopoll}set autopoll(t){this.toggleAttribute("autopoll",t)}get for(){return this._for}set for(t){this.setAttribute("for",t)}constructor(){super();let t=this.attachShadow({mode:"open"});t.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),t.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._titleElement=t.querySelector("#title"),this._pollElement=t.querySelector("#poll"),this._focusElement=t.querySelector("#focus"),this._bodyElement=t.querySelector("tbody"),this._outputElements={},this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null;let n=this;this._for="",this._eventTarget=n,this._autopoll=!1,this._context=null,this.onInputContextBind=this.onInputContextBind.bind(this),this.onInputContextUnbind=this.onInputContextUnbind.bind(this),this.onInputContextFocus=this.onInputContextFocus.bind(this),this.onInputContextBlur=this.onInputContextBlur.bind(this)}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"for")){let t=this.for;delete this.for,this.for=t}if(Object.prototype.hasOwnProperty.call(this,"autopoll")){let t=this.autopoll;delete this.autopoll,this.autopoll=t}this.updateTable(),this.updateTableValues(),this.animationFrameHandle=window.requestAnimationFrame(this.onAnimationFrame)}disconnectedCallback(){let t=this._context;t&&(t.removeEventListener("bind",this.onInputContextBind),t.removeEventListener("unbind",this.onInputContextUnbind),t.removeEventListener("blur",this.onInputContextBlur),t.removeEventListener("focus",this.onInputContextFocus),t.destroy(),this._context=null)}attributeChangedCallback(t,n,r){switch(t){case"for":{this._for=r;let i,s;r?(i=document.getElementById(r),s=`${i.tagName.toLowerCase()}#${r}`):(i=this,s="input-port"),this._eventTarget=i,this._context&&this._context.setEventTarget(this._eventTarget),this._titleElement.innerHTML=`for ${s}`}break;case"autopoll":this._autopoll=r!==null,this._context&&this._context.toggleAutoPoll(this._autopoll);break}}onAnimationFrame(){this.animationFrameHandle=window.requestAnimationFrame(this.onAnimationFrame),this.updateTableValues(),this.updatePollStatus()}onInputContextBind(){return this.updateTable(),!0}onInputContextUnbind(){return this.updateTable(),!0}onInputContextFocus(){return this._focusElement.innerHTML="\u2713",!0}onInputContextBlur(){return this._focusElement.innerHTML="",!0}getContext(t="axisbutton",n=void 0){switch(t){case"axisbutton":if(!this._context){let r=new wr(this._eventTarget,n);r.addEventListener("bind",this.onInputContextBind),r.addEventListener("unbind",this.onInputContextUnbind),r.addEventListener("blur",this.onInputContextBlur),r.addEventListener("focus",this.onInputContextFocus),this._autopoll&&r.toggleAutoPoll(!0),this._context=r}return this._context;default:throw new Error(`Input context id '${t}' is not supported.`)}}updateTable(){if(this.isConnected)if(this._context){let t=this._context,n=t.inputs,r=t.bindings,i={},s=[];for(let a of Object.keys(n)){let o=n[a],l=!0;for(let c of r.getBindingsByInput(o)){let h=Go(`${o.constructor.name}.${a}`,`${c.device}.${c.code}`,0,l);s.push(h),l&&(i[a]=h.querySelector("output"),l=!1)}}this._outputElements=i,this._bodyElement.innerHTML="";for(let a of s)this._bodyElement.appendChild(a)}else{this._outputElements={},this._bodyElement.innerHTML="";return}else return}updateTableValues(){if(this.isConnected)if(this._context){let n=this._context.inputs;for(let r of Object.keys(this._outputElements)){let i=this._outputElements[r],s=n[r].value;i.innerText=Number(s).toFixed(2)}}else{for(let t of Object.keys(this._outputElements)){let n=this._outputElements[t];n.innerText="---"}return}else return}updatePollStatus(){if(this.isConnected)if(this._context){let n=this._context.inputs;for(let r of Object.values(n))if(!r.polling){this._pollElement.innerHTML="";return}this._pollElement.innerHTML="\u2713"}else{this._pollElement.innerHTML="-";return}else return}};mt.define();function Go(e,t,n,r=!0){let i=document.createElement("tr");r&&i.classList.add("primary");{let s=document.createElement("td");s.textContent=e,s.classList.add("name"),i.appendChild(s)}{let s=document.createElement("td"),a=document.createElement("output");r?a.innerText=Number(n).toFixed(2):a.innerText="---",a.classList.add("value"),s.appendChild(a),i.appendChild(s)}{let s=document.createElement("td");s.classList.add("key");let a=new tn;a.innerText=t,s.appendChild(a),i.appendChild(s)}return i}var Td=Symbol("keyboardSource");var Md=Symbol("mouseSource");var xi=ua(Jr());var ei={},Ml=function(e,t,n,r,i){var s=new Worker(ei[t]||(ei[t]=URL.createObjectURL(new Blob([e+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return s.onmessage=function(a){var o=a.data,l=o.$e$;if(l){var c=new Error(l[0]);c.code=l[1],c.stack=l[2],i(c,null)}else i(null,o)},s.postMessage(n,r),s},ae=Uint8Array,Ne=Uint16Array,gn=Uint32Array,yn=new ae([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),_n=new ae([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ti=new ae([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ni=function(e,t){for(var n=new Ne(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];for(var i=new gn(n[30]),r=1;r<30;++r)for(var s=n[r];s<n[r+1];++s)i[s]=s-n[r]<<5|r;return[n,i]},ri=ni(yn,2),En=ri[0],Sl=ri[1];En[28]=258,Sl[258]=28;var ii=ni(_n,0),si=ii[0],Pd=ii[1],wt=new Ne(32768);for(var W=0;W<32768;++W)Re=(W&43690)>>>1|(W&21845)<<1,Re=(Re&52428)>>>2|(Re&13107)<<2,Re=(Re&61680)>>>4|(Re&3855)<<4,wt[W]=((Re&65280)>>>8|(Re&255)<<8)>>>1;var Re,$e=function(e,t,n){for(var r=e.length,i=0,s=new Ne(t);i<r;++i)e[i]&&++s[e[i]-1];var a=new Ne(t);for(i=0;i<t;++i)a[i]=a[i-1]+s[i-1]<<1;var o;if(n){o=new Ne(1<<t);var l=15-t;for(i=0;i<r;++i)if(e[i])for(var c=i<<4|e[i],h=t-e[i],f=a[e[i]-1]++<<h,u=f|(1<<h)-1;f<=u;++f)o[wt[f]>>>l]=c}else for(o=new Ne(r),i=0;i<r;++i)e[i]&&(o[i]=wt[a[e[i]-1]++]>>>15-e[i]);return o},tt=new ae(288);for(var W=0;W<144;++W)tt[W]=8;for(var W=144;W<256;++W)tt[W]=9;for(var W=256;W<280;++W)tt[W]=7;for(var W=280;W<288;++W)tt[W]=8;var ai=new ae(32);for(var W=0;W<32;++W)ai[W]=5;var oi=$e(tt,9,1);var li=$e(ai,5,1),bt=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},ue=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(t&7)&n},Tt=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(t&7)},ci=function(e){return(e+7)/8|0},Mt=function(e,t,n){(t==null||t<0)&&(t=0),(n==null||n>e.length)&&(n=e.length);var r=new(e.BYTES_PER_ELEMENT==2?Ne:e.BYTES_PER_ELEMENT==4?gn:ae)(n-t);return r.set(e.subarray(t,n)),r};var hi=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],le=function(e,t,n){var r=new Error(t||hi[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,le),!n)throw r;return r},fi=function(e,t,n){var r=e.length;if(!r||n&&n.f&&!n.l)return t||new ae(0);var i=!t||n,s=!n||n.i;n||(n={}),t||(t=new ae(r*3));var a=function(k){var Be=t.length;if(k>Be){var ht=new ae(Math.max(Be*2,k));ht.set(t),t=ht}},o=n.f||0,l=n.p||0,c=n.b||0,h=n.l,f=n.d,u=n.m,p=n.n,d=r*8;do{if(!h){o=ue(e,l,1);var v=ue(e,l+1,3);if(l+=3,v)if(v==1)h=oi,f=li,u=9,p=5;else if(v==2){var w=ue(e,l,31)+257,S=ue(e,l+10,15)+4,T=w+ue(e,l+5,31)+1;l+=14;for(var g=new ae(T),N=new ae(19),A=0;A<S;++A)N[ti[A]]=ue(e,l+A*3,7);l+=S*3;for(var M=bt(N),B=(1<<M)-1,x=$e(N,M,1),A=0;A<T;){var F=x[ue(e,l,B)];l+=F&15;var m=F>>>4;if(m<16)g[A++]=m;else{var D=0,P=0;for(m==16?(P=3+ue(e,l,3),l+=2,D=g[A-1]):m==17?(P=3+ue(e,l,7),l+=3):m==18&&(P=11+ue(e,l,127),l+=7);P--;)g[A++]=D}}var y=g.subarray(0,w),_=g.subarray(w);u=bt(y),p=bt(_),h=$e(y,u,1),f=$e(_,p,1)}else le(1);else{var m=ci(l)+4,E=e[m-4]|e[m-3]<<8,C=m+E;if(C>r){s&&le(0);break}i&&a(c+E),t.set(e.subarray(m,C),c),n.b=c+=E,n.p=l=C*8,n.f=o;continue}if(l>d){s&&le(0);break}}i&&a(c+131072);for(var j=(1<<u)-1,z=(1<<p)-1,J=l;;J=l){var D=h[Tt(e,l)&j],ee=D>>>4;if(l+=D&15,l>d){s&&le(0);break}if(D||le(2),ee<256)t[c++]=ee;else if(ee==256){J=l,h=null;break}else{var re=ee-254;if(ee>264){var A=ee-257,ge=yn[A];re=ue(e,l,(1<<ge)-1)+En[A],l+=ge}var qe=f[Tt(e,l)&z],Le=qe>>>4;qe||le(3),l+=qe&15;var _=si[Le];if(Le>3){var ge=_n[Le];_+=Tt(e,l)&(1<<ge)-1,l+=ge}if(l>d){s&&le(0);break}i&&a(c+131072);for(var ye=c+re;c<ye;c+=4)t[c]=t[c-_],t[c+1]=t[c+1-_],t[c+2]=t[c+2-_],t[c+3]=t[c+3-_];c=ye}}n.l=h,n.p=J,n.b=c,n.f=o,h&&(o=1,n.m=u,n.d=f,n.n=p)}while(!o);return c==t.length?t:Mt(t,0,c)};var Rl=new ae(0);var Il=function(e,t){var n={};for(var r in e)n[r]=e[r];for(var r in t)n[r]=t[r];return n},ui=function(e,t,n){for(var r=e(),i=e.toString(),s=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/\s+/g,"").split(","),a=0;a<r.length;++a){var o=r[a],l=s[a];if(typeof o=="function"){t+=";"+l+"=";var c=o.toString();if(o.prototype)if(c.indexOf("[native code]")!=-1){var h=c.indexOf(" ",8)+1;t+=c.slice(h,c.indexOf("(",h))}else{t+=c;for(var f in o.prototype)t+=";"+l+".prototype."+f+"="+o.prototype[f].toString()}else t+=c}else n[l]=o}return[t,n]},St=[],Cl=function(e){var t=[];for(var n in e)e[n].buffer&&t.push((e[n]=new e[n].constructor(e[n])).buffer);return t},Ll=function(e,t,n,r){var i;if(!St[n]){for(var s="",a={},o=e.length-1,l=0;l<o;++l)i=ui(e[l],s,a),s=i[0],a=i[1];St[n]=ui(e[o],s,a)}var c=Il({},St[n][1]);return Ml(St[n][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",n,c,Cl(c),r)},Nl=function(){return[ae,Ne,gn,yn,_n,ti,En,si,oi,li,wt,hi,$e,bt,ue,Tt,ci,Mt,le,fi,wn,pi,di]};var pi=function(e){return postMessage(e,[e.buffer])},di=function(e){return e&&e.size&&new ae(e.size)},Ol=function(e,t,n,r,i,s){var a=Ll(n,r,i,function(o,l){a.terminate(),s(o,l)});return a.postMessage([e,t],t.consume?[e.buffer]:[]),function(){a.terminate()}};var Ee=function(e,t){return e[t]|e[t+1]<<8},me=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0},An=function(e,t){return me(e,t)+me(e,t+4)*4294967296};function Bl(e,t,n){return n||(n=t,t={}),typeof n!="function"&&le(7),Ol(e,t,[Nl],function(r){return pi(wn(r.data[0],di(r.data[1])))},1,n)}function wn(e,t){return fi(e,t)}var Fd=typeof TextEncoder!="undefined"&&new TextEncoder,bn=typeof TextDecoder!="undefined"&&new TextDecoder,Pl=0;try{bn.decode(Rl,{stream:!0}),Pl=1}catch(e){}var Fl=function(e){for(var t="",n=0;;){var r=e[n++],i=(r>127)+(r>223)+(r>239);if(n+i>e.length)return[t,Mt(e,n-1)];i?i==3?(r=((r&15)<<18|(e[n++]&63)<<12|(e[n++]&63)<<6|e[n++]&63)-65536,t+=String.fromCharCode(55296|r>>10,56320|r&1023)):i&1?t+=String.fromCharCode((r&31)<<6|e[n++]&63):t+=String.fromCharCode((r&15)<<12|(e[n++]&63)<<6|e[n++]&63):t+=String.fromCharCode(r)}};function Dl(e,t){if(t){for(var n="",r=0;r<e.length;r+=16384)n+=String.fromCharCode.apply(null,e.subarray(r,r+16384));return n}else{if(bn)return bn.decode(e);var i=Fl(e),s=i[0],a=i[1];return a.length&&le(8),s}}var Ul=function(e,t){return t+30+Ee(e,t+26)+Ee(e,t+28)},kl=function(e,t,n){var r=Ee(e,t+28),i=Dl(e.subarray(t+46,t+46+r),!(Ee(e,t+8)&2048)),s=t+46+r,a=me(e,t+20),o=n&&a==4294967295?Hl(e,s):[a,me(e,t+24),me(e,t+42)],l=o[0],c=o[1],h=o[2];return[Ee(e,t+10),l,c,i,s+Ee(e,t+30)+Ee(e,t+32),h]},Hl=function(e,t){for(;Ee(e,t)!=1;t+=4+Ee(e,t+2));return[An(e,t+12),An(e,t+4),An(e,t+20)]};var mi=typeof queueMicrotask=="function"?queueMicrotask:typeof setTimeout=="function"?setTimeout:function(e){e()};function vi(e,t,n){n||(n=t,t={}),typeof n!="function"&&le(7);var r=[],i=function(){for(var m=0;m<r.length;++m)r[m]()},s={},a=function(m,E){mi(function(){n(m,E)})};mi(function(){a=n});for(var o=e.length-22;me(e,o)!=101010256;--o)if(!o||e.length-o>65558)return a(le(13,0,1),null),i;var l=Ee(e,o+8);if(l){var c=l,h=me(e,o+16),f=h==4294967295||c==65535;if(f){var u=me(e,o-12);f=me(e,u)==101075792,f&&(c=l=me(e,u+32),h=me(e,u+48))}for(var p=t&&t.filter,d=function(m){var E=kl(e,h,f),C=E[0],w=E[1],S=E[2],T=E[3],g=E[4],N=E[5],A=Ul(e,N);h=g;var M=function(x,F){x?(i(),a(x,null)):(F&&(s[T]=F),--l||a(null,s))};if(!p||p({name:T,size:w,originalSize:S,compression:C}))if(!C)M(null,Mt(e,A,A+w));else if(C==8){var B=e.subarray(A,A+w);if(w<32e4)try{M(null,wn(B,new ae(S)))}catch(x){M(x,null)}else r.push(Bl(B,{size:S},M))}else M(le(14,"unknown compression type "+C,1),null);else M(null,null)},v=0;v<c;++v)d(v)}else a(null,{});return i}var nt=class{constructor(t){let n;typeof t=="object"&&t instanceof nt?n=t.source:n=String(t),this.source=n,this._re=(0,xi.makeRe)(n)}test(t){return this._re.test(t)}},zl=/^([_\w\d]+)\:\/\//;async function gi(e,t,n,r,i,s){let{loadings:a}=e,o;t in a?o=a[t]:(o=new Ve(s),a[t]=o);let l=Ve.nextAttempt(o),c=[o.promise];return zl.test(n)?c.push(yi(e,n,s).then(h=>r(h,i)).then(h=>Ve.isCurrentAttempt(o,l)?rt(e,t,h):void 0)):c.push(r(n).then(h=>Ve.isCurrentAttempt(o,l)?rt(e,t,h):void 0)),await Promise.race(c)}function rt(e,t,n){let{store:r,loadings:i}=e;return r[t]=n,t in i&&(i[t].resolve(n),delete i[t]),n}function Yl(e,t,n){let{defaults:r}=e;typeof t=="string"&&(t=new nt(t));let i=`__default://[${r.length}]`;return rt(e,i,n),r.push(new Ai(t,i)),n}function Gl(e,t){let{store:n,loadings:r}=e;t in r&&(r[t].reject(new Error("Stop loading to delete asset.")),delete r[t]),t in n&&delete n[t]}function $l(e,t){typeof t=="string"&&(t=new nt(t));let{store:n,loadings:r}=e;for(let[i,s]of Object.entries(r))t.test(i)&&(s.reject(new Error(`Stop loading to clear assets matching ${t}`)),delete r[i]);for(let i of Object.keys(n))t.test(i)&&delete n[i]}function Vl(e){let{store:t,loadings:n,defaults:r}=e;for(let[i,s]of Object.entries(n))s.reject(new Error("Stop loading to clear all assets.")),delete n[i];for(let i of Object.keys(t))delete t[i];r.length=0}function Kl(e,t){let{loadings:n}=e;return t in n?n[t].promise:null}async function yi(e,t,n){let{store:r,loadings:i}=e;if(t in r)return r[t];if(t in i)return i[t].promise;{let s=new Ve(n);return i[t]=s,s.promise}}function Wl(e,t){let{defaults:n}=e;for(let r of n)if(r.glob.test(t))return Rt(e,r.uri);return null}function Rt(e,t){return e.store[t]}function jl(e,t){return Boolean(e.store[t])}function ql(e){return Object.keys(e.store)}function _i(e,t){return t in e.store}function Ei(e,t){return t in e.loadings}var Ai=class{constructor(t,n){this.glob=t,this.uri=n}},Ve=class{static nextAttempt(t){return++t._promiseHandle}static isCurrentAttempt(t,n){return t._promiseHandle===n}constructor(t){this._promiseHandle=0,this._resolve=null,this._reject=null,this._reason=null,this._value=null,this._timeoutHandle=Number.isFinite(t)&&t>0?setTimeout(()=>{this.reject(`Asset loading exceeded timeout of ${t} ms.`)},t):null,this._promise=new Promise((n,r)=>{this._value?n(this._value):this._resolve=n,this._reason?r(this._reason):this._reject=r})}get promise(){return this._promise}resolve(t){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._resolve?this._resolve(t):this._value=t}reject(t){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._reject?this._reject(t):this._reason=t}},Tn=class{constructor(t=null){this.parent=t,this.store={},this.loadings={},this.defaults=[]}get(t){let n=this;if(_i(n,t))return Rt(n,t);let r=Wl(n,t);return r||null}async resolve(t,n,r,i,s){return this.get(t)||await this.load(t,n,r,i,s)}fallback(t,n){return Yl(this,t,n)}cache(t,n){return rt(this,t,n)}async load(t,n,r,i,s){let a=this;return _i(a,t)?Rt(a,t):Ei(a,t)?await yi(a,t,s):await gi(a,t,n,r,i,s)}async reload(t,n,r,i,s){return await gi(this,t,n,r,i,s)}unload(t){Gl(this,t)}clear(t){$l(this,t)}current(t){return Rt(this,t)}exists(t){return jl(this,t)}loading(t){let n=this;return Ei(n,t)?Kl(n,t):null}keys(){return ql(this)}reset(){Vl(this)}},wi=5e3,X=class{constructor(t,n,r=void 0,i=t,s=null){this.uri=t,this.loader=n,this.opts=r,this.initial=s,this.filepath=i,this.source=null,this.current=null}cache(t,n){return t.cache(this.uri,n),this.source=t,this.current=n,this}get(t){let n;return t.exists(this.uri)?n=t.current(this.uri):this.initial&&this.initial instanceof X?n=this.initial.get(t):n=this.initial,this.source=t,this.current=n,n}async load(t,n=wi){let r;if(t.exists(this.uri))r=t.current(this.uri);else if(r=await t.load(this.uri,this.filepath,this.loader,this.opts,n),!r)if(this.initial&&this.initial instanceof X){let i=this.initial;r=await t.load(i.uri,i.filepath,i.loader,i.opts,n)}else r=this.initial;return this.source=t,this.current=r,r}async reload(t,n=wi){let r=await t.reload(this.uri,this.filepath,this.loader,this.opts,n);return this.source=t,this.current=r,r}};async function bi(e,t,n=void 0){let r=e,i="raw://",a=await(await fetch(t)).arrayBuffer();await new Promise((o,l)=>{vi(new Uint8Array(a),(c,h)=>{if(c)l(c);else{for(let[f,u]of Object.entries(h)){f=f.replaceAll("\\","/");let p=f.indexOf("/");p>=0&&(f=f.substring(p+1));let d=i+f;rt(r,d,u),n&&n(u,d,f)}o()}})})}async function ce(e,t,n=5e3){let r=[];for(let i of t)r.push(i.load(e,n));await Promise.allSettled(r)}async function ie(e,t=void 0){let{imageType:n=void 0}=t||{};if(typeof e=="string"){let l=await(await fetch(e)).arrayBuffer();if(typeof n=="undefined"){let c=e.lastIndexOf(".");if(c<0)throw new Error("Cannot load from url - unknown image type.");n="image/"+e.slice(c+1)}return ie(l,{...t,imageType:n})}else if(!(e instanceof ArrayBuffer||ArrayBuffer.isView(e)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let r=e;typeof n=="undefined"&&(n="image/png");let i=new Blob([r],{type:n}),s=URL.createObjectURL(i),a=new Image;return new Promise((o,l)=>{a.addEventListener("load",()=>{o(a)}),a.addEventListener("error",c=>{l(c)}),a.src=s})}async function Mn(e,t){let{audioContext:n}=t||{};if(typeof e=="string"){let o=await(await fetch(e)).arrayBuffer();return Mn(o,{audioContext:n})}else if(!(e instanceof ArrayBuffer||ArrayBuffer.isView(e)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let r=e,i=new ArrayBuffer(r.byteLength);return new Uint8Array(i).set(r),await n.decodeAudioData(i)}window.addEventListener("error",It,!0);window.addEventListener("unhandledrejection",It,!0);function It(e){typeof e=="object"?e instanceof PromiseRejectionEvent?It(e.reason):e instanceof ErrorEvent?It(e.error):e instanceof Error?window.alert(e.stack):window.alert(JSON.stringify(e)):window.alert(e)}var Xl=`
<slot></slot>
<div class="container"></div>`,Ql=`
slot, ::slotted(*) {
    display: none;
}

.outer {
    overflow: hidden;
}
.outer, .inner {
    display: inline-block;
    transform-origin: top left;
    transform: scale(0, 1);
    contain: content;
}
.inner {
    white-space: pre;
}

.container p {
    margin: 0;
}

.waveChild {
    display: inline-block;
    transform-origin: top left;
    animation-name: wavy;
    animation-duration: 300ms;
    animation-direction: alternate;
    animation-iteration-count: infinite;
    animation-timing-function: linear;
}
@keyframes wavy{
    from {
        transform: translateY(-6%);
    }
    to {
        transform: translateY(6%);
    }
}`,Zl=30,Jl=120,Ti=10,[ec,tc]=(()=>{let e=[],t=[];for(let n=1;n<=Ti;++n){let r=n/Ti,i=r.toFixed(5);e.push({transform:`scale(${i},1)`});let s=(1/r).toFixed(5);t.push({transform:`scale(${s},1)`})}return[e,t]})(),Mi=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=Xl,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Ql,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("dialogue-area",this)}get paused(){return this._paused}set paused(t){t?this.pause():this.play()}get autoplay(){return this.hasAttribute("autoplay")}set autoplay(t){this.toggleAttribute("autoplay",t)}constructor(){super();let t=this.attachShadow({mode:"open"});t.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),t.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._containerElement=t.querySelector(".container"),this._slotElement=t.querySelector("slot"),this._typeWriteQueue=[],this._typeWriteIndex=0,this._currentWaitTime=0,this._currentWaitTimeout=null,this._currentAnimations=[],this._paused=!0,this._eventFinish=new CustomEvent("finish",{composed:!0,bubbles:!1}),this.onSlotChange=this.onSlotChange.bind(this),this.onAnimationFinish=this.onAnimationFinish.bind(this),this.onWaitTimeout=this.onWaitTimeout.bind(this),this._slotElement.addEventListener("slotchange",this.onSlotChange)}connectedCallback(){nc(this,"autoplay")}disconnectedCallback(){this._containerElement.innerHTML=""}play(){this._paused=!1;for(let t of this._currentAnimations)t.play();this.step()}pause(){this._paused=!0;for(let t of this._currentAnimations)t.pause()}reset(){this._typeWriteIndex=0;for(let n of this._currentAnimations)n.cancel();this._currentAnimations.length=0,clearTimeout(this._currentWaitTimeout),this._currentWaitTimeout=null;let t=this._typeWriteQueue;for(let n of t){let r=n.children.item(0);n.style.removeProperty("transform"),r.style.removeProperty("transform")}}step(){if(this._currentAnimations.length>0||this._currentWaitTimeout||this._paused||this._typeWriteIndex>=this._typeWriteQueue.length)return;let t=Zl;if(this.hasAttribute("speed")){let c=Number(this.getAttribute("speed"));c>0?t/=c:t=0}if(t<=0){this.skip();return}let n=this._typeWriteQueue[this._typeWriteIndex],r=n.children.item(0);n.style.transform="scale(1,1)",r.style.transform="scale(1,1)";let s=r.textContent.length*t,a=(r.hasAttribute("data-p-wait")?Number(r.getAttribute("data-p-wait")):0)*t*4,o=n.animate(ec,s),l=r.animate(tc,s);this._currentAnimations.push(o,l),this._currentWaitTime=a,this._typeWriteIndex+=1,l.addEventListener("finish",this.onAnimationFinish)}skip(){if(this._typeWriteIndex>=this._typeWriteQueue.length)return;let t=this._currentWaitTimeout;this._currentWaitTimeout=null,clearTimeout(t);let n=this._currentAnimations;this._currentAnimations.length=0;for(let s of n)s.finish();let r=this._typeWriteQueue,i=r.length;for(let s=this._typeWriteIndex;s<i;++s){let a=r[s],o=a.children.item(0);a.style.transform="scale(1,1)",o.style.transform="scale(1,1)"}this._typeWriteIndex=r.length}onSlotChange(){this.reset();let t=this._containerElement,n=rc(this._slotElement);t.innerHTML="",t.appendChild(n);let r=t.querySelectorAll(".outer"),i=this._typeWriteQueue;i.length=0;let s=r.length;for(let a=0;a<s;++a){let o=r.item(a);i.push(o)}this._typeWriteIndex=0,this.hasAttribute("autoplay")&&this.play()}onAnimationFinish(){if(this._currentAnimations.length=0,this._typeWriteIndex>=this._typeWriteQueue.length){this.dispatchEvent(this._eventFinish);return}let t=this._currentWaitTime;t>0?(this._currentWaitTime=0,this._currentWaitTimeout=setTimeout(this.onWaitTimeout,t)):this.step()}onWaitTimeout(){this._currentWaitTimeout=null,this.step()}};Mi.define();function nc(e,t){if(Object.prototype.hasOwnProperty.call(e,t)){let n=e[t];delete e[t],e[t]=n}}function rc(e){let t=document.createDocumentFragment(),n=e.assignedNodes();for(let r of n){if(r=r.cloneNode(!0),r.nodeType===3){let s=r.textContent.split(/\s+/).filter(Boolean).map(o=>o+" "),a=document.createDocumentFragment();for(let o of s){let l=Ri(o),c=Sn(o,l);a.append(c)}r=a}else{let i=Si(r,/\s+/,!0);for(let{parent:s,node:a,content:o}of i){if(s.nodeName==="P-WAIT"){let c=Sn("",Number(o.join("")));s.insertBefore(c,a)}else for(let c of o){let h=Ri(c),f=Sn(c,h);s.insertBefore(f,a)}s.removeChild(a)}}if(r instanceof Element){let i=[];r.nodeName==="P-WAVE"&&i.push(r);let s=r.querySelectorAll("p-wave"),a=s.length;for(let o=0;o<a;++o){let l=s.item(o);i.push(l)}for(let o of i){let l=Si(o,"",!1);for(let{parent:c,node:h,content:f}of l){let u=0;for(let p of f){let d=document.createElement("span");d.className="waveChild",d.textContent=p,d.style.animationDelay=`${u}ms`,u+=Jl,c.insertBefore(d,h)}c.removeChild(h)}}}t.append(r)}return t}function Si(e,t,n){let r=[],i=document.createTreeWalker(e,NodeFilter.SHOW_TEXT),s;for(;s=i.nextNode();){let o=s.textContent.split(t).filter(Boolean);n&&(o=o.map(c=>c+" "));let l={parent:s.parentNode,node:s,content:o};r.push(l)}return r}function Ri(e){let t=/([\.\!\?\:\-]+)$/.exec(e),n=/([\,\;]+)$/.exec(e),r=0;if(t){let[i,s]=t;r+=s.length*2}if(n){let[i,s]=n;r+=s.length}return r}function Sn(e,t){let n=document.createElement("span");n.className="outer";let r=document.createElement("span");return r.className="inner",n.append(r),t>0&&r.setAttribute("data-p-wait",String(t)),e&&(r.textContent=e),n}var Rn=class{next(){return 0}},Ii=class extends Rn{next(){return Math.random()}},Ci=class extends Rn{constructor(t){super();this.seed=t,this.a=t}next(){var t=this.a+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}},R=class{static get RAND(){let t=new this;return this.next=this.next.bind(this),this.choose=this.choose.bind(this),this.range=this.range.bind(this),this.rangeInt=this.rangeInt.bind(this),this.sign=this.sign.bind(this),Object.defineProperty(this,"RAND",{value:t}),t}constructor(t=void 0){typeof t=="number"?this.generator=new Ci(t):t?this.generator=t:this.generator=new Ii,this.next=this.next.bind(this),this.choose=this.choose.bind(this),this.range=this.range.bind(this),this.rangeInt=this.rangeInt.bind(this),this.sign=this.sign.bind(this)}static next(){return this.RAND.next()}next(){return this.generator.next()}static choose(t){return this.RAND.choose(t)}choose(t){return t[Math.floor(this.generator.next()*t.length)]}static range(t,n){return this.RAND.range(t,n)}range(t,n){return(n-t)*this.generator.next()+t}static rangeInt(t,n){return this.RAND.rangeInt(t,n)}rangeInt(t,n){return Math.trunc(this.range(t,n))}static sign(){return this.RAND.sign()}sign(){return this.generator.next()<.5?-1:1}};var Ae={MoveLeft:new Me("moveLeft",[Te.KEY_A,Te.ARROW_LEFT]),MoveRight:new Me("moveRight",[Te.KEY_D,Te.ARROW_RIGHT]),Fish:new Me("fish",[Te.KEY_Z]),FastForward:new Me("fastForward",[Te.SPACE])};function Li(e){e.bindKeys(Ae)}var In=Symbol("audioContext"),Ct=class{static getAudioContext(){if(In in this)return this[In];{let t=new AudioContext;return ic(t),this[In]=t,t}}constructor(t,n){this.audioContext=t,this.audioBuffer=n,this._playing=!1,this._started=!1,this._pitch=0,this._loop=!1,this._gainNode=t.createGain(),this._panNode=t.createStereoPanner(),this._source=null,this.onAudioSourceEnded=this.onAudioSourceEnded.bind(this)}destroy(){this._source&&this._source.disconnect(),this._source=null,this._started=!1,this._playing=!1}onAudioSourceEnded(){console.log("END!"),this._playing=!1}setPitch(t){return this._pitch=t,this._source&&(this._source.detune.value=t*100),this}setGain(t){return this._gainNode.gain.value=t,this}setPan(t){return this._panNode.pan.value=t,this}setLoop(t){return this._loop=t,this._source&&(this._source.loop=t),this}play(){this._source&&this._source.disconnect();let t=this.audioContext,n=this.audioBuffer,r=t.createBufferSource();r.buffer=n,this._pitch&&(r.detune.value=this._pitch*100),this._loop&&(r.loop=this._loop);let i=r;i=i.connect(this._gainNode),i=i.connect(this._panNode),i.connect(t.destination),this._source=r,this._started=!0,this._playing=!0,r.addEventListener("ended",this.onAudioSourceEnded),r.start()}pause(){this._source.stop(),this._playing=!1}isStarted(){return this._started}isPlaying(){return this._playing}isPaused(){return this._started&&!this._playing}};function ic(e){let t=()=>{e.state==="suspended"&&e.resume()};document.addEventListener("click",t)}async function Lt(e){let t=Ct.getAudioContext(),n=await Mn(e,{audioContext:t});return new Ct(t,n)}var pe={CanoeImage:new X("canoe",ie,void 0,"raw://canoe.png"),PierImage:new X("pier",ie,void 0,"raw://pier.png"),PierLegImage:new X("pierLeg",ie,void 0,"raw://pier_leg.png"),BucketImage:new X("bucket",ie,void 0,"raw://bucket.png"),MusicBack:new X("musicBack",Lt,void 0,"raw://music_back.wav"),MusicLayer1:new X("musicLayer1",Lt,void 0,"raw://music_1.wav"),MusicLayer2:new X("musicLayer2",Lt,void 0,"raw://music_2.wav")};async function Ni(e){await bi(e,"res.pack"),await ce(e,Object.values(pe))}function ve(e){return typeof WebGL2RenderingContext!="undefined"&&e instanceof WebGL2RenderingContext}var Cn=class{constructor(t,n){this.gl=t,this.target=n}data(t,n=void 0){let r=this.gl,i=this.target;if(typeof t=="number")r.bufferData(i,t,n||r.STATIC_DRAW);else{if(!ArrayBuffer.isView(t))throw new Error("Source data must be a typed array.");r.bufferData(i,t,n||r.STATIC_DRAW)}return this}subData(t,n=0,r=void 0,i=void 0){let s=this.gl,a=this.target;if(ArrayBuffer.isView(t))if(typeof r!="undefined")if(ve(s))s.bufferSubData(a,n,t,r,i);else{let o=i?t.subarray(r,r+i):t.subarray(r);s.bufferSubData(a,n,o)}else s.bufferSubData(a,n,t);else throw new Error("Source data must be a typed array.");return this}},Oi=class{constructor(t,n,r=void 0){this.dataContext=new Cn(t,n),this.handle=r||t.createBuffer(),t.bindBuffer(n,this.handle)}get gl(){return this.dataContext.gl}get target(){return this.dataContext.target}data(t,n=void 0){return this.dataContext.data(t,n),this}subData(t,n=0,r=void 0,i=void 0){return this.dataContext.subData(t,n,r,i),this}build(){return this.handle}},Bi=class{constructor(t,n,r,i){this.gl=t,this.target=n,this.handle=i,this.type=r,this.bindContext=new Cn(t,this.target)}bind(t){return t.bindBuffer(this.target,this.handle),this.bindContext.gl=t,this.bindContext}},Oe={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,HALF_FLOAT:5131};function sc(e,t,n){let r=Ln(e,t);return new r(n)}function ac(e,t,n,r=e.STATIC_DRAW){if(!ArrayBuffer.isView(n))throw new Error("Source data must be a typed array.");let i=e.createBuffer();return e.bindBuffer(t,i),e.bufferData(t,n,r),i}function Ln(e,t){switch(t){case e.BYTE:return Int8Array;case e.UNSIGNED_BYTE:return Uint8Array;case e.SHORT:return Int16Array;case e.UNSIGNED_SHORT:return Uint16Array;case e.INT:return Int32Array;case e.UNSIGNED_INT:return Uint32Array;case e.FLOAT:return Float32Array;default:throw new Error(`Cannot find valid typed array for buffer type '${t}'.`)}}function it(e,t){if(t instanceof Int8Array)return e.BYTE;if(t instanceof Uint8Array)return e.UNSIGNED_BYTE;if(t instanceof Int16Array)return e.SHORT;if(t instanceof Uint16Array)return e.UNSIGNED_SHORT;if(t instanceof Int32Array)return e.INT;if(t instanceof Uint32Array)return e.UNSIGNED_INT;if(t instanceof Float32Array)return e.FLOAT;throw new Error("Cannot find valid data type for buffer source.")}var oc={[Oe.BYTE]:1,[Oe.UNSIGNED_BYTE]:1,[Oe.SHORT]:2,[Oe.UNSIGNED_SHORT]:2,[Oe.INT]:4,[Oe.UNSIGNED_INT]:4,[Oe.FLOAT]:4,[Oe.HALF_FLOAT]:2};function Nt(e,t){return oc[t]}function lc(e,t){switch(t){case Int8Array:return e.BYTE;case Uint8Array:return e.UNSIGNED_BYTE;case Int16Array:return e.SHORT;case Uint16Array:return e.UNSIGNED_SHORT;case Int32Array:return e.INT;case Uint32Array:return e.UNSIGNED_INT;case Float32Array:return e.FLOAT;default:throw new Error("Cannot find valid buffer type for typed array.")}}function cc(e,t,n){return e.bindBuffer(t,n),e.getBufferParameter(t,e.BUFFER_USAGE)}function Pi(e,t,n){return e.bindBuffer(t,n),e.getBufferParameter(t,e.BUFFER_SIZE)}function hc(e,t,n,r){return Math.trunc(Pi(e,t,n)/Nt(e,r))}var we=class{constructor(t,n,r=void 0){this.bufferBuilder=new Oi(t,n,r),this.bufferType=t.FLOAT}get gl(){return this.bufferBuilder.gl}get handle(){return this.bufferBuilder.handle}get target(){return this.bufferBuilder.target}data(t,n=void 0){return this.bufferBuilder.data(t,n),typeof t!="number"&&(this.bufferType=it(this.gl,t)),this}subData(t,n=void 0,r=void 0,i=void 0){return this.bufferBuilder.subData(t,n,r,i),this.bufferType=it(this.gl,t),this}build(){let t=this.bufferBuilder.build(),n=this.gl,r=this.target,i=this.bufferType;return new Bi(n,r,i,t)}};function fc(e,t){let n=[],r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<r;++i){let s=e.getActiveUniform(t,i);if(!s)break;n.push(s)}return n}function uc(e,t){let n=[],r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<r;++i){let s=e.getActiveAttrib(t,i);!s||n.push(s)}return n}function Ot(e,t){switch(t){case e.FLOAT:case e.INT:case e.UNSIGNED_INT:case e.BOOL:return 1;case e.FLOAT_VEC2:case e.INT_VEC2:case e.BOOL_VEC2:return 2;case e.FLOAT_VEC3:case e.INT_VEC3:case e.BOOL_VEC3:return 3;case e.FLOAT_VEC4:case e.INT_VEC4:case e.BOOL_VEC4:return 4;case e.FLOAT_MAT2:return 4;case e.FLOAT_MAT3:return 9;case e.FLOAT_MAT4:return 16;default:throw new Error("Invalid vertex attribute type.")}}function pc(e,t){switch(t){case e.FLOAT:case e.FLOAT_VEC2:case e.FLOAT_VEC3:case e.FLOAT_VEC4:return dc}if(ve(e)){let n=e;switch(t){case e.INT:case e.INT_VEC2:case e.INT_VEC3:case e.INT_VEC4:case e.BOOL:case e.BOOL_VEC2:case e.BOOL_VEC3:case e.BOOL_VEC4:return mc;case e.FLOAT_MAT2:return xc;case e.FLOAT_MAT3:return gc;case e.FLOAT_MAT4:return yc;case n.UNSIGNED_INT:case n.UNSIGNED_INT_VEC2:case n.UNSIGNED_INT_VEC3:case n.UNSIGNED_INT_VEC4:return vc}}throw new Error("Cannot find attribute function for gl enum.")}function dc(e,t,n,r,i=!1,s=0,a=0,o=void 0){if(this.bindBuffer(this.ARRAY_BUFFER,t),this.enableVertexAttribArray(e),this.vertexAttribPointer(e,n,r,i,s,a),o!==void 0){if(!ve(this))throw new Error("Cannot use attribute divisor in WebGL 1.");this.vertexAttribDivisor(e,o)}}function mc(e,t,n,r,i=!1,s=0,a=0,o=void 0){if(!ve(this))throw new Error("Cannot use attribute divisor in WebGL 1.");let l=this;l.bindBuffer(l.ARRAY_BUFFER,t),l.enableVertexAttribArray(e),l.vertexAttribIPointer(e,n,r,s,a),o!==void 0&&l.vertexAttribDivisor(e,o)}function vc(e,t,n,r,i=!1,s=0,a=0,o=void 0){if(!ve(this))throw new Error("Cannot use attribute divisor in WebGL 1.");let l=this;l.bindBuffer(l.ARRAY_BUFFER,t),l.enableVertexAttribArray(e),l.vertexAttribIPointer(e,n,r,s,a),o!==void 0&&l.vertexAttribDivisor(e,o)}function xc(e,t,n,r,i=!1,s=0,a=0,o=void 0){let l=Ot(this,this.FLOAT_MAT2),c=l*l;Nn(c,l,e,t,n,r,i,s,a,o)}function gc(e,t,n,r,i=!1,s=0,a=0,o=void 0){let l=Ot(this,this.FLOAT_MAT3),c=l*l;Nn(c,l,e,t,n,r,i,s,a,o)}function yc(e,t,n,r,i=!1,s=0,a=0,o=void 0){let l=Ot(this,this.FLOAT_MAT4),c=l*l;Nn(c,l,e,t,n,r,i,s,a,o)}function Nn(e,t,n,r,i,s,a,o,l,c){if(!ve(this))throw new Error("Cannot use attribute divisor in WebGL 1.");let h=this;h.bindBuffer(h.ARRAY_BUFFER,r);let f=i/t,u=e*i,p=o/t;for(let d=0;d<t;++d){let v=n+d;h.enableVertexAttribArray(v),h.vertexAttribPointer(v,f,s,a,u,l+p*d),c!==void 0&&h.vertexAttribDivisor(v,c)}}function _c(e,t){let n={},r=uc(e,t);for(let i of r){let s=i.name,a=i.size,o=i.type,l=e.getAttribLocation(t,s),c=pc(e,o),h=Ot(e,o);n[s]={type:o,length:a,location:l,size:h,applier:c,set value([f,u,p,d,v,m,E]){this.applier(this.location,f,u,p,d,v,m,E)}}}return n}function Ec(e,t,n){let r=e.createShader(t);if(e.shaderSource(r,n),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS)){let s=e.getShaderInfoLog(r)+`
Failed to compile shader:
${n}`;throw e.deleteShader(r),new Error(s)}return r}async function Ac(e,t,n){for(let s of n)e.attachShader(t,s);e.linkProgram(t);let r=e.getExtension("KHR_parallel_shader_compile");if(r){let s=1e3/60,a;do await new Promise((o,l)=>setTimeout(o,s)),a=e.getProgramParameter(t,r.COMPLETION_STATUS_KHR);while(!a)}for(let s of n)e.detachShader(t,s),e.deleteShader(s);if(!e.getProgramParameter(t,e.LINK_STATUS)){let s=e.getProgramInfoLog(t);throw e.deleteProgram(t),new Error(s)}return t}function wc(e,t,n,r,i=void 0){i?(e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,i),e.drawElements(t,r,e.UNSIGNED_SHORT,n)):e.drawArrays(t,n,r)}function bc(e,t){let n=e;switch(t){case n.FLOAT:return n.uniform1f;case n.FLOAT_VEC2:return n.uniform2fv;case n.FLOAT_VEC3:return n.uniform3fv;case n.FLOAT_VEC4:return n.uniform4fv;case n.INT:return n.uniform1i;case n.INT_VEC2:return n.uniform2iv;case n.INT_VEC3:return n.uniform3iv;case n.INT_VEC4:return n.uniform4iv;case n.BOOL:return n.uniform1i;case n.BOOL_VEC2:return n.uniform2iv;case n.BOOL_VEC3:return n.uniform3iv;case n.BOOL_VEC4:return n.uniform4iv;case n.FLOAT_MAT2:return Tc;case n.FLOAT_MAT3:return Mc;case n.FLOAT_MAT4:return Sc;case n.SAMPLER_2D:case n.SAMPLER_CUBE:return n.uniform1i}if(ve(e)){let r=e;switch(t){case r.UNSIGNED_INT:return r.uniform1ui;case r.UNSIGNED_INT_VEC2:return r.uniform2uiv;case r.UNSIGNED_INT_VEC3:return r.uniform3uiv;case r.UNSIGNED_INT_VEC4:return r.uniform4uiv;case r.FLOAT_MAT2x3:return Rc;case r.FLOAT_MAT2x4:return Ic;case r.FLOAT_MAT3x2:return Cc;case r.FLOAT_MAT3x4:return Lc;case r.FLOAT_MAT4x2:return Nc;case r.FLOAT_MAT4x3:return Oc;case r.SAMPLER_3D:case r.SAMPLER_2D_SHADOW:case r.SAMPLER_2D_ARRAY:case r.SAMPLER_2D_ARRAY_SHADOW:case r.SAMPLER_CUBE_SHADOW:case r.INT_SAMPLER_2D:case r.INT_SAMPLER_3D:case r.INT_SAMPLER_CUBE:case r.INT_SAMPLER_2D_ARRAY:case r.UNSIGNED_INT_SAMPLER_2D:case r.UNSIGNED_INT_SAMPLER_3D:case r.UNSIGNED_INT_SAMPLER_CUBE:case r.UNSIGNED_INT_SAMPLER_2D_ARRAY:return r.uniform1i}}throw new Error("Cannot find uniform function for gl enum.")}function Tc(e,t){this.uniformMatrix2fv(e,!1,t)}function Mc(e,t){this.uniformMatrix3fv(e,!1,t)}function Sc(e,t){this.uniformMatrix4fv(e,!1,t)}function Rc(e,t){this.uniformMatrix2x3fv(e,!1,t)}function Ic(e,t){this.uniformMatrix2x4fv(e,!1,t)}function Cc(e,t){this.uniformMatrix3x2fv(e,!1,t)}function Lc(e,t){this.uniformMatrix3x4fv(e,!1,t)}function Nc(e,t){this.uniformMatrix4x2fv(e,!1,t)}function Oc(e,t){this.uniformMatrix4x3fv(e,!1,t)}function Bc(e,t){let n={},r=fc(e,t);for(let i of r){let s=i.name,a=i.size,o=i.type,l=e.getUniformLocation(t,s),c=bc(e,o);n[s]={type:o,length:a,location:l,applier:c,set value(h){this.applier.call(e,this.location,h)}}}return n}function Pc(e,t,n){if("handle"in n&&n.handle instanceof WebGLVertexArrayObject){if(!ve(e))throw new Error("Vertex array objects are only supported in WebGL 2.");let r=e,i=n;r.bindVertexArray(i.handle)}else{let r=n,i=t.attributes;for(let s in i){if(!(s in r.attributes))throw new Error(`Missing buffer for attribute '${s}'.`);let a=r.attributes[s],{location:o,applier:l}=i[a.name];l.call(e,o,a.buffer,a.size,a.type,a.normalize,a.stride,a.offset,a.divisor)}r.element&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r.element.buffer)}}function Fc(e,t,n=void 0){let r=Hc(e,t),i=kc(e,n),s;if(i)s=i.length;else{let a=Object.keys(r);if(a.length>0){let o=r[a[0]];s=Math.trunc(o.length/o.size)}else s=0}return{attributes:r,element:i,vertexCount:s}}function Dc(e,t,n){if(!ve(e))throw new Error("Vertex array objects is only supported on WebGL2.");let r=e,i=r.createVertexArray();r.bindVertexArray(i);for(let s of n)Pc(r,s,t);return r.bindVertexArray(null),{handle:i,element:t.element,vertexCount:t.vertexCount}}function Uc(e,t,n=e.TRIANGLES,r=0,i=t.vertexCount,s=void 0){let a=t.element;if(a){let o=a.type;if(s!==void 0){if(!ve(e))throw new Error("Instanced element drawing is only supported on WebGL2.");e.drawElementsInstanced(n,i,o,r,s)}else e.drawElements(n,i,o,r)}else if(s!==void 0){if(!ve(e))throw new Error("Instanced array drawing is only supported on WebGL2.");e.drawArraysInstanced(n,r,i,s)}else e.drawArrays(n,r,i)}function kc(e,t=void 0){if(!t)return null;if(typeof t!="object")throw new Error("Element attribute options must be an object.");let{type:n=e.UNSIGNED_SHORT,buffer:r,usage:i=e.STATIC_DRAW,length:s}=t;if(r instanceof WebGLBuffer)e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r);else if(ArrayBuffer.isView(r)){let a=r;r=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r),e.bufferData(e.ELEMENT_ARRAY_BUFFER,a,i),n===void 0&&(n=it(e,a)),s===void 0&&(s=a.length)}else if(Array.isArray(r)){let a=r;r=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(a),i),s===void 0&&(s=a.length)}else if(typeof r=="number"){let a=r;r=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r),e.bufferData(e.ELEMENT_ARRAY_BUFFER,a,i),s===void 0&&(s=a)}else throw new Error("Invalid buffer for element attribute options.");if(n===void 0&&(n=e.UNSIGNED_SHORT),s===void 0){let a=e.getBufferParameter(e.ELEMENT_ARRAY_BUFFER,e.BUFFER_SIZE);s=Math.trunc(a/Nt(e,n))}return Yc(r,n,s)}function Hc(e,t){let n={};for(let r of Object.keys(t)){let i=t[r];if(!i)continue;if(typeof i!="object")throw new Error("Array attribute options must be an object.");let{name:s=r,buffer:a,size:o=3,type:l,normalize:c=!1,stride:h=0,offset:f=0,divisor:u=void 0,usage:p=e.STATIC_DRAW,length:d}=i;if(a instanceof WebGLBuffer)e.bindBuffer(e.ARRAY_BUFFER,a);else if(ArrayBuffer.isView(a)){let v=a;a=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,a),e.bufferData(e.ARRAY_BUFFER,v,p),l===void 0&&(l=it(e,v)),d===void 0&&(d=v.length)}else if(Array.isArray(a)){let v=a;l===void 0&&(l=e.FLOAT),d===void 0&&(d=v.length),a=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,a);let m=Ln(e,l);e.bufferData(e.ARRAY_BUFFER,new m(v),p)}else if(typeof a=="number"){let v=a;a=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,a),e.bufferData(e.ARRAY_BUFFER,v,p),d===void 0&&(d=v)}else throw new Error(`Invalid buffer '${a}' for array attribute options.`);if(l===void 0&&(l=e.FLOAT),d===void 0){let v=e.getBufferParameter(e.ARRAY_BUFFER,e.BUFFER_SIZE);d=Math.trunc(v/Nt(e,l))}o===void 0&&(o=zc(s,d)),n[s]=Gc(s,a,d,o,l,c,h,f,u)}return n}function zc(e,t){let n;if(e.includes("texcoord")?n=2:e.includes("color")?n=4:n=3,t%n!=0)throw new Error(`Could not determine vertex size - guessed ${n} but array length ${t} is not evenly divisible.`);return n}function Yc(e,t,n){return{buffer:e,type:t,length:n}}function Gc(e,t,n,r,i,s,a,o,l){return{name:e,buffer:t,length:n,size:r,type:i,normalize:s,stride:a,offset:o,divisor:l}}var Ie=Object.freeze({__proto__:null,createBuffer:ac,createBufferInfo:Fc,createBufferSource:sc,createVertexArrayInfo:Dc,drawBufferInfo:Uc,getBufferByteCount:Pi,getBufferLength:hc,getBufferTypeForBufferSource:it,getBufferTypeForTypedArray:lc,getBufferUsage:cc,getByteCountForBufferType:Nt,getTypedArrayForBufferType:Ln}),Fi=class{constructor(t,n){this.handle=n,this.activeUniforms=Bc(t,n),this.activeAttributes=_c(t,n),this.drawContext=new Di(t,this)}bind(t){return t.useProgram(this.handle),this.drawContext.gl=t,this.drawContext}},Di=class{constructor(t,n){this.gl=t,this.parent=n}uniform(t,n){let r=this.parent.activeUniforms;if(t in r){let i=r[t],s=i.location;i.applier.call(this.gl,s,n)}return this}attribute(t,n,r,i=!1,s=0,a=0){let o=this.gl,l=this.parent.activeAttributes;if(t in l){let c=l[t],h=c.location,f=c.size;r?(o.bindBuffer(o.ARRAY_BUFFER,r),o.vertexAttribPointer(h,f,n,i,s,a),o.enableVertexAttribArray(h)):o.disableVertexAttribArray(h)}return this}draw(t,n,r,i,s=null){return wc(t,n,r,i,s),this.parent}},Ui=class{constructor(t,n=void 0){this.handle=n||t.createProgram(),this.shaders=[],this.gl=t}shader(t,n){let r=this.gl,i=Ec(r,t,n);return this.shaders.push(i),this}link(){let t=this.gl;return Ac(t,this.handle,this.shaders),this.shaders.length=0,this.handle}},ke=class{constructor(t,n=void 0){this.programBuilder=new Ui(t,n)}get gl(){return this.programBuilder.gl}get handle(){return this.programBuilder.handle}get shaders(){return this.programBuilder.shaders}shader(t,n){return this.programBuilder.shader(t,n),this}link(){let t=this.programBuilder.link();return new Fi(this.gl,t)}};var U=1e-6,V=typeof Float32Array!="undefined"?Float32Array:Array,he=Math.random;var e0=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var st={};Fe(st,{add:()=>uh,adjoint:()=>Zc,clone:()=>Vc,copy:()=>Kc,create:()=>On,determinant:()=>Jc,equals:()=>vh,exactEquals:()=>mh,frob:()=>fh,fromMat2d:()=>ah,fromMat4:()=>$c,fromQuat:()=>oh,fromRotation:()=>ih,fromScaling:()=>sh,fromTranslation:()=>rh,fromValues:()=>Wc,identity:()=>qc,invert:()=>Qc,mul:()=>xh,multiply:()=>ki,multiplyScalar:()=>ph,multiplyScalarAndAdd:()=>dh,normalFromMat4:()=>lh,projection:()=>ch,rotate:()=>th,scale:()=>nh,set:()=>jc,str:()=>hh,sub:()=>gh,subtract:()=>Hi,translate:()=>eh,transpose:()=>Xc});function On(){var e=new V(9);return V!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function $c(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function Vc(e){var t=new V(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Kc(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Wc(e,t,n,r,i,s,a,o,l){var c=new V(9);return c[0]=e,c[1]=t,c[2]=n,c[3]=r,c[4]=i,c[5]=s,c[6]=a,c[7]=o,c[8]=l,c}function jc(e,t,n,r,i,s,a,o,l,c){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=s,e[5]=a,e[6]=o,e[7]=l,e[8]=c,e}function qc(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Xc(e,t){if(e===t){var n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function Qc(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8],f=h*a-o*c,u=-h*s+o*l,p=c*s-a*l,d=n*f+r*u+i*p;return d?(d=1/d,e[0]=f*d,e[1]=(-h*r+i*c)*d,e[2]=(o*r-i*a)*d,e[3]=u*d,e[4]=(h*n-i*l)*d,e[5]=(-o*n+i*s)*d,e[6]=p*d,e[7]=(-c*n+r*l)*d,e[8]=(a*n-r*s)*d,e):null}function Zc(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8];return e[0]=a*h-o*c,e[1]=i*c-r*h,e[2]=r*o-i*a,e[3]=o*l-s*h,e[4]=n*h-i*l,e[5]=i*s-n*o,e[6]=s*c-a*l,e[7]=r*l-n*c,e[8]=n*a-r*s,e}function Jc(e){var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8];return t*(c*s-a*l)+n*(-c*i+a*o)+r*(l*i-s*o)}function ki(e,t,n){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],f=t[8],u=n[0],p=n[1],d=n[2],v=n[3],m=n[4],E=n[5],C=n[6],w=n[7],S=n[8];return e[0]=u*r+p*a+d*c,e[1]=u*i+p*o+d*h,e[2]=u*s+p*l+d*f,e[3]=v*r+m*a+E*c,e[4]=v*i+m*o+E*h,e[5]=v*s+m*l+E*f,e[6]=C*r+w*a+S*c,e[7]=C*i+w*o+S*h,e[8]=C*s+w*l+S*f,e}function eh(e,t,n){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],f=t[8],u=n[0],p=n[1];return e[0]=r,e[1]=i,e[2]=s,e[3]=a,e[4]=o,e[5]=l,e[6]=u*r+p*a+c,e[7]=u*i+p*o+h,e[8]=u*s+p*l+f,e}function th(e,t,n){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],f=t[8],u=Math.sin(n),p=Math.cos(n);return e[0]=p*r+u*a,e[1]=p*i+u*o,e[2]=p*s+u*l,e[3]=p*a-u*r,e[4]=p*o-u*i,e[5]=p*l-u*s,e[6]=c,e[7]=h,e[8]=f,e}function nh(e,t,n){var r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function rh(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function ih(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=-n,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function sh(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function ah(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function oh(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=n+n,o=r+r,l=i+i,c=n*a,h=r*a,f=r*o,u=i*a,p=i*o,d=i*l,v=s*a,m=s*o,E=s*l;return e[0]=1-f-d,e[3]=h-E,e[6]=u+m,e[1]=h+E,e[4]=1-c-d,e[7]=p-v,e[2]=u-m,e[5]=p+v,e[8]=1-c-f,e}function lh(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8],f=t[9],u=t[10],p=t[11],d=t[12],v=t[13],m=t[14],E=t[15],C=n*o-r*a,w=n*l-i*a,S=n*c-s*a,T=r*l-i*o,g=r*c-s*o,N=i*c-s*l,A=h*v-f*d,M=h*m-u*d,B=h*E-p*d,x=f*m-u*v,F=f*E-p*v,D=u*E-p*m,P=C*D-w*F+S*x+T*B-g*M+N*A;return P?(P=1/P,e[0]=(o*D-l*F+c*x)*P,e[1]=(l*B-a*D-c*M)*P,e[2]=(a*F-o*B+c*A)*P,e[3]=(i*F-r*D-s*x)*P,e[4]=(n*D-i*B+s*M)*P,e[5]=(r*B-n*F-s*A)*P,e[6]=(v*N-m*g+E*T)*P,e[7]=(m*S-d*N-E*w)*P,e[8]=(d*g-v*S+E*C)*P,e):null}function ch(e,t,n){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/n,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function hh(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function fh(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}function uh(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e}function Hi(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e}function ph(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e}function dh(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e}function mh(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function vh(e,t){var n=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],h=e[8],f=t[0],u=t[1],p=t[2],d=t[3],v=t[4],m=t[5],E=t[6],C=t[7],w=t[8];return Math.abs(n-f)<=U*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(r-u)<=U*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(i-p)<=U*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(s-d)<=U*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(a-v)<=U*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(o-m)<=U*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(l-E)<=U*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(c-C)<=U*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(h-w)<=U*Math.max(1,Math.abs(h),Math.abs(w))}var xh=ki,gh=Hi;var $={};Fe($,{add:()=>nf,adjoint:()=>Mh,clone:()=>_h,copy:()=>Eh,create:()=>yh,determinant:()=>Sh,equals:()=>of,exactEquals:()=>af,frob:()=>tf,fromQuat:()=>Vh,fromQuat2:()=>Hh,fromRotation:()=>Fh,fromRotationTranslation:()=>Gi,fromRotationTranslationScale:()=>Gh,fromRotationTranslationScaleOrigin:()=>$h,fromScaling:()=>Ph,fromTranslation:()=>Bh,fromValues:()=>Ah,fromXRotation:()=>Dh,fromYRotation:()=>Uh,fromZRotation:()=>kh,frustum:()=>Kh,getRotation:()=>Yh,getScaling:()=>$i,getTranslation:()=>zh,identity:()=>zi,invert:()=>Th,lookAt:()=>Zh,mul:()=>lf,multiply:()=>Yi,multiplyScalar:()=>rf,multiplyScalarAndAdd:()=>sf,ortho:()=>Xh,orthoNO:()=>Ki,orthoZO:()=>Qh,perspective:()=>Wh,perspectiveFromFieldOfView:()=>qh,perspectiveNO:()=>Vi,perspectiveZO:()=>jh,rotate:()=>Ch,rotateX:()=>Lh,rotateY:()=>Nh,rotateZ:()=>Oh,scale:()=>Ih,set:()=>wh,str:()=>ef,sub:()=>cf,subtract:()=>Wi,targetTo:()=>Jh,translate:()=>Rh,transpose:()=>bh});function yh(){var e=new V(16);return V!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function _h(e){var t=new V(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Eh(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Ah(e,t,n,r,i,s,a,o,l,c,h,f,u,p,d,v){var m=new V(16);return m[0]=e,m[1]=t,m[2]=n,m[3]=r,m[4]=i,m[5]=s,m[6]=a,m[7]=o,m[8]=l,m[9]=c,m[10]=h,m[11]=f,m[12]=u,m[13]=p,m[14]=d,m[15]=v,m}function wh(e,t,n,r,i,s,a,o,l,c,h,f,u,p,d,v,m){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=s,e[5]=a,e[6]=o,e[7]=l,e[8]=c,e[9]=h,e[10]=f,e[11]=u,e[12]=p,e[13]=d,e[14]=v,e[15]=m,e}function zi(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function bh(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],s=t[6],a=t[7],o=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=s,e[11]=t[14],e[12]=i,e[13]=a,e[14]=o}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function Th(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8],f=t[9],u=t[10],p=t[11],d=t[12],v=t[13],m=t[14],E=t[15],C=n*o-r*a,w=n*l-i*a,S=n*c-s*a,T=r*l-i*o,g=r*c-s*o,N=i*c-s*l,A=h*v-f*d,M=h*m-u*d,B=h*E-p*d,x=f*m-u*v,F=f*E-p*v,D=u*E-p*m,P=C*D-w*F+S*x+T*B-g*M+N*A;return P?(P=1/P,e[0]=(o*D-l*F+c*x)*P,e[1]=(i*F-r*D-s*x)*P,e[2]=(v*N-m*g+E*T)*P,e[3]=(u*g-f*N-p*T)*P,e[4]=(l*B-a*D-c*M)*P,e[5]=(n*D-i*B+s*M)*P,e[6]=(m*S-d*N-E*w)*P,e[7]=(h*N-u*S+p*w)*P,e[8]=(a*F-o*B+c*A)*P,e[9]=(r*B-n*F-s*A)*P,e[10]=(d*g-v*S+E*C)*P,e[11]=(f*S-h*g-p*C)*P,e[12]=(o*M-a*x-l*A)*P,e[13]=(n*x-r*M+i*A)*P,e[14]=(v*w-d*T-m*C)*P,e[15]=(h*T-f*w+u*C)*P,e):null}function Mh(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8],f=t[9],u=t[10],p=t[11],d=t[12],v=t[13],m=t[14],E=t[15];return e[0]=o*(u*E-p*m)-f*(l*E-c*m)+v*(l*p-c*u),e[1]=-(r*(u*E-p*m)-f*(i*E-s*m)+v*(i*p-s*u)),e[2]=r*(l*E-c*m)-o*(i*E-s*m)+v*(i*c-s*l),e[3]=-(r*(l*p-c*u)-o*(i*p-s*u)+f*(i*c-s*l)),e[4]=-(a*(u*E-p*m)-h*(l*E-c*m)+d*(l*p-c*u)),e[5]=n*(u*E-p*m)-h*(i*E-s*m)+d*(i*p-s*u),e[6]=-(n*(l*E-c*m)-a*(i*E-s*m)+d*(i*c-s*l)),e[7]=n*(l*p-c*u)-a*(i*p-s*u)+h*(i*c-s*l),e[8]=a*(f*E-p*v)-h*(o*E-c*v)+d*(o*p-c*f),e[9]=-(n*(f*E-p*v)-h*(r*E-s*v)+d*(r*p-s*f)),e[10]=n*(o*E-c*v)-a*(r*E-s*v)+d*(r*c-s*o),e[11]=-(n*(o*p-c*f)-a*(r*p-s*f)+h*(r*c-s*o)),e[12]=-(a*(f*m-u*v)-h*(o*m-l*v)+d*(o*u-l*f)),e[13]=n*(f*m-u*v)-h*(r*m-i*v)+d*(r*u-i*f),e[14]=-(n*(o*m-l*v)-a*(r*m-i*v)+d*(r*l-i*o)),e[15]=n*(o*u-l*f)-a*(r*u-i*f)+h*(r*l-i*o),e}function Sh(e){var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],h=e[9],f=e[10],u=e[11],p=e[12],d=e[13],v=e[14],m=e[15],E=t*a-n*s,C=t*o-r*s,w=t*l-i*s,S=n*o-r*a,T=n*l-i*a,g=r*l-i*o,N=c*d-h*p,A=c*v-f*p,M=c*m-u*p,B=h*v-f*d,x=h*m-u*d,F=f*m-u*v;return E*F-C*x+w*B+S*M-T*A+g*N}function Yi(e,t,n){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],f=t[8],u=t[9],p=t[10],d=t[11],v=t[12],m=t[13],E=t[14],C=t[15],w=n[0],S=n[1],T=n[2],g=n[3];return e[0]=w*r+S*o+T*f+g*v,e[1]=w*i+S*l+T*u+g*m,e[2]=w*s+S*c+T*p+g*E,e[3]=w*a+S*h+T*d+g*C,w=n[4],S=n[5],T=n[6],g=n[7],e[4]=w*r+S*o+T*f+g*v,e[5]=w*i+S*l+T*u+g*m,e[6]=w*s+S*c+T*p+g*E,e[7]=w*a+S*h+T*d+g*C,w=n[8],S=n[9],T=n[10],g=n[11],e[8]=w*r+S*o+T*f+g*v,e[9]=w*i+S*l+T*u+g*m,e[10]=w*s+S*c+T*p+g*E,e[11]=w*a+S*h+T*d+g*C,w=n[12],S=n[13],T=n[14],g=n[15],e[12]=w*r+S*o+T*f+g*v,e[13]=w*i+S*l+T*u+g*m,e[14]=w*s+S*c+T*p+g*E,e[15]=w*a+S*h+T*d+g*C,e}function Rh(e,t,n){var r=n[0],i=n[1],s=n[2],a,o,l,c,h,f,u,p,d,v,m,E;return t===e?(e[12]=t[0]*r+t[4]*i+t[8]*s+t[12],e[13]=t[1]*r+t[5]*i+t[9]*s+t[13],e[14]=t[2]*r+t[6]*i+t[10]*s+t[14],e[15]=t[3]*r+t[7]*i+t[11]*s+t[15]):(a=t[0],o=t[1],l=t[2],c=t[3],h=t[4],f=t[5],u=t[6],p=t[7],d=t[8],v=t[9],m=t[10],E=t[11],e[0]=a,e[1]=o,e[2]=l,e[3]=c,e[4]=h,e[5]=f,e[6]=u,e[7]=p,e[8]=d,e[9]=v,e[10]=m,e[11]=E,e[12]=a*r+h*i+d*s+t[12],e[13]=o*r+f*i+v*s+t[13],e[14]=l*r+u*i+m*s+t[14],e[15]=c*r+p*i+E*s+t[15]),e}function Ih(e,t,n){var r=n[0],i=n[1],s=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Ch(e,t,n,r){var i=r[0],s=r[1],a=r[2],o=Math.hypot(i,s,a),l,c,h,f,u,p,d,v,m,E,C,w,S,T,g,N,A,M,B,x,F,D,P,y;return o<U?null:(o=1/o,i*=o,s*=o,a*=o,l=Math.sin(n),c=Math.cos(n),h=1-c,f=t[0],u=t[1],p=t[2],d=t[3],v=t[4],m=t[5],E=t[6],C=t[7],w=t[8],S=t[9],T=t[10],g=t[11],N=i*i*h+c,A=s*i*h+a*l,M=a*i*h-s*l,B=i*s*h-a*l,x=s*s*h+c,F=a*s*h+i*l,D=i*a*h+s*l,P=s*a*h-i*l,y=a*a*h+c,e[0]=f*N+v*A+w*M,e[1]=u*N+m*A+S*M,e[2]=p*N+E*A+T*M,e[3]=d*N+C*A+g*M,e[4]=f*B+v*x+w*F,e[5]=u*B+m*x+S*F,e[6]=p*B+E*x+T*F,e[7]=d*B+C*x+g*F,e[8]=f*D+v*P+w*y,e[9]=u*D+m*P+S*y,e[10]=p*D+E*P+T*y,e[11]=d*D+C*P+g*y,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function Lh(e,t,n){var r=Math.sin(n),i=Math.cos(n),s=t[4],a=t[5],o=t[6],l=t[7],c=t[8],h=t[9],f=t[10],u=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*i+c*r,e[5]=a*i+h*r,e[6]=o*i+f*r,e[7]=l*i+u*r,e[8]=c*i-s*r,e[9]=h*i-a*r,e[10]=f*i-o*r,e[11]=u*i-l*r,e}function Nh(e,t,n){var r=Math.sin(n),i=Math.cos(n),s=t[0],a=t[1],o=t[2],l=t[3],c=t[8],h=t[9],f=t[10],u=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i-c*r,e[1]=a*i-h*r,e[2]=o*i-f*r,e[3]=l*i-u*r,e[8]=s*r+c*i,e[9]=a*r+h*i,e[10]=o*r+f*i,e[11]=l*r+u*i,e}function Oh(e,t,n){var r=Math.sin(n),i=Math.cos(n),s=t[0],a=t[1],o=t[2],l=t[3],c=t[4],h=t[5],f=t[6],u=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i+c*r,e[1]=a*i+h*r,e[2]=o*i+f*r,e[3]=l*i+u*r,e[4]=c*i-s*r,e[5]=h*i-a*r,e[6]=f*i-o*r,e[7]=u*i-l*r,e}function Bh(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Ph(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Fh(e,t,n){var r=n[0],i=n[1],s=n[2],a=Math.hypot(r,i,s),o,l,c;return a<U?null:(a=1/a,r*=a,i*=a,s*=a,o=Math.sin(t),l=Math.cos(t),c=1-l,e[0]=r*r*c+l,e[1]=i*r*c+s*o,e[2]=s*r*c-i*o,e[3]=0,e[4]=r*i*c-s*o,e[5]=i*i*c+l,e[6]=s*i*c+r*o,e[7]=0,e[8]=r*s*c+i*o,e[9]=i*s*c-r*o,e[10]=s*s*c+l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function Dh(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Uh(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function kh(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Gi(e,t,n){var r=t[0],i=t[1],s=t[2],a=t[3],o=r+r,l=i+i,c=s+s,h=r*o,f=r*l,u=r*c,p=i*l,d=i*c,v=s*c,m=a*o,E=a*l,C=a*c;return e[0]=1-(p+v),e[1]=f+C,e[2]=u-E,e[3]=0,e[4]=f-C,e[5]=1-(h+v),e[6]=d+m,e[7]=0,e[8]=u+E,e[9]=d-m,e[10]=1-(h+p),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function Hh(e,t){var n=new V(3),r=-t[0],i=-t[1],s=-t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],f=r*r+i*i+s*s+a*a;return f>0?(n[0]=(o*a+h*r+l*s-c*i)*2/f,n[1]=(l*a+h*i+c*r-o*s)*2/f,n[2]=(c*a+h*s+o*i-l*r)*2/f):(n[0]=(o*a+h*r+l*s-c*i)*2,n[1]=(l*a+h*i+c*r-o*s)*2,n[2]=(c*a+h*s+o*i-l*r)*2),Gi(e,t,n),e}function zh(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function $i(e,t){var n=t[0],r=t[1],i=t[2],s=t[4],a=t[5],o=t[6],l=t[8],c=t[9],h=t[10];return e[0]=Math.hypot(n,r,i),e[1]=Math.hypot(s,a,o),e[2]=Math.hypot(l,c,h),e}function Yh(e,t){var n=new V(3);$i(n,t);var r=1/n[0],i=1/n[1],s=1/n[2],a=t[0]*r,o=t[1]*i,l=t[2]*s,c=t[4]*r,h=t[5]*i,f=t[6]*s,u=t[8]*r,p=t[9]*i,d=t[10]*s,v=a+h+d,m=0;return v>0?(m=Math.sqrt(v+1)*2,e[3]=.25*m,e[0]=(f-p)/m,e[1]=(u-l)/m,e[2]=(o-c)/m):a>h&&a>d?(m=Math.sqrt(1+a-h-d)*2,e[3]=(f-p)/m,e[0]=.25*m,e[1]=(o+c)/m,e[2]=(u+l)/m):h>d?(m=Math.sqrt(1+h-a-d)*2,e[3]=(u-l)/m,e[0]=(o+c)/m,e[1]=.25*m,e[2]=(f+p)/m):(m=Math.sqrt(1+d-a-h)*2,e[3]=(o-c)/m,e[0]=(u+l)/m,e[1]=(f+p)/m,e[2]=.25*m),e}function Gh(e,t,n,r){var i=t[0],s=t[1],a=t[2],o=t[3],l=i+i,c=s+s,h=a+a,f=i*l,u=i*c,p=i*h,d=s*c,v=s*h,m=a*h,E=o*l,C=o*c,w=o*h,S=r[0],T=r[1],g=r[2];return e[0]=(1-(d+m))*S,e[1]=(u+w)*S,e[2]=(p-C)*S,e[3]=0,e[4]=(u-w)*T,e[5]=(1-(f+m))*T,e[6]=(v+E)*T,e[7]=0,e[8]=(p+C)*g,e[9]=(v-E)*g,e[10]=(1-(f+d))*g,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function $h(e,t,n,r,i){var s=t[0],a=t[1],o=t[2],l=t[3],c=s+s,h=a+a,f=o+o,u=s*c,p=s*h,d=s*f,v=a*h,m=a*f,E=o*f,C=l*c,w=l*h,S=l*f,T=r[0],g=r[1],N=r[2],A=i[0],M=i[1],B=i[2],x=(1-(v+E))*T,F=(p+S)*T,D=(d-w)*T,P=(p-S)*g,y=(1-(u+E))*g,_=(m+C)*g,j=(d+w)*N,z=(m-C)*N,J=(1-(u+v))*N;return e[0]=x,e[1]=F,e[2]=D,e[3]=0,e[4]=P,e[5]=y,e[6]=_,e[7]=0,e[8]=j,e[9]=z,e[10]=J,e[11]=0,e[12]=n[0]+A-(x*A+P*M+j*B),e[13]=n[1]+M-(F*A+y*M+z*B),e[14]=n[2]+B-(D*A+_*M+J*B),e[15]=1,e}function Vh(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=n+n,o=r+r,l=i+i,c=n*a,h=r*a,f=r*o,u=i*a,p=i*o,d=i*l,v=s*a,m=s*o,E=s*l;return e[0]=1-f-d,e[1]=h+E,e[2]=u-m,e[3]=0,e[4]=h-E,e[5]=1-c-d,e[6]=p+v,e[7]=0,e[8]=u+m,e[9]=p-v,e[10]=1-c-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Kh(e,t,n,r,i,s,a){var o=1/(n-t),l=1/(i-r),c=1/(s-a);return e[0]=s*2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s*2*l,e[6]=0,e[7]=0,e[8]=(n+t)*o,e[9]=(i+r)*l,e[10]=(a+s)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*s*2*c,e[15]=0,e}function Vi(e,t,n,r,i){var s=1/Math.tan(t/2),a;return e[0]=s/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==Infinity?(a=1/(r-i),e[10]=(i+r)*a,e[14]=2*i*r*a):(e[10]=-1,e[14]=-2*r),e}var Wh=Vi;function jh(e,t,n,r,i){var s=1/Math.tan(t/2),a;return e[0]=s/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==Infinity?(a=1/(r-i),e[10]=i*a,e[14]=i*r*a):(e[10]=-1,e[14]=-r),e}function qh(e,t,n,r){var i=Math.tan(t.upDegrees*Math.PI/180),s=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),o=Math.tan(t.rightDegrees*Math.PI/180),l=2/(a+o),c=2/(i+s);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-((a-o)*l*.5),e[9]=(i-s)*c*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e}function Ki(e,t,n,r,i,s,a){var o=1/(t-n),l=1/(r-i),c=1/(s-a);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*o,e[13]=(i+r)*l,e[14]=(a+s)*c,e[15]=1,e}var Xh=Ki;function Qh(e,t,n,r,i,s,a){var o=1/(t-n),l=1/(r-i),c=1/(s-a);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=c,e[11]=0,e[12]=(t+n)*o,e[13]=(i+r)*l,e[14]=s*c,e[15]=1,e}function Zh(e,t,n,r){var i,s,a,o,l,c,h,f,u,p,d=t[0],v=t[1],m=t[2],E=r[0],C=r[1],w=r[2],S=n[0],T=n[1],g=n[2];return Math.abs(d-S)<U&&Math.abs(v-T)<U&&Math.abs(m-g)<U?zi(e):(h=d-S,f=v-T,u=m-g,p=1/Math.hypot(h,f,u),h*=p,f*=p,u*=p,i=C*u-w*f,s=w*h-E*u,a=E*f-C*h,p=Math.hypot(i,s,a),p?(p=1/p,i*=p,s*=p,a*=p):(i=0,s=0,a=0),o=f*a-u*s,l=u*i-h*a,c=h*s-f*i,p=Math.hypot(o,l,c),p?(p=1/p,o*=p,l*=p,c*=p):(o=0,l=0,c=0),e[0]=i,e[1]=o,e[2]=h,e[3]=0,e[4]=s,e[5]=l,e[6]=f,e[7]=0,e[8]=a,e[9]=c,e[10]=u,e[11]=0,e[12]=-(i*d+s*v+a*m),e[13]=-(o*d+l*v+c*m),e[14]=-(h*d+f*v+u*m),e[15]=1,e)}function Jh(e,t,n,r){var i=t[0],s=t[1],a=t[2],o=r[0],l=r[1],c=r[2],h=i-n[0],f=s-n[1],u=a-n[2],p=h*h+f*f+u*u;p>0&&(p=1/Math.sqrt(p),h*=p,f*=p,u*=p);var d=l*u-c*f,v=c*h-o*u,m=o*f-l*h;return p=d*d+v*v+m*m,p>0&&(p=1/Math.sqrt(p),d*=p,v*=p,m*=p),e[0]=d,e[1]=v,e[2]=m,e[3]=0,e[4]=f*m-u*v,e[5]=u*d-h*m,e[6]=h*v-f*d,e[7]=0,e[8]=h,e[9]=f,e[10]=u,e[11]=0,e[12]=i,e[13]=s,e[14]=a,e[15]=1,e}function ef(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function tf(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function nf(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e}function Wi(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}function rf(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e}function sf(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e[9]=t[9]+n[9]*r,e[10]=t[10]+n[10]*r,e[11]=t[11]+n[11]*r,e[12]=t[12]+n[12]*r,e[13]=t[13]+n[13]*r,e[14]=t[14]+n[14]*r,e[15]=t[15]+n[15]*r,e}function af(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function of(e,t){var n=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],h=e[8],f=e[9],u=e[10],p=e[11],d=e[12],v=e[13],m=e[14],E=e[15],C=t[0],w=t[1],S=t[2],T=t[3],g=t[4],N=t[5],A=t[6],M=t[7],B=t[8],x=t[9],F=t[10],D=t[11],P=t[12],y=t[13],_=t[14],j=t[15];return Math.abs(n-C)<=U*Math.max(1,Math.abs(n),Math.abs(C))&&Math.abs(r-w)<=U*Math.max(1,Math.abs(r),Math.abs(w))&&Math.abs(i-S)<=U*Math.max(1,Math.abs(i),Math.abs(S))&&Math.abs(s-T)<=U*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(a-g)<=U*Math.max(1,Math.abs(a),Math.abs(g))&&Math.abs(o-N)<=U*Math.max(1,Math.abs(o),Math.abs(N))&&Math.abs(l-A)<=U*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(c-M)<=U*Math.max(1,Math.abs(c),Math.abs(M))&&Math.abs(h-B)<=U*Math.max(1,Math.abs(h),Math.abs(B))&&Math.abs(f-x)<=U*Math.max(1,Math.abs(f),Math.abs(x))&&Math.abs(u-F)<=U*Math.max(1,Math.abs(u),Math.abs(F))&&Math.abs(p-D)<=U*Math.max(1,Math.abs(p),Math.abs(D))&&Math.abs(d-P)<=U*Math.max(1,Math.abs(d),Math.abs(P))&&Math.abs(v-y)<=U*Math.max(1,Math.abs(v),Math.abs(y))&&Math.abs(m-_)<=U*Math.max(1,Math.abs(m),Math.abs(_))&&Math.abs(E-j)<=U*Math.max(1,Math.abs(E),Math.abs(j))}var lf=Yi,cf=Wi;var te={};Fe(te,{add:()=>Cu,calculateW:()=>yu,clone:()=>Mu,conjugate:()=>wu,copy:()=>Ru,create:()=>Wn,dot:()=>ps,equals:()=>Fu,exactEquals:()=>Pu,exp:()=>cs,fromEuler:()=>bu,fromMat3:()=>fs,fromValues:()=>Su,getAngle:()=>mu,getAxisAngle:()=>du,identity:()=>pu,invert:()=>Au,len:()=>Ou,length:()=>ds,lerp:()=>Nu,ln:()=>hs,mul:()=>Lu,multiply:()=>ls,normalize:()=>jn,pow:()=>_u,random:()=>Eu,rotateX:()=>vu,rotateY:()=>xu,rotateZ:()=>gu,rotationTo:()=>Du,scale:()=>us,set:()=>Iu,setAxes:()=>ku,setAxisAngle:()=>os,slerp:()=>kt,sqlerp:()=>Uu,sqrLen:()=>Bu,squaredLength:()=>ms,str:()=>Tu});var G={};Fe(G,{add:()=>pf,angle:()=>Of,bezier:()=>Tf,ceil:()=>df,clone:()=>hf,copy:()=>ff,create:()=>Bt,cross:()=>at,dist:()=>zf,distance:()=>Zi,div:()=>Hf,divide:()=>Qi,dot:()=>Ft,equals:()=>Df,exactEquals:()=>Ff,floor:()=>mf,forEach:()=>$f,fromValues:()=>Pt,hermite:()=>bf,inverse:()=>Af,len:()=>Pn,length:()=>ji,lerp:()=>wf,max:()=>xf,min:()=>vf,mul:()=>kf,multiply:()=>Xi,negate:()=>Ef,normalize:()=>Bn,random:()=>Mf,rotateX:()=>Cf,rotateY:()=>Lf,rotateZ:()=>Nf,round:()=>gf,scale:()=>yf,scaleAndAdd:()=>_f,set:()=>uf,sqrDist:()=>Yf,sqrLen:()=>Gf,squaredDistance:()=>Ji,squaredLength:()=>es,str:()=>Pf,sub:()=>Uf,subtract:()=>qi,transformMat3:()=>Rf,transformMat4:()=>Sf,transformQuat:()=>If,zero:()=>Bf});function Bt(){var e=new V(3);return V!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function hf(e){var t=new V(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function ji(e){var t=e[0],n=e[1],r=e[2];return Math.hypot(t,n,r)}function Pt(e,t,n){var r=new V(3);return r[0]=e,r[1]=t,r[2]=n,r}function ff(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function uf(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}function pf(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function qi(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function Xi(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}function Qi(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}function df(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function mf(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function vf(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}function xf(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}function gf(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function yf(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function _f(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}function Zi(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.hypot(n,r,i)}function Ji(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i}function es(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}function Ef(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function Af(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function Bn(e,t){var n=t[0],r=t[1],i=t[2],s=n*n+r*r+i*i;return s>0&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e}function Ft(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function at(e,t,n){var r=t[0],i=t[1],s=t[2],a=n[0],o=n[1],l=n[2];return e[0]=i*l-s*o,e[1]=s*a-r*l,e[2]=r*o-i*a,e}function wf(e,t,n,r){var i=t[0],s=t[1],a=t[2];return e[0]=i+r*(n[0]-i),e[1]=s+r*(n[1]-s),e[2]=a+r*(n[2]-a),e}function bf(e,t,n,r,i,s){var a=s*s,o=a*(2*s-3)+1,l=a*(s-2)+s,c=a*(s-1),h=a*(3-2*s);return e[0]=t[0]*o+n[0]*l+r[0]*c+i[0]*h,e[1]=t[1]*o+n[1]*l+r[1]*c+i[1]*h,e[2]=t[2]*o+n[2]*l+r[2]*c+i[2]*h,e}function Tf(e,t,n,r,i,s){var a=1-s,o=a*a,l=s*s,c=o*a,h=3*s*o,f=3*l*a,u=l*s;return e[0]=t[0]*c+n[0]*h+r[0]*f+i[0]*u,e[1]=t[1]*c+n[1]*h+r[1]*f+i[1]*u,e[2]=t[2]*c+n[2]*h+r[2]*f+i[2]*u,e}function Mf(e,t){t=t||1;var n=he()*2*Math.PI,r=he()*2-1,i=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*i,e[1]=Math.sin(n)*i,e[2]=r*t,e}function Sf(e,t,n){var r=t[0],i=t[1],s=t[2],a=n[3]*r+n[7]*i+n[11]*s+n[15];return a=a||1,e[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/a,e[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/a,e[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/a,e}function Rf(e,t,n){var r=t[0],i=t[1],s=t[2];return e[0]=r*n[0]+i*n[3]+s*n[6],e[1]=r*n[1]+i*n[4]+s*n[7],e[2]=r*n[2]+i*n[5]+s*n[8],e}function If(e,t,n){var r=n[0],i=n[1],s=n[2],a=n[3],o=t[0],l=t[1],c=t[2],h=i*c-s*l,f=s*o-r*c,u=r*l-i*o,p=i*u-s*f,d=s*h-r*u,v=r*f-i*h,m=a*2;return h*=m,f*=m,u*=m,p*=2,d*=2,v*=2,e[0]=o+h+p,e[1]=l+f+d,e[2]=c+u+v,e}function Cf(e,t,n,r){var i=[],s=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=s[0]+n[0],e[1]=s[1]+n[1],e[2]=s[2]+n[2],e}function Lf(e,t,n,r){var i=[],s=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=s[0]+n[0],e[1]=s[1]+n[1],e[2]=s[2]+n[2],e}function Nf(e,t,n,r){var i=[],s=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],e[0]=s[0]+n[0],e[1]=s[1]+n[1],e[2]=s[2]+n[2],e}function Of(e,t){var n=e[0],r=e[1],i=e[2],s=t[0],a=t[1],o=t[2],l=Math.sqrt(n*n+r*r+i*i),c=Math.sqrt(s*s+a*a+o*o),h=l*c,f=h&&Ft(e,t)/h;return Math.acos(Math.min(Math.max(f,-1),1))}function Bf(e){return e[0]=0,e[1]=0,e[2]=0,e}function Pf(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function Ff(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function Df(e,t){var n=e[0],r=e[1],i=e[2],s=t[0],a=t[1],o=t[2];return Math.abs(n-s)<=U*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-a)<=U*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-o)<=U*Math.max(1,Math.abs(i),Math.abs(o))}var Uf=qi,kf=Xi,Hf=Qi,zf=Zi,Yf=Ji,Pn=ji,Gf=es,$f=function(){var e=Bt();return function(t,n,r,i,s,a){var o,l;for(n||(n=3),r||(r=0),i?l=Math.min(i*n+r,t.length):l=t.length,o=r;o<l;o+=n)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],s(e,e,a),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2];return t}}();var be={};Fe(be,{add:()=>Hn,ceil:()=>Vf,clone:()=>Fn,copy:()=>Un,create:()=>ts,cross:()=>Jf,dist:()=>lu,distance:()=>ss,div:()=>ou,divide:()=>is,dot:()=>Gn,equals:()=>Kn,exactEquals:()=>Vn,floor:()=>Kf,forEach:()=>uu,fromValues:()=>Dn,inverse:()=>Zf,len:()=>hu,length:()=>Dt,lerp:()=>$n,max:()=>jf,min:()=>Wf,mul:()=>au,multiply:()=>rs,negate:()=>Qf,normalize:()=>Yn,random:()=>eu,round:()=>qf,scale:()=>zn,scaleAndAdd:()=>Xf,set:()=>kn,sqrDist:()=>cu,sqrLen:()=>fu,squaredDistance:()=>as,squaredLength:()=>Ut,str:()=>iu,sub:()=>su,subtract:()=>ns,transformMat4:()=>tu,transformQuat:()=>nu,zero:()=>ru});function ts(){var e=new V(4);return V!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Fn(e){var t=new V(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Dn(e,t,n,r){var i=new V(4);return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i}function Un(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function kn(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e}function Hn(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e}function ns(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}function rs(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e}function is(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e}function Vf(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function Kf(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function Wf(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e}function jf(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e}function qf(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function zn(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function Xf(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e}function ss(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],s=t[3]-e[3];return Math.hypot(n,r,i,s)}function as(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],s=t[3]-e[3];return n*n+r*r+i*i+s*s}function Dt(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.hypot(t,n,r,i)}function Ut(e){var t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i}function Qf(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function Zf(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function Yn(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=n*n+r*r+i*i+s*s;return a>0&&(a=1/Math.sqrt(a)),e[0]=n*a,e[1]=r*a,e[2]=i*a,e[3]=s*a,e}function Gn(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Jf(e,t,n,r){var i=n[0]*r[1]-n[1]*r[0],s=n[0]*r[2]-n[2]*r[0],a=n[0]*r[3]-n[3]*r[0],o=n[1]*r[2]-n[2]*r[1],l=n[1]*r[3]-n[3]*r[1],c=n[2]*r[3]-n[3]*r[2],h=t[0],f=t[1],u=t[2],p=t[3];return e[0]=f*c-u*l+p*o,e[1]=-(h*c)+u*a-p*s,e[2]=h*l-f*a+p*i,e[3]=-(h*o)+f*s-u*i,e}function $n(e,t,n,r){var i=t[0],s=t[1],a=t[2],o=t[3];return e[0]=i+r*(n[0]-i),e[1]=s+r*(n[1]-s),e[2]=a+r*(n[2]-a),e[3]=o+r*(n[3]-o),e}function eu(e,t){t=t||1;var n,r,i,s,a,o;do n=he()*2-1,r=he()*2-1,a=n*n+r*r;while(a>=1);do i=he()*2-1,s=he()*2-1,o=i*i+s*s;while(o>=1);var l=Math.sqrt((1-a)/o);return e[0]=t*n,e[1]=t*r,e[2]=t*i*l,e[3]=t*s*l,e}function tu(e,t,n){var r=t[0],i=t[1],s=t[2],a=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*a,e[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*a,e[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*a,e[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*a,e}function nu(e,t,n){var r=t[0],i=t[1],s=t[2],a=n[0],o=n[1],l=n[2],c=n[3],h=c*r+o*s-l*i,f=c*i+l*r-a*s,u=c*s+a*i-o*r,p=-a*r-o*i-l*s;return e[0]=h*c+p*-a+f*-l-u*-o,e[1]=f*c+p*-o+u*-a-h*-l,e[2]=u*c+p*-l+h*-o-f*-a,e[3]=t[3],e}function ru(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function iu(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function Vn(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function Kn(e,t){var n=e[0],r=e[1],i=e[2],s=e[3],a=t[0],o=t[1],l=t[2],c=t[3];return Math.abs(n-a)<=U*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-o)<=U*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-l)<=U*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(s-c)<=U*Math.max(1,Math.abs(s),Math.abs(c))}var su=ns,au=rs,ou=is,lu=ss,cu=as,hu=Dt,fu=Ut,uu=function(){var e=ts();return function(t,n,r,i,s,a){var o,l;for(n||(n=4),r||(r=0),i?l=Math.min(i*n+r,t.length):l=t.length,o=r;o<l;o+=n)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],e[3]=t[o+3],s(e,e,a),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2],t[o+3]=e[3];return t}}();function Wn(){var e=new V(4);return V!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function pu(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function os(e,t,n){n=n*.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function du(e,t){var n=Math.acos(t[3])*2,r=Math.sin(n/2);return r>U?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=1,e[1]=0,e[2]=0),n}function mu(e,t){var n=ps(e,t);return Math.acos(2*n*n-1)}function ls(e,t,n){var r=t[0],i=t[1],s=t[2],a=t[3],o=n[0],l=n[1],c=n[2],h=n[3];return e[0]=r*h+a*o+i*c-s*l,e[1]=i*h+a*l+s*o-r*c,e[2]=s*h+a*c+r*l-i*o,e[3]=a*h-r*o-i*l-s*c,e}function vu(e,t,n){n*=.5;var r=t[0],i=t[1],s=t[2],a=t[3],o=Math.sin(n),l=Math.cos(n);return e[0]=r*l+a*o,e[1]=i*l+s*o,e[2]=s*l-i*o,e[3]=a*l-r*o,e}function xu(e,t,n){n*=.5;var r=t[0],i=t[1],s=t[2],a=t[3],o=Math.sin(n),l=Math.cos(n);return e[0]=r*l-s*o,e[1]=i*l+a*o,e[2]=s*l+r*o,e[3]=a*l-i*o,e}function gu(e,t,n){n*=.5;var r=t[0],i=t[1],s=t[2],a=t[3],o=Math.sin(n),l=Math.cos(n);return e[0]=r*l+i*o,e[1]=i*l-r*o,e[2]=s*l+a*o,e[3]=a*l-s*o,e}function yu(e,t){var n=t[0],r=t[1],i=t[2];return e[0]=n,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e}function cs(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=Math.sqrt(n*n+r*r+i*i),o=Math.exp(s),l=a>0?o*Math.sin(a)/a:0;return e[0]=n*l,e[1]=r*l,e[2]=i*l,e[3]=o*Math.cos(a),e}function hs(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=Math.sqrt(n*n+r*r+i*i),o=a>0?Math.atan2(a,s)/a:0;return e[0]=n*o,e[1]=r*o,e[2]=i*o,e[3]=.5*Math.log(n*n+r*r+i*i+s*s),e}function _u(e,t,n){return hs(e,t),us(e,e,n),cs(e,e),e}function kt(e,t,n,r){var i=t[0],s=t[1],a=t[2],o=t[3],l=n[0],c=n[1],h=n[2],f=n[3],u,p,d,v,m;return p=i*l+s*c+a*h+o*f,p<0&&(p=-p,l=-l,c=-c,h=-h,f=-f),1-p>U?(u=Math.acos(p),d=Math.sin(u),v=Math.sin((1-r)*u)/d,m=Math.sin(r*u)/d):(v=1-r,m=r),e[0]=v*i+m*l,e[1]=v*s+m*c,e[2]=v*a+m*h,e[3]=v*o+m*f,e}function Eu(e){var t=he(),n=he(),r=he(),i=Math.sqrt(1-t),s=Math.sqrt(t);return e[0]=i*Math.sin(2*Math.PI*n),e[1]=i*Math.cos(2*Math.PI*n),e[2]=s*Math.sin(2*Math.PI*r),e[3]=s*Math.cos(2*Math.PI*r),e}function Au(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],a=n*n+r*r+i*i+s*s,o=a?1/a:0;return e[0]=-n*o,e[1]=-r*o,e[2]=-i*o,e[3]=s*o,e}function wu(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function fs(e,t){var n=t[0]+t[4]+t[8],r;if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);var s=(i+1)%3,a=(i+2)%3;r=Math.sqrt(t[i*3+i]-t[s*3+s]-t[a*3+a]+1),e[i]=.5*r,r=.5/r,e[3]=(t[s*3+a]-t[a*3+s])*r,e[s]=(t[s*3+i]+t[i*3+s])*r,e[a]=(t[a*3+i]+t[i*3+a])*r}return e}function bu(e,t,n,r){var i=.5*Math.PI/180;t*=i,n*=i,r*=i;var s=Math.sin(t),a=Math.cos(t),o=Math.sin(n),l=Math.cos(n),c=Math.sin(r),h=Math.cos(r);return e[0]=s*l*h-a*o*c,e[1]=a*o*h+s*l*c,e[2]=a*l*c-s*o*h,e[3]=a*l*h+s*o*c,e}function Tu(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var Mu=Fn,Su=Dn,Ru=Un,Iu=kn,Cu=Hn,Lu=ls,us=zn,ps=Gn,Nu=$n,ds=Dt,Ou=ds,ms=Ut,Bu=ms,jn=Yn,Pu=Vn,Fu=Kn,Du=function(){var e=Bt(),t=Pt(1,0,0),n=Pt(0,1,0);return function(r,i,s){var a=Ft(i,s);return a<-.999999?(at(e,t,i),Pn(e)<1e-6&&at(e,n,i),Bn(e,e),os(r,e,Math.PI),r):a>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(at(e,i,s),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+a,jn(r,r))}}(),Uu=function(){var e=Wn(),t=Wn();return function(n,r,i,s,a,o){return kt(e,r,a,o),kt(t,i,s,o),kt(n,e,t,2*o*(1-o)),n}}(),ku=function(){var e=On();return function(t,n,r,i){return e[0]=r[0],e[3]=r[1],e[6]=r[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],jn(t,fs(t,e))}}();var Ke={};Fe(Ke,{add:()=>$u,angle:()=>hp,ceil:()=>Vu,clone:()=>Hu,copy:()=>Yu,create:()=>vs,cross:()=>np,dist:()=>yp,distance:()=>_s,div:()=>gp,divide:()=>ys,dot:()=>tp,equals:()=>dp,exactEquals:()=>pp,floor:()=>Ku,forEach:()=>Ap,fromValues:()=>zu,inverse:()=>Ju,len:()=>mp,length:()=>As,lerp:()=>rp,max:()=>ju,min:()=>Wu,mul:()=>xp,multiply:()=>gs,negate:()=>Zu,normalize:()=>ep,random:()=>ip,rotate:()=>cp,round:()=>qu,scale:()=>Xu,scaleAndAdd:()=>Qu,set:()=>Gu,sqrDist:()=>_p,sqrLen:()=>Ep,squaredDistance:()=>Es,squaredLength:()=>ws,str:()=>up,sub:()=>vp,subtract:()=>xs,transformMat2:()=>sp,transformMat2d:()=>ap,transformMat3:()=>op,transformMat4:()=>lp,zero:()=>fp});function vs(){var e=new V(2);return V!=Float32Array&&(e[0]=0,e[1]=0),e}function Hu(e){var t=new V(2);return t[0]=e[0],t[1]=e[1],t}function zu(e,t){var n=new V(2);return n[0]=e,n[1]=t,n}function Yu(e,t){return e[0]=t[0],e[1]=t[1],e}function Gu(e,t,n){return e[0]=t,e[1]=n,e}function $u(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function xs(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}function gs(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e}function ys(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e}function Vu(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function Ku(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function Wu(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e}function ju(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e}function qu(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function Xu(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e}function Qu(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e}function _s(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.hypot(n,r)}function Es(e,t){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}function As(e){var t=e[0],n=e[1];return Math.hypot(t,n)}function ws(e){var t=e[0],n=e[1];return t*t+n*n}function Zu(e,t){return e[0]=-t[0],e[1]=-t[1],e}function Ju(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function ep(e,t){var n=t[0],r=t[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e}function tp(e,t){return e[0]*t[0]+e[1]*t[1]}function np(e,t,n){var r=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=r,e}function rp(e,t,n,r){var i=t[0],s=t[1];return e[0]=i+r*(n[0]-i),e[1]=s+r*(n[1]-s),e}function ip(e,t){t=t||1;var n=he()*2*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e}function sp(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e}function ap(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i+n[4],e[1]=n[1]*r+n[3]*i+n[5],e}function op(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[3]*i+n[6],e[1]=n[1]*r+n[4]*i+n[7],e}function lp(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e}function cp(e,t,n,r){var i=t[0]-n[0],s=t[1]-n[1],a=Math.sin(r),o=Math.cos(r);return e[0]=i*o-s*a+n[0],e[1]=i*a+s*o+n[1],e}function hp(e,t){var n=e[0],r=e[1],i=t[0],s=t[1],a=Math.sqrt(n*n+r*r)*Math.sqrt(i*i+s*s),o=a&&(n*i+r*s)/a;return Math.acos(Math.min(Math.max(o,-1),1))}function fp(e){return e[0]=0,e[1]=0,e}function up(e){return"vec2("+e[0]+", "+e[1]+")"}function pp(e,t){return e[0]===t[0]&&e[1]===t[1]}function dp(e,t){var n=e[0],r=e[1],i=t[0],s=t[1];return Math.abs(n-i)<=U*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-s)<=U*Math.max(1,Math.abs(r),Math.abs(s))}var mp=As,vp=xs,xp=gs,gp=ys,yp=_s,_p=Es,Ep=ws,Ap=function(){var e=vs();return function(t,n,r,i,s,a){var o,l;for(n||(n=2),r||(r=0),i?l=Math.min(i*n+r,t.length):l=t.length,o=r;o<l;o+=n)e[0]=t[o],e[1]=t[o+1],s(e,e,a),t[o]=e[0],t[o+1]=e[1];return t}}();var ne={red(e){return e>>16&255},redf(e){return(e>>16&255)/255},green(e){return e>>8&255},greenf(e){return(e>>8&255)/255},blue(e){return e&255},bluef(e){return(e&255)/255},alpha(e){return e>>24&255},alphaf(e){return(e>>24&255)/255},hexf(e,t,n,r=1){let i=Math.floor(Math.max(Math.min(e,1),0)*255),s=Math.floor(Math.max(Math.min(t,1),0)*255),a=Math.floor(Math.max(Math.min(n,1),0)*255);return(Math.floor(Math.max(Math.min(r,1),0)*255)&255)<<24|(i&255)<<16|(s&255)<<8|a&255},mix(e=0,t=16777215,n=.5){let r=this.redf(e),i=this.greenf(e),s=this.bluef(e),a=this.alphaf(e),o=(this.redf(t)-r)*n+r,l=(this.greenf(t)-i)*n+i,c=(this.bluef(t)-s)*n+s,h=(this.alphaf(t)-a)*n+a;return h<.01&&(h=void 0),this.hexf(o,l,c,h)}};var d0=G.fromValues(0,1,0);var bs=class{constructor(t,n){this.projectionMatrix=t,this.viewMatrix=n}resize(t=void 0,n=void 0){return this}},m0=Math.PI/3;var qn=class extends bs{constructor(t=void 0,n=void 0,r=void 0,i=void 0,s=-1e3,a=1e3){super($.create(),$.create());this.orthoBounds={left:typeof t=="undefined"?void 0:Number(t),top:typeof n=="undefined"?void 0:Number(n),right:typeof r=="undefined"?void 0:Number(r),bottom:typeof i=="undefined"?void 0:Number(i)},this.clippingPlane={near:Number(s),far:Number(a)}}resize(t=void 0,n=void 0){let{near:r,far:i}=this.clippingPlane,{left:s,top:a,right:o,bottom:l}=this.orthoBounds,c=this.projectionMatrix,h=typeof t!="undefined",f=typeof s!="undefined";if(h)if(f){let u=t/n;$.ortho(c,s*u,o*u,l,a,r,i)}else $.ortho(c,0,t,n,0,r,i);else f?$.ortho(c,s,o,l,a,r,i):$.ortho(c,-1,1,1,-1,-1,1);return this}},v0=Math.PI/180;var Xn=class{constructor(t,n=t.canvas,r=new qn){this.gl=t,this.canvas=n,this.camera=r,this.projectionViewMatrix=$.create(),this.modelMatrix=$.create(),this.colorVector=G.create(),this.depthFloat=0,this.opacityFloat=1,this.transformStack=[],this.transformMatrix=$.create(),this.translationVector=G.create(),this.rotationQuat=te.create(),this.scaleVector=G.fromValues(1,1,1),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA)}reset(){this.resize(),this.clear(0,0,0,1),this.setColorVector(1,1,1),this.setDepthFloat(0),this.setOpacityFloat(1),this.resetTransform(),this.transformStack.length=0}resize(){let t=this.gl,n=t.canvas.width,r=t.canvas.height;t.viewport(0,0,n,r);let i=this.camera;i.resize(n,r);let s=this.projectionViewMatrix;$.mul(s,i.projectionMatrix,i.viewMatrix)}clear(t,n,r,i=1){let s=this.gl;s.clearColor(t,n,r,i),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT)}setColorVector(t,n,r){return G.set(this.colorVector,t,n,r),this}setColor(t){return this.setColorVector(ne.redf(t),ne.greenf(t),ne.bluef(t))}setDepthFloat(t){return this.depthFloat=t,this}setOpacityFloat(t){return this.opacityFloat=t,this}setTranslation(t,n,r=0){return G.set(this.translationVector,t,n,r),this}setRotation(t,n,r){return te.fromEuler(this.rotationQuat,t,n,r),this}setScale(t,n){return G.set(this.scaleVector,t,n,1),this}resetTransform(){$.identity(this.transformMatrix),G.zero(this.translationVector),te.identity(this.rotationQuat),G.set(this.scaleVector,1,1,1)}pushTransform(){$.fromRotationTranslationScale(this.transformMatrix,this.rotationQuat,this.translationVector,this.scaleVector),this.transformStack.push(this.transformMatrix),this.transformMatrix=$.create(),this.resetTransform()}popTransform(){let t=this.transformStack.pop();$.getRotation(this.rotationQuat,t),$.getTranslation(this.translationVector,t),$.getScaling(this.scaleVector,t),this.transformMatrix=t}applyTransform(t){for(let n=this.transformStack.length-1;n>=0;--n)$.mul(t,this.transformStack[n],t);return $.mul(t,$.fromRotationTranslationScale(this.transformMatrix,this.rotationQuat,this.translationVector,this.scaleVector),t),t}};var wp=`
attribute vec2 a_position;

uniform mat4 u_projection_view;
uniform mat4 u_model;

void main() {
    gl_Position = u_projection_view * u_model * vec4(a_position.xy, 0.0, 1.0);
}`,bp=`
precision mediump float;

uniform vec3 u_color;
uniform float u_opacity_inv;

void main() {
    gl_FragColor = vec4(u_color.rgb, 1.0 - u_opacity_inv);
}`,Qn=16,Ts=(()=>{let e=[],t=Qn,n=Math.PI*2/t,r=1,i=0,s,a;for(let o=0;o<=t;++o)s=Math.cos(o*n),a=Math.sin(o*n),e.push(0,0),e.push(r,i),e.push(s,a),r=s,i=a;return e})(),Tp=Math.trunc(Ts.length/2),Ms=(()=>{let e=[],t=Qn,n=Math.PI*2/t,r=1,i=0,s,a;for(let o=0;o<=t;++o)s=Math.cos(o*n),a=Math.sin(o*n),e.push(r,i),e.push(s,a),r=s,i=a;return e})(),Mp=Math.trunc(Ms.length/2),Sp=Qn/2,Ss=(()=>{let e=[],t=Sp,n=Math.PI/t,r=1,i=0,s,a;for(let o=0;o<=t;++o)s=Math.cos(o*n),a=Math.sin(o*n),e.push(0,0),e.push(r,i),e.push(s,a),r=s,i=a;return e})(),Rp=Math.trunc(Ss.length/2),Ht=[0,0,1,0,0,1,1,1,1,0,0,1],Ip=[0,0,1,1],Zn=class extends Xn{constructor(t,n=void 0,r=void 0){super(t,n,r);this.shapeProgram=new ke(t).shader(t.VERTEX_SHADER,wp).shader(t.FRAGMENT_SHADER,bp).link(),this.meshQuad=new we(t,t.ARRAY_BUFFER).data(Ie.createBufferSource(t,t.FLOAT,Ht)).build(),this.meshLine=new we(t,t.ARRAY_BUFFER).data(Ie.createBufferSource(t,t.FLOAT,Ip)).build(),this.meshCircle=new we(t,t.ARRAY_BUFFER).data(Ie.createBufferSource(t,t.FLOAT,Ts)).build(),this.meshLineCircle=new we(t,t.ARRAY_BUFFER).data(Ie.createBufferSource(t,t.FLOAT,Ms)).build(),this.meshHalfCircle=new we(t,t.ARRAY_BUFFER).data(Ie.createBufferSource(t,t.FLOAT,Ss)).build()}resize(){super.resize(),this.shapeProgram.bind(this.gl).uniform("u_projection_view",this.projectionViewMatrix)}setColorVector(t,n,r){return super.setColorVector(t,n,r),this.shapeProgram.bind(this.gl).uniform("u_color",this.colorVector),this}setOpacityFloat(t){return super.setOpacityFloat(t),this.shapeProgram.bind(this.gl).uniform("u_opacity_inv",1-this.opacityFloat),this}drawLine(t=0,n=0,r=t+16,i=n){let s=this.gl,a=this.depthFloat,o=r-t,l=i-n,c=this.modelMatrix;return $.fromRotationTranslationScale(c,te.create(),G.fromValues(t,n,a),G.fromValues(o,l,1)),this.applyTransform(c),this.shapeProgram.bind(s).attribute("a_position",s.FLOAT,this.meshLine.handle).uniform("u_model",c).draw(s,s.LINES,0,2),this}drawQuadratic(t=0,n=0,r=t+16,i=n,s=16,a=9){let o=r-t,l=i-n,c=o/2+t,h=l/2+n+s,f=[t,n,c,h,r,i];Cp(f,f,a);let u=f.length;for(let p=2;p<=u-2;p+=2)this.drawLine(f[p-2],f[p-1],f[p],f[p+1])}drawRay(t=0,n=0,r=0,i=16){let s=Math.PI*r/180;return this.drawLine(t,n,t+Math.cos(s)*i,n+Math.sin(s)*i)}drawBox(t=0,n=0,r=8,i=r){return this.drawBoxImpl(this.gl.TRIANGLES,t,n,this.depthFloat,r,i)}drawLineBox(t=0,n=0,r=8,i=r){return this.drawBoxImpl(this.gl.LINE_LOOP,t,n,this.depthFloat,r,i)}drawRect(t=0,n=0,r=16,i=16){let s=(r-t)/2,a=(i-n)/2;return this.drawBox(t+s,n+a,s,a)}drawLineRect(t=0,n=0,r=16,i=16){let s=(r-t)/2,a=(i-n)/2;return this.drawLineBox(t+s,n+a,s,a)}drawCircle(t=0,n=0,r=8){return this.drawCircleImpl(this.meshCircle,Tp,this.gl.TRIANGLES,t,n,this.depthFloat,r)}drawLineCircle(t=0,n=0,r=8){return this.drawCircleImpl(this.meshLineCircle,Mp,this.gl.LINE_LOOP,t,n,this.depthFloat,r)}drawHalfCircle(t=0,n=0,r=8){return this.drawCircleImpl(this.meshHalfCircle,Rp,this.gl.TRIANGLES,t,n,this.depthFloat,r)}drawBoxImpl(t,n,r,i,s,a){let o=this.gl,l=this.modelMatrix;return $.fromRotationTranslationScaleOrigin(l,te.create(),G.fromValues(n,r,i),G.fromValues(s*2,a*2,1),G.fromValues(.5,.5,0)),this.applyTransform(l),this.shapeProgram.bind(o).attribute("a_position",o.FLOAT,this.meshQuad.handle).uniform("u_model",l).draw(o,t,0,6),this}drawCircleImpl(t,n,r,i,s,a,o){let l=this.gl,c=this.modelMatrix;return $.fromRotationTranslationScale(c,te.create(),G.fromValues(i,s,a),G.fromValues(o,o,1)),this.applyTransform(c),this.shapeProgram.bind(l).attribute("a_position",l.FLOAT,t.handle).uniform("u_model",c).draw(l,r,0,n),this}};function Cp(e,t,n){if(t.length<6)throw new Error("Cannot find quadratic points from less than 3 points.");let[r,i,s,a,o,l]=t,c=st.fromValues(r*r,s*s,o*o,r,s,o,1,1,1),h=G.fromValues(i,a,l);st.invert(c,c);let f=G.transformMat3(h,h,c);e.length=0,e.push(r,i);let u=o-r;for(let p=1;p<n-1;++p){let d=p/n,v=u*d+r,m=f[0]*v*v+f[1]*v+f[2];e.push(v,m)}return e.push(o,l),e}var Lp=`
attribute vec2 a_position;
attribute vec2 a_texcoord;

varying vec2 v_texcoord;

uniform mat4 u_projection_view;
uniform mat4 u_model;

void main() {
    vec4 position = u_projection_view * u_model
        * vec4(a_position.xy, 0.0, 1.0);
    v_texcoord = a_texcoord;
    gl_Position = position;
}`,Np=`
precision mediump float;

varying vec2 v_texcoord;

uniform sampler2D u_texture;
uniform vec2 u_texture_size;
uniform vec4 u_sprite;
uniform vec3 u_color;
uniform float u_opacity_inv;

void main() {
    float spriteWidth = u_sprite.z - u_sprite.x;
    float spriteHeight = u_sprite.w - u_sprite.y;
    vec2 texcoord = vec2(
        (u_sprite.x / u_texture_size.x) + v_texcoord.x * (spriteWidth / u_texture_size.x),
        (u_sprite.y / u_texture_size.y) + v_texcoord.y * (spriteHeight / u_texture_size.y));
    vec4 texcolor = texture2D(u_texture, texcoord);
    if (texcolor.a <= 0.0) discard;
    gl_FragColor = vec4(
        texcolor.r * u_color.r,
        texcolor.g * u_color.g,
        texcolor.b * u_color.b,
        texcolor.a * (1.0 - u_opacity_inv));
}`,Jn=class extends Zn{constructor(t,n=void 0,r=void 0){super(t,n,r);this.texturedProgram=new ke(t).shader(t.VERTEX_SHADER,Lp).shader(t.FRAGMENT_SHADER,Np).link(),this.meshQuadTextured={position:new we(t,t.ARRAY_BUFFER).data(Ie.createBufferSource(t,t.FLOAT,Ht)).build(),texcoord:new we(t,t.ARRAY_BUFFER).data(Ie.createBufferSource(t,t.FLOAT,Ht)).build()},this.spriteVector=be.fromValues(0,0,1,1),this.textureSize=Ke.fromValues(1,1),this.textureHandle=null,this.textureList=new Array(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS))}resize(){super.resize(),this.texturedProgram.bind(this.gl).uniform("u_projection_view",this.projectionViewMatrix)}setColorVector(t,n,r){return super.setColorVector(t,n,r),this.texturedProgram.bind(this.gl).uniform("u_color",this.colorVector),this}setOpacityFloat(t){return super.setOpacityFloat(t),this.texturedProgram.bind(this.gl).uniform("u_opacity_inv",1-this.opacityFloat),this}setTextureImage(t,n){let r=this.textureList,i=r.length;if(t<0||t>=i)throw new Error(`Invalid texture unit - must be within range [0, ${i-1}]`);let s=this.gl,a=r[t];a&&Bp(s,a.handle);let o=Op(s,n);return r[t]=o,s.activeTexture(s.TEXTURE0+t),s.bindTexture(s.TEXTURE_2D,o.handle),this}drawTexturedBox(t=0,n=0,r=0,i=void 0,s=void 0,a=0,o=0,l=void 0,c=void 0){let{width:h,height:f}=this.textureList[t];Ke.set(this.textureSize,h,f),typeof l=="undefined"&&(l=h),typeof c=="undefined"&&(c=f),be.set(this.spriteVector,a,o,l,c);let u=l-a,p=c-o,d=!1;typeof i=="undefined"?i=u/2:d=!0,typeof s=="undefined"&&(d?s=i:s=p/2);let v=i*2,m=s*2,E=v/u,C=m/p;return this.drawTexturedQuadImpl(t,n,r,this.depthFloat,E,C)}drawTexturedRect(t=0,n=0,r=0,i=void 0,s=void 0,a=0,o=0,l=void 0,c=void 0){let{width:h,height:f}=this.textureList[t];typeof l=="undefined"&&(l=h),typeof c=="undefined"&&(c=f),Ke.set(this.textureSize,h,f),be.set(this.spriteVector,a,o,l,c),typeof i=="undefined"&&(i=n+h),typeof s=="undefined"&&(s=r+f);let u=i-n,p=s-r,d=l-a,v=c-o,m=u/d,E=p/v,C=n+d/2*m,w=r+v/2*E;return this.drawTexturedQuadImpl(t,C,w,this.depthFloat,m,E)}drawTexturedQuadImpl(t,n,r,i,s,a){let o=this.gl,l=this.spriteVector,c=l[2]-l[0],h=l[3]-l[1],f=this.modelMatrix;$.fromRotationTranslationScaleOrigin(f,te.fromEuler(te.create(),0,0,0),G.fromValues(n-c/2,r-h/2,i),G.fromValues(s,a,1),G.fromValues(c/2,h/2,0)),$.scale(f,f,G.fromValues(c,h,1)),this.applyTransform(f);let u=this.meshQuadTextured,p=this.textureSize;return this.texturedProgram.bind(o).attribute("a_position",o.FLOAT,u.position.handle).attribute("a_texcoord",o.FLOAT,u.texcoord.handle).uniform("u_model",f).uniform("u_texture",t).uniform("u_sprite",l).uniform("u_texture_size",p).draw(o,o.TRIANGLES,0,6),this}};function Op(e,t){if(!(t instanceof Image))throw new Error(`Not a valid image ${t}.`);let n=0,r=e.RGBA,i=e.RGBA,s=e.UNSIGNED_BYTE,a=e.createTexture();return e.bindTexture(e.TEXTURE_2D,a),e.texImage2D(e.TEXTURE_2D,n,r,i,s,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),{handle:a,width:t.width,height:t.height}}function Bp(e,t){e.deleteTexture(t)}var Pp=`
attribute vec2 a_position;

varying vec2 v_position;

uniform mat4 u_projection_view;
uniform mat4 u_model;

void main() {
    gl_Position = u_projection_view * u_model * vec4(a_position.xy, 0.0, 1.0);
    v_position = a_position;
}`,Fp=`
precision mediump float;

varying vec2 v_position;

uniform vec3 u_color;
uniform float u_opacity_inv;

uniform vec3 u_color_from;
uniform vec3 u_color_to;

uniform vec4 u_gradient_rect;

void main() {
    // float fx = (gl_FragCoord.x - u_gradient_rect.x) / u_gradient_rect.z;
    float fy = (gl_FragCoord.y - u_gradient_rect.y) / u_gradient_rect.w;
    gl_FragColor = vec4(mix(u_color_to, u_color_from, fy), 1.0 - u_opacity_inv);
}`,er=class extends Jn{constructor(t,n=void 0,r=void 0){super(t,n,r);this.gradientProgram=new ke(t).shader(t.VERTEX_SHADER,Pp).shader(t.FRAGMENT_SHADER,Fp).link(),this.gradientColor=G.create(),this.gradientVector=be.create()}resize(){super.resize(),this.gradientProgram.bind(this.gl).uniform("u_projection_view",this.projectionViewMatrix)}setOpacityFloat(t){return super.setOpacityFloat(t),this.gradientProgram.bind(this.gl).uniform("u_opacity_inv",1-this.opacityFloat),this}drawGradientRect(t=16777215,n=0,r=0,i=0,s=this.canvas.width,a=this.canvas.height){let o=(s-r)/2,l=(a-i)/2,c=r+o,h=i+l,f=this.depthFloat,u=this.gl,p=this.modelMatrix;return $.fromRotationTranslationScaleOrigin(p,te.fromEuler(te.create(),0,0,0),G.fromValues(c,h,f),G.fromValues(o*2,l*2,1),G.fromValues(.5,.5,0)),this.applyTransform(p),this.gradientProgram.bind(u).attribute("a_position",u.FLOAT,this.meshQuad.handle).uniform("u_model",p).uniform("u_color_from",G.set(this.gradientColor,ne.redf(t),ne.greenf(t),ne.bluef(t))).uniform("u_color_to",G.set(this.gradientColor,ne.redf(n),ne.greenf(n),ne.bluef(n))).uniform("u_gradient_rect",be.set(this.gradientVector,r,this.canvas.height-a,o*2,l*2)).draw(u,u.TRIANGLES,0,6),this}};var tr=class extends er{constructor(t,n=void 0,r=void 0){super(t,n,r);this.bmFontMap={}}setBMFontTexture(t,n,r){let i={};for(let s of r.chars){let a=s.x,o=s.y,l=a+s.width,c=o+s.height;i[s.id]={u:a,v:o,s:l,t:c}}this.bmFontMap[t]=i,this.setTextureImage(t,n)}drawText(t,n,r,i){let s=r,a=13,o=18;for(let l=0;l<n.length;++l){let c=n.charAt(l);if(c===`
`){i+=o,r=s;continue}else if(c===" "){r+=a;continue}else{r+=a;let h=n.charCodeAt(l),{u:f,v:u,s:p,t:d}=this.bmFontMap[t][h],v=p-f,m=d-u;this.drawTexturedBox(t,r,i,v/2,m/2,f,u,p,d)}}}};var Dp=5,Up=4,kp=3,Hp=2,zp=1,Yp=0,D0={[Dp]:ot("#7F8C8D"),[Up]:ot("#2ECC71"),[kp]:ot("#4794C8"),[Hp]:ot("#F39C12"),[zp]:ot("#C0392B"),[Yp]:[""]};function ot(e){return[`background: ${e}`,"border-radius: 0.5em","color: white","font-weight: bold","padding: 2px 0.5em"]}var U0=Symbol("level"),k0=Symbol("domain");var We=0,Gp=class{constructor(t){this._heap=[],this._comparator=t}get size(){return this._heap.length}clear(){this._heap.length=0}push(...t){for(let n of t)this._heap.push(n),this._shiftUp()}pop(){let t=this.peek(),n=$p(this);return n>We&&this._swap(We,n),this._heap.pop(),this._shiftDown(),t}replace(t){let n=this.peek();return this._heap[We]=t,this._shiftDown(),n}peek(){return this._heap[We]}at(t){return this._heap[t]}indexOf(t,n=void 0){return this._heap.indexOf(t,n)}splice(t,n=void 0){return this._heap.splice(t,n)}_compare(t,n){return this._comparator(this._heap[t],this._heap[n])}_swap(t,n){let r=this._heap[t];this._heap[t]=this._heap[n],this._heap[n]=r}_shiftUp(){let t=this._heap.length-1,n;for(;t>We&&this._compare(t,n=Vp(t));)this._swap(t,n),t=n}_shiftDown(){let t=this._heap.length,n=We,r,i=Rs(n),s=i<t,a=Is(n),o=a<t;for(;s&&this._compare(i,n)||o&&this._compare(a,n);)r=o&&this._compare(a,i)?a:i,this._swap(n,r),n=r,i=Rs(n),s=i<t,a=Is(n),o=a<t}values(){return this._heap}[Symbol.iterator](){return this._heap[Symbol.iterator]()}};function $p(e){return e._heap.length-1}function Vp(e){return(e+1>>>1)-1}function Rs(e){return(e<<1)+1}function Is(e){return e+1<<1}function Ce(e,t,n){return Math.min(n,Math.max(t,e))}var H0=Math.PI/180,z0=180/Math.PI;var xe=[{stars:[16774367],skies:[11007231,15377902],streaks:[8766926,6591951],clouds:[[13693691,16508880]],columns:[13300991,13303795,6011098],rows:[13300991,6011098,13303795],seas:[3902694,13303795]},{stars:[16777215],skies:[16555445,16774359],streaks:[16178095,16776936],clouds:[[16777215,16776936],[16777215,16776936],[16777215,16776936],[12748716,10973587]],columns:[16777215,16777215,16777215,15724741,8151940],rows:[16776935,12163267,12028345],seas:[16776935,12028345]},{stars:[16448250],skies:[8550580,11845350],streaks:[11837670,13484018],clouds:[[16777215,14741247]],columns:[10665701,5472705,4998547],rows:[4815292,3696037,1789849,1591177],seas:[4815292,1789849]}];function zt(e,t){let n=e/t;return Math.floor(n*xe.length)}function Yt(e,t){let n=t/xe.length;return e%n/n}function He(e,t,n,r){let i=xe[e],s=xe[e>=xe.length-1?0:e+1];return ne.mix(i[n][r],s[n][r],t)}function ze(e,t,n,r){let i=xe[e],s=xe[e>=xe.length-1?0:e+1],a=Math.floor(n*i[r].length),o=Math.floor(n*s[r].length),l=i[r][a],c=s[r][o];return ne.mix(l,c,t)}function Cs(e,t,n,r){let i=xe[e],s=xe[e>=xe.length-1?0:e+1],a=Math.floor(n*i[r].length),o=Math.floor(n*s[r].length),l=i[r][a],c=s[r][o],h=[];for(let f=0;f<l.length;++f)h.push(ne.mix(l[f],c[f],t));return h}var Kp=40,Wp=12,jp=4,qp=6,Xp=8,lt={StarImage:new X("star.png",ie,void 0,"raw://star.png"),BlurStrokeImage:new X("blur_stroke.png",ie,void 0,"raw://blur_stroke.png"),CircleImage:new X("circle.png",ie,void 0,"raw://circle.png"),CloudImage:new X("cloud.png",ie,void 0,"raw://cloud.png")};async function Ls(e){await ce(e.assets,Object.values(lt))}function Ns(e){let t=e.display.width,n=e.display.height;return{stars:ct(()=>Qp(t,n),Kp),streaks:ct(()=>Zp(t,n),Wp),bigStreaks:ct(()=>Jp(t,n),jp),shades:ct(()=>ed(t,n),qp),clouds:ct(()=>td(t,n),Xp)}}function ct(e,t){let n=[];for(let r=0;r<t;++r)n.push(e());return n}function Os(e,t,n){let r=e,i=t.display.width,s=t.display.height,{streaks:a,bigStreaks:o,clouds:l}=n;for(let c of a)if(c.progress+=r/50*c.speed,c.progress>c.y*2+c.length){let h=R.range(-i/2,i);c.x=h,c.y=s,c.progress=0,c.speed=R.range(.1,2),c.opacity=R.range(.1,.3),c.radius=R.range(.5,1),c.length=R.range(1,2)}for(let c of o)if(c.progress+=r/50*c.speed,c.progress>c.y*2+c.length){let h=R.range(-i/2,i);c.x=h,c.y=s,c.progress=0,c.speed=R.range(.1,.5),c.opacity=R.range(.1,.5),c.radius=R.range(.5,1)*3,c.length=R.range(1,2)*3}for(let c of l)c.progress+=r/100*c.speed,c.progress>i-c.x+300&&(c.w=R.range(2,4),c.h=R.range(.2,1),c.x=-i,c.y=R.range(0,s*.6),c.progress=0,c.speed=R.range(.5,3))}function Bs(e,t,n){let r=t.now,i=t.display.width,s=t.display.height,{shades:a,streaks:o,bigStreaks:l,stars:c,clouds:h}=n,f=6e4,u=r%f,p=zt(u,f),d=Yt(u,f),v=He(p,d,"skies",0),m=He(p,d,"skies",1);e.drawGradientRect(v,m,0,0,i,s);for(let g of a){let N=ne.mix(v,m,Ce(g.y/s-.06,0,1));e.setColor(N),e.setScale(i/16,g.height/16),e.setTranslation(g.x,g.y),e.drawCircle(),e.resetTransform()}e.setTextureImage(2,lt.BlurStrokeImage.current),e.setRotation(0,0,-45);for(let g of o){let N=g.progress/100,A=ze(p,d,g.spicy,"streaks");e.setColor(A),e.setOpacityFloat(Math.min(N,g.opacity)),e.setScale(g.length,g.radius),e.setTranslation(g.x,g.y),e.drawTexturedBox(2,g.progress)}for(let g of l){let N=g.progress/100,A=ze(p,d,g.spicy,"streaks");e.setColor(A),e.setOpacityFloat(Math.min(N,g.opacity)),e.setScale(g.length,g.radius),e.setTranslation(g.x,g.y),e.drawTexturedBox(2,g.progress)}e.setOpacityFloat(1),e.resetTransform();let E=r/400%i,C=r/400%s;e.setTextureImage(0,lt.StarImage.current);for(let g of c){let N=ze(p,d,g.spicy,"stars");e.setColor(N),e.setOpacityFloat(g.opacity);let A=Math.sin(r/500*g.wiggleSpeed+g.wiggleOffset)+1,M=(g.x+E)%i,B=(g.y+C)%s;e.drawTexturedBox(0,M,s-B,16*g.scale,16*g.scale+A*g.scale*8)}e.setOpacityFloat(1);let w=He(p,d,"stars",0);e.setColor(w),e.setTextureImage(3,lt.CircleImage.current),e.drawTexturedBox(3,i*.66,200);let S=lt.CloudImage.current;e.setTextureImage(4,S);let T=-S.height/2;for(let g of h){let[N,A]=Cs(p,d,g.spicy,"clouds"),M=g.x+g.progress;e.setColor(N),e.setScale(g.w*1.2,g.h*1.2),e.setTranslation(M,g.y);let B=M/i;e.drawTexturedBox(4,10*(-B*2+1),T),e.setColor(A),e.setScale(g.w,g.h),e.setTranslation(M,g.y),e.drawTexturedBox(4,0,T)}e.resetTransform()}function Qp(e,t){return{x:R.rangeInt(0,e),y:R.rangeInt(0,t),scale:R.range(.1,.4),opacity:R.range(.3,1),wiggleSpeed:R.range(.8,1.2),wiggleOffset:R.range(0,2),spicy:R.next()}}function Zp(e,t){let n=R.range(-e/2,e),r=R.range(0,t),i;r<e*.6?i=0:i=.99;let s=R.range(1,2);return{x:n,y:r,spicy:i,progress:R.range(0,t),speed:R.range(.1,1.5),opacity:R.range(.1,.3),radius:R.range(.5,1)*s,length:R.range(1,2)*s}}function Jp(e,t){let n=R.range(-e/2,e),r=R.rangeInt(0,t);return{x:n,y:r,spicy:.99,progress:0,speed:R.range(.1,.5),opacity:R.range(.1,.5),radius:R.range(.5,1)*3,length:R.range(1,2)*3}}function ed(e,t){let n=R.range(0,e),r=R.range(0,t),i=R.range(50,80);return{x:n,y:r,opacity:1,height:i}}function td(e,t){let n=R.range(0,e),r=R.range(0,t*.6),i=R.range(2,4),s=R.range(.2,1);return{x:n,y:r,w:i,h:s,spicy:R.next(),progress:0,speed:R.range(.5,3)}}var nd=60,rd=40,id=10,sd=8,nr={Wave1Image:new X("wave1.png",ie,void 0,"raw://wave1.png"),Wave2Image:new X("wave2.png",ie,void 0,"raw://wave2.png")};async function Ps(e){await ce(e.assets,Object.values(nr))}function Fs(e){let t=e.display.width,n=e.display.height;return{sparkles:Gt(()=>ad(t,n),nd),foams:Gt(()=>od(t,n),rd),columns:Gt(()=>ld(t,n),id),rows:Gt(()=>cd(t,n),sd)}}function Gt(e,t){let n=[];for(let r=0;r<t;++r)n.push(e());return n}function Ds(e,t,n){}function Us(e,t,n){let r=t.now,i=t.display.canvas,s=t.display.width,a=t.display.height,{columns:o,rows:l,sparkles:c,foams:h}=n,f=6e4,u=r%f,p=zt(u,f),d=Yt(u,f),v=i.height-200,m=He(p,d,"seas",0),E=He(p,d,"seas",1);e.drawGradientRect(m,E,0,v,s,a),e.setOpacityFloat(.6);for(let g of o){let N=ze(p,d,g.spicy,"columns");e.setColor(N),e.drawRect(g.x,v,g.x+g.width,i.height)}e.setOpacityFloat(1);for(let g of l){let N=ze(p,d,g.spicy,"rows");e.setColor(N),e.setScale(g.height,1),e.setTranslation(g.x,g.y),e.drawCircle()}e.resetTransform();let C=10,w=i.height-150,S=w-v;e.setRotation(0,0,45);for(let g of c){e.setColor(16777215);let N=(Math.sin(r/1e3+g.sparkleOffset)+1)/2;e.setOpacityFloat(N);let A=10*(Math.sin(r/5e3+g.sparkleOffset)+1)/2;e.setTranslation(g.x+A,g.y,C);let M=(v-g.y)/S;e.setScale(.5+M,.5+M),e.drawBox()}e.setOpacityFloat(1),e.resetTransform();let T=i.height-v;for(let g of h){e.setColor(16777215);let N=Ce((Math.sin(r/1e3+g.opacity)+1)/2*2,0,1);e.setOpacityFloat(N);let A=100*(Math.sin(r/5e3+g.opacity)+1)/2;e.setTranslation(g.x+A,g.y,C);let M=(g.y-w)/T;e.setScale(.1+M,(.1+M)*.5);let B;switch(g.wave){case 0:B=nr.Wave1Image.current;break;default:case 1:B=nr.Wave2Image.current;break}e.setTextureImage(5,B),e.drawTexturedBox(5)}e.setOpacityFloat(1),e.resetTransform()}function ad(e,t){let n=R.range(0,e),r=R.range(t-190,t-150);return{x:n,y:r,sparkleOffset:R.range(0,Math.PI*2)}}function od(e,t){let n=R.range(0,e),r=R.range(t-150,t),i=R.choose([0,1]);return{x:n,y:r,wave:i,opacity:R.range(0,Math.PI*2)}}function ld(e,t){let n=R.range(0,e),r=R.range(50,100);return{x:n,width:r,spicy:R.next()}}function cd(e,t){let n=R.range(0,e),r=R.range(t-190,t-20),i=R.range(20,60),s;if(R.next()<.6){let a=(r-(t-190))/200;a<.3?s=0:a<.6?s=.4:s=.9}else s=R.next();return{x:n,y:r,height:i,spicy:s}}var hd={};async function ks(e){await ce(e.assets,Object.values(hd))}function Hs(e){let t=[];for(let n=0;n<10;++n)t.push({x:0,y:0,startTime:0,dead:!1});return{ripples:t}}function zs(e,t,n){for(let r of n.ripples){if(r.dead)continue;t.now-r.startTime>$t&&(r.dead=!0)}}function Ys(e,t,n){let r=t.now;for(let i of n.ripples)i.dead||je(e,i.x,i.y,i.startTime,r,!1)}function Gs(e,t,n,r){let i=null;for(let s of e.ripples)if(s.dead){i=s;break}return i&&(i.x=t,i.y=n,i.startTime=r,i.dead=!1),i}var $t=8e3;function je(e,t,n,r,i,s=!1){let a=i-r;if(s)a%=$t;else if(a>=$t)return;let o=1-a/$t,l=(1-o)*.9,c=(1-o)*.5;e.setColor(16777215),e.setTranslation(t,n,10),e.setScale(2+l*2,.5+l),e.setOpacityFloat(o),e.drawLineCircle(),e.setScale(1+c*2,.1+c),e.drawLineCircle(),e.setOpacityFloat(1),e.resetTransform()}var fd={};async function $s(e){await ce(e.assets,Object.values(fd))}var ud=4,pd=.6,rr=800,dd=100,md=1e3,Y={IDLE:0,POWERING:1,CASTING:2,PLOPPING:3,BOBBING:4,NIBBLING:5,BITING:6,REELING:7,CAUGHT:8};function Vs(e){let t=e.display.width,n=e.display.height,r=t-200,i=n-200;return{fishingState:Y.IDLE,headX:r,headY:i,bobX:r,bobY:i,castingStartTime:0,castingPowerX:-10,castingPowerY:10,nibblingStartTime:0,bitingStartTime:0,hookedItem:null}}function vd(e){return 2e3}function Ks(e,t,n){let r=e,i=t.display.canvas,s=t.display.width,o=t.display.height-60;switch(n.fishingState){case Y.IDLE:break;case Y.POWERING:n.bobX=n.headX,n.bobY=n.headY;break;case Y.CASTING:{n.castingPowerY-=pd;let h=n.castingPowerX,f=n.castingPowerY*-1;n.bobX+=h,n.bobY+=f,n.bobY>=o&&(n.bobY=o,n.fishingState=Y.PLOPPING)}break;case Y.PLOPPING:n.fishingState=Y.BOBBING;break;case Y.BOBBING:break;case Y.NIBBLING:t.now-n.nibblingStartTime>md&&(n.fishingState=Y.BOBBING);break;case Y.BITING:{let h=t.now-n.bitingStartTime,f=vd(n.hookedItem);h>f&&(n.hookedItem=null,n.fishingState=Y.BOBBING)}break;case Y.REELING:let l=n.headX-n.bobX,c=n.headY-n.bobY;Math.abs(l)>ud?(n.bobX+=l*.2,n.bobY+=c*.2):(n.fishingState=Y.CAUGHT,n.bobX=n.headX,n.bobY=n.headY);break;case Y.CAUGHT:n.fishingState=Y.IDLE;break}xd(t,n)}function xd(e,t){switch(t.fishingState){case Y.IDLE:Ae.Fish.pressed&&(t.fishingState=Y.POWERING,t.castingStartTime=e.now);break;case Y.POWERING:if(Ae.Fish.released){let n=e.now-t.castingStartTime,r=Ce(n,dd,rr)/rr;t.castingPowerX=-15*r,t.castingPowerY=15*r,t.fishingState=Y.CASTING}break;case Y.CASTING:case Y.PLOPPING:case Y.BOBBING:case Y.NIBBLING:case Y.BITING:Ae.Fish.pressed&&(t.fishingState=Y.REELING);break;case Y.REELING:case Y.CAUGHT:break}}function Ws(e,t,n){let r=t.now,i=t.display.canvas,s=t.display.width,a=t.display.height;if(e.setDepthFloat(50),n.fishingState===Y.IDLE)return;let o=n.bobX,l=n.bobY,c=1;if(n.fishingState===Y.BOBBING){let u=Math.sin(r/500);l+=2-u*2,c=Ce((u+1)*.5,.5,1)}let h=Math.max(o,n.headX)-Math.min(o,n.headX);e.setColor(0),h>4&&(n.fishingState===Y.REELING?e.drawLine(n.headX,n.headY,o,l):e.drawQuadratic(n.headX,n.headY,o,l,Ce(40-h/60,0,40)));let f=0;n.fishingState===Y.POWERING&&(f=Ce((r-n.castingStartTime)/rr,0,1)*20),e.setOpacityFloat(c),e.setColor(16777215),e.drawCircle(o+f,l+f/2),e.setColor(16711680),e.drawHalfCircle(o+f,l+f/2),e.setOpacityFloat(1),n.fishingState===Y.BOBBING&&(e.setColor(16777215),e.setTranslation(0,0,50),e.pushTransform(),je(e,o,n.bobY,0,r,!0),e.popTransform(),e.resetTransform()),n.hookedItem}var ir=class{constructor(t,n){this.name=t,this.factory=n}create(){return this.factory()}delete(t){}};var js={FishImage:new X("fishShadow",ie,void 0,"raw://fish_shadow.png")},gd=new ir("fish",()=>({x:0,y:0,offset:0,size:0,speed:0}));async function qs(e){await ce(e.assets,Object.values(js))}function Xs(e){let t=e.display.width,n=e.display.height,r=[];for(let i=0;i<6;++i){let s=gd.create();s.x=R.range(0,t),s.y=R.range(n-100,n),s.offset=R.range(0,Math.PI*2),s.size=R.range(.3,.5),s.speed=R.range(1,3)*R.sign(),r.push(s)}return{fishes:r}}function Qs(e,t,n,r){let i=t.display.width,s=t.display.height,a=t.now,{fishes:o}=n;for(let l of o)l.x+=(.2+(Math.sin(a/1e3+l.offset)+1)/2)*l.speed,l.x>i&&(l.x=0,l.y=R.range(s-100,s)),l.x<0&&(l.x=i,l.y=R.range(s-100,s)),Math.floor(a/10+l.y*10)%400==0&&Math.random()<.1&&Gs(r,l.x,l.y-5,a)}function Zs(e,t,n){e.setTextureImage(6,js.FishImage.current),e.setColor(3355443);for(let r of n.fishes){e.pushTransform();let i=Math.sin(r.x/5+r.y),s=Math.cos(r.x/20);e.setTranslation(r.x,r.y+s*4),e.setOpacityFloat(.5),e.setRotation(0,0,90+i*4+(r.speed<0?180:0)),e.setScale(r.size,r.size+(s+1)/2*.1),e.drawTexturedBox(6,0,20),e.popTransform()}e.setOpacityFloat(1),e.resetTransform()}var yd={};async function Js(e){await ce(e.assets,Object.values(yd))}function ea(e){return{player:{x:e.display.width-100,y:0,motionX:0}}}function ta(e,t,n,r){let i=t.display.width,s=t.display.height,a=n.player,l=1-.4,c=Ae.MoveRight.value-Ae.MoveLeft.value;a.motionX+=c*e*.1,a.motionX*=l,a.x+=a.motionX,a.y=s-200,r.headX=a.x,r.headY=a.y,(r.fishingState===Y.IDLE||r.fishingState===Y.POWERING)&&(r.bobX=a.x,r.bobY-a.y),a.x>i-10?a.x=i-10:a.x<i-130&&(a.x=i-130)}function na(e,t,n){let r=n.player;e.setColor(65450),e.drawCircle(r.x,r.y),e.pushTransform(),e.setTranslation(r.x,r.y+75),e.setScale(3,1),e.setColor(3355443),e.setOpacityFloat(.3),e.drawCircle(),e.setOpacityFloat(1),e.popTransform()}function ra(){let e=document.querySelector("#display"),t=document.querySelector("#inputs").getContext("axisbutton"),n=new Tn;return{display:e,inputs:t,assets:n,now:0,deltaTime:0}}Xe.define();window.addEventListener("DOMContentLoaded",_d);async function _d(){let e=ra();await Ed(e)}async function Ed(e){let{display:t}=e,n=t.canvas,r=new tr(n.getContext("webgl")),i=t.width,s=t.height;Li(e.inputs),await Ni(e.assets),await Ls(e),await Ps(e),await $s(e),await qs(e),await ks(e),await Js(e);let a=Ns(e),o=Fs(e),l=Vs(e),c=Hs(e),h=Xs(e),f=ea(e),u={progression:0};t.addEventListener("frame",p=>{let{deltaTime:d,now:v}=p.detail;i=e.display.width,s=e.display.height,e.inputs.poll(v),Ad(u);let m=Ae.FastForward.current.down?30:1;d*=m,v*=m,e.deltaTime=d,e.now=v,Os(d,e,a),Ds(d,e,o),Ks(d,e,l),zs(d,e,c),Qs(d,e,h,c),ta(d,e,f,l),r.resize(),r.reset(),r.setTranslation(0,0,-10),r.pushTransform(),Bs(r,e,a),Us(r,e,o),r.popTransform(),Zs(r,e,h),Ys(r,e,c),r.setTranslation(i-50,s-110),r.setScale(20,3),r.setColor(3355443),r.setOpacityFloat(.3),r.drawCircle(),r.setOpacityFloat(1),r.resetTransform(),r.setColor(16777215),je(r,i-180,s-113,3e3,v,!0),je(r,i-100,s-92,5e3,v,!0),r.setTranslation(0,0,20),r.setColor(10057562),r.setTextureImage(8,pe.PierLegImage.current),r.drawTexturedBox(8,i-100,s-110,10,20),r.drawTexturedBox(8,i-180,s-120,8,10,0,30),r.setTextureImage(7,pe.PierImage.current),r.drawTexturedRect(7,i-pe.PierImage.current.width,s-140,i,s-100),r.resetTransform(),r.setTranslation(0,0,30),r.setTextureImage(9,pe.BucketImage.current),r.setColor(12833752),r.drawTexturedBox(9,i-140,s-140,15),na(r,e,f),Ws(r,e,l),r.resetTransform()})}function Ad(e){if(!pe.MusicBack.current.isPlaying()&&(pe.MusicBack.current.setGain(.4).play(),!pe.MusicLayer1.current.isPlaying()&&!pe.MusicLayer2.current.isPlaying())){let t=R.rangeInt(4,6);e.progression+=t,e.progression<8&&R.next()<e.progression/10?(pe.MusicLayer1.current.setGain(.6).play(),e.progression+=R.rangeInt(-4,4)):e.progression>8&&(pe.MusicLayer2.current.setGain(.6).play(),e.progression/=2)}}})();
//# sourceMappingURL=main.js.map
