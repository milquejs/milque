(()=>{var Rr=Object.create;var Oe=Object.defineProperty;var Cr=Object.getOwnPropertyDescriptor;var Tr=Object.getOwnPropertyNames;var Or=Object.getPrototypeOf,Lr=Object.prototype.hasOwnProperty;var Ir=(t,e)=>()=>(t&&(e=t(t=0)),e);var le=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Le=(t,e)=>{for(var n in e)Oe(t,n,{get:e[n],enumerable:!0})},Dt=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of Tr(e))!Lr.call(t,s)&&s!==n&&Oe(t,s,{get:()=>e[s],enumerable:!(r=Cr(e,s))||r.enumerable});return t};var Nr=(t,e,n)=>(n=t!=null?Rr(Or(t)):{},Dt(e||!t||!t.__esModule?Oe(n,"default",{value:t,enumerable:!0}):n,t)),Pr=t=>Dt(Oe({},"__esModule",{value:!0}),t);var Un={};Le(Un,{basename:()=>Kn,default:()=>uo,delimiter:()=>$n,dirname:()=>zn,extname:()=>Fn,isAbsolute:()=>wt,join:()=>Bn,normalize:()=>_t,relative:()=>Dn,resolve:()=>Ue,sep:()=>Hn});function kn(t,e){for(var n=0,r=t.length-1;r>=0;r--){var s=t[r];s==="."?t.splice(r,1):s===".."?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function Ue(){for(var t="",e=!1,n=arguments.length-1;n>=-1&&!e;n--){var r=n>=0?arguments[n]:"/";if(typeof r!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!r)continue;t=r+"/"+t,e=r.charAt(0)==="/"}return t=kn(Mt(t.split("/"),function(s){return!!s}),!e).join("/"),(e?"/":"")+t||"."}function _t(t){var e=wt(t),n=po(t,-1)==="/";return t=kn(Mt(t.split("/"),function(r){return!!r}),!e).join("/"),!t&&!e&&(t="."),t&&n&&(t+="/"),(e?"/":"")+t}function wt(t){return t.charAt(0)==="/"}function Bn(){var t=Array.prototype.slice.call(arguments,0);return _t(Mt(t,function(e,n){if(typeof e!="string")throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))}function Dn(t,e){t=Ue(t).substr(1),e=Ue(e).substr(1);function n(h){for(var c=0;c<h.length&&h[c]==="";c++);for(var f=h.length-1;f>=0&&h[f]==="";f--);return c>f?[]:h.slice(c,f-c+1)}for(var r=n(t.split("/")),s=n(e.split("/")),i=Math.min(r.length,s.length),a=i,o=0;o<i;o++)if(r[o]!==s[o]){a=o;break}for(var l=[],o=a;o<r.length;o++)l.push("..");return l=l.concat(s.slice(a)),l.join("/")}function zn(t){var e=bt(t),n=e[0],r=e[1];return!n&&!r?".":(r&&(r=r.substr(0,r.length-1)),n+r)}function Kn(t,e){var n=bt(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n}function Fn(t){return bt(t)[3]}function Mt(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}var fo,bt,Hn,$n,uo,po,Yn=Ir(()=>{fo=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,bt=function(t){return fo.exec(t).slice(1)};Hn="/",$n=":";uo={extname:Fn,basename:Kn,dirname:zn,sep:Hn,delimiter:$n,relative:Dn,join:Bn,isAbsolute:wt,normalize:_t,resolve:Ue};po="ab".substr(-1)==="b"?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}});var qe=le((kl,Ye)=>{var ce=(Yn(),Pr(Un));if(ce&&ce.default){Ye.exports=ce.default;for(let t in ce)Ye.exports[t]=ce[t]}else ce&&(Ye.exports=ce)});var we=le((Bl,Vn)=>{"use strict";var mo=qe(),ne="\\\\/",qn=`[^${ne}]`,ie="\\.",vo="\\+",go="\\?",je="\\/",yo="(?=.)",jn="[^/]",At=`(?:${je}|$)`,Gn=`(?:^|${je})`,St=`${ie}{1,2}${At}`,xo=`(?!${ie})`,Eo=`(?!${Gn}${St})`,bo=`(?!${ie}{0,1}${At})`,_o=`(?!${St})`,wo=`[^.${je}]`,Mo=`${jn}*?`,Wn={DOT_LITERAL:ie,PLUS_LITERAL:vo,QMARK_LITERAL:go,SLASH_LITERAL:je,ONE_CHAR:yo,QMARK:jn,END_ANCHOR:At,DOTS_SLASH:St,NO_DOT:xo,NO_DOTS:Eo,NO_DOT_SLASH:bo,NO_DOTS_SLASH:_o,QMARK_NO_DOT:wo,STAR:Mo,START_ANCHOR:Gn},Ao={...Wn,SLASH_LITERAL:`[${ne}]`,QMARK:qn,STAR:`${qn}*?`,DOTS_SLASH:`${ie}{1,2}(?:[${ne}]|$)`,NO_DOT:`(?!${ie})`,NO_DOTS:`(?!(?:^|[${ne}])${ie}{1,2}(?:[${ne}]|$))`,NO_DOT_SLASH:`(?!${ie}{0,1}(?:[${ne}]|$))`,NO_DOTS_SLASH:`(?!${ie}{1,2}(?:[${ne}]|$))`,QMARK_NO_DOT:`[^.${ne}]`,START_ANCHOR:`(?:^|[${ne}])`,END_ANCHOR:`(?:[${ne}]|$)`},So={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};Vn.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:So,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:mo.sep,extglobChars(t){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${t.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(t){return t===!0?Ao:Wn}}});var Ge=le(X=>{"use strict";var Ro=qe(),Co=!1,{REGEX_BACKSLASH:To,REGEX_REMOVE_BACKSLASH:Oo,REGEX_SPECIAL_CHARS:Lo,REGEX_SPECIAL_CHARS_GLOBAL:Io}=we();X.isObject=t=>t!==null&&typeof t=="object"&&!Array.isArray(t);X.hasRegexChars=t=>Lo.test(t);X.isRegexChar=t=>t.length===1&&X.hasRegexChars(t);X.escapeRegex=t=>t.replace(Io,"\\$1");X.toPosixSlashes=t=>t.replace(To,"/");X.removeBackslashes=t=>t.replace(Oo,e=>e==="\\"?"":e);X.supportsLookbehinds=()=>{let t=process.version.slice(1).split(".").map(Number);return t.length===3&&t[0]>=9||t[0]===8&&t[1]>=10};X.isWindows=t=>t&&typeof t.windows=="boolean"?t.windows:Co===!0||Ro.sep==="\\";X.escapeLast=(t,e,n)=>{let r=t.lastIndexOf(e,n);return r===-1?t:t[r-1]==="\\"?X.escapeLast(t,e,r-1):`${t.slice(0,r)}\\${t.slice(r)}`};X.removePrefix=(t,e={})=>{let n=t;return n.startsWith("./")&&(n=n.slice(2),e.prefix="./"),n};X.wrapOutput=(t,e={},n={})=>{let r=n.contains?"":"^",s=n.contains?"":"$",i=`${r}(?:${t})${s}`;return e.negated===!0&&(i=`(?:^(?!${i}).*$)`),i}});var rr=le((Hl,nr)=>{"use strict";var Xn=Ge(),{CHAR_ASTERISK:Rt,CHAR_AT:No,CHAR_BACKWARD_SLASH:Me,CHAR_COMMA:Po,CHAR_DOT:Ct,CHAR_EXCLAMATION_MARK:Tt,CHAR_FORWARD_SLASH:tr,CHAR_LEFT_CURLY_BRACE:Ot,CHAR_LEFT_PARENTHESES:Lt,CHAR_LEFT_SQUARE_BRACKET:ko,CHAR_PLUS:Bo,CHAR_QUESTION_MARK:Qn,CHAR_RIGHT_CURLY_BRACE:Do,CHAR_RIGHT_PARENTHESES:Zn,CHAR_RIGHT_SQUARE_BRACKET:Ho}=we(),Jn=t=>t===tr||t===Me,er=t=>{t.isPrefix!==!0&&(t.depth=t.isGlobstar?1/0:1)},$o=(t,e)=>{let n=e||{},r=t.length-1,s=n.parts===!0||n.scanToEnd===!0,i=[],a=[],o=[],l=t,h=-1,c=0,f=0,u=!1,d=!1,x=!1,y=!1,p=!1,_=!1,L=!1,M=!1,C=!1,S=!1,T=0,D,A,O={value:"",depth:0,isGlob:!1},k=()=>h>=r,v=()=>l.charCodeAt(h+1),I=()=>(D=A,l.charCodeAt(++h));for(;h<r;){A=I();let Y;if(A===Me){L=O.backslashes=!0,A=I(),A===Ot&&(_=!0);continue}if(_===!0||A===Ot){for(T++;k()!==!0&&(A=I());){if(A===Me){L=O.backslashes=!0,I();continue}if(A===Ot){T++;continue}if(_!==!0&&A===Ct&&(A=I())===Ct){if(u=O.isBrace=!0,x=O.isGlob=!0,S=!0,s===!0)continue;break}if(_!==!0&&A===Po){if(u=O.isBrace=!0,x=O.isGlob=!0,S=!0,s===!0)continue;break}if(A===Do&&(T--,T===0)){_=!1,u=O.isBrace=!0,S=!0;break}}if(s===!0)continue;break}if(A===tr){if(i.push(h),a.push(O),O={value:"",depth:0,isGlob:!1},S===!0)continue;if(D===Ct&&h===c+1){c+=2;continue}f=h+1;continue}if(n.noext!==!0&&(A===Bo||A===No||A===Rt||A===Qn||A===Tt)===!0&&v()===Lt){if(x=O.isGlob=!0,y=O.isExtglob=!0,S=!0,A===Tt&&h===c&&(C=!0),s===!0){for(;k()!==!0&&(A=I());){if(A===Me){L=O.backslashes=!0,A=I();continue}if(A===Zn){x=O.isGlob=!0,S=!0;break}}continue}break}if(A===Rt){if(D===Rt&&(p=O.isGlobstar=!0),x=O.isGlob=!0,S=!0,s===!0)continue;break}if(A===Qn){if(x=O.isGlob=!0,S=!0,s===!0)continue;break}if(A===ko){for(;k()!==!0&&(Y=I());){if(Y===Me){L=O.backslashes=!0,I();continue}if(Y===Ho){d=O.isBracket=!0,x=O.isGlob=!0,S=!0;break}}if(s===!0)continue;break}if(n.nonegate!==!0&&A===Tt&&h===c){M=O.negated=!0,c++;continue}if(n.noparen!==!0&&A===Lt){if(x=O.isGlob=!0,s===!0){for(;k()!==!0&&(A=I());){if(A===Lt){L=O.backslashes=!0,A=I();continue}if(A===Zn){S=!0;break}}continue}break}if(x===!0){if(S=!0,s===!0)continue;break}}n.noext===!0&&(y=!1,x=!1);let N=l,P="",m="";c>0&&(P=l.slice(0,c),l=l.slice(c),f-=c),N&&x===!0&&f>0?(N=l.slice(0,f),m=l.slice(f)):x===!0?(N="",m=l):N=l,N&&N!==""&&N!=="/"&&N!==l&&Jn(N.charCodeAt(N.length-1))&&(N=N.slice(0,-1)),n.unescape===!0&&(m&&(m=Xn.removeBackslashes(m)),N&&L===!0&&(N=Xn.removeBackslashes(N)));let g={prefix:P,input:t,start:c,base:N,glob:m,isBrace:u,isBracket:d,isGlob:x,isExtglob:y,isGlobstar:p,negated:M,negatedExtglob:C};if(n.tokens===!0&&(g.maxDepth=0,Jn(A)||a.push(O),g.tokens=a),n.parts===!0||n.tokens===!0){let Y;for(let $=0;$<i.length;$++){let Q=Y?Y+1:c,te=i[$],Z=t.slice(Q,te);n.tokens&&($===0&&c!==0?(a[$].isPrefix=!0,a[$].value=P):a[$].value=Z,er(a[$]),g.maxDepth+=a[$].depth),($!==0||Z!=="")&&o.push(Z),Y=te}if(Y&&Y+1<t.length){let $=t.slice(Y+1);o.push($),n.tokens&&(a[a.length-1].value=$,er(a[a.length-1]),g.maxDepth+=a[a.length-1].depth)}g.slashes=i,g.parts=o}return g};nr.exports=$o});var ar=le(($l,ir)=>{"use strict";var We=we(),J=Ge(),{MAX_LENGTH:Ve,POSIX_REGEX_SOURCE:zo,REGEX_NON_SPECIAL_CHARS:Ko,REGEX_SPECIAL_CHARS_BACKREF:Fo,REPLACEMENTS:sr}=We,Uo=(t,e)=>{if(typeof e.expandRange=="function")return e.expandRange(...t,e);t.sort();let n=`[${t.join("-")}]`;try{new RegExp(n)}catch{return t.map(s=>J.escapeRegex(s)).join("..")}return n},de=(t,e)=>`Missing ${t}: "${e}" - use "\\\\${e}" to match literal characters`,It=(t,e)=>{if(typeof t!="string")throw new TypeError("Expected a string");t=sr[t]||t;let n={...e},r=typeof n.maxLength=="number"?Math.min(Ve,n.maxLength):Ve,s=t.length;if(s>r)throw new SyntaxError(`Input length: ${s}, exceeds maximum allowed length: ${r}`);let i={type:"bos",value:"",output:n.prepend||""},a=[i],o=n.capture?"":"?:",l=J.isWindows(e),h=We.globChars(l),c=We.extglobChars(h),{DOT_LITERAL:f,PLUS_LITERAL:u,SLASH_LITERAL:d,ONE_CHAR:x,DOTS_SLASH:y,NO_DOT:p,NO_DOT_SLASH:_,NO_DOTS_SLASH:L,QMARK:M,QMARK_NO_DOT:C,STAR:S,START_ANCHOR:T}=h,D=w=>`(${o}(?:(?!${T}${w.dot?y:f}).)*?)`,A=n.dot?"":p,O=n.dot?M:C,k=n.bash===!0?D(n):S;n.capture&&(k=`(${k})`),typeof n.noext=="boolean"&&(n.noextglob=n.noext);let v={input:t,index:-1,start:0,dot:n.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:a};t=J.removePrefix(t,v),s=t.length;let I=[],N=[],P=[],m=i,g,Y=()=>v.index===s-1,$=v.peek=(w=1)=>t[v.index+w],Q=v.advance=()=>t[++v.index]||"",te=()=>t.slice(v.index+1),Z=(w="",K=0)=>{v.consumed+=w,v.index+=K},Se=w=>{v.output+=w.output!=null?w.output:w.value,Z(w.value)},Ar=()=>{let w=1;for(;$()==="!"&&($(2)!=="("||$(3)==="?");)Q(),v.start++,w++;return w%2===0?!1:(v.negated=!0,v.start++,!0)},Re=w=>{v[w]++,P.push(w)},oe=w=>{v[w]--,P.pop()},H=w=>{if(m.type==="globstar"){let K=v.braces>0&&(w.type==="comma"||w.type==="brace"),E=w.extglob===!0||I.length&&(w.type==="pipe"||w.type==="paren");w.type!=="slash"&&w.type!=="paren"&&!K&&!E&&(v.output=v.output.slice(0,-m.output.length),m.type="star",m.value="*",m.output=k,v.output+=m.output)}if(I.length&&w.type!=="paren"&&(I[I.length-1].inner+=w.value),(w.value||w.output)&&Se(w),m&&m.type==="text"&&w.type==="text"){m.value+=w.value,m.output=(m.output||"")+w.value;return}w.prev=m,a.push(w),m=w},Ce=(w,K)=>{let E={...c[K],conditions:1,inner:""};E.prev=m,E.parens=v.parens,E.output=v.output;let B=(n.capture?"(":"")+E.open;Re("parens"),H({type:w,value:K,output:v.output?"":x}),H({type:"paren",extglob:!0,value:Q(),output:B}),I.push(E)},Sr=w=>{let K=w.close+(n.capture?")":""),E;if(w.type==="negate"){let B=k;if(w.inner&&w.inner.length>1&&w.inner.includes("/")&&(B=D(n)),(B!==k||Y()||/^\)+$/.test(te()))&&(K=w.close=`)$))${B}`),w.inner.includes("*")&&(E=te())&&/^\.[^\\/.]+$/.test(E)){let F=It(E,{...e,fastpaths:!1}).output;K=w.close=`)${F})${B})`}w.prev.type==="bos"&&(v.negatedExtglob=!0)}H({type:"paren",extglob:!0,value:g,output:K}),oe("parens")};if(n.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(t)){let w=!1,K=t.replace(Fo,(E,B,F,W,G,nt)=>W==="\\"?(w=!0,E):W==="?"?B?B+W+(G?M.repeat(G.length):""):nt===0?O+(G?M.repeat(G.length):""):M.repeat(F.length):W==="."?f.repeat(F.length):W==="*"?B?B+W+(G?k:""):k:B?E:`\\${E}`);return w===!0&&(n.unescape===!0?K=K.replace(/\\/g,""):K=K.replace(/\\+/g,E=>E.length%2===0?"\\\\":E?"\\":"")),K===t&&n.contains===!0?(v.output=t,v):(v.output=J.wrapOutput(K,v,e),v)}for(;!Y();){if(g=Q(),g==="\0")continue;if(g==="\\"){let E=$();if(E==="/"&&n.bash!==!0||E==="."||E===";")continue;if(!E){g+="\\",H({type:"text",value:g});continue}let B=/^\\+/.exec(te()),F=0;if(B&&B[0].length>2&&(F=B[0].length,v.index+=F,F%2!==0&&(g+="\\")),n.unescape===!0?g=Q():g+=Q(),v.brackets===0){H({type:"text",value:g});continue}}if(v.brackets>0&&(g!=="]"||m.value==="["||m.value==="[^")){if(n.posix!==!1&&g===":"){let E=m.value.slice(1);if(E.includes("[")&&(m.posix=!0,E.includes(":"))){let B=m.value.lastIndexOf("["),F=m.value.slice(0,B),W=m.value.slice(B+2),G=zo[W];if(G){m.value=F+G,v.backtrack=!0,Q(),!i.output&&a.indexOf(m)===1&&(i.output=x);continue}}}(g==="["&&$()!==":"||g==="-"&&$()==="]")&&(g=`\\${g}`),g==="]"&&(m.value==="["||m.value==="[^")&&(g=`\\${g}`),n.posix===!0&&g==="!"&&m.value==="["&&(g="^"),m.value+=g,Se({value:g});continue}if(v.quotes===1&&g!=='"'){g=J.escapeRegex(g),m.value+=g,Se({value:g});continue}if(g==='"'){v.quotes=v.quotes===1?0:1,n.keepQuotes===!0&&H({type:"text",value:g});continue}if(g==="("){Re("parens"),H({type:"paren",value:g});continue}if(g===")"){if(v.parens===0&&n.strictBrackets===!0)throw new SyntaxError(de("opening","("));let E=I[I.length-1];if(E&&v.parens===E.parens+1){Sr(I.pop());continue}H({type:"paren",value:g,output:v.parens?")":"\\)"}),oe("parens");continue}if(g==="["){if(n.nobracket===!0||!te().includes("]")){if(n.nobracket!==!0&&n.strictBrackets===!0)throw new SyntaxError(de("closing","]"));g=`\\${g}`}else Re("brackets");H({type:"bracket",value:g});continue}if(g==="]"){if(n.nobracket===!0||m&&m.type==="bracket"&&m.value.length===1){H({type:"text",value:g,output:`\\${g}`});continue}if(v.brackets===0){if(n.strictBrackets===!0)throw new SyntaxError(de("opening","["));H({type:"text",value:g,output:`\\${g}`});continue}oe("brackets");let E=m.value.slice(1);if(m.posix!==!0&&E[0]==="^"&&!E.includes("/")&&(g=`/${g}`),m.value+=g,Se({value:g}),n.literalBrackets===!1||J.hasRegexChars(E))continue;let B=J.escapeRegex(m.value);if(v.output=v.output.slice(0,-m.value.length),n.literalBrackets===!0){v.output+=B,m.value=B;continue}m.value=`(${o}${B}|${m.value})`,v.output+=m.value;continue}if(g==="{"&&n.nobrace!==!0){Re("braces");let E={type:"brace",value:g,output:"(",outputIndex:v.output.length,tokensIndex:v.tokens.length};N.push(E),H(E);continue}if(g==="}"){let E=N[N.length-1];if(n.nobrace===!0||!E){H({type:"text",value:g,output:g});continue}let B=")";if(E.dots===!0){let F=a.slice(),W=[];for(let G=F.length-1;G>=0&&(a.pop(),F[G].type!=="brace");G--)F[G].type!=="dots"&&W.unshift(F[G].value);B=Uo(W,n),v.backtrack=!0}if(E.comma!==!0&&E.dots!==!0){let F=v.output.slice(0,E.outputIndex),W=v.tokens.slice(E.tokensIndex);E.value=E.output="\\{",g=B="\\}",v.output=F;for(let G of W)v.output+=G.output||G.value}H({type:"brace",value:g,output:B}),oe("braces"),N.pop();continue}if(g==="|"){I.length>0&&I[I.length-1].conditions++,H({type:"text",value:g});continue}if(g===","){let E=g,B=N[N.length-1];B&&P[P.length-1]==="braces"&&(B.comma=!0,E="|"),H({type:"comma",value:g,output:E});continue}if(g==="/"){if(m.type==="dot"&&v.index===v.start+1){v.start=v.index+1,v.consumed="",v.output="",a.pop(),m=i;continue}H({type:"slash",value:g,output:d});continue}if(g==="."){if(v.braces>0&&m.type==="dot"){m.value==="."&&(m.output=f);let E=N[N.length-1];m.type="dots",m.output+=g,m.value+=g,E.dots=!0;continue}if(v.braces+v.parens===0&&m.type!=="bos"&&m.type!=="slash"){H({type:"text",value:g,output:f});continue}H({type:"dot",value:g,output:f});continue}if(g==="?"){if(!(m&&m.value==="(")&&n.noextglob!==!0&&$()==="("&&$(2)!=="?"){Ce("qmark",g);continue}if(m&&m.type==="paren"){let B=$(),F=g;if(B==="<"&&!J.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(m.value==="("&&!/[!=<:]/.test(B)||B==="<"&&!/<([!=]|\w+>)/.test(te()))&&(F=`\\${g}`),H({type:"text",value:g,output:F});continue}if(n.dot!==!0&&(m.type==="slash"||m.type==="bos")){H({type:"qmark",value:g,output:C});continue}H({type:"qmark",value:g,output:M});continue}if(g==="!"){if(n.noextglob!==!0&&$()==="("&&($(2)!=="?"||!/[!=<:]/.test($(3)))){Ce("negate",g);continue}if(n.nonegate!==!0&&v.index===0){Ar();continue}}if(g==="+"){if(n.noextglob!==!0&&$()==="("&&$(2)!=="?"){Ce("plus",g);continue}if(m&&m.value==="("||n.regex===!1){H({type:"plus",value:g,output:u});continue}if(m&&(m.type==="bracket"||m.type==="paren"||m.type==="brace")||v.parens>0){H({type:"plus",value:g});continue}H({type:"plus",value:u});continue}if(g==="@"){if(n.noextglob!==!0&&$()==="("&&$(2)!=="?"){H({type:"at",extglob:!0,value:g,output:""});continue}H({type:"text",value:g});continue}if(g!=="*"){(g==="$"||g==="^")&&(g=`\\${g}`);let E=Ko.exec(te());E&&(g+=E[0],v.index+=E[0].length),H({type:"text",value:g});continue}if(m&&(m.type==="globstar"||m.star===!0)){m.type="star",m.star=!0,m.value+=g,m.output=k,v.backtrack=!0,v.globstar=!0,Z(g);continue}let w=te();if(n.noextglob!==!0&&/^\([^?]/.test(w)){Ce("star",g);continue}if(m.type==="star"){if(n.noglobstar===!0){Z(g);continue}let E=m.prev,B=E.prev,F=E.type==="slash"||E.type==="bos",W=B&&(B.type==="star"||B.type==="globstar");if(n.bash===!0&&(!F||w[0]&&w[0]!=="/")){H({type:"star",value:g,output:""});continue}let G=v.braces>0&&(E.type==="comma"||E.type==="brace"),nt=I.length&&(E.type==="pipe"||E.type==="paren");if(!F&&E.type!=="paren"&&!G&&!nt){H({type:"star",value:g,output:""});continue}for(;w.slice(0,3)==="/**";){let Te=t[v.index+4];if(Te&&Te!=="/")break;w=w.slice(3),Z("/**",3)}if(E.type==="bos"&&Y()){m.type="globstar",m.value+=g,m.output=D(n),v.output=m.output,v.globstar=!0,Z(g);continue}if(E.type==="slash"&&E.prev.type!=="bos"&&!W&&Y()){v.output=v.output.slice(0,-(E.output+m.output).length),E.output=`(?:${E.output}`,m.type="globstar",m.output=D(n)+(n.strictSlashes?")":"|$)"),m.value+=g,v.globstar=!0,v.output+=E.output+m.output,Z(g);continue}if(E.type==="slash"&&E.prev.type!=="bos"&&w[0]==="/"){let Te=w[1]!==void 0?"|$":"";v.output=v.output.slice(0,-(E.output+m.output).length),E.output=`(?:${E.output}`,m.type="globstar",m.output=`${D(n)}${d}|${d}${Te})`,m.value+=g,v.output+=E.output+m.output,v.globstar=!0,Z(g+Q()),H({type:"slash",value:"/",output:""});continue}if(E.type==="bos"&&w[0]==="/"){m.type="globstar",m.value+=g,m.output=`(?:^|${d}|${D(n)}${d})`,v.output=m.output,v.globstar=!0,Z(g+Q()),H({type:"slash",value:"/",output:""});continue}v.output=v.output.slice(0,-m.output.length),m.type="globstar",m.output=D(n),m.value+=g,v.output+=m.output,v.globstar=!0,Z(g);continue}let K={type:"star",value:g,output:k};if(n.bash===!0){K.output=".*?",(m.type==="bos"||m.type==="slash")&&(K.output=A+K.output),H(K);continue}if(m&&(m.type==="bracket"||m.type==="paren")&&n.regex===!0){K.output=g,H(K);continue}(v.index===v.start||m.type==="slash"||m.type==="dot")&&(m.type==="dot"?(v.output+=_,m.output+=_):n.dot===!0?(v.output+=L,m.output+=L):(v.output+=A,m.output+=A),$()!=="*"&&(v.output+=x,m.output+=x)),H(K)}for(;v.brackets>0;){if(n.strictBrackets===!0)throw new SyntaxError(de("closing","]"));v.output=J.escapeLast(v.output,"["),oe("brackets")}for(;v.parens>0;){if(n.strictBrackets===!0)throw new SyntaxError(de("closing",")"));v.output=J.escapeLast(v.output,"("),oe("parens")}for(;v.braces>0;){if(n.strictBrackets===!0)throw new SyntaxError(de("closing","}"));v.output=J.escapeLast(v.output,"{"),oe("braces")}if(n.strictSlashes!==!0&&(m.type==="star"||m.type==="bracket")&&H({type:"maybe_slash",value:"",output:`${d}?`}),v.backtrack===!0){v.output="";for(let w of v.tokens)v.output+=w.output!=null?w.output:w.value,w.suffix&&(v.output+=w.suffix)}return v};It.fastpaths=(t,e)=>{let n={...e},r=typeof n.maxLength=="number"?Math.min(Ve,n.maxLength):Ve,s=t.length;if(s>r)throw new SyntaxError(`Input length: ${s}, exceeds maximum allowed length: ${r}`);t=sr[t]||t;let i=J.isWindows(e),{DOT_LITERAL:a,SLASH_LITERAL:o,ONE_CHAR:l,DOTS_SLASH:h,NO_DOT:c,NO_DOTS:f,NO_DOTS_SLASH:u,STAR:d,START_ANCHOR:x}=We.globChars(i),y=n.dot?f:c,p=n.dot?u:c,_=n.capture?"":"?:",L={negated:!1,prefix:""},M=n.bash===!0?".*?":d;n.capture&&(M=`(${M})`);let C=A=>A.noglobstar===!0?M:`(${_}(?:(?!${x}${A.dot?h:a}).)*?)`,S=A=>{switch(A){case"*":return`${y}${l}${M}`;case".*":return`${a}${l}${M}`;case"*.*":return`${y}${M}${a}${l}${M}`;case"*/*":return`${y}${M}${o}${l}${p}${M}`;case"**":return y+C(n);case"**/*":return`(?:${y}${C(n)}${o})?${p}${l}${M}`;case"**/*.*":return`(?:${y}${C(n)}${o})?${p}${M}${a}${l}${M}`;case"**/.*":return`(?:${y}${C(n)}${o})?${a}${l}${M}`;default:{let O=/^(.*?)\.(\w+)$/.exec(A);if(!O)return;let k=S(O[1]);return k?k+a+O[2]:void 0}}},T=J.removePrefix(t,L),D=S(T);return D&&n.strictSlashes!==!0&&(D+=`${o}?`),D};ir.exports=It});var lr=le((zl,or)=>{"use strict";var Yo=qe(),qo=rr(),Nt=ar(),Pt=Ge(),jo=we(),Go=t=>t&&typeof t=="object"&&!Array.isArray(t),j=(t,e,n=!1)=>{if(Array.isArray(t)){let c=t.map(u=>j(u,e,n));return u=>{for(let d of c){let x=d(u);if(x)return x}return!1}}let r=Go(t)&&t.tokens&&t.input;if(t===""||typeof t!="string"&&!r)throw new TypeError("Expected pattern to be a non-empty string");let s=e||{},i=Pt.isWindows(e),a=r?j.compileRe(t,e):j.makeRe(t,e,!1,!0),o=a.state;delete a.state;let l=()=>!1;if(s.ignore){let c={...e,ignore:null,onMatch:null,onResult:null};l=j(s.ignore,c,n)}let h=(c,f=!1)=>{let{isMatch:u,match:d,output:x}=j.test(c,a,e,{glob:t,posix:i}),y={glob:t,state:o,regex:a,posix:i,input:c,output:x,match:d,isMatch:u};return typeof s.onResult=="function"&&s.onResult(y),u===!1?(y.isMatch=!1,f?y:!1):l(c)?(typeof s.onIgnore=="function"&&s.onIgnore(y),y.isMatch=!1,f?y:!1):(typeof s.onMatch=="function"&&s.onMatch(y),f?y:!0)};return n&&(h.state=o),h};j.test=(t,e,n,{glob:r,posix:s}={})=>{if(typeof t!="string")throw new TypeError("Expected input to be a string");if(t==="")return{isMatch:!1,output:""};let i=n||{},a=i.format||(s?Pt.toPosixSlashes:null),o=t===r,l=o&&a?a(t):t;return o===!1&&(l=a?a(t):t,o=l===r),(o===!1||i.capture===!0)&&(i.matchBase===!0||i.basename===!0?o=j.matchBase(t,e,n,s):o=e.exec(l)),{isMatch:!!o,match:o,output:l}};j.matchBase=(t,e,n,r=Pt.isWindows(n))=>(e instanceof RegExp?e:j.makeRe(e,n)).test(Yo.basename(t));j.isMatch=(t,e,n)=>j(e,n)(t);j.parse=(t,e)=>Array.isArray(t)?t.map(n=>j.parse(n,e)):Nt(t,{...e,fastpaths:!1});j.scan=(t,e)=>qo(t,e);j.compileRe=(t,e,n=!1,r=!1)=>{if(n===!0)return t.output;let s=e||{},i=s.contains?"":"^",a=s.contains?"":"$",o=`${i}(?:${t.output})${a}`;t&&t.negated===!0&&(o=`^(?!${o}).*$`);let l=j.toRegex(o,e);return r===!0&&(l.state=t),l};j.makeRe=(t,e={},n=!1,r=!1)=>{if(!t||typeof t!="string")throw new TypeError("Expected a non-empty string");let s={negated:!1,fastpaths:!0};return e.fastpaths!==!1&&(t[0]==="."||t[0]==="*")&&(s.output=Nt.fastpaths(t,e)),s.output||(s=Nt(t,e)),j.compileRe(s,e,n,r)};j.toRegex=(t,e)=>{try{let n=e||{};return new RegExp(t,n.flags||(n.nocase?"i":""))}catch(n){if(e&&e.debug===!0)throw n;return/$^/}};j.constants=jo;or.exports=j});var cr=le((Kl,hr)=>{"use strict";hr.exports=lr()});window.addEventListener("error",Ie,!0);window.addEventListener("unhandledrejection",Ie,!0);var Ht=!1;function Ie(t){Ht||(typeof t=="object"?t instanceof PromiseRejectionEvent?Ie(t.reason):t instanceof ErrorEvent?Ie(t.error):t instanceof Error?window.alert(t.stack):window.alert(JSON.stringify(t)):window.alert(t),Ht=!0)}var kr=`
<div class="container">
  <label class="hidden" id="title">display-port</label>
  <label class="hidden" id="fps">00</label>
  <label class="hidden" id="dimension">0x0</label>
  <div class="content">
    <slot id="inner">
      <canvas>
        Oh no! Your browser does not support canvas.
      </canvas>
    </slot>
    <slot name="overlay"></slot>
  </div>
  <slot name="frame"></slot>
</div>`,Br=`
:host {
  display: inline-block;
  color: #555555;
}

.container {
  display: flex;
  position: relative;
  width: 100%;
  height: 100%;
}

.content {
  position: relative;
  margin: auto;
  overflow: hidden;
}

.content > *:not(canvas) {
  width: 100%;
  height: 100%;
}

canvas {
  background: #000000;
  image-rendering: pixelated;
}

label {
  position: absolute;
  font-family: monospace;
  color: currentColor;
}

#inner {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: 0;
  left: 0;
  pointer-events: none;
}

#title {
  left: 0.5rem;
  top: 0.5rem;
}

#fps {
  right: 0.5rem;
  top: 0.5rem;
}

#dimension {
  left: 0.5rem;
  bottom: 0.5rem;
}

.hidden {
  display: none;
}

:host([debug]) .container {
  outline: 6px dashed rgba(0, 0, 0, 0.1);
  outline-offset: -4px;
  background-color: rgba(0, 0, 0, 0.1);
}

:host([mode='noscale']) canvas {
  margin: 0;
  top: 0;
  left: 0;
}

:host([mode='stretch']) canvas,
:host([mode='scale']) canvas {
  width: 100%;
  height: 100%;
}

:host([mode='fit']),
:host([mode='scale']),
:host([mode='center']),
:host([mode='stretch']),
:host([mode='fill']) {
  width: 100%;
  height: 100%;
}

:host([full]) {
  width: 100vw !important;
  height: 100vh !important;
}

:host([disabled]) {
  display: none;
}

slot {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  pointer-events: none;
}

::slotted(*) {
  pointer-events: auto;
}`,$t="noscale";var rt="fit",zt="scale",Kt="fill",Ft="stretch";var Ut=rt,Dr=200,Yt=class t extends HTMLElement{static create(e={}){let{root:n=document.body,id:r=void 0,mode:s=Ut,width:i=300,height:a=150,debug:o=!1}=e||{},l=new t;return l.id=r,l.mode=s,l.width=i,l.height=a,l.debug=o,n.appendChild(l),l}static define(e=window.customElements){e.define("display-port",this)}static get[Symbol.for("templateNode")](){let e=document.createElement("template");return e.innerHTML=kr,Object.defineProperty(this,Symbol.for("templateNode"),{value:e}),e}static get[Symbol.for("styleNode")](){let e=document.createElement("style");return e.innerHTML=Br,Object.defineProperty(this,Symbol.for("styleNode"),{value:e}),e}static get observedAttributes(){return["debug","disabled","width","height","onframe","id","class"]}get mode(){return this.getAttribute("mode")}set mode(e){this.setAttribute("mode",e)}get debug(){return this._debug}set debug(e){this.toggleAttribute("debug",e)}get disabled(){return this._disabled}set disabled(e){this.toggleAttribute("disabled",e)}get width(){return this._width}set width(e){this.setAttribute("width",String(e))}get height(){return this._height}set height(e){this.setAttribute("height",String(e))}get onframe(){return this._onframe}set onframe(e){this._onframe&&this.removeEventListener("frame",this._onframe),this._onframe=e,this._onframe&&this.addEventListener("frame",e)}constructor(){super();let e=this.attachShadow({mode:"open"});e.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),e.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._canvasElement=null,this._contentElement=e.querySelector(".content"),this._innerElement=e.querySelector("#inner"),this._titleElement=e.querySelector("#title"),this._fpsElement=e.querySelector("#fps"),this._dimensionElement=e.querySelector("#dimension"),this._debug=!1,this._disabled=!1,this._width=300,this._height=150,this._onframe=void 0,this._animationRequestHandle=0,this._prevAnimationFrameTime=0,this._resizeTimeoutHandle=0,this._resizeCanvasWidth=0,this._resizeCanvasHeight=0,this._frameEvent=new CustomEvent("frame",{composed:!0,bubbles:!1,detail:{now:0,prevTime:0,deltaTime:0,canvas:this._canvasElement}}),this._resizeEvent=new CustomEvent("resize",{composed:!0,bubbles:!1,detail:{width:0,height:0}}),this.update=this.update.bind(this),this.onDelayCanvasResize=this.onDelayCanvasResize.bind(this),this.onSlotChange=this.onSlotChange.bind(this)}get canvas(){return this._canvasElement}connectedCallback(){ue(this,"mode"),ue(this,"debug"),ue(this,"disabled"),ue(this,"width"),ue(this,"height"),ue(this,"onframe"),this.hasAttribute("mode")||this.setAttribute("mode",Ut),this.hasAttribute("tabindex")||this.setAttribute("tabindex","0"),this._innerElement.addEventListener("slotchange",this.onSlotChange),this._canvasElement=this._innerElement.querySelector("canvas"),this._canvasElement&&(this.updateCanvasSize(!0),this.resume())}disconnectedCallback(){this._innerElement.removeEventListener("slotchange",this.onSlotChange),this.pause()}attributeChangedCallback(e,n,r){switch(e){case"debug":this._debug=r!==null;break;case"disabled":this._disabled=r!==null;break;case"width":this._width=Number(r);break;case"height":this._height=Number(r);break;case"onframe":this.onframe=new Function("event","with(document){with(this){"+r+"}}").bind(this);break}switch(e){case"disabled":r?(this.update(0),this.pause()):this.resume();break;case"id":case"class":this._titleElement.innerHTML=`display-port${this.className?"."+this.className:""}${this.hasAttribute("id")?"#"+this.getAttribute("id"):""}`;break;case"debug":this._titleElement.classList.toggle("hidden",r),this._fpsElement.classList.toggle("hidden",r),this._dimensionElement.classList.toggle("hidden",r);break}}onSlotChange(e){let s=e.target.assignedElements({flatten:!0}).find(i=>i instanceof HTMLCanvasElement);if(!s)throw new Error("No valid canvas element found for display.");this._canvasElement=s,this.updateCanvasSize(!0),this.resume()}getContext(e="2d",n=void 0){return this._canvasElement.getContext(e,n)}pause(){window.cancelAnimationFrame(this._animationRequestHandle)}resume(){this._animationRequestHandle=window.requestAnimationFrame(this.update)}update(e){this._animationRequestHandle=window.requestAnimationFrame(this.update),this.updateCanvasSize(!1);let n=e-this._prevAnimationFrameTime;if(this._prevAnimationFrameTime=e,this._debug){let i=n<=0?"--":String(Math.round(1e3/n)).padStart(2,"0");if(this._fpsElement.textContent!==i&&(this._fpsElement.textContent=i),this.mode===$t){let o=`${this._width}x${this._height}`;this._dimensionElement.textContent!==o&&(this._dimensionElement.textContent=o)}else{let o=`${this._width}x${this._height}|${this.shadowRoot.host.clientWidth}x${this.shadowRoot.host.clientHeight}`;this._dimensionElement.textContent!==o&&(this._dimensionElement.textContent=o)}}let s=this._frameEvent.detail;s.now=e,s.prevTime=this._prevAnimationFrameTime,s.deltaTime=n,this.dispatchEvent(this._frameEvent)}onDelayCanvasResize(){this._resizeTimeoutHandle=null,this.updateCanvasSize(!0)}delayCanvasResize(e,n){(e!==this._resizeCanvasWidth||n!==this._resizeCanvasHeight)&&(this._resizeCanvasWidth=e,this._resizeCanvasHeight=n,this._resizeTimeoutHandle&&window.clearTimeout(this._resizeTimeoutHandle),this._resizeTimeoutHandle=window.setTimeout(this.onDelayCanvasResize,Dr))}updateCanvasSize(e=!0){let n=this.shadowRoot.host.getBoundingClientRect(),r=n.width,s=n.height,i=this._canvasElement,a=this._width,o=this._height,l=this.mode;if(l===Ft||l===Kt)a=r,o=s;else if(l!==$t&&(r<a||s<o||l===rt||l==zt)){let c=r/a,f=s/o;c<f?(a=r,o=o*c):(a=a*f,o=s)}if(a=Math.floor(a),o=Math.floor(o),typeof e>"u"&&(e=i.clientWidth!==a||i.clientHeight!==o),!e){this.delayCanvasResize(a,o);return}let h=Math.min(a/this._width,o/this._height)*.5;if(this._innerElement.style.fontSize=`font-size: ${h}em`,e){l===zt?(i.width=this._width,i.height=this._height):l!==Ft&&(i.width=a,i.height=o);let c=this._contentElement.style;c.width=`${a}px`,c.height=`${o}px`,(l===rt||l===Kt)&&(this._width=a,this._height=o);let u=this._resizeEvent.detail;u.width=a,u.height=o,this.dispatchEvent(this._resizeEvent)}}};function ue(t,e){if(Object.prototype.hasOwnProperty.call(t,e)){let n=t[e];delete t[e],t[e]=n}}var Hr=`<div class="container">
  <div class="padding"></div>
  <div class="innerContainer">
    <div class="padding"></div>
    <slot><canvas>Oh no! Your browser does not support canvas.</canvas></slot>
    <div class="padding"></div>
  </div>
  <div class="padding"></div>
</div>`,$r=`
:host {
  display: inline-block;
  flex: 1;
  --width: 300px;
  --height: 150px;
}
:host([scaling="noscale"]) {
  width: var(--width);
  height: var(--height);
}
:host([sizing="viewport"]) {
    position: fixed;
    top: 0;
    left: 0;
}
.container {
  position: relative;
  display: flex;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
.innerContainer {
  display: flex;
  flex-direction: column;
}
.padding {
  flex: 1;
}`,qt="scale",zr="conatiner",jt=300,Gt=150,Ne=class t extends HTMLElement{static create(e={}){let{root:n=document.body,id:r=void 0,scaling:s=qt,sizing:i=zr,width:a=jt,height:o=Gt}=e||{};window.customElements.get("flex-canvas")||window.customElements.define("flex-canvas",t);let l=new t;return l.id=r,l.scaling=s,l.sizing=i,l.width=a,l.height=o,n.appendChild(l),l}static define(e=window.customElements){e.define("flex-canvas",this)}static get[Symbol.for("templateNode")](){let e=document.createElement("template");return e.innerHTML=Hr,Object.defineProperty(this,Symbol.for("templateNode"),{value:e}),e}static get[Symbol.for("styleNode")](){let e=document.createElement("style");return e.innerHTML=$r,Object.defineProperty(this,Symbol.for("styleNode"),{value:e}),e}static get observedAttributes(){return["sizing","width","height","resize-delay"]}get scaling(){return this.getAttribute("scaling")}set scaling(e){this.setAttribute("scaling",e)}get sizing(){return this._sizing}set sizing(e){this.setAttribute("sizing",String(e))}get resizeDelay(){return this._resizeDelay}set resizeDelay(e){this.setAttribute("resize-delay",String(e))}get width(){return this._width}set width(e){this.setAttribute("width",String(e))}get height(){return this._height}set height(e){this.setAttribute("height",String(e))}get canvas(){return this.canvasElement}constructor(){super();let e=this.attachShadow({mode:"open"});e.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),e.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._sizing="none",this._width=jt,this._height=Gt,this._resizeDelay=0,this.animationFrameHandle=0,this.resizeTimeoutHandle=0,this.resizeCanvasWidth=0,this.resizeCanvasHeight=0,this.canvasSlotElement=e.querySelector("slot"),this.canvasElement=null,this.onResize=this.onResize.bind(this),this.onAnimationFrame=this.onAnimationFrame.bind(this),this.onSlotChange=this.onSlotChange.bind(this)}connectedCallback(){ve(this,"scaling"),ve(this,"sizing"),ve(this,"width"),ve(this,"height"),ve(this,"resize-delay"),this.hasAttribute("scaling")||this.setAttribute("scaling",qt),this.hasAttribute("tabindex")||this.setAttribute("tabindex","0"),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.canvasSlotElement.addEventListener("slotchange",this.onSlotChange),this.canvasElement||this.setCanvasElement(this.canvasSlotElement.querySelector("canvas"))}disconnectedCallback(){cancelAnimationFrame(this.animationFrameHandle),this.animationFrameHandle=null,this.canvasSlotElement.removeEventListener("slotchange",this.onSlotChange)}attributeChangedCallback(e,n,r){switch(e){case"sizing":switch(this._sizing=String(r),this._sizing){case"none":this.style.removeProperty("width"),this.style.removeProperty("height");break;case"container":this.style.setProperty("width","100%"),this.style.setProperty("height","100%");break;case"viewport":this.style.setProperty("width","100vw"),this.style.setProperty("height","100vh");break;default:let[s,i]=this._sizing.split(" ");s&&i&&(this.style.setProperty("width",s),this.style.setProperty("height",i));break}break;case"width":this._width=Number(r),this.canvasElement&&(this.canvasElement.width=this._width);break;case"height":this._height=Number(r),this.canvasElement&&(this.canvasElement.height=this._height);break;case"resize-delay":this._resizeDelay=Number(r);break}}onAnimationFrame(e){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),!(this.clientWidth===this.resizeCanvasWidth&&this.clientHeight===this.resizeCanvasHeight)&&(this.resizeCanvasWidth=this.clientWidth,this.resizeCanvasHeight=this.clientHeight,this._resizeDelay>0?this.resizeTimeoutHandle||(this.resizeTimeoutHandle=window.setTimeout(this.onResize,this._resizeDelay)):this.onResize())}onResize(){window.clearTimeout(this.resizeTimeoutHandle),this.resizeTimeoutHandle=null;let e=this.canvasElement;if(!e)return;let n=this.scaling,r=this.getBoundingClientRect(),s=r.width,i=r.height,a=this._width,o=this._height,l=s/a,h=i/o;n==="noscale"&&(this.style.setProperty("--width",`${a}px`),this.style.setProperty("--height",`${o}px`)),n==="scale"&&(l<h?(e.style.setProperty("width",`${Math.floor(s)}px`),e.style.setProperty("height",`${Math.floor(o*l)}px`)):(e.style.setProperty("width",`${Math.floor(a*h)}px`),e.style.setProperty("height",`${Math.floor(i)}px`))),n==="stretch"&&(e.style.setProperty("width",`${Math.floor(s)}px`),e.style.setProperty("height",`${Math.floor(i)}px`)),n==="fit"&&(l<h?(a=Math.floor(s),o=Math.floor(o*l),e.style.setProperty("width",`${a}px`),e.style.setProperty("height",`${o}px`)):(a=Math.floor(a*h),o=Math.floor(i),e.style.setProperty("width",`${a}px`),e.style.setProperty("height",`${o}px`)),e.width!==a&&(e.width=a),e.height!==o&&(e.height=o)),n==="fill"&&(l<h?(a=Math.floor(s),o=Math.floor(i),e.style.setProperty("width",`${a}px`),e.style.setProperty("height",`${o}px`)):(a=Math.floor(s),o=Math.floor(i),e.style.setProperty("width",`${a}px`),e.style.setProperty("height",`${o}px`)),e.width!==a&&(e.width=a),e.height!==o&&(e.height=o))}onSlotChange(e){let s=e.target.assignedElements({flatten:!0}).find(i=>i instanceof HTMLCanvasElement);s&&this.setCanvasElement(s)}setCanvasElement(e){e.width=this._width,e.height=this._height,e.style.imageRendering="pixelated",this.canvasElement=e}getContext(e="2d",n=void 0){return this.canvasElement.getContext(e,n)}};function ve(t,e){if(Object.prototype.hasOwnProperty.call(t,e)){let n=t[e];delete t[e],t[e]=n}}var z=1e-6,U=typeof Float32Array<"u"?Float32Array:Array,ae=Math.random;var Ml=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function Wt(){var t=new U(9);return U!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}var q={};Le(q,{add:()=>As,adjoint:()=>Vr,clone:()=>Ur,copy:()=>Yr,create:()=>Fr,determinant:()=>Xr,equals:()=>Ts,exactEquals:()=>Cs,frob:()=>Ms,fromQuat:()=>ds,fromQuat2:()=>hs,fromRotation:()=>is,fromRotationTranslation:()=>Qt,fromRotationTranslationScale:()=>us,fromRotationTranslationScaleOrigin:()=>ps,fromScaling:()=>ss,fromTranslation:()=>rs,fromValues:()=>qr,fromXRotation:()=>as,fromYRotation:()=>os,fromZRotation:()=>ls,frustum:()=>ms,getRotation:()=>fs,getScaling:()=>Zt,getTranslation:()=>cs,identity:()=>Vt,invert:()=>Wr,lookAt:()=>bs,mul:()=>Os,multiply:()=>Xt,multiplyScalar:()=>Ss,multiplyScalarAndAdd:()=>Rs,ortho:()=>xs,orthoNO:()=>en,orthoZO:()=>Es,perspective:()=>vs,perspectiveFromFieldOfView:()=>ys,perspectiveNO:()=>Jt,perspectiveZO:()=>gs,rotate:()=>Jr,rotateX:()=>es,rotateY:()=>ts,rotateZ:()=>ns,scale:()=>Zr,set:()=>jr,str:()=>ws,sub:()=>Ls,subtract:()=>tn,targetTo:()=>_s,translate:()=>Qr,transpose:()=>Gr});function Fr(){var t=new U(16);return U!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Ur(t){var e=new U(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Yr(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function qr(t,e,n,r,s,i,a,o,l,h,c,f,u,d,x,y){var p=new U(16);return p[0]=t,p[1]=e,p[2]=n,p[3]=r,p[4]=s,p[5]=i,p[6]=a,p[7]=o,p[8]=l,p[9]=h,p[10]=c,p[11]=f,p[12]=u,p[13]=d,p[14]=x,p[15]=y,p}function jr(t,e,n,r,s,i,a,o,l,h,c,f,u,d,x,y,p){return t[0]=e,t[1]=n,t[2]=r,t[3]=s,t[4]=i,t[5]=a,t[6]=o,t[7]=l,t[8]=h,t[9]=c,t[10]=f,t[11]=u,t[12]=d,t[13]=x,t[14]=y,t[15]=p,t}function Vt(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Gr(t,e){if(t===e){var n=e[1],r=e[2],s=e[3],i=e[6],a=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=i,t[11]=e[14],t[12]=s,t[13]=a,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Wr(t,e){var n=e[0],r=e[1],s=e[2],i=e[3],a=e[4],o=e[5],l=e[6],h=e[7],c=e[8],f=e[9],u=e[10],d=e[11],x=e[12],y=e[13],p=e[14],_=e[15],L=n*o-r*a,M=n*l-s*a,C=n*h-i*a,S=r*l-s*o,T=r*h-i*o,D=s*h-i*l,A=c*y-f*x,O=c*p-u*x,k=c*_-d*x,v=f*p-u*y,I=f*_-d*y,N=u*_-d*p,P=L*N-M*I+C*v+S*k-T*O+D*A;return P?(P=1/P,t[0]=(o*N-l*I+h*v)*P,t[1]=(s*I-r*N-i*v)*P,t[2]=(y*D-p*T+_*S)*P,t[3]=(u*T-f*D-d*S)*P,t[4]=(l*k-a*N-h*O)*P,t[5]=(n*N-s*k+i*O)*P,t[6]=(p*C-x*D-_*M)*P,t[7]=(c*D-u*C+d*M)*P,t[8]=(a*I-o*k+h*A)*P,t[9]=(r*k-n*I-i*A)*P,t[10]=(x*T-y*C+_*L)*P,t[11]=(f*C-c*T-d*L)*P,t[12]=(o*O-a*v-l*A)*P,t[13]=(n*v-r*O+s*A)*P,t[14]=(y*M-x*S-p*L)*P,t[15]=(c*S-f*M+u*L)*P,t):null}function Vr(t,e){var n=e[0],r=e[1],s=e[2],i=e[3],a=e[4],o=e[5],l=e[6],h=e[7],c=e[8],f=e[9],u=e[10],d=e[11],x=e[12],y=e[13],p=e[14],_=e[15];return t[0]=o*(u*_-d*p)-f*(l*_-h*p)+y*(l*d-h*u),t[1]=-(r*(u*_-d*p)-f*(s*_-i*p)+y*(s*d-i*u)),t[2]=r*(l*_-h*p)-o*(s*_-i*p)+y*(s*h-i*l),t[3]=-(r*(l*d-h*u)-o*(s*d-i*u)+f*(s*h-i*l)),t[4]=-(a*(u*_-d*p)-c*(l*_-h*p)+x*(l*d-h*u)),t[5]=n*(u*_-d*p)-c*(s*_-i*p)+x*(s*d-i*u),t[6]=-(n*(l*_-h*p)-a*(s*_-i*p)+x*(s*h-i*l)),t[7]=n*(l*d-h*u)-a*(s*d-i*u)+c*(s*h-i*l),t[8]=a*(f*_-d*y)-c*(o*_-h*y)+x*(o*d-h*f),t[9]=-(n*(f*_-d*y)-c*(r*_-i*y)+x*(r*d-i*f)),t[10]=n*(o*_-h*y)-a*(r*_-i*y)+x*(r*h-i*o),t[11]=-(n*(o*d-h*f)-a*(r*d-i*f)+c*(r*h-i*o)),t[12]=-(a*(f*p-u*y)-c*(o*p-l*y)+x*(o*u-l*f)),t[13]=n*(f*p-u*y)-c*(r*p-s*y)+x*(r*u-s*f),t[14]=-(n*(o*p-l*y)-a*(r*p-s*y)+x*(r*l-s*o)),t[15]=n*(o*u-l*f)-a*(r*u-s*f)+c*(r*l-s*o),t}function Xr(t){var e=t[0],n=t[1],r=t[2],s=t[3],i=t[4],a=t[5],o=t[6],l=t[7],h=t[8],c=t[9],f=t[10],u=t[11],d=t[12],x=t[13],y=t[14],p=t[15],_=e*a-n*i,L=e*o-r*i,M=e*l-s*i,C=n*o-r*a,S=n*l-s*a,T=r*l-s*o,D=h*x-c*d,A=h*y-f*d,O=h*p-u*d,k=c*y-f*x,v=c*p-u*x,I=f*p-u*y;return _*I-L*v+M*k+C*O-S*A+T*D}function Xt(t,e,n){var r=e[0],s=e[1],i=e[2],a=e[3],o=e[4],l=e[5],h=e[6],c=e[7],f=e[8],u=e[9],d=e[10],x=e[11],y=e[12],p=e[13],_=e[14],L=e[15],M=n[0],C=n[1],S=n[2],T=n[3];return t[0]=M*r+C*o+S*f+T*y,t[1]=M*s+C*l+S*u+T*p,t[2]=M*i+C*h+S*d+T*_,t[3]=M*a+C*c+S*x+T*L,M=n[4],C=n[5],S=n[6],T=n[7],t[4]=M*r+C*o+S*f+T*y,t[5]=M*s+C*l+S*u+T*p,t[6]=M*i+C*h+S*d+T*_,t[7]=M*a+C*c+S*x+T*L,M=n[8],C=n[9],S=n[10],T=n[11],t[8]=M*r+C*o+S*f+T*y,t[9]=M*s+C*l+S*u+T*p,t[10]=M*i+C*h+S*d+T*_,t[11]=M*a+C*c+S*x+T*L,M=n[12],C=n[13],S=n[14],T=n[15],t[12]=M*r+C*o+S*f+T*y,t[13]=M*s+C*l+S*u+T*p,t[14]=M*i+C*h+S*d+T*_,t[15]=M*a+C*c+S*x+T*L,t}function Qr(t,e,n){var r=n[0],s=n[1],i=n[2],a,o,l,h,c,f,u,d,x,y,p,_;return e===t?(t[12]=e[0]*r+e[4]*s+e[8]*i+e[12],t[13]=e[1]*r+e[5]*s+e[9]*i+e[13],t[14]=e[2]*r+e[6]*s+e[10]*i+e[14],t[15]=e[3]*r+e[7]*s+e[11]*i+e[15]):(a=e[0],o=e[1],l=e[2],h=e[3],c=e[4],f=e[5],u=e[6],d=e[7],x=e[8],y=e[9],p=e[10],_=e[11],t[0]=a,t[1]=o,t[2]=l,t[3]=h,t[4]=c,t[5]=f,t[6]=u,t[7]=d,t[8]=x,t[9]=y,t[10]=p,t[11]=_,t[12]=a*r+c*s+x*i+e[12],t[13]=o*r+f*s+y*i+e[13],t[14]=l*r+u*s+p*i+e[14],t[15]=h*r+d*s+_*i+e[15]),t}function Zr(t,e,n){var r=n[0],s=n[1],i=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Jr(t,e,n,r){var s=r[0],i=r[1],a=r[2],o=Math.hypot(s,i,a),l,h,c,f,u,d,x,y,p,_,L,M,C,S,T,D,A,O,k,v,I,N,P,m;return o<z?null:(o=1/o,s*=o,i*=o,a*=o,l=Math.sin(n),h=Math.cos(n),c=1-h,f=e[0],u=e[1],d=e[2],x=e[3],y=e[4],p=e[5],_=e[6],L=e[7],M=e[8],C=e[9],S=e[10],T=e[11],D=s*s*c+h,A=i*s*c+a*l,O=a*s*c-i*l,k=s*i*c-a*l,v=i*i*c+h,I=a*i*c+s*l,N=s*a*c+i*l,P=i*a*c-s*l,m=a*a*c+h,t[0]=f*D+y*A+M*O,t[1]=u*D+p*A+C*O,t[2]=d*D+_*A+S*O,t[3]=x*D+L*A+T*O,t[4]=f*k+y*v+M*I,t[5]=u*k+p*v+C*I,t[6]=d*k+_*v+S*I,t[7]=x*k+L*v+T*I,t[8]=f*N+y*P+M*m,t[9]=u*N+p*P+C*m,t[10]=d*N+_*P+S*m,t[11]=x*N+L*P+T*m,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function es(t,e,n){var r=Math.sin(n),s=Math.cos(n),i=e[4],a=e[5],o=e[6],l=e[7],h=e[8],c=e[9],f=e[10],u=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*s+h*r,t[5]=a*s+c*r,t[6]=o*s+f*r,t[7]=l*s+u*r,t[8]=h*s-i*r,t[9]=c*s-a*r,t[10]=f*s-o*r,t[11]=u*s-l*r,t}function ts(t,e,n){var r=Math.sin(n),s=Math.cos(n),i=e[0],a=e[1],o=e[2],l=e[3],h=e[8],c=e[9],f=e[10],u=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*s-h*r,t[1]=a*s-c*r,t[2]=o*s-f*r,t[3]=l*s-u*r,t[8]=i*r+h*s,t[9]=a*r+c*s,t[10]=o*r+f*s,t[11]=l*r+u*s,t}function ns(t,e,n){var r=Math.sin(n),s=Math.cos(n),i=e[0],a=e[1],o=e[2],l=e[3],h=e[4],c=e[5],f=e[6],u=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*s+h*r,t[1]=a*s+c*r,t[2]=o*s+f*r,t[3]=l*s+u*r,t[4]=h*s-i*r,t[5]=c*s-a*r,t[6]=f*s-o*r,t[7]=u*s-l*r,t}function rs(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function ss(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function is(t,e,n){var r=n[0],s=n[1],i=n[2],a=Math.hypot(r,s,i),o,l,h;return a<z?null:(a=1/a,r*=a,s*=a,i*=a,o=Math.sin(e),l=Math.cos(e),h=1-l,t[0]=r*r*h+l,t[1]=s*r*h+i*o,t[2]=i*r*h-s*o,t[3]=0,t[4]=r*s*h-i*o,t[5]=s*s*h+l,t[6]=i*s*h+r*o,t[7]=0,t[8]=r*i*h+s*o,t[9]=s*i*h-r*o,t[10]=i*i*h+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function as(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function os(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ls(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Qt(t,e,n){var r=e[0],s=e[1],i=e[2],a=e[3],o=r+r,l=s+s,h=i+i,c=r*o,f=r*l,u=r*h,d=s*l,x=s*h,y=i*h,p=a*o,_=a*l,L=a*h;return t[0]=1-(d+y),t[1]=f+L,t[2]=u-_,t[3]=0,t[4]=f-L,t[5]=1-(c+y),t[6]=x+p,t[7]=0,t[8]=u+_,t[9]=x-p,t[10]=1-(c+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function hs(t,e){var n=new U(3),r=-e[0],s=-e[1],i=-e[2],a=e[3],o=e[4],l=e[5],h=e[6],c=e[7],f=r*r+s*s+i*i+a*a;return f>0?(n[0]=(o*a+c*r+l*i-h*s)*2/f,n[1]=(l*a+c*s+h*r-o*i)*2/f,n[2]=(h*a+c*i+o*s-l*r)*2/f):(n[0]=(o*a+c*r+l*i-h*s)*2,n[1]=(l*a+c*s+h*r-o*i)*2,n[2]=(h*a+c*i+o*s-l*r)*2),Qt(t,e,n),t}function cs(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function Zt(t,e){var n=e[0],r=e[1],s=e[2],i=e[4],a=e[5],o=e[6],l=e[8],h=e[9],c=e[10];return t[0]=Math.hypot(n,r,s),t[1]=Math.hypot(i,a,o),t[2]=Math.hypot(l,h,c),t}function fs(t,e){var n=new U(3);Zt(n,e);var r=1/n[0],s=1/n[1],i=1/n[2],a=e[0]*r,o=e[1]*s,l=e[2]*i,h=e[4]*r,c=e[5]*s,f=e[6]*i,u=e[8]*r,d=e[9]*s,x=e[10]*i,y=a+c+x,p=0;return y>0?(p=Math.sqrt(y+1)*2,t[3]=.25*p,t[0]=(f-d)/p,t[1]=(u-l)/p,t[2]=(o-h)/p):a>c&&a>x?(p=Math.sqrt(1+a-c-x)*2,t[3]=(f-d)/p,t[0]=.25*p,t[1]=(o+h)/p,t[2]=(u+l)/p):c>x?(p=Math.sqrt(1+c-a-x)*2,t[3]=(u-l)/p,t[0]=(o+h)/p,t[1]=.25*p,t[2]=(f+d)/p):(p=Math.sqrt(1+x-a-c)*2,t[3]=(o-h)/p,t[0]=(u+l)/p,t[1]=(f+d)/p,t[2]=.25*p),t}function us(t,e,n,r){var s=e[0],i=e[1],a=e[2],o=e[3],l=s+s,h=i+i,c=a+a,f=s*l,u=s*h,d=s*c,x=i*h,y=i*c,p=a*c,_=o*l,L=o*h,M=o*c,C=r[0],S=r[1],T=r[2];return t[0]=(1-(x+p))*C,t[1]=(u+M)*C,t[2]=(d-L)*C,t[3]=0,t[4]=(u-M)*S,t[5]=(1-(f+p))*S,t[6]=(y+_)*S,t[7]=0,t[8]=(d+L)*T,t[9]=(y-_)*T,t[10]=(1-(f+x))*T,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function ps(t,e,n,r,s){var i=e[0],a=e[1],o=e[2],l=e[3],h=i+i,c=a+a,f=o+o,u=i*h,d=i*c,x=i*f,y=a*c,p=a*f,_=o*f,L=l*h,M=l*c,C=l*f,S=r[0],T=r[1],D=r[2],A=s[0],O=s[1],k=s[2],v=(1-(y+_))*S,I=(d+C)*S,N=(x-M)*S,P=(d-C)*T,m=(1-(u+_))*T,g=(p+L)*T,Y=(x+M)*D,$=(p-L)*D,Q=(1-(u+y))*D;return t[0]=v,t[1]=I,t[2]=N,t[3]=0,t[4]=P,t[5]=m,t[6]=g,t[7]=0,t[8]=Y,t[9]=$,t[10]=Q,t[11]=0,t[12]=n[0]+A-(v*A+P*O+Y*k),t[13]=n[1]+O-(I*A+m*O+$*k),t[14]=n[2]+k-(N*A+g*O+Q*k),t[15]=1,t}function ds(t,e){var n=e[0],r=e[1],s=e[2],i=e[3],a=n+n,o=r+r,l=s+s,h=n*a,c=r*a,f=r*o,u=s*a,d=s*o,x=s*l,y=i*a,p=i*o,_=i*l;return t[0]=1-f-x,t[1]=c+_,t[2]=u-p,t[3]=0,t[4]=c-_,t[5]=1-h-x,t[6]=d+y,t[7]=0,t[8]=u+p,t[9]=d-y,t[10]=1-h-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ms(t,e,n,r,s,i,a){var o=1/(n-e),l=1/(s-r),h=1/(i-a);return t[0]=i*2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i*2*l,t[6]=0,t[7]=0,t[8]=(n+e)*o,t[9]=(s+r)*l,t[10]=(a+i)*h,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*i*2*h,t[15]=0,t}function Jt(t,e,n,r,s){var i=1/Math.tan(e/2),a;return t[0]=i/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0?(a=1/(r-s),t[10]=(s+r)*a,t[14]=2*s*r*a):(t[10]=-1,t[14]=-2*r),t}var vs=Jt;function gs(t,e,n,r,s){var i=1/Math.tan(e/2),a;return t[0]=i/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0?(a=1/(r-s),t[10]=s*a,t[14]=s*r*a):(t[10]=-1,t[14]=-r),t}function ys(t,e,n,r){var s=Math.tan(e.upDegrees*Math.PI/180),i=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),o=Math.tan(e.rightDegrees*Math.PI/180),l=2/(a+o),h=2/(s+i);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=h,t[6]=0,t[7]=0,t[8]=-((a-o)*l*.5),t[9]=(s-i)*h*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function en(t,e,n,r,s,i,a){var o=1/(e-n),l=1/(r-s),h=1/(i-a);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(e+n)*o,t[13]=(s+r)*l,t[14]=(a+i)*h,t[15]=1,t}var xs=en;function Es(t,e,n,r,s,i,a){var o=1/(e-n),l=1/(r-s),h=1/(i-a);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=h,t[11]=0,t[12]=(e+n)*o,t[13]=(s+r)*l,t[14]=i*h,t[15]=1,t}function bs(t,e,n,r){var s,i,a,o,l,h,c,f,u,d,x=e[0],y=e[1],p=e[2],_=r[0],L=r[1],M=r[2],C=n[0],S=n[1],T=n[2];return Math.abs(x-C)<z&&Math.abs(y-S)<z&&Math.abs(p-T)<z?Vt(t):(c=x-C,f=y-S,u=p-T,d=1/Math.hypot(c,f,u),c*=d,f*=d,u*=d,s=L*u-M*f,i=M*c-_*u,a=_*f-L*c,d=Math.hypot(s,i,a),d?(d=1/d,s*=d,i*=d,a*=d):(s=0,i=0,a=0),o=f*a-u*i,l=u*s-c*a,h=c*i-f*s,d=Math.hypot(o,l,h),d?(d=1/d,o*=d,l*=d,h*=d):(o=0,l=0,h=0),t[0]=s,t[1]=o,t[2]=c,t[3]=0,t[4]=i,t[5]=l,t[6]=f,t[7]=0,t[8]=a,t[9]=h,t[10]=u,t[11]=0,t[12]=-(s*x+i*y+a*p),t[13]=-(o*x+l*y+h*p),t[14]=-(c*x+f*y+u*p),t[15]=1,t)}function _s(t,e,n,r){var s=e[0],i=e[1],a=e[2],o=r[0],l=r[1],h=r[2],c=s-n[0],f=i-n[1],u=a-n[2],d=c*c+f*f+u*u;d>0&&(d=1/Math.sqrt(d),c*=d,f*=d,u*=d);var x=l*u-h*f,y=h*c-o*u,p=o*f-l*c;return d=x*x+y*y+p*p,d>0&&(d=1/Math.sqrt(d),x*=d,y*=d,p*=d),t[0]=x,t[1]=y,t[2]=p,t[3]=0,t[4]=f*p-u*y,t[5]=u*x-c*p,t[6]=c*y-f*x,t[7]=0,t[8]=c,t[9]=f,t[10]=u,t[11]=0,t[12]=s,t[13]=i,t[14]=a,t[15]=1,t}function ws(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Ms(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function As(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function tn(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function Ss(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function Rs(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function Cs(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function Ts(t,e){var n=t[0],r=t[1],s=t[2],i=t[3],a=t[4],o=t[5],l=t[6],h=t[7],c=t[8],f=t[9],u=t[10],d=t[11],x=t[12],y=t[13],p=t[14],_=t[15],L=e[0],M=e[1],C=e[2],S=e[3],T=e[4],D=e[5],A=e[6],O=e[7],k=e[8],v=e[9],I=e[10],N=e[11],P=e[12],m=e[13],g=e[14],Y=e[15];return Math.abs(n-L)<=z*Math.max(1,Math.abs(n),Math.abs(L))&&Math.abs(r-M)<=z*Math.max(1,Math.abs(r),Math.abs(M))&&Math.abs(s-C)<=z*Math.max(1,Math.abs(s),Math.abs(C))&&Math.abs(i-S)<=z*Math.max(1,Math.abs(i),Math.abs(S))&&Math.abs(a-T)<=z*Math.max(1,Math.abs(a),Math.abs(T))&&Math.abs(o-D)<=z*Math.max(1,Math.abs(o),Math.abs(D))&&Math.abs(l-A)<=z*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(h-O)<=z*Math.max(1,Math.abs(h),Math.abs(O))&&Math.abs(c-k)<=z*Math.max(1,Math.abs(c),Math.abs(k))&&Math.abs(f-v)<=z*Math.max(1,Math.abs(f),Math.abs(v))&&Math.abs(u-I)<=z*Math.max(1,Math.abs(u),Math.abs(I))&&Math.abs(d-N)<=z*Math.max(1,Math.abs(d),Math.abs(N))&&Math.abs(x-P)<=z*Math.max(1,Math.abs(x),Math.abs(P))&&Math.abs(y-m)<=z*Math.max(1,Math.abs(y),Math.abs(m))&&Math.abs(p-g)<=z*Math.max(1,Math.abs(p),Math.abs(g))&&Math.abs(_-Y)<=z*Math.max(1,Math.abs(_),Math.abs(Y))}var Os=Xt,Ls=tn;var se={};Le(se,{add:()=>Li,calculateW:()=>Ei,clone:()=>Ri,conjugate:()=>Mi,copy:()=>Ti,create:()=>at,dot:()=>On,equals:()=>Di,exactEquals:()=>Bi,exp:()=>Sn,fromEuler:()=>Ai,fromMat3:()=>Cn,fromValues:()=>Ci,getAngle:()=>vi,getAxisAngle:()=>mi,identity:()=>di,invert:()=>wi,len:()=>Pi,length:()=>Ln,lerp:()=>Ni,ln:()=>Rn,mul:()=>Ii,multiply:()=>An,normalize:()=>ot,pow:()=>bi,random:()=>_i,rotateX:()=>gi,rotateY:()=>yi,rotateZ:()=>xi,rotationTo:()=>Hi,scale:()=>Tn,set:()=>Oi,setAxes:()=>zi,setAxisAngle:()=>Mn,slerp:()=>De,sqlerp:()=>$i,sqrLen:()=>ki,squaredLength:()=>In,str:()=>Si});var V={};Le(V,{add:()=>ks,angle:()=>ti,bezier:()=>Gs,ceil:()=>Bs,clone:()=>Is,copy:()=>Ns,create:()=>Pe,cross:()=>ye,dist:()=>hi,distance:()=>on,div:()=>li,divide:()=>an,dot:()=>Be,equals:()=>ii,exactEquals:()=>si,floor:()=>Ds,forEach:()=>ui,fromValues:()=>ke,hermite:()=>js,inverse:()=>Ys,len:()=>it,length:()=>nn,lerp:()=>qs,max:()=>$s,min:()=>Hs,mul:()=>oi,multiply:()=>sn,negate:()=>Us,normalize:()=>st,random:()=>Ws,rotateX:()=>Zs,rotateY:()=>Js,rotateZ:()=>ei,round:()=>zs,scale:()=>Ks,scaleAndAdd:()=>Fs,set:()=>Ps,sqrDist:()=>ci,sqrLen:()=>fi,squaredDistance:()=>ln,squaredLength:()=>hn,str:()=>ri,sub:()=>ai,subtract:()=>rn,transformMat3:()=>Xs,transformMat4:()=>Vs,transformQuat:()=>Qs,zero:()=>ni});function Pe(){var t=new U(3);return U!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Is(t){var e=new U(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function nn(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function ke(t,e,n){var r=new U(3);return r[0]=t,r[1]=e,r[2]=n,r}function Ns(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Ps(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function ks(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function rn(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function sn(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function an(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function Bs(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function Ds(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function Hs(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function $s(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function zs(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function Ks(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function Fs(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function on(t,e){var n=e[0]-t[0],r=e[1]-t[1],s=e[2]-t[2];return Math.hypot(n,r,s)}function ln(t,e){var n=e[0]-t[0],r=e[1]-t[1],s=e[2]-t[2];return n*n+r*r+s*s}function hn(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function Us(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Ys(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function st(t,e){var n=e[0],r=e[1],s=e[2],i=n*n+r*r+s*s;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function Be(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function ye(t,e,n){var r=e[0],s=e[1],i=e[2],a=n[0],o=n[1],l=n[2];return t[0]=s*l-i*o,t[1]=i*a-r*l,t[2]=r*o-s*a,t}function qs(t,e,n,r){var s=e[0],i=e[1],a=e[2];return t[0]=s+r*(n[0]-s),t[1]=i+r*(n[1]-i),t[2]=a+r*(n[2]-a),t}function js(t,e,n,r,s,i){var a=i*i,o=a*(2*i-3)+1,l=a*(i-2)+i,h=a*(i-1),c=a*(3-2*i);return t[0]=e[0]*o+n[0]*l+r[0]*h+s[0]*c,t[1]=e[1]*o+n[1]*l+r[1]*h+s[1]*c,t[2]=e[2]*o+n[2]*l+r[2]*h+s[2]*c,t}function Gs(t,e,n,r,s,i){var a=1-i,o=a*a,l=i*i,h=o*a,c=3*i*o,f=3*l*a,u=l*i;return t[0]=e[0]*h+n[0]*c+r[0]*f+s[0]*u,t[1]=e[1]*h+n[1]*c+r[1]*f+s[1]*u,t[2]=e[2]*h+n[2]*c+r[2]*f+s[2]*u,t}function Ws(t,e){e=e||1;var n=ae()*2*Math.PI,r=ae()*2-1,s=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*s,t[1]=Math.sin(n)*s,t[2]=r*e,t}function Vs(t,e,n){var r=e[0],s=e[1],i=e[2],a=n[3]*r+n[7]*s+n[11]*i+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*s+n[8]*i+n[12])/a,t[1]=(n[1]*r+n[5]*s+n[9]*i+n[13])/a,t[2]=(n[2]*r+n[6]*s+n[10]*i+n[14])/a,t}function Xs(t,e,n){var r=e[0],s=e[1],i=e[2];return t[0]=r*n[0]+s*n[3]+i*n[6],t[1]=r*n[1]+s*n[4]+i*n[7],t[2]=r*n[2]+s*n[5]+i*n[8],t}function Qs(t,e,n){var r=n[0],s=n[1],i=n[2],a=n[3],o=e[0],l=e[1],h=e[2],c=s*h-i*l,f=i*o-r*h,u=r*l-s*o,d=s*u-i*f,x=i*c-r*u,y=r*f-s*c,p=a*2;return c*=p,f*=p,u*=p,d*=2,x*=2,y*=2,t[0]=o+c+d,t[1]=l+f+x,t[2]=h+u+y,t}function Zs(t,e,n,r){var s=[],i=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],i[0]=s[0],i[1]=s[1]*Math.cos(r)-s[2]*Math.sin(r),i[2]=s[1]*Math.sin(r)+s[2]*Math.cos(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function Js(t,e,n,r){var s=[],i=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],i[0]=s[2]*Math.sin(r)+s[0]*Math.cos(r),i[1]=s[1],i[2]=s[2]*Math.cos(r)-s[0]*Math.sin(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function ei(t,e,n,r){var s=[],i=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],i[0]=s[0]*Math.cos(r)-s[1]*Math.sin(r),i[1]=s[0]*Math.sin(r)+s[1]*Math.cos(r),i[2]=s[2],t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function ti(t,e){var n=t[0],r=t[1],s=t[2],i=e[0],a=e[1],o=e[2],l=Math.sqrt(n*n+r*r+s*s),h=Math.sqrt(i*i+a*a+o*o),c=l*h,f=c&&Be(t,e)/c;return Math.acos(Math.min(Math.max(f,-1),1))}function ni(t){return t[0]=0,t[1]=0,t[2]=0,t}function ri(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function si(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function ii(t,e){var n=t[0],r=t[1],s=t[2],i=e[0],a=e[1],o=e[2];return Math.abs(n-i)<=z*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-a)<=z*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(s-o)<=z*Math.max(1,Math.abs(s),Math.abs(o))}var ai=rn,oi=sn,li=an,hi=on,ci=ln,it=nn,fi=hn,ui=function(){var t=Pe();return function(e,n,r,s,i,a){var o,l;for(n||(n=3),r||(r=0),s?l=Math.min(s*n+r,e.length):l=e.length,o=r;o<l;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],i(t,t,a),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}}();function pi(){var t=new U(4);return U!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function cn(t){var e=new U(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function fn(t,e,n,r){var s=new U(4);return s[0]=t,s[1]=e,s[2]=n,s[3]=r,s}function un(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function pn(t,e,n,r,s){return t[0]=e,t[1]=n,t[2]=r,t[3]=s,t}function dn(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function mn(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function vn(t){var e=t[0],n=t[1],r=t[2],s=t[3];return Math.hypot(e,n,r,s)}function gn(t){var e=t[0],n=t[1],r=t[2],s=t[3];return e*e+n*n+r*r+s*s}function yn(t,e){var n=e[0],r=e[1],s=e[2],i=e[3],a=n*n+r*r+s*s+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=n*a,t[1]=r*a,t[2]=s*a,t[3]=i*a,t}function xn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function En(t,e,n,r){var s=e[0],i=e[1],a=e[2],o=e[3];return t[0]=s+r*(n[0]-s),t[1]=i+r*(n[1]-i),t[2]=a+r*(n[2]-a),t[3]=o+r*(n[3]-o),t}function bn(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function _n(t,e){var n=t[0],r=t[1],s=t[2],i=t[3],a=e[0],o=e[1],l=e[2],h=e[3];return Math.abs(n-a)<=z*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-o)<=z*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(s-l)<=z*Math.max(1,Math.abs(s),Math.abs(l))&&Math.abs(i-h)<=z*Math.max(1,Math.abs(i),Math.abs(h))}var Al=function(){var t=pi();return function(e,n,r,s,i,a){var o,l;for(n||(n=4),r||(r=0),s?l=Math.min(s*n+r,e.length):l=e.length,o=r;o<l;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],i(t,t,a),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}}();function at(){var t=new U(4);return U!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function di(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Mn(t,e,n){n=n*.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function mi(t,e){var n=Math.acos(e[3])*2,r=Math.sin(n/2);return r>z?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function vi(t,e){var n=On(t,e);return Math.acos(2*n*n-1)}function An(t,e,n){var r=e[0],s=e[1],i=e[2],a=e[3],o=n[0],l=n[1],h=n[2],c=n[3];return t[0]=r*c+a*o+s*h-i*l,t[1]=s*c+a*l+i*o-r*h,t[2]=i*c+a*h+r*l-s*o,t[3]=a*c-r*o-s*l-i*h,t}function gi(t,e,n){n*=.5;var r=e[0],s=e[1],i=e[2],a=e[3],o=Math.sin(n),l=Math.cos(n);return t[0]=r*l+a*o,t[1]=s*l+i*o,t[2]=i*l-s*o,t[3]=a*l-r*o,t}function yi(t,e,n){n*=.5;var r=e[0],s=e[1],i=e[2],a=e[3],o=Math.sin(n),l=Math.cos(n);return t[0]=r*l-i*o,t[1]=s*l+a*o,t[2]=i*l+r*o,t[3]=a*l-s*o,t}function xi(t,e,n){n*=.5;var r=e[0],s=e[1],i=e[2],a=e[3],o=Math.sin(n),l=Math.cos(n);return t[0]=r*l+s*o,t[1]=s*l-r*o,t[2]=i*l+a*o,t[3]=a*l-i*o,t}function Ei(t,e){var n=e[0],r=e[1],s=e[2];return t[0]=n,t[1]=r,t[2]=s,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-s*s)),t}function Sn(t,e){var n=e[0],r=e[1],s=e[2],i=e[3],a=Math.sqrt(n*n+r*r+s*s),o=Math.exp(i),l=a>0?o*Math.sin(a)/a:0;return t[0]=n*l,t[1]=r*l,t[2]=s*l,t[3]=o*Math.cos(a),t}function Rn(t,e){var n=e[0],r=e[1],s=e[2],i=e[3],a=Math.sqrt(n*n+r*r+s*s),o=a>0?Math.atan2(a,i)/a:0;return t[0]=n*o,t[1]=r*o,t[2]=s*o,t[3]=.5*Math.log(n*n+r*r+s*s+i*i),t}function bi(t,e,n){return Rn(t,e),Tn(t,t,n),Sn(t,t),t}function De(t,e,n,r){var s=e[0],i=e[1],a=e[2],o=e[3],l=n[0],h=n[1],c=n[2],f=n[3],u,d,x,y,p;return d=s*l+i*h+a*c+o*f,d<0&&(d=-d,l=-l,h=-h,c=-c,f=-f),1-d>z?(u=Math.acos(d),x=Math.sin(u),y=Math.sin((1-r)*u)/x,p=Math.sin(r*u)/x):(y=1-r,p=r),t[0]=y*s+p*l,t[1]=y*i+p*h,t[2]=y*a+p*c,t[3]=y*o+p*f,t}function _i(t){var e=ae(),n=ae(),r=ae(),s=Math.sqrt(1-e),i=Math.sqrt(e);return t[0]=s*Math.sin(2*Math.PI*n),t[1]=s*Math.cos(2*Math.PI*n),t[2]=i*Math.sin(2*Math.PI*r),t[3]=i*Math.cos(2*Math.PI*r),t}function wi(t,e){var n=e[0],r=e[1],s=e[2],i=e[3],a=n*n+r*r+s*s+i*i,o=a?1/a:0;return t[0]=-n*o,t[1]=-r*o,t[2]=-s*o,t[3]=i*o,t}function Mi(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Cn(t,e){var n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var s=0;e[4]>e[0]&&(s=1),e[8]>e[s*3+s]&&(s=2);var i=(s+1)%3,a=(s+2)%3;r=Math.sqrt(e[s*3+s]-e[i*3+i]-e[a*3+a]+1),t[s]=.5*r,r=.5/r,t[3]=(e[i*3+a]-e[a*3+i])*r,t[i]=(e[i*3+s]+e[s*3+i])*r,t[a]=(e[a*3+s]+e[s*3+a])*r}return t}function Ai(t,e,n,r){var s=.5*Math.PI/180;e*=s,n*=s,r*=s;var i=Math.sin(e),a=Math.cos(e),o=Math.sin(n),l=Math.cos(n),h=Math.sin(r),c=Math.cos(r);return t[0]=i*l*c-a*o*h,t[1]=a*o*c+i*l*h,t[2]=a*l*h-i*o*c,t[3]=a*l*c+i*o*h,t}function Si(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var Ri=cn,Ci=fn,Ti=un,Oi=pn,Li=dn,Ii=An,Tn=mn,On=xn,Ni=En,Ln=vn,Pi=Ln,In=gn,ki=In,ot=yn,Bi=bn,Di=_n,Hi=function(){var t=Pe(),e=ke(1,0,0),n=ke(0,1,0);return function(r,s,i){var a=Be(s,i);return a<-.999999?(ye(t,e,s),it(t)<1e-6&&ye(t,n,s),st(t,t),Mn(r,t,Math.PI),r):a>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(ye(t,s,i),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+a,ot(r,r))}}(),$i=function(){var t=at(),e=at();return function(n,r,s,i,a,o){return De(t,r,a,o),De(e,s,i,o),De(n,t,e,2*o*(1-o)),n}}(),zi=function(){var t=Wt();return function(e,n,r,s){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=s[0],t[4]=s[1],t[7]=s[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],ot(e,Cn(e,t))}}();var Cl=V.fromValues(0,1,0);var Tl=Math.PI/3;var Ol=Math.PI/180;var He=class{constructor(e,n=void 0){let{animationFrameHandler:r=window}=n||{};this.handle=0,this.detail={prevTime:-1,currentTime:-1,deltaTime:0},this.animationFrameHandler=r,this.callback=e,this.next=this.next.bind(this),this.start=this.start.bind(this),this.cancel=this.cancel.bind(this)}get running(){return this.handle!==0}next(e=performance.now()){this.handle=this.animationFrameHandler.requestAnimationFrame(this.next);let n=this.detail;n.prevTime=n.currentTime,n.currentTime=e,n.deltaTime=n.currentTime-n.prevTime,this.callback(this)}start(){return this.handle=this.animationFrameHandler.requestAnimationFrame(this.next),this}cancel(){return this.animationFrameHandler.cancelAnimationFrame(this.handle),this}};var $e=class{get polling(){return performance.now()-this._lastPollingTime<1e3}get value(){return 0}get size(){return this._size}constructor(e){this._size=e,this._lastPollingTime=Number.MIN_SAFE_INTEGER}resize(e){this._size=e}getState(e){throw new Error("Missing implementation.")}onUpdate(e,n,r){throw new Error("Missing implementation.")}onStatus(e,n){throw new Error("Missing implementation.")}onPoll(e){this._lastPollingTime=e}onBind(e,n=void 0){e>=this._size&&this.resize(e+1)}onUnbind(){this.resize(0)}},pe=class extends $e{static createAxisBindingState(){return{value:0,delta:0,inverted:!1}}get delta(){return this._delta}get value(){return this._value}constructor(e=0){super(e);let n=new Array,r=this.constructor;for(let s=0;s<e;++s)n.push(r.createAxisBindingState());this._state=n,this._value=0,this._delta=0}resize(e){let n=this._state,r=n.length,s;if(e<=r)s=n.slice(0,e);else{s=n;let i=this.constructor;for(let a=r;a<e;++a)s.push(i.createAxisBindingState())}this._state=s,super.resize(e)}getState(e){return this._state[e].value}onPoll(e){let n=this._state,r=0,s=0,i=n.length;for(let a=0;a<i;++a){let o=n[a];r+=o.value*(o.inverted?-1:1),s+=o.delta,n[a].delta=0}this._value=r,this._delta=s,super.onPoll(e)}onUpdate(e,n,r){typeof n>"u"?this.onAxisChange(e,r):this.onAxisMove(e,n,r)}onStatus(e,n){this.onAxisStatus(e,n)}onBind(e,n=void 0){super.onBind(e,n);let{inverted:r=!1}=n||{},s=this._state;s[e].inverted=r}onAxisMove(e,n,r){let s=this._state[e];s.value=n,s.delta+=r}onAxisChange(e,n){let r=this._state[e];r.value+=n,r.delta+=n}onAxisStatus(e,n){let r=this._state[e],s=r.value;r.value=n,r.delta=n-s}},Ki=241,Nn=254,Fi=239,he=1,lt=2,ht=4,ct=8,ft=16,xe=class extends $e{get pressed(){return this._pressed}get repeated(){return this._repeated}get released(){return this._released}get down(){return this._down}get value(){return this._value}constructor(e=0){super(e),this._state=new Uint8Array(e),this._value=0,this._down=!1,this._pressed=!1,this._repeated=!1,this._released=!1}resize(e){let n=this._state,r=n.length,s;e<=r?s=n.slice(0,e):(s=new Uint8Array(e),s.set(n)),this._state=s,super.resize(e)}getState(e){let n=this._state[e],r=n&ft?-1:1;return(n&he?1:0)*r}onPoll(e){let n=this._state,r=0,s=0,i=0,a=0,o=0,l=n.length;for(let h=0;h<l;++h){let c=n[h],f=c&he,u=c&ft;s|=f,i|=c&lt,a|=c&ht,o|=c&ct,r+=(f?1:0)*(u?-1:1),n[h]&=Ki}this._value=r,this._down=s!==0,this._pressed=i!==0,this._repeated=a!==0,this._released=o!==0,super.onPoll(e)}onUpdate(e,n,r){r>0?this.onButtonPressed(e):this.onButtonReleased(e)}onStatus(e,n){this.onButtonStatus(e,n!==0)}onBind(e,n={inverted:!1}){super.onBind(e,n);let{inverted:r=!1}=n,s=this._state;r?s[e]|=ft:s[e]&=Fi}onButtonPressed(e){let n=this._state,r=n[e];r&he||(r|=lt,r|=he),r|=ht,n[e]=r}onButtonReleased(e){let n=this._state,r=n[e];r&he&&(r|=ct,r&=Nn),n[e]=r}onButtonStatus(e,n){let r=this._state,s=r[e],i=!!(s&he);n?s|=he:s&=Nn,i&&!n&&(s|=ct),!i&&n&&(s|=lt,s|=ht),r[e]=s}},b=class t{static parse(e){e=e.trim();let n=e.indexOf(".");if(n<0)throw new Error("Missing device separator for key code.");let r=e.substring(0,n);if(r.length<0)throw new Error("Missing device for key code.");let s=e.substring(n+1);if(s.length<0)throw new Error("Missing code for key code.");return new t(r,s)}constructor(e,n){this.device=e,this.code=n}toString(){return`${this.device}.${this.code}`}};function Pn(t,e){return new b(t,e)}function Ui(t){return"device"in t&&"code"in t}var R="Keyboard",ee="Mouse",Yi=new b(R,"KeyA"),qi=new b(R,"KeyB"),ji=new b(R,"KeyC"),Gi=new b(R,"KeyD"),Wi=new b(R,"KeyE"),Vi=new b(R,"KeyF"),Xi=new b(R,"KeyG"),Qi=new b(R,"KeyH"),Zi=new b(R,"KeyI"),Ji=new b(R,"KeyJ"),ea=new b(R,"KeyK"),ta=new b(R,"KeyL"),na=new b(R,"KeyM"),ra=new b(R,"KeyN"),sa=new b(R,"KeyO"),ia=new b(R,"KeyP"),aa=new b(R,"KeyQ"),oa=new b(R,"KeyR"),la=new b(R,"KeyS"),ha=new b(R,"KeyT"),ca=new b(R,"KeyU"),fa=new b(R,"KeyV"),ua=new b(R,"KeyW"),pa=new b(R,"KeyX"),da=new b(R,"KeyY"),ma=new b(R,"KeyZ"),va=new b(R,"Digit0"),ga=new b(R,"Digit1"),ya=new b(R,"Digit2"),xa=new b(R,"Digit3"),Ea=new b(R,"Digit4"),ba=new b(R,"Digit5"),_a=new b(R,"Digit6"),wa=new b(R,"Digit7"),Ma=new b(R,"Digit8"),Aa=new b(R,"Digit9"),Sa=new b(R,"Minus"),Ra=new b(R,"Equal"),Ca=new b(R,"BracketLeft"),Ta=new b(R,"BracketRight"),Oa=new b(R,"Semicolon"),La=new b(R,"Quote"),Ia=new b(R,"Backquote"),Na=new b(R,"Backslash"),Pa=new b(R,"Comma"),ka=new b(R,"Period"),Ba=new b(R,"Slash"),Da=new b(R,"Escape"),Ha=new b(R,"Space"),$a=new b(R,"CapsLock"),za=new b(R,"Backspace"),Ka=new b(R,"Delete"),Fa=new b(R,"Tab"),Ua=new b(R,"Enter"),Ya=new b(R,"ArrowUp"),qa=new b(R,"ArrowDown"),ja=new b(R,"ArrowLeft"),Ga=new b(R,"ArrowRight"),Wa=new b(ee,"Button0"),Va=new b(ee,"Button1"),Xa=new b(ee,"Button2"),Qa=new b(ee,"Button3"),Za=new b(ee,"Button4"),Ja=new b(ee,"PosX"),eo=new b(ee,"PosY"),to=new b(ee,"WheelX"),no=new b(ee,"WheelY"),ro=new b(ee,"WheelZ"),Ee=Object.freeze({__proto__:null,ARROW_DOWN:qa,ARROW_LEFT:ja,ARROW_RIGHT:Ga,ARROW_UP:Ya,BACKQUOTE:Ia,BACKSLASH:Na,BACKSPACE:za,BRACKET_LEFT:Ca,BRACKET_RIGHT:Ta,CAPS_LOCK:$a,COMMA:Pa,DELETE:Ka,DIGIT_0:va,DIGIT_1:ga,DIGIT_2:ya,DIGIT_3:xa,DIGIT_4:Ea,DIGIT_5:ba,DIGIT_6:_a,DIGIT_7:wa,DIGIT_8:Ma,DIGIT_9:Aa,ENTER:Ua,EQUAL:Ra,ESCAPE:Da,KEYBOARD:R,KEY_A:Yi,KEY_B:qi,KEY_C:ji,KEY_D:Gi,KEY_E:Wi,KEY_F:Vi,KEY_G:Xi,KEY_H:Qi,KEY_I:Zi,KEY_J:Ji,KEY_K:ea,KEY_L:ta,KEY_M:na,KEY_N:ra,KEY_O:sa,KEY_P:ia,KEY_Q:aa,KEY_R:oa,KEY_S:la,KEY_T:ha,KEY_U:ca,KEY_V:fa,KEY_W:ua,KEY_X:pa,KEY_Y:da,KEY_Z:ma,MINUS:Sa,MOUSE:ee,MOUSE_BUTTON_0:Wa,MOUSE_BUTTON_1:Va,MOUSE_BUTTON_2:Xa,MOUSE_BUTTON_3:Qa,MOUSE_BUTTON_4:Za,MOUSE_POS_X:Ja,MOUSE_POS_Y:eo,MOUSE_WHEEL_X:to,MOUSE_WHEEL_Y:no,MOUSE_WHEEL_Z:ro,PERIOD:ka,QUOTE:La,SEMICOLON:Oa,SLASH:Ba,SPACE:Ha,TAB:Fa,from:Pn,isKeyCode:Ui}),dt=class{constructor(e){this.name=e,this.current=null}bindKeys(e){throw new Error("Unsupported operation.")}get(e){throw new Error("Unsupported operation.")}};function so(t){Array.isArray(t)||(t=[t]);let e=[];for(let n of t){let r;try{r=b.parse(n)}catch(s){let i=io(n).toUpperCase();if(!(i in Ee))throw new Error("Invalid key code string - "+s);r=Ee[i]}e.push(r)}return e}function io(t){return t.replace(/([a-z]|(?:[A-Z0-9]+))([A-Z0-9]|$)/g,function(e,n,r){return n+(r&&"_"+r)}).toLowerCase()}var be=class t extends dt{static fromBind(e,n,r,s=void 0){return new t(e,Pn(n,r),s)}static fromString(e,...n){let r=so(n);return new t(e,r)}constructor(e,n,r=void 0){super(e),this.keyCodes=Array.isArray(n)?n:[n],this.opts=r,this.current=null}bindKeys(e){let n=this.name,r=this.opts;for(let s of this.keyCodes)e.bindAxis(n,s.device,s.code,r);return this.current=e.getAxis(n),this}get(e){let n=this.name;e.hasAxis(n)||this.bindKeys(e);let r=e.getAxis(n);return this.current=r,r}};var ze=class{static isAxis(e){return!1}static isButton(e){return!1}constructor(e,n){if(!n)throw new Error(`Missing event target for device ${e}.`);this.name=e,this.eventTarget=n,this.listeners={input:[]}}setEventTarget(e){if(!e)throw new Error(`Missing event target for device ${this.name}.`);this.eventTarget=e}destroy(){let e=this.listeners;for(let n in e)e[n].length=0}addEventListener(e,n){let r=this.listeners;e in r?r[e].push(n):r[e]=[n]}removeEventListener(e,n){let r=this.listeners;if(e in r){let s=r[e],i=s.indexOf(n);i>=0&&s.splice(i,1)}}dispatchInputEvent(e){let n=0;for(let r of this.listeners.input)n|=r(e);return!!n}},mt=class extends ze{static isAxis(e){return!1}static isButton(e){return!0}constructor(e,n,r={}){super(e,n);let{ignoreRepeat:s=!0}=r;this.ignoreRepeat=s,this._eventObject={target:n,device:e,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),n.addEventListener("keydown",this.onKeyDown),n.addEventListener("keyup",this.onKeyUp)}setEventTarget(e){this.eventTarget&&this.destroy(),super.setEventTarget(e),e.addEventListener("keydown",this.onKeyDown),e.addEventListener("keyup",this.onKeyUp)}destroy(){let e=this.eventTarget;e.removeEventListener("keydown",this.onKeyDown),e.removeEventListener("keyup",this.onKeyUp),super.destroy()}onKeyDown(e){if(e.repeat&&this.ignoreRepeat)return e.preventDefault(),e.stopPropagation(),!1;let n=this._eventObject;if(n.code=e.code,n.event="pressed",n.value=1,n.control=e.ctrlKey,n.shift=e.shiftKey,n.alt=e.altKey,this.dispatchInputEvent(n))return e.preventDefault(),e.stopPropagation(),!1}onKeyUp(e){let n=this._eventObject;if(n.code=e.code,n.event="released",n.value=1,n.control=e.ctrlKey,n.shift=e.shiftKey,n.alt=e.altKey,this.dispatchInputEvent(n))return e.preventDefault(),e.stopPropagation(),!1}},ut=10,pt=100,vt=class extends ze{static isAxis(e){return e==="PosX"||e==="PosY"||e==="WheelX"||e==="WheelY"||e==="WheelZ"}static isButton(e){return!this.isAxis(e)}constructor(e,n,r={}){super(e,n);let{eventsOnFocus:s=!0}=r;this.eventsOnFocus=s,this.canvasTarget=this.getCanvasFromEventTarget(n),this._downHasFocus=!1,this._eventObject={target:n,device:e,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this._positionObject={target:n,device:e,code:"",event:"move",value:0,movement:0},this._wheelObject={target:n,device:e,code:"",event:"wheel",movement:0},this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onWheel=this.onWheel.bind(this),n.addEventListener("mousedown",this.onMouseDown),n.addEventListener("contextmenu",this.onContextMenu),n.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}setEventTarget(e){this.eventTarget&&this.destroy(),super.setEventTarget(e),this.canvasTarget=this.getCanvasFromEventTarget(e),e.addEventListener("mousedown",this.onMouseDown),e.addEventListener("contextmenu",this.onContextMenu),e.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}destroy(){let e=this.eventTarget;e.removeEventListener("mousedown",this.onMouseDown),e.removeEventListener("contextmenu",this.onContextMenu),e.removeEventListener("wheel",this.onWheel),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),super.destroy()}setPointerLock(e=!0){e?this.eventTarget.requestPointerLock():this.eventTarget.exitPointerLock()}hasPointerLock(){return document.pointerLockElement===this.eventTarget}onMouseDown(e){this._downHasFocus=!0;let n=this._eventObject;if(n.code="Button"+e.button,n.event="pressed",n.value=1,n.control=e.ctrlKey,n.shift=e.shiftKey,n.alt=e.altKey,this.dispatchInputEvent(n)&&document.activeElement===this.eventTarget)return e.preventDefault(),e.stopPropagation(),!1}onContextMenu(e){return e.preventDefault(),e.stopPropagation(),!1}onWheel(e){let n,r,s;switch(e.deltaMode){case WheelEvent.DOM_DELTA_LINE:n=e.deltaX*ut,r=e.deltaY*ut,s=e.deltaZ*ut;break;case WheelEvent.DOM_DELTA_PAGE:n=e.deltaX*pt,r=e.deltaY*pt,s=e.deltaZ*pt;break;case WheelEvent.DOM_DELTA_PIXEL:default:n=e.deltaX,r=e.deltaY,s=e.deltaZ;break}let i=0,a=this._wheelObject;if(a.code="WheelX",a.movement=n,i|=this.dispatchInputEvent(a),a.code="WheelY",a.movement=r,i|=this.dispatchInputEvent(a),a.code="WheelZ",a.movement=s,i|=this.dispatchInputEvent(a),i)return e.preventDefault(),e.stopPropagation(),!1}onMouseUp(e){if(!this._downHasFocus)return;this._downHasFocus=!1;let n=this._eventObject;if(n.code="Button"+e.button,n.event="released",n.value=1,n.control=e.ctrlKey,n.shift=e.shiftKey,n.alt=e.altKey,this.dispatchInputEvent(n))return e.preventDefault(),e.stopPropagation(),!1}onMouseMove(e){if(this.eventsOnFocus&&document.activeElement!==this.eventTarget)return;let n=this.canvasTarget,{clientWidth:r,clientHeight:s}=n,i=n.getBoundingClientRect(),a=e.movementX/r,o=e.movementY/s,l=(e.clientX-i.left)/r,h=(e.clientY-i.top)/s,c=this._positionObject;c.code="PosX",c.value=l,c.movement=a,this.dispatchInputEvent(c),c.code="PosY",c.value=h,c.movement=o,this.dispatchInputEvent(c)}getCanvasFromEventTarget(e){return e instanceof HTMLCanvasElement?e:e.canvas||e.querySelector("canvas")||e.shadowRoot&&e.shadowRoot.querySelector("canvas")||e}},ao=`<kbd>
  <span id="name"><slot></slot></span>
  <span id="value" class="hidden"></span>
</kbd>
`,oo=`kbd {
  position: relative;
  display: inline-block;
  border-radius: 3px;
  border: 1px solid #888888;
  font-size: 0.85em;
  font-weight: 700;
  text-rendering: optimizeLegibility;
  line-height: 12px;
  height: 14px;
  padding: 2px 4px;
  color: #444444;
  background-color: #eeeeee;
  box-shadow: inset 0 -3px 0 #aaaaaa;
  overflow: hidden;
}

kbd:empty::after {
  content: '<?>';
  opacity: 0.6;
}

.disabled {
  opacity: 0.6;
  box-shadow: none;
  background-color: #aaaaaa;
}

.hidden {
  display: none;
}

#value {
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  font-size: 0.85em;
  padding: 0 4px;
  padding-top: 2px;
  color: #cccccc;
  background-color: #333333;
  box-shadow: inset 0 3px 0 #222222;
}
`,Ke=class extends HTMLElement{static get[Symbol.for("templateNode")](){let e=document.createElement("template");return e.innerHTML=ao,Object.defineProperty(this,Symbol.for("templateNode"),{value:e}),e}static get[Symbol.for("styleNode")](){let e=document.createElement("style");return e.innerHTML=oo,Object.defineProperty(this,Symbol.for("styleNode"),{value:e}),e}static define(e=window.customElements){e.define("input-code",this)}static get observedAttributes(){return["name","value","disabled"]}get disabled(){return this._disabled}set disabled(e){this.toggleAttribute("disabled",e)}get value(){return this._value}set value(e){this.setAttribute("value",e)}get name(){return this._name}set name(e){this.setAttribute("name",e)}constructor(){super();let e=this.constructor,n=this.attachShadow({mode:"open"});n.appendChild(e[Symbol.for("templateNode")].content.cloneNode(!0)),n.appendChild(e[Symbol.for("styleNode")].cloneNode(!0)),this._name="",this._value="",this._disabled=!1,this._kbdElement=n.querySelector("kbd"),this._nameElement=n.querySelector("#name"),this._valueElement=n.querySelector("#value")}attributeChangedCallback(e,n,r){switch(e){case"name":this._name=r,this._nameElement.textContent=r;break;case"value":this._value=r,r!==null?(this._valueElement.classList.toggle("hidden",!1),this._valueElement.textContent=r,this._kbdElement.style.paddingRight=`${this._valueElement.clientWidth+4}px`):this._valueElement.classList.toggle("hidden",!0);break;case"disabled":this._disabled=r!==null,this._kbdElement.classList.toggle("disabled",r!==null);break}}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"name")){let e=this.name;delete this.name,this.name=e}if(Object.prototype.hasOwnProperty.call(this,"value")){let e=this.value;delete this.value,this.value=e}if(Object.prototype.hasOwnProperty.call(this,"disabled")){let e=this.disabled;delete this.disabled,this.disabled=e}}};Ke.define();var lo=`<table>
  <thead>
    <tr class="tableHeader">
      <th colspan="3">
        <span class="tableTitle">
          <label id="title"> input-source </label>
          <span id="slotContainer">
            <slot></slot>
          </span>
          <p>
            <label for="poll">poll</label>
            <output id="poll"></output>
          </p>
          <p>
            <label for="focus">focus</label>
            <output id="focus"></output>
          </p>
        </span>
      </th>
    </tr>
    <tr class="colHeader">
      <th>name</th>
      <th>value</th>
      <th>key</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
`,ho=`:host {
  display: block;
}

table {
  border-collapse: collapse;
  font-family: monospace;
}

table,
th,
td {
  border: 1px solid #666666;
}

th,
td {
  padding: 5px 10px;
}

td {
  text-align: center;
}

thead th {
  padding: 0;
}

.colHeader > th {
  font-size: 0.8em;
  padding: 0 10px;
  letter-spacing: 3px;
  background-color: #aaaaaa;
  color: #666666;
}

tbody output {
  border-radius: 0.3em;
  padding: 3px;
}

tr:not(.primary) .name,
tr:not(.primary) .value {
  opacity: 0.3;
}

tr:nth-child(2n) {
  background-color: #eeeeee;
}

.tableHeader {
  color: #666666;
}

.tableTitle {
  display: flex;
  flex-direction: row;
  align-items: center;
  padding: 4px;
}

#slotContainer {
  flex: 1;
}

p {
  display: inline;
  margin: 0;
  padding: 0;
  padding-right: 10px;
}

#poll:empty::after,
#focus:empty::after {
  content: '\u2717';
  color: #ff0000;
}
`,gt=class{constructor(e){this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null,this.pollable=e}get running(){return this.animationFrameHandle!==null}start(){let e=this.animationFrameHandle;e&&cancelAnimationFrame(e),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}stop(){let e=this.animationFrameHandle;e&&cancelAnimationFrame(e),this.animationFrameHandle=null}onAnimationFrame(e){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.pollable.onPoll(e)}},yt=class{constructor(e){this.onInput=this.onInput.bind(this),this.onPoll=this.onPoll.bind(this),this.bindings=e}onPoll(e){for(let n of this.bindings.getInputs())n.onPoll(e)}onInput(e){let{device:n,code:r,event:s,value:i,movement:a,control:o,shift:l,alt:h}=e,c=this.bindings.getBindings(n,r);switch(s){case"pressed":for(let{input:f,index:u}of c)f.onUpdate(u,1,1);break;case"released":for(let{input:f,index:u}of c)f.onUpdate(u,0,-1);break;case"move":for(let{input:f,index:u}of c)f.onUpdate(u,i,a);break;case"wheel":for(let{input:f,index:u}of c)f.onUpdate(u,void 0,a);break}return c.length>0}},Fe=class{constructor(e,n,r,s){this.device=e,this.code=n,this.input=r,this.index=s}},xt=class{constructor(){this.bindingMap={},this.inputMap=new Map}clear(){for(let e of this.inputMap.keys())e.onUnbind();this.inputMap.clear(),this.bindingMap={}}bind(e,n,r,s={inverted:!1}){let i,a=this.inputMap;if(a.has(e)){let l=a.get(e),h=e.size;e.onBind(h,s),i=new Fe(n,r,e,h),l.push(i)}else{let l=[];a.set(e,l);let h=0;e.onBind(h,s),i=new Fe(n,r,e,h),l.push(i)}let o=this.bindingMap;n in o?r in o[n]?o[n][r].push(i):o[n][r]=[i]:o[n]={[r]:[i]}}unbind(e){let n=this.inputMap;if(n.has(e)){let r=this.bindingMap,s=n.get(e);for(let i of s){let{device:a,code:o}=i,l=r[a][o],h=l.indexOf(i);l.splice(h,1)}s.length=0,e.onUnbind(),n.delete(e)}}isBound(e){return this.inputMap.has(e)}getInputs(){return this.inputMap.keys()}getBindingsByInput(e){return this.inputMap.get(e)}getBindings(e,n){let r=this.bindingMap;if(e in r){let s=r[e];if(n in s)return s[n]}return[]}},Et=class{constructor(e,n=void 0){this.inputs={},this.devices=[new vt("Mouse",e),new mt("Keyboard",e)],this.bindings=new xt,this.adapter=new yt(this.bindings),this.autopoller=new gt(this.adapter),this.eventTarget=e,this.anyButton=new xe(1),this.anyButtonDevice="",this.anyButtonCode="",this.anyAxis=new pe(1),this.anyAxisDevice="",this.anyAxisCode="",this.listeners={bind:[],unbind:[],focus:[],blur:[]},this.onInput=this.onInput.bind(this),this.onEventTargetBlur=this.onEventTargetBlur.bind(this),this.onEventTargetFocus=this.onEventTargetFocus.bind(this),e.addEventListener("focus",this.onEventTargetFocus),e.addEventListener("blur",this.onEventTargetBlur);for(let r of this.devices)r.addEventListener("input",this.onInput)}get autopoll(){return this.autopoller.running}set autopoll(e){this.toggleAutoPoll(e)}destroy(){let e=this.listeners;for(let r in e)e[r].length=0;this.autopoller.running&&this.autopoller.stop();for(let r of this.devices)r.removeEventListener("input",this.onInput),r.destroy();let n=this.eventTarget;n.removeEventListener("focus",this.onEventTargetFocus),n.removeEventListener("blur",this.onEventTargetBlur)}setEventTarget(e){let n=this.eventTarget;n.removeEventListener("focus",this.onEventTargetFocus),n.removeEventListener("blur",this.onEventTargetBlur),this.eventTarget=e;for(let r of this.devices)r.setEventTarget(e);e.addEventListener("focus",this.onEventTargetFocus),e.addEventListener("blur",this.onEventTargetBlur)}toggleAutoPoll(e=void 0){let n=this.autopoller.running,r=typeof e>"u"?!n:!!e;r!==n&&(r?this.autopoller.start():this.autopoller.stop())}addEventListener(e,n){let r=this.listeners;e in r?r[e].push(n):r[e]=[n]}removeEventListener(e,n){let r=this.listeners;if(e in r){let s=r[e],i=s.indexOf(n);i>=0&&s.splice(i,1)}}dispatchEvent(e){let{type:n}=e,r=0;for(let s of this.listeners[n])r|=s(e)?1:0;return!!r}poll(e=performance.now()){if(this.autopoller.running)throw new Error("Should not manually poll() while autopolling.");this.onPoll(e)}onInput(e){let n=this.adapter.onInput(e);switch(e.event){case"pressed":this.anyButtonDevice=e.device,this.anyButtonCode=e.code,this.anyButton.onUpdate(0,1,1);break;case"released":this.anyButtonDevice=e.device,this.anyButtonCode=e.code,this.anyButton.onUpdate(0,0,-1);break;case"move":case"wheel":this.anyAxisDevice=e.device,this.anyAxisCode=e.code,this.anyAxis.onUpdate(0,e.value,e.movement);break}return n}onPoll(e){this.adapter.onPoll(e),this.anyButton.onPoll(e),this.anyAxis.onPoll(e)}onBind(){this.dispatchEvent({type:"bind"})}onUnbind(){this.dispatchEvent({type:"unbind"})}onEventTargetFocus(){this.dispatchEvent({type:"focus"})}onEventTargetBlur(){for(let e of this.bindings.getInputs())e.onStatus(0,0);this.anyButton.onStatus(0,0),this.anyAxis.onStatus(0,0),this.dispatchEvent({type:"blur"})}bindKeys(e){if(Array.isArray(e))for(let n of e)n.bindKeys(this);else if(typeof e.bindKeys=="function")e.bindKeys(this);else{e=Object.values(e);for(let n of e)n.bindKeys(this)}}bindButton(e,n,r,s=void 0){let i;this.hasButton(e)?i=this.getButton(e):(i=new xe(1),this.inputs[e]=i),this.bindings.bind(i,n,r,s),this.onBind()}bindAxis(e,n,r,s=void 0){let i;this.hasAxis(e)?i=this.getAxis(e):(i=new pe(1),this.inputs[e]=i),this.bindings.bind(i,n,r,s),this.onBind()}bindAxisButtons(e,n,r,s){let i;this.hasAxis(e)?i=this.getAxis(e):(i=new pe(2),this.inputs[e]=i),this.bindings.bind(i,n,s),this.bindings.bind(i,n,r,{inverted:!0}),this.onBind()}unbindButton(e){if(this.hasButton(e)){let n=this.getButton(e);delete this.inputs[e],this.bindings.unbind(n),this.onUnbind()}}unbindAxis(e){if(this.hasAxis(e)){let n=this.getAxis(e);delete this.inputs[e],this.bindings.unbind(n),this.onUnbind()}}getInput(e){return this.inputs[e]}getButton(e){return this.inputs[e]}getAxis(e){return this.inputs[e]}hasButton(e){return e in this.inputs&&this.inputs[e]instanceof xe}hasAxis(e){return e in this.inputs&&this.inputs[e]instanceof pe}isButtonDown(e){return this.inputs[e].down}isButtonPressed(e){return this.inputs[e].pressed}isButtonReleased(e){return this.inputs[e].released}getInputValue(e){return this.inputs[e].value}getButtonValue(e){return this.inputs[e].value}getAxisValue(e){return this.inputs[e].value}getAxisDelta(e){return this.inputs[e].delta}isAnyButtonDown(e=void 0){if(typeof e>"u")return this.anyButton.down;{let n=this.inputs;for(let r of e)if(n[r].down)return!0}return!1}isAnyButtonPressed(e=void 0){if(typeof e>"u")return this.anyButton.pressed;{let n=this.inputs;for(let r of e)if(n[r].pressed)return!0}return!1}isAnyButtonReleased(e=void 0){if(typeof e>"u")return this.anyButton.released;{let n=this.inputs;for(let r of e)if(n[r].released)return!0}return!1}getAnyAxisValue(e=void 0){if(typeof e>"u")return this.anyAxis.value;{let n=this.inputs;for(let r of e){let s=n[r];if(s.value)return s.value}}return 0}getAnyAxisDelta(e=void 0){if(typeof e>"u")return this.anyAxis.delta;{let n=this.inputs;for(let r of e){let s=n[r];if(s.delta)return s.delta}}return 0}getLastButtonDevice(){return this.anyButtonDevice}getLastButtonCode(){return this.anyButtonCode}getLastAxisDevice(){return this.anyAxisDevice}getLastAxisCode(){return this.anyAxisCode}getMouse(){return this.devices[0]}getKeyboard(){return this.devices[1]}},_e=class t extends HTMLElement{static create(e={}){let{root:n=document.body,id:r=void 0,for:s=void 0,autopoll:i=!1}=e||{},a=new t;return a.id=r,a.for=s,a.autopoll=i,n.appendChild(a),a}static get[Symbol.for("templateNode")](){let e=document.createElement("template");return e.innerHTML=lo,Object.defineProperty(this,Symbol.for("templateNode"),{value:e}),e}static get[Symbol.for("styleNode")](){let e=document.createElement("style");return e.innerHTML=ho,Object.defineProperty(this,Symbol.for("styleNode"),{value:e}),e}static define(e=window.customElements){e.define("input-port",this)}static get observedAttributes(){return["autopoll","for"]}get autopoll(){return this._autopoll}set autopoll(e){this.toggleAttribute("autopoll",e)}get for(){return this._for}set for(e){this.setAttribute("for",e)}constructor(){super();let e=this.attachShadow({mode:"open"});e.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),e.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._titleElement=e.querySelector("#title"),this._pollElement=e.querySelector("#poll"),this._focusElement=e.querySelector("#focus"),this._bodyElement=e.querySelector("tbody"),this._outputElements={},this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null;let n=this;this._for="",this._eventTarget=n,this._autopoll=!1,this._context=null,this.onInputContextBind=this.onInputContextBind.bind(this),this.onInputContextUnbind=this.onInputContextUnbind.bind(this),this.onInputContextFocus=this.onInputContextFocus.bind(this),this.onInputContextBlur=this.onInputContextBlur.bind(this)}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"for")){let e=this.for;delete this.for,this.for=e}if(Object.prototype.hasOwnProperty.call(this,"autopoll")){let e=this.autopoll;delete this.autopoll,this.autopoll=e}this.updateTable(),this.updateTableValues(),this.animationFrameHandle=window.requestAnimationFrame(this.onAnimationFrame)}disconnectedCallback(){let e=this._context;e&&(e.removeEventListener("bind",this.onInputContextBind),e.removeEventListener("unbind",this.onInputContextUnbind),e.removeEventListener("blur",this.onInputContextBlur),e.removeEventListener("focus",this.onInputContextFocus),e.destroy(),this._context=null)}attributeChangedCallback(e,n,r){switch(e){case"for":{this._for=r;let s,i;r?(s=document.getElementById(r),i=`${s.tagName.toLowerCase()}#${r}`):(s=this,i="input-port"),this._eventTarget=s,this._context&&this._context.setEventTarget(this._eventTarget),this._titleElement.innerHTML=`for ${i}`}break;case"autopoll":this._autopoll=r!==null,this._context&&this._context.toggleAutoPoll(this._autopoll);break}}onAnimationFrame(){this.animationFrameHandle=window.requestAnimationFrame(this.onAnimationFrame),this.updateTableValues(),this.updatePollStatus()}onInputContextBind(){return this.updateTable(),!0}onInputContextUnbind(){return this.updateTable(),!0}onInputContextFocus(){return this._focusElement.innerHTML="\u2713",!0}onInputContextBlur(){return this._focusElement.innerHTML="",!0}getContext(e="axisbutton",n=void 0){switch(e){case"axisbutton":if(!this._context){let r=new Et(this._eventTarget,n);r.addEventListener("bind",this.onInputContextBind),r.addEventListener("unbind",this.onInputContextUnbind),r.addEventListener("blur",this.onInputContextBlur),r.addEventListener("focus",this.onInputContextFocus),this._autopoll&&r.toggleAutoPoll(!0),this._context=r}return this._context;default:throw new Error(`Input context id '${e}' is not supported.`)}}updateTable(){if(this.isConnected)if(this._context){let e=this._context,n=e.inputs,r=e.bindings,s={},i=[];for(let a of Object.keys(n)){let o=n[a],l=!0;for(let h of r.getBindingsByInput(o)){let c=co(`${o.constructor.name}.${a}`,`${h.device}.${h.code}`,0,l);i.push(c),l&&(s[a]=c.querySelector("output"),l=!1)}}this._outputElements=s,this._bodyElement.innerHTML="";for(let a of i)this._bodyElement.appendChild(a)}else{this._outputElements={},this._bodyElement.innerHTML="";return}else return}updateTableValues(){if(this.isConnected)if(this._context){let n=this._context.inputs;for(let r of Object.keys(this._outputElements)){let s=this._outputElements[r],i=n[r].value;s.innerText=Number(i).toFixed(2)}}else{for(let e of Object.keys(this._outputElements)){let n=this._outputElements[e];n.innerText="---"}return}else return}updatePollStatus(){if(this.isConnected)if(this._context){let n=this._context.inputs;for(let r of Object.values(n))if(!r.polling){this._pollElement.innerHTML="";return}this._pollElement.innerHTML="\u2713"}else{this._pollElement.innerHTML="-";return}else return}};_e.define();function co(t,e,n,r=!0){let s=document.createElement("tr");r&&s.classList.add("primary");{let i=document.createElement("td");i.textContent=t,i.classList.add("name"),s.appendChild(i)}{let i=document.createElement("td"),a=document.createElement("output");r?a.innerText=Number(n).toFixed(2):a.innerText="---",a.classList.add("value"),i.appendChild(a),s.appendChild(i)}{let i=document.createElement("td");i.classList.add("key");let a=new Ke;a.innerText=e,i.appendChild(a),s.appendChild(i)}return s}var Il=Symbol("keyboardSource");var Nl=Symbol("mouseSource");var mr=Nr(cr());var Qe=class t{constructor(e){let n;typeof e=="object"&&e instanceof t?n=e.source:n=String(e),this.source=n,this._re=(0,mr.makeRe)(n)}test(e){return this._re.test(e)}},Wo=/^([_\w\d]+)\:\/\//;async function fr(t,e,n,r,s,i){let{loadings:a}=t,o;e in a?o=a[e]:(o=new fe(i),a[e]=o);let l=fe.nextAttempt(o),h=[o.promise];return Wo.test(n)?h.push(vr(t,n,i).then(c=>r(c,s)).then(c=>fe.isCurrentAttempt(o,l)?Ze(t,e,c):void 0)):h.push(r(n).then(c=>fe.isCurrentAttempt(o,l)?Ze(t,e,c):void 0)),await Promise.race(h)}function Ze(t,e,n){let{store:r,loadings:s}=t;return r[e]=n,e in s&&(s[e].resolve(n),delete s[e]),n}function Vo(t,e,n){let{defaults:r}=t;typeof e=="string"&&(e=new Qe(e));let s=`__default://[${r.length}]`;return Ze(t,s,n),r.push(new kt(e,s)),n}function Xo(t,e){let{store:n,loadings:r}=t;e in r&&(r[e].reject(new Error("Stop loading to delete asset.")),delete r[e]),e in n&&delete n[e]}function Qo(t,e){typeof e=="string"&&(e=new Qe(e));let{store:n,loadings:r}=t;for(let[s,i]of Object.entries(r))e.test(s)&&(i.reject(new Error(`Stop loading to clear assets matching ${e}`)),delete r[s]);for(let s of Object.keys(n))e.test(s)&&delete n[s]}function Zo(t){let{store:e,loadings:n,defaults:r}=t;for(let[s,i]of Object.entries(n))i.reject(new Error("Stop loading to clear all assets.")),delete n[s];for(let s of Object.keys(e))delete e[s];r.length=0}function Jo(t,e){let{loadings:n}=t;return e in n?n[e].promise:null}async function vr(t,e,n){let{store:r,loadings:s}=t;if(e in r)return r[e];if(e in s)return s[e].promise;{let i=new fe(n);return s[e]=i,i.promise}}function el(t,e){let{defaults:n}=t;for(let r of n)if(r.glob.test(e))return Xe(t,r.uri);return null}function Xe(t,e){return t.store[e]}function tl(t,e){return!!t.store[e]}function nl(t){return Object.keys(t.store)}function ur(t,e){return e in t.store}function pr(t,e){return e in t.loadings}var kt=class{constructor(e,n){this.glob=e,this.uri=n}},fe=class{static nextAttempt(e){return++e._promiseHandle}static isCurrentAttempt(e,n){return e._promiseHandle===n}constructor(e){this._promiseHandle=0,this._resolve=null,this._reject=null,this._reason=null,this._value=null,this._timeoutHandle=Number.isFinite(e)&&e>0?setTimeout(()=>{this.reject(`Asset loading exceeded timeout of ${e} ms.`)},e):null,this._promise=new Promise((n,r)=>{this._value?n(this._value):this._resolve=n,this._reason?r(this._reason):this._reject=r})}get promise(){return this._promise}resolve(e){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._resolve?this._resolve(e):this._value=e}reject(e){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._reject?this._reject(e):this._reason=e}},Je=class{constructor(e=null){this.parent=e,this.store={},this.loadings={},this.defaults=[]}get(e){let n=this;if(ur(n,e))return Xe(n,e);let r=el(n,e);if(r)return r;throw new Error(`Asset '${e}' not found.`)}async resolve(e,n,r,s,i){return this.get(e)||await this.load(e,n,r,s,i)}fallback(e,n){return Vo(this,e,n)}cache(e,n){return Ze(this,e,n)}async load(e,n,r,s,i){let a=this;return ur(a,e)?Xe(a,e):pr(a,e)?await vr(a,e,i):await fr(a,e,n,r,s,i)}async reload(e,n,r,s,i){return await fr(this,e,n,r,s,i)}unload(e){Xo(this,e)}clear(e){Qo(this,e)}current(e){return Xe(this,e)}exists(e){return tl(this,e)}loading(e){let n=this;return pr(n,e)?Jo(n,e):null}keys(){return nl(this)}reset(){Zo(this)}},dr=5e3,et=class t{constructor(e,n,r=void 0,s=e,i=null){this.uri=e,this.loader=n,this.opts=r,this.initial=i,this.filepath=s,this.source=null,this.current=null}cache(e,n){return e.cache(this.uri,n),this.source=e,this.current=n,this}get(e){let n;return e.exists(this.uri)?n=e.current(this.uri):this.initial&&this.initial instanceof t?n=this.initial.get(e):n=this.initial,this.source=e,this.current=n,n}async load(e,n=dr){let r;if(e.exists(this.uri))r=e.current(this.uri);else if(r=await e.load(this.uri,this.filepath,this.loader,this.opts,n),!r)if(this.initial&&this.initial instanceof t){let s=this.initial;r=await e.load(s.uri,s.filepath,s.loader,s.opts,n)}else r=this.initial;return this.source=e,this.current=r,r}async reload(e,n=dr){let r=await e.reload(this.uri,this.filepath,this.loader,this.opts,n);return this.source=e,this.current=r,r}};async function Bt(t,e=void 0){let{imageType:n=void 0}=e||{};if(typeof t=="string"){let l=await(await fetch(t)).arrayBuffer();if(typeof n>"u"){let h=t.lastIndexOf(".");if(h<0)throw new Error("Cannot load from url - unknown image type.");n="image/"+t.slice(h+1)}return Bt(l,{...e,imageType:n})}else if(!(t instanceof ArrayBuffer||ArrayBuffer.isView(t)))throw new Error(`Cannot load from source - must be an ArrayBuffer or fetchable url, but got instead: ${t}`);let r=t;typeof n>"u"&&(n="image/png");let s=new Blob([r],{type:n}),i=URL.createObjectURL(s),a=new Image;return new Promise((o,l)=>{a.addEventListener("load",()=>{o(a)}),a.addEventListener("error",h=>{l(h)}),a.src=i})}var rl=5,sl=4,il=3,al=2,ol=1,ll=0,Ul={[rl]:Ae("#7F8C8D"),[sl]:Ae("#2ECC71"),[il]:Ae("#4794C8"),[al]:Ae("#F39C12"),[ol]:Ae("#C0392B"),[ll]:[""]};function Ae(t){return[`background: ${t}`,"border-radius: 0.5em","color: white","font-weight: bold","padding: 2px 0.5em"]}var Yl=Symbol("level"),ql=Symbol("domain");var me=0,gr=class{constructor(e){this._heap=[],this._comparator=e}get size(){return this._heap.length}clear(){this._heap.length=0}push(...e){for(let n of e)this._heap.push(n),this._shiftUp()}pop(){let e=this.peek(),n=hl(this);return n>me&&this._swap(me,n),this._heap.pop(),this._shiftDown(),e}replace(e){let n=this.peek();return this._heap[me]=e,this._shiftDown(),n}peek(){return this._heap[me]}at(e){return this._heap[e]}indexOf(e,n=void 0){return this._heap.indexOf(e,n)}splice(e,n=void 0){return this._heap.splice(e,n)}_compare(e,n){return this._comparator(this._heap[e],this._heap[n])}_swap(e,n){let r=this._heap[e];this._heap[e]=this._heap[n],this._heap[n]=r}_shiftUp(){let e=this._heap.length-1,n;for(;e>me&&this._compare(e,n=cl(e));)this._swap(e,n),e=n}_shiftDown(){let e=this._heap.length,n=me,r,s=yr(n),i=s<e,a=xr(n),o=a<e;for(;i&&this._compare(s,n)||o&&this._compare(a,n);)r=o&&this._compare(a,s)?a:s,this._swap(n,r),n=r,s=yr(n),i=s<e,a=xr(n),o=a<e}values(){return this._heap}[Symbol.iterator](){return this._heap[Symbol.iterator]()}};function hl(t){return t._heap.length-1}function cl(t){return(t+1>>>1)-1}function yr(t){return(t<<1)+1}function xr(t){return t+1<<1}var jl=Math.PI/180,Gl=180/Math.PI;function Er(t){return t>>16&255}function fl(t){return(t>>16&255)/255}function br(t){return t>>8&255}function ul(t){return(t>>8&255)/255}function _r(t){return t&255}function pl(t){return(t&255)/255}function dl(t){return t>>24&255}function ml(t){return(t>>24&255)/255}function wr(t,e,n,r=1){let s=Math.floor(Math.max(Math.min(t,1),0)*255),i=Math.floor(Math.max(Math.min(e,1),0)*255),a=Math.floor(Math.max(Math.min(n,1),0)*255);return(Math.floor(Math.max(Math.min(r,1),0)*255)&255)<<24|(s&255)<<16|(i&255)<<8|a&255}function vl(t=0,e=16777215,n=.5){let r=this.redf(t),s=this.greenf(t),i=this.bluef(t),a=this.alphaf(t),o=(this.redf(e)-r)*n+r,l=(this.greenf(e)-s)*n+s,h=(this.bluef(e)-i)*n+i,c=(this.alphaf(e)-a)*n+a;return c<.01&&(c=void 0),wr(o,l,h,c)}function gl(t){if(typeof t!="number")return t;let e=Er(t).toString(16).padStart(2,"0"),n=br(t).toString(16).padStart(2,"0"),r=_r(t).toString(16).padStart(2,"0");return`#${e}${n}${r}`}var re=Object.freeze({__proto__:null,alpha:dl,alphaf:ml,blue:_r,bluef:pl,green:br,greenf:ul,hexf:wr,mix:vl,red:Er,redf:fl,toCSSColor:gl});var tt=class{constructor(){this.projectionMatrix=q.fromTranslation(q.create(),V.fromValues(0,0,0)),this.viewMatrix=q.create(),this.position=V.create(),this.rotation=se.create(),this.scaling=V.fromValues(1,1,1),this.transformMatrix=q.create(),this.transformStack=[],this.oldDOMMatrix=null,this.worldDOMMatrix=new DOMMatrix}cls(e,n=void 0){this.matBegin(e),e.resetTransform(),typeof n>"u"?e.clearRect(0,0,e.canvas.width,e.canvas.height):(e.fillStyle=re.toCSSColor(n),e.fillRect(0,0,e.canvas.width,e.canvas.height)),this.matEnd(e)}circ(e,n,r,s,i){this.matBegin(e),e.strokeStyle=re.toCSSColor(i),e.beginPath(),e.arc(n,r,s,0,Math.PI*2),e.stroke(),this.matEnd(e)}circFill(e,n,r,s,i){this.matBegin(e),e.fillStyle=re.toCSSColor(i),e.beginPath(),e.arc(n,r,s,0,Math.PI*2),e.fill(),this.matEnd(e)}rect(e,n,r,s,i,a){this.matBegin(e),e.strokeStyle=re.toCSSColor(a),e.strokeRect(n,r,s-n,i-r),this.matEnd(e)}rectFill(e,n,r,s,i,a){this.matBegin(e),e.fillStyle=re.toCSSColor(a),e.fillRect(n,r,s-n,i-r),this.matEnd(e)}line(e,n,r,s,i,a){this.matBegin(e),e.strokeStyle=re.toCSSColor(a),e.beginPath(),e.moveTo(n,r),e.lineTo(s,i),e.stroke(),this.matEnd(e)}trig(e,n,r,s,i,a,o){this.matBegin(e),e.fillStyle=re.toCSSColor(o),e.translate(n,r),e.rotate(a),e.beginPath();let l=i/2,h=s/2;e.moveTo(h,0),e.lineTo(-h,-l),e.lineTo(-h,l),e.fill(),this.matEnd(e)}trigFill(e,n,r,s,i,a,o){this.matBegin(e),e.fillStyle=re.toCSSColor(o),e.translate(n,r),e.rotate(a),e.beginPath();let l=i/2,h=s/2;e.moveTo(h,0),e.lineTo(-h,-l),e.lineTo(-h,l),e.fill(),this.matEnd(e)}print(e,n,r,s,i){this.matBegin(e),e.fillStyle=re.toCSSColor(i),e.font="16px sans-serif",e.textBaseline="top",e.fillText(n,r,s),this.matEnd(e)}spr(e,n,r,s,i,a,o,l=!1,h=!1){let c=Math.floor(Number(n.width)/a),f=r%c*a,u=Math.floor(r/c)*o;this.sprUV(e,n,f,u,a,o,s,i,a,o,l,h)}sprUV(e,n,r,s,i,a,o,l,h,c,f=!1,u=!1){this.matBegin(e);let d=f?h:0,x=u?c:0,y=f?-1:1,p=u?-1:1;e.translate(o+d,l+x),e.scale(y,p),e.drawImage(n,r,s,i-r,a-s,0,0,h,c),this.matEnd(e)}camera(e,n,r,s){q.fromTranslation(this.viewMatrix,V.fromValues(-e,-n,0)),this.matUpdate()}mat(e,n,r,s,i){this.position[0]=e,this.position[1]=n,this.position[2]=0,this.scaling[0]=r,this.scaling[1]=s,this.scaling[2]=1,se.fromEuler(this.rotation,0,0,i),this.matUpdate()}matPos(e,n){this.position[0]=e,this.position[1]=n,this.position[2]=0,this.matUpdate()}matScale(e,n){this.scaling[0]=e,this.scaling[1]=n,this.scaling[2]=1,this.matUpdate()}matRot(e){se.fromEuler(this.rotation,0,0,e),this.matUpdate()}push(){q.fromRotationTranslationScale(this.transformMatrix,this.rotation,this.position,this.scaling),se.identity(this.rotation),V.set(this.position,0,0,0),V.set(this.scaling,1,1,1),this.transformStack.push(this.transformMatrix),this.transformMatrix=q.create(),this.matUpdate()}pop(){if(this.transformStack.length>0){let e=this.transformStack.pop();q.getRotation(this.rotation,e),q.getScaling(this.scaling,e),q.getTranslation(this.position,e)}se.identity(this.rotation),V.set(this.position,0,0,0),V.set(this.scaling,1,1,1),q.fromRotationTranslationScale(this.transformMatrix,this.rotation,this.position,this.scaling),this.matUpdate()}getCurrentMatrix(){return this.worldDOMMatrix}matBegin(e){this.oldDOMMatrix=e.getTransform(),e.setTransform(this.worldDOMMatrix)}matEnd(e){e.setTransform(this.oldDOMMatrix),this.oldDOMMatrix=null}matUpdate(){let e=q.create(),n=this.transformStack.length;for(let r=n-1;r>=0;--r){let s=this.transformStack[r];q.mul(e,s,e)}q.fromRotationTranslationScale(this.transformMatrix,this.rotation,this.position,this.scaling),q.mul(e,e,this.transformMatrix),q.mul(e,this.viewMatrix,e),q.mul(e,this.projectionMatrix,e),this.worldDOMMatrix.a=e[0],this.worldDOMMatrix.b=e[1],this.worldDOMMatrix.c=e[4],this.worldDOMMatrix.d=e[5],this.worldDOMMatrix.e=Math.round(e[12]),this.worldDOMMatrix.f=Math.round(e[13])}};window.addEventListener("DOMContentLoaded",xl);var yl={cursorX:new be("cursorX",Ee.MOUSE_POS_X),cursorY:new be("cursorY",Ee.MOUSE_POS_Y)},Mr=new et("car.png",Bt,{imageType:"png"},"car.png");async function xl(){let{canvas:t}=Ne.create({id:"display",sizing:"container"}),e=t.getContext("2d"),n=new Je;await Mr.load(n);let s=_e.create({for:"display"}).getContext("axisbutton");s.bindKeys(yl);let i=new tt,a={tia:i,ctx:e};new He(l=>{s.poll(l.detail.currentTime),i.camera(0,0,t.width,t.height),i.cls(e,0),i.rectFill(e,0,0,10,10,16777215),i.trigFill(e,100,100,10,10,0,16711680),i.spr(e,Mr.current,0,10,10,32,32),El(e,i,20,100,10)}).start()}function El(t,e,n,r,s){e.trigFill(t,n,r,s,s,Math.PI/4,16711680)}})();
//# sourceMappingURL=main.js.map
