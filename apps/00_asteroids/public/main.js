(()=>{var Jn=Object.create,Dt=Object.defineProperty,tr=Object.getPrototypeOf,er=Object.prototype.hasOwnProperty,nr=Object.getOwnPropertyNames,rr=Object.getOwnPropertyDescriptor;var ir=t=>Dt(t,"__esModule",{value:!0});var sr=(t,e)=>()=>(t&&(e=t(t=0)),e),yt=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),or=(t,e)=>{for(var n in e)Dt(t,n,{get:e[n],enumerable:!0})},ar=(t,e,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of nr(e))!er.call(t,i)&&i!=="default"&&Dt(t,i,{get:()=>e[i],enumerable:!(n=rr(e,i))||n.enumerable});return t},lr=t=>ar(ir(Dt(t!=null?Jn(tr(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var Ge={};or(Ge,{basename:()=>Ye,default:()=>yr,delimiter:()=>Ke,dirname:()=>Ze,extname:()=>Qe,isAbsolute:()=>le,join:()=>We,normalize:()=>ue,relative:()=>je,resolve:()=>zt,sep:()=>Xe});function qe(t,e){for(var n=0,i=t.length-1;i>=0;i--){var r=t[i];r==="."?t.splice(i,1):r===".."?(t.splice(i,1),n++):n&&(t.splice(i,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function zt(){for(var t="",e=!1,n=arguments.length-1;n>=-1&&!e;n--){var i=n>=0?arguments[n]:"/";if(typeof i!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!i)continue;t=i+"/"+t,e=i.charAt(0)==="/"}return t=qe(ae(t.split("/"),function(r){return!!r}),!e).join("/"),(e?"/":"")+t||"."}function ue(t){var e=le(t),n=dr(t,-1)==="/";return t=qe(ae(t.split("/"),function(i){return!!i}),!e).join("/"),!t&&!e&&(t="."),t&&n&&(t+="/"),(e?"/":"")+t}function le(t){return t.charAt(0)==="/"}function We(){var t=Array.prototype.slice.call(arguments,0);return ue(ae(t,function(e,n){if(typeof e!="string")throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))}function je(t,e){t=zt(t).substr(1),e=zt(e).substr(1);function n(c){for(var v=0;v<c.length&&c[v]==="";v++);for(var m=c.length-1;m>=0&&c[m]==="";m--);return v>m?[]:c.slice(v,m-v+1)}for(var i=n(t.split("/")),r=n(e.split("/")),l=Math.min(i.length,r.length),s=l,h=0;h<l;h++)if(i[h]!==r[h]){s=h;break}for(var o=[],h=s;h<i.length;h++)o.push("..");return o=o.concat(r.slice(s)),o.join("/")}function Ze(t){var e=oe(t),n=e[0],i=e[1];return!n&&!i?".":(i&&(i=i.substr(0,i.length-1)),n+i)}function Ye(t,e){var n=oe(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n}function Qe(t){return oe(t)[3]}function ae(t,e){if(t.filter)return t.filter(e);for(var n=[],i=0;i<t.length;i++)e(t[i],i,t)&&n.push(t[i]);return n}var vr,oe,Xe,Ke,yr,dr,Ve=sr(()=>{vr=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,oe=function(t){return vr.exec(t).slice(1)};Xe="/",Ke=":";yr={extname:Qe,basename:Ye,dirname:Ze,sep:Xe,delimiter:Ke,relative:je,join:We,isAbsolute:le,normalize:ue,resolve:zt};dr="ab".substr(-1)==="b"?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}});var Ut=yt((as,Nt)=>{var gt=(Ve(),Ge);gt&&gt.default?Nt.exports=gt.default:gt&&(Nt.exports=gt);if(gt)for(let t in gt)Nt.exports[t]=gt[t]});var bt=yt((ls,Je)=>{"use strict";var mr=Ut(),st="\\\\/",tn=`[^${st}]`,ht="\\.",Ar="\\+",wr="\\?",Bt="\\/",_r="(?=.)",en="[^/]",he=`(?:${Bt}|$)`,nn=`(?:^|${Bt})`,fe=`${ht}{1,2}${he}`,Er=`(?!${ht})`,Sr=`(?!${nn}${fe})`,Rr=`(?!${ht}{0,1}${he})`,xr=`(?!${fe})`,br=`[^.${Bt}]`,Cr=`${en}*?`,rn={DOT_LITERAL:ht,PLUS_LITERAL:Ar,QMARK_LITERAL:wr,SLASH_LITERAL:Bt,ONE_CHAR:_r,QMARK:en,END_ANCHOR:he,DOTS_SLASH:fe,NO_DOT:Er,NO_DOTS:Sr,NO_DOT_SLASH:Rr,NO_DOTS_SLASH:xr,QMARK_NO_DOT:br,STAR:Cr,START_ANCHOR:nn},Tr={...rn,SLASH_LITERAL:`[${st}]`,QMARK:tn,STAR:`${tn}*?`,DOTS_SLASH:`${ht}{1,2}(?:[${st}]|$)`,NO_DOT:`(?!${ht})`,NO_DOTS:`(?!(?:^|[${st}])${ht}{1,2}(?:[${st}]|$))`,NO_DOT_SLASH:`(?!${ht}{0,1}(?:[${st}]|$))`,NO_DOTS_SLASH:`(?!${ht}{1,2}(?:[${st}]|$))`,QMARK_NO_DOT:`[^.${st}]`,START_ANCHOR:`(?:^|[${st}])`,END_ANCHOR:`(?:[${st}]|$)`},Or={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};Je.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:Or,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:mr.sep,extglobChars(t){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${t.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(t){return t===!0?Tr:rn}}});var Ft=yt(V=>{"use strict";var Lr=Ut(),Hr=!1,{REGEX_BACKSLASH:$r,REGEX_REMOVE_BACKSLASH:kr,REGEX_SPECIAL_CHARS:Ir,REGEX_SPECIAL_CHARS_GLOBAL:Pr}=bt();V.isObject=t=>t!==null&&typeof t=="object"&&!Array.isArray(t);V.hasRegexChars=t=>Ir.test(t);V.isRegexChar=t=>t.length===1&&V.hasRegexChars(t);V.escapeRegex=t=>t.replace(Pr,"\\$1");V.toPosixSlashes=t=>t.replace($r,"/");V.removeBackslashes=t=>t.replace(kr,e=>e==="\\"?"":e);V.supportsLookbehinds=()=>{let t=process.version.slice(1).split(".").map(Number);return t.length===3&&t[0]>=9||t[0]===8&&t[1]>=10};V.isWindows=t=>t&&typeof t.windows=="boolean"?t.windows:Hr===!0||Lr.sep==="\\";V.escapeLast=(t,e,n)=>{let i=t.lastIndexOf(e,n);return i===-1?t:t[i-1]==="\\"?V.escapeLast(t,e,i-1):`${t.slice(0,i)}\\${t.slice(i)}`};V.removePrefix=(t,e={})=>{let n=t;return n.startsWith("./")&&(n=n.slice(2),e.prefix="./"),n};V.wrapOutput=(t,e={},n={})=>{let i=n.contains?"":"^",r=n.contains?"":"$",l=`${i}(?:${t})${r}`;return e.negated===!0&&(l=`(?:^(?!${l}).*$)`),l}});var cn=yt((hs,sn)=>{"use strict";var on=Ft(),{CHAR_ASTERISK:ce,CHAR_AT:Mr,CHAR_BACKWARD_SLASH:Ct,CHAR_COMMA:Dr,CHAR_DOT:pe,CHAR_EXCLAMATION_MARK:ge,CHAR_FORWARD_SLASH:an,CHAR_LEFT_CURLY_BRACE:ve,CHAR_LEFT_PARENTHESES:de,CHAR_LEFT_SQUARE_BRACKET:zr,CHAR_PLUS:Nr,CHAR_QUESTION_MARK:ln,CHAR_RIGHT_CURLY_BRACE:Ur,CHAR_RIGHT_PARENTHESES:un,CHAR_RIGHT_SQUARE_BRACKET:Br}=bt(),hn=t=>t===an||t===Ct,fn=t=>{t.isPrefix!==!0&&(t.depth=t.isGlobstar?Infinity:1)},Fr=(t,e)=>{let n=e||{},i=t.length-1,r=n.parts===!0||n.scanToEnd===!0,l=[],s=[],h=[],o=t,c=-1,v=0,m=0,_=!1,C=!1,S=!1,b=!1,D=!1,X=!1,G=!1,T=!1,F=!1,$=!1,q=0,P,d,R={value:"",depth:0,isGlob:!1},U=()=>c>=i,f=()=>o.charCodeAt(c+1),O=()=>(P=d,o.charCodeAt(++c));for(;c<i;){d=O();let W;if(d===Ct){G=R.backslashes=!0,d=O(),d===ve&&(X=!0);continue}if(X===!0||d===ve){for(q++;U()!==!0&&(d=O());){if(d===Ct){G=R.backslashes=!0,O();continue}if(d===ve){q++;continue}if(X!==!0&&d===pe&&(d=O())===pe){if(_=R.isBrace=!0,S=R.isGlob=!0,$=!0,r===!0)continue;break}if(X!==!0&&d===Dr){if(_=R.isBrace=!0,S=R.isGlob=!0,$=!0,r===!0)continue;break}if(d===Ur&&(q--,q===0)){X=!1,_=R.isBrace=!0,$=!0;break}}if(r===!0)continue;break}if(d===an){if(l.push(c),s.push(R),R={value:"",depth:0,isGlob:!1},$===!0)continue;if(P===pe&&c===v+1){v+=2;continue}m=c+1;continue}if(n.noext!==!0&&(d===Nr||d===Mr||d===ce||d===ln||d===ge)===!0&&f()===de){if(S=R.isGlob=!0,b=R.isExtglob=!0,$=!0,d===ge&&c===v&&(F=!0),r===!0){for(;U()!==!0&&(d=O());){if(d===Ct){G=R.backslashes=!0,d=O();continue}if(d===un){S=R.isGlob=!0,$=!0;break}}continue}break}if(d===ce){if(P===ce&&(D=R.isGlobstar=!0),S=R.isGlob=!0,$=!0,r===!0)continue;break}if(d===ln){if(S=R.isGlob=!0,$=!0,r===!0)continue;break}if(d===zr){for(;U()!==!0&&(W=O());){if(W===Ct){G=R.backslashes=!0,O();continue}if(W===Br){C=R.isBracket=!0,S=R.isGlob=!0,$=!0;break}}if(r===!0)continue;break}if(n.nonegate!==!0&&d===ge&&c===v){T=R.negated=!0,v++;continue}if(n.noparen!==!0&&d===de){if(S=R.isGlob=!0,r===!0){for(;U()!==!0&&(d=O());){if(d===de){G=R.backslashes=!0,d=O();continue}if(d===un){$=!0;break}}continue}break}if(S===!0){if($=!0,r===!0)continue;break}}n.noext===!0&&(b=!1,S=!1);let x=o,J="",u="";v>0&&(J=o.slice(0,v),o=o.slice(v),m-=v),x&&S===!0&&m>0?(x=o.slice(0,m),u=o.slice(m)):S===!0?(x="",u=o):x=o,x&&x!==""&&x!=="/"&&x!==o&&hn(x.charCodeAt(x.length-1))&&(x=x.slice(0,-1)),n.unescape===!0&&(u&&(u=on.removeBackslashes(u)),x&&G===!0&&(x=on.removeBackslashes(x)));let a={prefix:J,input:t,start:v,base:x,glob:u,isBrace:_,isBracket:C,isGlob:S,isExtglob:b,isGlobstar:D,negated:T,negatedExtglob:F};if(n.tokens===!0&&(a.maxDepth=0,hn(d)||s.push(R),a.tokens=s),n.parts===!0||n.tokens===!0){let W;for(let E=0;E<l.length;E++){let Q=W?W+1:v,j=l[E],K=t.slice(Q,j);n.tokens&&(E===0&&v!==0?(s[E].isPrefix=!0,s[E].value=J):s[E].value=K,fn(s[E]),a.maxDepth+=s[E].depth),(E!==0||K!=="")&&h.push(K),W=j}if(W&&W+1<t.length){let E=t.slice(W+1);h.push(E),n.tokens&&(s[s.length-1].value=E,fn(s[s.length-1]),a.maxDepth+=s[s.length-1].depth)}a.slashes=l,a.parts=h}return a};sn.exports=Fr});var dn=yt((fs,pn)=>{"use strict";var Gt=bt(),tt=Ft(),{MAX_LENGTH:qt,POSIX_REGEX_SOURCE:Gr,REGEX_NON_SPECIAL_CHARS:qr,REGEX_SPECIAL_CHARS_BACKREF:Wr,REPLACEMENTS:gn}=Gt,jr=(t,e)=>{if(typeof e.expandRange=="function")return e.expandRange(...t,e);t.sort();let n=`[${t.join("-")}]`;try{new RegExp(n)}catch(i){return t.map(r=>tt.escapeRegex(r)).join("..")}return n},_t=(t,e)=>`Missing ${t}: "${e}" - use "\\\\${e}" to match literal characters`,vn=(t,e)=>{if(typeof t!="string")throw new TypeError("Expected a string");t=gn[t]||t;let n={...e},i=typeof n.maxLength=="number"?Math.min(qt,n.maxLength):qt,r=t.length;if(r>i)throw new SyntaxError(`Input length: ${r}, exceeds maximum allowed length: ${i}`);let l={type:"bos",value:"",output:n.prepend||""},s=[l],h=n.capture?"":"?:",o=tt.isWindows(e),c=Gt.globChars(o),v=Gt.extglobChars(c),{DOT_LITERAL:m,PLUS_LITERAL:_,SLASH_LITERAL:C,ONE_CHAR:S,DOTS_SLASH:b,NO_DOT:D,NO_DOT_SLASH:X,NO_DOTS_SLASH:G,QMARK:T,QMARK_NO_DOT:F,STAR:$,START_ANCHOR:q}=c,P=g=>`(${h}(?:(?!${q}${g.dot?b:m}).)*?)`,d=n.dot?"":D,R=n.dot?T:F,U=n.bash===!0?P(n):$;n.capture&&(U=`(${U})`),typeof n.noext=="boolean"&&(n.noextglob=n.noext);let f={input:t,index:-1,start:0,dot:n.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:s};t=tt.removePrefix(t,f),r=t.length;let O=[],x=[],J=[],u=l,a,W=()=>f.index===r-1,E=f.peek=(g=1)=>t[f.index+g],Q=f.advance=()=>t[++f.index]||"",j=()=>t.slice(f.index+1),K=(g="",k=0)=>{f.consumed+=g,f.index+=k},rt=g=>{f.output+=g.output!=null?g.output:g.value,K(g.value)},xt=()=>{let g=1;for(;E()==="!"&&(E(2)!=="("||E(3)==="?");)Q(),f.start++,g++;return g%2==0?!1:(f.negated=!0,f.start++,!0)},pt=g=>{f[g]++,J.push(g)},it=g=>{f[g]--,J.pop()},A=g=>{if(u.type==="globstar"){let k=f.braces>0&&(g.type==="comma"||g.type==="brace"),p=g.extglob===!0||O.length&&(g.type==="pipe"||g.type==="paren");g.type!=="slash"&&g.type!=="paren"&&!k&&!p&&(f.output=f.output.slice(0,-u.output.length),u.type="star",u.value="*",u.output=U,f.output+=u.output)}if(O.length&&g.type!=="paren"&&(O[O.length-1].inner+=g.value),(g.value||g.output)&&rt(g),u&&u.type==="text"&&g.type==="text"){u.value+=g.value,u.output=(u.output||"")+g.value;return}g.prev=u,s.push(g),u=g},dt=(g,k)=>{let p={...v[k],conditions:1,inner:""};p.prev=u,p.parens=f.parens,p.output=f.output;let w=(n.capture?"(":"")+p.open;pt("parens"),A({type:g,value:k,output:f.output?"":S}),A({type:"paren",extglob:!0,value:Q(),output:w}),O.push(p)},Pt=g=>{let k=g.close+(n.capture?")":""),p;if(g.type==="negate"){let w=U;g.inner&&g.inner.length>1&&g.inner.includes("/")&&(w=P(n)),(w!==U||W()||/^\)+$/.test(j()))&&(k=g.close=`)$))${w}`),g.inner.includes("*")&&(p=j())&&/^\.[^\\/.]+$/.test(p)&&(k=g.close=`)${p})${w})`),g.prev.type==="bos"&&(f.negatedExtglob=!0)}A({type:"paren",extglob:!0,value:a,output:k}),it("parens")};if(n.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(t)){let g=!1,k=t.replace(Wr,(p,w,z,Y,B,re)=>Y==="\\"?(g=!0,p):Y==="?"?w?w+Y+(B?T.repeat(B.length):""):re===0?R+(B?T.repeat(B.length):""):T.repeat(z.length):Y==="."?m.repeat(z.length):Y==="*"?w?w+Y+(B?U:""):U:w?p:`\\${p}`);return g===!0&&(n.unescape===!0?k=k.replace(/\\/g,""):k=k.replace(/\\+/g,p=>p.length%2==0?"\\\\":p?"\\":"")),k===t&&n.contains===!0?(f.output=t,f):(f.output=tt.wrapOutput(k,f,e),f)}for(;!W();){if(a=Q(),a==="\0")continue;if(a==="\\"){let p=E();if(p==="/"&&n.bash!==!0||p==="."||p===";")continue;if(!p){a+="\\",A({type:"text",value:a});continue}let w=/^\\+/.exec(j()),z=0;if(w&&w[0].length>2&&(z=w[0].length,f.index+=z,z%2!=0&&(a+="\\")),n.unescape===!0?a=Q():a+=Q(),f.brackets===0){A({type:"text",value:a});continue}}if(f.brackets>0&&(a!=="]"||u.value==="["||u.value==="[^")){if(n.posix!==!1&&a===":"){let p=u.value.slice(1);if(p.includes("[")&&(u.posix=!0,p.includes(":"))){let w=u.value.lastIndexOf("["),z=u.value.slice(0,w),Y=u.value.slice(w+2),B=Gr[Y];if(B){u.value=z+B,f.backtrack=!0,Q(),!l.output&&s.indexOf(u)===1&&(l.output=S);continue}}}(a==="["&&E()!==":"||a==="-"&&E()==="]")&&(a=`\\${a}`),a==="]"&&(u.value==="["||u.value==="[^")&&(a=`\\${a}`),n.posix===!0&&a==="!"&&u.value==="["&&(a="^"),u.value+=a,rt({value:a});continue}if(f.quotes===1&&a!=='"'){a=tt.escapeRegex(a),u.value+=a,rt({value:a});continue}if(a==='"'){f.quotes=f.quotes===1?0:1,n.keepQuotes===!0&&A({type:"text",value:a});continue}if(a==="("){pt("parens"),A({type:"paren",value:a});continue}if(a===")"){if(f.parens===0&&n.strictBrackets===!0)throw new SyntaxError(_t("opening","("));let p=O[O.length-1];if(p&&f.parens===p.parens+1){Pt(O.pop());continue}A({type:"paren",value:a,output:f.parens?")":"\\)"}),it("parens");continue}if(a==="["){if(n.nobracket===!0||!j().includes("]")){if(n.nobracket!==!0&&n.strictBrackets===!0)throw new SyntaxError(_t("closing","]"));a=`\\${a}`}else pt("brackets");A({type:"bracket",value:a});continue}if(a==="]"){if(n.nobracket===!0||u&&u.type==="bracket"&&u.value.length===1){A({type:"text",value:a,output:`\\${a}`});continue}if(f.brackets===0){if(n.strictBrackets===!0)throw new SyntaxError(_t("opening","["));A({type:"text",value:a,output:`\\${a}`});continue}it("brackets");let p=u.value.slice(1);if(u.posix!==!0&&p[0]==="^"&&!p.includes("/")&&(a=`/${a}`),u.value+=a,rt({value:a}),n.literalBrackets===!1||tt.hasRegexChars(p))continue;let w=tt.escapeRegex(u.value);if(f.output=f.output.slice(0,-u.value.length),n.literalBrackets===!0){f.output+=w,u.value=w;continue}u.value=`(${h}${w}|${u.value})`,f.output+=u.value;continue}if(a==="{"&&n.nobrace!==!0){pt("braces");let p={type:"brace",value:a,output:"(",outputIndex:f.output.length,tokensIndex:f.tokens.length};x.push(p),A(p);continue}if(a==="}"){let p=x[x.length-1];if(n.nobrace===!0||!p){A({type:"text",value:a,output:a});continue}let w=")";if(p.dots===!0){let z=s.slice(),Y=[];for(let B=z.length-1;B>=0&&(s.pop(),z[B].type!=="brace");B--)z[B].type!=="dots"&&Y.unshift(z[B].value);w=jr(Y,n),f.backtrack=!0}if(p.comma!==!0&&p.dots!==!0){let z=f.output.slice(0,p.outputIndex),Y=f.tokens.slice(p.tokensIndex);p.value=p.output="\\{",a=w="\\}",f.output=z;for(let B of Y)f.output+=B.output||B.value}A({type:"brace",value:a,output:w}),it("braces"),x.pop();continue}if(a==="|"){O.length>0&&O[O.length-1].conditions++,A({type:"text",value:a});continue}if(a===","){let p=a,w=x[x.length-1];w&&J[J.length-1]==="braces"&&(w.comma=!0,p="|"),A({type:"comma",value:a,output:p});continue}if(a==="/"){if(u.type==="dot"&&f.index===f.start+1){f.start=f.index+1,f.consumed="",f.output="",s.pop(),u=l;continue}A({type:"slash",value:a,output:C});continue}if(a==="."){if(f.braces>0&&u.type==="dot"){u.value==="."&&(u.output=m);let p=x[x.length-1];u.type="dots",u.output+=a,u.value+=a,p.dots=!0;continue}if(f.braces+f.parens===0&&u.type!=="bos"&&u.type!=="slash"){A({type:"text",value:a,output:m});continue}A({type:"dot",value:a,output:m});continue}if(a==="?"){if(!(u&&u.value==="(")&&n.noextglob!==!0&&E()==="("&&E(2)!=="?"){dt("qmark",a);continue}if(u&&u.type==="paren"){let w=E(),z=a;if(w==="<"&&!tt.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(u.value==="("&&!/[!=<:]/.test(w)||w==="<"&&!/<([!=]|\w+>)/.test(j()))&&(z=`\\${a}`),A({type:"text",value:a,output:z});continue}if(n.dot!==!0&&(u.type==="slash"||u.type==="bos")){A({type:"qmark",value:a,output:F});continue}A({type:"qmark",value:a,output:T});continue}if(a==="!"){if(n.noextglob!==!0&&E()==="("&&(E(2)!=="?"||!/[!=<:]/.test(E(3)))){dt("negate",a);continue}if(n.nonegate!==!0&&f.index===0){xt();continue}}if(a==="+"){if(n.noextglob!==!0&&E()==="("&&E(2)!=="?"){dt("plus",a);continue}if(u&&u.value==="("||n.regex===!1){A({type:"plus",value:a,output:_});continue}if(u&&(u.type==="bracket"||u.type==="paren"||u.type==="brace")||f.parens>0){A({type:"plus",value:a});continue}A({type:"plus",value:_});continue}if(a==="@"){if(n.noextglob!==!0&&E()==="("&&E(2)!=="?"){A({type:"at",extglob:!0,value:a,output:""});continue}A({type:"text",value:a});continue}if(a!=="*"){(a==="$"||a==="^")&&(a=`\\${a}`);let p=qr.exec(j());p&&(a+=p[0],f.index+=p[0].length),A({type:"text",value:a});continue}if(u&&(u.type==="globstar"||u.star===!0)){u.type="star",u.star=!0,u.value+=a,u.output=U,f.backtrack=!0,f.globstar=!0,K(a);continue}let g=j();if(n.noextglob!==!0&&/^\([^?]/.test(g)){dt("star",a);continue}if(u.type==="star"){if(n.noglobstar===!0){K(a);continue}let p=u.prev,w=p.prev,z=p.type==="slash"||p.type==="bos",Y=w&&(w.type==="star"||w.type==="globstar");if(n.bash===!0&&(!z||g[0]&&g[0]!=="/")){A({type:"star",value:a,output:""});continue}let B=f.braces>0&&(p.type==="comma"||p.type==="brace"),re=O.length&&(p.type==="pipe"||p.type==="paren");if(!z&&p.type!=="paren"&&!B&&!re){A({type:"star",value:a,output:""});continue}for(;g.slice(0,3)==="/**";){let Mt=t[f.index+4];if(Mt&&Mt!=="/")break;g=g.slice(3),K("/**",3)}if(p.type==="bos"&&W()){u.type="globstar",u.value+=a,u.output=P(n),f.output=u.output,f.globstar=!0,K(a);continue}if(p.type==="slash"&&p.prev.type!=="bos"&&!Y&&W()){f.output=f.output.slice(0,-(p.output+u.output).length),p.output=`(?:${p.output}`,u.type="globstar",u.output=P(n)+(n.strictSlashes?")":"|$)"),u.value+=a,f.globstar=!0,f.output+=p.output+u.output,K(a);continue}if(p.type==="slash"&&p.prev.type!=="bos"&&g[0]==="/"){let Mt=g[1]!==void 0?"|$":"";f.output=f.output.slice(0,-(p.output+u.output).length),p.output=`(?:${p.output}`,u.type="globstar",u.output=`${P(n)}${C}|${C}${Mt})`,u.value+=a,f.output+=p.output+u.output,f.globstar=!0,K(a+Q()),A({type:"slash",value:"/",output:""});continue}if(p.type==="bos"&&g[0]==="/"){u.type="globstar",u.value+=a,u.output=`(?:^|${C}|${P(n)}${C})`,f.output=u.output,f.globstar=!0,K(a+Q()),A({type:"slash",value:"/",output:""});continue}f.output=f.output.slice(0,-u.output.length),u.type="globstar",u.output=P(n),u.value+=a,f.output+=u.output,f.globstar=!0,K(a);continue}let k={type:"star",value:a,output:U};if(n.bash===!0){k.output=".*?",(u.type==="bos"||u.type==="slash")&&(k.output=d+k.output),A(k);continue}if(u&&(u.type==="bracket"||u.type==="paren")&&n.regex===!0){k.output=a,A(k);continue}(f.index===f.start||u.type==="slash"||u.type==="dot")&&(u.type==="dot"?(f.output+=X,u.output+=X):n.dot===!0?(f.output+=G,u.output+=G):(f.output+=d,u.output+=d),E()!=="*"&&(f.output+=S,u.output+=S)),A(k)}for(;f.brackets>0;){if(n.strictBrackets===!0)throw new SyntaxError(_t("closing","]"));f.output=tt.escapeLast(f.output,"["),it("brackets")}for(;f.parens>0;){if(n.strictBrackets===!0)throw new SyntaxError(_t("closing",")"));f.output=tt.escapeLast(f.output,"("),it("parens")}for(;f.braces>0;){if(n.strictBrackets===!0)throw new SyntaxError(_t("closing","}"));f.output=tt.escapeLast(f.output,"{"),it("braces")}if(n.strictSlashes!==!0&&(u.type==="star"||u.type==="bracket")&&A({type:"maybe_slash",value:"",output:`${C}?`}),f.backtrack===!0){f.output="";for(let g of f.tokens)f.output+=g.output!=null?g.output:g.value,g.suffix&&(f.output+=g.suffix)}return f};vn.fastpaths=(t,e)=>{let n={...e},i=typeof n.maxLength=="number"?Math.min(qt,n.maxLength):qt,r=t.length;if(r>i)throw new SyntaxError(`Input length: ${r}, exceeds maximum allowed length: ${i}`);t=gn[t]||t;let l=tt.isWindows(e),{DOT_LITERAL:s,SLASH_LITERAL:h,ONE_CHAR:o,DOTS_SLASH:c,NO_DOT:v,NO_DOTS:m,NO_DOTS_SLASH:_,STAR:C,START_ANCHOR:S}=Gt.globChars(l),b=n.dot?m:v,D=n.dot?_:v,X=n.capture?"":"?:",G={negated:!1,prefix:""},T=n.bash===!0?".*?":C;n.capture&&(T=`(${T})`);let F=d=>d.noglobstar===!0?T:`(${X}(?:(?!${S}${d.dot?c:s}).)*?)`,$=d=>{switch(d){case"*":return`${b}${o}${T}`;case".*":return`${s}${o}${T}`;case"*.*":return`${b}${T}${s}${o}${T}`;case"*/*":return`${b}${T}${h}${o}${D}${T}`;case"**":return b+F(n);case"**/*":return`(?:${b}${F(n)}${h})?${D}${o}${T}`;case"**/*.*":return`(?:${b}${F(n)}${h})?${D}${T}${s}${o}${T}`;case"**/.*":return`(?:${b}${F(n)}${h})?${s}${o}${T}`;default:{let R=/^(.*?)\.(\w+)$/.exec(d);if(!R)return;let U=$(R[1]);return U?U+s+R[2]:void 0}}},q=tt.removePrefix(t,G),P=$(q);return P&&n.strictSlashes!==!0&&(P+=`${h}?`),P};pn.exports=vn});var mn=yt((cs,yn)=>{"use strict";var Xr=Ut(),Kr=cn(),ye=dn(),me=Ft(),Zr=bt(),Yr=t=>t&&typeof t=="object"&&!Array.isArray(t),N=(t,e,n=!1)=>{if(Array.isArray(t)){let v=t.map(_=>N(_,e,n));return _=>{for(let C of v){let S=C(_);if(S)return S}return!1}}let i=Yr(t)&&t.tokens&&t.input;if(t===""||typeof t!="string"&&!i)throw new TypeError("Expected pattern to be a non-empty string");let r=e||{},l=me.isWindows(e),s=i?N.compileRe(t,e):N.makeRe(t,e,!1,!0),h=s.state;delete s.state;let o=()=>!1;if(r.ignore){let v={...e,ignore:null,onMatch:null,onResult:null};o=N(r.ignore,v,n)}let c=(v,m=!1)=>{let{isMatch:_,match:C,output:S}=N.test(v,s,e,{glob:t,posix:l}),b={glob:t,state:h,regex:s,posix:l,input:v,output:S,match:C,isMatch:_};return typeof r.onResult=="function"&&r.onResult(b),_===!1?(b.isMatch=!1,m?b:!1):o(v)?(typeof r.onIgnore=="function"&&r.onIgnore(b),b.isMatch=!1,m?b:!1):(typeof r.onMatch=="function"&&r.onMatch(b),m?b:!0)};return n&&(c.state=h),c};N.test=(t,e,n,{glob:i,posix:r}={})=>{if(typeof t!="string")throw new TypeError("Expected input to be a string");if(t==="")return{isMatch:!1,output:""};let l=n||{},s=l.format||(r?me.toPosixSlashes:null),h=t===i,o=h&&s?s(t):t;return h===!1&&(o=s?s(t):t,h=o===i),(h===!1||l.capture===!0)&&(l.matchBase===!0||l.basename===!0?h=N.matchBase(t,e,n,r):h=e.exec(o)),{isMatch:Boolean(h),match:h,output:o}};N.matchBase=(t,e,n,i=me.isWindows(n))=>(e instanceof RegExp?e:N.makeRe(e,n)).test(Xr.basename(t));N.isMatch=(t,e,n)=>N(e,n)(t);N.parse=(t,e)=>Array.isArray(t)?t.map(n=>N.parse(n,e)):ye(t,{...e,fastpaths:!1});N.scan=(t,e)=>Kr(t,e);N.compileRe=(t,e,n=!1,i=!1)=>{if(n===!0)return t.output;let r=e||{},l=r.contains?"":"^",s=r.contains?"":"$",h=`${l}(?:${t.output})${s}`;t&&t.negated===!0&&(h=`^(?!${h}).*$`);let o=N.toRegex(h,e);return i===!0&&(o.state=t),o};N.makeRe=(t,e={},n=!1,i=!1)=>{if(!t||typeof t!="string")throw new TypeError("Expected a non-empty string");let r={negated:!1,fastpaths:!0};return e.fastpaths!==!1&&(t[0]==="."||t[0]==="*")&&(r.output=ye.fastpaths(t,e)),r.output||(r=ye(t,e)),N.compileRe(r,e,n,i)};N.toRegex=(t,e)=>{try{let n=e||{};return new RegExp(t,n.flags||(n.nocase?"i":""))}catch(n){if(e&&e.debug===!0)throw n;return/$^/}};N.constants=Zr;yn.exports=N});var wn=yt((ps,An)=>{"use strict";An.exports=mn()});var ur=`<div class="container">
  <label class="hidden" id="title">display-port</label>
  <label class="hidden" id="fps">00</label>
  <label class="hidden" id="dimension">0x0</label>
  <div class="content">
    <canvas> Oh no! Your browser does not support canvas. </canvas>
    <slot id="inner"></slot>
  </div>
  <slot name="frame"></slot>
</div>
`,hr=`:host {
  display: inline-block;
  color: #555555;
}

.container {
  display: flex;
  position: relative;
  width: 100%;
  height: 100%;
}

.content {
  position: relative;
  margin: auto;
}

.content > *:not(canvas) {
  width: 100%;
  height: 100%;
}

canvas {
  background: #000000;
  image-rendering: pixelated;
}

label {
  position: absolute;
  font-family: monospace;
  color: currentColor;
}

#inner {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: 0;
  left: 0;
  pointer-events: none;
}

#title {
  left: 0.5rem;
  top: 0.5rem;
}

#fps {
  right: 0.5rem;
  top: 0.5rem;
}

#dimension {
  left: 0.5rem;
  bottom: 0.5rem;
}

.hidden {
  display: none;
}

:host([debug]) .container {
  outline: 6px dashed rgba(0, 0, 0, 0.1);
  outline-offset: -4px;
  background-color: rgba(0, 0, 0, 0.1);
}

:host([mode='noscale']) canvas {
  margin: 0;
  top: 0;
  left: 0;
}

:host([mode='stretch']) canvas,
:host([mode='scale']) canvas {
  width: 100%;
  height: 100%;
}

:host([mode='fit']),
:host([mode='scale']),
:host([mode='center']),
:host([mode='stretch']),
:host([mode='fill']) {
  width: 100%;
  height: 100%;
}

:host([full]) {
  width: 100vw !important;
  height: 100vh !important;
}

:host([disabled]) {
  display: none;
}

slot {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  pointer-events: none;
}

::slotted(*) {
  pointer-events: auto;
}
`,Pe="noscale",ie="fit",Me="scale",De="fill",ze="stretch",fr=300,cr=150,pr=ie,gr=200,Ne=class extends HTMLElement{static get[Symbol.for("templateNode")](){let e=document.createElement("template");return e.innerHTML=ur,Object.defineProperty(this,Symbol.for("templateNode"),{value:e}),e}static get[Symbol.for("styleNode")](){let e=document.createElement("style");return e.innerHTML=hr,Object.defineProperty(this,Symbol.for("styleNode"),{value:e}),e}static define(e=window.customElements){e.define("display-port",this)}static get observedAttributes(){return["debug","disabled","width","height","onframe","id","class"]}get mode(){return this.getAttribute("mode")}set mode(e){this.setAttribute("mode",e)}get debug(){return this._debug}set debug(e){this.toggleAttribute("debug",e)}get disabled(){return this._disabled}set disabled(e){this.toggleAttribute("disabled",e)}get width(){return this._width}set width(e){this.setAttribute("width",String(e))}get height(){return this._height}set height(e){this.setAttribute("height",String(e))}get onframe(){return this._onframe}set onframe(e){this._onframe&&this.removeEventListener("frame",this._onframe),this._onframe=e,this._onframe&&this.addEventListener("frame",e)}constructor(){super();let e=this.attachShadow({mode:"open"});e.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),e.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._canvasElement=e.querySelector("canvas"),this._contentElement=e.querySelector(".content"),this._innerElement=e.querySelector("#inner"),this._titleElement=e.querySelector("#title"),this._fpsElement=e.querySelector("#fps"),this._dimensionElement=e.querySelector("#dimension"),this._debug=!1,this._disabled=!1,this._width=fr,this._height=cr,this._onframe=void 0,this._animationRequestHandle=0,this._prevAnimationFrameTime=0,this._resizeTimeoutHandle=0,this._resizeCanvasWidth=0,this._resizeCanvasHeight=0,this._frameEvent=new CustomEvent("frame",{composed:!0,bubbles:!1,detail:{now:0,prevTime:0,deltaTime:0,canvas:this._canvasElement}}),this._resizeEvent=new CustomEvent("resize",{composed:!0,bubbles:!1,detail:{width:0,height:0}}),this.update=this.update.bind(this),this.onDelayCanvasResize=this.onDelayCanvasResize.bind(this)}get canvas(){return this._canvasElement}connectedCallback(){wt(this,"mode"),wt(this,"debug"),wt(this,"disabled"),wt(this,"width"),wt(this,"height"),wt(this,"onframe"),this.hasAttribute("mode")||this.setAttribute("mode",pr),this.hasAttribute("tabindex")||this.setAttribute("tabindex","0"),this.updateCanvasSize(!0),this.resume()}disconnectedCallback(){this.pause()}attributeChangedCallback(e,n,i){switch(e){case"debug":this._debug=i!==null;break;case"disabled":this._disabled=i!==null;break;case"width":this._width=Number(i);break;case"height":this._height=Number(i);break;case"onframe":this.onframe=new Function("event","with(document){with(this){"+i+"}}").bind(this);break}switch(e){case"disabled":i?(this.update(0),this.pause()):this.resume();break;case"id":case"class":this._titleElement.innerHTML=`display-port${this.className?"."+this.className:""}${this.hasAttribute("id")?"#"+this.getAttribute("id"):""}`;break;case"debug":this._titleElement.classList.toggle("hidden",i),this._fpsElement.classList.toggle("hidden",i),this._dimensionElement.classList.toggle("hidden",i);break}}getContext(e="2d",n=void 0){return this._canvasElement.getContext(e,n)}pause(){cancelAnimationFrame(this._animationRequestHandle)}resume(){this._animationRequestHandle=requestAnimationFrame(this.update)}update(e){this._animationRequestHandle=requestAnimationFrame(this.update),this.updateCanvasSize(!1);let n=e-this._prevAnimationFrameTime;if(this._prevAnimationFrameTime=e,this._debug){let l=n<=0?"--":String(Math.round(1e3/n)).padStart(2,"0");if(this._fpsElement.textContent!==l&&(this._fpsElement.textContent=l),this.mode===Pe){let h=`${this._width}x${this._height}`;this._dimensionElement.textContent!==h&&(this._dimensionElement.textContent=h)}else{let h=`${this._width}x${this._height}|${this.shadowRoot.host.clientWidth}x${this.shadowRoot.host.clientHeight}`;this._dimensionElement.textContent!==h&&(this._dimensionElement.textContent=h)}}let r=this._frameEvent.detail;r.now=e,r.prevTime=this._prevAnimationFrameTime,r.deltaTime=n,this.dispatchEvent(this._frameEvent)}onDelayCanvasResize(){this._resizeTimeoutHandle=0,this.updateCanvasSize(!0)}delayCanvasResize(e,n){(e!==this._resizeCanvasWidth||n!==this._resizeCanvasHeight)&&(this._resizeCanvasWidth=e,this._resizeCanvasHeight=n,this._resizeTimeoutHandle&&clearTimeout(this._resizeTimeoutHandle),this._resizeTimeoutHandle=setTimeout(this.onDelayCanvasResize,gr))}updateCanvasSize(e=!0){let n=this.shadowRoot.host.getBoundingClientRect(),i=n.width,r=n.height,l=this._canvasElement,s=this._width,h=this._height,o=this.mode;if(o===ze||o===De)s=i,h=r;else if(o!==Pe&&(i<s||r<h||o===ie||o==Me)){let v=i/s,m=r/h;v<m?(s=i,h=h*v):(s=s*m,h=r)}if(s=Math.floor(s),h=Math.floor(h),typeof e=="undefined"&&(e=l.clientWidth!==s||l.clientHeight!==h),!e){this.delayCanvasResize(s,h);return}let c=Math.min(s/this._width,h/this._height)*.5;if(this._innerElement.style.fontSize=`font-size: ${c}em`,e){o===Me?(l.width=this._width,l.height=this._height):o!==ze&&(l.width=s,l.height=h);let v=this._contentElement.style;v.width=`${s}px`,v.height=`${h}px`,(o===ie||o===De)&&(this._width=s,this._height=h);let _=this._resizeEvent.detail;_.width=s,_.height=h,this.dispatchEvent(this._resizeEvent)}}};Ne.define();function wt(t,e){if(Object.prototype.hasOwnProperty.call(t,e)){let n=t[e];delete t[e],t[e]=n}}var se=class{next(){return 0}},Ue=class extends se{next(){return Math.random()}},Be=class extends se{constructor(e){super();this.seed=e,this.a=e}next(){var e=this.a+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}},y=class{static get RAND(){let e=new this;return this.next=this.next.bind(this),this.choose=this.choose.bind(this),this.range=this.range.bind(this),this.rangeInt=this.rangeInt.bind(this),this.sign=this.sign.bind(this),Object.defineProperty(this,"RAND",{value:e}),e}constructor(e=void 0){typeof e=="number"?this.generator=new Be(e):e?this.generator=e:this.generator=new Ue,this.next=this.next.bind(this),this.choose=this.choose.bind(this),this.range=this.range.bind(this),this.rangeInt=this.rangeInt.bind(this),this.sign=this.sign.bind(this)}static next(){return this.RAND.next()}next(){return this.generator.next()}static choose(e){return this.RAND.choose(e)}choose(e){return e[Math.floor(this.generator.next()*e.length)]}static range(e,n){return this.RAND.range(e,n)}range(e,n){return(n-e)*this.generator.next()+e}static rangeInt(e,n){return this.RAND.rangeInt(e,n)}rangeInt(e,n){return Math.trunc(this.range(e,n))}static sign(){return this.RAND.sign()}sign(){return this.generator.next()<.5?-1:1}};window.addEventListener("error",Fe,!0);window.addEventListener("unhandledrejection",Fe,!0);function Fe(t){t instanceof PromiseRejectionEvent?window.alert(t.reason.stack):t instanceof ErrorEvent?window.alert(t.error.stack):window.alert(JSON.stringify(t))}var ci=lr(wn());var _n={},Qr=function(t,e,n,i,r){var l=new Worker(_n[e]||(_n[e]=URL.createObjectURL(new Blob([t],{type:"text/javascript"}))));return l.onerror=function(s){return r(s.error,null)},l.onmessage=function(s){return r(null,s.data)},l.postMessage(n,i),l},Z=Uint8Array,ot=Uint16Array,Tt=Uint32Array,Ae=new Z([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),we=new Z([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),En=new Z([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Sn=function(t,e){for(var n=new ot(31),i=0;i<31;++i)n[i]=e+=1<<t[i-1];for(var r=new Tt(n[30]),i=1;i<30;++i)for(var l=n[i];l<n[i+1];++l)r[l]=l-n[i]<<5|i;return[n,r]},Rn=Sn(Ae,2),_e=Rn[0],Vr=Rn[1];_e[28]=258,Vr[258]=28;var xn=Sn(we,0),bn=xn[0],vs=xn[1],Wt=new ot(32768);for(var I=0;I<32768;++I)ft=(I&43690)>>>1|(I&21845)<<1,ft=(ft&52428)>>>2|(ft&13107)<<2,ft=(ft&61680)>>>4|(ft&3855)<<4,Wt[I]=((ft&65280)>>>8|(ft&255)<<8)>>>1;var ft,Et=function(t,e,n){for(var i=t.length,r=0,l=new ot(e);r<i;++r)++l[t[r]-1];var s=new ot(e);for(r=0;r<e;++r)s[r]=s[r-1]+l[r-1]<<1;var h;if(n){h=new ot(1<<e);var o=15-e;for(r=0;r<i;++r)if(t[r])for(var c=r<<4|t[r],v=e-t[r],m=s[t[r]-1]++<<v,_=m|(1<<v)-1;m<=_;++m)h[Wt[m]>>>o]=c}else for(h=new ot(i),r=0;r<i;++r)t[r]&&(h[r]=Wt[s[t[r]-1]++]>>>15-t[r]);return h},Ot=new Z(288);for(var I=0;I<144;++I)Ot[I]=8;for(var I=144;I<256;++I)Ot[I]=9;for(var I=256;I<280;++I)Ot[I]=7;for(var I=280;I<288;++I)Ot[I]=8;var Cn=new Z(32);for(var I=0;I<32;++I)Cn[I]=5;var Tn=Et(Ot,9,1);var On=Et(Cn,5,1),jt=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},et=function(t,e,n){var i=e/8|0;return(t[i]|t[i+1]<<8)>>(e&7)&n},Xt=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(e&7)},Ln=function(t){return(t/8|0)+(t&7&&1)},Kt=function(t,e,n){(e==null||e<0)&&(e=0),(n==null||n>t.length)&&(n=t.length);var i=new(t instanceof ot?ot:t instanceof Tt?Tt:Z)(n-e);return i.set(t.subarray(e,n)),i},Hn=function(t,e,n){var i=t.length;if(!i||n&&!n.l&&i<5)return e||new Z(0);var r=!e||n,l=!n||n.i;n||(n={}),e||(e=new Z(i*3));var s=function(A){var dt=e.length;if(A>dt){var Pt=new Z(Math.max(dt*2,A));Pt.set(e),e=Pt}},h=n.f||0,o=n.p||0,c=n.b||0,v=n.l,m=n.d,_=n.m,C=n.n,S=i*8;do{if(!v){n.f=h=et(t,o,1);var b=et(t,o+1,3);if(o+=3,b)if(b==1)v=Tn,m=On,_=9,C=5;else if(b==2){var T=et(t,o,31)+257,F=et(t,o+10,15)+4,$=T+et(t,o+5,31)+1;o+=14;for(var q=new Z($),P=new Z(19),d=0;d<F;++d)P[En[d]]=et(t,o+d*3,7);o+=F*3;for(var R=jt(P),U=(1<<R)-1,f=Et(P,R,1),d=0;d<$;){var O=f[et(t,o,U)];o+=O&15;var D=O>>>4;if(D<16)q[d++]=D;else{var x=0,J=0;for(D==16?(J=3+et(t,o,3),o+=2,x=q[d-1]):D==17?(J=3+et(t,o,7),o+=3):D==18&&(J=11+et(t,o,127),o+=7);J--;)q[d++]=x}}var u=q.subarray(0,T),a=q.subarray(T);_=jt(u),C=jt(a),v=Et(u,_,1),m=Et(a,C,1)}else throw"invalid block type";else{var D=Ln(o)+4,X=t[D-4]|t[D-3]<<8,G=D+X;if(G>i){if(l)throw"unexpected EOF";break}r&&s(c+X),e.set(t.subarray(D,G),c),n.b=c+=X,n.p=o=G*8;continue}if(o>S){if(l)throw"unexpected EOF";break}}r&&s(c+131072);for(var W=(1<<_)-1,E=(1<<C)-1,Q=o;;Q=o){var x=v[Xt(t,o)&W],j=x>>>4;if(o+=x&15,o>S){if(l)throw"unexpected EOF";break}if(!x)throw"invalid length/literal";if(j<256)e[c++]=j;else if(j==256){Q=o,v=null;break}else{var K=j-254;if(j>264){var d=j-257,rt=Ae[d];K=et(t,o,(1<<rt)-1)+_e[d],o+=rt}var xt=m[Xt(t,o)&E],pt=xt>>>4;if(!xt)throw"invalid distance";o+=xt&15;var a=bn[pt];if(pt>3){var rt=we[pt];a+=Xt(t,o)&(1<<rt)-1,o+=rt}if(o>S){if(l)throw"unexpected EOF";break}r&&s(c+131072);for(var it=c+K;c<it;c+=4)e[c]=e[c-a],e[c+1]=e[c+1-a],e[c+2]=e[c+2-a],e[c+3]=e[c+3-a];c=it}}n.l=v,n.p=Q,n.b=c,v&&(h=1,n.m=_,n.d=m,n.n=C)}while(!h);return c==e.length?e:Kt(e,0,c)};var Jr=new Z(0);var ti=function(t,e){var n={};for(var i in t)n[i]=t[i];for(var i in e)n[i]=e[i];return n},$n=function(t,e,n){for(var i=t(),r=t.toString(),l=r.slice(r.indexOf("[")+1,r.lastIndexOf("]")).replace(/ /g,"").split(","),s=0;s<i.length;++s){var h=i[s],o=l[s];if(typeof h=="function"){e+=";"+o+"=";var c=h.toString();if(h.prototype)if(c.indexOf("[native code]")!=-1){var v=c.indexOf(" ",8)+1;e+=c.slice(v,c.indexOf("(",v))}else{e+=c;for(var m in h.prototype)e+=";"+o+".prototype."+m+"="+h.prototype[m].toString()}else e+=c}else n[o]=h}return[e,n]},Zt=[],ei=function(t){var e=[];for(var n in t)(t[n]instanceof Z||t[n]instanceof ot||t[n]instanceof Tt)&&e.push((t[n]=new t[n].constructor(t[n])).buffer);return e},ni=function(t,e,n,i){var r;if(!Zt[n]){for(var l="",s={},h=t.length-1,o=0;o<h;++o)r=$n(t[o],l,s),l=r[0],s=r[1];Zt[n]=$n(t[h],l,s)}var c=ti({},Zt[n][1]);return Qr(Zt[n][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",n,c,ei(c),i)},ri=function(){return[Z,ot,Tt,Ae,we,En,_e,bn,Tn,On,Wt,Et,jt,et,Xt,Ln,Kt,Hn,Ee,kn,In]};var kn=function(t){return postMessage(t,[t.buffer])},In=function(t){return t&&t.size&&new Z(t.size)},ii=function(t,e,n,i,r,l){var s=ni(n,i,r,function(h,o){s.terminate(),l(h,o)});return s.postMessage([t,e],e.consume?[t.buffer]:[]),function(){s.terminate()}};var at=function(t,e){return t[e]|t[e+1]<<8},nt=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},Se=function(t,e){return nt(t,e)+nt(t,e+4)*4294967296};function si(t,e,n){if(n||(n=e,e={}),typeof n!="function")throw"no callback";return ii(t,e,[ri],function(i){return kn(Ee(i.data[0],In(i.data[1])))},1,n)}function Ee(t,e){return Hn(t,e)}var ds=typeof TextEncoder!="undefined"&&new TextEncoder,Re=typeof TextDecoder!="undefined"&&new TextDecoder,oi=0;try{Re.decode(Jr,{stream:!0}),oi=1}catch(t){}var ai=function(t){for(var e="",n=0;;){var i=t[n++],r=(i>127)+(i>223)+(i>239);if(n+r>t.length)return[e,Kt(t,n-1)];r?r==3?(i=((i&15)<<18|(t[n++]&63)<<12|(t[n++]&63)<<6|t[n++]&63)-65536,e+=String.fromCharCode(55296|i>>10,56320|i&1023)):r&1?e+=String.fromCharCode((i&31)<<6|t[n++]&63):e+=String.fromCharCode((i&15)<<12|(t[n++]&63)<<6|t[n++]&63):e+=String.fromCharCode(i)}};function li(t,e){if(e){for(var n="",i=0;i<t.length;i+=16384)n+=String.fromCharCode.apply(null,t.subarray(i,i+16384));return n}else{if(Re)return Re.decode(t);var r=ai(t),l=r[0],s=r[1];if(s.length)throw"invalid utf-8 data";return l}}var ui=function(t,e){return e+30+at(t,e+26)+at(t,e+28)},fi=function(t,e,n){var i=at(t,e+28),r=li(t.subarray(e+46,e+46+i),!(at(t,e+8)&2048)),l=e+46+i,s=nt(t,e+20),h=n&&s==4294967295?hi(t,l):[s,nt(t,e+24),nt(t,e+42)],o=h[0],c=h[1],v=h[2];return[at(t,e+10),o,c,r,l+at(t,e+30)+at(t,e+32),v]},hi=function(t,e){for(;at(t,e)!=1;e+=4+at(t,e+2));return[Se(t,e+12),Se(t,e+4),Se(t,e+20)]};function xe(t,e){if(typeof e!="function")throw"no callback";for(var n=[],i=function(){for(var _=0;_<n.length;++_)n[_]()},r={},l=t.length-22;nt(t,l)!=101010256;--l)if(!l||t.length-l>65558){e("invalid zip file",null);return}var s=at(t,l+8);s||e(null,{});var h=s,o=nt(t,l+16),c=o==4294967295;if(c){if(l=nt(t,l-12),nt(t,l)!=101075792){e("invalid zip file",null);return}h=s=nt(t,l+32),o=nt(t,l+48)}for(var v=function(_){var C=fi(t,o,c),S=C[0],b=C[1],D=C[2],X=C[3],G=C[4],T=C[5],F=ui(t,T);o=G;var $=function(P,d){P?(i(),e(P,null)):(r[X]=d,--s||e(null,r))};if(!S)$(null,Kt(t,F,F+b));else if(S==8){var q=t.subarray(F,F+b);if(b<32e4)try{$(null,Ee(q,new Z(D)))}catch(P){$(P,null)}else n.push(si(q,{size:D},$))}else $("unknown compression type "+S,null)},m=0;m<h;++m)v(m);return i}var pi=/^([_\w\d]+)\:\/\//,Pn=5e3;async function gi(t,e,n,i,r=Pn){let{cache:l,loadings:s}=t;if(e in l)return l[e];let h;if(e in s){if(h=s[e],h.active)return s[e].promise}else h=new be(r),s[e]=h;let o=[h.promise];return pi.test(n)?o.push(Mn(t,n,r).then(c=>i(c)).then(c=>St(t,e,c))):o.push(fetch(n).then(c=>c.arrayBuffer()).then(c=>i(c)).then(c=>St(t,e,c))),await Promise.race(o)}function St(t,e,n){let{cache:i,loadings:r}=t;return i[e]=n,e in r&&(r[e].resolve(n),delete r[e]),n}function vi(t,e){let{cache:n,loadings:i}=t;e in i&&(i[e].reject(new Error("Stop loading to delete asset.")),delete i[e]),e in n&&delete n[e]}async function Mn(t,e,n=Pn){let{cache:i,loadings:r}=t;if(e in i)return i[e];if(e in r)return r[e].promise;{let l=new be(n);return r[e]=l,l.promise}}function di(t,e){let{defaults:n}=t;for(let i of n)if(i.glob.test(e))return Ce(t,i.uri);return null}function Ce(t,e){return t.cache[e]}function yi(t){return Object.keys(t.cache)}var be=class{constructor(e){this.active=!1,this._resolve=null,this._reject=null,this._reason=null,this._value=null,this._timeoutHandle=Number.isFinite(e)&&e>0?setTimeout(()=>{this.reject(`Asset loading exceeded timeout of ${e} ms.`)},e):null,this._promise=new Promise((n,i)=>{this._value?n(this._value):this._resolve=n,this._reason?i(this._reason):this._reject=i})}get promise(){return this._promise}resolve(e){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._resolve?this._resolve(e):this._value=e}reject(e){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._reject?this._reject(e):this._reason=e}},vt=class{constructor(e,n,i){this.uri=e,this.source=n,this.loader=i,this.store=null}get current(){return Ce(this.store,this.uri)}set current(e){St(this.store,this.uri,e)}get default(){return di(this.store,this.uri)}get loaded(){return Mn(this.store,this.uri)}async preload(e,n=void 0,i=void 0){return this.store=e,typeof i!="undefined"?St(e,this.uri,i):await gi(this.store,this.uri,this.source,this.loader,n),this}async unload(){return vi(this.store,this.uri),this.store=null,this}},mi=5e3,Lt={cache:{},loadings:{},defaults:[]};async function Ai(t,e=void 0){let n="raw://",r=await(await fetch(t)).arrayBuffer();await new Promise((l,s)=>{xe(new Uint8Array(r),(h,o)=>{if(h)s(h);else{for(let[c,v]of Object.entries(o)){c=c.replaceAll("\\","/");let m=c.indexOf("/");m>=0&&(c=c.substring(m+1));let _=n+c;St(Lt,_,v),e&&e(v,_,c)}l()}})})}async function wi(t,e){let i=await(await fetch(t)).arrayBuffer();await new Promise((r,l)=>{xe(new Uint8Array(i),(s,h)=>{if(s)l(s);else{for(let[o,c]of Object.entries(h))o=o.replaceAll("\\","/"),e(c,o);r()}})})}async function _i(t,e=mi){let n=[];for(let i of t)n.push(i.preload(Lt,e));await Promise.allSettled(n)}function Ei(t,e){return St(Lt,t,e)}function Si(){return yi(Lt)}function Dn(t){return Ce(Lt,t)}function Ri(t){return Dn(t)}var Te=Object.freeze({__proto__:null,loadAssetPackAsRaw:Ai,loadAssetPack:wi,loadAssetRefs:_i,cache:Ei,keys:Si,current:Dn,get:Ri});var Oe=Symbol("audioContext"),Yt=class{static getAudioContext(){if(Oe in this)return this[Oe];{let e=new AudioContext;return xi(e),this[Oe]=e,e}}constructor(e,n){this.audioContext=e,this.audioBuffer=n,this._playing=!1,this._started=!1,this._source=null,this.onAudioSourceEnded=this.onAudioSourceEnded.bind(this)}destroy(){this._source&&this._source.disconnect(),this._source=null,this._started=!1,this._playing=!1}onAudioSourceEnded(){this._playing=!1}play(e={}){let n=this.audioBuffer;if(!n)return;this._source&&this.destroy();let{pitch:i=void 0,gain:r=void 0,pan:l=void 0,loop:s=!1}=e,h=this.audioContext,o=h.createBufferSource();o.addEventListener("ended",this.onAudioSourceEnded),o.buffer=n,o.loop=s;let c=o;if(i&&(o.detune.value=i*100),r){let v=h.createGain();v.gain.value=r,c=c.connect(v)}if(l){let v=h.createStereoPanner();v.pan.value=l,c=c.connect(v)}c.connect(h.destination),o.start(),this._source=o,this._started=!0,this._playing=!0}pause(){this._source.stop(),this._playing=!1}isStarted(){return this._started}isPlaying(){return this._playing}isPaused(){return this._started&&!this._playing}};function xi(t){let e=()=>{t.state==="suspended"&&t.resume()};document.addEventListener("click",e)}async function Le(t,e){if(typeof t=="string"){let s=await(await fetch(t)).arrayBuffer();return Le(s)}else if(!(t instanceof ArrayBuffer||ArrayBuffer.isView(t)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let n=t,i=new ArrayBuffer(n.byteLength);return new Uint8Array(i).set(n),await e.decodeAudioData(i)}async function mt(t){let e=Yt.getAudioContext(),n=await Le(t,e);return new Yt(e,n)}var lt={SoundStart:new vt("start","raw://start.wav",mt),SoundDead:new vt("dead","raw://dead.wav",mt),SoundPop:new vt("pop","raw://boop.wav",mt),SoundShoot:new vt("shoot","raw://click.wav",mt),SoundBoom:new vt("boom","raw://boom.wav",mt),BackgroundMusic:new vt("music","raw://music.wav",mt)};async function zn(){await Te.loadAssetPackAsRaw("res.pack"),Te.loadAssetRefs(Object.values(lt))}var bi=[2,4],Ci=[.3,1],Ti=30;function Nn(t,e){let n={x:[],y:[],size:[],speed:[],length:0,width:t,height:e};for(let i=0;i<Ti;++i)n.x.push(y.range(0,t)),n.y.push(y.range(0,e)),n.size.push(y.range(...bi)),n.speed.push(y.range(...Ci)),n.length++;return n}function Un(t,e,n="white"){for(let i=0;i<e.length;++i){let r=e.x[i],l=e.y[i],s=e.size[i],h=s/2;t.fillStyle=n,t.fillRect(r-h,l-h,s,s)}}function Bn(t,e=1,n=0){let{length:i,width:r,height:l}=t;for(let s=0;s<i;++s){let h=e*t.speed[s],o=n*t.speed[s];t.x[s]+=h,t.y[s]+=o,h<0?t.x[s]<0&&(t.x[s]=r,t.y[s]=y.range(0,l)):h>0&&t.x[s]>r&&(t.x[s]=0,t.y[s]=y.range(0,l)),o<0?t.y[s]<0&&(t.x[s]=y.range(0,r),t.y[s]=l):o>0&&t.y[s]>l&&(t.x[s]=y.range(0,r),t.y[s]=0)}}var Oi=document.querySelector("#display"),L=Oi.canvas,Li=L.getContext("2d"),He=0,Qt={load:Hi,start:$i,update:ki,render:Ii};window.addEventListener("DOMContentLoaded",Pi);function Pi(){Qt.load().then(()=>{Qt.start(),Fn(He=performance.now())})}function Fn(t){requestAnimationFrame(Fn);let e=t-He;He=t,Qt.update(e),Qt.render(Li)}var ut=5,Ht=4,H=8,Gn=[[-H,-H,H*2+L.width,H],[-H,0,H,L.height],[-H,L.height,H*2+L.width,H],[L.width,0,H,L.height]],Vt=[3e3,1e4],Mi=1,Di=100,M=1,At=2,Jt=4,zi=2e3,Ni=100,qn=10,$t=4,Wn=2,kt=600,jn=.1,Ui=["red","red","red","yellow","orange"],Xn=["blue","blue","blue","dodgerblue","gray","darkgray","yellow"],Bi=["gray","darkgray","lightgray"],Fi="[ wasd_ ]",te=[-2,2],Kn=1.5,Gi=.1,qi=.4,$e=.1,Zn=.02,Wi=.008,ji=.1,Yn=.001,Xi="gold";var ct=4,Ki=["white","violet","violet"],Zi=30,Yi=.7,ke=!1;async function Hi(){console.log("Loading..."),await zn(),console.log("...loading complete!")}function $i(){this.level=0,this.score=0,this.highScore=Number(localStorage.getItem("highscore")),this.flashScoreDelta=0,this.flashHighScoreDelta=0,this.flashShootDelta=0,this.player={scene:this,x:L.width/2,y:L.height/2,rotation:0,dx:0,dy:0,dr:0,left:0,right:0,up:0,down:0,cooldown:0,powerMode:0,shoot(){if(!(this.scene.bullets.length>Ni)&&!(this.cooldown>0)){if(this.powerMode>0){for(let t=-1;t<=1;++t){let e=this.rotation+t*Math.PI/4,n=Qn(this.scene,this.x-Math.cos(e)*ut,this.y-Math.sin(e)*ut,-Math.cos(e)*Jt+this.dx,-Math.sin(e)*Jt+this.dy);this.scene.bullets.push(n)}--this.powerMode}else{let t=Qn(this.scene,this.x-Math.cos(this.rotation)*ut,this.y-Math.sin(this.rotation)*ut,-Math.cos(this.rotation)*Jt+this.dx,-Math.sin(this.rotation)*Jt+this.dy);this.scene.bullets.push(t)}this.cooldown=qn,lt.SoundShoot.current.play()}}},this.asteroids=[],this.asteroidSpawner={scene:this,spawnTicks:Vt[1],reset(){this.spawnTicks=Vt[1]},spawn(){if(this.scene.asteroids.length>Di)return;let t=y.choose(Gn),e=It(this.scene,y.range(t[0],t[0]+t[2]),y.range(t[1],t[1]+t[3]),y.range(-M,M),y.range(-M,M),H);this.scene.asteroids.push(e)},update(t){this.scene.gamePause||(this.spawnTicks-=t,this.spawnTicks<=0&&(this.spawn(),this.spawnTicks=y.range(Vt[0],Vt[1])))}},this.bullets=[],this.particles=[],this.powerUps=[],this.powerUpSpawner={scene:this,reset(){},spawn(){let t=y.choose(Gn),e=Qi(this.scene,y.range(t[0],t[0]+t[2]),y.range(t[1],t[1]+t[3]),y.range(-M,M),y.range(-M,M));this.scene.powerUps.push(e)},update(t){}},this.starfield=Nn(L.width,L.height),this.gamePause=!0,this.showPlayer=!0,this.gameStart=!0,this.gameWait=!0,this.hint=Fi,document.addEventListener("keydown",t=>Vi.call(this,t.key)),document.addEventListener("keyup",t=>Ji.call(this,t.key))}function ki(t){if(this.gamePause){for(let r of this.particles)r.age+=t,r.age>kt?r.destroy():(r.x+=r.dx,r.y+=r.dy,Rt(r,$t*2,$t*2));return}let e=this.player.right-this.player.left,n=this.player.down-this.player.up,i=this.player.fire;this.player.dx+=n*Math.cos(this.player.rotation)*Zn,this.player.dy+=n*Math.sin(this.player.rotation)*Zn,this.player.dx*=1-Yn,this.player.dy*=1-Yn,this.player.dr+=e*Wi,this.player.dr*=1-ji,this.player.x+=this.player.dx,this.player.y+=this.player.dy,this.player.rotation+=this.player.dr,--this.player.cooldown,Rt(this.player,ut*2,ut*2),i&&(this.player.shoot(),this.flashShootDelta=1),n&&es(this,this.player.x,this.player.y,-n*Math.cos(this.player.rotation)*Kn,-n*Math.sin(this.player.rotation)*Kn,y.choose.bind(null,Bi));for(let r of this.bullets)r.age+=t,r.age>zi?r.destroy():(r.x+=r.dx,r.y+=r.dy,Rt(r,At*2,At*2));for(let r of this.bullets)for(let l of this.asteroids)if(Ie(r,l,l.size)){this.flashScore=1,this.score++,this.score>this.highScore&&(this.flashHighScore=this.score-this.highScore,this.highScore=this.score,localStorage.setItem("highscore",this.highScore)),ee(this,l.x,l.y,10,y.choose.bind(null,Xn)),lt.SoundPop.current.play(),r.destroy(),l.breakUp(r.dx*jn,r.dy*jn);break}for(let r of this.particles)r.age+=t,r.age>kt?r.destroy():(r.x+=r.dx,r.y+=r.dy,Rt(r,$t*2,$t*2));for(let r of this.asteroids)r.x+=r.dx,r.y+=r.dy,Rt(r,r.size*2,r.size*2);for(let r of this.asteroids)if(Ie(r,this.player,r.size+ut)){ee(this,r.x,r.y,10,y.choose.bind(null,Xn)),r.destroy(),ts(this);break}for(let r of this.powerUps)r.x+=r.dx,r.y+=r.dy,Rt(r,ct*2,ct*2);for(let r of this.powerUps)if(Ie(r,this.player,ct+ut)){ee(this,r.x,r.y,10,y.choose.bind(null,Ki)),r.destroy(),this.player.powerMode+=Zi;break}Bn(this.starfield),this.asteroidSpawner.update(t),this.powerUpSpawner.update(t),!this.gamePause&&this.asteroids.length<=0&&(this.gamePause=!0,this.showPlayer=!0,lt.SoundStart.current.play(),setTimeout(()=>this.gameWait=!0,1e3))}function Ii(t){t.fillStyle="black",t.fillRect(0,0,L.width,L.height),Un(t,this.starfield),t.fillStyle="rgba(255, 255, 255, 0.2)",t.textAlign="center",t.textBaseline="middle",t.font="16px sans-serif",t.fillText(this.hint,L.width/2,L.height/2-32),this.flashScore>0?(t.fillStyle=`rgba(255, 255, 255, ${this.flashScore+.2})`,this.flashScore-=$e):t.fillStyle="rgba(255, 255, 255, 0.2)",t.font="48px sans-serif",t.fillText("= "+String(this.score).padStart(2,"0")+" =",L.width/2,L.height/2),this.flashHighScore>0?(t.fillStyle=`rgba(255, 255, 255, ${this.flashHighScore+.2})`,this.flashHighScore-=$e):t.fillStyle="rgba(255, 255, 255, 0.2)",t.font="16px sans-serif",t.fillText(String(this.highScore).padStart(2,"0"),L.width/2,L.height/2+32),t.fillStyle="rgba(255, 255, 255, 0.2)",t.font="24px sans-serif",t.textAlign="right",t.fillText(Math.ceil(this.asteroidSpawner.spawnTicks/1e3),L.width,L.height-12);for(let e of this.asteroids)t.translate(e.x,e.y),t.rotate(e.rotation),t.fillStyle="slategray",t.fillRect(-e.size,-e.size,e.size*2,e.size*2),t.setTransform(1,0,0,1,0,0),ne(t,e.x,e.y,e.size);for(let e of this.powerUps)t.translate(e.x,e.y),t.rotate(e.rotation),t.beginPath(),t.strokeStyle="violet",t.arc(0,0,ct,0,Math.PI*2),t.moveTo(-ct/2,0),t.lineTo(ct/2,0),t.moveTo(0,-ct/2),t.lineTo(0,ct/2),t.stroke(),t.setTransform(1,0,0,1,0,0),ne(t,e.x,e.y,ct);for(let e of this.bullets)t.translate(e.x,e.y),t.rotate(e.rotation),t.fillStyle=Xi,t.fillRect(-At,-At,At*4,At*2),t.setTransform(1,0,0,1,0,0),ne(t,e.x,e.y,At);for(let e of this.particles){t.translate(e.x,e.y),t.rotate(e.rotation),t.fillStyle=e.color;let n=$t*(1-e.age/kt);t.fillRect(-n,-n,n*2,n*2),t.setTransform(1,0,0,1,0,0)}if(this.showPlayer){t.translate(this.player.x,this.player.y),t.rotate(this.player.rotation),t.fillStyle="white";let e=ut;t.fillRect(-e,-e,e*2,e*2);let n=-1,i=0,r=0;this.flashShootDelta>0?(t.fillStyle=`rgb(${200*this.flashShootDelta+55*Math.sin(performance.now()/(qn*2))}, 0, 0)`,this.flashShootDelta-=$e,r=this.flashShootDelta*2,n=this.flashShootDelta):t.fillStyle="black",t.fillRect(-e-r/2+n,-(e/4)-r/2+i,e+r,e/2+r),t.setTransform(1,0,0,1,0,0)}ne(t,this.player.x,this.player.y,ut)}function Rt(t,e,n){t.x<-e&&(t.x=L.width),t.y<-n&&(t.y=L.height),t.x>L.width+e/2&&(t.x=-e),t.y>L.height+n/2&&(t.y=-n)}function Ie(t,e,n){let i=t.x-e.x,r=t.y-e.y;return i*i+r*r<=n*n}function ne(t,e,n,i){!ke||(t.translate(e,n),t.beginPath(),t.arc(0,0,i,0,Math.PI*2),t.strokeStyle="lime",t.stroke(),t.setTransform(1,0,0,1,0,0))}function Qi(t,e,n,i,r){return{scene:t,x:e,y:n,dx:i,dy:r,rotation:Math.atan2(r,i),destroy(){this.scene.powerUps.splice(this.scene.powerUps.indexOf(this),1)}}}function It(t,e,n,i,r,l){return{scene:t,x:e,y:n,dx:i,dy:r,size:l,rotation:Math.atan2(r,i),breakUp(s=0,h=0){if(this.destroy(),this.size>Ht){let o=[];o.push(It(this.scene,this.x+y.range(-H,H),this.y+y.range(-H,H),y.range(-M,M)+s,y.range(-M,M)+h,Ht)),o.push(It(this.scene,this.x+y.range(-H,H),this.y+y.range(-H,H),y.range(-M,M)+s,y.range(-M,M)+h,Ht)),o.push(It(this.scene,this.x+y.range(-H,H),this.y+y.range(-H,H),y.range(-M,M)+s,y.range(-M,M)+h,Ht)),o.push(It(this.scene,this.x+y.range(-H,H),this.y+y.range(-H,H),y.range(-M,M)+s,y.range(-M,M)+h,Ht)),this.scene.asteroids.push(...o)}},destroy(){this.scene.asteroids.splice(this.scene.asteroids.indexOf(this),1)}}}function Qn(t,e,n,i,r){return{scene:t,x:e,y:n,dx:i,dy:r,rotation:Math.atan2(r,i),age:0,destroy(){this.scene.bullets.splice(this.scene.bullets.indexOf(this),1)}}}function Vn(t,e,n,i,r,l){return typeof l=="function"&&(l=l.call(null)),{scene:t,x:e,y:n,dx:i,dy:r,rotation:Math.atan2(r,i),age:0,color:l,destroy(){this.scene.particles.splice(this.scene.particles.indexOf(this),1)}}}function ns(t){t.bullets.length=0,t.asteroids.length=0,t.particles.length=0,t.player.x=L.width/2,t.player.y=L.height/2,t.player.dx=0,t.player.dy=0,t.level++,t.gamePause=!1,t.showPlayer=!0;for(let e=0;e<Mi*t.level;++e)t.asteroidSpawner.spawn();y.next()>Yi&&t.powerUpSpawner.spawn(),lt.BackgroundMusic.current.isPlaying()||lt.BackgroundMusic.current.play({loop:!0})}function ts(t){t.gamePause=!0,t.showPlayer=!1,ee(t,t.player.x,t.player.y,100,y.choose.bind(null,Ui)),lt.SoundDead.current.play(),lt.SoundBoom.current.play(),setTimeout(()=>t.gameStart=t.gameWait=!0,1e3)}function es(t,e,n,i,r,l){if(y.next()>.3){let s=Vn(t,e+y.range(te[0],te[1]),n+y.range(te[0],te[1]),i,r,l);s.age=y.range(kt*Gi,kt*qi),t.particles.push(s)}}function ee(t,e,n,i=10,r){for(let l=0;l<i;++l)t.particles.push(Vn(t,e,n,y.range(-1,1)*Wn,y.range(-1,1)*Wn,r))}function Vi(t){switch(this.gameWait&&(this.gameStart&&(lt.BackgroundMusic.current.play(),this.score=0,this.flashScore=!0,this.level=0,this.gameStart=!1,this.player.powerMode=0,this.powerUps.length=0,this.asteroidSpawner.reset(),this.powerUpSpawner.reset()),this.gameWait=!1,ns(this)),t){case"w":case"ArrowUp":this.player.up=1;break;case"s":case"ArrowDown":this.player.down=1;break;case"a":case"ArrowLeft":this.player.left=1;break;case"d":case"ArrowRight":this.player.right=1;break;case" ":this.player.fire=1;break;case"\\":break;default:console.log(t)}}function Ji(t){switch(t){case"w":case"ArrowUp":this.player.up=0;break;case"s":case"ArrowDown":this.player.down=0;break;case"a":case"ArrowLeft":this.player.left=0;break;case"d":case"ArrowRight":this.player.right=0;break;case" ":this.player.fire=0;break;case"\\":ke=!ke;break;default:console.log(t)}}})();
//# sourceMappingURL=main.js.map
