(()=>{var Zn=Object.create,It=Object.defineProperty,Yn=Object.getPrototypeOf,Qn=Object.prototype.hasOwnProperty,Vn=Object.getOwnPropertyNames,Jn=Object.getOwnPropertyDescriptor;var tr=t=>It(t,"__esModule",{value:!0});var er=(t,e)=>()=>(t&&(e=t(t=0)),e),dt=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),nr=(t,e)=>{for(var n in e)It(t,n,{get:e[n],enumerable:!0})},rr=(t,e,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Vn(e))!Qn.call(t,i)&&i!=="default"&&It(t,i,{get:()=>e[i],enumerable:!(n=Jn(e,i))||n.enumerable});return t},ir=t=>rr(tr(It(t!=null?Zn(Yn(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var je={};nr(je,{basename:()=>Je,default:()=>Tr,delimiter:()=>Qe,dirname:()=>Ve,extname:()=>tn,isAbsolute:()=>le,join:()=>Ke,normalize:()=>ue,relative:()=>Ze,resolve:()=>Ut,sep:()=>Ye});function Xe(t,e){for(var n=0,i=t.length-1;i>=0;i--){var r=t[i];r==="."?t.splice(i,1):r===".."?(t.splice(i,1),n++):n&&(t.splice(i,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function Ut(){for(var t="",e=!1,n=arguments.length-1;n>=-1&&!e;n--){var i=n>=0?arguments[n]:"/";if(typeof i!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!i)continue;t=i+"/"+t,e=i.charAt(0)==="/"}return t=Xe(ae(t.split("/"),function(r){return!!r}),!e).join("/"),(e?"/":"")+t||"."}function ue(t){var e=le(t),n=Cr(t,-1)==="/";return t=Xe(ae(t.split("/"),function(i){return!!i}),!e).join("/"),!t&&!e&&(t="."),t&&n&&(t+="/"),(e?"/":"")+t}function le(t){return t.charAt(0)==="/"}function Ke(){var t=Array.prototype.slice.call(arguments,0);return ue(ae(t,function(e,n){if(typeof e!="string")throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))}function Ze(t,e){t=Ut(t).substr(1),e=Ut(e).substr(1);function n(p){for(var v=0;v<p.length&&p[v]==="";v++);for(var m=p.length-1;m>=0&&p[m]==="";m--);return v>m?[]:p.slice(v,m-v+1)}for(var i=n(t.split("/")),r=n(e.split("/")),l=Math.min(i.length,r.length),s=l,c=0;c<l;c++)if(i[c]!==r[c]){s=c;break}for(var a=[],c=s;c<i.length;c++)a.push("..");return a=a.concat(r.slice(s)),a.join("/")}function Ve(t){var e=oe(t),n=e[0],i=e[1];return!n&&!i?".":(i&&(i=i.substr(0,i.length-1)),n+i)}function Je(t,e){var n=oe(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n}function tn(t){return oe(t)[3]}function ae(t,e){if(t.filter)return t.filter(e);for(var n=[],i=0;i<t.length;i++)e(t[i],i,t)&&n.push(t[i]);return n}var br,oe,Ye,Qe,Tr,Cr,en=er(()=>{br=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,oe=function(t){return br.exec(t).slice(1)};Ye="/",Qe=":";Tr={extname:tn,basename:Je,dirname:Ve,sep:Ye,delimiter:Qe,relative:Ze,join:Ke,isAbsolute:le,normalize:ue,resolve:Ut};Cr="ab".substr(-1)==="b"?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}});var Ft=dt((Yi,Bt)=>{var gt=(en(),je);gt&&gt.default?Bt.exports=gt.default:gt&&(Bt.exports=gt);if(gt)for(let t in gt)Bt.exports[t]=gt[t]});var bt=dt((Qi,nn)=>{"use strict";var Lr=Ft(),at="\\\\/",rn=`[^${at}]`,ht="\\.",Or="\\+",Hr="\\?",Gt="\\/",$r="(?=.)",sn="[^/]",he=`(?:${Gt}|$)`,on=`(?:^|${Gt})`,ce=`${ht}{1,2}${he}`,kr=`(?!${ht})`,Ir=`(?!${on}${ce})`,Pr=`(?!${ht}{0,1}${he})`,Mr=`(?!${ce})`,Dr=`[^.${Gt}]`,Nr=`${sn}*?`,an={DOT_LITERAL:ht,PLUS_LITERAL:Or,QMARK_LITERAL:Hr,SLASH_LITERAL:Gt,ONE_CHAR:$r,QMARK:sn,END_ANCHOR:he,DOTS_SLASH:ce,NO_DOT:kr,NO_DOTS:Ir,NO_DOT_SLASH:Pr,NO_DOTS_SLASH:Mr,QMARK_NO_DOT:Dr,STAR:Nr,START_ANCHOR:on},zr={...an,SLASH_LITERAL:`[${at}]`,QMARK:rn,STAR:`${rn}*?`,DOTS_SLASH:`${ht}{1,2}(?:[${at}]|$)`,NO_DOT:`(?!${ht})`,NO_DOTS:`(?!(?:^|[${at}])${ht}{1,2}(?:[${at}]|$))`,NO_DOT_SLASH:`(?!${ht}{0,1}(?:[${at}]|$))`,NO_DOTS_SLASH:`(?!${ht}{1,2}(?:[${at}]|$))`,QMARK_NO_DOT:`[^.${at}]`,START_ANCHOR:`(?:^|[${at}])`,END_ANCHOR:`(?:[${at}]|$)`},Ur={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};nn.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:Ur,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:Lr.sep,extglobChars(t){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${t.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(t){return t===!0?zr:an}}});var qt=dt(V=>{"use strict";var Br=Ft(),Fr=!1,{REGEX_BACKSLASH:Gr,REGEX_REMOVE_BACKSLASH:qr,REGEX_SPECIAL_CHARS:Wr,REGEX_SPECIAL_CHARS_GLOBAL:jr}=bt();V.isObject=t=>t!==null&&typeof t=="object"&&!Array.isArray(t);V.hasRegexChars=t=>Wr.test(t);V.isRegexChar=t=>t.length===1&&V.hasRegexChars(t);V.escapeRegex=t=>t.replace(jr,"\\$1");V.toPosixSlashes=t=>t.replace(Gr,"/");V.removeBackslashes=t=>t.replace(qr,e=>e==="\\"?"":e);V.supportsLookbehinds=()=>{let t=process.version.slice(1).split(".").map(Number);return t.length===3&&t[0]>=9||t[0]===8&&t[1]>=10};V.isWindows=t=>t&&typeof t.windows=="boolean"?t.windows:Fr===!0||Br.sep==="\\";V.escapeLast=(t,e,n)=>{let i=t.lastIndexOf(e,n);return i===-1?t:t[i-1]==="\\"?V.escapeLast(t,e,i-1):`${t.slice(0,i)}\\${t.slice(i)}`};V.removePrefix=(t,e={})=>{let n=t;return n.startsWith("./")&&(n=n.slice(2),e.prefix="./"),n};V.wrapOutput=(t,e={},n={})=>{let i=n.contains?"":"^",r=n.contains?"":"$",l=`${i}(?:${t})${r}`;return e.negated===!0&&(l=`(?:^(?!${l}).*$)`),l}});var vn=dt((Ji,ln)=>{"use strict";var un=qt(),{CHAR_ASTERISK:fe,CHAR_AT:Xr,CHAR_BACKWARD_SLASH:Ct,CHAR_COMMA:Kr,CHAR_DOT:pe,CHAR_EXCLAMATION_MARK:ge,CHAR_FORWARD_SLASH:hn,CHAR_LEFT_CURLY_BRACE:ve,CHAR_LEFT_PARENTHESES:de,CHAR_LEFT_SQUARE_BRACKET:Zr,CHAR_PLUS:Yr,CHAR_QUESTION_MARK:cn,CHAR_RIGHT_CURLY_BRACE:Qr,CHAR_RIGHT_PARENTHESES:fn,CHAR_RIGHT_SQUARE_BRACKET:Vr}=bt(),pn=t=>t===hn||t===Ct,gn=t=>{t.isPrefix!==!0&&(t.depth=t.isGlobstar?Infinity:1)},Jr=(t,e)=>{let n=e||{},i=t.length-1,r=n.parts===!0||n.scanToEnd===!0,l=[],s=[],c=[],a=t,p=-1,v=0,m=0,b=!1,C=!1,E=!1,x=!1,D=!1,X=!1,G=!1,T=!1,F=!1,$=!1,q=0,P,d,S={value:"",depth:0,isGlob:!1},U=()=>p>=i,h=()=>a.charCodeAt(p+1),L=()=>(P=d,a.charCodeAt(++p));for(;p<i;){d=L();let W;if(d===Ct){G=S.backslashes=!0,d=L(),d===ve&&(X=!0);continue}if(X===!0||d===ve){for(q++;U()!==!0&&(d=L());){if(d===Ct){G=S.backslashes=!0,L();continue}if(d===ve){q++;continue}if(X!==!0&&d===pe&&(d=L())===pe){if(b=S.isBrace=!0,E=S.isGlob=!0,$=!0,r===!0)continue;break}if(X!==!0&&d===Kr){if(b=S.isBrace=!0,E=S.isGlob=!0,$=!0,r===!0)continue;break}if(d===Qr&&(q--,q===0)){X=!1,b=S.isBrace=!0,$=!0;break}}if(r===!0)continue;break}if(d===hn){if(l.push(p),s.push(S),S={value:"",depth:0,isGlob:!1},$===!0)continue;if(P===pe&&p===v+1){v+=2;continue}m=p+1;continue}if(n.noext!==!0&&(d===Yr||d===Xr||d===fe||d===cn||d===ge)===!0&&h()===de){if(E=S.isGlob=!0,x=S.isExtglob=!0,$=!0,d===ge&&p===v&&(F=!0),r===!0){for(;U()!==!0&&(d=L());){if(d===Ct){G=S.backslashes=!0,d=L();continue}if(d===fn){E=S.isGlob=!0,$=!0;break}}continue}break}if(d===fe){if(P===fe&&(D=S.isGlobstar=!0),E=S.isGlob=!0,$=!0,r===!0)continue;break}if(d===cn){if(E=S.isGlob=!0,$=!0,r===!0)continue;break}if(d===Zr){for(;U()!==!0&&(W=L());){if(W===Ct){G=S.backslashes=!0,L();continue}if(W===Vr){C=S.isBracket=!0,E=S.isGlob=!0,$=!0;break}}if(r===!0)continue;break}if(n.nonegate!==!0&&d===ge&&p===v){T=S.negated=!0,v++;continue}if(n.noparen!==!0&&d===de){if(E=S.isGlob=!0,r===!0){for(;U()!==!0&&(d=L());){if(d===de){G=S.backslashes=!0,d=L();continue}if(d===fn){$=!0;break}}continue}break}if(E===!0){if($=!0,r===!0)continue;break}}n.noext===!0&&(x=!1,E=!1);let R=a,J="",u="";v>0&&(J=a.slice(0,v),a=a.slice(v),m-=v),R&&E===!0&&m>0?(R=a.slice(0,m),u=a.slice(m)):E===!0?(R="",u=a):R=a,R&&R!==""&&R!=="/"&&R!==a&&pn(R.charCodeAt(R.length-1))&&(R=R.slice(0,-1)),n.unescape===!0&&(u&&(u=un.removeBackslashes(u)),R&&G===!0&&(R=un.removeBackslashes(R)));let o={prefix:J,input:t,start:v,base:R,glob:u,isBrace:b,isBracket:C,isGlob:E,isExtglob:x,isGlobstar:D,negated:T,negatedExtglob:F};if(n.tokens===!0&&(o.maxDepth=0,pn(d)||s.push(S),o.tokens=s),n.parts===!0||n.tokens===!0){let W;for(let w=0;w<l.length;w++){let Q=W?W+1:v,j=l[w],K=t.slice(Q,j);n.tokens&&(w===0&&v!==0?(s[w].isPrefix=!0,s[w].value=J):s[w].value=K,gn(s[w]),o.maxDepth+=s[w].depth),(w!==0||K!=="")&&c.push(K),W=j}if(W&&W+1<t.length){let w=t.slice(W+1);c.push(w),n.tokens&&(s[s.length-1].value=w,gn(s[s.length-1]),o.maxDepth+=s[s.length-1].depth)}o.slashes=l,o.parts=c}return o};ln.exports=Jr});var _n=dt((ts,dn)=>{"use strict";var Wt=bt(),tt=qt(),{MAX_LENGTH:jt,POSIX_REGEX_SOURCE:ti,REGEX_NON_SPECIAL_CHARS:ei,REGEX_SPECIAL_CHARS_BACKREF:ni,REPLACEMENTS:yn}=Wt,ri=(t,e)=>{if(typeof e.expandRange=="function")return e.expandRange(...t,e);t.sort();let n=`[${t.join("-")}]`;try{new RegExp(n)}catch(i){return t.map(r=>tt.escapeRegex(r)).join("..")}return n},At=(t,e)=>`Missing ${t}: "${e}" - use "\\\\${e}" to match literal characters`,mn=(t,e)=>{if(typeof t!="string")throw new TypeError("Expected a string");t=yn[t]||t;let n={...e},i=typeof n.maxLength=="number"?Math.min(jt,n.maxLength):jt,r=t.length;if(r>i)throw new SyntaxError(`Input length: ${r}, exceeds maximum allowed length: ${i}`);let l={type:"bos",value:"",output:n.prepend||""},s=[l],c=n.capture?"":"?:",a=tt.isWindows(e),p=Wt.globChars(a),v=Wt.extglobChars(p),{DOT_LITERAL:m,PLUS_LITERAL:b,SLASH_LITERAL:C,ONE_CHAR:E,DOTS_SLASH:x,NO_DOT:D,NO_DOT_SLASH:X,NO_DOTS_SLASH:G,QMARK:T,QMARK_NO_DOT:F,STAR:$,START_ANCHOR:q}=p,P=g=>`(${c}(?:(?!${q}${g.dot?x:m}).)*?)`,d=n.dot?"":D,S=n.dot?T:F,U=n.bash===!0?P(n):$;n.capture&&(U=`(${U})`),typeof n.noext=="boolean"&&(n.noextglob=n.noext);let h={input:t,index:-1,start:0,dot:n.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:s};t=tt.removePrefix(t,h),r=t.length;let L=[],R=[],J=[],u=l,o,W=()=>h.index===r-1,w=h.peek=(g=1)=>t[h.index+g],Q=h.advance=()=>t[++h.index]||"",j=()=>t.slice(h.index+1),K=(g="",k=0)=>{h.consumed+=g,h.index+=k},rt=g=>{h.output+=g.output!=null?g.output:g.value,K(g.value)},St=()=>{let g=1;for(;w()==="!"&&(w(2)!=="("||w(3)==="?");)Q(),h.start++,g++;return g%2==0?!1:(h.negated=!0,h.start++,!0)},pt=g=>{h[g]++,J.push(g)},it=g=>{h[g]--,J.pop()},_=g=>{if(u.type==="globstar"){let k=h.braces>0&&(g.type==="comma"||g.type==="brace"),f=g.extglob===!0||L.length&&(g.type==="pipe"||g.type==="paren");g.type!=="slash"&&g.type!=="paren"&&!k&&!f&&(h.output=h.output.slice(0,-u.output.length),u.type="star",u.value="*",u.output=U,h.output+=u.output)}if(L.length&&g.type!=="paren"&&(L[L.length-1].inner+=g.value),(g.value||g.output)&&rt(g),u&&u.type==="text"&&g.type==="text"){u.value+=g.value,u.output=(u.output||"")+g.value;return}g.prev=u,s.push(g),u=g},vt=(g,k)=>{let f={...v[k],conditions:1,inner:""};f.prev=u,f.parens=h.parens,f.output=h.output;let A=(n.capture?"(":"")+f.open;pt("parens"),_({type:g,value:k,output:h.output?"":E}),_({type:"paren",extglob:!0,value:Q(),output:A}),L.push(f)},$t=g=>{let k=g.close+(n.capture?")":""),f;if(g.type==="negate"){let A=U;g.inner&&g.inner.length>1&&g.inner.includes("/")&&(A=P(n)),(A!==U||W()||/^\)+$/.test(j()))&&(k=g.close=`)$))${A}`),g.inner.includes("*")&&(f=j())&&/^\.[^\\/.]+$/.test(f)&&(k=g.close=`)${f})${A})`),g.prev.type==="bos"&&(h.negatedExtglob=!0)}_({type:"paren",extglob:!0,value:o,output:k}),it("parens")};if(n.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(t)){let g=!1,k=t.replace(ni,(f,A,N,Y,B,Vt)=>Y==="\\"?(g=!0,f):Y==="?"?A?A+Y+(B?T.repeat(B.length):""):Vt===0?S+(B?T.repeat(B.length):""):T.repeat(N.length):Y==="."?m.repeat(N.length):Y==="*"?A?A+Y+(B?U:""):U:A?f:`\\${f}`);return g===!0&&(n.unescape===!0?k=k.replace(/\\/g,""):k=k.replace(/\\+/g,f=>f.length%2==0?"\\\\":f?"\\":"")),k===t&&n.contains===!0?(h.output=t,h):(h.output=tt.wrapOutput(k,h,e),h)}for(;!W();){if(o=Q(),o==="\0")continue;if(o==="\\"){let f=w();if(f==="/"&&n.bash!==!0||f==="."||f===";")continue;if(!f){o+="\\",_({type:"text",value:o});continue}let A=/^\\+/.exec(j()),N=0;if(A&&A[0].length>2&&(N=A[0].length,h.index+=N,N%2!=0&&(o+="\\")),n.unescape===!0?o=Q():o+=Q(),h.brackets===0){_({type:"text",value:o});continue}}if(h.brackets>0&&(o!=="]"||u.value==="["||u.value==="[^")){if(n.posix!==!1&&o===":"){let f=u.value.slice(1);if(f.includes("[")&&(u.posix=!0,f.includes(":"))){let A=u.value.lastIndexOf("["),N=u.value.slice(0,A),Y=u.value.slice(A+2),B=ti[Y];if(B){u.value=N+B,h.backtrack=!0,Q(),!l.output&&s.indexOf(u)===1&&(l.output=E);continue}}}(o==="["&&w()!==":"||o==="-"&&w()==="]")&&(o=`\\${o}`),o==="]"&&(u.value==="["||u.value==="[^")&&(o=`\\${o}`),n.posix===!0&&o==="!"&&u.value==="["&&(o="^"),u.value+=o,rt({value:o});continue}if(h.quotes===1&&o!=='"'){o=tt.escapeRegex(o),u.value+=o,rt({value:o});continue}if(o==='"'){h.quotes=h.quotes===1?0:1,n.keepQuotes===!0&&_({type:"text",value:o});continue}if(o==="("){pt("parens"),_({type:"paren",value:o});continue}if(o===")"){if(h.parens===0&&n.strictBrackets===!0)throw new SyntaxError(At("opening","("));let f=L[L.length-1];if(f&&h.parens===f.parens+1){$t(L.pop());continue}_({type:"paren",value:o,output:h.parens?")":"\\)"}),it("parens");continue}if(o==="["){if(n.nobracket===!0||!j().includes("]")){if(n.nobracket!==!0&&n.strictBrackets===!0)throw new SyntaxError(At("closing","]"));o=`\\${o}`}else pt("brackets");_({type:"bracket",value:o});continue}if(o==="]"){if(n.nobracket===!0||u&&u.type==="bracket"&&u.value.length===1){_({type:"text",value:o,output:`\\${o}`});continue}if(h.brackets===0){if(n.strictBrackets===!0)throw new SyntaxError(At("opening","["));_({type:"text",value:o,output:`\\${o}`});continue}it("brackets");let f=u.value.slice(1);if(u.posix!==!0&&f[0]==="^"&&!f.includes("/")&&(o=`/${o}`),u.value+=o,rt({value:o}),n.literalBrackets===!1||tt.hasRegexChars(f))continue;let A=tt.escapeRegex(u.value);if(h.output=h.output.slice(0,-u.value.length),n.literalBrackets===!0){h.output+=A,u.value=A;continue}u.value=`(${c}${A}|${u.value})`,h.output+=u.value;continue}if(o==="{"&&n.nobrace!==!0){pt("braces");let f={type:"brace",value:o,output:"(",outputIndex:h.output.length,tokensIndex:h.tokens.length};R.push(f),_(f);continue}if(o==="}"){let f=R[R.length-1];if(n.nobrace===!0||!f){_({type:"text",value:o,output:o});continue}let A=")";if(f.dots===!0){let N=s.slice(),Y=[];for(let B=N.length-1;B>=0&&(s.pop(),N[B].type!=="brace");B--)N[B].type!=="dots"&&Y.unshift(N[B].value);A=ri(Y,n),h.backtrack=!0}if(f.comma!==!0&&f.dots!==!0){let N=h.output.slice(0,f.outputIndex),Y=h.tokens.slice(f.tokensIndex);f.value=f.output="\\{",o=A="\\}",h.output=N;for(let B of Y)h.output+=B.output||B.value}_({type:"brace",value:o,output:A}),it("braces"),R.pop();continue}if(o==="|"){L.length>0&&L[L.length-1].conditions++,_({type:"text",value:o});continue}if(o===","){let f=o,A=R[R.length-1];A&&J[J.length-1]==="braces"&&(A.comma=!0,f="|"),_({type:"comma",value:o,output:f});continue}if(o==="/"){if(u.type==="dot"&&h.index===h.start+1){h.start=h.index+1,h.consumed="",h.output="",s.pop(),u=l;continue}_({type:"slash",value:o,output:C});continue}if(o==="."){if(h.braces>0&&u.type==="dot"){u.value==="."&&(u.output=m);let f=R[R.length-1];u.type="dots",u.output+=o,u.value+=o,f.dots=!0;continue}if(h.braces+h.parens===0&&u.type!=="bos"&&u.type!=="slash"){_({type:"text",value:o,output:m});continue}_({type:"dot",value:o,output:m});continue}if(o==="?"){if(!(u&&u.value==="(")&&n.noextglob!==!0&&w()==="("&&w(2)!=="?"){vt("qmark",o);continue}if(u&&u.type==="paren"){let A=w(),N=o;if(A==="<"&&!tt.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(u.value==="("&&!/[!=<:]/.test(A)||A==="<"&&!/<([!=]|\w+>)/.test(j()))&&(N=`\\${o}`),_({type:"text",value:o,output:N});continue}if(n.dot!==!0&&(u.type==="slash"||u.type==="bos")){_({type:"qmark",value:o,output:F});continue}_({type:"qmark",value:o,output:T});continue}if(o==="!"){if(n.noextglob!==!0&&w()==="("&&(w(2)!=="?"||!/[!=<:]/.test(w(3)))){vt("negate",o);continue}if(n.nonegate!==!0&&h.index===0){St();continue}}if(o==="+"){if(n.noextglob!==!0&&w()==="("&&w(2)!=="?"){vt("plus",o);continue}if(u&&u.value==="("||n.regex===!1){_({type:"plus",value:o,output:b});continue}if(u&&(u.type==="bracket"||u.type==="paren"||u.type==="brace")||h.parens>0){_({type:"plus",value:o});continue}_({type:"plus",value:b});continue}if(o==="@"){if(n.noextglob!==!0&&w()==="("&&w(2)!=="?"){_({type:"at",extglob:!0,value:o,output:""});continue}_({type:"text",value:o});continue}if(o!=="*"){(o==="$"||o==="^")&&(o=`\\${o}`);let f=ei.exec(j());f&&(o+=f[0],h.index+=f[0].length),_({type:"text",value:o});continue}if(u&&(u.type==="globstar"||u.star===!0)){u.type="star",u.star=!0,u.value+=o,u.output=U,h.backtrack=!0,h.globstar=!0,K(o);continue}let g=j();if(n.noextglob!==!0&&/^\([^?]/.test(g)){vt("star",o);continue}if(u.type==="star"){if(n.noglobstar===!0){K(o);continue}let f=u.prev,A=f.prev,N=f.type==="slash"||f.type==="bos",Y=A&&(A.type==="star"||A.type==="globstar");if(n.bash===!0&&(!N||g[0]&&g[0]!=="/")){_({type:"star",value:o,output:""});continue}let B=h.braces>0&&(f.type==="comma"||f.type==="brace"),Vt=L.length&&(f.type==="pipe"||f.type==="paren");if(!N&&f.type!=="paren"&&!B&&!Vt){_({type:"star",value:o,output:""});continue}for(;g.slice(0,3)==="/**";){let kt=t[h.index+4];if(kt&&kt!=="/")break;g=g.slice(3),K("/**",3)}if(f.type==="bos"&&W()){u.type="globstar",u.value+=o,u.output=P(n),h.output=u.output,h.globstar=!0,K(o);continue}if(f.type==="slash"&&f.prev.type!=="bos"&&!Y&&W()){h.output=h.output.slice(0,-(f.output+u.output).length),f.output=`(?:${f.output}`,u.type="globstar",u.output=P(n)+(n.strictSlashes?")":"|$)"),u.value+=o,h.globstar=!0,h.output+=f.output+u.output,K(o);continue}if(f.type==="slash"&&f.prev.type!=="bos"&&g[0]==="/"){let kt=g[1]!==void 0?"|$":"";h.output=h.output.slice(0,-(f.output+u.output).length),f.output=`(?:${f.output}`,u.type="globstar",u.output=`${P(n)}${C}|${C}${kt})`,u.value+=o,h.output+=f.output+u.output,h.globstar=!0,K(o+Q()),_({type:"slash",value:"/",output:""});continue}if(f.type==="bos"&&g[0]==="/"){u.type="globstar",u.value+=o,u.output=`(?:^|${C}|${P(n)}${C})`,h.output=u.output,h.globstar=!0,K(o+Q()),_({type:"slash",value:"/",output:""});continue}h.output=h.output.slice(0,-u.output.length),u.type="globstar",u.output=P(n),u.value+=o,h.output+=u.output,h.globstar=!0,K(o);continue}let k={type:"star",value:o,output:U};if(n.bash===!0){k.output=".*?",(u.type==="bos"||u.type==="slash")&&(k.output=d+k.output),_(k);continue}if(u&&(u.type==="bracket"||u.type==="paren")&&n.regex===!0){k.output=o,_(k);continue}(h.index===h.start||u.type==="slash"||u.type==="dot")&&(u.type==="dot"?(h.output+=X,u.output+=X):n.dot===!0?(h.output+=G,u.output+=G):(h.output+=d,u.output+=d),w()!=="*"&&(h.output+=E,u.output+=E)),_(k)}for(;h.brackets>0;){if(n.strictBrackets===!0)throw new SyntaxError(At("closing","]"));h.output=tt.escapeLast(h.output,"["),it("brackets")}for(;h.parens>0;){if(n.strictBrackets===!0)throw new SyntaxError(At("closing",")"));h.output=tt.escapeLast(h.output,"("),it("parens")}for(;h.braces>0;){if(n.strictBrackets===!0)throw new SyntaxError(At("closing","}"));h.output=tt.escapeLast(h.output,"{"),it("braces")}if(n.strictSlashes!==!0&&(u.type==="star"||u.type==="bracket")&&_({type:"maybe_slash",value:"",output:`${C}?`}),h.backtrack===!0){h.output="";for(let g of h.tokens)h.output+=g.output!=null?g.output:g.value,g.suffix&&(h.output+=g.suffix)}return h};mn.fastpaths=(t,e)=>{let n={...e},i=typeof n.maxLength=="number"?Math.min(jt,n.maxLength):jt,r=t.length;if(r>i)throw new SyntaxError(`Input length: ${r}, exceeds maximum allowed length: ${i}`);t=yn[t]||t;let l=tt.isWindows(e),{DOT_LITERAL:s,SLASH_LITERAL:c,ONE_CHAR:a,DOTS_SLASH:p,NO_DOT:v,NO_DOTS:m,NO_DOTS_SLASH:b,STAR:C,START_ANCHOR:E}=Wt.globChars(l),x=n.dot?m:v,D=n.dot?b:v,X=n.capture?"":"?:",G={negated:!1,prefix:""},T=n.bash===!0?".*?":C;n.capture&&(T=`(${T})`);let F=d=>d.noglobstar===!0?T:`(${X}(?:(?!${E}${d.dot?p:s}).)*?)`,$=d=>{switch(d){case"*":return`${x}${a}${T}`;case".*":return`${s}${a}${T}`;case"*.*":return`${x}${T}${s}${a}${T}`;case"*/*":return`${x}${T}${c}${a}${D}${T}`;case"**":return x+F(n);case"**/*":return`(?:${x}${F(n)}${c})?${D}${a}${T}`;case"**/*.*":return`(?:${x}${F(n)}${c})?${D}${T}${s}${a}${T}`;case"**/.*":return`(?:${x}${F(n)}${c})?${s}${a}${T}`;default:{let S=/^(.*?)\.(\w+)$/.exec(d);if(!S)return;let U=$(S[1]);return U?U+s+S[2]:void 0}}},q=tt.removePrefix(t,G),P=$(q);return P&&n.strictSlashes!==!0&&(P+=`${c}?`),P};dn.exports=mn});var wn=dt((es,An)=>{"use strict";var ii=Ft(),si=vn(),ye=_n(),me=qt(),oi=bt(),ai=t=>t&&typeof t=="object"&&!Array.isArray(t),z=(t,e,n=!1)=>{if(Array.isArray(t)){let v=t.map(b=>z(b,e,n));return b=>{for(let C of v){let E=C(b);if(E)return E}return!1}}let i=ai(t)&&t.tokens&&t.input;if(t===""||typeof t!="string"&&!i)throw new TypeError("Expected pattern to be a non-empty string");let r=e||{},l=me.isWindows(e),s=i?z.compileRe(t,e):z.makeRe(t,e,!1,!0),c=s.state;delete s.state;let a=()=>!1;if(r.ignore){let v={...e,ignore:null,onMatch:null,onResult:null};a=z(r.ignore,v,n)}let p=(v,m=!1)=>{let{isMatch:b,match:C,output:E}=z.test(v,s,e,{glob:t,posix:l}),x={glob:t,state:c,regex:s,posix:l,input:v,output:E,match:C,isMatch:b};return typeof r.onResult=="function"&&r.onResult(x),b===!1?(x.isMatch=!1,m?x:!1):a(v)?(typeof r.onIgnore=="function"&&r.onIgnore(x),x.isMatch=!1,m?x:!1):(typeof r.onMatch=="function"&&r.onMatch(x),m?x:!0)};return n&&(p.state=c),p};z.test=(t,e,n,{glob:i,posix:r}={})=>{if(typeof t!="string")throw new TypeError("Expected input to be a string");if(t==="")return{isMatch:!1,output:""};let l=n||{},s=l.format||(r?me.toPosixSlashes:null),c=t===i,a=c&&s?s(t):t;return c===!1&&(a=s?s(t):t,c=a===i),(c===!1||l.capture===!0)&&(l.matchBase===!0||l.basename===!0?c=z.matchBase(t,e,n,r):c=e.exec(a)),{isMatch:Boolean(c),match:c,output:a}};z.matchBase=(t,e,n,i=me.isWindows(n))=>(e instanceof RegExp?e:z.makeRe(e,n)).test(ii.basename(t));z.isMatch=(t,e,n)=>z(e,n)(t);z.parse=(t,e)=>Array.isArray(t)?t.map(n=>z.parse(n,e)):ye(t,{...e,fastpaths:!1});z.scan=(t,e)=>si(t,e);z.compileRe=(t,e,n=!1,i=!1)=>{if(n===!0)return t.output;let r=e||{},l=r.contains?"":"^",s=r.contains?"":"$",c=`${l}(?:${t.output})${s}`;t&&t.negated===!0&&(c=`^(?!${c}).*$`);let a=z.toRegex(c,e);return i===!0&&(a.state=t),a};z.makeRe=(t,e={},n=!1,i=!1)=>{if(!t||typeof t!="string")throw new TypeError("Expected a non-empty string");let r={negated:!1,fastpaths:!0};return e.fastpaths!==!1&&(t[0]==="."||t[0]==="*")&&(r.output=ye.fastpaths(t,e)),r.output||(r=ye(t,e)),z.compileRe(r,e,n,i)};z.toRegex=(t,e)=>{try{let n=e||{};return new RegExp(t,n.flags||(n.nocase?"i":""))}catch(n){if(e&&e.debug===!0)throw n;return/$^/}};z.constants=oi;An.exports=z});var Sn=dt((ns,En)=>{"use strict";En.exports=wn()});var sr=`<div class="container">
  <label class="hidden" id="title">display-port</label>
  <label class="hidden" id="fps">00</label>
  <label class="hidden" id="dimension">0x0</label>
  <div class="content">
    <canvas> Oh no! Your browser does not support canvas. </canvas>
    <slot id="inner"></slot>
  </div>
  <slot name="frame"></slot>
</div>
`,or=`:host {
  display: inline-block;
  color: #555555;
}

.container {
  display: flex;
  position: relative;
  width: 100%;
  height: 100%;
}

.content {
  position: relative;
  margin: auto;
}

.content > *:not(canvas) {
  width: 100%;
  height: 100%;
}

canvas {
  background: #000000;
  image-rendering: pixelated;
}

label {
  position: absolute;
  font-family: monospace;
  color: currentColor;
}

#inner {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: 0;
  left: 0;
  pointer-events: none;
}

#title {
  left: 0.5rem;
  top: 0.5rem;
}

#fps {
  right: 0.5rem;
  top: 0.5rem;
}

#dimension {
  left: 0.5rem;
  bottom: 0.5rem;
}

.hidden {
  display: none;
}

:host([debug]) .container {
  outline: 6px dashed rgba(0, 0, 0, 0.1);
  outline-offset: -4px;
  background-color: rgba(0, 0, 0, 0.1);
}

:host([mode='noscale']) canvas {
  margin: 0;
  top: 0;
  left: 0;
}

:host([mode='stretch']) canvas,
:host([mode='scale']) canvas {
  width: 100%;
  height: 100%;
}

:host([mode='fit']),
:host([mode='scale']),
:host([mode='center']),
:host([mode='stretch']),
:host([mode='fill']) {
  width: 100%;
  height: 100%;
}

:host([full]) {
  width: 100vw !important;
  height: 100vh !important;
}

:host([disabled]) {
  display: none;
}

slot {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  pointer-events: none;
}

::slotted(*) {
  pointer-events: auto;
}
`,be="noscale",Jt="fit",Ce="scale",Te="fill",Le="stretch",ar=300,lr=150,ur=Jt,hr=200,Oe=class extends HTMLElement{static get[Symbol.for("templateNode")](){let e=document.createElement("template");return e.innerHTML=sr,Object.defineProperty(this,Symbol.for("templateNode"),{value:e}),e}static get[Symbol.for("styleNode")](){let e=document.createElement("style");return e.innerHTML=or,Object.defineProperty(this,Symbol.for("styleNode"),{value:e}),e}static define(e=window.customElements){e.define("display-port",this)}static get observedAttributes(){return["debug","disabled","width","height","onframe","id","class"]}get mode(){return this.getAttribute("mode")}set mode(e){this.setAttribute("mode",e)}get debug(){return this._debug}set debug(e){this.toggleAttribute("debug",e)}get disabled(){return this._disabled}set disabled(e){this.toggleAttribute("disabled",e)}get width(){return this._width}set width(e){this.setAttribute("width",String(e))}get height(){return this._height}set height(e){this.setAttribute("height",String(e))}get onframe(){return this._onframe}set onframe(e){this._onframe&&this.removeEventListener("frame",this._onframe),this._onframe=e,this._onframe&&this.addEventListener("frame",e)}constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._canvasElement=this.shadowRoot.querySelector("canvas"),this._contentElement=this.shadowRoot.querySelector(".content"),this._innerElement=this.shadowRoot.querySelector("#inner"),this._titleElement=this.shadowRoot.querySelector("#title"),this._fpsElement=this.shadowRoot.querySelector("#fps"),this._dimensionElement=this.shadowRoot.querySelector("#dimension"),this._debug=!1,this._disabled=!1,this._width=ar,this._height=lr,this._onframe=void 0,this._animationRequestHandle=0,this._prevAnimationFrameTime=0,this._resizeTimeoutHandle=0,this._resizeCanvasWidth=0,this._resizeCanvasHeight=0,this.update=this.update.bind(this),this.onDelayCanvasResize=this.onDelayCanvasResize.bind(this)}get canvas(){return this._canvasElement}connectedCallback(){mt(this,"mode"),mt(this,"debug"),mt(this,"disabled"),mt(this,"width"),mt(this,"height"),mt(this,"onframe"),this.hasAttribute("mode")||this.setAttribute("mode",ur),this.hasAttribute("tabindex")||this.setAttribute("tabindex","0"),this.updateCanvasSize(!0),this.resume()}disconnectedCallback(){this.pause()}attributeChangedCallback(e,n,i){switch(e){case"debug":this._debug=i!==null;break;case"disabled":this._disabled=i!==null;break;case"width":this._width=Number(i);break;case"height":this._height=Number(i);break;case"onframe":this.onframe=new Function("event","with(document){with(this){"+i+"}}").bind(this);break}switch(e){case"disabled":i?(this.update(0),this.pause()):this.resume();break;case"id":case"class":this._titleElement.innerHTML=`display-port${this.className?"."+this.className:""}${this.hasAttribute("id")?"#"+this.getAttribute("id"):""}`;break;case"debug":this._titleElement.classList.toggle("hidden",i),this._fpsElement.classList.toggle("hidden",i),this._dimensionElement.classList.toggle("hidden",i);break}}getContext(e="2d",n=void 0){return this._canvasElement.getContext(e,n)}pause(){cancelAnimationFrame(this._animationRequestHandle)}resume(){this._animationRequestHandle=requestAnimationFrame(this.update)}update(e){this._animationRequestHandle=requestAnimationFrame(this.update),this.updateCanvasSize(!1);let n=e-this._prevAnimationFrameTime;if(this._prevAnimationFrameTime=e,this._debug){let i=n<=0?"--":String(Math.round(1e3/n)).padStart(2,"0");if(this._fpsElement.textContent!==i&&(this._fpsElement.textContent=i),this.mode===be){let l=`${this._width}x${this._height}`;this._dimensionElement.textContent!==l&&(this._dimensionElement.textContent=l)}else{let l=`${this._width}x${this._height}|${this.shadowRoot.host.clientWidth}x${this.shadowRoot.host.clientHeight}`;this._dimensionElement.textContent!==l&&(this._dimensionElement.textContent=l)}}this.dispatchEvent(new CustomEvent("frame",{detail:{now:e,prevTime:this._prevAnimationFrameTime,deltaTime:n,canvas:this._canvasElement},bubbles:!1,composed:!0}))}onDelayCanvasResize(){this._resizeTimeoutHandle=0,this.updateCanvasSize(!0)}delayCanvasResize(e,n){(e!==this._resizeCanvasWidth||n!==this._resizeCanvasHeight)&&(this._resizeCanvasWidth=e,this._resizeCanvasHeight=n,this._resizeTimeoutHandle&&clearTimeout(this._resizeTimeoutHandle),this._resizeTimeoutHandle=setTimeout(this.onDelayCanvasResize,hr))}updateCanvasSize(e=!0){let n=this.shadowRoot.host.getBoundingClientRect(),i=n.width,r=n.height,l=this._canvasElement,s=this._width,c=this._height,a=this.mode;if(a===Le||a===Te)s=i,c=r;else if(a!==be&&(i<s||r<c||a===Jt||a==Ce)){let v=i/s,m=r/c;v<m?(s=i,c=c*v):(s=s*m,c=r)}if(s=Math.floor(s),c=Math.floor(c),typeof e=="undefined"&&(e=l.clientWidth!==s||l.clientHeight!==c),!e){this.delayCanvasResize(s,c);return}let p=Math.min(s/this._width,c/this._height)*.5;if(this._innerElement.style.fontSize=`font-size: ${p}em`,e){a===Ce?(l.width=this._width,l.height=this._height):a!==Le&&(l.width=s,l.height=c);let v=this._contentElement.style;v.width=`${s}px`,v.height=`${c}px`,(a===Jt||a===Te)&&(this._width=s,this._height=c),this.dispatchEvent(new CustomEvent("resize",{detail:{width:s,height:c},bubbles:!1,composed:!0}))}}};Oe.define();function mt(t,e){if(Object.prototype.hasOwnProperty.call(t,e)){let n=t[e];delete t[e],t[e]=n}}var He={},cr=function(t,e,n,i,r){var l=new Worker(He[e]||(He[e]=URL.createObjectURL(new Blob([t],{type:"text/javascript"}))));return l.onerror=function(s){return r(s.error,null)},l.onmessage=function(s){return r(null,s.data)},l.postMessage(n,i),l},Z=Uint8Array,st=Uint16Array,Rt=Uint32Array,te=new Z([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ee=new Z([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),$e=new Z([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ke=function(t,e){for(var n=new st(31),i=0;i<31;++i)n[i]=e+=1<<t[i-1];for(var r=new Rt(n[30]),i=1;i<30;++i)for(var l=n[i];l<n[i+1];++l)r[l]=l-n[i]<<5|i;return[n,r]},Ie=ke(te,2),ne=Ie[0],fr=Ie[1];ne[28]=258,fr[258]=28;var Pe=ke(ee,0),Me=Pe[0],Ki=Pe[1],Pt=new st(32768);for(var I=0;I<32768;++I)ut=(I&43690)>>>1|(I&21845)<<1,ut=(ut&52428)>>>2|(ut&13107)<<2,ut=(ut&61680)>>>4|(ut&3855)<<4,Pt[I]=((ut&65280)>>>8|(ut&255)<<8)>>>1;var ut,_t=function(t,e,n){for(var i=t.length,r=0,l=new st(e);r<i;++r)++l[t[r]-1];var s=new st(e);for(r=0;r<e;++r)s[r]=s[r-1]+l[r-1]<<1;var c;if(n){c=new st(1<<e);var a=15-e;for(r=0;r<i;++r)if(t[r])for(var p=r<<4|t[r],v=e-t[r],m=s[t[r]-1]++<<v,b=m|(1<<v)-1;m<=b;++m)c[Pt[m]>>>a]=p}else for(c=new st(i),r=0;r<i;++r)t[r]&&(c[r]=Pt[s[t[r]-1]++]>>>15-t[r]);return c},xt=new Z(288);for(var I=0;I<144;++I)xt[I]=8;for(var I=144;I<256;++I)xt[I]=9;for(var I=256;I<280;++I)xt[I]=7;for(var I=280;I<288;++I)xt[I]=8;var De=new Z(32);for(var I=0;I<32;++I)De[I]=5;var Ne=_t(xt,9,1);var ze=_t(De,5,1),Mt=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},et=function(t,e,n){var i=e/8|0;return(t[i]|t[i+1]<<8)>>(e&7)&n},Dt=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(e&7)},Ue=function(t){return(t/8|0)+(t&7&&1)},Nt=function(t,e,n){(e==null||e<0)&&(e=0),(n==null||n>t.length)&&(n=t.length);var i=new(t instanceof st?st:t instanceof Rt?Rt:Z)(n-e);return i.set(t.subarray(e,n)),i},Be=function(t,e,n){var i=t.length;if(!i||n&&!n.l&&i<5)return e||new Z(0);var r=!e||n,l=!n||n.i;n||(n={}),e||(e=new Z(i*3));var s=function(_){var vt=e.length;if(_>vt){var $t=new Z(Math.max(vt*2,_));$t.set(e),e=$t}},c=n.f||0,a=n.p||0,p=n.b||0,v=n.l,m=n.d,b=n.m,C=n.n,E=i*8;do{if(!v){n.f=c=et(t,a,1);var x=et(t,a+1,3);if(a+=3,x)if(x==1)v=Ne,m=ze,b=9,C=5;else if(x==2){var T=et(t,a,31)+257,F=et(t,a+10,15)+4,$=T+et(t,a+5,31)+1;a+=14;for(var q=new Z($),P=new Z(19),d=0;d<F;++d)P[$e[d]]=et(t,a+d*3,7);a+=F*3;for(var S=Mt(P),U=(1<<S)-1,h=_t(P,S,1),d=0;d<$;){var L=h[et(t,a,U)];a+=L&15;var D=L>>>4;if(D<16)q[d++]=D;else{var R=0,J=0;for(D==16?(J=3+et(t,a,3),a+=2,R=q[d-1]):D==17?(J=3+et(t,a,7),a+=3):D==18&&(J=11+et(t,a,127),a+=7);J--;)q[d++]=R}}var u=q.subarray(0,T),o=q.subarray(T);b=Mt(u),C=Mt(o),v=_t(u,b,1),m=_t(o,C,1)}else throw"invalid block type";else{var D=Ue(a)+4,X=t[D-4]|t[D-3]<<8,G=D+X;if(G>i){if(l)throw"unexpected EOF";break}r&&s(p+X),e.set(t.subarray(D,G),p),n.b=p+=X,n.p=a=G*8;continue}if(a>E){if(l)throw"unexpected EOF";break}}r&&s(p+131072);for(var W=(1<<b)-1,w=(1<<C)-1,Q=a;;Q=a){var R=v[Dt(t,a)&W],j=R>>>4;if(a+=R&15,a>E){if(l)throw"unexpected EOF";break}if(!R)throw"invalid length/literal";if(j<256)e[p++]=j;else if(j==256){Q=a,v=null;break}else{var K=j-254;if(j>264){var d=j-257,rt=te[d];K=et(t,a,(1<<rt)-1)+ne[d],a+=rt}var St=m[Dt(t,a)&w],pt=St>>>4;if(!St)throw"invalid distance";a+=St&15;var o=Me[pt];if(pt>3){var rt=ee[pt];o+=Dt(t,a)&(1<<rt)-1,a+=rt}if(a>E){if(l)throw"unexpected EOF";break}r&&s(p+131072);for(var it=p+K;p<it;p+=4)e[p]=e[p-o],e[p+1]=e[p+1-o],e[p+2]=e[p+2-o],e[p+3]=e[p+3-o];p=it}}n.l=v,n.p=Q,n.b=p,v&&(c=1,n.m=b,n.d=m,n.n=C)}while(!c);return p==e.length?e:Nt(e,0,p)};var pr=new Z(0);var gr=function(t,e){var n={};for(var i in t)n[i]=t[i];for(var i in e)n[i]=e[i];return n},Fe=function(t,e,n){for(var i=t(),r=t.toString(),l=r.slice(r.indexOf("[")+1,r.lastIndexOf("]")).replace(/ /g,"").split(","),s=0;s<i.length;++s){var c=i[s],a=l[s];if(typeof c=="function"){e+=";"+a+"=";var p=c.toString();if(c.prototype)if(p.indexOf("[native code]")!=-1){var v=p.indexOf(" ",8)+1;e+=p.slice(v,p.indexOf("(",v))}else{e+=p;for(var m in c.prototype)e+=";"+a+".prototype."+m+"="+c.prototype[m].toString()}else e+=p}else n[a]=c}return[e,n]},zt=[],vr=function(t){var e=[];for(var n in t)(t[n]instanceof Z||t[n]instanceof st||t[n]instanceof Rt)&&e.push((t[n]=new t[n].constructor(t[n])).buffer);return e},dr=function(t,e,n,i){var r;if(!zt[n]){for(var l="",s={},c=t.length-1,a=0;a<c;++a)r=Fe(t[a],l,s),l=r[0],s=r[1];zt[n]=Fe(t[c],l,s)}var p=gr({},zt[n][1]);return cr(zt[n][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",n,p,vr(p),i)},yr=function(){return[Z,st,Rt,te,ee,$e,ne,Me,Ne,ze,Pt,_t,Mt,et,Dt,Ue,Nt,Be,re,Ge,qe]};var Ge=function(t){return postMessage(t,[t.buffer])},qe=function(t){return t&&t.size&&new Z(t.size)},mr=function(t,e,n,i,r,l){var s=dr(n,i,r,function(c,a){s.terminate(),l(c,a)});return s.postMessage([t,e],e.consume?[t.buffer]:[]),function(){s.terminate()}};var ot=function(t,e){return t[e]|t[e+1]<<8},nt=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},ie=function(t,e){return nt(t,e)+nt(t,e+4)*4294967296};function _r(t,e,n){if(n||(n=e,e={}),typeof n!="function")throw"no callback";return mr(t,e,[yr],function(i){return Ge(re(i.data[0],qe(i.data[1])))},1,n)}function re(t,e){return Be(t,e)}var Zi=typeof TextEncoder!="undefined"&&new TextEncoder,se=typeof TextDecoder!="undefined"&&new TextDecoder,Ar=0;try{se.decode(pr,{stream:!0}),Ar=1}catch(t){}var wr=function(t){for(var e="",n=0;;){var i=t[n++],r=(i>127)+(i>223)+(i>239);if(n+r>t.length)return[e,Nt(t,n-1)];r?r==3?(i=((i&15)<<18|(t[n++]&63)<<12|(t[n++]&63)<<6|t[n++]&63)-65536,e+=String.fromCharCode(55296|i>>10,56320|i&1023)):r&1?e+=String.fromCharCode((i&31)<<6|t[n++]&63):e+=String.fromCharCode((i&15)<<12|(t[n++]&63)<<6|t[n++]&63):e+=String.fromCharCode(i)}};function Er(t,e){if(e){for(var n="",i=0;i<t.length;i+=16384)n+=String.fromCharCode.apply(null,t.subarray(i,i+16384));return n}else{if(se)return se.decode(t);var r=wr(t),l=r[0],s=r[1];if(s.length)throw"invalid utf-8 data";return l}}var Sr=function(t,e){return e+30+ot(t,e+26)+ot(t,e+28)},xr=function(t,e,n){var i=ot(t,e+28),r=Er(t.subarray(e+46,e+46+i),!(ot(t,e+8)&2048)),l=e+46+i,s=nt(t,e+20),c=n&&s==4294967295?Rr(t,l):[s,nt(t,e+24),nt(t,e+42)],a=c[0],p=c[1],v=c[2];return[ot(t,e+10),a,p,r,l+ot(t,e+30)+ot(t,e+32),v]},Rr=function(t,e){for(;ot(t,e)!=1;e+=4+ot(t,e+2));return[ie(t,e+12),ie(t,e+4),ie(t,e+20)]};function We(t,e){if(typeof e!="function")throw"no callback";for(var n=[],i=function(){for(var b=0;b<n.length;++b)n[b]()},r={},l=t.length-22;nt(t,l)!=101010256;--l)if(!l||t.length-l>65558){e("invalid zip file",null);return}var s=ot(t,l+8);s||e(null,{});var c=s,a=nt(t,l+16),p=a==4294967295;if(p){if(l=nt(t,l-12),nt(t,l)!=101075792){e("invalid zip file",null);return}c=s=nt(t,l+32),a=nt(t,l+48)}for(var v=function(b){var C=xr(t,a,p),E=C[0],x=C[1],D=C[2],X=C[3],G=C[4],T=C[5],F=Sr(t,T);a=G;var $=function(P,d){P?(i(),e(P,null)):(r[X]=d,--s||e(null,r))};if(!E)$(null,Nt(t,F,F+x));else if(E==8){var q=t.subarray(F,F+x);if(x<32e4)try{$(null,re(q,new Z(D)))}catch(P){$(P,null)}else n.push(_r(q,{size:D},$))}else $("unknown compression type "+E,null)},m=0;m<c;++m)v(m);return i}var Rn=ir(Sn()),xn=class{constructor(){this._buffers={}}clear(){this._buffers={}}put(e,n){this._buffers[e]=n}get(e){return this._buffers[e]}keys(){return Object.keys(this._buffers)}},li="",ui="",hi=5e3;function bn(t){return this.test(t)}function ci(t,e){console.error(t,e)}var Xt=class extends HTMLElement{static createFileMatcher(e){if(typeof e=="string"){let n=(0,Rn.makeRe)(e),i=bn.bind(n);return i.key=e,i}else if(e instanceof RegExp){let n=e,i=bn.bind(n);return i.key=e.source,i}else throw new Error("Filter must be either a RegExp or glob string.")}static get[Symbol.for("templateNode")](){let e=document.createElement("template");return e.innerHTML=li,Object.defineProperty(this,Symbol.for("templateNode"),{value:e}),e}static get[Symbol.for("styleNode")](){let e=document.createElement("style");return e.innerHTML=ui,Object.defineProperty(this,Symbol.for("styleNode"),{value:e}),e}static define(e=window.customElements){e.define("asset-pack",Xt)}static get observedAttributes(){return["src"]}set src(e){this.setAttribute("src",e)}get src(){return this._src}constructor(){super();let e=this.attachShadow({mode:"open"});e.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),e.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._src="",this._files=new xn,this._cache={},this._loading={},this.onLoad=this.onLoad.bind(this),this.loaded=!1}get files(){return this._files}cacheAsset(e,n,i={}){let{ephemeral:r}=i,l=this._cache[e],s=this._loading[e];this._cache[e]=n,this.dispatchEvent(new CustomEvent("cache",{composed:!0,bubbles:!1,detail:{uri:e,current:n}})),s&&(s.resolve(n),delete this._loading[n]),r&&this._cache[n]===n&&(l?this._cache[n]=l:delete this._cache[n])}async loadAsset(e,n=hi){let i=this._cache[e];if(i)return i;if(e in this._loading)return this._loading[e].promise;{let r=new Cn(n);return this._loading[e]=r,r.promise}}clearAssets(){for(let e of Object.values(this._loading))e.reject(new Error("Stop loading to clear all assets."));this._loading={},this._cache={}}deleteAsset(e){e in this._loading&&(this._loading[e].reject(new Error("Stop loading to delete asset.")),delete this._loading[e]),e in this._cache&&delete this._cache[e]}getAsset(e){return this._cache[e]}getAssetURIs(){return Object.keys(this._cache)}hasAsset(e){let n=this._cache[e];return n?Boolean(n):!1}isAssetCached(e){return e in this._cache}isAssetLoading(e){return e in this._loading}connectedCallback(){fi(this,"src")}attributeChangedCallback(e,n,i){switch(e){case"src":this._src=i,i&&(this.loaded=!1,fetch(i).then(this.onLoad).catch(r=>ci("Failed to load asset pack:",r)));break}}async onLoad(e){let n=await e.arrayBuffer();await new Promise((i,r)=>{We(new Uint8Array(n),(l,s)=>{if(l)r(l);else{let c=this._files;Promise.all(Object.entries(s).map(([a,p])=>(c.put(a,p),this.cacheAsset(a,p)))).then(()=>i()).catch(r)}})}),this.dispatchEvent(new CustomEvent("load",{composed:!0})),this.loaded=!0}};Xt.define();function fi(t,e){if(Object.prototype.hasOwnProperty.call(t,e)){let n=t[e];delete t[e],t[e]=n}}var Cn=class{constructor(e){this._resolve=null,this._reject=null,this._reason=null,this._value=null,this._timeoutHandle=e>0?setTimeout(()=>{this.reject(`Asset loading exceeded timeout of ${e} ms.`)},e):null,this._promise=new Promise((n,i)=>{this._value?n(this._value):this._resolve=n,this._reason?i(this._reason):this._reject=i})}get promise(){return this._promise}resolve(e){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._resolve?this._resolve(e):this._value=e}reject(e){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._reject?this._reject(e):this._reason=e}};var _e=class{next(){return 0}},Tn=class extends _e{next(){return Math.random()}},Ln=class extends _e{constructor(e){super();this.seed=e,this.a=e}next(){var e=this.a+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}},y=class{static get RAND(){let e=new this;return this.next=this.next.bind(this),this.choose=this.choose.bind(this),this.range=this.range.bind(this),this.rangeInt=this.rangeInt.bind(this),this.sign=this.sign.bind(this),Object.defineProperty(this,"RAND",{value:e}),e}constructor(e=void 0){typeof e=="number"?this.generator=new Ln(e):e?this.generator=e:this.generator=new Tn,this.next=this.next.bind(this),this.choose=this.choose.bind(this),this.range=this.range.bind(this),this.rangeInt=this.rangeInt.bind(this),this.sign=this.sign.bind(this)}static next(){return this.RAND.next()}next(){return this.generator.next()}static choose(e){return this.RAND.choose(e)}choose(e){return e[Math.floor(this.generator.next()*e.length)]}static range(e,n){return this.RAND.range(e,n)}range(e,n){return(n-e)*this.generator.next()+e}static rangeInt(e,n){return this.RAND.rangeInt(e,n)}rangeInt(e,n){return Math.trunc(this.range(e,n))}static sign(){return this.RAND.sign()}sign(){return this.generator.next()<.5?-1:1}};window.addEventListener("error",On,!0);window.addEventListener("unhandledrejection",On,!0);function On(t){t instanceof PromiseRejectionEvent?window.alert(t.reason.stack):t instanceof ErrorEvent?window.alert(t.error.stack):window.alert(JSON.stringify(t))}async function Hn(t){let e=Ae.AUDIO_CONTEXT,n=await e.decodeAudioData(t);return new Ae(e,n)}var Ae=class{static get AUDIO_CONTEXT(){let e=new AudioContext;return pi(e),Object.defineProperty(this,"AUDIO_CONTEXT",{value:e}),e}constructor(e,n){this.audioContext=e,this.audioBuffer=n,this._playing=!1,this._started=!1,this._source=null,this.onAudioSourceEnded=this.onAudioSourceEnded.bind(this)}onAudioSourceEnded(){this._playing=!1}play(e={}){let n=this.audioBuffer;if(!n)return;this._source&&this.destroy();let{pitch:i=0,gain:r=0,pan:l=0,loop:s=!1}=e,c=this.audioContext,a=c.createBufferSource();a.addEventListener("ended",this.onAudioSourceEnded),a.buffer=n,a.loop=s;let p=a;if(i&&(a.detune.value=i*100),r){let v=c.createGain();v.gain.value=r,p=p.connect(v)}if(l){let v=c.createStereoPanner();v.pan.value=l,p=p.connect(v)}p.connect(c.destination),a.start(),this._source=a,this._started=!0,this._playing=!0}pause(){this._source.stop(),this._playing=!1}destroy(){this._source&&this._source.disconnect(),this._source=null,this._started=!1,this._playing=!1}isStarted(){return this._started}isPlaying(){return this._playing}isPaused(){return this._started&&!this._playing}};function pi(t){let e=()=>{t.state==="suspended"&&t.resume()};document.addEventListener("click",e)}var $n={};function ct(){return $n}async function kn(t){await Promise.all([wt("start",t.files.get("res/start.wav")),wt("dead",t.files.get("res/dead.wav")),wt("pop",t.files.get("res/boop.wav")),wt("music",t.files.get("res/music.wav")),wt("shoot",t.files.get("res/click.wav")),wt("boom",t.files.get("res/boom.wav"))])}async function wt(t,e){let n=new ArrayBuffer(e.byteLength);new Uint8Array(n).set(e),$n[t]=await Hn(n)}var gi=[2,4],vi=[.3,1],di=30;function In(t,e){let n={x:[],y:[],size:[],speed:[],length:0,width:t,height:e};for(let i=0;i<di;++i)n.x.push(y.range(0,t)),n.y.push(y.range(0,e)),n.size.push(y.range(...gi)),n.speed.push(y.range(...vi)),n.length++;return n}function Pn(t,e,n="white"){for(let i=0;i<e.length;++i){let r=e.x[i],l=e.y[i],s=e.size[i],c=s/2;t.fillStyle=n,t.fillRect(r-c,l-c,s,s)}}function Mn(t,e=1,n=0){let{length:i,width:r,height:l}=t;for(let s=0;s<i;++s){let c=e*t.speed[s],a=n*t.speed[s];t.x[s]+=c,t.y[s]+=a,c<0?t.x[s]<0&&(t.x[s]=r,t.y[s]=y.range(0,l)):c>0&&t.x[s]>r&&(t.x[s]=0,t.y[s]=y.range(0,l)),a<0?t.y[s]<0&&(t.x[s]=y.range(0,r),t.y[s]=l):a>0&&t.y[s]>l&&(t.x[s]=y.range(0,r),t.y[s]=0)}}var yi=document.querySelector("#display"),O=yi.canvas,mi=O.getContext("2d"),we=0,Kt={load:_i,start:Ai,update:wi,render:Ei};window.addEventListener("DOMContentLoaded",Si);function Si(){Kt.load().then(()=>{Kt.start(),Dn(we=performance.now())})}function Dn(t){requestAnimationFrame(Dn);let e=t-we;we=t,Kt.update(e),Kt.render(mi)}var lt=5,Tt=4,H=8,Nn=[[-H,-H,H*2+O.width,H],[-H,0,H,O.height],[-H,O.height,H*2+O.width,H],[O.width,0,H,O.height]],Ee=[3e3,1e4],Ri=1,xi=100,M=1,yt=2,Zt=4,bi=2e3,Ci=100,zn=10,Lt=4,Un=2,Ot=600,Bn=.1,Ti=["red","red","red","yellow","orange"],Fn=["blue","blue","blue","dodgerblue","gray","darkgray","yellow"],Li=["gray","darkgray","lightgray"],Oi="[ wasd_ ]",Gn=[-2,2],qn=1.5,Hi=.1,$i=.4,Se=.1,Wn=.02,ki=.008,Ii=.1,jn=.001,Pi="gold";var ft=4,Mi=["white","violet","violet"],Di=30,Ni=.7,Re=!1;async function _i(){console.log("Loading...");let t=document.querySelector("#assets"),e=new Promise((n,i)=>{t.addEventListener("load",n),t.addEventListener("error",i)});t.src="res.pack",await e,await kn(t),console.log("...loading complete!")}function Ai(){this.level=0,this.score=0,this.highScore=Number(localStorage.getItem("highscore")),this.flashScoreDelta=0,this.flashHighScoreDelta=0,this.flashShootDelta=0,this.player={scene:this,x:O.width/2,y:O.height/2,rotation:0,dx:0,dy:0,dr:0,left:0,right:0,up:0,down:0,cooldown:0,powerMode:0,shoot(){if(!(this.scene.bullets.length>Ci)&&!(this.cooldown>0)){if(this.powerMode>0){for(let t=-1;t<=1;++t){let e=this.rotation+t*Math.PI/4,n=Xn(this.scene,this.x-Math.cos(e)*lt,this.y-Math.sin(e)*lt,-Math.cos(e)*Zt+this.dx,-Math.sin(e)*Zt+this.dy);this.scene.bullets.push(n)}--this.powerMode}else{let t=Xn(this.scene,this.x-Math.cos(this.rotation)*lt,this.y-Math.sin(this.rotation)*lt,-Math.cos(this.rotation)*Zt+this.dx,-Math.sin(this.rotation)*Zt+this.dy);this.scene.bullets.push(t)}this.cooldown=zn,ct().shoot.play()}}},this.asteroids=[],this.asteroidSpawner={scene:this,spawnTicks:Ee[1],reset(){this.spawnTicks=Ee[1]},spawn(){if(this.scene.asteroids.length>xi)return;let t=y.choose(Nn),e=Ht(this.scene,y.range(t[0],t[0]+t[2]),y.range(t[1],t[1]+t[3]),y.range(-M,M),y.range(-M,M),H);this.scene.asteroids.push(e)},update(t){this.scene.gamePause||(this.spawnTicks-=t,this.spawnTicks<=0&&(this.spawn(),this.spawnTicks=y.range(...Ee)))}},this.bullets=[],this.particles=[],this.powerUps=[],this.powerUpSpawner={scene:this,reset(){},spawn(){let t=y.choose(Nn),e=zi(this.scene,y.range(t[0],t[0]+t[2]),y.range(t[1],t[1]+t[3]),y.range(-M,M),y.range(-M,M));this.scene.powerUps.push(e)},update(t){}},this.starfield=In(O.width,O.height),this.gamePause=!0,this.showPlayer=!0,this.gameStart=!0,this.gameWait=!0,this.hint=Oi,document.addEventListener("keydown",t=>Ui.call(this,t.key)),document.addEventListener("keyup",t=>Bi.call(this,t.key))}function wi(t){if(this.gamePause){for(let r of this.particles)r.age+=t,r.age>Ot?r.destroy():(r.x+=r.dx,r.y+=r.dy,Et(r,Lt*2,Lt*2));return}let e=this.player.right-this.player.left,n=this.player.down-this.player.up,i=this.player.fire;this.player.dx+=n*Math.cos(this.player.rotation)*Wn,this.player.dy+=n*Math.sin(this.player.rotation)*Wn,this.player.dx*=1-jn,this.player.dy*=1-jn,this.player.dr+=e*ki,this.player.dr*=1-Ii,this.player.x+=this.player.dx,this.player.y+=this.player.dy,this.player.rotation+=this.player.dr,--this.player.cooldown,Et(this.player,lt*2,lt*2),i&&(this.player.shoot(),this.flashShootDelta=1),n&&Gi(this,this.player.x,this.player.y,-n*Math.cos(this.player.rotation)*qn,-n*Math.sin(this.player.rotation)*qn,y.choose.bind(null,Li));for(let r of this.bullets)r.age+=t,r.age>bi?r.destroy():(r.x+=r.dx,r.y+=r.dy,Et(r,yt*2,yt*2));for(let r of this.bullets)for(let l of this.asteroids)if(xe(r,l,l.size)){this.flashScore=1,this.score++,this.score>this.highScore&&(this.flashHighScore=this.score-this.highScore,this.highScore=this.score,localStorage.setItem("highscore",this.highScore)),Yt(this,l.x,l.y,10,y.choose.bind(null,Fn)),ct().pop.play(),r.destroy(),l.breakUp(r.dx*Bn,r.dy*Bn);break}for(let r of this.particles)r.age+=t,r.age>Ot?r.destroy():(r.x+=r.dx,r.y+=r.dy,Et(r,Lt*2,Lt*2));for(let r of this.asteroids)r.x+=r.dx,r.y+=r.dy,Et(r,r.size*2,r.size*2);for(let r of this.asteroids)if(xe(r,this.player,r.size+lt)){Yt(this,r.x,r.y,10,y.choose.bind(null,Fn)),r.destroy(),Fi(this);break}for(let r of this.powerUps)r.x+=r.dx,r.y+=r.dy,Et(r,ft*2,ft*2);for(let r of this.powerUps)if(xe(r,this.player,ft+lt)){Yt(this,r.x,r.y,10,y.choose.bind(null,Mi)),r.destroy(),this.player.powerMode+=Di;break}Mn(this.starfield),this.asteroidSpawner.update(t),this.powerUpSpawner.update(t),!this.gamePause&&this.asteroids.length<=0&&(this.gamePause=!0,this.showPlayer=!0,ct().start.play(),setTimeout(()=>this.gameWait=!0,1e3))}function Ei(t){t.fillStyle="black",t.fillRect(0,0,O.width,O.height),Pn(t,this.starfield),t.fillStyle="rgba(255, 255, 255, 0.2)",t.textAlign="center",t.textBaseline="middle",t.font="16px sans-serif",t.fillText(this.hint,O.width/2,O.height/2-32),this.flashScore>0?(t.fillStyle=`rgba(255, 255, 255, ${this.flashScore+.2})`,this.flashScore-=Se):t.fillStyle="rgba(255, 255, 255, 0.2)",t.font="48px sans-serif",t.fillText("= "+String(this.score).padStart(2,"0")+" =",O.width/2,O.height/2),this.flashHighScore>0?(t.fillStyle=`rgba(255, 255, 255, ${this.flashHighScore+.2})`,this.flashHighScore-=Se):t.fillStyle="rgba(255, 255, 255, 0.2)",t.font="16px sans-serif",t.fillText(String(this.highScore).padStart(2,"0"),O.width/2,O.height/2+32),t.fillStyle="rgba(255, 255, 255, 0.2)",t.font="24px sans-serif",t.textAlign="right",t.fillText(Math.ceil(this.asteroidSpawner.spawnTicks/1e3),O.width,O.height-12);for(let e of this.asteroids)t.translate(e.x,e.y),t.rotate(e.rotation),t.fillStyle="slategray",t.fillRect(-e.size,-e.size,e.size*2,e.size*2),t.setTransform(1,0,0,1,0,0),Qt(t,e.x,e.y,e.size);for(let e of this.powerUps)t.translate(e.x,e.y),t.rotate(e.rotation),t.beginPath(),t.strokeStyle="violet",t.arc(0,0,ft,0,Math.PI*2),t.moveTo(-ft/2,0),t.lineTo(ft/2,0),t.moveTo(0,-ft/2),t.lineTo(0,ft/2),t.stroke(),t.setTransform(1,0,0,1,0,0),Qt(t,e.x,e.y,ft);for(let e of this.bullets)t.translate(e.x,e.y),t.rotate(e.rotation),t.fillStyle=Pi,t.fillRect(-yt,-yt,yt*4,yt*2),t.setTransform(1,0,0,1,0,0),Qt(t,e.x,e.y,yt);for(let e of this.particles){t.translate(e.x,e.y),t.rotate(e.rotation),t.fillStyle=e.color;let n=Lt*(1-e.age/Ot);t.fillRect(-n,-n,n*2,n*2),t.setTransform(1,0,0,1,0,0)}if(this.showPlayer){t.translate(this.player.x,this.player.y),t.rotate(this.player.rotation),t.fillStyle="white";let e=lt;t.fillRect(-e,-e,e*2,e*2);let n=-1,i=0,r=0;this.flashShootDelta>0?(t.fillStyle=`rgb(${200*this.flashShootDelta+55*Math.sin(performance.now()/(zn*2))}, 0, 0)`,this.flashShootDelta-=Se,r=this.flashShootDelta*2,n=this.flashShootDelta):t.fillStyle="black",t.fillRect(-e-r/2+n,-(e/4)-r/2+i,e+r,e/2+r),t.setTransform(1,0,0,1,0,0)}Qt(t,this.player.x,this.player.y,lt)}function Et(t,e,n){t.x<-e&&(t.x=O.width),t.y<-n&&(t.y=O.height),t.x>O.width+e/2&&(t.x=-e),t.y>O.height+n/2&&(t.y=-n)}function xe(t,e,n){let i=t.x-e.x,r=t.y-e.y;return i*i+r*r<=n*n}function Qt(t,e,n,i){!Re||(t.translate(e,n),t.beginPath(),t.arc(0,0,i,0,Math.PI*2),t.strokeStyle="lime",t.stroke(),t.setTransform(1,0,0,1,0,0))}function zi(t,e,n,i,r){return{scene:t,x:e,y:n,dx:i,dy:r,rotation:Math.atan2(r,i),destroy(){this.scene.powerUps.splice(this.scene.powerUps.indexOf(this),1)}}}function Ht(t,e,n,i,r,l){return{scene:t,x:e,y:n,dx:i,dy:r,size:l,rotation:Math.atan2(r,i),breakUp(s=0,c=0){if(this.destroy(),this.size>Tt){let a=[];a.push(Ht(this.scene,this.x+y.range(-H,H),this.y+y.range(-H,H),y.range(-M,M)+s,y.range(-M,M)+c,Tt)),a.push(Ht(this.scene,this.x+y.range(-H,H),this.y+y.range(-H,H),y.range(-M,M)+s,y.range(-M,M)+c,Tt)),a.push(Ht(this.scene,this.x+y.range(-H,H),this.y+y.range(-H,H),y.range(-M,M)+s,y.range(-M,M)+c,Tt)),a.push(Ht(this.scene,this.x+y.range(-H,H),this.y+y.range(-H,H),y.range(-M,M)+s,y.range(-M,M)+c,Tt)),this.scene.asteroids.push(...a)}},destroy(){this.scene.asteroids.splice(this.scene.asteroids.indexOf(this),1)}}}function Xn(t,e,n,i,r){return{scene:t,x:e,y:n,dx:i,dy:r,rotation:Math.atan2(r,i),age:0,destroy(){this.scene.bullets.splice(this.scene.bullets.indexOf(this),1)}}}function Kn(t,e,n,i,r,l){return typeof l=="function"&&(l=l.call(null)),{scene:t,x:e,y:n,dx:i,dy:r,rotation:Math.atan2(r,i),age:0,color:l,destroy(){this.scene.particles.splice(this.scene.particles.indexOf(this),1)}}}function qi(t){t.bullets.length=0,t.asteroids.length=0,t.particles.length=0,t.player.x=O.width/2,t.player.y=O.height/2,t.player.dx=0,t.player.dy=0,t.level++,t.gamePause=!1,t.showPlayer=!0;for(let e=0;e<Ri*t.level;++e)t.asteroidSpawner.spawn();y.next()>Ni&&t.powerUpSpawner.spawn(),ct().music.isPlaying()||ct().music.play({loop:!0})}function Fi(t){t.gamePause=!0,t.showPlayer=!1,Yt(t,t.player.x,t.player.y,100,y.choose.bind(null,Ti)),ct().dead.play(),ct().boom.play(),setTimeout(()=>t.gameStart=t.gameWait=!0,1e3)}function Gi(t,e,n,i,r,l){if(y.next()>.3){let s=Kn(t,e+y.range(...Gn),n+y.range(...Gn),i,r,l);s.age=y.range(Ot*Hi,Ot*$i),t.particles.push(s)}}function Yt(t,e,n,i=10,r){for(let l=0;l<i;++l)t.particles.push(Kn(t,e,n,y.range(-1,1)*Un,y.range(-1,1)*Un,r))}function Ui(t){switch(this.gameWait&&(this.gameStart&&(ct().music.play(),this.score=0,this.flashScore=!0,this.level=0,this.gameStart=!1,this.player.powerMode=0,this.powerUps.length=0,this.asteroidSpawner.reset(),this.powerUpSpawner.reset()),this.gameWait=!1,qi(this)),t){case"w":case"ArrowUp":this.player.up=1;break;case"s":case"ArrowDown":this.player.down=1;break;case"a":case"ArrowLeft":this.player.left=1;break;case"d":case"ArrowRight":this.player.right=1;break;case" ":this.player.fire=1;break;case"\\":break;default:console.log(t)}}function Bi(t){switch(t){case"w":case"ArrowUp":this.player.up=0;break;case"s":case"ArrowDown":this.player.down=0;break;case"a":case"ArrowLeft":this.player.left=0;break;case"d":case"ArrowRight":this.player.right=0;break;case" ":this.player.fire=0;break;case"\\":Re=!Re;break;default:console.log(t)}}})();
//# sourceMappingURL=main.js.map
