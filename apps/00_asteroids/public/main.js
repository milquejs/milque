(()=>{var er=Object.create,zt=Object.defineProperty,nr=Object.getPrototypeOf,rr=Object.prototype.hasOwnProperty,ir=Object.getOwnPropertyNames,sr=Object.getOwnPropertyDescriptor;var ar=t=>zt(t,"__esModule",{value:!0});var or=(t,e)=>()=>(t&&(e=t(t=0)),e),mt=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),lr=(t,e)=>{for(var n in e)zt(t,n,{get:e[n],enumerable:!0})},ur=(t,e,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of ir(e))!rr.call(t,i)&&i!=="default"&&zt(t,i,{get:()=>e[i],enumerable:!(n=sr(e,i))||n.enumerable});return t},hr=t=>ur(ar(zt(t!=null?er(nr(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var Ue={};lr(Ue,{basename:()=>Xe,default:()=>Ar,delimiter:()=>We,dirname:()=>je,extname:()=>Ke,isAbsolute:()=>ae,join:()=>Fe,normalize:()=>oe,relative:()=>Ge,resolve:()=>Nt,sep:()=>qe});function Be(t,e){for(var n=0,i=t.length-1;i>=0;i--){var r=t[i];r==="."?t.splice(i,1):r===".."?(t.splice(i,1),n++):n&&(t.splice(i,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function Nt(){for(var t="",e=!1,n=arguments.length-1;n>=-1&&!e;n--){var i=n>=0?arguments[n]:"/";if(typeof i!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!i)continue;t=i+"/"+t,e=i.charAt(0)==="/"}return t=Be(se(t.split("/"),function(r){return!!r}),!e).join("/"),(e?"/":"")+t||"."}function oe(t){var e=ae(t),n=mr(t,-1)==="/";return t=Be(se(t.split("/"),function(i){return!!i}),!e).join("/"),!t&&!e&&(t="."),t&&n&&(t+="/"),(e?"/":"")+t}function ae(t){return t.charAt(0)==="/"}function Fe(){var t=Array.prototype.slice.call(arguments,0);return oe(se(t,function(e,n){if(typeof e!="string")throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))}function Ge(t,e){t=Nt(t).substr(1),e=Nt(e).substr(1);function n(p){for(var v=0;v<p.length&&p[v]==="";v++);for(var m=p.length-1;m>=0&&p[m]==="";m--);return v>m?[]:p.slice(v,m-v+1)}for(var i=n(t.split("/")),r=n(e.split("/")),l=Math.min(i.length,r.length),s=l,h=0;h<l;h++)if(i[h]!==r[h]){s=h;break}for(var a=[],h=s;h<i.length;h++)a.push("..");return a=a.concat(r.slice(s)),a.join("/")}function je(t){var e=ie(t),n=e[0],i=e[1];return!n&&!i?".":(i&&(i=i.substr(0,i.length-1)),n+i)}function Xe(t,e){var n=ie(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n}function Ke(t){return ie(t)[3]}function se(t,e){if(t.filter)return t.filter(e);for(var n=[],i=0;i<t.length;i++)e(t[i],i,t)&&n.push(t[i]);return n}var yr,ie,qe,We,Ar,mr,Ze=or(()=>{yr=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,ie=function(t){return yr.exec(t).slice(1)};qe="/",We=":";Ar={extname:Ke,basename:Xe,dirname:je,sep:qe,delimiter:We,relative:Ge,join:Fe,isAbsolute:ae,normalize:oe,resolve:Nt};mr="ab".substr(-1)==="b"?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}});var Bt=mt((us,Ut)=>{var dt=(Ze(),Ue);dt&&dt.default?Ut.exports=dt.default:dt&&(Ut.exports=dt);if(dt)for(let t in dt)Ut.exports[t]=dt[t]});var bt=mt((hs,Ye)=>{"use strict";var wr=Bt(),at="\\\\/",Qe=`[^${at}]`,ht="\\.",_r="\\+",Er="\\?",Ft="\\/",Sr="(?=.)",Ve="[^/]",le=`(?:${Ft}|$)`,Je=`(?:^|${Ft})`,ue=`${ht}{1,2}${le}`,Rr=`(?!${ht})`,xr=`(?!${Je}${ue})`,br=`(?!${ht}{0,1}${le})`,Cr=`(?!${ue})`,Tr=`[^.${Ft}]`,Or=`${Ve}*?`,tn={DOT_LITERAL:ht,PLUS_LITERAL:_r,QMARK_LITERAL:Er,SLASH_LITERAL:Ft,ONE_CHAR:Sr,QMARK:Ve,END_ANCHOR:le,DOTS_SLASH:ue,NO_DOT:Rr,NO_DOTS:xr,NO_DOT_SLASH:br,NO_DOTS_SLASH:Cr,QMARK_NO_DOT:Tr,STAR:Or,START_ANCHOR:Je},Lr={...tn,SLASH_LITERAL:`[${at}]`,QMARK:Qe,STAR:`${Qe}*?`,DOTS_SLASH:`${ht}{1,2}(?:[${at}]|$)`,NO_DOT:`(?!${ht})`,NO_DOTS:`(?!(?:^|[${at}])${ht}{1,2}(?:[${at}]|$))`,NO_DOT_SLASH:`(?!${ht}{0,1}(?:[${at}]|$))`,NO_DOTS_SLASH:`(?!${ht}{1,2}(?:[${at}]|$))`,QMARK_NO_DOT:`[^.${at}]`,START_ANCHOR:`(?:^|[${at}])`,END_ANCHOR:`(?:[${at}]|$)`},Hr={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};Ye.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:Hr,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:wr.sep,extglobChars(t){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${t.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(t){return t===!0?Lr:tn}}});var Gt=mt(V=>{"use strict";var $r=Bt(),kr=!1,{REGEX_BACKSLASH:Ir,REGEX_REMOVE_BACKSLASH:Pr,REGEX_SPECIAL_CHARS:Dr,REGEX_SPECIAL_CHARS_GLOBAL:Mr}=bt();V.isObject=t=>t!==null&&typeof t=="object"&&!Array.isArray(t);V.hasRegexChars=t=>Dr.test(t);V.isRegexChar=t=>t.length===1&&V.hasRegexChars(t);V.escapeRegex=t=>t.replace(Mr,"\\$1");V.toPosixSlashes=t=>t.replace(Ir,"/");V.removeBackslashes=t=>t.replace(Pr,e=>e==="\\"?"":e);V.supportsLookbehinds=()=>{let t=process.version.slice(1).split(".").map(Number);return t.length===3&&t[0]>=9||t[0]===8&&t[1]>=10};V.isWindows=t=>t&&typeof t.windows=="boolean"?t.windows:kr===!0||$r.sep==="\\";V.escapeLast=(t,e,n)=>{let i=t.lastIndexOf(e,n);return i===-1?t:t[i-1]==="\\"?V.escapeLast(t,e,i-1):`${t.slice(0,i)}\\${t.slice(i)}`};V.removePrefix=(t,e={})=>{let n=t;return n.startsWith("./")&&(n=n.slice(2),e.prefix="./"),n};V.wrapOutput=(t,e={},n={})=>{let i=n.contains?"":"^",r=n.contains?"":"$",l=`${i}(?:${t})${r}`;return e.negated===!0&&(l=`(?:^(?!${l}).*$)`),l}});var un=mt((fs,en)=>{"use strict";var nn=Gt(),{CHAR_ASTERISK:he,CHAR_AT:zr,CHAR_BACKWARD_SLASH:Ct,CHAR_COMMA:Nr,CHAR_DOT:ce,CHAR_EXCLAMATION_MARK:fe,CHAR_FORWARD_SLASH:rn,CHAR_LEFT_CURLY_BRACE:pe,CHAR_LEFT_PARENTHESES:ge,CHAR_LEFT_SQUARE_BRACKET:Ur,CHAR_PLUS:Br,CHAR_QUESTION_MARK:sn,CHAR_RIGHT_CURLY_BRACE:Fr,CHAR_RIGHT_PARENTHESES:an,CHAR_RIGHT_SQUARE_BRACKET:Gr}=bt(),on=t=>t===rn||t===Ct,ln=t=>{t.isPrefix!==!0&&(t.depth=t.isGlobstar?Infinity:1)},qr=(t,e)=>{let n=e||{},i=t.length-1,r=n.parts===!0||n.scanToEnd===!0,l=[],s=[],h=[],a=t,p=-1,v=0,m=0,_=!1,C=!1,S=!1,b=!1,M=!1,X=!1,G=!1,T=!1,F=!1,$=!1,q=0,P,d,R={value:"",depth:0,isGlob:!1},U=()=>p>=i,c=()=>a.charCodeAt(p+1),O=()=>(P=d,a.charCodeAt(++p));for(;p<i;){d=O();let W;if(d===Ct){G=R.backslashes=!0,d=O(),d===pe&&(X=!0);continue}if(X===!0||d===pe){for(q++;U()!==!0&&(d=O());){if(d===Ct){G=R.backslashes=!0,O();continue}if(d===pe){q++;continue}if(X!==!0&&d===ce&&(d=O())===ce){if(_=R.isBrace=!0,S=R.isGlob=!0,$=!0,r===!0)continue;break}if(X!==!0&&d===Nr){if(_=R.isBrace=!0,S=R.isGlob=!0,$=!0,r===!0)continue;break}if(d===Fr&&(q--,q===0)){X=!1,_=R.isBrace=!0,$=!0;break}}if(r===!0)continue;break}if(d===rn){if(l.push(p),s.push(R),R={value:"",depth:0,isGlob:!1},$===!0)continue;if(P===ce&&p===v+1){v+=2;continue}m=p+1;continue}if(n.noext!==!0&&(d===Br||d===zr||d===he||d===sn||d===fe)===!0&&c()===ge){if(S=R.isGlob=!0,b=R.isExtglob=!0,$=!0,d===fe&&p===v&&(F=!0),r===!0){for(;U()!==!0&&(d=O());){if(d===Ct){G=R.backslashes=!0,d=O();continue}if(d===an){S=R.isGlob=!0,$=!0;break}}continue}break}if(d===he){if(P===he&&(M=R.isGlobstar=!0),S=R.isGlob=!0,$=!0,r===!0)continue;break}if(d===sn){if(S=R.isGlob=!0,$=!0,r===!0)continue;break}if(d===Ur){for(;U()!==!0&&(W=O());){if(W===Ct){G=R.backslashes=!0,O();continue}if(W===Gr){C=R.isBracket=!0,S=R.isGlob=!0,$=!0;break}}if(r===!0)continue;break}if(n.nonegate!==!0&&d===fe&&p===v){T=R.negated=!0,v++;continue}if(n.noparen!==!0&&d===ge){if(S=R.isGlob=!0,r===!0){for(;U()!==!0&&(d=O());){if(d===ge){G=R.backslashes=!0,d=O();continue}if(d===an){$=!0;break}}continue}break}if(S===!0){if($=!0,r===!0)continue;break}}n.noext===!0&&(b=!1,S=!1);let x=a,J="",u="";v>0&&(J=a.slice(0,v),a=a.slice(v),m-=v),x&&S===!0&&m>0?(x=a.slice(0,m),u=a.slice(m)):S===!0?(x="",u=a):x=a,x&&x!==""&&x!=="/"&&x!==a&&on(x.charCodeAt(x.length-1))&&(x=x.slice(0,-1)),n.unescape===!0&&(u&&(u=nn.removeBackslashes(u)),x&&G===!0&&(x=nn.removeBackslashes(x)));let o={prefix:J,input:t,start:v,base:x,glob:u,isBrace:_,isBracket:C,isGlob:S,isExtglob:b,isGlobstar:M,negated:T,negatedExtglob:F};if(n.tokens===!0&&(o.maxDepth=0,on(d)||s.push(R),o.tokens=s),n.parts===!0||n.tokens===!0){let W;for(let E=0;E<l.length;E++){let Q=W?W+1:v,j=l[E],K=t.slice(Q,j);n.tokens&&(E===0&&v!==0?(s[E].isPrefix=!0,s[E].value=J):s[E].value=K,ln(s[E]),o.maxDepth+=s[E].depth),(E!==0||K!=="")&&h.push(K),W=j}if(W&&W+1<t.length){let E=t.slice(W+1);h.push(E),n.tokens&&(s[s.length-1].value=E,ln(s[s.length-1]),o.maxDepth+=s[s.length-1].depth)}o.slashes=l,o.parts=h}return o};en.exports=qr});var pn=mt((ps,hn)=>{"use strict";var qt=bt(),tt=Gt(),{MAX_LENGTH:Wt,POSIX_REGEX_SOURCE:Wr,REGEX_NON_SPECIAL_CHARS:jr,REGEX_SPECIAL_CHARS_BACKREF:Xr,REPLACEMENTS:cn}=qt,Kr=(t,e)=>{if(typeof e.expandRange=="function")return e.expandRange(...t,e);t.sort();let n=`[${t.join("-")}]`;try{new RegExp(n)}catch(i){return t.map(r=>tt.escapeRegex(r)).join("..")}return n},_t=(t,e)=>`Missing ${t}: "${e}" - use "\\\\${e}" to match literal characters`,fn=(t,e)=>{if(typeof t!="string")throw new TypeError("Expected a string");t=cn[t]||t;let n={...e},i=typeof n.maxLength=="number"?Math.min(Wt,n.maxLength):Wt,r=t.length;if(r>i)throw new SyntaxError(`Input length: ${r}, exceeds maximum allowed length: ${i}`);let l={type:"bos",value:"",output:n.prepend||""},s=[l],h=n.capture?"":"?:",a=tt.isWindows(e),p=qt.globChars(a),v=qt.extglobChars(p),{DOT_LITERAL:m,PLUS_LITERAL:_,SLASH_LITERAL:C,ONE_CHAR:S,DOTS_SLASH:b,NO_DOT:M,NO_DOT_SLASH:X,NO_DOTS_SLASH:G,QMARK:T,QMARK_NO_DOT:F,STAR:$,START_ANCHOR:q}=p,P=g=>`(${h}(?:(?!${q}${g.dot?b:m}).)*?)`,d=n.dot?"":M,R=n.dot?T:F,U=n.bash===!0?P(n):$;n.capture&&(U=`(${U})`),typeof n.noext=="boolean"&&(n.noextglob=n.noext);let c={input:t,index:-1,start:0,dot:n.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:s};t=tt.removePrefix(t,c),r=t.length;let O=[],x=[],J=[],u=l,o,W=()=>c.index===r-1,E=c.peek=(g=1)=>t[c.index+g],Q=c.advance=()=>t[++c.index]||"",j=()=>t.slice(c.index+1),K=(g="",k=0)=>{c.consumed+=g,c.index+=k},it=g=>{c.output+=g.output!=null?g.output:g.value,K(g.value)},xt=()=>{let g=1;for(;E()==="!"&&(E(2)!=="("||E(3)==="?");)Q(),c.start++,g++;return g%2==0?!1:(c.negated=!0,c.start++,!0)},vt=g=>{c[g]++,J.push(g)},st=g=>{c[g]--,J.pop()},A=g=>{if(u.type==="globstar"){let k=c.braces>0&&(g.type==="comma"||g.type==="brace"),f=g.extglob===!0||O.length&&(g.type==="pipe"||g.type==="paren");g.type!=="slash"&&g.type!=="paren"&&!k&&!f&&(c.output=c.output.slice(0,-u.output.length),u.type="star",u.value="*",u.output=U,c.output+=u.output)}if(O.length&&g.type!=="paren"&&(O[O.length-1].inner+=g.value),(g.value||g.output)&&it(g),u&&u.type==="text"&&g.type==="text"){u.value+=g.value,u.output=(u.output||"")+g.value;return}g.prev=u,s.push(g),u=g},yt=(g,k)=>{let f={...v[k],conditions:1,inner:""};f.prev=u,f.parens=c.parens,f.output=c.output;let w=(n.capture?"(":"")+f.open;vt("parens"),A({type:g,value:k,output:c.output?"":S}),A({type:"paren",extglob:!0,value:Q(),output:w}),O.push(f)},Dt=g=>{let k=g.close+(n.capture?")":""),f;if(g.type==="negate"){let w=U;g.inner&&g.inner.length>1&&g.inner.includes("/")&&(w=P(n)),(w!==U||W()||/^\)+$/.test(j()))&&(k=g.close=`)$))${w}`),g.inner.includes("*")&&(f=j())&&/^\.[^\\/.]+$/.test(f)&&(k=g.close=`)${f})${w})`),g.prev.type==="bos"&&(c.negatedExtglob=!0)}A({type:"paren",extglob:!0,value:o,output:k}),st("parens")};if(n.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(t)){let g=!1,k=t.replace(Xr,(f,w,z,Y,B,ee)=>Y==="\\"?(g=!0,f):Y==="?"?w?w+Y+(B?T.repeat(B.length):""):ee===0?R+(B?T.repeat(B.length):""):T.repeat(z.length):Y==="."?m.repeat(z.length):Y==="*"?w?w+Y+(B?U:""):U:w?f:`\\${f}`);return g===!0&&(n.unescape===!0?k=k.replace(/\\/g,""):k=k.replace(/\\+/g,f=>f.length%2==0?"\\\\":f?"\\":"")),k===t&&n.contains===!0?(c.output=t,c):(c.output=tt.wrapOutput(k,c,e),c)}for(;!W();){if(o=Q(),o==="\0")continue;if(o==="\\"){let f=E();if(f==="/"&&n.bash!==!0||f==="."||f===";")continue;if(!f){o+="\\",A({type:"text",value:o});continue}let w=/^\\+/.exec(j()),z=0;if(w&&w[0].length>2&&(z=w[0].length,c.index+=z,z%2!=0&&(o+="\\")),n.unescape===!0?o=Q():o+=Q(),c.brackets===0){A({type:"text",value:o});continue}}if(c.brackets>0&&(o!=="]"||u.value==="["||u.value==="[^")){if(n.posix!==!1&&o===":"){let f=u.value.slice(1);if(f.includes("[")&&(u.posix=!0,f.includes(":"))){let w=u.value.lastIndexOf("["),z=u.value.slice(0,w),Y=u.value.slice(w+2),B=Wr[Y];if(B){u.value=z+B,c.backtrack=!0,Q(),!l.output&&s.indexOf(u)===1&&(l.output=S);continue}}}(o==="["&&E()!==":"||o==="-"&&E()==="]")&&(o=`\\${o}`),o==="]"&&(u.value==="["||u.value==="[^")&&(o=`\\${o}`),n.posix===!0&&o==="!"&&u.value==="["&&(o="^"),u.value+=o,it({value:o});continue}if(c.quotes===1&&o!=='"'){o=tt.escapeRegex(o),u.value+=o,it({value:o});continue}if(o==='"'){c.quotes=c.quotes===1?0:1,n.keepQuotes===!0&&A({type:"text",value:o});continue}if(o==="("){vt("parens"),A({type:"paren",value:o});continue}if(o===")"){if(c.parens===0&&n.strictBrackets===!0)throw new SyntaxError(_t("opening","("));let f=O[O.length-1];if(f&&c.parens===f.parens+1){Dt(O.pop());continue}A({type:"paren",value:o,output:c.parens?")":"\\)"}),st("parens");continue}if(o==="["){if(n.nobracket===!0||!j().includes("]")){if(n.nobracket!==!0&&n.strictBrackets===!0)throw new SyntaxError(_t("closing","]"));o=`\\${o}`}else vt("brackets");A({type:"bracket",value:o});continue}if(o==="]"){if(n.nobracket===!0||u&&u.type==="bracket"&&u.value.length===1){A({type:"text",value:o,output:`\\${o}`});continue}if(c.brackets===0){if(n.strictBrackets===!0)throw new SyntaxError(_t("opening","["));A({type:"text",value:o,output:`\\${o}`});continue}st("brackets");let f=u.value.slice(1);if(u.posix!==!0&&f[0]==="^"&&!f.includes("/")&&(o=`/${o}`),u.value+=o,it({value:o}),n.literalBrackets===!1||tt.hasRegexChars(f))continue;let w=tt.escapeRegex(u.value);if(c.output=c.output.slice(0,-u.value.length),n.literalBrackets===!0){c.output+=w,u.value=w;continue}u.value=`(${h}${w}|${u.value})`,c.output+=u.value;continue}if(o==="{"&&n.nobrace!==!0){vt("braces");let f={type:"brace",value:o,output:"(",outputIndex:c.output.length,tokensIndex:c.tokens.length};x.push(f),A(f);continue}if(o==="}"){let f=x[x.length-1];if(n.nobrace===!0||!f){A({type:"text",value:o,output:o});continue}let w=")";if(f.dots===!0){let z=s.slice(),Y=[];for(let B=z.length-1;B>=0&&(s.pop(),z[B].type!=="brace");B--)z[B].type!=="dots"&&Y.unshift(z[B].value);w=Kr(Y,n),c.backtrack=!0}if(f.comma!==!0&&f.dots!==!0){let z=c.output.slice(0,f.outputIndex),Y=c.tokens.slice(f.tokensIndex);f.value=f.output="\\{",o=w="\\}",c.output=z;for(let B of Y)c.output+=B.output||B.value}A({type:"brace",value:o,output:w}),st("braces"),x.pop();continue}if(o==="|"){O.length>0&&O[O.length-1].conditions++,A({type:"text",value:o});continue}if(o===","){let f=o,w=x[x.length-1];w&&J[J.length-1]==="braces"&&(w.comma=!0,f="|"),A({type:"comma",value:o,output:f});continue}if(o==="/"){if(u.type==="dot"&&c.index===c.start+1){c.start=c.index+1,c.consumed="",c.output="",s.pop(),u=l;continue}A({type:"slash",value:o,output:C});continue}if(o==="."){if(c.braces>0&&u.type==="dot"){u.value==="."&&(u.output=m);let f=x[x.length-1];u.type="dots",u.output+=o,u.value+=o,f.dots=!0;continue}if(c.braces+c.parens===0&&u.type!=="bos"&&u.type!=="slash"){A({type:"text",value:o,output:m});continue}A({type:"dot",value:o,output:m});continue}if(o==="?"){if(!(u&&u.value==="(")&&n.noextglob!==!0&&E()==="("&&E(2)!=="?"){yt("qmark",o);continue}if(u&&u.type==="paren"){let w=E(),z=o;if(w==="<"&&!tt.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(u.value==="("&&!/[!=<:]/.test(w)||w==="<"&&!/<([!=]|\w+>)/.test(j()))&&(z=`\\${o}`),A({type:"text",value:o,output:z});continue}if(n.dot!==!0&&(u.type==="slash"||u.type==="bos")){A({type:"qmark",value:o,output:F});continue}A({type:"qmark",value:o,output:T});continue}if(o==="!"){if(n.noextglob!==!0&&E()==="("&&(E(2)!=="?"||!/[!=<:]/.test(E(3)))){yt("negate",o);continue}if(n.nonegate!==!0&&c.index===0){xt();continue}}if(o==="+"){if(n.noextglob!==!0&&E()==="("&&E(2)!=="?"){yt("plus",o);continue}if(u&&u.value==="("||n.regex===!1){A({type:"plus",value:o,output:_});continue}if(u&&(u.type==="bracket"||u.type==="paren"||u.type==="brace")||c.parens>0){A({type:"plus",value:o});continue}A({type:"plus",value:_});continue}if(o==="@"){if(n.noextglob!==!0&&E()==="("&&E(2)!=="?"){A({type:"at",extglob:!0,value:o,output:""});continue}A({type:"text",value:o});continue}if(o!=="*"){(o==="$"||o==="^")&&(o=`\\${o}`);let f=jr.exec(j());f&&(o+=f[0],c.index+=f[0].length),A({type:"text",value:o});continue}if(u&&(u.type==="globstar"||u.star===!0)){u.type="star",u.star=!0,u.value+=o,u.output=U,c.backtrack=!0,c.globstar=!0,K(o);continue}let g=j();if(n.noextglob!==!0&&/^\([^?]/.test(g)){yt("star",o);continue}if(u.type==="star"){if(n.noglobstar===!0){K(o);continue}let f=u.prev,w=f.prev,z=f.type==="slash"||f.type==="bos",Y=w&&(w.type==="star"||w.type==="globstar");if(n.bash===!0&&(!z||g[0]&&g[0]!=="/")){A({type:"star",value:o,output:""});continue}let B=c.braces>0&&(f.type==="comma"||f.type==="brace"),ee=O.length&&(f.type==="pipe"||f.type==="paren");if(!z&&f.type!=="paren"&&!B&&!ee){A({type:"star",value:o,output:""});continue}for(;g.slice(0,3)==="/**";){let Mt=t[c.index+4];if(Mt&&Mt!=="/")break;g=g.slice(3),K("/**",3)}if(f.type==="bos"&&W()){u.type="globstar",u.value+=o,u.output=P(n),c.output=u.output,c.globstar=!0,K(o);continue}if(f.type==="slash"&&f.prev.type!=="bos"&&!Y&&W()){c.output=c.output.slice(0,-(f.output+u.output).length),f.output=`(?:${f.output}`,u.type="globstar",u.output=P(n)+(n.strictSlashes?")":"|$)"),u.value+=o,c.globstar=!0,c.output+=f.output+u.output,K(o);continue}if(f.type==="slash"&&f.prev.type!=="bos"&&g[0]==="/"){let Mt=g[1]!==void 0?"|$":"";c.output=c.output.slice(0,-(f.output+u.output).length),f.output=`(?:${f.output}`,u.type="globstar",u.output=`${P(n)}${C}|${C}${Mt})`,u.value+=o,c.output+=f.output+u.output,c.globstar=!0,K(o+Q()),A({type:"slash",value:"/",output:""});continue}if(f.type==="bos"&&g[0]==="/"){u.type="globstar",u.value+=o,u.output=`(?:^|${C}|${P(n)}${C})`,c.output=u.output,c.globstar=!0,K(o+Q()),A({type:"slash",value:"/",output:""});continue}c.output=c.output.slice(0,-u.output.length),u.type="globstar",u.output=P(n),u.value+=o,c.output+=u.output,c.globstar=!0,K(o);continue}let k={type:"star",value:o,output:U};if(n.bash===!0){k.output=".*?",(u.type==="bos"||u.type==="slash")&&(k.output=d+k.output),A(k);continue}if(u&&(u.type==="bracket"||u.type==="paren")&&n.regex===!0){k.output=o,A(k);continue}(c.index===c.start||u.type==="slash"||u.type==="dot")&&(u.type==="dot"?(c.output+=X,u.output+=X):n.dot===!0?(c.output+=G,u.output+=G):(c.output+=d,u.output+=d),E()!=="*"&&(c.output+=S,u.output+=S)),A(k)}for(;c.brackets>0;){if(n.strictBrackets===!0)throw new SyntaxError(_t("closing","]"));c.output=tt.escapeLast(c.output,"["),st("brackets")}for(;c.parens>0;){if(n.strictBrackets===!0)throw new SyntaxError(_t("closing",")"));c.output=tt.escapeLast(c.output,"("),st("parens")}for(;c.braces>0;){if(n.strictBrackets===!0)throw new SyntaxError(_t("closing","}"));c.output=tt.escapeLast(c.output,"{"),st("braces")}if(n.strictSlashes!==!0&&(u.type==="star"||u.type==="bracket")&&A({type:"maybe_slash",value:"",output:`${C}?`}),c.backtrack===!0){c.output="";for(let g of c.tokens)c.output+=g.output!=null?g.output:g.value,g.suffix&&(c.output+=g.suffix)}return c};fn.fastpaths=(t,e)=>{let n={...e},i=typeof n.maxLength=="number"?Math.min(Wt,n.maxLength):Wt,r=t.length;if(r>i)throw new SyntaxError(`Input length: ${r}, exceeds maximum allowed length: ${i}`);t=cn[t]||t;let l=tt.isWindows(e),{DOT_LITERAL:s,SLASH_LITERAL:h,ONE_CHAR:a,DOTS_SLASH:p,NO_DOT:v,NO_DOTS:m,NO_DOTS_SLASH:_,STAR:C,START_ANCHOR:S}=qt.globChars(l),b=n.dot?m:v,M=n.dot?_:v,X=n.capture?"":"?:",G={negated:!1,prefix:""},T=n.bash===!0?".*?":C;n.capture&&(T=`(${T})`);let F=d=>d.noglobstar===!0?T:`(${X}(?:(?!${S}${d.dot?p:s}).)*?)`,$=d=>{switch(d){case"*":return`${b}${a}${T}`;case".*":return`${s}${a}${T}`;case"*.*":return`${b}${T}${s}${a}${T}`;case"*/*":return`${b}${T}${h}${a}${M}${T}`;case"**":return b+F(n);case"**/*":return`(?:${b}${F(n)}${h})?${M}${a}${T}`;case"**/*.*":return`(?:${b}${F(n)}${h})?${M}${T}${s}${a}${T}`;case"**/.*":return`(?:${b}${F(n)}${h})?${s}${a}${T}`;default:{let R=/^(.*?)\.(\w+)$/.exec(d);if(!R)return;let U=$(R[1]);return U?U+s+R[2]:void 0}}},q=tt.removePrefix(t,G),P=$(q);return P&&n.strictSlashes!==!0&&(P+=`${h}?`),P};hn.exports=fn});var vn=mt((gs,gn)=>{"use strict";var Zr=Bt(),Yr=un(),ve=pn(),de=Gt(),Qr=bt(),Vr=t=>t&&typeof t=="object"&&!Array.isArray(t),N=(t,e,n=!1)=>{if(Array.isArray(t)){let v=t.map(_=>N(_,e,n));return _=>{for(let C of v){let S=C(_);if(S)return S}return!1}}let i=Vr(t)&&t.tokens&&t.input;if(t===""||typeof t!="string"&&!i)throw new TypeError("Expected pattern to be a non-empty string");let r=e||{},l=de.isWindows(e),s=i?N.compileRe(t,e):N.makeRe(t,e,!1,!0),h=s.state;delete s.state;let a=()=>!1;if(r.ignore){let v={...e,ignore:null,onMatch:null,onResult:null};a=N(r.ignore,v,n)}let p=(v,m=!1)=>{let{isMatch:_,match:C,output:S}=N.test(v,s,e,{glob:t,posix:l}),b={glob:t,state:h,regex:s,posix:l,input:v,output:S,match:C,isMatch:_};return typeof r.onResult=="function"&&r.onResult(b),_===!1?(b.isMatch=!1,m?b:!1):a(v)?(typeof r.onIgnore=="function"&&r.onIgnore(b),b.isMatch=!1,m?b:!1):(typeof r.onMatch=="function"&&r.onMatch(b),m?b:!0)};return n&&(p.state=h),p};N.test=(t,e,n,{glob:i,posix:r}={})=>{if(typeof t!="string")throw new TypeError("Expected input to be a string");if(t==="")return{isMatch:!1,output:""};let l=n||{},s=l.format||(r?de.toPosixSlashes:null),h=t===i,a=h&&s?s(t):t;return h===!1&&(a=s?s(t):t,h=a===i),(h===!1||l.capture===!0)&&(l.matchBase===!0||l.basename===!0?h=N.matchBase(t,e,n,r):h=e.exec(a)),{isMatch:Boolean(h),match:h,output:a}};N.matchBase=(t,e,n,i=de.isWindows(n))=>(e instanceof RegExp?e:N.makeRe(e,n)).test(Zr.basename(t));N.isMatch=(t,e,n)=>N(e,n)(t);N.parse=(t,e)=>Array.isArray(t)?t.map(n=>N.parse(n,e)):ve(t,{...e,fastpaths:!1});N.scan=(t,e)=>Yr(t,e);N.compileRe=(t,e,n=!1,i=!1)=>{if(n===!0)return t.output;let r=e||{},l=r.contains?"":"^",s=r.contains?"":"$",h=`${l}(?:${t.output})${s}`;t&&t.negated===!0&&(h=`^(?!${h}).*$`);let a=N.toRegex(h,e);return i===!0&&(a.state=t),a};N.makeRe=(t,e={},n=!1,i=!1)=>{if(!t||typeof t!="string")throw new TypeError("Expected a non-empty string");let r={negated:!1,fastpaths:!0};return e.fastpaths!==!1&&(t[0]==="."||t[0]==="*")&&(r.output=ve.fastpaths(t,e)),r.output||(r=ve(t,e)),N.compileRe(r,e,n,i)};N.toRegex=(t,e)=>{try{let n=e||{};return new RegExp(t,n.flags||(n.nocase?"i":""))}catch(n){if(e&&e.debug===!0)throw n;return/$^/}};N.constants=Qr;gn.exports=N});var yn=mt((vs,dn)=>{"use strict";dn.exports=vn()});var cr=`<div class="container">
  <label class="hidden" id="title">display-port</label>
  <label class="hidden" id="fps">00</label>
  <label class="hidden" id="dimension">0x0</label>
  <div class="content">
    <canvas> Oh no! Your browser does not support canvas. </canvas>
    <slot id="inner"></slot>
  </div>
  <slot name="frame"></slot>
</div>
`,fr=`:host {
  display: inline-block;
  color: #555555;
}

.container {
  display: flex;
  position: relative;
  width: 100%;
  height: 100%;
}

.content {
  position: relative;
  margin: auto;
}

.content > *:not(canvas) {
  width: 100%;
  height: 100%;
}

canvas {
  background: #000000;
  image-rendering: pixelated;
}

label {
  position: absolute;
  font-family: monospace;
  color: currentColor;
}

#inner {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: 0;
  left: 0;
  pointer-events: none;
}

#title {
  left: 0.5rem;
  top: 0.5rem;
}

#fps {
  right: 0.5rem;
  top: 0.5rem;
}

#dimension {
  left: 0.5rem;
  bottom: 0.5rem;
}

.hidden {
  display: none;
}

:host([debug]) .container {
  outline: 6px dashed rgba(0, 0, 0, 0.1);
  outline-offset: -4px;
  background-color: rgba(0, 0, 0, 0.1);
}

:host([mode='noscale']) canvas {
  margin: 0;
  top: 0;
  left: 0;
}

:host([mode='stretch']) canvas,
:host([mode='scale']) canvas {
  width: 100%;
  height: 100%;
}

:host([mode='fit']),
:host([mode='scale']),
:host([mode='center']),
:host([mode='stretch']),
:host([mode='fill']) {
  width: 100%;
  height: 100%;
}

:host([full]) {
  width: 100vw !important;
  height: 100vh !important;
}

:host([disabled]) {
  display: none;
}

slot {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  pointer-events: none;
}

::slotted(*) {
  pointer-events: auto;
}
`,$e="noscale",ne="fit",ke="scale",Ie="fill",Pe="stretch",pr=300,gr=150,vr=ne,dr=200,De=class extends HTMLElement{static get[Symbol.for("templateNode")](){let e=document.createElement("template");return e.innerHTML=cr,Object.defineProperty(this,Symbol.for("templateNode"),{value:e}),e}static get[Symbol.for("styleNode")](){let e=document.createElement("style");return e.innerHTML=fr,Object.defineProperty(this,Symbol.for("styleNode"),{value:e}),e}static define(e=window.customElements){e.define("display-port",this)}static get observedAttributes(){return["debug","disabled","width","height","onframe","id","class"]}get mode(){return this.getAttribute("mode")}set mode(e){this.setAttribute("mode",e)}get debug(){return this._debug}set debug(e){this.toggleAttribute("debug",e)}get disabled(){return this._disabled}set disabled(e){this.toggleAttribute("disabled",e)}get width(){return this._width}set width(e){this.setAttribute("width",String(e))}get height(){return this._height}set height(e){this.setAttribute("height",String(e))}get onframe(){return this._onframe}set onframe(e){this._onframe&&this.removeEventListener("frame",this._onframe),this._onframe=e,this._onframe&&this.addEventListener("frame",e)}constructor(){super();let e=this.attachShadow({mode:"open"});e.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),e.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._canvasElement=e.querySelector("canvas"),this._contentElement=e.querySelector(".content"),this._innerElement=e.querySelector("#inner"),this._titleElement=e.querySelector("#title"),this._fpsElement=e.querySelector("#fps"),this._dimensionElement=e.querySelector("#dimension"),this._debug=!1,this._disabled=!1,this._width=pr,this._height=gr,this._onframe=void 0,this._animationRequestHandle=0,this._prevAnimationFrameTime=0,this._resizeTimeoutHandle=0,this._resizeCanvasWidth=0,this._resizeCanvasHeight=0,this._frameEvent=new CustomEvent("frame",{composed:!0,bubbles:!1,detail:{now:0,prevTime:0,deltaTime:0,canvas:this._canvasElement}}),this._resizeEvent=new CustomEvent("resize",{composed:!0,bubbles:!1,detail:{width:0,height:0}}),this.update=this.update.bind(this),this.onDelayCanvasResize=this.onDelayCanvasResize.bind(this)}get canvas(){return this._canvasElement}connectedCallback(){wt(this,"mode"),wt(this,"debug"),wt(this,"disabled"),wt(this,"width"),wt(this,"height"),wt(this,"onframe"),this.hasAttribute("mode")||this.setAttribute("mode",vr),this.hasAttribute("tabindex")||this.setAttribute("tabindex","0"),this.updateCanvasSize(!0),this.resume()}disconnectedCallback(){this.pause()}attributeChangedCallback(e,n,i){switch(e){case"debug":this._debug=i!==null;break;case"disabled":this._disabled=i!==null;break;case"width":this._width=Number(i);break;case"height":this._height=Number(i);break;case"onframe":this.onframe=new Function("event","with(document){with(this){"+i+"}}").bind(this);break}switch(e){case"disabled":i?(this.update(0),this.pause()):this.resume();break;case"id":case"class":this._titleElement.innerHTML=`display-port${this.className?"."+this.className:""}${this.hasAttribute("id")?"#"+this.getAttribute("id"):""}`;break;case"debug":this._titleElement.classList.toggle("hidden",i),this._fpsElement.classList.toggle("hidden",i),this._dimensionElement.classList.toggle("hidden",i);break}}getContext(e="2d",n=void 0){return this._canvasElement.getContext(e,n)}pause(){cancelAnimationFrame(this._animationRequestHandle)}resume(){this._animationRequestHandle=requestAnimationFrame(this.update)}update(e){this._animationRequestHandle=requestAnimationFrame(this.update),this.updateCanvasSize(!1);let n=e-this._prevAnimationFrameTime;if(this._prevAnimationFrameTime=e,this._debug){let l=n<=0?"--":String(Math.round(1e3/n)).padStart(2,"0");if(this._fpsElement.textContent!==l&&(this._fpsElement.textContent=l),this.mode===$e){let h=`${this._width}x${this._height}`;this._dimensionElement.textContent!==h&&(this._dimensionElement.textContent=h)}else{let h=`${this._width}x${this._height}|${this.shadowRoot.host.clientWidth}x${this.shadowRoot.host.clientHeight}`;this._dimensionElement.textContent!==h&&(this._dimensionElement.textContent=h)}}let r=this._frameEvent.detail;r.now=e,r.prevTime=this._prevAnimationFrameTime,r.deltaTime=n,this.dispatchEvent(this._frameEvent)}onDelayCanvasResize(){this._resizeTimeoutHandle=0,this.updateCanvasSize(!0)}delayCanvasResize(e,n){(e!==this._resizeCanvasWidth||n!==this._resizeCanvasHeight)&&(this._resizeCanvasWidth=e,this._resizeCanvasHeight=n,this._resizeTimeoutHandle&&clearTimeout(this._resizeTimeoutHandle),this._resizeTimeoutHandle=setTimeout(this.onDelayCanvasResize,dr))}updateCanvasSize(e=!0){let n=this.shadowRoot.host.getBoundingClientRect(),i=n.width,r=n.height,l=this._canvasElement,s=this._width,h=this._height,a=this.mode;if(a===Pe||a===Ie)s=i,h=r;else if(a!==$e&&(i<s||r<h||a===ne||a==ke)){let v=i/s,m=r/h;v<m?(s=i,h=h*v):(s=s*m,h=r)}if(s=Math.floor(s),h=Math.floor(h),typeof e=="undefined"&&(e=l.clientWidth!==s||l.clientHeight!==h),!e){this.delayCanvasResize(s,h);return}let p=Math.min(s/this._width,h/this._height)*.5;if(this._innerElement.style.fontSize=`font-size: ${p}em`,e){a===ke?(l.width=this._width,l.height=this._height):a!==Pe&&(l.width=s,l.height=h);let v=this._contentElement.style;v.width=`${s}px`,v.height=`${h}px`,(a===ne||a===Ie)&&(this._width=s,this._height=h);let _=this._resizeEvent.detail;_.width=s,_.height=h,this.dispatchEvent(this._resizeEvent)}}};De.define();function wt(t,e){if(Object.prototype.hasOwnProperty.call(t,e)){let n=t[e];delete t[e],t[e]=n}}var re=class{next(){return 0}},Me=class extends re{next(){return Math.random()}},ze=class extends re{constructor(e){super();this.seed=e,this.a=e}next(){var e=this.a+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}},y=class{static get RAND(){let e=new this;return this.next=this.next.bind(this),this.choose=this.choose.bind(this),this.range=this.range.bind(this),this.rangeInt=this.rangeInt.bind(this),this.sign=this.sign.bind(this),Object.defineProperty(this,"RAND",{value:e}),e}constructor(e=void 0){typeof e=="number"?this.generator=new ze(e):e?this.generator=e:this.generator=new Me,this.next=this.next.bind(this),this.choose=this.choose.bind(this),this.range=this.range.bind(this),this.rangeInt=this.rangeInt.bind(this),this.sign=this.sign.bind(this)}static next(){return this.RAND.next()}next(){return this.generator.next()}static choose(e){return this.RAND.choose(e)}choose(e){return e[Math.floor(this.generator.next()*e.length)]}static range(e,n){return this.RAND.range(e,n)}range(e,n){return(n-e)*this.generator.next()+e}static rangeInt(e,n){return this.RAND.rangeInt(e,n)}rangeInt(e,n){return Math.trunc(this.range(e,n))}static sign(){return this.RAND.sign()}sign(){return this.generator.next()<.5?-1:1}};window.addEventListener("error",Ne,!0);window.addEventListener("unhandledrejection",Ne,!0);function Ne(t){t instanceof PromiseRejectionEvent?window.alert(t.reason.stack):t instanceof ErrorEvent?window.alert(t.error.stack):window.alert(JSON.stringify(t))}var kn=hr(yn());var mn={},Jr=function(t,e,n,i,r){var l=new Worker(mn[e]||(mn[e]=URL.createObjectURL(new Blob([t],{type:"text/javascript"}))));return l.onerror=function(s){return r(s.error,null)},l.onmessage=function(s){return r(null,s.data)},l.postMessage(n,i),l},Z=Uint8Array,ot=Uint16Array,Tt=Uint32Array,ye=new Z([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),me=new Z([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),An=new Z([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),wn=function(t,e){for(var n=new ot(31),i=0;i<31;++i)n[i]=e+=1<<t[i-1];for(var r=new Tt(n[30]),i=1;i<30;++i)for(var l=n[i];l<n[i+1];++l)r[l]=l-n[i]<<5|i;return[n,r]},_n=wn(ye,2),Ae=_n[0],ti=_n[1];Ae[28]=258,ti[258]=28;var En=wn(me,0),Sn=En[0],ys=En[1],jt=new ot(32768);for(var I=0;I<32768;++I)ct=(I&43690)>>>1|(I&21845)<<1,ct=(ct&52428)>>>2|(ct&13107)<<2,ct=(ct&61680)>>>4|(ct&3855)<<4,jt[I]=((ct&65280)>>>8|(ct&255)<<8)>>>1;var ct,Et=function(t,e,n){for(var i=t.length,r=0,l=new ot(e);r<i;++r)++l[t[r]-1];var s=new ot(e);for(r=0;r<e;++r)s[r]=s[r-1]+l[r-1]<<1;var h;if(n){h=new ot(1<<e);var a=15-e;for(r=0;r<i;++r)if(t[r])for(var p=r<<4|t[r],v=e-t[r],m=s[t[r]-1]++<<v,_=m|(1<<v)-1;m<=_;++m)h[jt[m]>>>a]=p}else for(h=new ot(i),r=0;r<i;++r)t[r]&&(h[r]=jt[s[t[r]-1]++]>>>15-t[r]);return h},Ot=new Z(288);for(var I=0;I<144;++I)Ot[I]=8;for(var I=144;I<256;++I)Ot[I]=9;for(var I=256;I<280;++I)Ot[I]=7;for(var I=280;I<288;++I)Ot[I]=8;var Rn=new Z(32);for(var I=0;I<32;++I)Rn[I]=5;var xn=Et(Ot,9,1);var bn=Et(Rn,5,1),Xt=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},et=function(t,e,n){var i=e/8|0;return(t[i]|t[i+1]<<8)>>(e&7)&n},Kt=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(e&7)},Cn=function(t){return(t/8|0)+(t&7&&1)},Zt=function(t,e,n){(e==null||e<0)&&(e=0),(n==null||n>t.length)&&(n=t.length);var i=new(t instanceof ot?ot:t instanceof Tt?Tt:Z)(n-e);return i.set(t.subarray(e,n)),i},Tn=function(t,e,n){var i=t.length;if(!i||n&&!n.l&&i<5)return e||new Z(0);var r=!e||n,l=!n||n.i;n||(n={}),e||(e=new Z(i*3));var s=function(A){var yt=e.length;if(A>yt){var Dt=new Z(Math.max(yt*2,A));Dt.set(e),e=Dt}},h=n.f||0,a=n.p||0,p=n.b||0,v=n.l,m=n.d,_=n.m,C=n.n,S=i*8;do{if(!v){n.f=h=et(t,a,1);var b=et(t,a+1,3);if(a+=3,b)if(b==1)v=xn,m=bn,_=9,C=5;else if(b==2){var T=et(t,a,31)+257,F=et(t,a+10,15)+4,$=T+et(t,a+5,31)+1;a+=14;for(var q=new Z($),P=new Z(19),d=0;d<F;++d)P[An[d]]=et(t,a+d*3,7);a+=F*3;for(var R=Xt(P),U=(1<<R)-1,c=Et(P,R,1),d=0;d<$;){var O=c[et(t,a,U)];a+=O&15;var M=O>>>4;if(M<16)q[d++]=M;else{var x=0,J=0;for(M==16?(J=3+et(t,a,3),a+=2,x=q[d-1]):M==17?(J=3+et(t,a,7),a+=3):M==18&&(J=11+et(t,a,127),a+=7);J--;)q[d++]=x}}var u=q.subarray(0,T),o=q.subarray(T);_=Xt(u),C=Xt(o),v=Et(u,_,1),m=Et(o,C,1)}else throw"invalid block type";else{var M=Cn(a)+4,X=t[M-4]|t[M-3]<<8,G=M+X;if(G>i){if(l)throw"unexpected EOF";break}r&&s(p+X),e.set(t.subarray(M,G),p),n.b=p+=X,n.p=a=G*8;continue}if(a>S){if(l)throw"unexpected EOF";break}}r&&s(p+131072);for(var W=(1<<_)-1,E=(1<<C)-1,Q=a;;Q=a){var x=v[Kt(t,a)&W],j=x>>>4;if(a+=x&15,a>S){if(l)throw"unexpected EOF";break}if(!x)throw"invalid length/literal";if(j<256)e[p++]=j;else if(j==256){Q=a,v=null;break}else{var K=j-254;if(j>264){var d=j-257,it=ye[d];K=et(t,a,(1<<it)-1)+Ae[d],a+=it}var xt=m[Kt(t,a)&E],vt=xt>>>4;if(!xt)throw"invalid distance";a+=xt&15;var o=Sn[vt];if(vt>3){var it=me[vt];o+=Kt(t,a)&(1<<it)-1,a+=it}if(a>S){if(l)throw"unexpected EOF";break}r&&s(p+131072);for(var st=p+K;p<st;p+=4)e[p]=e[p-o],e[p+1]=e[p+1-o],e[p+2]=e[p+2-o],e[p+3]=e[p+3-o];p=st}}n.l=v,n.p=Q,n.b=p,v&&(h=1,n.m=_,n.d=m,n.n=C)}while(!h);return p==e.length?e:Zt(e,0,p)};var ei=new Z(0);var ni=function(t,e){var n={};for(var i in t)n[i]=t[i];for(var i in e)n[i]=e[i];return n},On=function(t,e,n){for(var i=t(),r=t.toString(),l=r.slice(r.indexOf("[")+1,r.lastIndexOf("]")).replace(/ /g,"").split(","),s=0;s<i.length;++s){var h=i[s],a=l[s];if(typeof h=="function"){e+=";"+a+"=";var p=h.toString();if(h.prototype)if(p.indexOf("[native code]")!=-1){var v=p.indexOf(" ",8)+1;e+=p.slice(v,p.indexOf("(",v))}else{e+=p;for(var m in h.prototype)e+=";"+a+".prototype."+m+"="+h.prototype[m].toString()}else e+=p}else n[a]=h}return[e,n]},Yt=[],ri=function(t){var e=[];for(var n in t)(t[n]instanceof Z||t[n]instanceof ot||t[n]instanceof Tt)&&e.push((t[n]=new t[n].constructor(t[n])).buffer);return e},ii=function(t,e,n,i){var r;if(!Yt[n]){for(var l="",s={},h=t.length-1,a=0;a<h;++a)r=On(t[a],l,s),l=r[0],s=r[1];Yt[n]=On(t[h],l,s)}var p=ni({},Yt[n][1]);return Jr(Yt[n][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",n,p,ri(p),i)},si=function(){return[Z,ot,Tt,ye,me,An,Ae,Sn,xn,bn,jt,Et,Xt,et,Kt,Cn,Zt,Tn,we,Ln,Hn]};var Ln=function(t){return postMessage(t,[t.buffer])},Hn=function(t){return t&&t.size&&new Z(t.size)},ai=function(t,e,n,i,r,l){var s=ii(n,i,r,function(h,a){s.terminate(),l(h,a)});return s.postMessage([t,e],e.consume?[t.buffer]:[]),function(){s.terminate()}};var lt=function(t,e){return t[e]|t[e+1]<<8},rt=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},_e=function(t,e){return rt(t,e)+rt(t,e+4)*4294967296};function oi(t,e,n){if(n||(n=e,e={}),typeof n!="function")throw"no callback";return ai(t,e,[si],function(i){return Ln(we(i.data[0],Hn(i.data[1])))},1,n)}function we(t,e){return Tn(t,e)}var ms=typeof TextEncoder!="undefined"&&new TextEncoder,Ee=typeof TextDecoder!="undefined"&&new TextDecoder,li=0;try{Ee.decode(ei,{stream:!0}),li=1}catch(t){}var ui=function(t){for(var e="",n=0;;){var i=t[n++],r=(i>127)+(i>223)+(i>239);if(n+r>t.length)return[e,Zt(t,n-1)];r?r==3?(i=((i&15)<<18|(t[n++]&63)<<12|(t[n++]&63)<<6|t[n++]&63)-65536,e+=String.fromCharCode(55296|i>>10,56320|i&1023)):r&1?e+=String.fromCharCode((i&31)<<6|t[n++]&63):e+=String.fromCharCode((i&15)<<12|(t[n++]&63)<<6|t[n++]&63):e+=String.fromCharCode(i)}};function hi(t,e){if(e){for(var n="",i=0;i<t.length;i+=16384)n+=String.fromCharCode.apply(null,t.subarray(i,i+16384));return n}else{if(Ee)return Ee.decode(t);var r=ui(t),l=r[0],s=r[1];if(s.length)throw"invalid utf-8 data";return l}}var ci=function(t,e){return e+30+lt(t,e+26)+lt(t,e+28)},pi=function(t,e,n){var i=lt(t,e+28),r=hi(t.subarray(e+46,e+46+i),!(lt(t,e+8)&2048)),l=e+46+i,s=rt(t,e+20),h=n&&s==4294967295?fi(t,l):[s,rt(t,e+24),rt(t,e+42)],a=h[0],p=h[1],v=h[2];return[lt(t,e+10),a,p,r,l+lt(t,e+30)+lt(t,e+32),v]},fi=function(t,e){for(;lt(t,e)!=1;e+=4+lt(t,e+2));return[_e(t,e+12),_e(t,e+4),_e(t,e+20)]};function $n(t,e){if(typeof e!="function")throw"no callback";for(var n=[],i=function(){for(var _=0;_<n.length;++_)n[_]()},r={},l=t.length-22;rt(t,l)!=101010256;--l)if(!l||t.length-l>65558){e("invalid zip file",null);return}var s=lt(t,l+8);s||e(null,{});var h=s,a=rt(t,l+16),p=a==4294967295;if(p){if(l=rt(t,l-12),rt(t,l)!=101075792){e("invalid zip file",null);return}h=s=rt(t,l+32),a=rt(t,l+48)}for(var v=function(_){var C=pi(t,a,p),S=C[0],b=C[1],M=C[2],X=C[3],G=C[4],T=C[5],F=ci(t,T);a=G;var $=function(P,d){P?(i(),e(P,null)):(r[X]=d,--s||e(null,r))};if(!S)$(null,Zt(t,F,F+b));else if(S==8){var q=t.subarray(F,F+b);if(b<32e4)try{$(null,we(q,new Z(M)))}catch(P){$(P,null)}else n.push(oi(q,{size:M},$))}else $("unknown compression type "+S,null)},m=0;m<h;++m)v(m);return i}var Lt=class{constructor(e){let n;typeof e=="object"&&e instanceof Lt?n=e.source:n=String(e),this.source=n,this._re=(0,kn.makeRe)(n)}test(e){return this._re.test(e)}},gi=/^([_\w\d]+)\:\/\//,Se=5e3,nt={cache:{},loadings:{},defaults:[]};async function vi(t,e,n,i=Se){let{cache:r,loadings:l}=nt;if(t in r)return r[t];let s;if(t in l){if(s=l[t],s.active)return l[t].promise}else s=new Re(i),l[t]=s;let h=[s.promise];return gi.test(e)?h.push(In(e,i).then(a=>n(a)).then(a=>Ht(t,a))):h.push(fetch(e).then(a=>a.arrayBuffer()).then(a=>n(a)).then(a=>Ht(t,a))),await Promise.race(h)}async function di(t,e=void 0){let n="raw://",r=await(await fetch(t)).arrayBuffer();await new Promise((l,s)=>{$n(new Uint8Array(r),(h,a)=>{if(h)s(h);else{for(let[p,v]of Object.entries(a)){let m=p.indexOf("/");m>=0&&(p=p.substring(m+1));let _=n+p;Ht(_,v),e&&e(v,_,p)}l()}})})}async function yi(t,e=Se){let n=[];for(let i of t)n.push(i.load(e));await Promise.allSettled(n)}function Ht(t,e){let{cache:n,loadings:i}=nt;return n[t]=e,t in i&&(i[t].resolve(e),delete i[t]),e}function mi(t,e){let{defaults:n}=nt;typeof t=="string"&&(t=new Lt(t));let i=`__default://[${n.length}]`;Ht(i,e),n.push(new Pn(t,i))}function Ai(t){let{cache:e,loadings:n}=nt;t in n&&(n[t].reject(new Error("Stop loading to delete asset.")),delete n[t]),t in e&&delete e[t]}function wi(t=void 0,e={preserveDefault:!1}){let{preserveDefault:n}=e;typeof t=="string"&&(t=new Lt(t));let{cache:i,loadings:r,defaults:l}=nt;for(let[s,h]of Object.entries(r))(!t||t.test(s))&&(h.reject(new Error("Stop loading to clear all assets.")),delete r[s]);for(let s of Object.keys(i))(!t||t.test(s))&&delete i[s];n||(l.length=0)}async function In(t,e=Se){let{cache:n,loadings:i}=nt;if(t in n)return n[t];if(t in i)return i[t].promise;{let r=new Re(e);return i[t]=r,r.promise}}function Dn(t){let{defaults:e}=nt;for(let n of e)if(n.glob.test(t))return xe(n.uri);return null}function xe(t){return nt.cache[t]}function _i(t){return xe(t)||Dn(t)}function Ei(t){return Boolean(nt.cache[t])}function Si(){return Object.keys(nt.cache)}function Ri(t){return t in nt.cache}function xi(t){return t in nt.loadings}function bi(t,e){}var Pn=class{constructor(e,n){this.glob=e,this.uri=n}},Re=class{constructor(e){this.active=!1,this._resolve=null,this._reject=null,this._reason=null,this._value=null,this._timeoutHandle=Number.isFinite(e)&&e>0?setTimeout(()=>{this.reject(`Asset loading exceeded timeout of ${e} ms.`)},e):null,this._promise=new Promise((n,i)=>{this._value?n(this._value):this._resolve=n,this._reason?i(this._reason):this._reject=i})}get promise(){return this._promise}resolve(e){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._resolve?this._resolve(e):this._value=e}reject(e){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._reject?this._reject(e):this._reason=e}},ft=Object.freeze({__proto__:null,load:vi,loadAssetPack:di,loadAssetRefs:yi,cache:Ht,cacheDefault:mi,unload:Ai,clear:wi,getLoaded:In,getDefault:Dn,getCurrent:xe,get:_i,has:Ei,keys:Si,isAssetCached:Ri,isAssetLoading:xi,on:bi});async function Mn(t){let e=be.AUDIO_CONTEXT,n=await e.decodeAudioData(t);return new be(e,n)}var be=class{static get AUDIO_CONTEXT(){let e=new AudioContext;return Ci(e),Object.defineProperty(this,"AUDIO_CONTEXT",{value:e}),e}constructor(e,n){this.audioContext=e,this.audioBuffer=n,this._playing=!1,this._started=!1,this._source=null,this.onAudioSourceEnded=this.onAudioSourceEnded.bind(this)}onAudioSourceEnded(){this._playing=!1}play(e={}){let n=this.audioBuffer;if(!n)return;this._source&&this.destroy();let{pitch:i=0,gain:r=0,pan:l=0,loop:s=!1}=e,h=this.audioContext,a=h.createBufferSource();a.addEventListener("ended",this.onAudioSourceEnded),a.buffer=n,a.loop=s;let p=a;if(i&&(a.detune.value=i*100),r){let v=h.createGain();v.gain.value=r,p=p.connect(v)}if(l){let v=h.createStereoPanner();v.pan.value=l,p=p.connect(v)}p.connect(h.destination),a.start(),this._source=a,this._started=!0,this._playing=!0}pause(){this._source.stop(),this._playing=!1}destroy(){this._source&&this._source.disconnect(),this._source=null,this._started=!1,this._playing=!1}isStarted(){return this._started}isPlaying(){return this._playing}isPaused(){return this._started&&!this._playing}};function Ci(t){let e=()=>{t.state==="suspended"&&t.resume()};document.addEventListener("click",e)}var zn={};function pt(){return zn}async function Nn(){await Promise.all([St("start",ft.get("raw://start.wav")),St("dead",ft.get("raw://dead.wav")),St("pop",ft.get("raw://boop.wav")),St("music",ft.get("raw://music.wav")),St("shoot",ft.get("raw://click.wav")),St("boom",ft.get("raw://boom.wav"))])}async function St(t,e){let n=new ArrayBuffer(e.byteLength);new Uint8Array(n).set(e),zn[t]=await Mn(n)}var Ti=[2,4],Oi=[.3,1],Li=30;function Un(t,e){let n={x:[],y:[],size:[],speed:[],length:0,width:t,height:e};for(let i=0;i<Li;++i)n.x.push(y.range(0,t)),n.y.push(y.range(0,e)),n.size.push(y.range(...Ti)),n.speed.push(y.range(...Oi)),n.length++;return n}function Bn(t,e,n="white"){for(let i=0;i<e.length;++i){let r=e.x[i],l=e.y[i],s=e.size[i],h=s/2;t.fillStyle=n,t.fillRect(r-h,l-h,s,s)}}function Fn(t,e=1,n=0){let{length:i,width:r,height:l}=t;for(let s=0;s<i;++s){let h=e*t.speed[s],a=n*t.speed[s];t.x[s]+=h,t.y[s]+=a,h<0?t.x[s]<0&&(t.x[s]=r,t.y[s]=y.range(0,l)):h>0&&t.x[s]>r&&(t.x[s]=0,t.y[s]=y.range(0,l)),a<0?t.y[s]<0&&(t.x[s]=y.range(0,r),t.y[s]=l):a>0&&t.y[s]>l&&(t.x[s]=y.range(0,r),t.y[s]=0)}}var Hi=document.querySelector("#display"),L=Hi.canvas,$i=L.getContext("2d"),Ce=0,Qt={load:ki,start:Ii,update:Pi,render:Di};window.addEventListener("DOMContentLoaded",Mi);function Mi(){Qt.load().then(()=>{Qt.start(),Gn(Ce=performance.now())})}function Gn(t){requestAnimationFrame(Gn);let e=t-Ce;Ce=t,Qt.update(e),Qt.render($i)}var ut=5,$t=4,H=8,qn=[[-H,-H,H*2+L.width,H],[-H,0,H,L.height],[-H,L.height,H*2+L.width,H],[L.width,0,H,L.height]],Te=[3e3,1e4],zi=1,Ni=100,D=1,At=2,Vt=4,Ui=2e3,Bi=100,Wn=10,kt=4,jn=2,It=600,Xn=.1,Fi=["red","red","red","yellow","orange"],Kn=["blue","blue","blue","dodgerblue","gray","darkgray","yellow"],Gi=["gray","darkgray","lightgray"],qi="[ wasd_ ]",Zn=[-2,2],Yn=1.5,Wi=.1,ji=.4,Oe=.1,Qn=.02,Xi=.008,Ki=.1,Vn=.001,Zi="gold";var gt=4,Yi=["white","violet","violet"],Qi=30,Vi=.7,Le=!1;async function ki(){console.log("Loading..."),await ft.loadAssetPack("res.pack"),await Nn(),console.log("...loading complete!")}function Ii(){this.level=0,this.score=0,this.highScore=Number(localStorage.getItem("highscore")),this.flashScoreDelta=0,this.flashHighScoreDelta=0,this.flashShootDelta=0,this.player={scene:this,x:L.width/2,y:L.height/2,rotation:0,dx:0,dy:0,dr:0,left:0,right:0,up:0,down:0,cooldown:0,powerMode:0,shoot(){if(!(this.scene.bullets.length>Bi)&&!(this.cooldown>0)){if(this.powerMode>0){for(let t=-1;t<=1;++t){let e=this.rotation+t*Math.PI/4,n=Jn(this.scene,this.x-Math.cos(e)*ut,this.y-Math.sin(e)*ut,-Math.cos(e)*Vt+this.dx,-Math.sin(e)*Vt+this.dy);this.scene.bullets.push(n)}--this.powerMode}else{let t=Jn(this.scene,this.x-Math.cos(this.rotation)*ut,this.y-Math.sin(this.rotation)*ut,-Math.cos(this.rotation)*Vt+this.dx,-Math.sin(this.rotation)*Vt+this.dy);this.scene.bullets.push(t)}this.cooldown=Wn,pt().shoot.play()}}},this.asteroids=[],this.asteroidSpawner={scene:this,spawnTicks:Te[1],reset(){this.spawnTicks=Te[1]},spawn(){if(this.scene.asteroids.length>Ni)return;let t=y.choose(qn),e=Pt(this.scene,y.range(t[0],t[0]+t[2]),y.range(t[1],t[1]+t[3]),y.range(-D,D),y.range(-D,D),H);this.scene.asteroids.push(e)},update(t){this.scene.gamePause||(this.spawnTicks-=t,this.spawnTicks<=0&&(this.spawn(),this.spawnTicks=y.range(...Te)))}},this.bullets=[],this.particles=[],this.powerUps=[],this.powerUpSpawner={scene:this,reset(){},spawn(){let t=y.choose(qn),e=Ji(this.scene,y.range(t[0],t[0]+t[2]),y.range(t[1],t[1]+t[3]),y.range(-D,D),y.range(-D,D));this.scene.powerUps.push(e)},update(t){}},this.starfield=Un(L.width,L.height),this.gamePause=!0,this.showPlayer=!0,this.gameStart=!0,this.gameWait=!0,this.hint=qi,document.addEventListener("keydown",t=>ts.call(this,t.key)),document.addEventListener("keyup",t=>es.call(this,t.key))}function Pi(t){if(this.gamePause){for(let r of this.particles)r.age+=t,r.age>It?r.destroy():(r.x+=r.dx,r.y+=r.dy,Rt(r,kt*2,kt*2));return}let e=this.player.right-this.player.left,n=this.player.down-this.player.up,i=this.player.fire;this.player.dx+=n*Math.cos(this.player.rotation)*Qn,this.player.dy+=n*Math.sin(this.player.rotation)*Qn,this.player.dx*=1-Vn,this.player.dy*=1-Vn,this.player.dr+=e*Xi,this.player.dr*=1-Ki,this.player.x+=this.player.dx,this.player.y+=this.player.dy,this.player.rotation+=this.player.dr,--this.player.cooldown,Rt(this.player,ut*2,ut*2),i&&(this.player.shoot(),this.flashShootDelta=1),n&&rs(this,this.player.x,this.player.y,-n*Math.cos(this.player.rotation)*Yn,-n*Math.sin(this.player.rotation)*Yn,y.choose.bind(null,Gi));for(let r of this.bullets)r.age+=t,r.age>Ui?r.destroy():(r.x+=r.dx,r.y+=r.dy,Rt(r,At*2,At*2));for(let r of this.bullets)for(let l of this.asteroids)if(He(r,l,l.size)){this.flashScore=1,this.score++,this.score>this.highScore&&(this.flashHighScore=this.score-this.highScore,this.highScore=this.score,localStorage.setItem("highscore",this.highScore)),Jt(this,l.x,l.y,10,y.choose.bind(null,Kn)),pt().pop.play(),r.destroy(),l.breakUp(r.dx*Xn,r.dy*Xn);break}for(let r of this.particles)r.age+=t,r.age>It?r.destroy():(r.x+=r.dx,r.y+=r.dy,Rt(r,kt*2,kt*2));for(let r of this.asteroids)r.x+=r.dx,r.y+=r.dy,Rt(r,r.size*2,r.size*2);for(let r of this.asteroids)if(He(r,this.player,r.size+ut)){Jt(this,r.x,r.y,10,y.choose.bind(null,Kn)),r.destroy(),ns(this);break}for(let r of this.powerUps)r.x+=r.dx,r.y+=r.dy,Rt(r,gt*2,gt*2);for(let r of this.powerUps)if(He(r,this.player,gt+ut)){Jt(this,r.x,r.y,10,y.choose.bind(null,Yi)),r.destroy(),this.player.powerMode+=Qi;break}Fn(this.starfield),this.asteroidSpawner.update(t),this.powerUpSpawner.update(t),!this.gamePause&&this.asteroids.length<=0&&(this.gamePause=!0,this.showPlayer=!0,pt().start.play(),setTimeout(()=>this.gameWait=!0,1e3))}function Di(t){t.fillStyle="black",t.fillRect(0,0,L.width,L.height),Bn(t,this.starfield),t.fillStyle="rgba(255, 255, 255, 0.2)",t.textAlign="center",t.textBaseline="middle",t.font="16px sans-serif",t.fillText(this.hint,L.width/2,L.height/2-32),this.flashScore>0?(t.fillStyle=`rgba(255, 255, 255, ${this.flashScore+.2})`,this.flashScore-=Oe):t.fillStyle="rgba(255, 255, 255, 0.2)",t.font="48px sans-serif",t.fillText("= "+String(this.score).padStart(2,"0")+" =",L.width/2,L.height/2),this.flashHighScore>0?(t.fillStyle=`rgba(255, 255, 255, ${this.flashHighScore+.2})`,this.flashHighScore-=Oe):t.fillStyle="rgba(255, 255, 255, 0.2)",t.font="16px sans-serif",t.fillText(String(this.highScore).padStart(2,"0"),L.width/2,L.height/2+32),t.fillStyle="rgba(255, 255, 255, 0.2)",t.font="24px sans-serif",t.textAlign="right",t.fillText(Math.ceil(this.asteroidSpawner.spawnTicks/1e3),L.width,L.height-12);for(let e of this.asteroids)t.translate(e.x,e.y),t.rotate(e.rotation),t.fillStyle="slategray",t.fillRect(-e.size,-e.size,e.size*2,e.size*2),t.setTransform(1,0,0,1,0,0),te(t,e.x,e.y,e.size);for(let e of this.powerUps)t.translate(e.x,e.y),t.rotate(e.rotation),t.beginPath(),t.strokeStyle="violet",t.arc(0,0,gt,0,Math.PI*2),t.moveTo(-gt/2,0),t.lineTo(gt/2,0),t.moveTo(0,-gt/2),t.lineTo(0,gt/2),t.stroke(),t.setTransform(1,0,0,1,0,0),te(t,e.x,e.y,gt);for(let e of this.bullets)t.translate(e.x,e.y),t.rotate(e.rotation),t.fillStyle=Zi,t.fillRect(-At,-At,At*4,At*2),t.setTransform(1,0,0,1,0,0),te(t,e.x,e.y,At);for(let e of this.particles){t.translate(e.x,e.y),t.rotate(e.rotation),t.fillStyle=e.color;let n=kt*(1-e.age/It);t.fillRect(-n,-n,n*2,n*2),t.setTransform(1,0,0,1,0,0)}if(this.showPlayer){t.translate(this.player.x,this.player.y),t.rotate(this.player.rotation),t.fillStyle="white";let e=ut;t.fillRect(-e,-e,e*2,e*2);let n=-1,i=0,r=0;this.flashShootDelta>0?(t.fillStyle=`rgb(${200*this.flashShootDelta+55*Math.sin(performance.now()/(Wn*2))}, 0, 0)`,this.flashShootDelta-=Oe,r=this.flashShootDelta*2,n=this.flashShootDelta):t.fillStyle="black",t.fillRect(-e-r/2+n,-(e/4)-r/2+i,e+r,e/2+r),t.setTransform(1,0,0,1,0,0)}te(t,this.player.x,this.player.y,ut)}function Rt(t,e,n){t.x<-e&&(t.x=L.width),t.y<-n&&(t.y=L.height),t.x>L.width+e/2&&(t.x=-e),t.y>L.height+n/2&&(t.y=-n)}function He(t,e,n){let i=t.x-e.x,r=t.y-e.y;return i*i+r*r<=n*n}function te(t,e,n,i){!Le||(t.translate(e,n),t.beginPath(),t.arc(0,0,i,0,Math.PI*2),t.strokeStyle="lime",t.stroke(),t.setTransform(1,0,0,1,0,0))}function Ji(t,e,n,i,r){return{scene:t,x:e,y:n,dx:i,dy:r,rotation:Math.atan2(r,i),destroy(){this.scene.powerUps.splice(this.scene.powerUps.indexOf(this),1)}}}function Pt(t,e,n,i,r,l){return{scene:t,x:e,y:n,dx:i,dy:r,size:l,rotation:Math.atan2(r,i),breakUp(s=0,h=0){if(this.destroy(),this.size>$t){let a=[];a.push(Pt(this.scene,this.x+y.range(-H,H),this.y+y.range(-H,H),y.range(-D,D)+s,y.range(-D,D)+h,$t)),a.push(Pt(this.scene,this.x+y.range(-H,H),this.y+y.range(-H,H),y.range(-D,D)+s,y.range(-D,D)+h,$t)),a.push(Pt(this.scene,this.x+y.range(-H,H),this.y+y.range(-H,H),y.range(-D,D)+s,y.range(-D,D)+h,$t)),a.push(Pt(this.scene,this.x+y.range(-H,H),this.y+y.range(-H,H),y.range(-D,D)+s,y.range(-D,D)+h,$t)),this.scene.asteroids.push(...a)}},destroy(){this.scene.asteroids.splice(this.scene.asteroids.indexOf(this),1)}}}function Jn(t,e,n,i,r){return{scene:t,x:e,y:n,dx:i,dy:r,rotation:Math.atan2(r,i),age:0,destroy(){this.scene.bullets.splice(this.scene.bullets.indexOf(this),1)}}}function tr(t,e,n,i,r,l){return typeof l=="function"&&(l=l.call(null)),{scene:t,x:e,y:n,dx:i,dy:r,rotation:Math.atan2(r,i),age:0,color:l,destroy(){this.scene.particles.splice(this.scene.particles.indexOf(this),1)}}}function is(t){t.bullets.length=0,t.asteroids.length=0,t.particles.length=0,t.player.x=L.width/2,t.player.y=L.height/2,t.player.dx=0,t.player.dy=0,t.level++,t.gamePause=!1,t.showPlayer=!0;for(let e=0;e<zi*t.level;++e)t.asteroidSpawner.spawn();y.next()>Vi&&t.powerUpSpawner.spawn(),pt().music.isPlaying()||pt().music.play({loop:!0})}function ns(t){t.gamePause=!0,t.showPlayer=!1,Jt(t,t.player.x,t.player.y,100,y.choose.bind(null,Fi)),pt().dead.play(),pt().boom.play(),setTimeout(()=>t.gameStart=t.gameWait=!0,1e3)}function rs(t,e,n,i,r,l){if(y.next()>.3){let s=tr(t,e+y.range(...Zn),n+y.range(...Zn),i,r,l);s.age=y.range(It*Wi,It*ji),t.particles.push(s)}}function Jt(t,e,n,i=10,r){for(let l=0;l<i;++l)t.particles.push(tr(t,e,n,y.range(-1,1)*jn,y.range(-1,1)*jn,r))}function ts(t){switch(this.gameWait&&(this.gameStart&&(pt().music.play(),this.score=0,this.flashScore=!0,this.level=0,this.gameStart=!1,this.player.powerMode=0,this.powerUps.length=0,this.asteroidSpawner.reset(),this.powerUpSpawner.reset()),this.gameWait=!1,is(this)),t){case"w":case"ArrowUp":this.player.up=1;break;case"s":case"ArrowDown":this.player.down=1;break;case"a":case"ArrowLeft":this.player.left=1;break;case"d":case"ArrowRight":this.player.right=1;break;case" ":this.player.fire=1;break;case"\\":break;default:console.log(t)}}function es(t){switch(t){case"w":case"ArrowUp":this.player.up=0;break;case"s":case"ArrowDown":this.player.down=0;break;case"a":case"ArrowLeft":this.player.left=0;break;case"d":case"ArrowRight":this.player.right=0;break;case" ":this.player.fire=0;break;case"\\":Le=!Le;break;default:console.log(t)}}})();
//# sourceMappingURL=main.js.map
