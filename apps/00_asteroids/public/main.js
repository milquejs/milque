(()=>{var yr=Object.create,De=Object.defineProperty;var mr=Object.getOwnPropertyDescriptor;var wr=Object.getOwnPropertyNames;var Ar=Object.getPrototypeOf,Er=Object.prototype.hasOwnProperty;var Sr=e=>De(e,"__esModule",{value:!0});var _r=(e,t)=>()=>(e&&(t=e(e=0)),t),ve=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Mt=(e,t)=>{for(var n in t)De(e,n,{get:t[n],enumerable:!0})},br=(e,t,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of wr(t))!Er.call(e,s)&&s!=="default"&&De(e,s,{get:()=>t[s],enumerable:!(n=mr(t,s))||n.enumerable});return e},xr=e=>br(Sr(De(e!=null?yr(Ar(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var rn={};Mt(rn,{basename:()=>tn,default:()=>Or,delimiter:()=>Jt,dirname:()=>en,extname:()=>nn,isAbsolute:()=>ft,join:()=>Zt,normalize:()=>ht,relative:()=>Vt,resolve:()=>Be,sep:()=>Qt});function Yt(e,t){for(var n=0,s=e.length-1;s>=0;s--){var r=e[s];r==="."?e.splice(s,1):r===".."?(e.splice(s,1),n++):n&&(e.splice(s,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function Be(){for(var e="",t=!1,n=arguments.length-1;n>=-1&&!t;n--){var s=n>=0?arguments[n]:"/";if(typeof s!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!s)continue;e=s+"/"+e,t=s.charAt(0)==="/"}return e=Yt(ct(e.split("/"),function(r){return!!r}),!t).join("/"),(t?"/":"")+e||"."}function ht(e){var t=ft(e),n=Ir(e,-1)==="/";return e=Yt(ct(e.split("/"),function(s){return!!s}),!t).join("/"),!e&&!t&&(e="."),e&&n&&(e+="/"),(t?"/":"")+e}function ft(e){return e.charAt(0)==="/"}function Zt(){var e=Array.prototype.slice.call(arguments,0);return ht(ct(e,function(t,n){if(typeof t!="string")throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))}function Vt(e,t){e=Be(e).substr(1),t=Be(t).substr(1);function n(c){for(var d=0;d<c.length&&c[d]==="";d++);for(var y=c.length-1;y>=0&&c[y]==="";y--);return d>y?[]:c.slice(d,y-d+1)}for(var s=n(e.split("/")),r=n(t.split("/")),l=Math.min(s.length,r.length),i=l,a=0;a<l;a++)if(s[a]!==r[a]){i=a;break}for(var o=[],a=i;a<s.length;a++)o.push("..");return o=o.concat(r.slice(i)),o.join("/")}function en(e){var t=lt(e),n=t[0],s=t[1];return!n&&!s?".":(s&&(s=s.substr(0,s.length-1)),n+s)}function tn(e,t){var n=lt(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n}function nn(e){return lt(e)[3]}function ct(e,t){if(e.filter)return e.filter(t);for(var n=[],s=0;s<e.length;s++)t(e[s],s,e)&&n.push(e[s]);return n}var Lr,lt,Qt,Jt,Or,Ir,sn=_r(()=>{Lr=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,lt=function(e){return Lr.exec(e).slice(1)};Qt="/",Jt=":";Or={extname:nn,basename:tn,dirname:en,sep:Qt,delimiter:Jt,relative:Vt,join:Zt,isAbsolute:ft,normalize:ht,resolve:Be};Ir="ab".substr(-1)==="b"?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}});var Ue=ve((yi,ze)=>{var ye=(sn(),rn);if(ye&&ye.default){ze.exports=ye.default;for(let e in ye)ze.exports[e]=ye[e]}else ye&&(ze.exports=ye)});var Re=ve((mi,hn)=>{"use strict";var Nr=Ue(),oe="\\\\/",an=`[^${oe}]`,he="\\.",Hr="\\+",$r="\\?",Fe="\\/",kr="(?=.)",on="[^/]",pt=`(?:${Fe}|$)`,un=`(?:^|${Fe})`,dt=`${he}{1,2}${pt}`,Pr=`(?!${he})`,Dr=`(?!${un}${dt})`,Mr=`(?!${he}{0,1}${pt})`,Br=`(?!${dt})`,zr=`[^.${Fe}]`,Ur=`${on}*?`,ln={DOT_LITERAL:he,PLUS_LITERAL:Hr,QMARK_LITERAL:$r,SLASH_LITERAL:Fe,ONE_CHAR:kr,QMARK:on,END_ANCHOR:pt,DOTS_SLASH:dt,NO_DOT:Pr,NO_DOTS:Dr,NO_DOT_SLASH:Mr,NO_DOTS_SLASH:Br,QMARK_NO_DOT:zr,STAR:Ur,START_ANCHOR:un},Fr={...ln,SLASH_LITERAL:`[${oe}]`,QMARK:an,STAR:`${an}*?`,DOTS_SLASH:`${he}{1,2}(?:[${oe}]|$)`,NO_DOT:`(?!${he})`,NO_DOTS:`(?!(?:^|[${oe}])${he}{1,2}(?:[${oe}]|$))`,NO_DOT_SLASH:`(?!${he}{0,1}(?:[${oe}]|$))`,NO_DOTS_SLASH:`(?!${he}{1,2}(?:[${oe}]|$))`,QMARK_NO_DOT:`[^.${oe}]`,START_ANCHOR:`(?:^|[${oe}])`,END_ANCHOR:`(?:[${oe}]|$)`},Gr={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};hn.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:Gr,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:Nr.sep,extglobChars(e){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${e.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(e){return e===!0?Fr:ln}}});var Ge=ve(Q=>{"use strict";var qr=Ue(),Wr=!1,{REGEX_BACKSLASH:jr,REGEX_REMOVE_BACKSLASH:Xr,REGEX_SPECIAL_CHARS:Kr,REGEX_SPECIAL_CHARS_GLOBAL:Yr}=Re();Q.isObject=e=>e!==null&&typeof e=="object"&&!Array.isArray(e);Q.hasRegexChars=e=>Kr.test(e);Q.isRegexChar=e=>e.length===1&&Q.hasRegexChars(e);Q.escapeRegex=e=>e.replace(Yr,"\\$1");Q.toPosixSlashes=e=>e.replace(jr,"/");Q.removeBackslashes=e=>e.replace(Xr,t=>t==="\\"?"":t);Q.supportsLookbehinds=()=>{let e=process.version.slice(1).split(".").map(Number);return e.length===3&&e[0]>=9||e[0]===8&&e[1]>=10};Q.isWindows=e=>e&&typeof e.windows=="boolean"?e.windows:Wr===!0||qr.sep==="\\";Q.escapeLast=(e,t,n)=>{let s=e.lastIndexOf(t,n);return s===-1?e:e[s-1]==="\\"?Q.escapeLast(e,t,s-1):`${e.slice(0,s)}\\${e.slice(s)}`};Q.removePrefix=(e,t={})=>{let n=e;return n.startsWith("./")&&(n=n.slice(2),t.prefix="./"),n};Q.wrapOutput=(e,t={},n={})=>{let s=n.contains?"":"^",r=n.contains?"":"$",l=`${s}(?:${e})${r}`;return t.negated===!0&&(l=`(?:^(?!${l}).*$)`),l}});var mn=ve((Ai,yn)=>{"use strict";var fn=Ge(),{CHAR_ASTERISK:gt,CHAR_AT:Zr,CHAR_BACKWARD_SLASH:Ce,CHAR_COMMA:Vr,CHAR_DOT:vt,CHAR_EXCLAMATION_MARK:yt,CHAR_FORWARD_SLASH:cn,CHAR_LEFT_CURLY_BRACE:mt,CHAR_LEFT_PARENTHESES:wt,CHAR_LEFT_SQUARE_BRACKET:Qr,CHAR_PLUS:Jr,CHAR_QUESTION_MARK:pn,CHAR_RIGHT_CURLY_BRACE:es,CHAR_RIGHT_PARENTHESES:dn,CHAR_RIGHT_SQUARE_BRACKET:ts}=Re(),gn=e=>e===cn||e===Ce,vn=e=>{e.isPrefix!==!0&&(e.depth=e.isGlobstar?Infinity:1)},ns=(e,t)=>{let n=t||{},s=e.length-1,r=n.parts===!0||n.scanToEnd===!0,l=[],i=[],a=[],o=e,c=-1,d=0,y=0,S=!1,L=!1,_=!1,C=!1,N=!1,P=!1,F=!1,R=!1,q=!1,M=!1,X=0,z,v,w={value:"",depth:0,isGlob:!1},B=()=>c>=s,f=()=>o.charCodeAt(c+1),T=()=>(z=v,o.charCodeAt(++c));for(;c<s;){v=T();let W;if(v===Ce){F=w.backslashes=!0,v=T(),v===mt&&(P=!0);continue}if(P===!0||v===mt){for(X++;B()!==!0&&(v=T());){if(v===Ce){F=w.backslashes=!0,T();continue}if(v===mt){X++;continue}if(P!==!0&&v===vt&&(v=T())===vt){if(S=w.isBrace=!0,_=w.isGlob=!0,M=!0,r===!0)continue;break}if(P!==!0&&v===Vr){if(S=w.isBrace=!0,_=w.isGlob=!0,M=!0,r===!0)continue;break}if(v===es&&(X--,X===0)){P=!1,S=w.isBrace=!0,M=!0;break}}if(r===!0)continue;break}if(v===cn){if(l.push(c),i.push(w),w={value:"",depth:0,isGlob:!1},M===!0)continue;if(z===vt&&c===d+1){d+=2;continue}y=c+1;continue}if(n.noext!==!0&&(v===Jr||v===Zr||v===gt||v===pn||v===yt)===!0&&f()===wt){if(_=w.isGlob=!0,C=w.isExtglob=!0,M=!0,v===yt&&c===d&&(q=!0),r===!0){for(;B()!==!0&&(v=T());){if(v===Ce){F=w.backslashes=!0,v=T();continue}if(v===dn){_=w.isGlob=!0,M=!0;break}}continue}break}if(v===gt){if(z===gt&&(N=w.isGlobstar=!0),_=w.isGlob=!0,M=!0,r===!0)continue;break}if(v===pn){if(_=w.isGlob=!0,M=!0,r===!0)continue;break}if(v===Qr){for(;B()!==!0&&(W=T());){if(W===Ce){F=w.backslashes=!0,T();continue}if(W===ts){L=w.isBracket=!0,_=w.isGlob=!0,M=!0;break}}if(r===!0)continue;break}if(n.nonegate!==!0&&v===yt&&c===d){R=w.negated=!0,d++;continue}if(n.noparen!==!0&&v===wt){if(_=w.isGlob=!0,r===!0){for(;B()!==!0&&(v=T());){if(v===wt){F=w.backslashes=!0,v=T();continue}if(v===dn){M=!0;break}}continue}break}if(_===!0){if(M=!0,r===!0)continue;break}}n.noext===!0&&(C=!1,_=!1);let x=o,ee="",h="";d>0&&(ee=o.slice(0,d),o=o.slice(d),y-=d),x&&_===!0&&y>0?(x=o.slice(0,y),h=o.slice(y)):_===!0?(x="",h=o):x=o,x&&x!==""&&x!=="/"&&x!==o&&gn(x.charCodeAt(x.length-1))&&(x=x.slice(0,-1)),n.unescape===!0&&(h&&(h=fn.removeBackslashes(h)),x&&F===!0&&(x=fn.removeBackslashes(x)));let u={prefix:ee,input:e,start:d,base:x,glob:h,isBrace:S,isBracket:L,isGlob:_,isExtglob:C,isGlobstar:N,negated:R,negatedExtglob:q};if(n.tokens===!0&&(u.maxDepth=0,gn(v)||i.push(w),u.tokens=i),n.parts===!0||n.tokens===!0){let W;for(let b=0;b<l.length;b++){let V=W?W+1:d,j=l[b],K=e.slice(V,j);n.tokens&&(b===0&&d!==0?(i[b].isPrefix=!0,i[b].value=ee):i[b].value=K,vn(i[b]),u.maxDepth+=i[b].depth),(b!==0||K!=="")&&a.push(K),W=j}if(W&&W+1<e.length){let b=e.slice(W+1);a.push(b),n.tokens&&(i[i.length-1].value=b,vn(i[i.length-1]),u.maxDepth+=i[i.length-1].depth)}u.slashes=l,u.parts=a}return u};yn.exports=ns});var En=ve((Ei,An)=>{"use strict";var qe=Re(),te=Ge(),{MAX_LENGTH:We,POSIX_REGEX_SOURCE:rs,REGEX_NON_SPECIAL_CHARS:ss,REGEX_SPECIAL_CHARS_BACKREF:is,REPLACEMENTS:wn}=qe,as=(e,t)=>{if(typeof t.expandRange=="function")return t.expandRange(...e,t);e.sort();let n=`[${e.join("-")}]`;try{new RegExp(n)}catch(s){return e.map(r=>te.escapeRegex(r)).join("..")}return n},Ee=(e,t)=>`Missing ${e}: "${t}" - use "\\\\${t}" to match literal characters`,At=(e,t)=>{if(typeof e!="string")throw new TypeError("Expected a string");e=wn[e]||e;let n={...t},s=typeof n.maxLength=="number"?Math.min(We,n.maxLength):We,r=e.length;if(r>s)throw new SyntaxError(`Input length: ${r}, exceeds maximum allowed length: ${s}`);let l={type:"bos",value:"",output:n.prepend||""},i=[l],a=n.capture?"":"?:",o=te.isWindows(t),c=qe.globChars(o),d=qe.extglobChars(c),{DOT_LITERAL:y,PLUS_LITERAL:S,SLASH_LITERAL:L,ONE_CHAR:_,DOTS_SLASH:C,NO_DOT:N,NO_DOT_SLASH:P,NO_DOTS_SLASH:F,QMARK:R,QMARK_NO_DOT:q,STAR:M,START_ANCHOR:X}=c,z=g=>`(${a}(?:(?!${X}${g.dot?C:y}).)*?)`,v=n.dot?"":N,w=n.dot?R:q,B=n.bash===!0?z(n):M;n.capture&&(B=`(${B})`),typeof n.noext=="boolean"&&(n.noextglob=n.noext);let f={input:e,index:-1,start:0,dot:n.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:i};e=te.removePrefix(e,f),r=e.length;let T=[],x=[],ee=[],h=l,u,W=()=>f.index===r-1,b=f.peek=(g=1)=>e[f.index+g],V=f.advance=()=>e[++f.index]||"",j=()=>e.slice(f.index+1),K=(g="",H=0)=>{f.consumed+=g,f.index+=H},ie=g=>{f.output+=g.output!=null?g.output:g.value,K(g.value)},xe=()=>{let g=1;for(;b()==="!"&&(b(2)!=="("||b(3)==="?");)V(),f.start++,g++;return g%2==0?!1:(f.negated=!0,f.start++,!0)},pe=g=>{f[g]++,ee.push(g)},ae=g=>{f[g]--,ee.pop()},A=g=>{if(h.type==="globstar"){let H=f.braces>0&&(g.type==="comma"||g.type==="brace"),p=g.extglob===!0||T.length&&(g.type==="pipe"||g.type==="paren");g.type!=="slash"&&g.type!=="paren"&&!H&&!p&&(f.output=f.output.slice(0,-h.output.length),h.type="star",h.value="*",h.output=B,f.output+=h.output)}if(T.length&&g.type!=="paren"&&(T[T.length-1].inner+=g.value),(g.value||g.output)&&ie(g),h&&h.type==="text"&&g.type==="text"){h.value+=g.value,h.output=(h.output||"")+g.value;return}g.prev=h,i.push(g),h=g},ge=(g,H)=>{let p={...d[H],conditions:1,inner:""};p.prev=h,p.parens=f.parens,p.output=f.output;let E=(n.capture?"(":"")+p.open;pe("parens"),A({type:g,value:H,output:f.output?"":_}),A({type:"paren",extglob:!0,value:V(),output:E}),T.push(p)},ke=g=>{let H=g.close+(n.capture?")":""),p;if(g.type==="negate"){let E=B;if(g.inner&&g.inner.length>1&&g.inner.includes("/")&&(E=z(n)),(E!==B||W()||/^\)+$/.test(j()))&&(H=g.close=`)$))${E}`),g.inner.includes("*")&&(p=j())&&/^\.[^\\/.]+$/.test(p)){let D=At(p,{...t,fastpaths:!1}).output;H=g.close=`)${D})${E})`}g.prev.type==="bos"&&(f.negatedExtglob=!0)}A({type:"paren",extglob:!0,value:u,output:H}),ae("parens")};if(n.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(e)){let g=!1,H=e.replace(is,(p,E,D,Y,G,at)=>Y==="\\"?(g=!0,p):Y==="?"?E?E+Y+(G?R.repeat(G.length):""):at===0?w+(G?R.repeat(G.length):""):R.repeat(D.length):Y==="."?y.repeat(D.length):Y==="*"?E?E+Y+(G?B:""):B:E?p:`\\${p}`);return g===!0&&(n.unescape===!0?H=H.replace(/\\/g,""):H=H.replace(/\\+/g,p=>p.length%2==0?"\\\\":p?"\\":"")),H===e&&n.contains===!0?(f.output=e,f):(f.output=te.wrapOutput(H,f,t),f)}for(;!W();){if(u=V(),u==="\0")continue;if(u==="\\"){let p=b();if(p==="/"&&n.bash!==!0||p==="."||p===";")continue;if(!p){u+="\\",A({type:"text",value:u});continue}let E=/^\\+/.exec(j()),D=0;if(E&&E[0].length>2&&(D=E[0].length,f.index+=D,D%2!=0&&(u+="\\")),n.unescape===!0?u=V():u+=V(),f.brackets===0){A({type:"text",value:u});continue}}if(f.brackets>0&&(u!=="]"||h.value==="["||h.value==="[^")){if(n.posix!==!1&&u===":"){let p=h.value.slice(1);if(p.includes("[")&&(h.posix=!0,p.includes(":"))){let E=h.value.lastIndexOf("["),D=h.value.slice(0,E),Y=h.value.slice(E+2),G=rs[Y];if(G){h.value=D+G,f.backtrack=!0,V(),!l.output&&i.indexOf(h)===1&&(l.output=_);continue}}}(u==="["&&b()!==":"||u==="-"&&b()==="]")&&(u=`\\${u}`),u==="]"&&(h.value==="["||h.value==="[^")&&(u=`\\${u}`),n.posix===!0&&u==="!"&&h.value==="["&&(u="^"),h.value+=u,ie({value:u});continue}if(f.quotes===1&&u!=='"'){u=te.escapeRegex(u),h.value+=u,ie({value:u});continue}if(u==='"'){f.quotes=f.quotes===1?0:1,n.keepQuotes===!0&&A({type:"text",value:u});continue}if(u==="("){pe("parens"),A({type:"paren",value:u});continue}if(u===")"){if(f.parens===0&&n.strictBrackets===!0)throw new SyntaxError(Ee("opening","("));let p=T[T.length-1];if(p&&f.parens===p.parens+1){ke(T.pop());continue}A({type:"paren",value:u,output:f.parens?")":"\\)"}),ae("parens");continue}if(u==="["){if(n.nobracket===!0||!j().includes("]")){if(n.nobracket!==!0&&n.strictBrackets===!0)throw new SyntaxError(Ee("closing","]"));u=`\\${u}`}else pe("brackets");A({type:"bracket",value:u});continue}if(u==="]"){if(n.nobracket===!0||h&&h.type==="bracket"&&h.value.length===1){A({type:"text",value:u,output:`\\${u}`});continue}if(f.brackets===0){if(n.strictBrackets===!0)throw new SyntaxError(Ee("opening","["));A({type:"text",value:u,output:`\\${u}`});continue}ae("brackets");let p=h.value.slice(1);if(h.posix!==!0&&p[0]==="^"&&!p.includes("/")&&(u=`/${u}`),h.value+=u,ie({value:u}),n.literalBrackets===!1||te.hasRegexChars(p))continue;let E=te.escapeRegex(h.value);if(f.output=f.output.slice(0,-h.value.length),n.literalBrackets===!0){f.output+=E,h.value=E;continue}h.value=`(${a}${E}|${h.value})`,f.output+=h.value;continue}if(u==="{"&&n.nobrace!==!0){pe("braces");let p={type:"brace",value:u,output:"(",outputIndex:f.output.length,tokensIndex:f.tokens.length};x.push(p),A(p);continue}if(u==="}"){let p=x[x.length-1];if(n.nobrace===!0||!p){A({type:"text",value:u,output:u});continue}let E=")";if(p.dots===!0){let D=i.slice(),Y=[];for(let G=D.length-1;G>=0&&(i.pop(),D[G].type!=="brace");G--)D[G].type!=="dots"&&Y.unshift(D[G].value);E=as(Y,n),f.backtrack=!0}if(p.comma!==!0&&p.dots!==!0){let D=f.output.slice(0,p.outputIndex),Y=f.tokens.slice(p.tokensIndex);p.value=p.output="\\{",u=E="\\}",f.output=D;for(let G of Y)f.output+=G.output||G.value}A({type:"brace",value:u,output:E}),ae("braces"),x.pop();continue}if(u==="|"){T.length>0&&T[T.length-1].conditions++,A({type:"text",value:u});continue}if(u===","){let p=u,E=x[x.length-1];E&&ee[ee.length-1]==="braces"&&(E.comma=!0,p="|"),A({type:"comma",value:u,output:p});continue}if(u==="/"){if(h.type==="dot"&&f.index===f.start+1){f.start=f.index+1,f.consumed="",f.output="",i.pop(),h=l;continue}A({type:"slash",value:u,output:L});continue}if(u==="."){if(f.braces>0&&h.type==="dot"){h.value==="."&&(h.output=y);let p=x[x.length-1];h.type="dots",h.output+=u,h.value+=u,p.dots=!0;continue}if(f.braces+f.parens===0&&h.type!=="bos"&&h.type!=="slash"){A({type:"text",value:u,output:y});continue}A({type:"dot",value:u,output:y});continue}if(u==="?"){if(!(h&&h.value==="(")&&n.noextglob!==!0&&b()==="("&&b(2)!=="?"){ge("qmark",u);continue}if(h&&h.type==="paren"){let E=b(),D=u;if(E==="<"&&!te.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(h.value==="("&&!/[!=<:]/.test(E)||E==="<"&&!/<([!=]|\w+>)/.test(j()))&&(D=`\\${u}`),A({type:"text",value:u,output:D});continue}if(n.dot!==!0&&(h.type==="slash"||h.type==="bos")){A({type:"qmark",value:u,output:q});continue}A({type:"qmark",value:u,output:R});continue}if(u==="!"){if(n.noextglob!==!0&&b()==="("&&(b(2)!=="?"||!/[!=<:]/.test(b(3)))){ge("negate",u);continue}if(n.nonegate!==!0&&f.index===0){xe();continue}}if(u==="+"){if(n.noextglob!==!0&&b()==="("&&b(2)!=="?"){ge("plus",u);continue}if(h&&h.value==="("||n.regex===!1){A({type:"plus",value:u,output:S});continue}if(h&&(h.type==="bracket"||h.type==="paren"||h.type==="brace")||f.parens>0){A({type:"plus",value:u});continue}A({type:"plus",value:S});continue}if(u==="@"){if(n.noextglob!==!0&&b()==="("&&b(2)!=="?"){A({type:"at",extglob:!0,value:u,output:""});continue}A({type:"text",value:u});continue}if(u!=="*"){(u==="$"||u==="^")&&(u=`\\${u}`);let p=ss.exec(j());p&&(u+=p[0],f.index+=p[0].length),A({type:"text",value:u});continue}if(h&&(h.type==="globstar"||h.star===!0)){h.type="star",h.star=!0,h.value+=u,h.output=B,f.backtrack=!0,f.globstar=!0,K(u);continue}let g=j();if(n.noextglob!==!0&&/^\([^?]/.test(g)){ge("star",u);continue}if(h.type==="star"){if(n.noglobstar===!0){K(u);continue}let p=h.prev,E=p.prev,D=p.type==="slash"||p.type==="bos",Y=E&&(E.type==="star"||E.type==="globstar");if(n.bash===!0&&(!D||g[0]&&g[0]!=="/")){A({type:"star",value:u,output:""});continue}let G=f.braces>0&&(p.type==="comma"||p.type==="brace"),at=T.length&&(p.type==="pipe"||p.type==="paren");if(!D&&p.type!=="paren"&&!G&&!at){A({type:"star",value:u,output:""});continue}for(;g.slice(0,3)==="/**";){let Pe=e[f.index+4];if(Pe&&Pe!=="/")break;g=g.slice(3),K("/**",3)}if(p.type==="bos"&&W()){h.type="globstar",h.value+=u,h.output=z(n),f.output=h.output,f.globstar=!0,K(u);continue}if(p.type==="slash"&&p.prev.type!=="bos"&&!Y&&W()){f.output=f.output.slice(0,-(p.output+h.output).length),p.output=`(?:${p.output}`,h.type="globstar",h.output=z(n)+(n.strictSlashes?")":"|$)"),h.value+=u,f.globstar=!0,f.output+=p.output+h.output,K(u);continue}if(p.type==="slash"&&p.prev.type!=="bos"&&g[0]==="/"){let Pe=g[1]!==void 0?"|$":"";f.output=f.output.slice(0,-(p.output+h.output).length),p.output=`(?:${p.output}`,h.type="globstar",h.output=`${z(n)}${L}|${L}${Pe})`,h.value+=u,f.output+=p.output+h.output,f.globstar=!0,K(u+V()),A({type:"slash",value:"/",output:""});continue}if(p.type==="bos"&&g[0]==="/"){h.type="globstar",h.value+=u,h.output=`(?:^|${L}|${z(n)}${L})`,f.output=h.output,f.globstar=!0,K(u+V()),A({type:"slash",value:"/",output:""});continue}f.output=f.output.slice(0,-h.output.length),h.type="globstar",h.output=z(n),h.value+=u,f.output+=h.output,f.globstar=!0,K(u);continue}let H={type:"star",value:u,output:B};if(n.bash===!0){H.output=".*?",(h.type==="bos"||h.type==="slash")&&(H.output=v+H.output),A(H);continue}if(h&&(h.type==="bracket"||h.type==="paren")&&n.regex===!0){H.output=u,A(H);continue}(f.index===f.start||h.type==="slash"||h.type==="dot")&&(h.type==="dot"?(f.output+=P,h.output+=P):n.dot===!0?(f.output+=F,h.output+=F):(f.output+=v,h.output+=v),b()!=="*"&&(f.output+=_,h.output+=_)),A(H)}for(;f.brackets>0;){if(n.strictBrackets===!0)throw new SyntaxError(Ee("closing","]"));f.output=te.escapeLast(f.output,"["),ae("brackets")}for(;f.parens>0;){if(n.strictBrackets===!0)throw new SyntaxError(Ee("closing",")"));f.output=te.escapeLast(f.output,"("),ae("parens")}for(;f.braces>0;){if(n.strictBrackets===!0)throw new SyntaxError(Ee("closing","}"));f.output=te.escapeLast(f.output,"{"),ae("braces")}if(n.strictSlashes!==!0&&(h.type==="star"||h.type==="bracket")&&A({type:"maybe_slash",value:"",output:`${L}?`}),f.backtrack===!0){f.output="";for(let g of f.tokens)f.output+=g.output!=null?g.output:g.value,g.suffix&&(f.output+=g.suffix)}return f};At.fastpaths=(e,t)=>{let n={...t},s=typeof n.maxLength=="number"?Math.min(We,n.maxLength):We,r=e.length;if(r>s)throw new SyntaxError(`Input length: ${r}, exceeds maximum allowed length: ${s}`);e=wn[e]||e;let l=te.isWindows(t),{DOT_LITERAL:i,SLASH_LITERAL:a,ONE_CHAR:o,DOTS_SLASH:c,NO_DOT:d,NO_DOTS:y,NO_DOTS_SLASH:S,STAR:L,START_ANCHOR:_}=qe.globChars(l),C=n.dot?y:d,N=n.dot?S:d,P=n.capture?"":"?:",F={negated:!1,prefix:""},R=n.bash===!0?".*?":L;n.capture&&(R=`(${R})`);let q=v=>v.noglobstar===!0?R:`(${P}(?:(?!${_}${v.dot?c:i}).)*?)`,M=v=>{switch(v){case"*":return`${C}${o}${R}`;case".*":return`${i}${o}${R}`;case"*.*":return`${C}${R}${i}${o}${R}`;case"*/*":return`${C}${R}${a}${o}${N}${R}`;case"**":return C+q(n);case"**/*":return`(?:${C}${q(n)}${a})?${N}${o}${R}`;case"**/*.*":return`(?:${C}${q(n)}${a})?${N}${R}${i}${o}${R}`;case"**/.*":return`(?:${C}${q(n)}${a})?${i}${o}${R}`;default:{let w=/^(.*?)\.(\w+)$/.exec(v);if(!w)return;let B=M(w[1]);return B?B+i+w[2]:void 0}}},X=te.removePrefix(e,F),z=M(X);return z&&n.strictSlashes!==!0&&(z+=`${a}?`),z};An.exports=At});var _n=ve((Si,Sn)=>{"use strict";var os=Ue(),us=mn(),Et=En(),St=Ge(),ls=Re(),hs=e=>e&&typeof e=="object"&&!Array.isArray(e),U=(e,t,n=!1)=>{if(Array.isArray(e)){let d=e.map(S=>U(S,t,n));return S=>{for(let L of d){let _=L(S);if(_)return _}return!1}}let s=hs(e)&&e.tokens&&e.input;if(e===""||typeof e!="string"&&!s)throw new TypeError("Expected pattern to be a non-empty string");let r=t||{},l=St.isWindows(t),i=s?U.compileRe(e,t):U.makeRe(e,t,!1,!0),a=i.state;delete i.state;let o=()=>!1;if(r.ignore){let d={...t,ignore:null,onMatch:null,onResult:null};o=U(r.ignore,d,n)}let c=(d,y=!1)=>{let{isMatch:S,match:L,output:_}=U.test(d,i,t,{glob:e,posix:l}),C={glob:e,state:a,regex:i,posix:l,input:d,output:_,match:L,isMatch:S};return typeof r.onResult=="function"&&r.onResult(C),S===!1?(C.isMatch=!1,y?C:!1):o(d)?(typeof r.onIgnore=="function"&&r.onIgnore(C),C.isMatch=!1,y?C:!1):(typeof r.onMatch=="function"&&r.onMatch(C),y?C:!0)};return n&&(c.state=a),c};U.test=(e,t,n,{glob:s,posix:r}={})=>{if(typeof e!="string")throw new TypeError("Expected input to be a string");if(e==="")return{isMatch:!1,output:""};let l=n||{},i=l.format||(r?St.toPosixSlashes:null),a=e===s,o=a&&i?i(e):e;return a===!1&&(o=i?i(e):e,a=o===s),(a===!1||l.capture===!0)&&(l.matchBase===!0||l.basename===!0?a=U.matchBase(e,t,n,r):a=t.exec(o)),{isMatch:Boolean(a),match:a,output:o}};U.matchBase=(e,t,n,s=St.isWindows(n))=>(t instanceof RegExp?t:U.makeRe(t,n)).test(os.basename(e));U.isMatch=(e,t,n)=>U(t,n)(e);U.parse=(e,t)=>Array.isArray(e)?e.map(n=>U.parse(n,t)):Et(e,{...t,fastpaths:!1});U.scan=(e,t)=>us(e,t);U.compileRe=(e,t,n=!1,s=!1)=>{if(n===!0)return e.output;let r=t||{},l=r.contains?"":"^",i=r.contains?"":"$",a=`${l}(?:${e.output})${i}`;e&&e.negated===!0&&(a=`^(?!${a}).*$`);let o=U.toRegex(a,t);return s===!0&&(o.state=e),o};U.makeRe=(e,t={},n=!1,s=!1)=>{if(!e||typeof e!="string")throw new TypeError("Expected a non-empty string");let r={negated:!1,fastpaths:!0};return t.fastpaths!==!1&&(e[0]==="."||e[0]==="*")&&(r.output=Et.fastpaths(e,t)),r.output||(r=Et(e,t)),U.compileRe(r,t,n,s)};U.toRegex=(e,t)=>{try{let n=t||{};return new RegExp(e,n.flags||(n.nocase?"i":""))}catch(n){if(t&&t.debug===!0)throw n;return/$^/}};U.constants=ls;Sn.exports=U});var xn=ve((_i,bn)=>{"use strict";bn.exports=_n()});var Rr=`<div class="container">
  <label class="hidden" id="title">display-port</label>
  <label class="hidden" id="fps">00</label>
  <label class="hidden" id="dimension">0x0</label>
  <div class="content">
    <canvas> Oh no! Your browser does not support canvas. </canvas>
    <slot id="inner"></slot>
  </div>
  <slot name="frame"></slot>
</div>
`,Cr=`:host {
  display: inline-block;
  color: #555555;
}

.container {
  display: flex;
  position: relative;
  width: 100%;
  height: 100%;
}

.content {
  position: relative;
  margin: auto;
}

.content > *:not(canvas) {
  width: 100%;
  height: 100%;
}

canvas {
  background: #000000;
  image-rendering: pixelated;
}

label {
  position: absolute;
  font-family: monospace;
  color: currentColor;
}

#inner {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: 0;
  left: 0;
  pointer-events: none;
}

#title {
  left: 0.5rem;
  top: 0.5rem;
}

#fps {
  right: 0.5rem;
  top: 0.5rem;
}

#dimension {
  left: 0.5rem;
  bottom: 0.5rem;
}

.hidden {
  display: none;
}

:host([debug]) .container {
  outline: 6px dashed rgba(0, 0, 0, 0.1);
  outline-offset: -4px;
  background-color: rgba(0, 0, 0, 0.1);
}

:host([mode='noscale']) canvas {
  margin: 0;
  top: 0;
  left: 0;
}

:host([mode='stretch']) canvas,
:host([mode='scale']) canvas {
  width: 100%;
  height: 100%;
}

:host([mode='fit']),
:host([mode='scale']),
:host([mode='center']),
:host([mode='stretch']),
:host([mode='fill']) {
  width: 100%;
  height: 100%;
}

:host([full]) {
  width: 100vw !important;
  height: 100vh !important;
}

:host([disabled]) {
  display: none;
}

slot {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  pointer-events: none;
}

::slotted(*) {
  pointer-events: auto;
}
`,Bt="noscale";var ot="fit",zt="scale",Ut="fill",Ft="stretch",Gt=300,qt=150,Wt=ot,Tr=200,Me=class extends HTMLElement{static create(t={}){let{root:n=document.body,mode:s=Wt,width:r=Gt,height:l=qt,debug:i=!1}=t||{},a=new Me;return a.mode=s,a.width=r,a.height=l,a.debug=i,n.appendChild(a),a}static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=Rr,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Cr,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("display-port",this)}static get observedAttributes(){return["debug","disabled","width","height","onframe","id","class"]}get mode(){return this.getAttribute("mode")}set mode(t){this.setAttribute("mode",t)}get debug(){return this._debug}set debug(t){this.toggleAttribute("debug",t)}get disabled(){return this._disabled}set disabled(t){this.toggleAttribute("disabled",t)}get width(){return this._width}set width(t){this.setAttribute("width",String(t))}get height(){return this._height}set height(t){this.setAttribute("height",String(t))}get onframe(){return this._onframe}set onframe(t){this._onframe&&this.removeEventListener("frame",this._onframe),this._onframe=t,this._onframe&&this.addEventListener("frame",t)}constructor(){super();let t=this.attachShadow({mode:"open"});t.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),t.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._canvasElement=t.querySelector("canvas"),this._contentElement=t.querySelector(".content"),this._innerElement=t.querySelector("#inner"),this._titleElement=t.querySelector("#title"),this._fpsElement=t.querySelector("#fps"),this._dimensionElement=t.querySelector("#dimension"),this._debug=!1,this._disabled=!1,this._width=Gt,this._height=qt,this._onframe=void 0,this._animationRequestHandle=0,this._prevAnimationFrameTime=0,this._resizeTimeoutHandle=0,this._resizeCanvasWidth=0,this._resizeCanvasHeight=0,this._frameEvent=new CustomEvent("frame",{composed:!0,bubbles:!1,detail:{now:0,prevTime:0,deltaTime:0,canvas:this._canvasElement}}),this._resizeEvent=new CustomEvent("resize",{composed:!0,bubbles:!1,detail:{width:0,height:0}}),this.update=this.update.bind(this),this.onDelayCanvasResize=this.onDelayCanvasResize.bind(this)}get canvas(){return this._canvasElement}connectedCallback(){Ae(this,"mode"),Ae(this,"debug"),Ae(this,"disabled"),Ae(this,"width"),Ae(this,"height"),Ae(this,"onframe"),this.hasAttribute("mode")||this.setAttribute("mode",Wt),this.hasAttribute("tabindex")||this.setAttribute("tabindex","0"),this.updateCanvasSize(!0),this.resume()}disconnectedCallback(){this.pause()}attributeChangedCallback(t,n,s){switch(t){case"debug":this._debug=s!==null;break;case"disabled":this._disabled=s!==null;break;case"width":this._width=Number(s);break;case"height":this._height=Number(s);break;case"onframe":this.onframe=new Function("event","with(document){with(this){"+s+"}}").bind(this);break}switch(t){case"disabled":s?(this.update(0),this.pause()):this.resume();break;case"id":case"class":this._titleElement.innerHTML=`display-port${this.className?"."+this.className:""}${this.hasAttribute("id")?"#"+this.getAttribute("id"):""}`;break;case"debug":this._titleElement.classList.toggle("hidden",s),this._fpsElement.classList.toggle("hidden",s),this._dimensionElement.classList.toggle("hidden",s);break}}getContext(t="2d",n=void 0){return this._canvasElement.getContext(t,n)}pause(){window.cancelAnimationFrame(this._animationRequestHandle)}resume(){this._animationRequestHandle=window.requestAnimationFrame(this.update)}update(t){this._animationRequestHandle=window.requestAnimationFrame(this.update),this.updateCanvasSize(!1);let n=t-this._prevAnimationFrameTime;if(this._prevAnimationFrameTime=t,this._debug){let l=n<=0?"--":String(Math.round(1e3/n)).padStart(2,"0");if(this._fpsElement.textContent!==l&&(this._fpsElement.textContent=l),this.mode===Bt){let a=`${this._width}x${this._height}`;this._dimensionElement.textContent!==a&&(this._dimensionElement.textContent=a)}else{let a=`${this._width}x${this._height}|${this.shadowRoot.host.clientWidth}x${this.shadowRoot.host.clientHeight}`;this._dimensionElement.textContent!==a&&(this._dimensionElement.textContent=a)}}let r=this._frameEvent.detail;r.now=t,r.prevTime=this._prevAnimationFrameTime,r.deltaTime=n,this.dispatchEvent(this._frameEvent)}onDelayCanvasResize(){this._resizeTimeoutHandle=null,this.updateCanvasSize(!0)}delayCanvasResize(t,n){(t!==this._resizeCanvasWidth||n!==this._resizeCanvasHeight)&&(this._resizeCanvasWidth=t,this._resizeCanvasHeight=n,this._resizeTimeoutHandle&&window.clearTimeout(this._resizeTimeoutHandle),this._resizeTimeoutHandle=window.setTimeout(this.onDelayCanvasResize,Tr))}updateCanvasSize(t=!0){let n=this.shadowRoot.host.getBoundingClientRect(),s=n.width,r=n.height,l=this._canvasElement,i=this._width,a=this._height,o=this.mode;if(o===Ft||o===Ut)i=s,a=r;else if(o!==Bt&&(s<i||r<a||o===ot||o==zt)){let d=s/i,y=r/a;d<y?(i=s,a=a*d):(i=i*y,a=r)}if(i=Math.floor(i),a=Math.floor(a),typeof t=="undefined"&&(t=l.clientWidth!==i||l.clientHeight!==a),!t){this.delayCanvasResize(i,a);return}let c=Math.min(i/this._width,a/this._height)*.5;if(this._innerElement.style.fontSize=`font-size: ${c}em`,t){o===zt?(l.width=this._width,l.height=this._height):o!==Ft&&(l.width=i,l.height=a);let d=this._contentElement.style;d.width=`${i}px`,d.height=`${a}px`,(o===ot||o===Ut)&&(this._width=i,this._height=a);let S=this._resizeEvent.detail;S.width=i,S.height=a,this.dispatchEvent(this._resizeEvent)}}};Me.define();function Ae(e,t){if(Object.prototype.hasOwnProperty.call(e,t)){let n=e[t];delete e[t],e[t]=n}}var ut=class{next(){return 0}},jt=class extends ut{next(){return Math.random()}},Xt=class extends ut{constructor(t){super();this.seed=t,this.a=t}next(){var t=this.a+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}},m=class{static get RAND(){let t=new this;return this.next=this.next.bind(this),this.choose=this.choose.bind(this),this.range=this.range.bind(this),this.rangeInt=this.rangeInt.bind(this),this.sign=this.sign.bind(this),Object.defineProperty(this,"RAND",{value:t}),t}constructor(t=void 0){typeof t=="number"?this.generator=new Xt(t):t?this.generator=t:this.generator=new jt,this.next=this.next.bind(this),this.choose=this.choose.bind(this),this.range=this.range.bind(this),this.rangeInt=this.rangeInt.bind(this),this.sign=this.sign.bind(this)}static next(){return this.RAND.next()}next(){return this.generator.next()}static choose(t){return this.RAND.choose(t)}choose(t){return t[Math.floor(this.generator.next()*t.length)]}static range(t,n){return this.RAND.range(t,n)}range(t,n){return(n-t)*this.generator.next()+t}static rangeInt(t,n){return this.RAND.rangeInt(t,n)}rangeInt(t,n){return Math.trunc(this.range(t,n))}static sign(){return this.RAND.sign()}sign(){return this.generator.next()<.5?-1:1}};window.addEventListener("error",Kt,!0);window.addEventListener("unhandledrejection",Kt,!0);function Kt(e){e instanceof PromiseRejectionEvent?window.alert(e.reason.stack):e instanceof ErrorEvent?window.alert(e.error.stack):window.alert(JSON.stringify(e))}var Ht={};Mt(Ht,{BackgroundMusic:()=>Je,SoundBoom:()=>nr,SoundDead:()=>Jn,SoundPop:()=>er,SoundShoot:()=>tr,SoundStart:()=>Qn});var Gn=xr(xn());var Rn={},fs=function(e,t,n,s,r){var l=new Worker(Rn[t]||(Rn[t]=URL.createObjectURL(new Blob([e+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return l.onmessage=function(i){var a=i.data,o=a.$e$;if(o){var c=new Error(o[0]);c.code=o[1],c.stack=o[2],r(c,null)}else r(null,a)},l.postMessage(n,s),l},Z=Uint8Array,de=Uint16Array,_t=Uint32Array,bt=new Z([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),xt=new Z([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Cn=new Z([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Tn=function(e,t){for(var n=new de(31),s=0;s<31;++s)n[s]=t+=1<<e[s-1];for(var r=new _t(n[30]),s=1;s<30;++s)for(var l=n[s];l<n[s+1];++l)r[l]=l-n[s]<<5|s;return[n,r]},Ln=Tn(bt,2),Rt=Ln[0],cs=Ln[1];Rt[28]=258,cs[258]=28;var On=Tn(xt,0),In=On[0],bi=On[1],je=new de(32768);for(var $=0;$<32768;++$)fe=($&43690)>>>1|($&21845)<<1,fe=(fe&52428)>>>2|(fe&13107)<<2,fe=(fe&61680)>>>4|(fe&3855)<<4,je[$]=((fe&65280)>>>8|(fe&255)<<8)>>>1;var fe,Se=function(e,t,n){for(var s=e.length,r=0,l=new de(t);r<s;++r)e[r]&&++l[e[r]-1];var i=new de(t);for(r=0;r<t;++r)i[r]=i[r-1]+l[r-1]<<1;var a;if(n){a=new de(1<<t);var o=15-t;for(r=0;r<s;++r)if(e[r])for(var c=r<<4|e[r],d=t-e[r],y=i[e[r]-1]++<<d,S=y|(1<<d)-1;y<=S;++y)a[je[y]>>>o]=c}else for(a=new de(s),r=0;r<s;++r)e[r]&&(a[r]=je[i[e[r]-1]++]>>>15-e[r]);return a},Te=new Z(288);for(var $=0;$<144;++$)Te[$]=8;for(var $=144;$<256;++$)Te[$]=9;for(var $=256;$<280;++$)Te[$]=7;for(var $=280;$<288;++$)Te[$]=8;var Nn=new Z(32);for(var $=0;$<32;++$)Nn[$]=5;var Hn=Se(Te,9,1);var $n=Se(Nn,5,1),Xe=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},ne=function(e,t,n){var s=t/8|0;return(e[s]|e[s+1]<<8)>>(t&7)&n},Ke=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(t&7)},kn=function(e){return(e+7)/8|0},Ye=function(e,t,n){(t==null||t<0)&&(t=0),(n==null||n>e.length)&&(n=e.length);var s=new(e.BYTES_PER_ELEMENT==2?de:e.BYTES_PER_ELEMENT==4?_t:Z)(n-t);return s.set(e.subarray(t,n)),s};var Pn=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],J=function(e,t,n){var s=new Error(t||Pn[e]);if(s.code=e,Error.captureStackTrace&&Error.captureStackTrace(s,J),!n)throw s;return s},Dn=function(e,t,n){var s=e.length;if(!s||n&&n.f&&!n.l)return t||new Z(0);var r=!t||n,l=!n||n.i;n||(n={}),t||(t=new Z(s*3));var i=function(A){var ge=t.length;if(A>ge){var ke=new Z(Math.max(ge*2,A));ke.set(t),t=ke}},a=n.f||0,o=n.p||0,c=n.b||0,d=n.l,y=n.d,S=n.m,L=n.n,_=s*8;do{if(!d){a=ne(e,o,1);var C=ne(e,o+1,3);if(o+=3,C)if(C==1)d=Hn,y=$n,S=9,L=5;else if(C==2){var R=ne(e,o,31)+257,q=ne(e,o+10,15)+4,M=R+ne(e,o+5,31)+1;o+=14;for(var X=new Z(M),z=new Z(19),v=0;v<q;++v)z[Cn[v]]=ne(e,o+v*3,7);o+=q*3;for(var w=Xe(z),B=(1<<w)-1,f=Se(z,w,1),v=0;v<M;){var T=f[ne(e,o,B)];o+=T&15;var N=T>>>4;if(N<16)X[v++]=N;else{var x=0,ee=0;for(N==16?(ee=3+ne(e,o,3),o+=2,x=X[v-1]):N==17?(ee=3+ne(e,o,7),o+=3):N==18&&(ee=11+ne(e,o,127),o+=7);ee--;)X[v++]=x}}var h=X.subarray(0,R),u=X.subarray(R);S=Xe(h),L=Xe(u),d=Se(h,S,1),y=Se(u,L,1)}else J(1);else{var N=kn(o)+4,P=e[N-4]|e[N-3]<<8,F=N+P;if(F>s){l&&J(0);break}r&&i(c+P),t.set(e.subarray(N,F),c),n.b=c+=P,n.p=o=F*8,n.f=a;continue}if(o>_){l&&J(0);break}}r&&i(c+131072);for(var W=(1<<S)-1,b=(1<<L)-1,V=o;;V=o){var x=d[Ke(e,o)&W],j=x>>>4;if(o+=x&15,o>_){l&&J(0);break}if(x||J(2),j<256)t[c++]=j;else if(j==256){V=o,d=null;break}else{var K=j-254;if(j>264){var v=j-257,ie=bt[v];K=ne(e,o,(1<<ie)-1)+Rt[v],o+=ie}var xe=y[Ke(e,o)&b],pe=xe>>>4;xe||J(3),o+=xe&15;var u=In[pe];if(pe>3){var ie=xt[pe];u+=Ke(e,o)&(1<<ie)-1,o+=ie}if(o>_){l&&J(0);break}r&&i(c+131072);for(var ae=c+K;c<ae;c+=4)t[c]=t[c-u],t[c+1]=t[c+1-u],t[c+2]=t[c+2-u],t[c+3]=t[c+3-u];c=ae}}n.l=d,n.p=V,n.b=c,n.f=a,d&&(a=1,n.m=S,n.d=y,n.n=L)}while(!a);return c==t.length?t:Ye(t,0,c)};var ps=new Z(0);var ds=function(e,t){var n={};for(var s in e)n[s]=e[s];for(var s in t)n[s]=t[s];return n},Mn=function(e,t,n){for(var s=e(),r=e.toString(),l=r.slice(r.indexOf("[")+1,r.lastIndexOf("]")).replace(/\s+/g,"").split(","),i=0;i<s.length;++i){var a=s[i],o=l[i];if(typeof a=="function"){t+=";"+o+"=";var c=a.toString();if(a.prototype)if(c.indexOf("[native code]")!=-1){var d=c.indexOf(" ",8)+1;t+=c.slice(d,c.indexOf("(",d))}else{t+=c;for(var y in a.prototype)t+=";"+o+".prototype."+y+"="+a.prototype[y].toString()}else t+=c}else n[o]=a}return[t,n]},Ze=[],gs=function(e){var t=[];for(var n in e)e[n].buffer&&t.push((e[n]=new e[n].constructor(e[n])).buffer);return t},vs=function(e,t,n,s){var r;if(!Ze[n]){for(var l="",i={},a=e.length-1,o=0;o<a;++o)r=Mn(e[o],l,i),l=r[0],i=r[1];Ze[n]=Mn(e[a],l,i)}var c=ds({},Ze[n][1]);return fs(Ze[n][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",n,c,gs(c),s)},ys=function(){return[Z,de,_t,bt,xt,Cn,Rt,In,Hn,$n,je,Pn,Se,Xe,ne,Ke,kn,Ye,J,Dn,Tt,Bn,zn]};var Bn=function(e){return postMessage(e,[e.buffer])},zn=function(e){return e&&e.size&&new Z(e.size)},ms=function(e,t,n,s,r,l){var i=vs(n,s,r,function(a,o){i.terminate(),l(a,o)});return i.postMessage([e,t],t.consume?[e.buffer]:[]),function(){i.terminate()}};var ue=function(e,t){return e[t]|e[t+1]<<8},re=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0},Ct=function(e,t){return re(e,t)+re(e,t+4)*4294967296};function ws(e,t,n){return n||(n=t,t={}),typeof n!="function"&&J(7),ms(e,t,[ys],function(s){return Bn(Tt(s.data[0],zn(s.data[1])))},1,n)}function Tt(e,t){return Dn(e,t)}var xi=typeof TextEncoder!="undefined"&&new TextEncoder,Lt=typeof TextDecoder!="undefined"&&new TextDecoder,As=0;try{Lt.decode(ps,{stream:!0}),As=1}catch(e){}var Es=function(e){for(var t="",n=0;;){var s=e[n++],r=(s>127)+(s>223)+(s>239);if(n+r>e.length)return[t,Ye(e,n-1)];r?r==3?(s=((s&15)<<18|(e[n++]&63)<<12|(e[n++]&63)<<6|e[n++]&63)-65536,t+=String.fromCharCode(55296|s>>10,56320|s&1023)):r&1?t+=String.fromCharCode((s&31)<<6|e[n++]&63):t+=String.fromCharCode((s&15)<<12|(e[n++]&63)<<6|e[n++]&63):t+=String.fromCharCode(s)}};function Ss(e,t){if(t){for(var n="",s=0;s<e.length;s+=16384)n+=String.fromCharCode.apply(null,e.subarray(s,s+16384));return n}else{if(Lt)return Lt.decode(e);var r=Es(e),l=r[0],i=r[1];return i.length&&J(8),l}}var _s=function(e,t){return t+30+ue(e,t+26)+ue(e,t+28)},bs=function(e,t,n){var s=ue(e,t+28),r=Ss(e.subarray(t+46,t+46+s),!(ue(e,t+8)&2048)),l=t+46+s,i=re(e,t+20),a=n&&i==4294967295?xs(e,l):[i,re(e,t+24),re(e,t+42)],o=a[0],c=a[1],d=a[2];return[ue(e,t+10),o,c,r,l+ue(e,t+30)+ue(e,t+32),d]},xs=function(e,t){for(;ue(e,t)!=1;t+=4+ue(e,t+2));return[Ct(e,t+12),Ct(e,t+4),Ct(e,t+20)]};var Un=typeof queueMicrotask=="function"?queueMicrotask:typeof setTimeout=="function"?setTimeout:function(e){e()};function Fn(e,t,n){n||(n=t,t={}),typeof n!="function"&&J(7);var s=[],r=function(){for(var N=0;N<s.length;++N)s[N]()},l={},i=function(N,P){Un(function(){n(N,P)})};Un(function(){i=n});for(var a=e.length-22;re(e,a)!=101010256;--a)if(!a||e.length-a>65558)return i(J(13,0,1),null),r;var o=ue(e,a+8);if(o){var c=o,d=re(e,a+16),y=d==4294967295||c==65535;if(y){var S=re(e,a-12);y=re(e,S)==101075792,y&&(c=o=re(e,S+32),d=re(e,S+48))}for(var L=t&&t.filter,_=function(N){var P=bs(e,d,y),F=P[0],R=P[1],q=P[2],M=P[3],X=P[4],z=P[5],v=_s(e,z);d=X;var w=function(f,T){f?(r(),i(f,null)):(T&&(l[M]=T),--o||i(null,l))};if(!L||L({name:M,size:R,originalSize:q,compression:F}))if(!F)w(null,Ye(e,v,v+R));else if(F==8){var B=e.subarray(v,v+R);if(R<32e4)try{w(null,Tt(B,new Z(q)))}catch(f){w(f,null)}else s.push(ws(B,{size:q},w))}else w(J(14,"unknown compression type "+F,1),null);else w(null,null)},C=0;C<c;++C)_(C)}else i(null,{});return r}var Le=class{constructor(t){let n;typeof t=="object"&&t instanceof Le?n=t.source:n=String(t),this.source=n,this._re=(0,Gn.makeRe)(n)}test(t){return this._re.test(t)}},Rs=/^([_\w\d]+)\:\/\//;async function qn(e,t,n,s,r,l){let{loadings:i}=e,a;t in i?a=i[t]:(a=new _e(l),i[t]=a);let o=_e.nextAttempt(a),c=[a.promise];return Rs.test(n)?c.push(Wn(e,n,l).then(d=>s(d,r)).then(d=>_e.isCurrentAttempt(a,o)?Oe(e,t,d):void 0)):c.push(fetch(n).then(d=>d.arrayBuffer()).then(d=>s(d)).then(d=>_e.isCurrentAttempt(a,o)?Oe(e,t,d):void 0)),await Promise.race(c)}function Oe(e,t,n){let{store:s,loadings:r}=e;return s[t]=n,t in r&&(r[t].resolve(n),delete r[t]),n}function Cs(e,t,n){let{defaults:s}=e;typeof t=="string"&&(t=new Le(t));let r=`__default://[${s.length}]`;return Oe(e,r,n),s.push(new Kn(t,r)),n}function Ts(e,t){let{store:n,loadings:s}=e;t in s&&(s[t].reject(new Error("Stop loading to delete asset.")),delete s[t]),t in n&&delete n[t]}function Ls(e,t){typeof t=="string"&&(t=new Le(t));let{store:n,loadings:s}=e;for(let[r,l]of Object.entries(s))t.test(r)&&(l.reject(new Error(`Stop loading to clear assets matching ${t}`)),delete s[r]);for(let r of Object.keys(n))t.test(r)&&delete n[r]}function Os(e){let{store:t,loadings:n,defaults:s}=e;for(let[r,l]of Object.entries(n))l.reject(new Error("Stop loading to clear all assets.")),delete n[r];for(let r of Object.keys(t))delete t[r];s.length=0}function Is(e,t){let{loadings:n}=e;return t in n?n[t].promise:null}async function Wn(e,t,n){let{store:s,loadings:r}=e;if(t in s)return s[t];if(t in r)return r[t].promise;{let l=new _e(n);return r[t]=l,l.promise}}function Ns(e,t){let{defaults:n}=e;for(let s of n)if(s.glob.test(t))return Ve(e,s.uri);return null}function Ve(e,t){return e.store[t]}function Hs(e,t){return Boolean(e.store[t])}function $s(e){return Object.keys(e.store)}function jn(e,t){return t in e.store}function Xn(e,t){return t in e.loadings}var Kn=class{constructor(t,n){this.glob=t,this.uri=n}},_e=class{static nextAttempt(t){return++t._promiseHandle}static isCurrentAttempt(t,n){return t._promiseHandle===n}constructor(t){this._promiseHandle=0,this._resolve=null,this._reject=null,this._reason=null,this._value=null,this._timeoutHandle=Number.isFinite(t)&&t>0?setTimeout(()=>{this.reject(`Asset loading exceeded timeout of ${t} ms.`)},t):null,this._promise=new Promise((n,s)=>{this._value?n(this._value):this._resolve=n,this._reason?s(this._reason):this._reject=s})}get promise(){return this._promise}resolve(t){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._resolve?this._resolve(t):this._value=t}reject(t){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._reject?this._reject(t):this._reason=t}},Ot=class{constructor(t=null){this.parent=t,this.store={},this.loadings={},this.defaults=[]}get(t){let n=this;if(jn(n,t))return Ve(n,t);let s=Ns(n,t);return s||null}async resolve(t,n,s,r,l){return this.get(t)||await this.load(t,n,s,r,l)}fallback(t,n){return Cs(this,t,n)}cache(t,n){return Oe(this,t,n)}async load(t,n,s,r,l){let i=this;return jn(i,t)?Ve(i,t):Xn(i,t)?await Wn(i,t,l):await qn(i,t,n,s,r,l)}async reload(t,n,s,r,l){return await qn(this,t,n,s,r,l)}unload(t){Ts(this,t)}clear(t){Ls(this,t)}current(t){return Ve(this,t)}exists(t){return Hs(this,t)}loading(t){let n=this;return Xn(n,t)?Is(n,t):null}keys(){return $s(this)}reset(){Os(this)}},Yn=5e3,se=class{constructor(t,n,s=void 0,r=t,l=null){this.uri=t,this.loader=n,this.opts=s,this.initial=l,this.filepath=r,this.source=null,this.current=null}cache(t,n){return t.cache(this.uri,n),this.source=t,this.current=n,this}get(t){let n;return t.exists(this.uri)?n=t.current(this.uri):this.initial&&this.initial instanceof se?n=this.initial.get(t):n=this.initial,this.source=t,this.current=n,n}async load(t,n=Yn){let s;if(t.exists(this.uri))s=t.current(this.uri);else if(s=await t.load(this.uri,this.filepath,this.loader,this.opts,n),!s)if(this.initial&&this.initial instanceof se){let r=this.initial;s=await t.load(r.uri,r.filepath,r.loader,r.opts,n)}else s=this.initial;return this.source=t,this.current=s,s}async reload(t,n=Yn){let s=await t.reload(this.uri,this.filepath,this.loader,this.opts,n);return this.source=t,this.current=s,s}};async function Zn(e,t,n=void 0){let s=e,r="raw://",i=await(await fetch(t)).arrayBuffer();await new Promise((a,o)=>{Fn(new Uint8Array(i),(c,d)=>{if(c)o(c);else{for(let[y,S]of Object.entries(d)){y=y.replaceAll("\\","/");let L=y.indexOf("/");L>=0&&(y=y.substring(L+1));let _=r+y;Oe(s,_,S),n&&n(S,_,y)}a()}})})}async function Vn(e,t,n=5e3){let s=[];for(let r of t)s.push(r.load(e,n));await Promise.allSettled(s)}async function It(e,t){let{audioContext:n}=t||{};if(typeof e=="string"){let a=await(await fetch(e)).arrayBuffer();return It(a,{audioContext:n})}else if(!(e instanceof ArrayBuffer||ArrayBuffer.isView(e)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let s=e,r=new ArrayBuffer(s.byteLength);return new Uint8Array(r).set(s),await n.decodeAudioData(r)}var Nt=Symbol("audioContext"),Qe=class{static getAudioContext(){if(Nt in this)return this[Nt];{let t=new AudioContext;return ks(t),this[Nt]=t,t}}constructor(t,n){this.audioContext=t,this.audioBuffer=n,this._playing=!1,this._started=!1,this._source=null,this.onAudioSourceEnded=this.onAudioSourceEnded.bind(this)}destroy(){this._source&&this._source.disconnect(),this._source=null,this._started=!1,this._playing=!1}onAudioSourceEnded(){this._playing=!1}play(t={}){let n=this.audioBuffer;if(!n)return;this._source&&this.destroy();let{pitch:s=void 0,gain:r=void 0,pan:l=void 0,loop:i=!1}=t,a=this.audioContext,o=a.createBufferSource();o.addEventListener("ended",this.onAudioSourceEnded),o.buffer=n,o.loop=i;let c=o;if(s&&(o.detune.value=s*100),r){let d=a.createGain();d.gain.value=r,c=c.connect(d)}if(l){let d=a.createStereoPanner();d.pan.value=l,c=c.connect(d)}c.connect(a.destination),o.start(),this._source=o,this._started=!0,this._playing=!0}pause(){this._source.stop(),this._playing=!1}isStarted(){return this._started}isPlaying(){return this._playing}isPaused(){return this._started&&!this._playing}};function ks(e){let t=()=>{e.state==="suspended"&&e.resume()};document.addEventListener("click",t)}async function me(e){let t=Qe.getAudioContext(),n=await It(e,{audioContext:t});return new Qe(t,n)}var Qn=new se("start.wav",me,void 0,"raw://start.wav"),Jn=new se("dead.wav",me,void 0,"raw://dead.wav"),er=new se("pop.wav",me,void 0,"raw://boop.wav"),tr=new se("shoot.wav",me,void 0,"raw://click.wav"),nr=new se("boom.wav",me,void 0,"raw://boom.wav"),Je=new se("music.wav",me,void 0,"raw://music.wav");var Ps=[2,4],Ds=[.3,1],Ms=30;function rr(e,t){let n={x:[],y:[],size:[],speed:[],length:0,width:e,height:t};for(let s=0;s<Ms;++s)n.x.push(m.range(0,e)),n.y.push(m.range(0,t)),n.size.push(m.range(...Ps)),n.speed.push(m.range(...Ds)),n.length++;return n}function sr(e,t,n="white"){for(let s=0;s<t.length;++s){let r=t.x[s],l=t.y[s],i=t.size[s],a=i/2;e.fillStyle=n,e.fillRect(r-a,l-a,i,i)}}function ir(e,t=1,n=0){let{length:s,width:r,height:l}=e;for(let i=0;i<s;++i){let a=t*e.speed[i],o=n*e.speed[i];e.x[i]+=a,e.y[i]+=o,a<0?e.x[i]<0&&(e.x[i]=r,e.y[i]=m.range(0,l)):a>0&&e.x[i]>r&&(e.x[i]=0,e.y[i]=m.range(0,l)),o<0?e.y[i]<0&&(e.x[i]=m.range(0,r),e.y[i]=l):o>0&&e.y[i]>l&&(e.x[i]=m.range(0,r),e.y[i]=0)}}var Bs=document.querySelector("#display"),O=Bs.canvas,zs=O.getContext("2d"),$t=0,et={load:ri,start:si,update:ii,render:ai};window.addEventListener("DOMContentLoaded",Us);function Us(){et.load().then(()=>{et.start(),ar($t=performance.now())})}function ar(e){requestAnimationFrame(ar);let t=e-$t;$t=e,et.update(t),et.render(zs)}var le=5,Ie=4,I=8,or=[[-I,-I,I*2+O.width,I],[-I,0,I,O.height],[-I,O.height,I*2+O.width,I],[O.width,0,I,O.height]],tt=[3e3,1e4],Fs=1,Gs=100,k=1,we=2,nt=4,qs=2e3,Ws=100,ur=10,Ne=4,lr=2,He=600,hr=.1,js=["red","red","red","yellow","orange"],fr=["blue","blue","blue","dodgerblue","gray","darkgray","yellow"],Xs=["gray","darkgray","lightgray"],Ks="[ wasd_ ]",rt=[-2,2],cr=1.5,Ys=.1,Zs=.4,kt=.1,pr=.02,Vs=.008,Qs=.1,dr=.001,Js="gold";var ce=4,ei=["white","violet","violet"],ti=30,ni=.7,Pt=!1;async function ri(){console.log("Loading..."),this.assets=new Ot,await Zn(this.assets,"res.pack"),await Vn(this.assets,Object.values(Ht)),console.log("...loading complete!")}function si(){this.level=0,this.score=0,this.highScore=Number(localStorage.getItem("highscore")),this.flashScoreDelta=0,this.flashHighScoreDelta=0,this.flashShootDelta=0,this.player={scene:this,x:O.width/2,y:O.height/2,rotation:0,dx:0,dy:0,dr:0,left:0,right:0,up:0,down:0,cooldown:0,powerMode:0,shoot(){if(!(this.scene.bullets.length>Ws)&&!(this.cooldown>0)){if(this.powerMode>0){for(let e=-1;e<=1;++e){let t=this.rotation+e*Math.PI/4,n=gr(this.scene,this.x-Math.cos(t)*le,this.y-Math.sin(t)*le,-Math.cos(t)*nt+this.dx,-Math.sin(t)*nt+this.dy);this.scene.bullets.push(n)}--this.powerMode}else{let e=gr(this.scene,this.x-Math.cos(this.rotation)*le,this.y-Math.sin(this.rotation)*le,-Math.cos(this.rotation)*nt+this.dx,-Math.sin(this.rotation)*nt+this.dy);this.scene.bullets.push(e)}this.cooldown=ur,tr.current.play()}}},this.asteroids=[],this.asteroidSpawner={scene:this,spawnTicks:tt[1],reset(){this.spawnTicks=tt[1]},spawn(){if(this.scene.asteroids.length>Gs)return;let e=m.choose(or),t=$e(this.scene,m.range(e[0],e[0]+e[2]),m.range(e[1],e[1]+e[3]),m.range(-k,k),m.range(-k,k),I);this.scene.asteroids.push(t)},update(e){this.scene.gamePause||(this.spawnTicks-=e,this.spawnTicks<=0&&(this.spawn(),this.spawnTicks=m.range(tt[0],tt[1])))}},this.bullets=[],this.particles=[],this.powerUps=[],this.powerUpSpawner={scene:this,reset(){},spawn(){let e=m.choose(or),t=oi(this.scene,m.range(e[0],e[0]+e[2]),m.range(e[1],e[1]+e[3]),m.range(-k,k),m.range(-k,k));this.scene.powerUps.push(t)},update(e){}},this.starfield=rr(O.width,O.height),this.gamePause=!0,this.showPlayer=!0,this.gameStart=!0,this.gameWait=!0,this.hint=Ks,document.addEventListener("keydown",e=>fi.call(this,e.key)),document.addEventListener("keyup",e=>ci.call(this,e.key))}function ii(e){if(this.gamePause){for(let r of this.particles)r.age+=e,r.age>He?r.destroy():(r.x+=r.dx,r.y+=r.dy,be(r,Ne*2,Ne*2));return}let t=this.player.right-this.player.left,n=this.player.down-this.player.up,s=this.player.fire;this.player.dx+=n*Math.cos(this.player.rotation)*pr,this.player.dy+=n*Math.sin(this.player.rotation)*pr,this.player.dx*=1-dr,this.player.dy*=1-dr,this.player.dr+=t*Vs,this.player.dr*=1-Qs,this.player.x+=this.player.dx,this.player.y+=this.player.dy,this.player.rotation+=this.player.dr,--this.player.cooldown,be(this.player,le*2,le*2),s&&(this.player.shoot(),this.flashShootDelta=1),n&&hi(this,this.player.x,this.player.y,-n*Math.cos(this.player.rotation)*cr,-n*Math.sin(this.player.rotation)*cr,m.choose.bind(null,Xs));for(let r of this.bullets)r.age+=e,r.age>qs?r.destroy():(r.x+=r.dx,r.y+=r.dy,be(r,we*2,we*2));for(let r of this.bullets)for(let l of this.asteroids)if(Dt(r,l,l.size)){this.flashScore=1,this.score++,this.score>this.highScore&&(this.flashHighScore=this.score-this.highScore,this.highScore=this.score,localStorage.setItem("highscore",this.highScore)),it(this,l.x,l.y,10,m.choose.bind(null,fr)),er.current.play(),r.destroy(),l.breakUp(r.dx*hr,r.dy*hr);break}for(let r of this.particles)r.age+=e,r.age>He?r.destroy():(r.x+=r.dx,r.y+=r.dy,be(r,Ne*2,Ne*2));for(let r of this.asteroids)r.x+=r.dx,r.y+=r.dy,be(r,r.size*2,r.size*2);for(let r of this.asteroids)if(Dt(r,this.player,r.size+le)){it(this,r.x,r.y,10,m.choose.bind(null,fr)),r.destroy(),li(this);break}for(let r of this.powerUps)r.x+=r.dx,r.y+=r.dy,be(r,ce*2,ce*2);for(let r of this.powerUps)if(Dt(r,this.player,ce+le)){it(this,r.x,r.y,10,m.choose.bind(null,ei)),r.destroy(),this.player.powerMode+=ti;break}ir(this.starfield),this.asteroidSpawner.update(e),this.powerUpSpawner.update(e),!this.gamePause&&this.asteroids.length<=0&&(this.gamePause=!0,this.showPlayer=!0,Qn.current.play(),setTimeout(()=>this.gameWait=!0,1e3))}function ai(e){e.fillStyle="black",e.fillRect(0,0,O.width,O.height),sr(e,this.starfield),e.fillStyle="rgba(255, 255, 255, 0.2)",e.textAlign="center",e.textBaseline="middle",e.font="16px sans-serif",e.fillText(this.hint,O.width/2,O.height/2-32),this.flashScore>0?(e.fillStyle=`rgba(255, 255, 255, ${this.flashScore+.2})`,this.flashScore-=kt):e.fillStyle="rgba(255, 255, 255, 0.2)",e.font="48px sans-serif",e.fillText("= "+String(this.score).padStart(2,"0")+" =",O.width/2,O.height/2),this.flashHighScore>0?(e.fillStyle=`rgba(255, 255, 255, ${this.flashHighScore+.2})`,this.flashHighScore-=kt):e.fillStyle="rgba(255, 255, 255, 0.2)",e.font="16px sans-serif",e.fillText(String(this.highScore).padStart(2,"0"),O.width/2,O.height/2+32),e.fillStyle="rgba(255, 255, 255, 0.2)",e.font="24px sans-serif",e.textAlign="right",e.fillText(Math.ceil(this.asteroidSpawner.spawnTicks/1e3),O.width,O.height-12);for(let t of this.asteroids)e.translate(t.x,t.y),e.rotate(t.rotation),e.fillStyle="slategray",e.fillRect(-t.size,-t.size,t.size*2,t.size*2),e.setTransform(1,0,0,1,0,0),st(e,t.x,t.y,t.size);for(let t of this.powerUps)e.translate(t.x,t.y),e.rotate(t.rotation),e.beginPath(),e.strokeStyle="violet",e.arc(0,0,ce,0,Math.PI*2),e.moveTo(-ce/2,0),e.lineTo(ce/2,0),e.moveTo(0,-ce/2),e.lineTo(0,ce/2),e.stroke(),e.setTransform(1,0,0,1,0,0),st(e,t.x,t.y,ce);for(let t of this.bullets)e.translate(t.x,t.y),e.rotate(t.rotation),e.fillStyle=Js,e.fillRect(-we,-we,we*4,we*2),e.setTransform(1,0,0,1,0,0),st(e,t.x,t.y,we);for(let t of this.particles){e.translate(t.x,t.y),e.rotate(t.rotation),e.fillStyle=t.color;let n=Ne*(1-t.age/He);e.fillRect(-n,-n,n*2,n*2),e.setTransform(1,0,0,1,0,0)}if(this.showPlayer){e.translate(this.player.x,this.player.y),e.rotate(this.player.rotation),e.fillStyle="white";let t=le;e.fillRect(-t,-t,t*2,t*2);let n=-1,s=0,r=0;this.flashShootDelta>0?(e.fillStyle=`rgb(${200*this.flashShootDelta+55*Math.sin(performance.now()/(ur*2))}, 0, 0)`,this.flashShootDelta-=kt,r=this.flashShootDelta*2,n=this.flashShootDelta):e.fillStyle="black",e.fillRect(-t-r/2+n,-(t/4)-r/2+s,t+r,t/2+r),e.setTransform(1,0,0,1,0,0)}st(e,this.player.x,this.player.y,le)}function be(e,t,n){e.x<-t&&(e.x=O.width),e.y<-n&&(e.y=O.height),e.x>O.width+t/2&&(e.x=-t),e.y>O.height+n/2&&(e.y=-n)}function Dt(e,t,n){let s=e.x-t.x,r=e.y-t.y;return s*s+r*r<=n*n}function st(e,t,n,s){!Pt||(e.translate(t,n),e.beginPath(),e.arc(0,0,s,0,Math.PI*2),e.strokeStyle="lime",e.stroke(),e.setTransform(1,0,0,1,0,0))}function oi(e,t,n,s,r){return{scene:e,x:t,y:n,dx:s,dy:r,rotation:Math.atan2(r,s),destroy(){this.scene.powerUps.splice(this.scene.powerUps.indexOf(this),1)}}}function $e(e,t,n,s,r,l){return{scene:e,x:t,y:n,dx:s,dy:r,size:l,rotation:Math.atan2(r,s),breakUp(i=0,a=0){if(this.destroy(),this.size>Ie){let o=[];o.push($e(this.scene,this.x+m.range(-I,I),this.y+m.range(-I,I),m.range(-k,k)+i,m.range(-k,k)+a,Ie)),o.push($e(this.scene,this.x+m.range(-I,I),this.y+m.range(-I,I),m.range(-k,k)+i,m.range(-k,k)+a,Ie)),o.push($e(this.scene,this.x+m.range(-I,I),this.y+m.range(-I,I),m.range(-k,k)+i,m.range(-k,k)+a,Ie)),o.push($e(this.scene,this.x+m.range(-I,I),this.y+m.range(-I,I),m.range(-k,k)+i,m.range(-k,k)+a,Ie)),this.scene.asteroids.push(...o)}},destroy(){this.scene.asteroids.splice(this.scene.asteroids.indexOf(this),1)}}}function gr(e,t,n,s,r){return{scene:e,x:t,y:n,dx:s,dy:r,rotation:Math.atan2(r,s),age:0,destroy(){this.scene.bullets.splice(this.scene.bullets.indexOf(this),1)}}}function vr(e,t,n,s,r,l){return typeof l=="function"&&(l=l.call(null)),{scene:e,x:t,y:n,dx:s,dy:r,rotation:Math.atan2(r,s),age:0,color:l,destroy(){this.scene.particles.splice(this.scene.particles.indexOf(this),1)}}}function ui(e){e.bullets.length=0,e.asteroids.length=0,e.particles.length=0,e.player.x=O.width/2,e.player.y=O.height/2,e.player.dx=0,e.player.dy=0,e.level++,e.gamePause=!1,e.showPlayer=!0;for(let t=0;t<Fs*e.level;++t)e.asteroidSpawner.spawn();m.next()>ni&&e.powerUpSpawner.spawn(),Je.current.isPlaying()||Je.current.play({loop:!0})}function li(e){e.gamePause=!0,e.showPlayer=!1,it(e,e.player.x,e.player.y,100,m.choose.bind(null,js)),Jn.current.play(),nr.current.play(),setTimeout(()=>e.gameStart=e.gameWait=!0,1e3)}function hi(e,t,n,s,r,l){if(m.next()>.3){let i=vr(e,t+m.range(rt[0],rt[1]),n+m.range(rt[0],rt[1]),s,r,l);i.age=m.range(He*Ys,He*Zs),e.particles.push(i)}}function it(e,t,n,s=10,r){for(let l=0;l<s;++l)e.particles.push(vr(e,t,n,m.range(-1,1)*lr,m.range(-1,1)*lr,r))}function fi(e){switch(this.gameWait&&(this.gameStart&&(Je.current.play(),this.score=0,this.flashScore=!0,this.level=0,this.gameStart=!1,this.player.powerMode=0,this.powerUps.length=0,this.asteroidSpawner.reset(),this.powerUpSpawner.reset()),this.gameWait=!1,ui(this)),e){case"w":case"ArrowUp":this.player.up=1;break;case"s":case"ArrowDown":this.player.down=1;break;case"a":case"ArrowLeft":this.player.left=1;break;case"d":case"ArrowRight":this.player.right=1;break;case" ":this.player.fire=1;break;case"\\":break;default:console.log(e)}}function ci(e){switch(e){case"w":case"ArrowUp":this.player.up=0;break;case"s":case"ArrowDown":this.player.down=0;break;case"a":case"ArrowLeft":this.player.left=0;break;case"d":case"ArrowRight":this.player.right=0;break;case" ":this.player.fire=0;break;case"\\":Pt=!Pt;break;default:console.log(e)}}})();
//# sourceMappingURL=main.js.map
