(()=>{var gr=Object.create,Lt=Object.defineProperty,yr=Object.getPrototypeOf,Ar=Object.prototype.hasOwnProperty,Er=Object.getOwnPropertyNames,wr=Object.getOwnPropertyDescriptor;var br=n=>Lt(n,"__esModule",{value:!0});var Tr=(n,t)=>()=>(n&&(t=n(n=0)),t),ct=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports),qt=(n,t)=>{for(var e in t)Lt(n,e,{get:t[e],enumerable:!0})},Sr=(n,t,e)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of Er(t))!Ar.call(n,r)&&r!=="default"&&Lt(n,r,{get:()=>t[r],enumerable:!(e=wr(t,r))||e.enumerable});return n},Rr=n=>Sr(br(Lt(n!=null?gr(yr(n)):{},"default",n&&n.__esModule&&"default"in n?{get:()=>n.default,enumerable:!0}:{value:n,enumerable:!0})),n);var En={};qt(En,{basename:()=>Ln,default:()=>ii,delimiter:()=>Rn,dirname:()=>Mn,extname:()=>Cn,isAbsolute:()=>ve,join:()=>bn,normalize:()=>xe,relative:()=>Tn,resolve:()=>Dt,sep:()=>Sn});function wn(n,t){for(var e=0,r=n.length-1;r>=0;r--){var i=n[r];i==="."?n.splice(r,1):i===".."?(n.splice(r,1),e++):e&&(n.splice(r,1),e--)}if(t)for(;e--;e)n.unshift("..");return n}function Dt(){for(var n="",t=!1,e=arguments.length-1;e>=-1&&!t;e--){var r=e>=0?arguments[e]:"/";if(typeof r!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!r)continue;n=r+"/"+n,t=r.charAt(0)==="/"}return n=wn(me(n.split("/"),function(i){return!!i}),!t).join("/"),(t?"/":"")+n||"."}function xe(n){var t=ve(n),e=ri(n,-1)==="/";return n=wn(me(n.split("/"),function(r){return!!r}),!t).join("/"),!n&&!t&&(n="."),n&&e&&(n+="/"),(t?"/":"")+n}function ve(n){return n.charAt(0)==="/"}function bn(){var n=Array.prototype.slice.call(arguments,0);return xe(me(n,function(t,e){if(typeof t!="string")throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))}function Tn(n,t){n=Dt(n).substr(1),t=Dt(t).substr(1);function e(c){for(var p=0;p<c.length&&c[p]==="";p++);for(var v=c.length-1;v>=0&&c[v]==="";v--);return p>v?[]:c.slice(p,v-p+1)}for(var r=e(n.split("/")),i=e(t.split("/")),s=Math.min(r.length,i.length),o=s,a=0;a<s;a++)if(r[a]!==i[a]){o=a;break}for(var u=[],a=o;a<r.length;a++)u.push("..");return u=u.concat(i.slice(o)),u.join("/")}function Mn(n){var t=de(n),e=t[0],r=t[1];return!e&&!r?".":(r&&(r=r.substr(0,r.length-1)),e+r)}function Ln(n,t){var e=de(n)[2];return t&&e.substr(-1*t.length)===t&&(e=e.substr(0,e.length-t.length)),e}function Cn(n){return de(n)[3]}function me(n,t){if(n.filter)return n.filter(t);for(var e=[],r=0;r<n.length;r++)t(n[r],r,n)&&e.push(n[r]);return e}var ni,de,Sn,Rn,ii,ri,In=Tr(()=>{ni=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,de=function(n){return ni.exec(n).slice(1)};Sn="/",Rn=":";ii={extname:Cn,basename:Ln,dirname:Mn,sep:Sn,delimiter:Rn,relative:Tn,join:bn,isAbsolute:ve,normalize:xe,resolve:Dt};ri="ab".substr(-1)==="b"?function(n,t,e){return n.substr(t,e)}:function(n,t,e){return t<0&&(t=n.length+t),n.substr(t,e)}});var kt=ct((po,Pt)=>{var lt=(In(),En);lt&&lt.default?Pt.exports=lt.default:lt&&(Pt.exports=lt);if(lt)for(let n in lt)Pt.exports[n]=lt[n]});var At=ct((mo,Nn)=>{"use strict";var si=kt(),it="\\\\/",Bn=`[^${it}]`,at="\\.",oi="\\+",ai="\\?",Ut="\\/",ui="(?=.)",On="[^/]",_e=`(?:${Ut}|$)`,Fn=`(?:^|${Ut})`,ge=`${at}{1,2}${_e}`,li=`(?!${at})`,hi=`(?!${Fn}${ge})`,ci=`(?!${at}{0,1}${_e})`,fi=`(?!${ge})`,pi=`[^.${Ut}]`,di=`${On}*?`,Dn={DOT_LITERAL:at,PLUS_LITERAL:oi,QMARK_LITERAL:ai,SLASH_LITERAL:Ut,ONE_CHAR:ui,QMARK:On,END_ANCHOR:_e,DOTS_SLASH:ge,NO_DOT:li,NO_DOTS:hi,NO_DOT_SLASH:ci,NO_DOTS_SLASH:fi,QMARK_NO_DOT:pi,STAR:di,START_ANCHOR:Fn},mi={...Dn,SLASH_LITERAL:`[${it}]`,QMARK:Bn,STAR:`${Bn}*?`,DOTS_SLASH:`${at}{1,2}(?:[${it}]|$)`,NO_DOT:`(?!${at})`,NO_DOTS:`(?!(?:^|[${it}])${at}{1,2}(?:[${it}]|$))`,NO_DOT_SLASH:`(?!${at}{0,1}(?:[${it}]|$))`,NO_DOTS_SLASH:`(?!${at}{1,2}(?:[${it}]|$))`,QMARK_NO_DOT:`[^.${it}]`,START_ANCHOR:`(?:^|[${it}])`,END_ANCHOR:`(?:[${it}]|$)`},vi={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};Nn.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:vi,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:si.sep,extglobChars(n){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${n.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(n){return n===!0?mi:Dn}}});var Ht=ct(X=>{"use strict";var xi=kt(),_i=!1,{REGEX_BACKSLASH:gi,REGEX_REMOVE_BACKSLASH:yi,REGEX_SPECIAL_CHARS:Ai,REGEX_SPECIAL_CHARS_GLOBAL:Ei}=At();X.isObject=n=>n!==null&&typeof n=="object"&&!Array.isArray(n);X.hasRegexChars=n=>Ai.test(n);X.isRegexChar=n=>n.length===1&&X.hasRegexChars(n);X.escapeRegex=n=>n.replace(Ei,"\\$1");X.toPosixSlashes=n=>n.replace(gi,"/");X.removeBackslashes=n=>n.replace(yi,t=>t==="\\"?"":t);X.supportsLookbehinds=()=>{let n=process.version.slice(1).split(".").map(Number);return n.length===3&&n[0]>=9||n[0]===8&&n[1]>=10};X.isWindows=n=>n&&typeof n.windows=="boolean"?n.windows:_i===!0||xi.sep==="\\";X.escapeLast=(n,t,e)=>{let r=n.lastIndexOf(t,e);return r===-1?n:n[r-1]==="\\"?X.escapeLast(n,t,r-1):`${n.slice(0,r)}\\${n.slice(r)}`};X.removePrefix=(n,t={})=>{let e=n;return e.startsWith("./")&&(e=e.slice(2),t.prefix="./"),e};X.wrapOutput=(n,t={},e={})=>{let r=e.contains?"":"^",i=e.contains?"":"$",s=`${r}(?:${n})${i}`;return t.negated===!0&&(s=`(?:^(?!${s}).*$)`),s}});var Gn=ct((xo,Pn)=>{"use strict";var kn=Ht(),{CHAR_ASTERISK:ye,CHAR_AT:wi,CHAR_BACKWARD_SLASH:Et,CHAR_COMMA:bi,CHAR_DOT:Ae,CHAR_EXCLAMATION_MARK:Ee,CHAR_FORWARD_SLASH:Un,CHAR_LEFT_CURLY_BRACE:we,CHAR_LEFT_PARENTHESES:be,CHAR_LEFT_SQUARE_BRACKET:Ti,CHAR_PLUS:Si,CHAR_QUESTION_MARK:Hn,CHAR_RIGHT_CURLY_BRACE:Ri,CHAR_RIGHT_PARENTHESES:jn,CHAR_RIGHT_SQUARE_BRACKET:Mi}=At(),zn=n=>n===Un||n===Et,$n=n=>{n.isPrefix!==!0&&(n.depth=n.isGlobstar?Infinity:1)},Li=(n,t)=>{let e=t||{},r=n.length-1,i=e.parts===!0||e.scanToEnd===!0,s=[],o=[],a=[],u=n,c=-1,p=0,v=0,A=!1,w=!1,m=!1,g=!1,E=!1,R=!1,C=!1,b=!1,I=!1,N=!1,P=0,B,_,y={value:"",depth:0,isGlob:!1},H=()=>c>=r,f=()=>u.charCodeAt(c+1),O=()=>(B=_,u.charCodeAt(++c));for(;c<r;){_=O();let z;if(_===Et){C=y.backslashes=!0,_=O(),_===we&&(R=!0);continue}if(R===!0||_===we){for(P++;H()!==!0&&(_=O());){if(_===Et){C=y.backslashes=!0,O();continue}if(_===we){P++;continue}if(R!==!0&&_===Ae&&(_=O())===Ae){if(A=y.isBrace=!0,m=y.isGlob=!0,N=!0,i===!0)continue;break}if(R!==!0&&_===bi){if(A=y.isBrace=!0,m=y.isGlob=!0,N=!0,i===!0)continue;break}if(_===Ri&&(P--,P===0)){R=!1,A=y.isBrace=!0,N=!0;break}}if(i===!0)continue;break}if(_===Un){if(s.push(c),o.push(y),y={value:"",depth:0,isGlob:!1},N===!0)continue;if(B===Ae&&c===p+1){p+=2;continue}v=c+1;continue}if(e.noext!==!0&&(_===Si||_===wi||_===ye||_===Hn||_===Ee)===!0&&f()===be){if(m=y.isGlob=!0,g=y.isExtglob=!0,N=!0,_===Ee&&c===p&&(I=!0),i===!0){for(;H()!==!0&&(_=O());){if(_===Et){C=y.backslashes=!0,_=O();continue}if(_===jn){m=y.isGlob=!0,N=!0;break}}continue}break}if(_===ye){if(B===ye&&(E=y.isGlobstar=!0),m=y.isGlob=!0,N=!0,i===!0)continue;break}if(_===Hn){if(m=y.isGlob=!0,N=!0,i===!0)continue;break}if(_===Ti){for(;H()!==!0&&(z=O());){if(z===Et){C=y.backslashes=!0,O();continue}if(z===Mi){w=y.isBracket=!0,m=y.isGlob=!0,N=!0;break}}if(i===!0)continue;break}if(e.nonegate!==!0&&_===Ee&&c===p){b=y.negated=!0,p++;continue}if(e.noparen!==!0&&_===be){if(m=y.isGlob=!0,i===!0){for(;H()!==!0&&(_=O());){if(_===be){C=y.backslashes=!0,_=O();continue}if(_===jn){N=!0;break}}continue}break}if(m===!0){if(N=!0,i===!0)continue;break}}e.noext===!0&&(g=!1,m=!1);let L=u,q="",h="";p>0&&(q=u.slice(0,p),u=u.slice(p),v-=p),L&&m===!0&&v>0?(L=u.slice(0,v),h=u.slice(v)):m===!0?(L="",h=u):L=u,L&&L!==""&&L!=="/"&&L!==u&&zn(L.charCodeAt(L.length-1))&&(L=L.slice(0,-1)),e.unescape===!0&&(h&&(h=kn.removeBackslashes(h)),L&&C===!0&&(L=kn.removeBackslashes(L)));let l={prefix:q,input:n,start:p,base:L,glob:h,isBrace:A,isBracket:w,isGlob:m,isExtglob:g,isGlobstar:E,negated:b,negatedExtglob:I};if(e.tokens===!0&&(l.maxDepth=0,zn(_)||o.push(y),l.tokens=o),e.parts===!0||e.tokens===!0){let z;for(let M=0;M<s.length;M++){let Y=z?z+1:p,$=s[M],G=n.slice(Y,$);e.tokens&&(M===0&&p!==0?(o[M].isPrefix=!0,o[M].value=q):o[M].value=G,$n(o[M]),l.maxDepth+=o[M].depth),(M!==0||G!=="")&&a.push(G),z=$}if(z&&z+1<n.length){let M=n.slice(z+1);a.push(M),e.tokens&&(o[o.length-1].value=M,$n(o[o.length-1]),l.maxDepth+=o[o.length-1].depth)}l.slashes=s,l.parts=a}return l};Pn.exports=Li});var Xn=ct((_o,Vn)=>{"use strict";var jt=At(),W=Ht(),{MAX_LENGTH:zt,POSIX_REGEX_SOURCE:Ci,REGEX_NON_SPECIAL_CHARS:Ii,REGEX_SPECIAL_CHARS_BACKREF:Ni,REPLACEMENTS:Kn}=jt,Bi=(n,t)=>{if(typeof t.expandRange=="function")return t.expandRange(...n,t);n.sort();let e=`[${n.join("-")}]`;try{new RegExp(e)}catch(r){return n.map(i=>W.escapeRegex(i)).join("..")}return e},mt=(n,t)=>`Missing ${n}: "${t}" - use "\\\\${t}" to match literal characters`,Yn=(n,t)=>{if(typeof n!="string")throw new TypeError("Expected a string");n=Kn[n]||n;let e={...t},r=typeof e.maxLength=="number"?Math.min(zt,e.maxLength):zt,i=n.length;if(i>r)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${r}`);let s={type:"bos",value:"",output:e.prepend||""},o=[s],a=e.capture?"":"?:",u=W.isWindows(t),c=jt.globChars(u),p=jt.extglobChars(c),{DOT_LITERAL:v,PLUS_LITERAL:A,SLASH_LITERAL:w,ONE_CHAR:m,DOTS_SLASH:g,NO_DOT:E,NO_DOT_SLASH:R,NO_DOTS_SLASH:C,QMARK:b,QMARK_NO_DOT:I,STAR:N,START_ANCHOR:P}=c,B=x=>`(${a}(?:(?!${P}${x.dot?g:v}).)*?)`,_=e.dot?"":E,y=e.dot?b:I,H=e.bash===!0?B(e):N;e.capture&&(H=`(${H})`),typeof e.noext=="boolean"&&(e.noextglob=e.noext);let f={input:n,index:-1,start:0,dot:e.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:o};n=W.removePrefix(n,f),i=n.length;let O=[],L=[],q=[],h=s,l,z=()=>f.index===i-1,M=f.peek=(x=1)=>n[f.index+x],Y=f.advance=()=>n[++f.index]||"",$=()=>n.slice(f.index+1),G=(x="",F=0)=>{f.consumed+=x,f.index+=F},tt=x=>{f.output+=x.output!=null?x.output:x.value,G(x.value)},xt=()=>{let x=1;for(;M()==="!"&&(M(2)!=="("||M(3)==="?");)Y(),f.start++,x++;return x%2==0?!1:(f.negated=!0,f.start++,!0)},ut=x=>{f[x]++,q.push(x)},et=x=>{f[x]--,q.pop()},T=x=>{if(h.type==="globstar"){let F=f.braces>0&&(x.type==="comma"||x.type==="brace"),d=x.extglob===!0||O.length&&(x.type==="pipe"||x.type==="paren");x.type!=="slash"&&x.type!=="paren"&&!F&&!d&&(f.output=f.output.slice(0,-h.output.length),h.type="star",h.value="*",h.output=H,f.output+=h.output)}if(O.length&&x.type!=="paren"&&(O[O.length-1].inner+=x.value),(x.value||x.output)&&tt(x),h&&h.type==="text"&&x.type==="text"){h.value+=x.value,h.output=(h.output||"")+x.value;return}x.prev=h,o.push(x),h=x},ht=(x,F)=>{let d={...p[F],conditions:1,inner:""};d.prev=h,d.parens=f.parens,d.output=f.output;let S=(e.capture?"(":"")+d.open;ut("parens"),T({type:x,value:F,output:f.output?"":m}),T({type:"paren",extglob:!0,value:Y(),output:S}),O.push(d)},Rt=x=>{let F=x.close+(e.capture?")":""),d;if(x.type==="negate"){let S=H;x.inner&&x.inner.length>1&&x.inner.includes("/")&&(S=B(e)),(S!==H||z()||/^\)+$/.test($()))&&(F=x.close=`)$))${S}`),x.inner.includes("*")&&(d=$())&&/^\.[^\\/.]+$/.test(d)&&(F=x.close=`)${d})${S})`),x.prev.type==="bos"&&(f.negatedExtglob=!0)}T({type:"paren",extglob:!0,value:l,output:F}),et("parens")};if(e.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(n)){let x=!1,F=n.replace(Ni,(d,S,k,K,j,Xt)=>K==="\\"?(x=!0,d):K==="?"?S?S+K+(j?b.repeat(j.length):""):Xt===0?y+(j?b.repeat(j.length):""):b.repeat(k.length):K==="."?v.repeat(k.length):K==="*"?S?S+K+(j?H:""):H:S?d:`\\${d}`);return x===!0&&(e.unescape===!0?F=F.replace(/\\/g,""):F=F.replace(/\\+/g,d=>d.length%2==0?"\\\\":d?"\\":"")),F===n&&e.contains===!0?(f.output=n,f):(f.output=W.wrapOutput(F,f,t),f)}for(;!z();){if(l=Y(),l==="\0")continue;if(l==="\\"){let d=M();if(d==="/"&&e.bash!==!0||d==="."||d===";")continue;if(!d){l+="\\",T({type:"text",value:l});continue}let S=/^\\+/.exec($()),k=0;if(S&&S[0].length>2&&(k=S[0].length,f.index+=k,k%2!=0&&(l+="\\")),e.unescape===!0?l=Y():l+=Y(),f.brackets===0){T({type:"text",value:l});continue}}if(f.brackets>0&&(l!=="]"||h.value==="["||h.value==="[^")){if(e.posix!==!1&&l===":"){let d=h.value.slice(1);if(d.includes("[")&&(h.posix=!0,d.includes(":"))){let S=h.value.lastIndexOf("["),k=h.value.slice(0,S),K=h.value.slice(S+2),j=Ci[K];if(j){h.value=k+j,f.backtrack=!0,Y(),!s.output&&o.indexOf(h)===1&&(s.output=m);continue}}}(l==="["&&M()!==":"||l==="-"&&M()==="]")&&(l=`\\${l}`),l==="]"&&(h.value==="["||h.value==="[^")&&(l=`\\${l}`),e.posix===!0&&l==="!"&&h.value==="["&&(l="^"),h.value+=l,tt({value:l});continue}if(f.quotes===1&&l!=='"'){l=W.escapeRegex(l),h.value+=l,tt({value:l});continue}if(l==='"'){f.quotes=f.quotes===1?0:1,e.keepQuotes===!0&&T({type:"text",value:l});continue}if(l==="("){ut("parens"),T({type:"paren",value:l});continue}if(l===")"){if(f.parens===0&&e.strictBrackets===!0)throw new SyntaxError(mt("opening","("));let d=O[O.length-1];if(d&&f.parens===d.parens+1){Rt(O.pop());continue}T({type:"paren",value:l,output:f.parens?")":"\\)"}),et("parens");continue}if(l==="["){if(e.nobracket===!0||!$().includes("]")){if(e.nobracket!==!0&&e.strictBrackets===!0)throw new SyntaxError(mt("closing","]"));l=`\\${l}`}else ut("brackets");T({type:"bracket",value:l});continue}if(l==="]"){if(e.nobracket===!0||h&&h.type==="bracket"&&h.value.length===1){T({type:"text",value:l,output:`\\${l}`});continue}if(f.brackets===0){if(e.strictBrackets===!0)throw new SyntaxError(mt("opening","["));T({type:"text",value:l,output:`\\${l}`});continue}et("brackets");let d=h.value.slice(1);if(h.posix!==!0&&d[0]==="^"&&!d.includes("/")&&(l=`/${l}`),h.value+=l,tt({value:l}),e.literalBrackets===!1||W.hasRegexChars(d))continue;let S=W.escapeRegex(h.value);if(f.output=f.output.slice(0,-h.value.length),e.literalBrackets===!0){f.output+=S,h.value=S;continue}h.value=`(${a}${S}|${h.value})`,f.output+=h.value;continue}if(l==="{"&&e.nobrace!==!0){ut("braces");let d={type:"brace",value:l,output:"(",outputIndex:f.output.length,tokensIndex:f.tokens.length};L.push(d),T(d);continue}if(l==="}"){let d=L[L.length-1];if(e.nobrace===!0||!d){T({type:"text",value:l,output:l});continue}let S=")";if(d.dots===!0){let k=o.slice(),K=[];for(let j=k.length-1;j>=0&&(o.pop(),k[j].type!=="brace");j--)k[j].type!=="dots"&&K.unshift(k[j].value);S=Bi(K,e),f.backtrack=!0}if(d.comma!==!0&&d.dots!==!0){let k=f.output.slice(0,d.outputIndex),K=f.tokens.slice(d.tokensIndex);d.value=d.output="\\{",l=S="\\}",f.output=k;for(let j of K)f.output+=j.output||j.value}T({type:"brace",value:l,output:S}),et("braces"),L.pop();continue}if(l==="|"){O.length>0&&O[O.length-1].conditions++,T({type:"text",value:l});continue}if(l===","){let d=l,S=L[L.length-1];S&&q[q.length-1]==="braces"&&(S.comma=!0,d="|"),T({type:"comma",value:l,output:d});continue}if(l==="/"){if(h.type==="dot"&&f.index===f.start+1){f.start=f.index+1,f.consumed="",f.output="",o.pop(),h=s;continue}T({type:"slash",value:l,output:w});continue}if(l==="."){if(f.braces>0&&h.type==="dot"){h.value==="."&&(h.output=v);let d=L[L.length-1];h.type="dots",h.output+=l,h.value+=l,d.dots=!0;continue}if(f.braces+f.parens===0&&h.type!=="bos"&&h.type!=="slash"){T({type:"text",value:l,output:v});continue}T({type:"dot",value:l,output:v});continue}if(l==="?"){if(!(h&&h.value==="(")&&e.noextglob!==!0&&M()==="("&&M(2)!=="?"){ht("qmark",l);continue}if(h&&h.type==="paren"){let S=M(),k=l;if(S==="<"&&!W.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(h.value==="("&&!/[!=<:]/.test(S)||S==="<"&&!/<([!=]|\w+>)/.test($()))&&(k=`\\${l}`),T({type:"text",value:l,output:k});continue}if(e.dot!==!0&&(h.type==="slash"||h.type==="bos")){T({type:"qmark",value:l,output:I});continue}T({type:"qmark",value:l,output:b});continue}if(l==="!"){if(e.noextglob!==!0&&M()==="("&&(M(2)!=="?"||!/[!=<:]/.test(M(3)))){ht("negate",l);continue}if(e.nonegate!==!0&&f.index===0){xt();continue}}if(l==="+"){if(e.noextglob!==!0&&M()==="("&&M(2)!=="?"){ht("plus",l);continue}if(h&&h.value==="("||e.regex===!1){T({type:"plus",value:l,output:A});continue}if(h&&(h.type==="bracket"||h.type==="paren"||h.type==="brace")||f.parens>0){T({type:"plus",value:l});continue}T({type:"plus",value:A});continue}if(l==="@"){if(e.noextglob!==!0&&M()==="("&&M(2)!=="?"){T({type:"at",extglob:!0,value:l,output:""});continue}T({type:"text",value:l});continue}if(l!=="*"){(l==="$"||l==="^")&&(l=`\\${l}`);let d=Ii.exec($());d&&(l+=d[0],f.index+=d[0].length),T({type:"text",value:l});continue}if(h&&(h.type==="globstar"||h.star===!0)){h.type="star",h.star=!0,h.value+=l,h.output=H,f.backtrack=!0,f.globstar=!0,G(l);continue}let x=$();if(e.noextglob!==!0&&/^\([^?]/.test(x)){ht("star",l);continue}if(h.type==="star"){if(e.noglobstar===!0){G(l);continue}let d=h.prev,S=d.prev,k=d.type==="slash"||d.type==="bos",K=S&&(S.type==="star"||S.type==="globstar");if(e.bash===!0&&(!k||x[0]&&x[0]!=="/")){T({type:"star",value:l,output:""});continue}let j=f.braces>0&&(d.type==="comma"||d.type==="brace"),Xt=O.length&&(d.type==="pipe"||d.type==="paren");if(!k&&d.type!=="paren"&&!j&&!Xt){T({type:"star",value:l,output:""});continue}for(;x.slice(0,3)==="/**";){let Mt=n[f.index+4];if(Mt&&Mt!=="/")break;x=x.slice(3),G("/**",3)}if(d.type==="bos"&&z()){h.type="globstar",h.value+=l,h.output=B(e),f.output=h.output,f.globstar=!0,G(l);continue}if(d.type==="slash"&&d.prev.type!=="bos"&&!K&&z()){f.output=f.output.slice(0,-(d.output+h.output).length),d.output=`(?:${d.output}`,h.type="globstar",h.output=B(e)+(e.strictSlashes?")":"|$)"),h.value+=l,f.globstar=!0,f.output+=d.output+h.output,G(l);continue}if(d.type==="slash"&&d.prev.type!=="bos"&&x[0]==="/"){let Mt=x[1]!==void 0?"|$":"";f.output=f.output.slice(0,-(d.output+h.output).length),d.output=`(?:${d.output}`,h.type="globstar",h.output=`${B(e)}${w}|${w}${Mt})`,h.value+=l,f.output+=d.output+h.output,f.globstar=!0,G(l+Y()),T({type:"slash",value:"/",output:""});continue}if(d.type==="bos"&&x[0]==="/"){h.type="globstar",h.value+=l,h.output=`(?:^|${w}|${B(e)}${w})`,f.output=h.output,f.globstar=!0,G(l+Y()),T({type:"slash",value:"/",output:""});continue}f.output=f.output.slice(0,-h.output.length),h.type="globstar",h.output=B(e),h.value+=l,f.output+=h.output,f.globstar=!0,G(l);continue}let F={type:"star",value:l,output:H};if(e.bash===!0){F.output=".*?",(h.type==="bos"||h.type==="slash")&&(F.output=_+F.output),T(F);continue}if(h&&(h.type==="bracket"||h.type==="paren")&&e.regex===!0){F.output=l,T(F);continue}(f.index===f.start||h.type==="slash"||h.type==="dot")&&(h.type==="dot"?(f.output+=R,h.output+=R):e.dot===!0?(f.output+=C,h.output+=C):(f.output+=_,h.output+=_),M()!=="*"&&(f.output+=m,h.output+=m)),T(F)}for(;f.brackets>0;){if(e.strictBrackets===!0)throw new SyntaxError(mt("closing","]"));f.output=W.escapeLast(f.output,"["),et("brackets")}for(;f.parens>0;){if(e.strictBrackets===!0)throw new SyntaxError(mt("closing",")"));f.output=W.escapeLast(f.output,"("),et("parens")}for(;f.braces>0;){if(e.strictBrackets===!0)throw new SyntaxError(mt("closing","}"));f.output=W.escapeLast(f.output,"{"),et("braces")}if(e.strictSlashes!==!0&&(h.type==="star"||h.type==="bracket")&&T({type:"maybe_slash",value:"",output:`${w}?`}),f.backtrack===!0){f.output="";for(let x of f.tokens)f.output+=x.output!=null?x.output:x.value,x.suffix&&(f.output+=x.suffix)}return f};Yn.fastpaths=(n,t)=>{let e={...t},r=typeof e.maxLength=="number"?Math.min(zt,e.maxLength):zt,i=n.length;if(i>r)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${r}`);n=Kn[n]||n;let s=W.isWindows(t),{DOT_LITERAL:o,SLASH_LITERAL:a,ONE_CHAR:u,DOTS_SLASH:c,NO_DOT:p,NO_DOTS:v,NO_DOTS_SLASH:A,STAR:w,START_ANCHOR:m}=jt.globChars(s),g=e.dot?v:p,E=e.dot?A:p,R=e.capture?"":"?:",C={negated:!1,prefix:""},b=e.bash===!0?".*?":w;e.capture&&(b=`(${b})`);let I=_=>_.noglobstar===!0?b:`(${R}(?:(?!${m}${_.dot?c:o}).)*?)`,N=_=>{switch(_){case"*":return`${g}${u}${b}`;case".*":return`${o}${u}${b}`;case"*.*":return`${g}${b}${o}${u}${b}`;case"*/*":return`${g}${b}${a}${u}${E}${b}`;case"**":return g+I(e);case"**/*":return`(?:${g}${I(e)}${a})?${E}${u}${b}`;case"**/*.*":return`(?:${g}${I(e)}${a})?${E}${b}${o}${u}${b}`;case"**/.*":return`(?:${g}${I(e)}${a})?${o}${u}${b}`;default:{let y=/^(.*?)\.(\w+)$/.exec(_);if(!y)return;let H=N(y[1]);return H?H+o+y[2]:void 0}}},P=W.removePrefix(n,C),B=N(P);return B&&e.strictSlashes!==!0&&(B+=`${a}?`),B};Vn.exports=Yn});var Wn=ct((go,qn)=>{"use strict";var Oi=kt(),Fi=Gn(),Te=Xn(),Se=Ht(),Di=At(),Pi=n=>n&&typeof n=="object"&&!Array.isArray(n),U=(n,t,e=!1)=>{if(Array.isArray(n)){let p=n.map(A=>U(A,t,e));return A=>{for(let w of p){let m=w(A);if(m)return m}return!1}}let r=Pi(n)&&n.tokens&&n.input;if(n===""||typeof n!="string"&&!r)throw new TypeError("Expected pattern to be a non-empty string");let i=t||{},s=Se.isWindows(t),o=r?U.compileRe(n,t):U.makeRe(n,t,!1,!0),a=o.state;delete o.state;let u=()=>!1;if(i.ignore){let p={...t,ignore:null,onMatch:null,onResult:null};u=U(i.ignore,p,e)}let c=(p,v=!1)=>{let{isMatch:A,match:w,output:m}=U.test(p,o,t,{glob:n,posix:s}),g={glob:n,state:a,regex:o,posix:s,input:p,output:m,match:w,isMatch:A};return typeof i.onResult=="function"&&i.onResult(g),A===!1?(g.isMatch=!1,v?g:!1):u(p)?(typeof i.onIgnore=="function"&&i.onIgnore(g),g.isMatch=!1,v?g:!1):(typeof i.onMatch=="function"&&i.onMatch(g),v?g:!0)};return e&&(c.state=a),c};U.test=(n,t,e,{glob:r,posix:i}={})=>{if(typeof n!="string")throw new TypeError("Expected input to be a string");if(n==="")return{isMatch:!1,output:""};let s=e||{},o=s.format||(i?Se.toPosixSlashes:null),a=n===r,u=a&&o?o(n):n;return a===!1&&(u=o?o(n):n,a=u===r),(a===!1||s.capture===!0)&&(s.matchBase===!0||s.basename===!0?a=U.matchBase(n,t,e,i):a=t.exec(u)),{isMatch:Boolean(a),match:a,output:u}};U.matchBase=(n,t,e,r=Se.isWindows(e))=>(t instanceof RegExp?t:U.makeRe(t,e)).test(Oi.basename(n));U.isMatch=(n,t,e)=>U(t,e)(n);U.parse=(n,t)=>Array.isArray(n)?n.map(e=>U.parse(e,t)):Te(n,{...t,fastpaths:!1});U.scan=(n,t)=>Fi(n,t);U.compileRe=(n,t,e=!1,r=!1)=>{if(e===!0)return n.output;let i=t||{},s=i.contains?"":"^",o=i.contains?"":"$",a=`${s}(?:${n.output})${o}`;n&&n.negated===!0&&(a=`^(?!${a}).*$`);let u=U.toRegex(a,t);return r===!0&&(u.state=n),u};U.makeRe=(n,t={},e=!1,r=!1)=>{if(!n||typeof n!="string")throw new TypeError("Expected a non-empty string");let i={negated:!1,fastpaths:!0};return t.fastpaths!==!1&&(n[0]==="."||n[0]==="*")&&(i.output=Te.fastpaths(n,t)),i.output||(i=Te(n,t)),U.compileRe(i,t,e,r)};U.toRegex=(n,t)=>{try{let e=t||{};return new RegExp(n,e.flags||(e.nocase?"i":""))}catch(e){if(t&&t.debug===!0)throw e;return/$^/}};U.constants=Di;qn.exports=U});var Qn=ct((yo,Zn)=>{"use strict";Zn.exports=Wn()});var Mr=`<div class="container">
    <label class="hidden" id="title">display-port</label>
    <label class="hidden" id="fps">00</label>
    <label class="hidden" id="dimension">0x0</label>
    <div class="content">
        <canvas>
            Oh no! Your browser does not support canvas.
        </canvas>
        <slot id="inner"></slot>
    </div>
    <slot name="frame"></slot>
</div>`,Lr=`:host {
    display: inline-block;
    color: #555555;
}

.container {
    display: flex;
    position: relative;
    width: 100%;
    height: 100%;
}

.content {
    position: relative;
    margin: auto;
}

.content > *:not(canvas) {
    width: 100%;
    height: 100%;
}

canvas {
    background: #000000;
    image-rendering: pixelated;
}

label {
    position: absolute;
    font-family: monospace;
    color: currentColor;
}

#inner {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    pointer-events: none;
}

#title {
    left: 0.5rem;
    top: 0.5rem;
}

#fps {
    right: 0.5rem;
    top: 0.5rem;
}

#dimension {
    left: 0.5rem;
    bottom: 0.5rem;
}

.hidden {
    display: none;
}

:host([debug]) .container {
    outline: 6px dashed rgba(0, 0, 0, 0.1);
    outline-offset: -4px;
    background-color: rgba(0, 0, 0, 0.1);
}

:host([mode="noscale"]) canvas {
    margin: 0;
    top: 0;
    left: 0;
}

:host([mode="stretch"]) canvas,
:host([mode="scale"]) canvas {
    width: 100%;
    height: 100%;
}

:host([mode="fit"]),
:host([mode="scale"]),
:host([mode="center"]),
:host([mode="stretch"]),
:host([mode="fill"]) {
    width: 100%;
    height: 100%;
}

:host([full]) {
    width: 100vw !important;
    height: 100vh !important;
}

:host([disabled]) {
    display: none;
}

slot {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    pointer-events: none;
}

::slotted(*) {
    pointer-events: auto;
}
`,Ke="noscale",Wt="fit",Ye="scale",Xe="fill",qe="stretch",Cr=300,Ir=150,Nr=Wt,Br=200,We=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=Mr,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Lr,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("display-port",this)}static get observedAttributes(){return["debug","disabled","width","height","onframe","id","class"]}get mode(){return this.getAttribute("mode")}set mode(t){this.setAttribute("mode",t)}get debug(){return this._debug}set debug(t){this.toggleAttribute("debug",t)}get disabled(){return this._disabled}set disabled(t){this.toggleAttribute("disabled",t)}get width(){return this._width}set width(t){this.setAttribute("width",String(t))}get height(){return this._height}set height(t){this.setAttribute("height",String(t))}get onframe(){return this._onframe}set onframe(t){this._onframe&&this.removeEventListener("frame",this._onframe),this._onframe=t,this._onframe&&this.addEventListener("frame",t)}constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._canvasElement=this.shadowRoot.querySelector("canvas"),this._contentElement=this.shadowRoot.querySelector(".content"),this._innerElement=this.shadowRoot.querySelector("#inner"),this._titleElement=this.shadowRoot.querySelector("#title"),this._fpsElement=this.shadowRoot.querySelector("#fps"),this._dimensionElement=this.shadowRoot.querySelector("#dimension"),this._debug=!1,this._disabled=!1,this._width=Cr,this._height=Ir,this._onframe=void 0,this._animationRequestHandle=0,this._prevAnimationFrameTime=0,this._resizeTimeoutHandle=0,this._resizeCanvasWidth=0,this._resizeCanvasHeight=0,this.update=this.update.bind(this),this.onDelayCanvasResize=this.onDelayCanvasResize.bind(this)}get canvas(){return this._canvasElement}connectedCallback(){pt(this,"mode"),pt(this,"debug"),pt(this,"disabled"),pt(this,"width"),pt(this,"height"),pt(this,"onframe"),this.hasAttribute("mode")||this.setAttribute("mode",Nr),this.hasAttribute("tabindex")||this.setAttribute("tabindex","0"),this.updateCanvasSize(!0),this.resume()}disconnectedCallback(){this.pause()}attributeChangedCallback(t,e,r){switch(t){case"debug":this._debug=r!==null;break;case"disabled":this._disabled=r!==null;break;case"width":this._width=Number(r);break;case"height":this._height=Number(r);break;case"onframe":this.onframe=new Function("event","with(document){with(this){"+r+"}}").bind(this);break}switch(t){case"disabled":r?(this.update(0),this.pause()):this.resume();break;case"id":case"class":this._titleElement.innerHTML=`display-port${this.className?"."+this.className:""}${this.hasAttribute("id")?"#"+this.getAttribute("id"):""}`;break;case"debug":this._titleElement.classList.toggle("hidden",r),this._fpsElement.classList.toggle("hidden",r),this._dimensionElement.classList.toggle("hidden",r);break}}getContext(t="2d",e=void 0){return this._canvasElement.getContext(t,e)}pause(){cancelAnimationFrame(this._animationRequestHandle)}resume(){this._animationRequestHandle=requestAnimationFrame(this.update)}update(t){this._animationRequestHandle=requestAnimationFrame(this.update),this.updateCanvasSize(!1);let e=t-this._prevAnimationFrameTime;if(this._prevAnimationFrameTime=t,this._debug){let r=e<=0?"--":String(Math.round(1e3/e)).padStart(2,"0");if(this._fpsElement.textContent!==r&&(this._fpsElement.textContent=r),this.mode===Ke){let s=`${this._width}x${this._height}`;this._dimensionElement.textContent!==s&&(this._dimensionElement.textContent=s)}else{let s=`${this._width}x${this._height}|${this.shadowRoot.host.clientWidth}x${this.shadowRoot.host.clientHeight}`;this._dimensionElement.textContent!==s&&(this._dimensionElement.textContent=s)}}this.dispatchEvent(new CustomEvent("frame",{detail:{now:t,prevTime:this._prevAnimationFrameTime,deltaTime:e,canvas:this._canvasElement},bubbles:!1,composed:!0}))}onDelayCanvasResize(){this._resizeTimeoutHandle=0,this.updateCanvasSize(!0)}delayCanvasResize(t,e){(t!==this._resizeCanvasWidth||e!==this._resizeCanvasHeight)&&(this._resizeCanvasWidth=t,this._resizeCanvasHeight=e,this._resizeTimeoutHandle&&clearTimeout(this._resizeTimeoutHandle),this._resizeTimeoutHandle=setTimeout(this.onDelayCanvasResize,Br))}updateCanvasSize(t=!0){let e=this.shadowRoot.host.getBoundingClientRect(),r=e.width,i=e.height,s=this._canvasElement,o=this._width,a=this._height,u=this.mode;if(u===qe||u===Xe)o=r,a=i;else if(u!==Ke&&(r<o||i<a||u===Wt||u==Ye)){let p=r/o,v=i/a;p<v?(o=r,a=a*p):(o=o*v,a=i)}if(o=Math.floor(o),a=Math.floor(a),typeof t=="undefined"&&(t=s.clientWidth!==o||s.clientHeight!==a),!t){this.delayCanvasResize(o,a);return}let c=Math.min(o/this._width,a/this._height)*.5;if(this._innerElement.style.fontSize=`font-size: ${c}em`,t){u===Ye?(s.width=this._width,s.height=this._height):u!==qe&&(s.width=o,s.height=a);let p=this._contentElement.style;p.width=`${o}px`,p.height=`${a}px`,(u===Wt||u===Xe)&&(this._width=o,this._height=a),this.dispatchEvent(new CustomEvent("resize",{detail:{width:o,height:a},bubbles:!1,composed:!0}))}}};We.define();function pt(n,t){if(Object.prototype.hasOwnProperty.call(n,t)){let e=n[t];delete n[t],n[t]=e}}var Zt=class{get polling(){return performance.now()-this._lastPollingTime<1e3}get value(){return 0}get size(){return this._size}constructor(t){this._size=t,this._lastPollingTime=Number.MIN_SAFE_INTEGER}resize(t){this._size=t}getState(t){throw new Error("Missing implementation.")}onUpdate(t,e,r){throw new Error("Missing implementation.")}onStatus(t,e){throw new Error("Missing implementation.")}onPoll(t){this._lastPollingTime=t}onBind(t,e={}){t>=this._size&&this.resize(t+1)}onUnbind(){this.resize(0)}},_t=class extends Zt{static createAxisBindingState(){return{value:0,delta:0,inverted:!1}}get delta(){return this._delta}get value(){return this._value}constructor(t=0){super(t);let e=new Array;for(let r=0;r<t;++r)e.push(this.constructor.createAxisBindingState());this._state=e,this._value=0,this._delta=0}resize(t){let e=this._state,r=e.length,i;if(t<=r)i=e.slice(0,t);else{i=e;for(let s=r;s<t;++s)i.push(this.constructor.createAxisBindingState())}this._state=i,super.resize(t)}getState(t){return this._state[t].value}onPoll(t){let e=this._state,r=0,i=0,s=e.length;for(let o=0;o<s;++o){let a=e[o];r+=a.value*(a.inverted?-1:1),i+=a.delta,e[o].delta=0}this._value=r,this._delta=i,super.onPoll(t)}onUpdate(t,e,r){typeof e=="undefined"?this.onAxisChange(t,r):this.onAxisMove(t,e,r)}onStatus(t,e){this.onAxisStatus(t,e)}onBind(t,e={}){super.onBind(t,e);let{inverted:r=!1}=e,i=this._state;i[t].inverted=r}onAxisMove(t,e,r){let i=this._state[t];i.value=e,i.delta+=r}onAxisChange(t,e){let r=this._state[t];r.value+=e,r.delta+=e}onAxisStatus(t,e){let r=this._state[t],i=r.value;r.value=e,r.delta=e-i}},Or=241,Ze=254,Fr=239,ft=1,Qt=2,Jt=4,te=8,ee=16,Ct=class extends Zt{get pressed(){return this._pressed}get repeated(){return this._repeated}get released(){return this._released}get down(){return this._down}get value(){return this._value}constructor(t=0){super(t);this._state=new Uint8Array(t),this._value=0,this._down=!1,this._pressed=!1,this._repeated=!1,this._released=!1}resize(t){let e=this._state,r=e.length,i;t<=r?i=e.slice(0,t):(i=new Uint8Array(t),i.set(e)),this._state=i,super.resize(t)}getState(t){let e=this._state[t],r=e&ee?-1:1;return(e&ft?1:0)*r}onPoll(t){let e=this._state,r=0,i=0,s=0,o=0,a=0,u=e.length;for(let c=0;c<u;++c){let p=e[c],v=p&ft,A=p&ee;i|=v,s|=p&Qt,o|=p&Jt,a|=p&te,r+=(v?1:0)*(A?-1:1),e[c]&=Or}this._value=r,this._down=i!==0,this._pressed=s!==0,this._repeated=o!==0,this._released=a!==0,super.onPoll(t)}onUpdate(t,e,r){r>0?this.onButtonPressed(t):this.onButtonReleased(t)}onStatus(t,e){this.onButtonStatus(t,e!==0)}onBind(t,e={}){super.onBind(t,e);let{inverted:r=!1}=e,i=this._state;r?i[t]|=ee:i[t]&=Fr}onButtonPressed(t){let e=this._state,r=e[t];r&ft||(r|=Qt,r|=ft),r|=Jt,e[t]=r}onButtonReleased(t){let e=this._state,r=e[t];r&ft&&(r|=te,r&=Ze),e[t]=r}onButtonStatus(t,e){let r=this._state,i=r[t],s=Boolean(i&ft);e?i|=ft:i&=Ze,s&&!e&&(i|=te),!s&&e&&(i|=Qt,i|=Jt),r[t]=i}},ne=class{get polling(){return this.ref?this.ref.polling:!1}get value(){return this.ref?this.ref.value:0}constructor(t,e,r,i=void 0){this.name=t,this.device=e,this.code=r,this.opts=i,this.ref=null}setRef(t){return this.ref=t,this}getState(t){return this.ref?this.ref.getState(t):0}},st=class extends ne{get delta(){return this.ref?this.ref.delta:0}constructor(t,e,r,i){super(t,e,r,i)}},Z=class extends ne{get pressed(){return this.ref?this.ref.pressed:!1}get repeated(){return this.ref?this.ref.repeated:!1}get released(){return this.ref?this.ref.released:!1}get down(){return this.ref?this.ref.down:!1}constructor(t,e,r,i){super(t,e,r,i)}},Qe=class extends st{constructor(t,e,r,i){super(t,e,i,void 0);this.negativeCode=r}},re=class{static isAxis(t){return!1}static isButton(t){return!1}constructor(t,e){if(!e)throw new Error(`Missing event target for device ${t}.`);this.name=t,this.eventTarget=e,this.listeners={input:[]}}setEventTarget(t){if(!t)throw new Error(`Missing event target for device ${this.name}.`);this.eventTarget=t}destroy(){let t=this.listeners;for(let e in t)t[e].length=0}addEventListener(t,e){let r=this.listeners;t in r?r[t].push(e):r[t]=[e]}removeEventListener(t,e){let r=this.listeners;if(t in r){let i=r[t],s=i.indexOf(e);s>=0&&i.splice(s,1)}}dispatchInputEvent(t){let e=0;for(let r of this.listeners.input)e|=r(t);return Boolean(e)}},Je=class extends re{static isAxis(t){return!1}static isButton(t){return!0}constructor(t,e,r={}){super(t,e);let{ignoreRepeat:i=!0}=r;this.ignoreRepeat=i,this._eventObject={target:e,device:t,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),e.addEventListener("keydown",this.onKeyDown),e.addEventListener("keyup",this.onKeyUp)}setEventTarget(t){this.eventTarget&&this.destroy(),super.setEventTarget(t),t.addEventListener("keydown",this.onKeyDown),t.addEventListener("keyup",this.onKeyUp)}destroy(){let t=this.eventTarget;t.removeEventListener("keydown",this.onKeyDown),t.removeEventListener("keyup",this.onKeyUp),super.destroy()}onKeyDown(t){if(t.repeat&&this.ignoreRepeat)return t.preventDefault(),t.stopPropagation(),!1;let e=this._eventObject;if(e.code=t.code,e.event="pressed",e.value=1,e.control=t.ctrlKey,e.shift=t.shiftKey,e.alt=t.altKey,this.dispatchInputEvent(e))return t.preventDefault(),t.stopPropagation(),!1}onKeyUp(t){let e=this._eventObject;if(e.code=t.code,e.event="released",e.value=1,e.control=t.ctrlKey,e.shift=t.shiftKey,e.alt=t.altKey,this.dispatchInputEvent(e))return t.preventDefault(),t.stopPropagation(),!1}},ie=10,se=100,tn=class extends re{static isAxis(t){return t==="PosX"||t==="PosY"||t==="WheelX"||t==="WheelY"||t==="WheelZ"}static isButton(t){return!this.isAxis(t)}constructor(t,e,r={}){super(t,e);let{eventsOnFocus:i=!0}=r;this.eventsOnFocus=i,this.canvasTarget=this.getCanvasFromEventTarget(e),this._downHasFocus=!1,this._eventObject={target:e,device:t,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this._positionObject={target:e,device:t,code:"",event:"move",value:0,movement:0},this._wheelObject={target:e,device:t,code:"",event:"wheel",movement:0},this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onWheel=this.onWheel.bind(this),e.addEventListener("mousedown",this.onMouseDown),e.addEventListener("contextmenu",this.onContextMenu),e.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}setEventTarget(t){this.eventTarget&&this.destroy(),super.setEventTarget(t),this.canvasTarget=this.getCanvasFromEventTarget(t),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("contextmenu",this.onContextMenu),t.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}destroy(){let t=this.eventTarget;t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("contextmenu",this.onContextMenu),t.removeEventListener("wheel",this.onWheel),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),super.destroy()}setPointerLock(t=!0){t?this.eventTarget.requestPointerLock():this.eventTarget.exitPointerLock()}hasPointerLock(){return document.pointerLockElement===this.eventTarget}onMouseDown(t){this._downHasFocus=!0;let e=this._eventObject;if(e.code="Button"+t.button,e.event="pressed",e.value=1,e.control=t.ctrlKey,e.shift=t.shiftKey,e.alt=t.altKey,this.dispatchInputEvent(e)&&document.activeElement===this.eventTarget)return t.preventDefault(),t.stopPropagation(),!1}onContextMenu(t){return t.preventDefault(),t.stopPropagation(),!1}onWheel(t){let e,r,i;switch(t.deltaMode){case WheelEvent.DOM_DELTA_LINE:e=t.deltaX*ie,r=t.deltaY*ie,i=t.deltaZ*ie;break;case WheelEvent.DOM_DELTA_PAGE:e=t.deltaX*se,r=t.deltaY*se,i=t.deltaZ*se;break;case WheelEvent.DOM_DELTA_PIXEL:default:e=t.deltaX,r=t.deltaY,i=t.deltaZ;break}let s=0,o=this._wheelObject;if(o.code="WheelX",o.movement=e,s|=this.dispatchInputEvent(o),o.code="WheelY",o.movement=r,s|=this.dispatchInputEvent(o),o.code="WheelZ",o.movement=i,s|=this.dispatchInputEvent(o),s)return t.preventDefault(),t.stopPropagation(),!1}onMouseUp(t){if(!this._downHasFocus)return;this._downHasFocus=!1;let e=this._eventObject;if(e.code="Button"+t.button,e.event="released",e.value=1,e.control=t.ctrlKey,e.shift=t.shiftKey,e.alt=t.altKey,this.dispatchInputEvent(e))return t.preventDefault(),t.stopPropagation(),!1}onMouseMove(t){if(this.eventsOnFocus&&document.activeElement!==this.eventTarget)return;let e=this.canvasTarget,{clientWidth:r,clientHeight:i}=e,s=e.getBoundingClientRect(),o=t.movementX/r,a=t.movementY/i,u=(t.clientX-s.left)/r,c=(t.clientY-s.top)/i,p=this._positionObject;p.code="PosX",p.value=u,p.movement=o,this.dispatchInputEvent(p),p.code="PosY",p.value=c,p.movement=a,this.dispatchInputEvent(p)}getCanvasFromEventTarget(t){return t instanceof HTMLCanvasElement?t:t.canvas||t.querySelector("canvas")||t.shadowRoot&&t.shadowRoot.querySelector("canvas")||t}},Dr=`<kbd>
    <span id="name"><slot></slot></span>
    <span id="value" class="hidden"></span>
</kbd>
`,Pr=`kbd {
    position: relative;
    display: inline-block;
    border-radius: 3px;
    border: 1px solid #888888;
    font-size: 0.85em;
    font-weight: 700;
    text-rendering: optimizeLegibility;
    line-height: 12px;
    height: 14px;
    padding: 2px 4px;
    color: #444444;
    background-color: #eeeeee;
    box-shadow: inset 0 -3px 0 #aaaaaa;
    overflow: hidden;
}

kbd:empty::after {
    content: "<?>";
    opacity: 0.6;
}

.disabled {
    opacity: 0.6;
    box-shadow: none;
    background-color: #aaaaaa;
}

.hidden {
    display: none;
}

#value {
    position: absolute;
    top: 0;
    bottom: 0;
    right: 0;
    font-size: 0.85em;
    padding: 0 4px;
    padding-top: 2px;
    color: #cccccc;
    background-color: #333333;
    box-shadow: inset 0 3px 0 #222222;
}
`,oe=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=Dr,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Pr,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("input-code",this)}static get observedAttributes(){return["name","value","disabled"]}get disabled(){return this._disabled}set disabled(t){this.toggleAttribute("disabled",t)}get value(){return this._value}set value(t){this.setAttribute("value",t)}get name(){return this._name}set name(t){this.setAttribute("name",t)}constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._name="",this._value="",this._disabled=!1,this._kbdElement=this.shadowRoot.querySelector("kbd"),this._nameElement=this.shadowRoot.querySelector("#name"),this._valueElement=this.shadowRoot.querySelector("#value")}attributeChangedCallback(t,e,r){switch(t){case"name":this._name=r,this._nameElement.textContent=r;break;case"value":this._value=r,r!==null?(this._valueElement.classList.toggle("hidden",!1),this._valueElement.textContent=r,this._kbdElement.style.paddingRight=`${this._valueElement.clientWidth+4}px`):this._valueElement.classList.toggle("hidden",!0);break;case"disabled":this._disabled=r!==null,this._kbdElement.classList.toggle("disabled",r!==null);break}}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"name")){let t=this.name;delete this.name,this.name=t}if(Object.prototype.hasOwnProperty.call(this,"value")){let t=this.value;delete this.value,this.value=t}if(Object.prototype.hasOwnProperty.call(this,"disabled")){let t=this.disabled;delete this.disabled,this.disabled=t}}};oe.define();var kr=`<table>
    <thead>
        <tr class="tableHeader">
            <th colspan=3>
                <span class="tableTitle">
                    <label id="title">
                        input-source
                    </label>
                    <span id="slotContainer">
                        <slot></slot>
                    </span>
                    <p>
                        <label for="poll">poll</label>
                        <output id="poll"></output>
                    </p>
                    <p>
                        <label for="focus">focus</label>
                        <output id="focus"></output>
                    </p>
                </span>
            </th>
        </tr>
        <tr class="colHeader">
            <th>name</th>
            <th>value</th>
            <th>key</th>
        </tr>
    </thead>
    <tbody>
    </tbody>
</table>
`,Ur=`:host {
    display: block;
}

table {
    border-collapse: collapse;
    font-family: monospace;
}

table,
th,
td {
    border: 1px solid #666666;
}

th,
td {
    padding: 5px 10px;
}

td {
    text-align: center;
}

thead th {
    padding: 0;
}

.colHeader > th {
    font-size: 0.8em;
    padding: 0 10px;
    letter-spacing: 3px;
    background-color: #aaaaaa;
    color: #666666;
}

tbody output {
    border-radius: 0.3em;
    padding: 3px;
}

tr:not(.primary) .name,
tr:not(.primary) .value {
    opacity: 0.3;
}

tr:nth-child(2n) {
    background-color: #eeeeee;
}

.tableHeader {
    color: #666666;
}

.tableTitle {
    display: flex;
    flex-direction: row;
    align-items: center;
    padding: 4px;
}

#slotContainer {
    flex: 1;
}

p {
    display: inline;
    margin: 0;
    padding: 0;
    padding-right: 10px;
}

#poll:empty::after,
#focus:empty::after {
    content: "\u2717";
    color: #ff0000;
}
`,en=class{constructor(t){this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null,this.pollable=t}get running(){return this.animationFrameHandle!==null}start(){let t=this.animationFrameHandle;t&&cancelAnimationFrame(t),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}stop(){let t=this.animationFrameHandle;t&&cancelAnimationFrame(t),this.animationFrameHandle=null}onAnimationFrame(t){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.pollable.onPoll(t)}},nn=class{constructor(t){this.onInput=this.onInput.bind(this),this.onPoll=this.onPoll.bind(this),this.bindings=t}onPoll(t){for(let e of this.bindings.getInputs())e.onPoll(t)}onInput(t){let{device:e,code:r,event:i,value:s,movement:o,control:a,shift:u,alt:c}=t,p=this.bindings.getBindings(e,r);switch(i){case"pressed":for(let{input:v,index:A}of p)v.onUpdate(A,1,1);break;case"released":for(let{input:v,index:A}of p)v.onUpdate(A,0,-1);break;case"move":for(let{input:v,index:A}of p)v.onUpdate(A,s,o);break;case"wheel":for(let{input:v,index:A}of p)v.onUpdate(A,void 0,o);break}return p.length>0}},ae=class{constructor(t,e,r,i){this.device=t,this.code=e,this.input=r,this.index=i}},rn=class{constructor(){this.bindingMap={},this.inputMap=new Map}clear(){for(let t of this.inputMap.keys())t.onUnbind();this.inputMap.clear(),this.bindingMap={}}bind(t,e,r,i={}){let s,o=this.inputMap;if(o.has(t)){let u=o.get(t),c=t.size;t.onBind(c,i),s=new ae(e,r,t,c),u.push(s)}else{let u=[];o.set(t,u);let c=0;t.onBind(c,i),s=new ae(e,r,t,c),u.push(s)}let a=this.bindingMap;e in a?r in a[e]?a[e][r].push(s):a[e][r]=[s]:a[e]={[r]:[s]}}unbind(t){let e=this.inputMap;if(e.has(t)){let r=this.bindingMap,i=e.get(t);for(let s of i){let{device:o,code:a}=s,u=r[o][a],c=u.indexOf(s);u.splice(c,1)}i.length=0,t.onUnbind(),e.delete(t)}}isBound(t){return this.inputMap.has(t)}getInputs(){return this.inputMap.keys()}getBindingsByInput(t){return this.inputMap.get(t)}getBindings(t,e){let r=this.bindingMap;if(t in r){let i=r[t];if(e in i)return i[e]}return[]}},sn=class{constructor(t,e={}){this.inputs={},this.devices=[new tn("Mouse",t),new Je("Keyboard",t)],this.bindings=new rn,this.adapter=new nn(this.bindings),this.autopoller=new en(this.adapter),this.eventTarget=t,this.anyButton=new Ct(1),this.anyButtonDevice="",this.anyButtonCode="",this.anyAxis=new _t(1),this.anyAxisDevice="",this.anyAxisCode="",this.listeners={bind:[],unbind:[],focus:[],blur:[]},this.onInput=this.onInput.bind(this),this.onEventTargetBlur=this.onEventTargetBlur.bind(this),this.onEventTargetFocus=this.onEventTargetFocus.bind(this),t.addEventListener("focus",this.onEventTargetFocus),t.addEventListener("blur",this.onEventTargetBlur);for(let r of this.devices)r.addEventListener("input",this.onInput)}get autopoll(){return this.autopoller.running}set autopoll(t=void 0){this.toggleAutoPoll(t)}destroy(){let t=this.listeners;for(let r in t)t[r].length=0;this.autopoller.running&&this.autopoller.stop();for(let r of this.devices)r.removeEventListener("input",this.onInput),r.destroy();let e=this.eventTarget;e.removeEventListener("focus",this.onEventTargetFocus),e.removeEventListener("blur",this.onEventTargetBlur)}setEventTarget(t){let e=this.eventTarget;e.removeEventListener("focus",this.onEventTargetFocus),e.removeEventListener("blur",this.onEventTargetBlur),this.eventTarget=t;for(let r of this.devices)r.setEventTarget(t);t.addEventListener("focus",this.onEventTargetFocus),t.addEventListener("blur",this.onEventTargetBlur)}toggleAutoPoll(t=void 0){let e=this.autopoller.running,r=typeof t=="undefined"?!e:Boolean(t);r!==e&&(r?this.autopoller.start():this.autopoller.stop())}addEventListener(t,e){let r=this.listeners;t in r?r[t].push(e):r[t]=[e]}removeEventListener(t,e){let r=this.listeners;if(t in r){let i=r[t],s=i.indexOf(e);s>=0&&i.splice(s,1)}}dispatchEvent(t){let{type:e}=t,r=0;for(let i of this.listeners[e])r|=i(t);return Boolean(r)}poll(t=performance.now()){if(this.autopoller.running)throw new Error("Should not manually poll() while autopolling.");this.onPoll(t)}onInput(t){let e=this.adapter.onInput(t);switch(t.event){case"pressed":this.anyButtonDevice=t.device,this.anyButtonCode=t.code,this.anyButton.onUpdate(0,1,1);break;case"released":this.anyButtonDevice=t.device,this.anyButtonCode=t.code,this.anyButton.onUpdate(0,0,-1);break;case"move":case"wheel":this.anyAxisDevice=t.device,this.anyAxisCode=t.code,this.anyAxis.onUpdate(0,t.value,t.movement);break}return e}onPoll(t){this.adapter.onPoll(t),this.anyButton.onPoll(t),this.anyAxis.onPoll(t)}onBind(){this.dispatchEvent({type:"bind"})}onUnbind(){this.dispatchEvent({type:"unbind"})}onEventTargetFocus(){this.dispatchEvent({type:"focus"})}onEventTargetBlur(){for(let t of this.bindings.getInputs())t.onStatus(0,0);this.anyButton.onStatus(0,0),this.anyAxis.onStatus(0,0),this.dispatchEvent({type:"blur"})}bindBindings(t){for(let e of t){let r=e.name;if(e instanceof st)this.bindAxis(r,e.device,e.code,e.opts),e.setRef(this.getAxis(r));else if(e instanceof Z)this.bindButton(r,e.device,e.code,e.opts),e.setRef(this.getButton(r));else if(e instanceof Qe)this.bindAxisButtons(r,e.device,e.negativeCode,e.code),e.setRef(this.getAxis(r));else throw new Error("Unknown binding type.")}}bindButton(t,e,r,i=void 0){let s;this.hasButton(t)?s=this.getButton(t):(s=new Ct(1),this.inputs[t]=s),this.bindings.bind(s,e,r,i),this.onBind()}bindAxis(t,e,r,i=void 0){let s;this.hasAxis(t)?s=this.getAxis(t):(s=new _t(1),this.inputs[t]=s),this.bindings.bind(s,e,r,i),this.onBind()}bindAxisButtons(t,e,r,i){let s;this.hasAxis(t)?s=this.getAxis(t):(s=new _t(2),this.inputs[t]=s),this.bindings.bind(s,e,i),this.bindings.bind(s,e,r,{inverted:!0}),this.onBind()}unbindButton(t){if(this.hasButton(t)){let e=this.getButton(t);delete this.inputs[t],this.bindings.unbind(e),this.onUnbind()}}unbindAxis(t){if(this.hasAxis(t)){let e=this.getAxis(t);delete this.inputs[t],this.bindings.unbind(e),this.onUnbind()}}getInput(t){return this.inputs[t]}getButton(t){return this.inputs[t]}getAxis(t){return this.inputs[t]}hasButton(t){return t in this.inputs&&this.inputs[t]instanceof Ct}hasAxis(t){return t in this.inputs&&this.inputs[t]instanceof _t}isButtonDown(t){return this.inputs[t].down}isButtonPressed(t){return this.inputs[t].pressed}isButtonReleased(t){return this.inputs[t].released}getInputValue(t){return this.inputs[t].value}getButtonValue(t){return this.inputs[t].value}getAxisValue(t){return this.inputs[t].value}getAxisDelta(t){return this.inputs[t].delta}isAnyButtonDown(t=void 0){if(typeof t=="undefined")return this.anyButton.down;{let e=this.inputs;for(let r of t)if(e[r].down)return!0}return!1}isAnyButtonPressed(t=void 0){if(typeof t=="undefined")return this.anyButton.pressed;{let e=this.inputs;for(let r of t)if(e[r].pressed)return!0}return!1}isAnyButtonReleased(t=void 0){if(typeof t=="undefined")return this.anyButton.released;{let e=this.inputs;for(let r of t)if(e[r].released)return!0}return!1}getAnyAxisValue(t=void 0){if(typeof t=="undefined")return this.anyAxis.value;{let e=this.inputs;for(let r of t){let i=e[r];if(i.value)return i.value}}return 0}getAnyAxisDelta(t=void 0){if(typeof t=="undefined")return this.anyAxis.delta;{let e=this.inputs;for(let r of t){let i=e[r];if(i.delta)return i.delta}}return 0}getLastButtonDevice(){return this.anyButtonDevice}getLastButtonCode(){return this.anyButtonCode}getLastAxisDevice(){return this.anyAxisDevice}getLastAxisCode(){return this.anyAxisCode}getMouse(){return this.devices[0]}getKeyboard(){return this.devices[1]}},on=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=kr,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Ur,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("input-port",this)}static get observedAttributes(){return["autopoll","for"]}get autopoll(){return this._autopoll}set autopoll(t){this.toggleAttribute("autopoll",t)}get for(){return this._for}set for(t){this.setAttribute("for",t)}constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._titleElement=this.shadowRoot.querySelector("#title"),this._pollElement=this.shadowRoot.querySelector("#poll"),this._focusElement=this.shadowRoot.querySelector("#focus"),this._bodyElement=this.shadowRoot.querySelector("tbody"),this._outputElements={},this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null;let t=this;this._for="",this._eventTarget=t,this._autopoll=!1,this._context=null,this.onInputContextBind=this.onInputContextBind.bind(this),this.onInputContextUnbind=this.onInputContextUnbind.bind(this),this.onInputContextFocus=this.onInputContextFocus.bind(this),this.onInputContextBlur=this.onInputContextBlur.bind(this)}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"for")){let t=this.for;delete this.for,this.for=t}if(Object.prototype.hasOwnProperty.call(this,"autopoll")){let t=this.autopoll;delete this.autopoll,this.autopoll=t}this.updateTable(),this.updateTableValues(),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}disconnectedCallback(){this._context&&(this._context.removeEventListener("bind",this.onInputContextBind),this._context.removeEventListener("unbind",this.onInputContextUnbind),this._context.removeEventListener("blur",this.onInputContextBlur),this._context.removeEventListener("focus",this.onInputContextFocus),this._context.destroy(),this._context=null)}attributeChangedCallback(t,e,r){switch(t){case"for":{this._for=r;let i,s;r?(i=document.getElementById(r),s=`${i.tagName.toLowerCase()}#${r}`):(i=this,s="input-port"),this._eventTarget=i,this._context&&this._context.setEventTarget(this._eventTarget),this._titleElement.innerHTML=`for ${s}`}break;case"autopoll":this._autopoll=r!==null,this._context&&this._context.toggleAutoPoll(this._autopoll);break}}onAnimationFrame(){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.updateTableValues(),this.updatePollStatus()}onInputContextBind(){this.updateTable()}onInputContextUnbind(){this.updateTable()}onInputContextFocus(){this._focusElement.innerHTML="\u2713"}onInputContextBlur(){this._focusElement.innerHTML=""}getContext(t="axisbutton",e=void 0){switch(t){case"axisbutton":return this._context||(this._context=new sn(this._eventTarget,e),this._context.addEventListener("bind",this.onInputContextBind),this._context.addEventListener("unbind",this.onInputContextUnbind),this._context.addEventListener("blur",this.onInputContextBlur),this._context.addEventListener("focus",this.onInputContextFocus),this._autopoll&&this._context.toggleAutoPoll(!0)),this._context;default:throw new Error(`Input context id '${t}' is not supported.`)}}updateTable(){if(this.isConnected)if(this._context){let t=this._context,e=t.inputs,r=t.bindings,i={},s=[];for(let o of Object.keys(e)){let a=e[o],u=!0;for(let c of r.getBindingsByInput(a)){let p=Hr(`${a.constructor.name}.${o}`,`${c.device}.${c.code}`,0,u);s.push(p),u&&(i[o]=p.querySelector("output"),u=!1)}}this._outputElements=i,this._bodyElement.innerHTML="";for(let o of s)this._bodyElement.appendChild(o)}else{this._outputElements={},this._bodyElement.innerHTML="";return}else return}updateTableValues(){if(this.isConnected)if(this._context){let e=this._context.inputs;for(let r of Object.keys(this._outputElements)){let i=this._outputElements[r],s=e[r].value;i.innerText=Number(s).toFixed(2)}}else{for(let t of Object.keys(this._outputElements)){let e=this._outputElements[t];e.innerText="---"}return}else return}updatePollStatus(){if(this.isConnected)if(this._context){let e=this._context.inputs;for(let r of Object.values(e))if(!r.polling){this._pollElement.innerHTML="";return}this._pollElement.innerHTML="\u2713"}else{this._pollElement.innerHTML="-";return}else return}};on.define();function Hr(n,t,e,r=!0){let i=document.createElement("tr");r&&i.classList.add("primary");{let s=document.createElement("td");s.textContent=n,s.classList.add("name"),i.appendChild(s)}{let s=document.createElement("td"),o=document.createElement("output");r?o.innerText=Number(e).toFixed(2):o.innerText="---",o.classList.add("value"),s.appendChild(o),i.appendChild(s)}{let s=document.createElement("td");s.classList.add("key");let o=new oe;o.innerText=t,s.appendChild(o),i.appendChild(s)}return i}var uo=Symbol("keyboardSource");var lo=Symbol("mouseSource");var an={},jr=function(n,t,e,r,i){var s=new Worker(an[t]||(an[t]=URL.createObjectURL(new Blob([n],{type:"text/javascript"}))));return s.onerror=function(o){return i(o.error,null)},s.onmessage=function(o){return i(null,o.data)},s.postMessage(e,r),s},V=Uint8Array,nt=Uint16Array,gt=Uint32Array,ue=new V([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),le=new V([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),un=new V([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ln=function(n,t){for(var e=new nt(31),r=0;r<31;++r)e[r]=t+=1<<n[r-1];for(var i=new gt(e[30]),r=1;r<30;++r)for(var s=e[r];s<e[r+1];++s)i[s]=s-e[r]<<5|r;return[e,i]},hn=ln(ue,2),he=hn[0],zr=hn[1];he[28]=258,zr[258]=28;var cn=ln(le,0),fn=cn[0],co=cn[1],It=new nt(32768);for(var D=0;D<32768;++D)ot=(D&43690)>>>1|(D&21845)<<1,ot=(ot&52428)>>>2|(ot&13107)<<2,ot=(ot&61680)>>>4|(ot&3855)<<4,It[D]=((ot&65280)>>>8|(ot&255)<<8)>>>1;var ot,dt=function(n,t,e){for(var r=n.length,i=0,s=new nt(t);i<r;++i)++s[n[i]-1];var o=new nt(t);for(i=0;i<t;++i)o[i]=o[i-1]+s[i-1]<<1;var a;if(e){a=new nt(1<<t);var u=15-t;for(i=0;i<r;++i)if(n[i])for(var c=i<<4|n[i],p=t-n[i],v=o[n[i]-1]++<<p,A=v|(1<<p)-1;v<=A;++v)a[It[v]>>>u]=c}else for(a=new nt(r),i=0;i<r;++i)n[i]&&(a[i]=It[o[n[i]-1]++]>>>15-n[i]);return a},yt=new V(288);for(var D=0;D<144;++D)yt[D]=8;for(var D=144;D<256;++D)yt[D]=9;for(var D=256;D<280;++D)yt[D]=7;for(var D=280;D<288;++D)yt[D]=8;var pn=new V(32);for(var D=0;D<32;++D)pn[D]=5;var dn=dt(yt,9,1);var mn=dt(pn,5,1),Nt=function(n){for(var t=n[0],e=1;e<n.length;++e)n[e]>t&&(t=n[e]);return t},Q=function(n,t,e){var r=t/8|0;return(n[r]|n[r+1]<<8)>>(t&7)&e},Bt=function(n,t){var e=t/8|0;return(n[e]|n[e+1]<<8|n[e+2]<<16)>>(t&7)},vn=function(n){return(n/8|0)+(n&7&&1)},Ot=function(n,t,e){(t==null||t<0)&&(t=0),(e==null||e>n.length)&&(e=n.length);var r=new(n instanceof nt?nt:n instanceof gt?gt:V)(e-t);return r.set(n.subarray(t,e)),r},xn=function(n,t,e){var r=n.length;if(!r||e&&!e.l&&r<5)return t||new V(0);var i=!t||e,s=!e||e.i;e||(e={}),t||(t=new V(r*3));var o=function(T){var ht=t.length;if(T>ht){var Rt=new V(Math.max(ht*2,T));Rt.set(t),t=Rt}},a=e.f||0,u=e.p||0,c=e.b||0,p=e.l,v=e.d,A=e.m,w=e.n,m=r*8;do{if(!p){e.f=a=Q(n,u,1);var g=Q(n,u+1,3);if(u+=3,g)if(g==1)p=dn,v=mn,A=9,w=5;else if(g==2){var b=Q(n,u,31)+257,I=Q(n,u+10,15)+4,N=b+Q(n,u+5,31)+1;u+=14;for(var P=new V(N),B=new V(19),_=0;_<I;++_)B[un[_]]=Q(n,u+_*3,7);u+=I*3;for(var y=Nt(B),H=(1<<y)-1,f=dt(B,y,1),_=0;_<N;){var O=f[Q(n,u,H)];u+=O&15;var E=O>>>4;if(E<16)P[_++]=E;else{var L=0,q=0;for(E==16?(q=3+Q(n,u,3),u+=2,L=P[_-1]):E==17?(q=3+Q(n,u,7),u+=3):E==18&&(q=11+Q(n,u,127),u+=7);q--;)P[_++]=L}}var h=P.subarray(0,b),l=P.subarray(b);A=Nt(h),w=Nt(l),p=dt(h,A,1),v=dt(l,w,1)}else throw"invalid block type";else{var E=vn(u)+4,R=n[E-4]|n[E-3]<<8,C=E+R;if(C>r){if(s)throw"unexpected EOF";break}i&&o(c+R),t.set(n.subarray(E,C),c),e.b=c+=R,e.p=u=C*8;continue}if(u>m){if(s)throw"unexpected EOF";break}}i&&o(c+131072);for(var z=(1<<A)-1,M=(1<<w)-1,Y=u;;Y=u){var L=p[Bt(n,u)&z],$=L>>>4;if(u+=L&15,u>m){if(s)throw"unexpected EOF";break}if(!L)throw"invalid length/literal";if($<256)t[c++]=$;else if($==256){Y=u,p=null;break}else{var G=$-254;if($>264){var _=$-257,tt=ue[_];G=Q(n,u,(1<<tt)-1)+he[_],u+=tt}var xt=v[Bt(n,u)&M],ut=xt>>>4;if(!xt)throw"invalid distance";u+=xt&15;var l=fn[ut];if(ut>3){var tt=le[ut];l+=Bt(n,u)&(1<<tt)-1,u+=tt}if(u>m){if(s)throw"unexpected EOF";break}i&&o(c+131072);for(var et=c+G;c<et;c+=4)t[c]=t[c-l],t[c+1]=t[c+1-l],t[c+2]=t[c+2-l],t[c+3]=t[c+3-l];c=et}}e.l=p,e.p=Y,e.b=c,p&&(a=1,e.m=A,e.d=v,e.n=w)}while(!a);return c==t.length?t:Ot(t,0,c)};var $r=new V(0);var Gr=function(n,t){var e={};for(var r in n)e[r]=n[r];for(var r in t)e[r]=t[r];return e},_n=function(n,t,e){for(var r=n(),i=n.toString(),s=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/ /g,"").split(","),o=0;o<r.length;++o){var a=r[o],u=s[o];if(typeof a=="function"){t+=";"+u+"=";var c=a.toString();if(a.prototype)if(c.indexOf("[native code]")!=-1){var p=c.indexOf(" ",8)+1;t+=c.slice(p,c.indexOf("(",p))}else{t+=c;for(var v in a.prototype)t+=";"+u+".prototype."+v+"="+a.prototype[v].toString()}else t+=c}else e[u]=a}return[t,e]},Ft=[],Vr=function(n){var t=[];for(var e in n)(n[e]instanceof V||n[e]instanceof nt||n[e]instanceof gt)&&t.push((n[e]=new n[e].constructor(n[e])).buffer);return t},Kr=function(n,t,e,r){var i;if(!Ft[e]){for(var s="",o={},a=n.length-1,u=0;u<a;++u)i=_n(n[u],s,o),s=i[0],o=i[1];Ft[e]=_n(n[a],s,o)}var c=Gr({},Ft[e][1]);return jr(Ft[e][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",e,c,Vr(c),r)},Yr=function(){return[V,nt,gt,ue,le,un,he,fn,dn,mn,It,dt,Nt,Q,Bt,vn,Ot,xn,ce,gn,yn]};var gn=function(n){return postMessage(n,[n.buffer])},yn=function(n){return n&&n.size&&new V(n.size)},Xr=function(n,t,e,r,i,s){var o=Kr(e,r,i,function(a,u){o.terminate(),s(a,u)});return o.postMessage([n,t],t.consume?[n.buffer]:[]),function(){o.terminate()}};var rt=function(n,t){return n[t]|n[t+1]<<8},J=function(n,t){return(n[t]|n[t+1]<<8|n[t+2]<<16|n[t+3]<<24)>>>0},fe=function(n,t){return J(n,t)+J(n,t+4)*4294967296};function qr(n,t,e){if(e||(e=t,t={}),typeof e!="function")throw"no callback";return Xr(n,t,[Yr],function(r){return gn(ce(r.data[0],yn(r.data[1])))},1,e)}function ce(n,t){return xn(n,t)}var fo=typeof TextEncoder!="undefined"&&new TextEncoder,pe=typeof TextDecoder!="undefined"&&new TextDecoder,Wr=0;try{pe.decode($r,{stream:!0}),Wr=1}catch(n){}var Zr=function(n){for(var t="",e=0;;){var r=n[e++],i=(r>127)+(r>223)+(r>239);if(e+i>n.length)return[t,Ot(n,e-1)];i?i==3?(r=((r&15)<<18|(n[e++]&63)<<12|(n[e++]&63)<<6|n[e++]&63)-65536,t+=String.fromCharCode(55296|r>>10,56320|r&1023)):i&1?t+=String.fromCharCode((r&31)<<6|n[e++]&63):t+=String.fromCharCode((r&15)<<12|(n[e++]&63)<<6|n[e++]&63):t+=String.fromCharCode(r)}};function Qr(n,t){if(t){for(var e="",r=0;r<n.length;r+=16384)e+=String.fromCharCode.apply(null,n.subarray(r,r+16384));return e}else{if(pe)return pe.decode(n);var i=Zr(n),s=i[0],o=i[1];if(o.length)throw"invalid utf-8 data";return s}}var Jr=function(n,t){return t+30+rt(n,t+26)+rt(n,t+28)},ei=function(n,t,e){var r=rt(n,t+28),i=Qr(n.subarray(t+46,t+46+r),!(rt(n,t+8)&2048)),s=t+46+r,o=J(n,t+20),a=e&&o==4294967295?ti(n,s):[o,J(n,t+24),J(n,t+42)],u=a[0],c=a[1],p=a[2];return[rt(n,t+10),u,c,i,s+rt(n,t+30)+rt(n,t+32),p]},ti=function(n,t){for(;rt(n,t)!=1;t+=4+rt(n,t+2));return[fe(n,t+12),fe(n,t+4),fe(n,t+20)]};function An(n,t){if(typeof t!="function")throw"no callback";for(var e=[],r=function(){for(var A=0;A<e.length;++A)e[A]()},i={},s=n.length-22;J(n,s)!=101010256;--s)if(!s||n.length-s>65558){t("invalid zip file",null);return}var o=rt(n,s+8);o||t(null,{});var a=o,u=J(n,s+16),c=u==4294967295;if(c){if(s=J(n,s-12),J(n,s)!=101075792){t("invalid zip file",null);return}a=o=J(n,s+32),u=J(n,s+48)}for(var p=function(A){var w=ei(n,u,c),m=w[0],g=w[1],E=w[2],R=w[3],C=w[4],b=w[5],I=Jr(n,b);u=C;var N=function(B,_){B?(r(),t(B,null)):(i[R]=_,--o||t(null,i))};if(!m)N(null,Ot(n,I,I+g));else if(m==8){var P=n.subarray(I,I+g);if(g<32e4)try{N(null,ce(P,new V(E)))}catch(B){N(B,null)}else e.push(qr(P,{size:E},N))}else N("unknown compression type "+m,null)},v=0;v<a;++v)p(v);return r}var Jn=Rr(Qn()),tr=class{constructor(){this._buffers={}}clear(){this._buffers={}}put(t,e){this._buffers[t]=e}get(t){return this._buffers[t]}keys(){return Object.keys(this._buffers)}},ki="",Ui="",Hi=5e3,$t=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=ki,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Ui,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("asset-pack",$t)}static get observedAttributes(){return["src"]}set src(t){this.setAttribute("src",t)}get src(){return this._src}constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._src="",this._files=new tr,this._cache={},this._loading={},this._pipeline={},this.onLoad=this.onLoad.bind(this)}get files(){return this._files}async pipe(t,e){let r;if(typeof t=="string")r=t,r in this._pipeline||(t=(0,Jn.makeRe)(t));else if(t instanceof RegExp)r=t.source;else throw new Error("Filter must be either a RegExp or glob string.");let i;r in this._pipeline?i=this._pipeline[r]:(i=new er(t),this._pipeline[r]=i),i.addHandler(e),await Promise.all(Object.entries(this._cache).map(([s,o])=>i.matches(s)?e(o,s):null))}async cache(t,e,r={}){let{ephemeral:i}=r,s=this._cache[t],o=this._loading[t];this._cache[t]=e,await Promise.all(Object.values(this._pipeline).map(a=>a.matches(t)?a.process(t,e):null)),o&&(o.resolve(e),delete this._loading[e]),i&&this._cache[e]===e&&(s?this._cache[e]=s:delete this._cache[e])}async loadAsset(t,e=Hi){let r=this._cache[t];if(r)return r;if(t in this._loading)return this._loading[t].promise;{let i=new nr(e);return this._loading[t]=i,i.promise}}clearAssets(){for(let t of Object.values(this._loading))t.reject(new Error("Stop loading to clear all assets."));this._loading={},this._cache={}}deleteAsset(t){t in this._loading&&(this._loading[t].reject(new Error("Stop loading to delete asset.")),delete this._loading[t]),t in this._cache&&delete this._cache[t]}getAsset(t){return this._cache[t]}hasAsset(t){let e=this._cache[t];return e||!1}connectedCallback(){ji(this,"src")}attributeChangedCallback(t,e,r){switch(t){case"src":this._src=r,r&&fetch(r).then(this.onLoad).catch(i=>console.error(`Failed to load asset pack: ${i}`));break}}async onLoad(t){let e=await t.arrayBuffer();await new Promise((r,i)=>{An(new Uint8Array(e),(s,o)=>{if(s)i(s);else{let a=this._files;Promise.all(Object.entries(o).map(([u,c])=>(a.put(u,c),this.cache(u,c)))).then(()=>r()).catch(i)}})}),this.dispatchEvent(new CustomEvent("load",{composed:!0}))}};$t.define();function ji(n,t){if(Object.prototype.hasOwnProperty.call(n,t)){let e=n[t];delete n[t],n[t]=e}}var er=class{constructor(t){this.filter=t,this.handlers=[]}matches(t){return this.filter.test(t)}async process(t,e){return Promise.all(this.handlers.map(r=>r(t,e)))}addHandler(t){this.handlers.push(t)}},nr=class{constructor(t){this._resolve=null,this._reject=null,this._reason=null,this._value=null,this._timeoutHandle=t>0?setTimeout(()=>{this.reject(`Asset loading exceeded timeout of ${t} ms.`)},t):null,this._promise=new Promise((e,r)=>{this._value?e(this._value):this._resolve=e,this._reason?r(this._reason):this._reject=r})}get promise(){return this._promise}resolve(t){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._resolve?this._resolve(t):this._value=t}reject(t){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._reject?this._reject(t):this._reason=t}};window.addEventListener("error",Gt,!0);window.addEventListener("unhandledrejection",Gt,!0);function Gt(n){typeof n=="object"?n instanceof PromiseRejectionEvent?Gt(n.reason):n instanceof ErrorEvent?Gt(n.error):n instanceof Error?window.alert(n.stack):window.alert(JSON.stringify(n)):window.alert(n)}var Re={on(n,t,e=t){let r;if(this.__events.has(n)?r=this.__events.get(n):(r=new Map,this.__events.set(n,r)),!r.has(e))r.set(e,t);else throw new Error(`Found callback for event '${n}' with the same handle '${e}'.`);return this},off(n,t){if(this.__events.has(n)){let e=this.__events.get(n);if(e.has(t))e.delete(t);else throw new Error(`Unable to find callback for event '${n}' with handle '${t}'.`)}else throw new Error(`Unable to find event '${n}'.`);return this},once(n,t,e=t){let r=(...i)=>{this.off(n,e),t.apply(this.__context||this,i)};return this.on(n,r,e)},emit(n,...t){if(this.__events.has(n)){let e=[],r=Array.from(this.__events.get(n).values());for(let i of r){let s=i.apply(this.__context||this,t);s&&e.push(s)}return e}else return this.__events.set(n,new Map),[]}};function zi(n=void 0){let t=Object.create(Re);return t.__events=new Map,t.__context=n,t}function $i(n,t=void 0){let e=Object.assign(n,Re);return e.__events=new Map,e.__context=t,e}function Gi(n,t=void 0){let e=n.prototype;return Object.assign(e,Re),e.__events=new Map,e.__context=t,e}var rr={create:zi,assign:$i,mixin:Gi},Vi=5,Ki=4,Yi=3,Xi=2,qi=1,Wi=0,To={[Vi]:wt("#7F8C8D"),[Ki]:wt("#2ECC71"),[Yi]:wt("#4794C8"),[Xi]:wt("#F39C12"),[qi]:wt("#C0392B"),[Wi]:[""]};function wt(n){return[`background: ${n}`,"border-radius: 0.5em","color: white","font-weight: bold","padding: 2px 0.5em"]}var So=Symbol("level"),Ro=Symbol("domain");var vt=0,Zi=class{constructor(t){this._heap=[],this._comparator=t}get size(){return this._heap.length}clear(){this._heap.length=0}push(...t){for(let e of t)this._heap.push(e),this._shiftUp()}pop(){let t=this.peek(),e=Qi(this);return e>vt&&this._swap(vt,e),this._heap.pop(),this._shiftDown(),t}replace(t){let e=this.peek();return this._heap[vt]=t,this._shiftDown(),e}peek(){return this._heap[vt]}_compare(t,e){return this._comparator(this._heap[t],this._heap[e])}_swap(t,e){let r=this._heap[t];this._heap[t]=this._heap[e],this._heap[e]=r}_shiftUp(){let t=this._heap.length-1,e;for(;t>vt&&this._compare(t,e=Ji(t));)this._swap(t,e),t=e}_shiftDown(){let t=this._heap.length,e=vt,r,i=ir(e),s=i<t,o=sr(e),a=o<t;for(;s&&this._compare(i,e)||a&&this._compare(o,e);)r=a&&this._compare(o,i)?o:i,this._swap(e,r),e=r,i=ir(e),s=i<t,o=sr(e),a=o<t}values(){return this._heap}[Symbol.iterator](){return this._heap[Symbol.iterator]()}};function Qi(n){return n._heap.length-1}function Ji(n){return(n+1>>>1)-1}function ir(n){return(n<<1)+1}function sr(n){return n+1<<1}var Mo=Math.PI/180,Lo=180/Math.PI;var Me=class{constructor(t,e,r){this.display=t,this.inputs=e,this.assets=r,this.deltaTime=0,this.prevTime=0,this.now=0,this.events=rr.create()}on(t,e){return this.events.on(t,e),this}off(t,e){return this.events.off(t,e),this}once(t,e){return this.events.once(t,e),this}emit(t,...e){this.events.emit(t,...e)}};async function Le(n,t=void 0){if(typeof n=="string"){let a=await(await fetch(n)).arrayBuffer();if(typeof t=="undefined"){let u=n.lastIndexOf(".");if(u<0)throw new Error("Cannot load from url - unknown image type.");t="image/"+n.slice(u+1)}return Le(a,t)}else if(!(n instanceof ArrayBuffer||ArrayBuffer.isView(n)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let e=n;typeof t=="undefined"&&(t="image/png");let r=new Blob([e],{type:t}),i=URL.createObjectURL(r),s=new Image;return new Promise((o,a)=>{s.addEventListener("load",()=>{o(s)}),s.addEventListener("error",u=>{a(u)}),s.src=i})}async function Ce(n){if(typeof n=="string"){let r=await(await fetch(n)).arrayBuffer();return Ce(r)}else if(!(n instanceof ArrayBuffer||ArrayBuffer.isView(n)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let t=n;return ts(new TextDecoder().decode(t))}function ts(n){let t=[],e=[],r=[],i=[],s=[],o=[],a=/^#.*/g,u=/v\s+(\S+)\s+(\S+)\s+(\S+)/g,c=/vn\s+(\S+)\s+(\S+)\s+(\S+)/g,p=/vt\s+(\S+)\s+(\S+)/g,v=/f\s+(([^/\s]*)\/([^/\s]*)\/?([^/\s]*))\s+(([^/\s]*)\/([^/\s]*)\/?([^/\s]*))\s+(([^/\s]*)\/([^/\s]*)\/?([^/\s]*))(\s+(([^/\s]*)\/([^/\s]*)\/?([^/\s]*)))?/g,A=/f\s+([^/\s]+)\s+([^/\s]+)\s+([^/\s]+)/g,w=!1,m=null,g,E,R,C;for(n=n.replace(a,"");(m=u.exec(n))!=null;)g=Number.parseFloat(m[1]),E=Number.parseFloat(m[2]),R=Number.parseFloat(m[3]),t.push(g),t.push(E),t.push(R);for(;(m=c.exec(n))!=null;)g=Number.parseFloat(m[1]),E=Number.parseFloat(m[2]),R=Number.parseFloat(m[3]),r.push(g),r.push(E),r.push(R);for(;(m=p.exec(n))!=null;)g=Number.parseFloat(m[1]),E=Number.parseFloat(m[2]),e.push(g),e.push(E);for(;(m=v.exec(n))!=null;)g=Number.parseInt(m[2]),Number.isNaN(g)&&(g=1),E=Number.parseInt(m[6]),Number.isNaN(E)&&(E=1),R=Number.parseInt(m[10]),Number.isNaN(R)&&(R=1),i.push(g),i.push(E),i.push(R),g=Number.parseInt(m[4]),Number.isNaN(g)?(g=Number.parseInt(m[3]),E=Number.parseInt(m[7]),R=Number.parseInt(m[11]),o.push(g),o.push(E),o.push(R),s.push(1),s.push(1),s.push(1)):(E=Number.parseInt(m[8]),Number.isNaN(E)&&(E=1),R=Number.parseInt(m[12]),Number.isNaN(R)&&(R=1),o.push(g),o.push(E),o.push(R),g=Number.parseInt(m[3]),Number.isNaN(g)&&(g=1),E=Number.parseInt(m[7]),Number.isNaN(E)&&(E=1),R=Number.parseInt(m[11]),Number.isNaN(R)&&(R=1),s.push(g),s.push(E),s.push(R)),typeof m[13]!="undefined"&&(C=Number.parseInt(m[15]),Number.isNaN(C)&&(C=1),i.push(C),C=Number.parseInt(m[17]),Number.isNaN(C)?(C=Number.parseInt(m[16]),o.push(C),s.push(1)):(o.push(C),C=Number.parseInt(m[16]),s.push(C)),w=!0);for(;(m=A.exec(n))!=null;)g=Number.parseInt(m[2]),E=Number.parseInt(m[6]),R=Number.parseInt(m[10]),i.push(g),i.push(E),i.push(R),s.push(1),s.push(1),s.push(1),o.push(1),o.push(1),o.push(1),typeof m[13]!="undefined"&&(C=Number.parseInt(m[14]),i.push(C),s.push(1),o.push(1),w=!0);let b,I;I=i.length;let N=new Float32Array(I*3);for(let y=0;y<I;++y)b=i[y]-1,N[y*3+0]=t[b*3+0],N[y*3+1]=t[b*3+1],N[y*3+2]=t[b*3+2];I=s.length;let P=new Float32Array(I*2);for(let y=0;y<I;++y)b=s[y]-1,P[y*2+0]=e[b*2+0],P[y*2+1]=e[b*2+1];I=o.length;let B=new Float32Array(I*3);for(let y=0;y<I;++y)b=o[y]-1,B[y*3+0]=r[b*3+0],B[y*3+1]=r[b*3+1],B[y*3+2]=r[b*3+2];I=i.length;let _=new Uint16Array(I);for(let y=0;y<I;++y)_[y]=y;return w&&console.warn("WebGL does not support quad faces, only triangles."),{positions:N,texcoords:P,normals:B,indices:_}}async function Ie(n){if(typeof n=="string"){let s=await(await fetch(n)).arrayBuffer();return Ie(s)}else if(!(n instanceof ArrayBuffer||ArrayBuffer.isView(n)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let t=n,e=new TextDecoder().decode(t),r={};for(let i of e.split(`
`)){if(i=i.trim(),i<=0||i.startsWith("#")||i.startsWith("//"))continue;let s=[],o=0,a=i.indexOf(" ");for(;a>=0;)s.push(i.substring(o,a)),o=a+1,a=i.indexOf(" ",o);s.push(i.substring(o));let u=s[0],c=Number.parseInt(s[1]),p=Number.parseInt(s[2]),v=Number.parseInt(s[3]),A=Number.parseInt(s[4]),w=s.length>=6?Number.parseInt(s[5]):1,m=s.length>=7?Number.parseInt(s[6]):w,g=s.length>=8?Number.parseInt(s[7]):w>m?Math.ceil(w/m):1;r[u]={u:c,v:p,w:v,h:A,frames:w,cols:m,rows:g,name:u}}return r}async function Ne(n,t){if(typeof n=="string"){let o=await(await fetch(n)).arrayBuffer();return Ne(o)}else if(!(n instanceof ArrayBuffer||ArrayBuffer.isView(n)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let e=n,r=new ArrayBuffer(e.byteLength);return new Uint8Array(r).set(e),await t.decodeAudioData(r)}var Be=Symbol("audioContext"),Vt=class{static getAudioContext(){if(Be in this)return this[Be];{let t=new AudioContext;return es(t),this[Be]=t,t}}constructor(t,e){this.audioContext=t,this.audioBuffer=e,this._playing=!1,this._started=!1,this._source=null,this.onAudioSourceEnded=this.onAudioSourceEnded.bind(this)}destroy(){this._source&&this._source.disconnect(),this._source=null,this._started=!1,this._playing=!1}onAudioSourceEnded(){this._playing=!1}play(t={}){let e=this.audioBuffer;if(!e)return;this._source&&this.destroy();let{pitch:r=void 0,gain:i=void 0,pan:s=void 0,loop:o=!1}=t,a=this.audioContext,u=a.createBufferSource();u.addEventListener("ended",this.onAudioSourceEnded),u.buffer=e,u.loop=o;let c=u;if(r&&(u.detune.value=r*100),i){let p=a.createGain();p.gain.value=i,c=c.connect(p)}if(s){let p=a.createStereoPanner();p.pan.value=s,c=c.connect(p)}c.connect(a.destination),u.start(),this._source=u,this._started=!0,this._playing=!0}pause(){this._source.stop(),this._playing=!1}isStarted(){return this._started}isPlaying(){return this._playing}isPaused(){return this._started&&!this._playing}};function es(n){let t=()=>{n.state==="suspended"&&n.resume()};document.addEventListener("click",t)}var ko=new st("cursorX","Mouse","PosX"),Uo=new st("cursorY","Mouse","PosY"),Ho=new Z("activate","Mouse","Button0"),jo=new Z("mark","Mouse","Button2"),zo=new Z("restart","Keyboard","KeyR");var Go=Symbol("IslandRendererInfo");document.title="Archaea";document.title="Architect";var Oe={};qt(Oe,{CursorX:()=>rs,CursorY:()=>is,MoveDown:()=>ke,MoveLeft:()=>Fe,MoveRight:()=>De,MoveUp:()=>Pe,Shoot:()=>Ue});var Fe=new Z("moveLeft","Keyboard","KeyA"),De=new Z("moveRight","Keyboard","KeyD"),Pe=new Z("moveUp","Keyboard","KeyW"),ke=new Z("moveDown","Keyboard","KeyS"),rs=new st("cursorX","Mouse","PosX"),is=new st("cursorY","Mouse","PosY"),Ue=new Z("shoot","Keyboard","Space");var He=class{constructor(t,e,r=[]){this.width=t,this.height=e,this.initials=r,this.instances=[]}start(){for(let t of this.initials)t.object?this.createInstance(t.x||0,t.y||0,t.object):this.instances.push({x:t.x||0,y:t.y||0,room:this})}createInstance(t,e,r){let i=new r;return i.x=t,i.y=e,i.room=this,i.onCreate&&i.onCreate.call(i),this.instances.push(i),i}update(t){let e=[];for(let r of this.instances)r.dead?(r.onDestroy&&r.onDestroy(),e.push(r)):r.onUpdate&&r.onUpdate.call(r,t);for(let r of e)this.instances.splice(this.instances.indexOf(r),1)}render(t){for(let e of this.instances)e.onRender&&(t.translate(e.x,e.y),e.onRender.call(e,t),t.translate(-e.x,-e.y))}stop(){this.instances.length=0}},bt=class{constructor(){this.name="object",this.sprite=null,this.mask=null,this.dead=!1}onCreate(){}onDestroy(){}onUpdate(t){}onRender(t){this.sprite&&this.sprite.render(t,t.assets)}},je=class{constructor(t){this.src=t,this.offsetX=0,this.offsetY=0}render(t,e){let r=e.getAsset(this.src);r?t.drawImage(r,this.offsetX,this.offsetY):(t.fillStyle="white",t.fillRect(this.offsetX,this.offsetY,16,16))}};var or=4,ss=100,Tt=class extends bt{constructor(){super();this.dx=0,this.dy=0,this.age=0}onCreate(){}onUpdate(t){this.x+=this.dx*t,this.y+=this.dy*t,this.age+=t,this.age>ss&&(this.dead=!0)}onRender(t){t.fillStyle="red",t.fillRect(0,0,4,4)}};var ar=1,os=10,ze=class extends bt{constructor(){super();this.name="player",this.sprite=new je("image:toast.png"),this.facing=1,this.shootCooldown=0}onUpdate(t){let e=De.value-Fe.value,r=ke.value-Pe.value;if(this.x+=ar*e*t,this.y+=ar*r*t,this.shootCooldown>0&&(this.shootCooldown-=t),Ue.value){if(this.shootCooldown<=0){this.shootCooldown=os;let i=this.room.createInstance(this.x,this.y,Tt);i.dx=or*this.facing}}else e!==0&&(this.facing=Math.sign(e))}onRender(t){t.fillStyle="white",t.fillRect(0,0,16,16),super.onRender(t)}};document.title="Bioform";async function ur(n){let t=n.display,e=t.canvas.getContext("2d");e.imageSmoothingEnabled=!1,e.assets=n.assets,n.inputs.bindBindings(Object.values(Oe));let i=new He(t.width,t.height,[{x:0,y:0,object:ze},{x:0,y:0,object:Tt}]);i.start(),t.addEventListener("frame",s=>{let o=s.detail.deltaTime/1e3*60;i.update(o),e.clearRect(0,0,t.width,t.height),i.render(e)})}var Kt=1e-6,St=typeof Float32Array!="undefined"?Float32Array:Array,$e=Math.random;var Ha=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var n=0,t=arguments.length;t--;)n+=arguments[t]*arguments[t];return Math.sqrt(n)});var Yt={};qt(Yt,{add:()=>cs,angle:()=>Bs,bezier:()=>Ts,ceil:()=>fs,clone:()=>as,copy:()=>ls,create:()=>lr,cross:()=>Es,dist:()=>js,distance:()=>dr,div:()=>Hs,divide:()=>pr,dot:()=>xr,equals:()=>Ps,exactEquals:()=>Ds,floor:()=>ps,forEach:()=>Vs,fromValues:()=>us,hermite:()=>bs,inverse:()=>ys,len:()=>$s,length:()=>hr,lerp:()=>ws,max:()=>ms,min:()=>ds,mul:()=>Us,multiply:()=>fr,negate:()=>gs,normalize:()=>As,random:()=>Ss,rotateX:()=>Cs,rotateY:()=>Is,rotateZ:()=>Ns,round:()=>vs,scale:()=>xs,scaleAndAdd:()=>_s,set:()=>hs,sqrDist:()=>zs,sqrLen:()=>Gs,squaredDistance:()=>mr,squaredLength:()=>vr,str:()=>Fs,sub:()=>ks,subtract:()=>cr,transformMat3:()=>Ms,transformMat4:()=>Rs,transformQuat:()=>Ls,zero:()=>Os});function lr(){var n=new St(3);return St!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function as(n){var t=new St(3);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t}function hr(n){var t=n[0],e=n[1],r=n[2];return Math.hypot(t,e,r)}function us(n,t,e){var r=new St(3);return r[0]=n,r[1]=t,r[2]=e,r}function ls(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n}function hs(n,t,e,r){return n[0]=t,n[1]=e,n[2]=r,n}function cs(n,t,e){return n[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n}function cr(n,t,e){return n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n}function fr(n,t,e){return n[0]=t[0]*e[0],n[1]=t[1]*e[1],n[2]=t[2]*e[2],n}function pr(n,t,e){return n[0]=t[0]/e[0],n[1]=t[1]/e[1],n[2]=t[2]/e[2],n}function fs(n,t){return n[0]=Math.ceil(t[0]),n[1]=Math.ceil(t[1]),n[2]=Math.ceil(t[2]),n}function ps(n,t){return n[0]=Math.floor(t[0]),n[1]=Math.floor(t[1]),n[2]=Math.floor(t[2]),n}function ds(n,t,e){return n[0]=Math.min(t[0],e[0]),n[1]=Math.min(t[1],e[1]),n[2]=Math.min(t[2],e[2]),n}function ms(n,t,e){return n[0]=Math.max(t[0],e[0]),n[1]=Math.max(t[1],e[1]),n[2]=Math.max(t[2],e[2]),n}function vs(n,t){return n[0]=Math.round(t[0]),n[1]=Math.round(t[1]),n[2]=Math.round(t[2]),n}function xs(n,t,e){return n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e,n}function _s(n,t,e,r){return n[0]=t[0]+e[0]*r,n[1]=t[1]+e[1]*r,n[2]=t[2]+e[2]*r,n}function dr(n,t){var e=t[0]-n[0],r=t[1]-n[1],i=t[2]-n[2];return Math.hypot(e,r,i)}function mr(n,t){var e=t[0]-n[0],r=t[1]-n[1],i=t[2]-n[2];return e*e+r*r+i*i}function vr(n){var t=n[0],e=n[1],r=n[2];return t*t+e*e+r*r}function gs(n,t){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n}function ys(n,t){return n[0]=1/t[0],n[1]=1/t[1],n[2]=1/t[2],n}function As(n,t){var e=t[0],r=t[1],i=t[2],s=e*e+r*r+i*i;return s>0&&(s=1/Math.sqrt(s)),n[0]=t[0]*s,n[1]=t[1]*s,n[2]=t[2]*s,n}function xr(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function Es(n,t,e){var r=t[0],i=t[1],s=t[2],o=e[0],a=e[1],u=e[2];return n[0]=i*u-s*a,n[1]=s*o-r*u,n[2]=r*a-i*o,n}function ws(n,t,e,r){var i=t[0],s=t[1],o=t[2];return n[0]=i+r*(e[0]-i),n[1]=s+r*(e[1]-s),n[2]=o+r*(e[2]-o),n}function bs(n,t,e,r,i,s){var o=s*s,a=o*(2*s-3)+1,u=o*(s-2)+s,c=o*(s-1),p=o*(3-2*s);return n[0]=t[0]*a+e[0]*u+r[0]*c+i[0]*p,n[1]=t[1]*a+e[1]*u+r[1]*c+i[1]*p,n[2]=t[2]*a+e[2]*u+r[2]*c+i[2]*p,n}function Ts(n,t,e,r,i,s){var o=1-s,a=o*o,u=s*s,c=a*o,p=3*s*a,v=3*u*o,A=u*s;return n[0]=t[0]*c+e[0]*p+r[0]*v+i[0]*A,n[1]=t[1]*c+e[1]*p+r[1]*v+i[1]*A,n[2]=t[2]*c+e[2]*p+r[2]*v+i[2]*A,n}function Ss(n,t){t=t||1;var e=$e()*2*Math.PI,r=$e()*2-1,i=Math.sqrt(1-r*r)*t;return n[0]=Math.cos(e)*i,n[1]=Math.sin(e)*i,n[2]=r*t,n}function Rs(n,t,e){var r=t[0],i=t[1],s=t[2],o=e[3]*r+e[7]*i+e[11]*s+e[15];return o=o||1,n[0]=(e[0]*r+e[4]*i+e[8]*s+e[12])/o,n[1]=(e[1]*r+e[5]*i+e[9]*s+e[13])/o,n[2]=(e[2]*r+e[6]*i+e[10]*s+e[14])/o,n}function Ms(n,t,e){var r=t[0],i=t[1],s=t[2];return n[0]=r*e[0]+i*e[3]+s*e[6],n[1]=r*e[1]+i*e[4]+s*e[7],n[2]=r*e[2]+i*e[5]+s*e[8],n}function Ls(n,t,e){var r=e[0],i=e[1],s=e[2],o=e[3],a=t[0],u=t[1],c=t[2],p=i*c-s*u,v=s*a-r*c,A=r*u-i*a,w=i*A-s*v,m=s*p-r*A,g=r*v-i*p,E=o*2;return p*=E,v*=E,A*=E,w*=2,m*=2,g*=2,n[0]=a+p+w,n[1]=u+v+m,n[2]=c+A+g,n}function Cs(n,t,e,r){var i=[],s=[];return i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),n[0]=s[0]+e[0],n[1]=s[1]+e[1],n[2]=s[2]+e[2],n}function Is(n,t,e,r){var i=[],s=[];return i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),n[0]=s[0]+e[0],n[1]=s[1]+e[1],n[2]=s[2]+e[2],n}function Ns(n,t,e,r){var i=[],s=[];return i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],n[0]=s[0]+e[0],n[1]=s[1]+e[1],n[2]=s[2]+e[2],n}function Bs(n,t){var e=n[0],r=n[1],i=n[2],s=t[0],o=t[1],a=t[2],u=Math.sqrt(e*e+r*r+i*i),c=Math.sqrt(s*s+o*o+a*a),p=u*c,v=p&&xr(n,t)/p;return Math.acos(Math.min(Math.max(v,-1),1))}function Os(n){return n[0]=0,n[1]=0,n[2]=0,n}function Fs(n){return"vec3("+n[0]+", "+n[1]+", "+n[2]+")"}function Ds(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]}function Ps(n,t){var e=n[0],r=n[1],i=n[2],s=t[0],o=t[1],a=t[2];return Math.abs(e-s)<=Kt*Math.max(1,Math.abs(e),Math.abs(s))&&Math.abs(r-o)<=Kt*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-a)<=Kt*Math.max(1,Math.abs(i),Math.abs(a))}var ks=cr,Us=fr,Hs=pr,js=dr,zs=mr,$s=hr,Gs=vr,Vs=function(){var n=lr();return function(t,e,r,i,s,o){var a,u;for(e||(e=3),r||(r=0),i?u=Math.min(i*e+r,t.length):u=t.length,a=r;a<u;a+=e)n[0]=t[a],n[1]=t[a+1],n[2]=t[a+2],s(n,n,o),t[a]=n[0],t[a+1]=n[1],t[a+2]=n[2];return t}}();var Xa=Yt.fromValues(0,1,0);var qa=Math.PI/3;var Wa=Math.PI/180;var _r=16,Qs=(()=>{let n=[],t=_r,e=Math.PI*2/t,r=1,i=0,s,o;for(let a=0;a<=t;++a)s=Math.cos(a*e),o=Math.sin(a*e),n.push(0,0),n.push(r,i),n.push(s,o),r=s,i=o;return n})(),su=Math.trunc(Qs.length/2),Js=(()=>{let n=[],t=_r,e=Math.PI*2/t,r=1,i=0,s,o;for(let a=0;a<=t;++a)s=Math.cos(a*e),o=Math.sin(a*e),n.push(r,i),n.push(s,o),r=s,i=o;return n})(),ou=Math.trunc(Js.length/2);var to=16,Ge=16,pu=Ge/2,eo=to*Ge,du=1/eo;var no=.3,Uu=1-no;var ro=60,qu=1e3/ro;window.addEventListener("DOMContentLoaded",io);async function io(){let n=document.querySelector("#display"),t=document.querySelector("#inputs").getContext("axisbutton"),e=document.querySelector("#assets"),r=new Promise((s,o)=>{e.addEventListener("load",s),e.addEventListener("error",o)});e.src="res.pack",await r,await e.pipe("res/**/*.png",async(s,o)=>e.cache("image:"+o.substring(4),await Le(s,"image/png"))),await e.pipe("res/**/*.obj",async(s,o)=>e.cache("obj:"+o.substring(4),await Ce(s))),await e.pipe("res/**/*.atlas",async(s,o)=>e.cache("atlas:"+o.substring(4),await Ie(s))),await e.pipe("res/**/*.wav",async(s,o)=>{let a=Vt.getAudioContext(),u=await Ne(s,a),c=new Vt(a,u);return e.cache("sound:"+o.substring(4),c)});let i=new Me(n,t,e);n.addEventListener("frame",s=>{let{deltaTime:o,prevTime:a,now:u}=s.detail;i.deltaTime=o,i.prevTime=a,i.now=u,t.poll(u),i.emit("frame")}),await ur(i)}})();
//# sourceMappingURL=main.js.map
