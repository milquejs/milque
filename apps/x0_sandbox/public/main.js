(()=>{var Pn=Object.create,At=Object.defineProperty,Fn=Object.getPrototypeOf,zn=Object.prototype.hasOwnProperty,Un=Object.getOwnPropertyNames,Kn=Object.getOwnPropertyDescriptor;var jn=n=>At(n,"__esModule",{value:!0});var Gn=(n,t)=>()=>(n&&(t=n(n=0)),t),ut=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports),qn=(n,t)=>{for(var e in t)At(n,e,{get:t[e],enumerable:!0})},Wn=(n,t,e)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Un(t))!zn.call(n,s)&&s!=="default"&&At(n,s,{get:()=>t[s],enumerable:!(e=Kn(t,s))||e.enumerable});return n},Xn=n=>Wn(jn(At(n!=null?Pn(Fn(n)):{},"default",n&&n.__esModule&&"default"in n?{get:()=>n.default,enumerable:!0}:{value:n,enumerable:!0})),n);var Je={};qn(Je,{basename:()=>an,default:()=>Ss,delimiter:()=>rn,dirname:()=>on,extname:()=>ln,isAbsolute:()=>ae,join:()=>en,normalize:()=>le,relative:()=>nn,resolve:()=>Nt,sep:()=>sn});function tn(n,t){for(var e=0,s=n.length-1;s>=0;s--){var i=n[s];i==="."?n.splice(s,1):i===".."?(n.splice(s,1),e++):e&&(n.splice(s,1),e--)}if(t)for(;e--;e)n.unshift("..");return n}function Nt(){for(var n="",t=!1,e=arguments.length-1;e>=-1&&!t;e--){var s=e>=0?arguments[e]:"/";if(typeof s!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!s)continue;n=s+"/"+n,t=s.charAt(0)==="/"}return n=tn(oe(n.split("/"),function(i){return!!i}),!t).join("/"),(t?"/":"")+n||"."}function le(n){var t=ae(n),e=As(n,-1)==="/";return n=tn(oe(n.split("/"),function(s){return!!s}),!t).join("/"),!n&&!t&&(n="."),n&&e&&(n+="/"),(t?"/":"")+n}function ae(n){return n.charAt(0)==="/"}function en(){var n=Array.prototype.slice.call(arguments,0);return le(oe(n,function(t,e){if(typeof t!="string")throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))}function nn(n,t){n=Nt(n).substr(1),t=Nt(t).substr(1);function e(f){for(var p=0;p<f.length&&f[p]==="";p++);for(var y=f.length-1;y>=0&&f[y]==="";y--);return p>y?[]:f.slice(p,y-p+1)}for(var s=e(n.split("/")),i=e(t.split("/")),r=Math.min(s.length,i.length),o=r,l=0;l<r;l++)if(s[l]!==i[l]){o=l;break}for(var a=[],l=o;l<s.length;l++)a.push("..");return a=a.concat(i.slice(o)),a.join("/")}function on(n){var t=re(n),e=t[0],s=t[1];return!e&&!s?".":(s&&(s=s.substr(0,s.length-1)),e+s)}function an(n,t){var e=re(n)[2];return t&&e.substr(-1*t.length)===t&&(e=e.substr(0,e.length-t.length)),e}function ln(n){return re(n)[3]}function oe(n,t){if(n.filter)return n.filter(t);for(var e=[],s=0;s<n.length;s++)t(n[s],s,n)&&e.push(n[s]);return e}var xs,re,sn,rn,Ss,As,un=Gn(()=>{xs=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,re=function(n){return xs.exec(n).slice(1)};sn="/",rn=":";Ss={extname:ln,basename:an,dirname:on,sep:sn,delimiter:rn,relative:nn,join:en,isAbsolute:ae,normalize:le,resolve:Nt};As="ab".substr(-1)==="b"?function(n,t,e){return n.substr(t,e)}:function(n,t,e){return t<0&&(t=n.length+t),n.substr(t,e)}});var Ot=ut((Bi,Bt)=>{var at=(un(),Je);at&&at.default?Bt.exports=at.default:at&&(Bt.exports=at);if(at)for(let n in at)Bt.exports[n]=at[n]});var bt=ut((Oi,hn)=>{"use strict";var Cs=Ot(),st="\\\\/",cn=`[^${st}]`,rt="\\.",Rs="\\+",Ls="\\?",Mt="\\/",Ts="(?=.)",fn="[^/]",ue=`(?:${Mt}|$)`,pn=`(?:^|${Mt})`,he=`${rt}{1,2}${ue}`,Is=`(?!${rt})`,Ns=`(?!${pn}${he})`,Bs=`(?!${rt}{0,1}${ue})`,Os=`(?!${he})`,Ms=`[^.${Mt}]`,Hs=`${fn}*?`,dn={DOT_LITERAL:rt,PLUS_LITERAL:Rs,QMARK_LITERAL:Ls,SLASH_LITERAL:Mt,ONE_CHAR:Ts,QMARK:fn,END_ANCHOR:ue,DOTS_SLASH:he,NO_DOT:Is,NO_DOTS:Ns,NO_DOT_SLASH:Bs,NO_DOTS_SLASH:Os,QMARK_NO_DOT:Ms,STAR:Hs,START_ANCHOR:pn},ks={...dn,SLASH_LITERAL:`[${st}]`,QMARK:cn,STAR:`${cn}*?`,DOTS_SLASH:`${rt}{1,2}(?:[${st}]|$)`,NO_DOT:`(?!${rt})`,NO_DOTS:`(?!(?:^|[${st}])${rt}{1,2}(?:[${st}]|$))`,NO_DOT_SLASH:`(?!${rt}{0,1}(?:[${st}]|$))`,NO_DOTS_SLASH:`(?!${rt}{1,2}(?:[${st}]|$))`,QMARK_NO_DOT:`[^.${st}]`,START_ANCHOR:`(?:^|[${st}])`,END_ANCHOR:`(?:[${st}]|$)`},$s={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};hn.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:$s,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:Cs.sep,extglobChars(n){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${n.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(n){return n===!0?ks:dn}}});var Ht=ut(X=>{"use strict";var Ds=Ot(),Ps=!1,{REGEX_BACKSLASH:Fs,REGEX_REMOVE_BACKSLASH:zs,REGEX_SPECIAL_CHARS:Us,REGEX_SPECIAL_CHARS_GLOBAL:Ks}=bt();X.isObject=n=>n!==null&&typeof n=="object"&&!Array.isArray(n);X.hasRegexChars=n=>Us.test(n);X.isRegexChar=n=>n.length===1&&X.hasRegexChars(n);X.escapeRegex=n=>n.replace(Ks,"\\$1");X.toPosixSlashes=n=>n.replace(Fs,"/");X.removeBackslashes=n=>n.replace(zs,t=>t==="\\"?"":t);X.supportsLookbehinds=()=>{let n=process.version.slice(1).split(".").map(Number);return n.length===3&&n[0]>=9||n[0]===8&&n[1]>=10};X.isWindows=n=>n&&typeof n.windows=="boolean"?n.windows:Ps===!0||Ds.sep==="\\";X.escapeLast=(n,t,e)=>{let s=n.lastIndexOf(t,e);return s===-1?n:n[s-1]==="\\"?X.escapeLast(n,t,s-1):`${n.slice(0,s)}\\${n.slice(s)}`};X.removePrefix=(n,t={})=>{let e=n;return e.startsWith("./")&&(e=e.slice(2),t.prefix="./"),e};X.wrapOutput=(n,t={},e={})=>{let s=e.contains?"":"^",i=e.contains?"":"$",r=`${s}(?:${n})${i}`;return t.negated===!0&&(r=`(?:^(?!${r}).*$)`),r}});var En=ut((Hi,vn)=>{"use strict";var gn=Ht(),{CHAR_ASTERISK:ce,CHAR_AT:js,CHAR_BACKWARD_SLASH:wt,CHAR_COMMA:Gs,CHAR_DOT:fe,CHAR_EXCLAMATION_MARK:pe,CHAR_FORWARD_SLASH:mn,CHAR_LEFT_CURLY_BRACE:de,CHAR_LEFT_PARENTHESES:ve,CHAR_LEFT_SQUARE_BRACKET:qs,CHAR_PLUS:Ws,CHAR_QUESTION_MARK:yn,CHAR_RIGHT_CURLY_BRACE:Xs,CHAR_RIGHT_PARENTHESES:bn,CHAR_RIGHT_SQUARE_BRACKET:Vs}=bt(),wn=n=>n===mn||n===wt,_n=n=>{n.isPrefix!==!0&&(n.depth=n.isGlobstar?Infinity:1)},Zs=(n,t)=>{let e=t||{},s=n.length-1,i=e.parts===!0||e.scanToEnd===!0,r=[],o=[],l=[],a=n,f=-1,p=0,y=0,E=!1,C=!1,v=!1,w=!1,_=!1,R=!1,I=!1,x=!1,N=!1,B=!1,$=0,O,m,b={value:"",depth:0,isGlob:!1},F=()=>f>=s,c=()=>a.charCodeAt(f+1),M=()=>(O=m,a.charCodeAt(++f));for(;f<s;){m=M();let U;if(m===wt){I=b.backslashes=!0,m=M(),m===de&&(R=!0);continue}if(R===!0||m===de){for($++;F()!==!0&&(m=M());){if(m===wt){I=b.backslashes=!0,M();continue}if(m===de){$++;continue}if(R!==!0&&m===fe&&(m=M())===fe){if(E=b.isBrace=!0,v=b.isGlob=!0,B=!0,i===!0)continue;break}if(R!==!0&&m===Gs){if(E=b.isBrace=!0,v=b.isGlob=!0,B=!0,i===!0)continue;break}if(m===Xs&&($--,$===0)){R=!1,E=b.isBrace=!0,B=!0;break}}if(i===!0)continue;break}if(m===mn){if(r.push(f),o.push(b),b={value:"",depth:0,isGlob:!1},B===!0)continue;if(O===fe&&f===p+1){p+=2;continue}y=f+1;continue}if(e.noext!==!0&&(m===Ws||m===js||m===ce||m===yn||m===pe)===!0&&c()===ve){if(v=b.isGlob=!0,w=b.isExtglob=!0,B=!0,m===pe&&f===p&&(N=!0),i===!0){for(;F()!==!0&&(m=M());){if(m===wt){I=b.backslashes=!0,m=M();continue}if(m===bn){v=b.isGlob=!0,B=!0;break}}continue}break}if(m===ce){if(O===ce&&(_=b.isGlobstar=!0),v=b.isGlob=!0,B=!0,i===!0)continue;break}if(m===yn){if(v=b.isGlob=!0,B=!0,i===!0)continue;break}if(m===qs){for(;F()!==!0&&(U=M());){if(U===wt){I=b.backslashes=!0,M();continue}if(U===Vs){C=b.isBracket=!0,v=b.isGlob=!0,B=!0;break}}if(i===!0)continue;break}if(e.nonegate!==!0&&m===pe&&f===p){x=b.negated=!0,p++;continue}if(e.noparen!==!0&&m===ve){if(v=b.isGlob=!0,i===!0){for(;F()!==!0&&(m=M());){if(m===ve){I=b.backslashes=!0,m=M();continue}if(m===bn){B=!0;break}}continue}break}if(v===!0){if(B=!0,i===!0)continue;break}}e.noext===!0&&(w=!1,v=!1);let T=a,V="",h="";p>0&&(V=a.slice(0,p),a=a.slice(p),y-=p),T&&v===!0&&y>0?(T=a.slice(0,y),h=a.slice(y)):v===!0?(T="",h=a):T=a,T&&T!==""&&T!=="/"&&T!==a&&wn(T.charCodeAt(T.length-1))&&(T=T.slice(0,-1)),e.unescape===!0&&(h&&(h=gn.removeBackslashes(h)),T&&I===!0&&(T=gn.removeBackslashes(T)));let u={prefix:V,input:n,start:p,base:T,glob:h,isBrace:E,isBracket:C,isGlob:v,isExtglob:w,isGlobstar:_,negated:x,negatedExtglob:N};if(e.tokens===!0&&(u.maxDepth=0,wn(m)||o.push(b),u.tokens=o),e.parts===!0||e.tokens===!0){let U;for(let L=0;L<r.length;L++){let W=U?U+1:p,K=r[L],j=n.slice(W,K);e.tokens&&(L===0&&p!==0?(o[L].isPrefix=!0,o[L].value=V):o[L].value=j,_n(o[L]),u.maxDepth+=o[L].depth),(L!==0||j!=="")&&l.push(j),U=K}if(U&&U+1<n.length){let L=n.slice(U+1);l.push(L),e.tokens&&(o[o.length-1].value=L,_n(o[o.length-1]),u.maxDepth+=o[o.length-1].depth)}u.slashes=r,u.parts=l}return u};vn.exports=Zs});var Cn=ut((ki,xn)=>{"use strict";var kt=bt(),Z=Ht(),{MAX_LENGTH:$t,POSIX_REGEX_SOURCE:Ys,REGEX_NON_SPECIAL_CHARS:Qs,REGEX_SPECIAL_CHARS_BACKREF:Js,REPLACEMENTS:An}=kt,ti=(n,t)=>{if(typeof t.expandRange=="function")return t.expandRange(...n,t);n.sort();let e=`[${n.join("-")}]`;try{new RegExp(e)}catch(s){return n.map(i=>Z.escapeRegex(i)).join("..")}return e},pt=(n,t)=>`Missing ${n}: "${t}" - use "\\\\${t}" to match literal characters`,Sn=(n,t)=>{if(typeof n!="string")throw new TypeError("Expected a string");n=An[n]||n;let e={...t},s=typeof e.maxLength=="number"?Math.min($t,e.maxLength):$t,i=n.length;if(i>s)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${s}`);let r={type:"bos",value:"",output:e.prepend||""},o=[r],l=e.capture?"":"?:",a=Z.isWindows(t),f=kt.globChars(a),p=kt.extglobChars(f),{DOT_LITERAL:y,PLUS_LITERAL:E,SLASH_LITERAL:C,ONE_CHAR:v,DOTS_SLASH:w,NO_DOT:_,NO_DOT_SLASH:R,NO_DOTS_SLASH:I,QMARK:x,QMARK_NO_DOT:N,STAR:B,START_ANCHOR:$}=f,O=g=>`(${l}(?:(?!${$}${g.dot?w:y}).)*?)`,m=e.dot?"":_,b=e.dot?x:N,F=e.bash===!0?O(e):B;e.capture&&(F=`(${F})`),typeof e.noext=="boolean"&&(e.noextglob=e.noext);let c={input:n,index:-1,start:0,dot:e.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:o};n=Z.removePrefix(n,c),i=n.length;let M=[],T=[],V=[],h=r,u,U=()=>c.index===i-1,L=c.peek=(g=1)=>n[c.index+g],W=c.advance=()=>n[++c.index]||"",K=()=>n.slice(c.index+1),j=(g="",H=0)=>{c.consumed+=g,c.index+=H},J=g=>{c.output+=g.output!=null?g.output:g.value,j(g.value)},vt=()=>{let g=1;for(;L()==="!"&&(L(2)!=="("||L(3)==="?");)W(),c.start++,g++;return g%2==0?!1:(c.negated=!0,c.start++,!0)},ot=g=>{c[g]++,V.push(g)},tt=g=>{c[g]--,V.pop()},A=g=>{if(h.type==="globstar"){let H=c.braces>0&&(g.type==="comma"||g.type==="brace"),d=g.extglob===!0||M.length&&(g.type==="pipe"||g.type==="paren");g.type!=="slash"&&g.type!=="paren"&&!H&&!d&&(c.output=c.output.slice(0,-h.output.length),h.type="star",h.value="*",h.output=F,c.output+=h.output)}if(M.length&&g.type!=="paren"&&(M[M.length-1].inner+=g.value),(g.value||g.output)&&J(g),h&&h.type==="text"&&g.type==="text"){h.value+=g.value,h.output=(h.output||"")+g.value;return}g.prev=h,o.push(g),h=g},lt=(g,H)=>{let d={...p[H],conditions:1,inner:""};d.prev=h,d.parens=c.parens,d.output=c.output;let S=(e.capture?"(":"")+d.open;ot("parens"),A({type:g,value:H,output:c.output?"":v}),A({type:"paren",extglob:!0,value:W(),output:S}),M.push(d)},Et=g=>{let H=g.close+(e.capture?")":""),d;if(g.type==="negate"){let S=F;g.inner&&g.inner.length>1&&g.inner.includes("/")&&(S=O(e)),(S!==F||U()||/^\)+$/.test(K()))&&(H=g.close=`)$))${S}`),g.inner.includes("*")&&(d=K())&&/^\.[^\\/.]+$/.test(d)&&(H=g.close=`)${d})${S})`),g.prev.type==="bos"&&(c.negatedExtglob=!0)}A({type:"paren",extglob:!0,value:u,output:H}),tt("parens")};if(e.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(n)){let g=!1,H=n.replace(Js,(d,S,D,q,z,zt)=>q==="\\"?(g=!0,d):q==="?"?S?S+q+(z?x.repeat(z.length):""):zt===0?b+(z?x.repeat(z.length):""):x.repeat(D.length):q==="."?y.repeat(D.length):q==="*"?S?S+q+(z?F:""):F:S?d:`\\${d}`);return g===!0&&(e.unescape===!0?H=H.replace(/\\/g,""):H=H.replace(/\\+/g,d=>d.length%2==0?"\\\\":d?"\\":"")),H===n&&e.contains===!0?(c.output=n,c):(c.output=Z.wrapOutput(H,c,t),c)}for(;!U();){if(u=W(),u==="\0")continue;if(u==="\\"){let d=L();if(d==="/"&&e.bash!==!0||d==="."||d===";")continue;if(!d){u+="\\",A({type:"text",value:u});continue}let S=/^\\+/.exec(K()),D=0;if(S&&S[0].length>2&&(D=S[0].length,c.index+=D,D%2!=0&&(u+="\\")),e.unescape===!0?u=W():u+=W(),c.brackets===0){A({type:"text",value:u});continue}}if(c.brackets>0&&(u!=="]"||h.value==="["||h.value==="[^")){if(e.posix!==!1&&u===":"){let d=h.value.slice(1);if(d.includes("[")&&(h.posix=!0,d.includes(":"))){let S=h.value.lastIndexOf("["),D=h.value.slice(0,S),q=h.value.slice(S+2),z=Ys[q];if(z){h.value=D+z,c.backtrack=!0,W(),!r.output&&o.indexOf(h)===1&&(r.output=v);continue}}}(u==="["&&L()!==":"||u==="-"&&L()==="]")&&(u=`\\${u}`),u==="]"&&(h.value==="["||h.value==="[^")&&(u=`\\${u}`),e.posix===!0&&u==="!"&&h.value==="["&&(u="^"),h.value+=u,J({value:u});continue}if(c.quotes===1&&u!=='"'){u=Z.escapeRegex(u),h.value+=u,J({value:u});continue}if(u==='"'){c.quotes=c.quotes===1?0:1,e.keepQuotes===!0&&A({type:"text",value:u});continue}if(u==="("){ot("parens"),A({type:"paren",value:u});continue}if(u===")"){if(c.parens===0&&e.strictBrackets===!0)throw new SyntaxError(pt("opening","("));let d=M[M.length-1];if(d&&c.parens===d.parens+1){Et(M.pop());continue}A({type:"paren",value:u,output:c.parens?")":"\\)"}),tt("parens");continue}if(u==="["){if(e.nobracket===!0||!K().includes("]")){if(e.nobracket!==!0&&e.strictBrackets===!0)throw new SyntaxError(pt("closing","]"));u=`\\${u}`}else ot("brackets");A({type:"bracket",value:u});continue}if(u==="]"){if(e.nobracket===!0||h&&h.type==="bracket"&&h.value.length===1){A({type:"text",value:u,output:`\\${u}`});continue}if(c.brackets===0){if(e.strictBrackets===!0)throw new SyntaxError(pt("opening","["));A({type:"text",value:u,output:`\\${u}`});continue}tt("brackets");let d=h.value.slice(1);if(h.posix!==!0&&d[0]==="^"&&!d.includes("/")&&(u=`/${u}`),h.value+=u,J({value:u}),e.literalBrackets===!1||Z.hasRegexChars(d))continue;let S=Z.escapeRegex(h.value);if(c.output=c.output.slice(0,-h.value.length),e.literalBrackets===!0){c.output+=S,h.value=S;continue}h.value=`(${l}${S}|${h.value})`,c.output+=h.value;continue}if(u==="{"&&e.nobrace!==!0){ot("braces");let d={type:"brace",value:u,output:"(",outputIndex:c.output.length,tokensIndex:c.tokens.length};T.push(d),A(d);continue}if(u==="}"){let d=T[T.length-1];if(e.nobrace===!0||!d){A({type:"text",value:u,output:u});continue}let S=")";if(d.dots===!0){let D=o.slice(),q=[];for(let z=D.length-1;z>=0&&(o.pop(),D[z].type!=="brace");z--)D[z].type!=="dots"&&q.unshift(D[z].value);S=ti(q,e),c.backtrack=!0}if(d.comma!==!0&&d.dots!==!0){let D=c.output.slice(0,d.outputIndex),q=c.tokens.slice(d.tokensIndex);d.value=d.output="\\{",u=S="\\}",c.output=D;for(let z of q)c.output+=z.output||z.value}A({type:"brace",value:u,output:S}),tt("braces"),T.pop();continue}if(u==="|"){M.length>0&&M[M.length-1].conditions++,A({type:"text",value:u});continue}if(u===","){let d=u,S=T[T.length-1];S&&V[V.length-1]==="braces"&&(S.comma=!0,d="|"),A({type:"comma",value:u,output:d});continue}if(u==="/"){if(h.type==="dot"&&c.index===c.start+1){c.start=c.index+1,c.consumed="",c.output="",o.pop(),h=r;continue}A({type:"slash",value:u,output:C});continue}if(u==="."){if(c.braces>0&&h.type==="dot"){h.value==="."&&(h.output=y);let d=T[T.length-1];h.type="dots",h.output+=u,h.value+=u,d.dots=!0;continue}if(c.braces+c.parens===0&&h.type!=="bos"&&h.type!=="slash"){A({type:"text",value:u,output:y});continue}A({type:"dot",value:u,output:y});continue}if(u==="?"){if(!(h&&h.value==="(")&&e.noextglob!==!0&&L()==="("&&L(2)!=="?"){lt("qmark",u);continue}if(h&&h.type==="paren"){let S=L(),D=u;if(S==="<"&&!Z.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(h.value==="("&&!/[!=<:]/.test(S)||S==="<"&&!/<([!=]|\w+>)/.test(K()))&&(D=`\\${u}`),A({type:"text",value:u,output:D});continue}if(e.dot!==!0&&(h.type==="slash"||h.type==="bos")){A({type:"qmark",value:u,output:N});continue}A({type:"qmark",value:u,output:x});continue}if(u==="!"){if(e.noextglob!==!0&&L()==="("&&(L(2)!=="?"||!/[!=<:]/.test(L(3)))){lt("negate",u);continue}if(e.nonegate!==!0&&c.index===0){vt();continue}}if(u==="+"){if(e.noextglob!==!0&&L()==="("&&L(2)!=="?"){lt("plus",u);continue}if(h&&h.value==="("||e.regex===!1){A({type:"plus",value:u,output:E});continue}if(h&&(h.type==="bracket"||h.type==="paren"||h.type==="brace")||c.parens>0){A({type:"plus",value:u});continue}A({type:"plus",value:E});continue}if(u==="@"){if(e.noextglob!==!0&&L()==="("&&L(2)!=="?"){A({type:"at",extglob:!0,value:u,output:""});continue}A({type:"text",value:u});continue}if(u!=="*"){(u==="$"||u==="^")&&(u=`\\${u}`);let d=Qs.exec(K());d&&(u+=d[0],c.index+=d[0].length),A({type:"text",value:u});continue}if(h&&(h.type==="globstar"||h.star===!0)){h.type="star",h.star=!0,h.value+=u,h.output=F,c.backtrack=!0,c.globstar=!0,j(u);continue}let g=K();if(e.noextglob!==!0&&/^\([^?]/.test(g)){lt("star",u);continue}if(h.type==="star"){if(e.noglobstar===!0){j(u);continue}let d=h.prev,S=d.prev,D=d.type==="slash"||d.type==="bos",q=S&&(S.type==="star"||S.type==="globstar");if(e.bash===!0&&(!D||g[0]&&g[0]!=="/")){A({type:"star",value:u,output:""});continue}let z=c.braces>0&&(d.type==="comma"||d.type==="brace"),zt=M.length&&(d.type==="pipe"||d.type==="paren");if(!D&&d.type!=="paren"&&!z&&!zt){A({type:"star",value:u,output:""});continue}for(;g.slice(0,3)==="/**";){let xt=n[c.index+4];if(xt&&xt!=="/")break;g=g.slice(3),j("/**",3)}if(d.type==="bos"&&U()){h.type="globstar",h.value+=u,h.output=O(e),c.output=h.output,c.globstar=!0,j(u);continue}if(d.type==="slash"&&d.prev.type!=="bos"&&!q&&U()){c.output=c.output.slice(0,-(d.output+h.output).length),d.output=`(?:${d.output}`,h.type="globstar",h.output=O(e)+(e.strictSlashes?")":"|$)"),h.value+=u,c.globstar=!0,c.output+=d.output+h.output,j(u);continue}if(d.type==="slash"&&d.prev.type!=="bos"&&g[0]==="/"){let xt=g[1]!==void 0?"|$":"";c.output=c.output.slice(0,-(d.output+h.output).length),d.output=`(?:${d.output}`,h.type="globstar",h.output=`${O(e)}${C}|${C}${xt})`,h.value+=u,c.output+=d.output+h.output,c.globstar=!0,j(u+W()),A({type:"slash",value:"/",output:""});continue}if(d.type==="bos"&&g[0]==="/"){h.type="globstar",h.value+=u,h.output=`(?:^|${C}|${O(e)}${C})`,c.output=h.output,c.globstar=!0,j(u+W()),A({type:"slash",value:"/",output:""});continue}c.output=c.output.slice(0,-h.output.length),h.type="globstar",h.output=O(e),h.value+=u,c.output+=h.output,c.globstar=!0,j(u);continue}let H={type:"star",value:u,output:F};if(e.bash===!0){H.output=".*?",(h.type==="bos"||h.type==="slash")&&(H.output=m+H.output),A(H);continue}if(h&&(h.type==="bracket"||h.type==="paren")&&e.regex===!0){H.output=u,A(H);continue}(c.index===c.start||h.type==="slash"||h.type==="dot")&&(h.type==="dot"?(c.output+=R,h.output+=R):e.dot===!0?(c.output+=I,h.output+=I):(c.output+=m,h.output+=m),L()!=="*"&&(c.output+=v,h.output+=v)),A(H)}for(;c.brackets>0;){if(e.strictBrackets===!0)throw new SyntaxError(pt("closing","]"));c.output=Z.escapeLast(c.output,"["),tt("brackets")}for(;c.parens>0;){if(e.strictBrackets===!0)throw new SyntaxError(pt("closing",")"));c.output=Z.escapeLast(c.output,"("),tt("parens")}for(;c.braces>0;){if(e.strictBrackets===!0)throw new SyntaxError(pt("closing","}"));c.output=Z.escapeLast(c.output,"{"),tt("braces")}if(e.strictSlashes!==!0&&(h.type==="star"||h.type==="bracket")&&A({type:"maybe_slash",value:"",output:`${C}?`}),c.backtrack===!0){c.output="";for(let g of c.tokens)c.output+=g.output!=null?g.output:g.value,g.suffix&&(c.output+=g.suffix)}return c};Sn.fastpaths=(n,t)=>{let e={...t},s=typeof e.maxLength=="number"?Math.min($t,e.maxLength):$t,i=n.length;if(i>s)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${s}`);n=An[n]||n;let r=Z.isWindows(t),{DOT_LITERAL:o,SLASH_LITERAL:l,ONE_CHAR:a,DOTS_SLASH:f,NO_DOT:p,NO_DOTS:y,NO_DOTS_SLASH:E,STAR:C,START_ANCHOR:v}=kt.globChars(r),w=e.dot?y:p,_=e.dot?E:p,R=e.capture?"":"?:",I={negated:!1,prefix:""},x=e.bash===!0?".*?":C;e.capture&&(x=`(${x})`);let N=m=>m.noglobstar===!0?x:`(${R}(?:(?!${v}${m.dot?f:o}).)*?)`,B=m=>{switch(m){case"*":return`${w}${a}${x}`;case".*":return`${o}${a}${x}`;case"*.*":return`${w}${x}${o}${a}${x}`;case"*/*":return`${w}${x}${l}${a}${_}${x}`;case"**":return w+N(e);case"**/*":return`(?:${w}${N(e)}${l})?${_}${a}${x}`;case"**/*.*":return`(?:${w}${N(e)}${l})?${_}${x}${o}${a}${x}`;case"**/.*":return`(?:${w}${N(e)}${l})?${o}${a}${x}`;default:{let b=/^(.*?)\.(\w+)$/.exec(m);if(!b)return;let F=B(b[1]);return F?F+o+b[2]:void 0}}},$=Z.removePrefix(n,I),O=B($);return O&&e.strictSlashes!==!0&&(O+=`${l}?`),O};xn.exports=Sn});var Ln=ut(($i,Rn)=>{"use strict";var ei=Ot(),ni=En(),ge=Cn(),me=Ht(),si=bt(),ii=n=>n&&typeof n=="object"&&!Array.isArray(n),P=(n,t,e=!1)=>{if(Array.isArray(n)){let p=n.map(E=>P(E,t,e));return E=>{for(let C of p){let v=C(E);if(v)return v}return!1}}let s=ii(n)&&n.tokens&&n.input;if(n===""||typeof n!="string"&&!s)throw new TypeError("Expected pattern to be a non-empty string");let i=t||{},r=me.isWindows(t),o=s?P.compileRe(n,t):P.makeRe(n,t,!1,!0),l=o.state;delete o.state;let a=()=>!1;if(i.ignore){let p={...t,ignore:null,onMatch:null,onResult:null};a=P(i.ignore,p,e)}let f=(p,y=!1)=>{let{isMatch:E,match:C,output:v}=P.test(p,o,t,{glob:n,posix:r}),w={glob:n,state:l,regex:o,posix:r,input:p,output:v,match:C,isMatch:E};return typeof i.onResult=="function"&&i.onResult(w),E===!1?(w.isMatch=!1,y?w:!1):a(p)?(typeof i.onIgnore=="function"&&i.onIgnore(w),w.isMatch=!1,y?w:!1):(typeof i.onMatch=="function"&&i.onMatch(w),y?w:!0)};return e&&(f.state=l),f};P.test=(n,t,e,{glob:s,posix:i}={})=>{if(typeof n!="string")throw new TypeError("Expected input to be a string");if(n==="")return{isMatch:!1,output:""};let r=e||{},o=r.format||(i?me.toPosixSlashes:null),l=n===s,a=l&&o?o(n):n;return l===!1&&(a=o?o(n):n,l=a===s),(l===!1||r.capture===!0)&&(r.matchBase===!0||r.basename===!0?l=P.matchBase(n,t,e,i):l=t.exec(a)),{isMatch:Boolean(l),match:l,output:a}};P.matchBase=(n,t,e,s=me.isWindows(e))=>(t instanceof RegExp?t:P.makeRe(t,e)).test(ei.basename(n));P.isMatch=(n,t,e)=>P(t,e)(n);P.parse=(n,t)=>Array.isArray(n)?n.map(e=>P.parse(e,t)):ge(n,{...t,fastpaths:!1});P.scan=(n,t)=>ni(n,t);P.compileRe=(n,t,e=!1,s=!1)=>{if(e===!0)return n.output;let i=t||{},r=i.contains?"":"^",o=i.contains?"":"$",l=`${r}(?:${n.output})${o}`;n&&n.negated===!0&&(l=`^(?!${l}).*$`);let a=P.toRegex(l,t);return s===!0&&(a.state=n),a};P.makeRe=(n,t={},e=!1,s=!1)=>{if(!n||typeof n!="string")throw new TypeError("Expected a non-empty string");let i={negated:!1,fastpaths:!0};return t.fastpaths!==!1&&(n[0]==="."||n[0]==="*")&&(i.output=ge.fastpaths(n,t)),i.output||(i=ge(n,t)),P.compileRe(i,t,e,s)};P.toRegex=(n,t)=>{try{let e=t||{};return new RegExp(n,e.flags||(e.nocase?"i":""))}catch(e){if(t&&t.debug===!0)throw e;return/$^/}};P.constants=si;Rn.exports=P});var In=ut((Di,Tn)=>{"use strict";Tn.exports=Ln()});var Vn=`<div class="container">
    <label class="hidden" id="title">display-port</label>
    <label class="hidden" id="fps">00</label>
    <label class="hidden" id="dimension">0x0</label>
    <div class="content">
        <canvas>
            Oh no! Your browser does not support canvas.
        </canvas>
        <slot id="inner"></slot>
    </div>
    <slot name="frame"></slot>
</div>`,Zn=`:host {
    display: inline-block;
    color: #555555;
}

.container {
    display: flex;
    position: relative;
    width: 100%;
    height: 100%;
}

.content {
    position: relative;
    margin: auto;
}

.content > *:not(canvas) {
    width: 100%;
    height: 100%;
}

canvas {
    background: #000000;
    image-rendering: pixelated;
}

label {
    position: absolute;
    font-family: monospace;
    color: currentColor;
}

#inner {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    pointer-events: none;
}

#title {
    left: 0.5rem;
    top: 0.5rem;
}

#fps {
    right: 0.5rem;
    top: 0.5rem;
}

#dimension {
    left: 0.5rem;
    bottom: 0.5rem;
}

.hidden {
    display: none;
}

:host([debug]) .container {
    outline: 6px dashed rgba(0, 0, 0, 0.1);
    outline-offset: -4px;
    background-color: rgba(0, 0, 0, 0.1);
}

:host([mode="noscale"]) canvas {
    margin: 0;
    top: 0;
    left: 0;
}

:host([mode="stretch"]) canvas,
:host([mode="scale"]) canvas {
    width: 100%;
    height: 100%;
}

:host([mode="fit"]),
:host([mode="scale"]),
:host([mode="center"]),
:host([mode="stretch"]),
:host([mode="fill"]) {
    width: 100%;
    height: 100%;
}

:host([full]) {
    width: 100vw !important;
    height: 100vh !important;
}

:host([disabled]) {
    display: none;
}

slot {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    pointer-events: none;
}

::slotted(*) {
    pointer-events: auto;
}
`,Se="noscale",Ut="fit",Ce="scale",Re="fill",Le="stretch",Yn=300,Qn=150,Jn=Ut,ts=200,Te=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=Vn,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Zn,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("display-port",this)}static get observedAttributes(){return["debug","disabled","width","height","onframe","id","class"]}get mode(){return this.getAttribute("mode")}set mode(t){this.setAttribute("mode",t)}get debug(){return this._debug}set debug(t){this.toggleAttribute("debug",t)}get disabled(){return this._disabled}set disabled(t){this.toggleAttribute("disabled",t)}get width(){return this._width}set width(t){this.setAttribute("width",String(t))}get height(){return this._height}set height(t){this.setAttribute("height",String(t))}get onframe(){return this._onframe}set onframe(t){this._onframe&&this.removeEventListener("frame",this._onframe),this._onframe=t,this._onframe&&this.addEventListener("frame",t)}constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._canvasElement=this.shadowRoot.querySelector("canvas"),this._contentElement=this.shadowRoot.querySelector(".content"),this._innerElement=this.shadowRoot.querySelector("#inner"),this._titleElement=this.shadowRoot.querySelector("#title"),this._fpsElement=this.shadowRoot.querySelector("#fps"),this._dimensionElement=this.shadowRoot.querySelector("#dimension"),this._debug=!1,this._disabled=!1,this._width=Yn,this._height=Qn,this._onframe=void 0,this._animationRequestHandle=0,this._prevAnimationFrameTime=0,this._resizeTimeoutHandle=0,this._resizeCanvasWidth=0,this._resizeCanvasHeight=0,this.update=this.update.bind(this),this.onDelayCanvasResize=this.onDelayCanvasResize.bind(this)}get canvas(){return this._canvasElement}connectedCallback(){ct(this,"mode"),ct(this,"debug"),ct(this,"disabled"),ct(this,"width"),ct(this,"height"),ct(this,"onframe"),this.hasAttribute("mode")||this.setAttribute("mode",Jn),this.hasAttribute("tabindex")||this.setAttribute("tabindex","0"),this.updateCanvasSize(!0),this.resume()}disconnectedCallback(){this.pause()}attributeChangedCallback(t,e,s){switch(t){case"debug":this._debug=s!==null;break;case"disabled":this._disabled=s!==null;break;case"width":this._width=Number(s);break;case"height":this._height=Number(s);break;case"onframe":this.onframe=new Function("event","with(document){with(this){"+s+"}}").bind(this);break}switch(t){case"disabled":s?(this.update(0),this.pause()):this.resume();break;case"id":case"class":this._titleElement.innerHTML=`display-port${this.className?"."+this.className:""}${this.hasAttribute("id")?"#"+this.getAttribute("id"):""}`;break;case"debug":this._titleElement.classList.toggle("hidden",s),this._fpsElement.classList.toggle("hidden",s),this._dimensionElement.classList.toggle("hidden",s);break}}getContext(t="2d",e=void 0){return this._canvasElement.getContext(t,e)}pause(){cancelAnimationFrame(this._animationRequestHandle)}resume(){this._animationRequestHandle=requestAnimationFrame(this.update)}update(t){this._animationRequestHandle=requestAnimationFrame(this.update),this.updateCanvasSize(!1);let e=t-this._prevAnimationFrameTime;if(this._prevAnimationFrameTime=t,this._debug){let s=e<=0?"--":String(Math.round(1e3/e)).padStart(2,"0");if(this._fpsElement.textContent!==s&&(this._fpsElement.textContent=s),this.mode===Se){let r=`${this._width}x${this._height}`;this._dimensionElement.textContent!==r&&(this._dimensionElement.textContent=r)}else{let r=`${this._width}x${this._height}|${this.shadowRoot.host.clientWidth}x${this.shadowRoot.host.clientHeight}`;this._dimensionElement.textContent!==r&&(this._dimensionElement.textContent=r)}}this.dispatchEvent(new CustomEvent("frame",{detail:{now:t,prevTime:this._prevAnimationFrameTime,deltaTime:e,canvas:this._canvasElement},bubbles:!1,composed:!0}))}onDelayCanvasResize(){this._resizeTimeoutHandle=0,this.updateCanvasSize(!0)}delayCanvasResize(t,e){(t!==this._resizeCanvasWidth||e!==this._resizeCanvasHeight)&&(this._resizeCanvasWidth=t,this._resizeCanvasHeight=e,this._resizeTimeoutHandle&&clearTimeout(this._resizeTimeoutHandle),this._resizeTimeoutHandle=setTimeout(this.onDelayCanvasResize,ts))}updateCanvasSize(t=!0){let e=this.shadowRoot.host.getBoundingClientRect(),s=e.width,i=e.height,r=this._canvasElement,o=this._width,l=this._height,a=this.mode;if(a===Le||a===Re)o=s,l=i;else if(a!==Se&&(s<o||i<l||a===Ut||a==Ce)){let p=s/o,y=i/l;p<y?(o=s,l=l*p):(o=o*y,l=i)}if(o=Math.floor(o),l=Math.floor(l),typeof t=="undefined"&&(t=r.clientWidth!==o||r.clientHeight!==l),!t){this.delayCanvasResize(o,l);return}let f=Math.min(o/this._width,l/this._height)*.5;if(this._innerElement.style.fontSize=`font-size: ${f}em`,t){a===Ce?(r.width=this._width,r.height=this._height):a!==Le&&(r.width=o,r.height=l);let p=this._contentElement.style;p.width=`${o}px`,p.height=`${l}px`,(a===Ut||a===Re)&&(this._width=o,this._height=l),this.dispatchEvent(new CustomEvent("resize",{detail:{width:o,height:l},bubbles:!1,composed:!0}))}}};Te.define();function ct(n,t){if(Object.prototype.hasOwnProperty.call(n,t)){let e=n[t];delete n[t],n[t]=e}}var Kt=class{get polling(){return performance.now()-this._lastPollingTime<1e3}get value(){return 0}get size(){return this._size}constructor(t){this._size=t,this._lastPollingTime=Number.MIN_SAFE_INTEGER}resize(t){this._size=t}getState(t){throw new Error("Missing implementation.")}onUpdate(t,e,s){throw new Error("Missing implementation.")}onStatus(t,e){throw new Error("Missing implementation.")}onPoll(t){this._lastPollingTime=t}onBind(t,e={}){t>=this._size&&this.resize(t+1)}onUnbind(){this.resize(0)}},gt=class extends Kt{static createAxisBindingState(){return{value:0,delta:0,inverted:!1}}get delta(){return this._delta}get value(){return this._value}constructor(t=0){super(t);let e=new Array;for(let s=0;s<t;++s)e.push(this.constructor.createAxisBindingState());this._state=e,this._value=0,this._delta=0}resize(t){let e=this._state,s=e.length,i;if(t<=s)i=e.slice(0,t);else{i=e;for(let r=s;r<t;++r)i.push(this.constructor.createAxisBindingState())}this._state=i,super.resize(t)}getState(t){return this._state[t].value}onPoll(t){let e=this._state,s=0,i=0,r=e.length;for(let o=0;o<r;++o){let l=e[o];s+=l.value*(l.inverted?-1:1),i+=l.delta,e[o].delta=0}this._value=s,this._delta=i,super.onPoll(t)}onUpdate(t,e,s){typeof e=="undefined"?this.onAxisChange(t,s):this.onAxisMove(t,e,s)}onStatus(t,e){this.onAxisStatus(t,e)}onBind(t,e={}){super.onBind(t,e);let{inverted:s=!1}=e,i=this._state;i[t].inverted=s}onAxisMove(t,e,s){let i=this._state[t];i.value=e,i.delta+=s}onAxisChange(t,e){let s=this._state[t];s.value+=e,s.delta+=e}onAxisStatus(t,e){let s=this._state[t],i=s.value;s.value=e,s.delta=e-i}},es=241,Ie=254,ns=239,ht=1,jt=2,Gt=4,qt=8,Wt=16,St=class extends Kt{get pressed(){return this._pressed}get repeated(){return this._repeated}get released(){return this._released}get down(){return this._down}get value(){return this._value}constructor(t=0){super(t);this._state=new Uint8Array(t),this._value=0,this._down=!1,this._pressed=!1,this._repeated=!1,this._released=!1}resize(t){let e=this._state,s=e.length,i;t<=s?i=e.slice(0,t):(i=new Uint8Array(t),i.set(e)),this._state=i,super.resize(t)}getState(t){let e=this._state[t],s=e&Wt?-1:1;return(e&ht?1:0)*s}onPoll(t){let e=this._state,s=0,i=0,r=0,o=0,l=0,a=e.length;for(let f=0;f<a;++f){let p=e[f],y=p&ht,E=p&Wt;i|=y,r|=p&jt,o|=p&Gt,l|=p&qt,s+=(y?1:0)*(E?-1:1),e[f]&=es}this._value=s,this._down=i!==0,this._pressed=r!==0,this._repeated=o!==0,this._released=l!==0,super.onPoll(t)}onUpdate(t,e,s){s>0?this.onButtonPressed(t):this.onButtonReleased(t)}onStatus(t,e){this.onButtonStatus(t,e!==0)}onBind(t,e={}){super.onBind(t,e);let{inverted:s=!1}=e,i=this._state;s?i[t]|=Wt:i[t]&=ns}onButtonPressed(t){let e=this._state,s=e[t];s&ht||(s|=jt,s|=ht),s|=Gt,e[t]=s}onButtonReleased(t){let e=this._state,s=e[t];s&ht&&(s|=qt,s&=Ie),e[t]=s}onButtonStatus(t,e){let s=this._state,i=s[t],r=Boolean(i&ht);e?i|=ht:i&=Ie,r&&!e&&(i|=qt),!r&&e&&(i|=jt,i|=Gt),s[t]=i}},Xt=class{static isAxis(t){return!1}static isButton(t){return!1}constructor(t,e){if(!e)throw new Error(`Missing event target for device ${t}.`);this.name=t,this.eventTarget=e,this.listeners={input:[]}}setEventTarget(t){if(!t)throw new Error(`Missing event target for device ${this.name}.`);this.eventTarget=t}destroy(){let t=this.listeners;for(let e in t)t[e].length=0}addEventListener(t,e){let s=this.listeners;t in s?s[t].push(e):s[t]=[e]}removeEventListener(t,e){let s=this.listeners;if(t in s){let i=s[t],r=i.indexOf(e);r>=0&&i.splice(r,1)}}dispatchInputEvent(t){let e=0;for(let s of this.listeners.input)e|=s(t);return Boolean(e)}},Ne=class extends Xt{static isAxis(t){return!1}static isButton(t){return!0}constructor(t,e,s={}){super(t,e);let{ignoreRepeat:i=!0}=s;this.ignoreRepeat=i,this._eventObject={target:e,device:t,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),e.addEventListener("keydown",this.onKeyDown),e.addEventListener("keyup",this.onKeyUp)}setEventTarget(t){this.eventTarget&&this.destroy(),super.setEventTarget(t),t.addEventListener("keydown",this.onKeyDown),t.addEventListener("keyup",this.onKeyUp)}destroy(){let t=this.eventTarget;t.removeEventListener("keydown",this.onKeyDown),t.removeEventListener("keyup",this.onKeyUp),super.destroy()}onKeyDown(t){if(t.repeat&&this.ignoreRepeat)return t.preventDefault(),t.stopPropagation(),!1;let e=this._eventObject;if(e.code=t.code,e.event="pressed",e.value=1,e.control=t.ctrlKey,e.shift=t.shiftKey,e.alt=t.altKey,this.dispatchInputEvent(e))return t.preventDefault(),t.stopPropagation(),!1}onKeyUp(t){let e=this._eventObject;if(e.code=t.code,e.event="released",e.value=1,e.control=t.ctrlKey,e.shift=t.shiftKey,e.alt=t.altKey,this.dispatchInputEvent(e))return t.preventDefault(),t.stopPropagation(),!1}},Vt=10,Zt=100,Be=class extends Xt{static isAxis(t){return t==="PosX"||t==="PosY"||t==="WheelX"||t==="WheelY"||t==="WheelZ"}static isButton(t){return!this.isAxis(t)}constructor(t,e,s={}){super(t,e);let{eventsOnFocus:i=!0}=s;this.eventsOnFocus=i,this.canvasTarget=this.getCanvasFromEventTarget(e),this._downHasFocus=!1,this._eventObject={target:e,device:t,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this._positionObject={target:e,device:t,code:"",event:"move",value:0,movement:0},this._wheelObject={target:e,device:t,code:"",event:"wheel",movement:0},this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onWheel=this.onWheel.bind(this),e.addEventListener("mousedown",this.onMouseDown),e.addEventListener("contextmenu",this.onContextMenu),e.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}setEventTarget(t){this.eventTarget&&this.destroy(),super.setEventTarget(t),this.canvasTarget=this.getCanvasFromEventTarget(t),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("contextmenu",this.onContextMenu),t.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}destroy(){let t=this.eventTarget;t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("contextmenu",this.onContextMenu),t.removeEventListener("wheel",this.onWheel),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),super.destroy()}setPointerLock(t=!0){t?this.eventTarget.requestPointerLock():this.eventTarget.exitPointerLock()}hasPointerLock(){return document.pointerLockElement===this.eventTarget}onMouseDown(t){this._downHasFocus=!0;let e=this._eventObject;if(e.code="Button"+t.button,e.event="pressed",e.value=1,e.control=t.ctrlKey,e.shift=t.shiftKey,e.alt=t.altKey,this.dispatchInputEvent(e)&&document.activeElement===this.eventTarget)return t.preventDefault(),t.stopPropagation(),!1}onContextMenu(t){return t.preventDefault(),t.stopPropagation(),!1}onWheel(t){let e,s,i;switch(t.deltaMode){case WheelEvent.DOM_DELTA_LINE:e=t.deltaX*Vt,s=t.deltaY*Vt,i=t.deltaZ*Vt;break;case WheelEvent.DOM_DELTA_PAGE:e=t.deltaX*Zt,s=t.deltaY*Zt,i=t.deltaZ*Zt;break;case WheelEvent.DOM_DELTA_PIXEL:default:e=t.deltaX,s=t.deltaY,i=t.deltaZ;break}let r=0,o=this._wheelObject;if(o.code="WheelX",o.movement=e,r|=this.dispatchInputEvent(o),o.code="WheelY",o.movement=s,r|=this.dispatchInputEvent(o),o.code="WheelZ",o.movement=i,r|=this.dispatchInputEvent(o),r)return t.preventDefault(),t.stopPropagation(),!1}onMouseUp(t){if(!this._downHasFocus)return;this._downHasFocus=!1;let e=this._eventObject;if(e.code="Button"+t.button,e.event="released",e.value=1,e.control=t.ctrlKey,e.shift=t.shiftKey,e.alt=t.altKey,this.dispatchInputEvent(e))return t.preventDefault(),t.stopPropagation(),!1}onMouseMove(t){if(this.eventsOnFocus&&document.activeElement!==this.eventTarget)return;let e=this.canvasTarget,{clientWidth:s,clientHeight:i}=e,r=e.getBoundingClientRect(),o=t.movementX/s,l=t.movementY/i,a=(t.clientX-r.left)/s,f=(t.clientY-r.top)/i,p=this._positionObject;p.code="PosX",p.value=a,p.movement=o,this.dispatchInputEvent(p),p.code="PosY",p.value=f,p.movement=l,this.dispatchInputEvent(p)}getCanvasFromEventTarget(t){return t instanceof HTMLCanvasElement?t:t.canvas||t.querySelector("canvas")||t.shadowRoot&&t.shadowRoot.querySelector("canvas")||t}},ss=`<kbd>
    <span id="name"><slot></slot></span>
    <span id="value" class="hidden"></span>
</kbd>
`,is=`kbd {
    position: relative;
    display: inline-block;
    border-radius: 3px;
    border: 1px solid #888888;
    font-size: 0.85em;
    font-weight: 700;
    text-rendering: optimizeLegibility;
    line-height: 12px;
    height: 14px;
    padding: 2px 4px;
    color: #444444;
    background-color: #eeeeee;
    box-shadow: inset 0 -3px 0 #aaaaaa;
    overflow: hidden;
}

kbd:empty::after {
    content: "<?>";
    opacity: 0.6;
}

.disabled {
    opacity: 0.6;
    box-shadow: none;
    background-color: #aaaaaa;
}

.hidden {
    display: none;
}

#value {
    position: absolute;
    top: 0;
    bottom: 0;
    right: 0;
    font-size: 0.85em;
    padding: 0 4px;
    padding-top: 2px;
    color: #cccccc;
    background-color: #333333;
    box-shadow: inset 0 3px 0 #222222;
}
`,Yt=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=ss,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=is,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("input-code",this)}static get observedAttributes(){return["name","value","disabled"]}get disabled(){return this._disabled}set disabled(t){this.toggleAttribute("disabled",t)}get value(){return this._value}set value(t){this.setAttribute("value",t)}get name(){return this._name}set name(t){this.setAttribute("name",t)}constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._name="",this._value="",this._disabled=!1,this._kbdElement=this.shadowRoot.querySelector("kbd"),this._nameElement=this.shadowRoot.querySelector("#name"),this._valueElement=this.shadowRoot.querySelector("#value")}attributeChangedCallback(t,e,s){switch(t){case"name":this._name=s,this._nameElement.textContent=s;break;case"value":this._value=s,s!==null?(this._valueElement.classList.toggle("hidden",!1),this._valueElement.textContent=s,this._kbdElement.style.paddingRight=`${this._valueElement.clientWidth+4}px`):this._valueElement.classList.toggle("hidden",!0);break;case"disabled":this._disabled=s!==null,this._kbdElement.classList.toggle("disabled",s!==null);break}}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"name")){let t=this.name;delete this.name,this.name=t}if(Object.prototype.hasOwnProperty.call(this,"value")){let t=this.value;delete this.value,this.value=t}if(Object.prototype.hasOwnProperty.call(this,"disabled")){let t=this.disabled;delete this.disabled,this.disabled=t}}};Yt.define();var rs=`<table>
    <thead>
        <tr class="tableHeader">
            <th colspan=3>
                <span class="tableTitle">
                    <label id="title">
                        input-source
                    </label>
                    <span id="slotContainer">
                        <slot></slot>
                    </span>
                    <p>
                        <label for="poll">poll</label>
                        <output id="poll"></output>
                    </p>
                    <p>
                        <label for="focus">focus</label>
                        <output id="focus"></output>
                    </p>
                </span>
            </th>
        </tr>
        <tr class="colHeader">
            <th>name</th>
            <th>value</th>
            <th>key</th>
        </tr>
    </thead>
    <tbody>
    </tbody>
</table>
`,os=`:host {
    display: block;
}

table {
    border-collapse: collapse;
    font-family: monospace;
}

table,
th,
td {
    border: 1px solid #666666;
}

th,
td {
    padding: 5px 10px;
}

td {
    text-align: center;
}

thead th {
    padding: 0;
}

.colHeader > th {
    font-size: 0.8em;
    padding: 0 10px;
    letter-spacing: 3px;
    background-color: #aaaaaa;
    color: #666666;
}

tbody output {
    border-radius: 0.3em;
    padding: 3px;
}

tr:not(.primary) .name,
tr:not(.primary) .value {
    opacity: 0.3;
}

tr:nth-child(2n) {
    background-color: #eeeeee;
}

.tableHeader {
    color: #666666;
}

.tableTitle {
    display: flex;
    flex-direction: row;
    align-items: center;
    padding: 4px;
}

#slotContainer {
    flex: 1;
}

p {
    display: inline;
    margin: 0;
    padding: 0;
    padding-right: 10px;
}

#poll:empty::after,
#focus:empty::after {
    content: "\u2717";
    color: #ff0000;
}
`,Oe=class{constructor(t){this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null,this.pollable=t}get running(){return this.animationFrameHandle!==null}start(){let t=this.animationFrameHandle;t&&cancelAnimationFrame(t),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}stop(){let t=this.animationFrameHandle;t&&cancelAnimationFrame(t),this.animationFrameHandle=null}onAnimationFrame(t){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.pollable.onPoll(t)}},Me=class{constructor(t){this.onInput=this.onInput.bind(this),this.onPoll=this.onPoll.bind(this),this.bindings=t}onPoll(t){for(let e of this.bindings.getInputs())e.onPoll(t)}onInput(t){let{device:e,code:s,event:i,value:r,movement:o,control:l,shift:a,alt:f}=t,p=this.bindings.getBindings(e,s);switch(i){case"pressed":for(let{input:y,index:E}of p)y.onUpdate(E,1,1);break;case"released":for(let{input:y,index:E}of p)y.onUpdate(E,0,-1);break;case"move":for(let{input:y,index:E}of p)y.onUpdate(E,r,o);break;case"wheel":for(let{input:y,index:E}of p)y.onUpdate(E,void 0,o);break}return p.length>0}},Qt=class{constructor(t,e,s,i){this.device=t,this.code=e,this.input=s,this.index=i}},He=class{constructor(){this.bindingMap={},this.inputMap=new Map}clear(){for(let t of this.inputMap.keys())t.onUnbind();this.inputMap.clear(),this.bindingMap={}}bind(t,e,s,i={}){let r,o=this.inputMap;if(o.has(t)){let a=o.get(t),f=t.size;t.onBind(f,i),r=new Qt(e,s,t,f),a.push(r)}else{let a=[];o.set(t,a);let f=0;t.onBind(f,i),r=new Qt(e,s,t,f),a.push(r)}let l=this.bindingMap;e in l?s in l[e]?l[e][s].push(r):l[e][s]=[r]:l[e]={[s]:[r]}}unbind(t){let e=this.inputMap;if(e.has(t)){let s=this.bindingMap,i=e.get(t);for(let r of i){let{device:o,code:l}=r,a=s[o][l],f=a.indexOf(r);a.splice(f,1)}i.length=0,t.onUnbind(),e.delete(t)}}isBound(t){return this.inputMap.has(t)}getInputs(){return this.inputMap.keys()}getBindingsByInput(t){return this.inputMap.get(t)}getBindings(t,e){let s=this.bindingMap;if(t in s){let i=s[t];if(e in i)return i[e]}return[]}},ke=class{constructor(t,e={}){this.inputs={},this.devices=[new Be("Mouse",t),new Ne("Keyboard",t)],this.bindings=new He,this.adapter=new Me(this.bindings),this.autopoller=new Oe(this.adapter),this.eventTarget=t,this.anyButton=new St(1),this.anyButtonDevice="",this.anyButtonCode="",this.anyAxis=new gt(1),this.anyAxisDevice="",this.anyAxisCode="",this.listeners={bind:[],unbind:[],focus:[],blur:[]},this.onInput=this.onInput.bind(this),this.onEventTargetBlur=this.onEventTargetBlur.bind(this),this.onEventTargetFocus=this.onEventTargetFocus.bind(this),t.addEventListener("focus",this.onEventTargetFocus),t.addEventListener("blur",this.onEventTargetBlur);for(let s of this.devices)s.addEventListener("input",this.onInput)}get autopoll(){return this.autopoller.running}set autopoll(t=void 0){this.toggleAutoPoll(t)}destroy(){let t=this.listeners;for(let s in t)t[s].length=0;this.autopoller.running&&this.autopoller.stop();for(let s of this.devices)s.removeEventListener("input",this.onInput),s.destroy();let e=this.eventTarget;e.removeEventListener("focus",this.onEventTargetFocus),e.removeEventListener("blur",this.onEventTargetBlur)}setEventTarget(t){let e=this.eventTarget;e.removeEventListener("focus",this.onEventTargetFocus),e.removeEventListener("blur",this.onEventTargetBlur),this.eventTarget=t;for(let s of this.devices)s.setEventTarget(t);t.addEventListener("focus",this.onEventTargetFocus),t.addEventListener("blur",this.onEventTargetBlur)}toggleAutoPoll(t=void 0){let e=this.autopoller.running,s=typeof t=="undefined"?!e:Boolean(t);s!==e&&(s?this.autopoller.start():this.autopoller.stop())}addEventListener(t,e){let s=this.listeners;t in s?s[t].push(e):s[t]=[e]}removeEventListener(t,e){let s=this.listeners;if(t in s){let i=s[t],r=i.indexOf(e);r>=0&&i.splice(r,1)}}dispatchEvent(t){let{type:e}=t,s=0;for(let i of this.listeners[e])s|=i(t);return Boolean(s)}poll(t=performance.now()){if(this.autopoller.running)throw new Error("Should not manually poll() while autopolling.");this.onPoll(t)}onInput(t){let e=this.adapter.onInput(t);switch(t.event){case"pressed":this.anyButtonDevice=t.device,this.anyButtonCode=t.code,this.anyButton.onUpdate(0,1,1);break;case"released":this.anyButtonDevice=t.device,this.anyButtonCode=t.code,this.anyButton.onUpdate(0,0,-1);break;case"move":case"wheel":this.anyAxisDevice=t.device,this.anyAxisCode=t.code,this.anyAxis.onUpdate(0,t.value,t.movement);break}return e}onPoll(t){this.adapter.onPoll(t),this.anyButton.onPoll(t),this.anyAxis.onPoll(t)}onBind(){this.dispatchEvent({type:"bind"})}onUnbind(){this.dispatchEvent({type:"unbind"})}onEventTargetFocus(){this.dispatchEvent({type:"focus"})}onEventTargetBlur(){for(let t of this.bindings.getInputs())t.onStatus(0,0);this.anyButton.onStatus(0,0),this.anyAxis.onStatus(0,0),this.dispatchEvent({type:"blur"})}bindButton(t,e,s,i=void 0){let r;this.hasButton(t)?r=this.getButton(t):(r=new St(1),this.inputs[t]=r),this.bindings.bind(r,e,s,i),this.onBind()}bindAxis(t,e,s,i=void 0){let r;this.hasAxis(t)?r=this.getAxis(t):(r=new gt(1),this.inputs[t]=r),this.bindings.bind(r,e,s,i),this.onBind()}bindAxisButtons(t,e,s,i){let r;this.hasAxis(t)?r=this.getAxis(t):(r=new gt(2),this.inputs[t]=r),this.bindings.bind(r,e,i),this.bindings.bind(r,e,s,{inverted:!0}),this.onBind()}unbindButton(t){if(this.hasButton(t)){let e=this.getButton(t);delete this.inputs[t],this.bindings.unbind(e),this.onUnbind()}}unbindAxis(t){if(this.hasAxis(t)){let e=this.getAxis(t);delete this.inputs[t],this.bindings.unbind(e),this.onUnbind()}}getInput(t){return this.inputs[t]}getButton(t){return this.inputs[t]}getAxis(t){return this.inputs[t]}hasButton(t){return t in this.inputs&&this.inputs[t]instanceof St}hasAxis(t){return t in this.inputs&&this.inputs[t]instanceof gt}isButtonDown(t){return this.inputs[t].down}isButtonPressed(t){return this.inputs[t].pressed}isButtonReleased(t){return this.inputs[t].released}getInputValue(t){return this.inputs[t].value}getButtonValue(t){return this.inputs[t].value}getAxisValue(t){return this.inputs[t].value}getAxisDelta(t){return this.inputs[t].delta}isAnyButtonDown(t=void 0){if(typeof t=="undefined")return this.anyButton.down;{let e=this.inputs;for(let s of t)if(e[s].down)return!0}return!1}isAnyButtonPressed(t=void 0){if(typeof t=="undefined")return this.anyButton.pressed;{let e=this.inputs;for(let s of t)if(e[s].pressed)return!0}return!1}isAnyButtonReleased(t=void 0){if(typeof t=="undefined")return this.anyButton.released;{let e=this.inputs;for(let s of t)if(e[s].released)return!0}return!1}getAnyAxisValue(t=void 0){if(typeof t=="undefined")return this.anyAxis.value;{let e=this.inputs;for(let s of t){let i=e[s];if(i.value)return i.value}}return 0}getAnyAxisDelta(t=void 0){if(typeof t=="undefined")return this.anyAxis.delta;{let e=this.inputs;for(let s of t){let i=e[s];if(i.delta)return i.delta}}return 0}getLastButtonDevice(){return this.anyButtonDevice}getLastButtonCode(){return this.anyButtonCode}getLastAxisDevice(){return this.anyAxisDevice}getLastAxisCode(){return this.anyAxisCode}getMouse(){return this.devices[0]}getKeyboard(){return this.devices[1]}},$e=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=rs,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=os,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("input-port",this)}static get observedAttributes(){return["autopoll","for"]}get autopoll(){return this._autopoll}set autopoll(t){this.toggleAttribute("autopoll",t)}get for(){return this._for}set for(t){this.setAttribute("for",t)}constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._titleElement=this.shadowRoot.querySelector("#title"),this._pollElement=this.shadowRoot.querySelector("#poll"),this._focusElement=this.shadowRoot.querySelector("#focus"),this._bodyElement=this.shadowRoot.querySelector("tbody"),this._outputElements={},this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null;let t=this;this._for="",this._eventTarget=t,this._autopoll=!1,this._context=null,this.onInputContextBind=this.onInputContextBind.bind(this),this.onInputContextUnbind=this.onInputContextUnbind.bind(this),this.onInputContextFocus=this.onInputContextFocus.bind(this),this.onInputContextBlur=this.onInputContextBlur.bind(this)}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"for")){let t=this.for;delete this.for,this.for=t}if(Object.prototype.hasOwnProperty.call(this,"autopoll")){let t=this.autopoll;delete this.autopoll,this.autopoll=t}this.updateTable(),this.updateTableValues(),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}disconnectedCallback(){this._context&&(this._context.removeEventListener("bind",this.onInputContextBind),this._context.removeEventListener("unbind",this.onInputContextUnbind),this._context.removeEventListener("blur",this.onInputContextBlur),this._context.removeEventListener("focus",this.onInputContextFocus),this._context.destroy(),this._context=null)}attributeChangedCallback(t,e,s){switch(t){case"for":{this._for=s;let i,r;s?(i=document.getElementById(s),r=`${i.tagName.toLowerCase()}#${s}`):(i=this,r="input-port"),this._eventTarget=i,this._context&&this._context.setEventTarget(this._eventTarget),this._titleElement.innerHTML=`for ${r}`}break;case"autopoll":this._autopoll=s!==null,this._context&&this._context.toggleAutoPoll(this._autopoll);break}}onAnimationFrame(){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.updateTableValues(),this.updatePollStatus()}onInputContextBind(){this.updateTable()}onInputContextUnbind(){this.updateTable()}onInputContextFocus(){this._focusElement.innerHTML="\u2713"}onInputContextBlur(){this._focusElement.innerHTML=""}getContext(t="axisbutton",e=void 0){switch(t){case"axisbutton":return this._context||(this._context=new ke(this._eventTarget,e),this._context.addEventListener("bind",this.onInputContextBind),this._context.addEventListener("unbind",this.onInputContextUnbind),this._context.addEventListener("blur",this.onInputContextBlur),this._context.addEventListener("focus",this.onInputContextFocus),this._autopoll&&this._context.toggleAutoPoll(!0)),this._context;default:throw new Error(`Input context id '${t}' is not supported.`)}}updateTable(){if(this.isConnected)if(this._context){let t=this._context,e=t.inputs,s=t.bindings,i={},r=[];for(let o of Object.keys(e)){let l=e[o],a=!0;for(let f of s.getBindingsByInput(l)){let p=as(`${l.constructor.name}.${o}`,`${f.device}.${f.code}`,0,a);r.push(p),a&&(i[o]=p.querySelector("output"),a=!1)}}this._outputElements=i,this._bodyElement.innerHTML="";for(let o of r)this._bodyElement.appendChild(o)}else{this._outputElements={},this._bodyElement.innerHTML="";return}else return}updateTableValues(){if(this.isConnected)if(this._context){let e=this._context.inputs;for(let s of Object.keys(this._outputElements)){let i=this._outputElements[s],r=e[s].value;i.innerText=Number(r).toFixed(2)}}else{for(let t of Object.keys(this._outputElements)){let e=this._outputElements[t];e.innerText="---"}return}else return}updatePollStatus(){if(this.isConnected)if(this._context){let e=this._context.inputs;for(let s of Object.values(e))if(!s.polling){this._pollElement.innerHTML="";return}this._pollElement.innerHTML="\u2713"}else{this._pollElement.innerHTML="-";return}else return}};$e.define();function as(n,t,e,s=!0){let i=document.createElement("tr");s&&i.classList.add("primary");{let r=document.createElement("td");r.textContent=n,r.classList.add("name"),i.appendChild(r)}{let r=document.createElement("td"),o=document.createElement("output");s?o.innerText=Number(e).toFixed(2):o.innerText="---",o.classList.add("value"),r.appendChild(o),i.appendChild(r)}{let r=document.createElement("td");r.classList.add("key");let o=new Yt;o.innerText=t,r.appendChild(o),i.appendChild(r)}return i}var Ri=Symbol("keyboardSource");var Li=Symbol("mouseSource");var De={},ls=function(n,t,e,s,i){var r=new Worker(De[t]||(De[t]=URL.createObjectURL(new Blob([n],{type:"text/javascript"}))));return r.onerror=function(o){return i(o.error,null)},r.onmessage=function(o){return i(null,o.data)},r.postMessage(e,s),r},G=Uint8Array,et=Uint16Array,mt=Uint32Array,Jt=new G([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),te=new G([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Pe=new G([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Fe=function(n,t){for(var e=new et(31),s=0;s<31;++s)e[s]=t+=1<<n[s-1];for(var i=new mt(e[30]),s=1;s<30;++s)for(var r=e[s];r<e[s+1];++r)i[r]=r-e[s]<<5|s;return[e,i]},ze=Fe(Jt,2),ee=ze[0],us=ze[1];ee[28]=258,us[258]=28;var Ue=Fe(te,0),Ke=Ue[0],Ii=Ue[1],Ct=new et(32768);for(var k=0;k<32768;++k)it=(k&43690)>>>1|(k&21845)<<1,it=(it&52428)>>>2|(it&13107)<<2,it=(it&61680)>>>4|(it&3855)<<4,Ct[k]=((it&65280)>>>8|(it&255)<<8)>>>1;var it,ft=function(n,t,e){for(var s=n.length,i=0,r=new et(t);i<s;++i)++r[n[i]-1];var o=new et(t);for(i=0;i<t;++i)o[i]=o[i-1]+r[i-1]<<1;var l;if(e){l=new et(1<<t);var a=15-t;for(i=0;i<s;++i)if(n[i])for(var f=i<<4|n[i],p=t-n[i],y=o[n[i]-1]++<<p,E=y|(1<<p)-1;y<=E;++y)l[Ct[y]>>>a]=f}else for(l=new et(s),i=0;i<s;++i)n[i]&&(l[i]=Ct[o[n[i]-1]++]>>>15-n[i]);return l},yt=new G(288);for(var k=0;k<144;++k)yt[k]=8;for(var k=144;k<256;++k)yt[k]=9;for(var k=256;k<280;++k)yt[k]=7;for(var k=280;k<288;++k)yt[k]=8;var je=new G(32);for(var k=0;k<32;++k)je[k]=5;var Ge=ft(yt,9,1);var qe=ft(je,5,1),Rt=function(n){for(var t=n[0],e=1;e<n.length;++e)n[e]>t&&(t=n[e]);return t},Y=function(n,t,e){var s=t/8|0;return(n[s]|n[s+1]<<8)>>(t&7)&e},Lt=function(n,t){var e=t/8|0;return(n[e]|n[e+1]<<8|n[e+2]<<16)>>(t&7)},We=function(n){return(n/8|0)+(n&7&&1)},Tt=function(n,t,e){(t==null||t<0)&&(t=0),(e==null||e>n.length)&&(e=n.length);var s=new(n instanceof et?et:n instanceof mt?mt:G)(e-t);return s.set(n.subarray(t,e)),s},Xe=function(n,t,e){var s=n.length;if(!s||e&&!e.l&&s<5)return t||new G(0);var i=!t||e,r=!e||e.i;e||(e={}),t||(t=new G(s*3));var o=function(A){var lt=t.length;if(A>lt){var Et=new G(Math.max(lt*2,A));Et.set(t),t=Et}},l=e.f||0,a=e.p||0,f=e.b||0,p=e.l,y=e.d,E=e.m,C=e.n,v=s*8;do{if(!p){e.f=l=Y(n,a,1);var w=Y(n,a+1,3);if(a+=3,w)if(w==1)p=Ge,y=qe,E=9,C=5;else if(w==2){var x=Y(n,a,31)+257,N=Y(n,a+10,15)+4,B=x+Y(n,a+5,31)+1;a+=14;for(var $=new G(B),O=new G(19),m=0;m<N;++m)O[Pe[m]]=Y(n,a+m*3,7);a+=N*3;for(var b=Rt(O),F=(1<<b)-1,c=ft(O,b,1),m=0;m<B;){var M=c[Y(n,a,F)];a+=M&15;var _=M>>>4;if(_<16)$[m++]=_;else{var T=0,V=0;for(_==16?(V=3+Y(n,a,3),a+=2,T=$[m-1]):_==17?(V=3+Y(n,a,7),a+=3):_==18&&(V=11+Y(n,a,127),a+=7);V--;)$[m++]=T}}var h=$.subarray(0,x),u=$.subarray(x);E=Rt(h),C=Rt(u),p=ft(h,E,1),y=ft(u,C,1)}else throw"invalid block type";else{var _=We(a)+4,R=n[_-4]|n[_-3]<<8,I=_+R;if(I>s){if(r)throw"unexpected EOF";break}i&&o(f+R),t.set(n.subarray(_,I),f),e.b=f+=R,e.p=a=I*8;continue}if(a>v){if(r)throw"unexpected EOF";break}}i&&o(f+131072);for(var U=(1<<E)-1,L=(1<<C)-1,W=a;;W=a){var T=p[Lt(n,a)&U],K=T>>>4;if(a+=T&15,a>v){if(r)throw"unexpected EOF";break}if(!T)throw"invalid length/literal";if(K<256)t[f++]=K;else if(K==256){W=a,p=null;break}else{var j=K-254;if(K>264){var m=K-257,J=Jt[m];j=Y(n,a,(1<<J)-1)+ee[m],a+=J}var vt=y[Lt(n,a)&L],ot=vt>>>4;if(!vt)throw"invalid distance";a+=vt&15;var u=Ke[ot];if(ot>3){var J=te[ot];u+=Lt(n,a)&(1<<J)-1,a+=J}if(a>v){if(r)throw"unexpected EOF";break}i&&o(f+131072);for(var tt=f+j;f<tt;f+=4)t[f]=t[f-u],t[f+1]=t[f+1-u],t[f+2]=t[f+2-u],t[f+3]=t[f+3-u];f=tt}}e.l=p,e.p=W,e.b=f,p&&(l=1,e.m=E,e.d=y,e.n=C)}while(!l);return f==t.length?t:Tt(t,0,f)};var hs=new G(0);var cs=function(n,t){var e={};for(var s in n)e[s]=n[s];for(var s in t)e[s]=t[s];return e},Ve=function(n,t,e){for(var s=n(),i=n.toString(),r=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/ /g,"").split(","),o=0;o<s.length;++o){var l=s[o],a=r[o];if(typeof l=="function"){t+=";"+a+"=";var f=l.toString();if(l.prototype)if(f.indexOf("[native code]")!=-1){var p=f.indexOf(" ",8)+1;t+=f.slice(p,f.indexOf("(",p))}else{t+=f;for(var y in l.prototype)t+=";"+a+".prototype."+y+"="+l.prototype[y].toString()}else t+=f}else e[a]=l}return[t,e]},It=[],fs=function(n){var t=[];for(var e in n)(n[e]instanceof G||n[e]instanceof et||n[e]instanceof mt)&&t.push((n[e]=new n[e].constructor(n[e])).buffer);return t},ps=function(n,t,e,s){var i;if(!It[e]){for(var r="",o={},l=n.length-1,a=0;a<l;++a)i=Ve(n[a],r,o),r=i[0],o=i[1];It[e]=Ve(n[l],r,o)}var f=cs({},It[e][1]);return ls(It[e][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",e,f,fs(f),s)},ds=function(){return[G,et,mt,Jt,te,Pe,ee,Ke,Ge,qe,Ct,ft,Rt,Y,Lt,We,Tt,Xe,ne,Ze,Ye]};var Ze=function(n){return postMessage(n,[n.buffer])},Ye=function(n){return n&&n.size&&new G(n.size)},vs=function(n,t,e,s,i,r){var o=ps(e,s,i,function(l,a){o.terminate(),r(l,a)});return o.postMessage([n,t],t.consume?[n.buffer]:[]),function(){o.terminate()}};var nt=function(n,t){return n[t]|n[t+1]<<8},Q=function(n,t){return(n[t]|n[t+1]<<8|n[t+2]<<16|n[t+3]<<24)>>>0},se=function(n,t){return Q(n,t)+Q(n,t+4)*4294967296};function gs(n,t,e){if(e||(e=t,t={}),typeof e!="function")throw"no callback";return vs(n,t,[ds],function(s){return Ze(ne(s.data[0],Ye(s.data[1])))},1,e)}function ne(n,t){return Xe(n,t)}var Ni=typeof TextEncoder!="undefined"&&new TextEncoder,ie=typeof TextDecoder!="undefined"&&new TextDecoder,ms=0;try{ie.decode(hs,{stream:!0}),ms=1}catch(n){}var ys=function(n){for(var t="",e=0;;){var s=n[e++],i=(s>127)+(s>223)+(s>239);if(e+i>n.length)return[t,Tt(n,e-1)];i?i==3?(s=((s&15)<<18|(n[e++]&63)<<12|(n[e++]&63)<<6|n[e++]&63)-65536,t+=String.fromCharCode(55296|s>>10,56320|s&1023)):i&1?t+=String.fromCharCode((s&31)<<6|n[e++]&63):t+=String.fromCharCode((s&15)<<12|(n[e++]&63)<<6|n[e++]&63):t+=String.fromCharCode(s)}};function bs(n,t){if(t){for(var e="",s=0;s<n.length;s+=16384)e+=String.fromCharCode.apply(null,n.subarray(s,s+16384));return e}else{if(ie)return ie.decode(n);var i=ys(n),r=i[0],o=i[1];if(o.length)throw"invalid utf-8 data";return r}}var ws=function(n,t){return t+30+nt(n,t+26)+nt(n,t+28)},Es=function(n,t,e){var s=nt(n,t+28),i=bs(n.subarray(t+46,t+46+s),!(nt(n,t+8)&2048)),r=t+46+s,o=Q(n,t+20),l=e&&o==4294967295?_s(n,r):[o,Q(n,t+24),Q(n,t+42)],a=l[0],f=l[1],p=l[2];return[nt(n,t+10),a,f,i,r+nt(n,t+30)+nt(n,t+32),p]},_s=function(n,t){for(;nt(n,t)!=1;t+=4+nt(n,t+2));return[se(n,t+12),se(n,t+4),se(n,t+20)]};function Qe(n,t){if(typeof t!="function")throw"no callback";for(var e=[],s=function(){for(var E=0;E<e.length;++E)e[E]()},i={},r=n.length-22;Q(n,r)!=101010256;--r)if(!r||n.length-r>65558){t("invalid zip file",null);return}var o=nt(n,r+8);o||t(null,{});var l=o,a=Q(n,r+16),f=a==4294967295;if(f){if(r=Q(n,r-12),Q(n,r)!=101075792){t("invalid zip file",null);return}l=o=Q(n,r+32),a=Q(n,r+48)}for(var p=function(E){var C=Es(n,a,f),v=C[0],w=C[1],_=C[2],R=C[3],I=C[4],x=C[5],N=ws(n,x);a=I;var B=function(O,m){O?(s(),t(O,null)):(i[R]=m,--o||t(null,i))};if(!v)B(null,Tt(n,N,N+w));else if(v==8){var $=n.subarray(N,N+w);if(w<32e4)try{B(null,ne($,new G(_)))}catch(O){B(O,null)}else e.push(gs($,{size:_},B))}else B("unknown compression type "+v,null)},y=0;y<l;++y)p(y);return s}var Nn=Xn(In()),Bn=class{constructor(){this._buffers={}}clear(){this._buffers={}}put(t,e){this._buffers[t]=e}get(t){return this._buffers[t]}keys(){return Object.keys(this._buffers)}},ri="",oi="",ai=5e3,Dt=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=ri,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=oi,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("asset-pack",Dt)}static get observedAttributes(){return["src"]}set src(t){this.setAttribute("src",t)}get src(){return this._src}constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._src="",this._files=new Bn,this._cache={},this._loading={},this._pipeline={},this.onLoad=this.onLoad.bind(this)}get files(){return this._files}async pipe(t,e){let s;if(typeof t=="string")s=t,s in this._pipeline||(t=(0,Nn.makeRe)(t));else if(t instanceof RegExp)s=t.source;else throw new Error("Filter must be either a RegExp or glob string.");let i;s in this._pipeline?i=this._pipeline[s]:(i=new On(t),this._pipeline[s]=i),i.addHandler(e),await Promise.all(Object.entries(this._cache).map(([r,o])=>i.matches(r)?e(o,r):null))}async cache(t,e,s={}){let{ephemeral:i}=s,r=this._cache[t],o=this._loading[t];this._cache[t]=e,await Promise.all(Object.values(this._pipeline).map(l=>l.matches(t)?l.process(t,e):null)),o&&(o.resolve(e),delete this._loading[e]),i&&this._cache[e]===e&&(r?this._cache[e]=r:delete this._cache[e])}async loadAsset(t,e=ai){let s=this._cache[t];if(s)return s;if(t in this._loading)return this._loading[t].promise;{let i=new Mn(e);return this._loading[t]=i,i.promise}}clearAssets(){for(let t of Object.values(this._loading))t.reject(new Error("Stop loading to clear all assets."));this._loading={},this._cache={}}deleteAsset(t){t in this._loading&&(this._loading[t].reject(new Error("Stop loading to delete asset.")),delete this._loading[t]),t in this._cache&&delete this._cache[t]}getAsset(t){return this._cache[t]}hasAsset(t){let e=this._cache[t];return e||!1}connectedCallback(){li(this,"src")}attributeChangedCallback(t,e,s){switch(t){case"src":this._src=s,s&&fetch(s).then(this.onLoad).catch(i=>console.error(`Failed to load asset pack: ${i}`));break}}async onLoad(t){let e=await t.arrayBuffer();await new Promise((s,i)=>{Qe(new Uint8Array(e),(r,o)=>{if(r)i(r);else{let l=this._files;Promise.all(Object.entries(o).map(([a,f])=>(l.put(a,f),this.cache(a,f)))).then(()=>s()).catch(i)}})}),this.dispatchEvent(new CustomEvent("load",{composed:!0}))}};Dt.define();function li(n,t){if(Object.prototype.hasOwnProperty.call(n,t)){let e=n[t];delete n[t],n[t]=e}}var On=class{constructor(t){this.filter=t,this.handlers=[]}matches(t){return this.filter.test(t)}async process(t,e){return Promise.all(this.handlers.map(s=>s(t,e)))}addHandler(t){this.handlers.push(t)}},Mn=class{constructor(t){this._resolve=null,this._reject=null,this._reason=null,this._value=null,this._timeoutHandle=t>0?setTimeout(()=>{this.reject(`Asset loading exceeded timeout of ${t} ms.`)},t):null,this._promise=new Promise((e,s)=>{this._value?e(this._value):this._resolve=e,this._reason?s(this._reason):this._reject=s})}get promise(){return this._promise}resolve(t){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._resolve?this._resolve(t):this._value=t}reject(t){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._reject?this._reject(t):this._reason=t}};window.addEventListener("error",Pt,!0);window.addEventListener("unhandledrejection",Pt,!0);function Pt(n){typeof n=="object"?n instanceof PromiseRejectionEvent?Pt(n.reason):n instanceof ErrorEvent?Pt(n.error):n instanceof Error?window.alert(n.stack):window.alert(JSON.stringify(n)):window.alert(n)}var ye={on(n,t,e=t){let s;if(this.__events.has(n)?s=this.__events.get(n):(s=new Map,this.__events.set(n,s)),!s.has(e))s.set(e,t);else throw new Error(`Found callback for event '${n}' with the same handle '${e}'.`);return this},off(n,t){if(this.__events.has(n)){let e=this.__events.get(n);if(e.has(t))e.delete(t);else throw new Error(`Unable to find callback for event '${n}' with handle '${t}'.`)}else throw new Error(`Unable to find event '${n}'.`);return this},once(n,t,e=t){let s=(...i)=>{this.off(n,e),t.apply(this.__context||this,i)};return this.on(n,s,e)},emit(n,...t){if(this.__events.has(n)){let e=[],s=Array.from(this.__events.get(n).values());for(let i of s){let r=i.apply(this.__context||this,t);r&&e.push(r)}return e}else return this.__events.set(n,new Map),[]}};function ui(n=void 0){let t=Object.create(ye);return t.__events=new Map,t.__context=n,t}function hi(n,t=void 0){let e=Object.assign(n,ye);return e.__events=new Map,e.__context=t,e}function ci(n,t=void 0){let e=n.prototype;return Object.assign(e,ye),e.__events=new Map,e.__context=t,e}var Hn={create:ui,assign:hi,mixin:ci},fi=5,pi=4,di=3,vi=2,gi=1,mi=0,Ki={[fi]:_t("#7F8C8D"),[pi]:_t("#2ECC71"),[di]:_t("#4794C8"),[vi]:_t("#F39C12"),[gi]:_t("#C0392B"),[mi]:[""]};function _t(n){return[`background: ${n}`,"border-radius: 0.5em","color: white","font-weight: bold","padding: 2px 0.5em"]}var ji=Symbol("level"),Gi=Symbol("domain");var dt=0,yi=class{constructor(t){this._heap=[],this._comparator=t}get size(){return this._heap.length}clear(){this._heap.length=0}push(...t){for(let e of t)this._heap.push(e),this._shiftUp()}pop(){let t=this.peek(),e=bi(this);return e>dt&&this._swap(dt,e),this._heap.pop(),this._shiftDown(),t}replace(t){let e=this.peek();return this._heap[dt]=t,this._shiftDown(),e}peek(){return this._heap[dt]}_compare(t,e){return this._comparator(this._heap[t],this._heap[e])}_swap(t,e){let s=this._heap[t];this._heap[t]=this._heap[e],this._heap[e]=s}_shiftUp(){let t=this._heap.length-1,e;for(;t>dt&&this._compare(t,e=wi(t));)this._swap(t,e),t=e}_shiftDown(){let t=this._heap.length,e=dt,s,i=kn(e),r=i<t,o=$n(e),l=o<t;for(;r&&this._compare(i,e)||l&&this._compare(o,e);)s=l&&this._compare(o,i)?o:i,this._swap(e,s),e=s,i=kn(e),r=i<t,o=$n(e),l=o<t}values(){return this._heap}[Symbol.iterator](){return this._heap[Symbol.iterator]()}};function bi(n){return n._heap.length-1}function wi(n){return(n+1>>>1)-1}function kn(n){return(n<<1)+1}function $n(n){return n+1<<1}var qi=Math.PI/180,Wi=180/Math.PI;var be=class{constructor(t,e,s){this.display=t,this.inputs=e,this.assets=s,this.deltaTime=0,this.prevTime=0,this.now=0,this.events=Hn.create()}on(t,e){return this.events.on(t,e),this}off(t,e){return this.events.off(t,e),this}once(t,e){return this.events.once(t,e),this}emit(t,...e){this.events.emit(t,...e)}};async function we(n,t=void 0){if(typeof n=="string"){let l=await(await fetch(n)).arrayBuffer();if(typeof t=="undefined"){let a=n.lastIndexOf(".");if(a<0)throw new Error("Cannot load from url - unknown image type.");t="image/"+n.slice(a+1)}return we(l,t)}else if(!(n instanceof ArrayBuffer||ArrayBuffer.isView(n)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let e=n;typeof t=="undefined"&&(t="image/png");let s=new Blob([e],{type:t}),i=URL.createObjectURL(s),r=new Image;return new Promise((o,l)=>{r.addEventListener("load",()=>{o(r)}),r.addEventListener("error",a=>{l(a)}),r.src=i})}async function _e(n){if(typeof n=="string"){let s=await(await fetch(n)).arrayBuffer();return _e(s)}else if(!(n instanceof ArrayBuffer||ArrayBuffer.isView(n)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let t=n;return _i(new TextDecoder().decode(t))}function _i(n){let t=[],e=[],s=[],i=[],r=[],o=[],l=/^#.*/g,a=/v\s+(\S+)\s+(\S+)\s+(\S+)/g,f=/vn\s+(\S+)\s+(\S+)\s+(\S+)/g,p=/vt\s+(\S+)\s+(\S+)/g,y=/f\s+(([^/\s]*)\/([^/\s]*)\/?([^/\s]*))\s+(([^/\s]*)\/([^/\s]*)\/?([^/\s]*))\s+(([^/\s]*)\/([^/\s]*)\/?([^/\s]*))(\s+(([^/\s]*)\/([^/\s]*)\/?([^/\s]*)))?/g,E=/f\s+([^/\s]+)\s+([^/\s]+)\s+([^/\s]+)/g,C=!1,v=null,w,_,R,I;for(n=n.replace(l,"");(v=a.exec(n))!=null;)w=Number.parseFloat(v[1]),_=Number.parseFloat(v[2]),R=Number.parseFloat(v[3]),t.push(w),t.push(_),t.push(R);for(;(v=f.exec(n))!=null;)w=Number.parseFloat(v[1]),_=Number.parseFloat(v[2]),R=Number.parseFloat(v[3]),s.push(w),s.push(_),s.push(R);for(;(v=p.exec(n))!=null;)w=Number.parseFloat(v[1]),_=Number.parseFloat(v[2]),e.push(w),e.push(_);for(;(v=y.exec(n))!=null;)w=Number.parseInt(v[2]),Number.isNaN(w)&&(w=1),_=Number.parseInt(v[6]),Number.isNaN(_)&&(_=1),R=Number.parseInt(v[10]),Number.isNaN(R)&&(R=1),i.push(w),i.push(_),i.push(R),w=Number.parseInt(v[4]),Number.isNaN(w)?(w=Number.parseInt(v[3]),_=Number.parseInt(v[7]),R=Number.parseInt(v[11]),o.push(w),o.push(_),o.push(R),r.push(1),r.push(1),r.push(1)):(_=Number.parseInt(v[8]),Number.isNaN(_)&&(_=1),R=Number.parseInt(v[12]),Number.isNaN(R)&&(R=1),o.push(w),o.push(_),o.push(R),w=Number.parseInt(v[3]),Number.isNaN(w)&&(w=1),_=Number.parseInt(v[7]),Number.isNaN(_)&&(_=1),R=Number.parseInt(v[11]),Number.isNaN(R)&&(R=1),r.push(w),r.push(_),r.push(R)),typeof v[13]!="undefined"&&(I=Number.parseInt(v[15]),Number.isNaN(I)&&(I=1),i.push(I),I=Number.parseInt(v[17]),Number.isNaN(I)?(I=Number.parseInt(v[16]),o.push(I),r.push(1)):(o.push(I),I=Number.parseInt(v[16]),r.push(I)),C=!0);for(;(v=E.exec(n))!=null;)w=Number.parseInt(v[2]),_=Number.parseInt(v[6]),R=Number.parseInt(v[10]),i.push(w),i.push(_),i.push(R),r.push(1),r.push(1),r.push(1),o.push(1),o.push(1),o.push(1),typeof v[13]!="undefined"&&(I=Number.parseInt(v[14]),i.push(I),r.push(1),o.push(1),C=!0);let x,N;N=i.length;let B=new Float32Array(N*3);for(let b=0;b<N;++b)x=i[b]-1,B[b*3+0]=t[x*3+0],B[b*3+1]=t[x*3+1],B[b*3+2]=t[x*3+2];N=r.length;let $=new Float32Array(N*2);for(let b=0;b<N;++b)x=r[b]-1,$[b*2+0]=e[x*2+0],$[b*2+1]=e[x*2+1];N=o.length;let O=new Float32Array(N*3);for(let b=0;b<N;++b)x=o[b]-1,O[b*3+0]=s[x*3+0],O[b*3+1]=s[x*3+1],O[b*3+2]=s[x*3+2];N=i.length;let m=new Uint16Array(N);for(let b=0;b<N;++b)m[b]=b;return C&&console.warn("WebGL does not support quad faces, only triangles."),{positions:B,texcoords:$,normals:O,indices:m}}async function Ee(n){if(typeof n=="string"){let r=await(await fetch(n)).arrayBuffer();return Ee(r)}else if(!(n instanceof ArrayBuffer||ArrayBuffer.isView(n)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let t=n,e=new TextDecoder().decode(t),s={};for(let i of e.split(`
`)){if(i=i.trim(),i<=0||i.startsWith("#")||i.startsWith("//"))continue;let r=[],o=0,l=i.indexOf(" ");for(;l>=0;)r.push(i.substring(o,l)),o=l+1,l=i.indexOf(" ",o);r.push(i.substring(o));let a=r[0],f=Number.parseInt(r[1]),p=Number.parseInt(r[2]),y=Number.parseInt(r[3]),E=Number.parseInt(r[4]),C=r.length>=6?Number.parseInt(r[5]):1,v=r.length>=7?Number.parseInt(r[6]):C,w=r.length>=8?Number.parseInt(r[7]):C>v?Math.ceil(C/v):1;s[a]={u:f,v:p,w:y,h:E,frames:C,cols:v,rows:w,name:a}}return s}async function xe(n,t){if(typeof n=="string"){let o=await(await fetch(n)).arrayBuffer();return xe(o)}else if(!(n instanceof ArrayBuffer||ArrayBuffer.isView(n)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let e=n,s=new ArrayBuffer(e.byteLength);return new Uint8Array(s).set(e),await t.decodeAudioData(s)}var Ae=Symbol("audioContext"),Ft=class{static getAudioContext(){if(Ae in this)return this[Ae];{let t=new AudioContext;return Ei(t),this[Ae]=t,t}}constructor(t,e){this.audioContext=t,this.audioBuffer=e,this._playing=!1,this._started=!1,this._source=null,this.onAudioSourceEnded=this.onAudioSourceEnded.bind(this)}destroy(){this._source&&this._source.disconnect(),this._source=null,this._started=!1,this._playing=!1}onAudioSourceEnded(){this._playing=!1}play(t={}){let e=this.audioBuffer;if(!e)return;this._source&&this.destroy();let{pitch:s=void 0,gain:i=void 0,pan:r=void 0,loop:o=!1}=t,l=this.audioContext,a=l.createBufferSource();a.addEventListener("ended",this.onAudioSourceEnded),a.buffer=e,a.loop=o;let f=a;if(s&&(a.detune.value=s*100),i){let p=l.createGain();p.gain.value=i,f=f.connect(p)}if(r){let p=l.createStereoPanner();p.pan.value=r,f=f.connect(p)}f.connect(l.destination),a.start(),this._source=a,this._started=!0,this._playing=!0}pause(){this._source.stop(),this._playing=!1}isStarted(){return this._started}isPlaying(){return this._playing}isPaused(){return this._started&&!this._playing}};function Ei(n){let t=()=>{n.state==="suspended"&&n.resume()};document.addEventListener("click",t)}async function Dn(n){n.on("frame",()=>{})}window.addEventListener("DOMContentLoaded",xi);async function xi(){let n=document.querySelector("#display"),t=document.querySelector("#inputs").getContext("axisbutton"),e=document.querySelector("#assets"),s=new Promise((r,o)=>{e.addEventListener("load",r),e.addEventListener("error",o)});e.src="res.pack",await s,await e.pipe("res/**/*.png",async(r,o)=>e.cache("image:"+o.substring(4),await we(r,"image/png"))),await e.pipe("res/**/*.obj",async(r,o)=>e.cache("obj:"+o.substring(4),await _e(r))),await e.pipe("res/**/*.atlas",async(r,o)=>e.cache("atlas:"+o.substring(4),await Ee(r))),await e.pipe("res/**/*.wav",async(r,o)=>{let l=Ft.getAudioContext(),a=await xe(r,l),f=new Ft(l,a);return e.cache("sound:"+o.substring(4),f)});let i=new be(n,t,e);n.addEventListener("frame",r=>{let{deltaTime:o,prevTime:l,now:a}=r.detail;i.deltaTime=o,i.prevTime=l,i.now=a,t.poll(a),i.emit("frame")}),await Dn(i)}})();
//# sourceMappingURL=main.js.map
