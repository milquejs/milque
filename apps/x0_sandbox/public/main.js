(()=>{var ps=Object.create,it=Object.defineProperty;var ds=Object.getOwnPropertyDescriptor;var ms=Object.getOwnPropertyNames;var vs=Object.getPrototypeOf,xs=Object.prototype.hasOwnProperty;var gs=t=>it(t,"__esModule",{value:!0});var _s=(t,e)=>()=>(t&&(e=t(t=0)),e),Le=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),De=(t,e)=>{for(var r in e)it(t,r,{get:e[r],enumerable:!0})},ys=(t,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of ms(e))!xs.call(t,n)&&n!=="default"&&it(t,n,{get:()=>e[n],enumerable:!(r=ds(e,n))||r.enumerable});return t},Es=t=>ys(gs(it(t!=null?ps(vs(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var xn={};De(xn,{basename:()=>mn,default:()=>Wa,delimiter:()=>pn,dirname:()=>dn,extname:()=>vn,isAbsolute:()=>qt,join:()=>un,normalize:()=>$t,relative:()=>cn,resolve:()=>ht,sep:()=>fn});function hn(t,e){for(var r=0,n=t.length-1;n>=0;n--){var i=t[n];i==="."?t.splice(n,1):i===".."?(t.splice(n,1),r++):r&&(t.splice(n,1),r--)}if(e)for(;r--;r)t.unshift("..");return t}function ht(){for(var t="",e=!1,r=arguments.length-1;r>=-1&&!e;r--){var n=r>=0?arguments[r]:"/";if(typeof n!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!n)continue;t=n+"/"+t,e=n.charAt(0)==="/"}return t=hn(Wt(t.split("/"),function(i){return!!i}),!e).join("/"),(e?"/":"")+t||"."}function $t(t){var e=qt(t),r=Xa(t,-1)==="/";return t=hn(Wt(t.split("/"),function(n){return!!n}),!e).join("/"),!t&&!e&&(t="."),t&&r&&(t+="/"),(e?"/":"")+t}function qt(t){return t.charAt(0)==="/"}function un(){var t=Array.prototype.slice.call(arguments,0);return $t(Wt(t,function(e,r){if(typeof e!="string")throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))}function cn(t,e){t=ht(t).substr(1),e=ht(e).substr(1);function r(h){for(var u=0;u<h.length&&h[u]==="";u++);for(var c=h.length-1;c>=0&&h[c]==="";c--);return u>c?[]:h.slice(u,c-u+1)}for(var n=r(t.split("/")),i=r(e.split("/")),s=Math.min(n.length,i.length),a=s,o=0;o<s;o++)if(n[o]!==i[o]){a=o;break}for(var l=[],o=a;o<n.length;o++)l.push("..");return l=l.concat(i.slice(a)),l.join("/")}function dn(t){var e=Kt(t),r=e[0],n=e[1];return!r&&!n?".":(n&&(n=n.substr(0,n.length-1)),r+n)}function mn(t,e){var r=Kt(t)[2];return e&&r.substr(-1*e.length)===e&&(r=r.substr(0,r.length-e.length)),r}function vn(t){return Kt(t)[3]}function Wt(t,e){if(t.filter)return t.filter(e);for(var r=[],n=0;n<t.length;n++)e(t[n],n,t)&&r.push(t[n]);return r}var qa,Kt,fn,pn,Wa,Xa,gn=_s(()=>{qa=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,Kt=function(t){return qa.exec(t).slice(1)};fn="/",pn=":";Wa={extname:vn,basename:mn,dirname:dn,sep:fn,delimiter:pn,relative:cn,join:un,isAbsolute:qt,normalize:$t,resolve:ht};Xa="ab".substr(-1)==="b"?function(t,e,r){return t.substr(e,r)}:function(t,e,r){return e<0&&(e=t.length+e),t.substr(e,r)}});var ct=Le((Vf,ut)=>{var Ne=(gn(),xn);if(Ne&&Ne.default){ut.exports=Ne.default;for(let t in Ne)ut.exports[t]=Ne[t]}else Ne&&(ut.exports=Ne)});var Ge=Le((Yf,wn)=>{"use strict";var Qa=ct(),_e="\\\\/",_n=`[^${_e}]`,we="\\.",Za="\\+",Ja="\\?",ft="\\/",eo="(?=.)",yn="[^/]",Xt=`(?:${ft}|$)`,En=`(?:^|${ft})`,Qt=`${we}{1,2}${Xt}`,to=`(?!${we})`,ro=`(?!${En}${Qt})`,no=`(?!${we}{0,1}${Xt})`,io=`(?!${Qt})`,so=`[^.${ft}]`,ao=`${yn}*?`,An={DOT_LITERAL:we,PLUS_LITERAL:Za,QMARK_LITERAL:Ja,SLASH_LITERAL:ft,ONE_CHAR:eo,QMARK:yn,END_ANCHOR:Xt,DOTS_SLASH:Qt,NO_DOT:to,NO_DOTS:ro,NO_DOT_SLASH:no,NO_DOTS_SLASH:io,QMARK_NO_DOT:so,STAR:ao,START_ANCHOR:En},oo={...An,SLASH_LITERAL:`[${_e}]`,QMARK:_n,STAR:`${_n}*?`,DOTS_SLASH:`${we}{1,2}(?:[${_e}]|$)`,NO_DOT:`(?!${we})`,NO_DOTS:`(?!(?:^|[${_e}])${we}{1,2}(?:[${_e}]|$))`,NO_DOT_SLASH:`(?!${we}{0,1}(?:[${_e}]|$))`,NO_DOTS_SLASH:`(?!${we}{1,2}(?:[${_e}]|$))`,QMARK_NO_DOT:`[^.${_e}]`,START_ANCHOR:`(?:^|[${_e}])`,END_ANCHOR:`(?:[${_e}]|$)`},lo={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};wn.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:lo,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:Qa.sep,extglobChars(t){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${t.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(t){return t===!0?oo:An}}});var pt=Le(se=>{"use strict";var ho=ct(),uo=!1,{REGEX_BACKSLASH:co,REGEX_REMOVE_BACKSLASH:fo,REGEX_SPECIAL_CHARS:po,REGEX_SPECIAL_CHARS_GLOBAL:mo}=Ge();se.isObject=t=>t!==null&&typeof t=="object"&&!Array.isArray(t);se.hasRegexChars=t=>po.test(t);se.isRegexChar=t=>t.length===1&&se.hasRegexChars(t);se.escapeRegex=t=>t.replace(mo,"\\$1");se.toPosixSlashes=t=>t.replace(co,"/");se.removeBackslashes=t=>t.replace(fo,e=>e==="\\"?"":e);se.supportsLookbehinds=()=>{let t=process.version.slice(1).split(".").map(Number);return t.length===3&&t[0]>=9||t[0]===8&&t[1]>=10};se.isWindows=t=>t&&typeof t.windows=="boolean"?t.windows:uo===!0||ho.sep==="\\";se.escapeLast=(t,e,r)=>{let n=t.lastIndexOf(e,r);return n===-1?t:t[n-1]==="\\"?se.escapeLast(t,e,n-1):`${t.slice(0,n)}\\${t.slice(n)}`};se.removePrefix=(t,e={})=>{let r=t;return r.startsWith("./")&&(r=r.slice(2),e.prefix="./"),r};se.wrapOutput=(t,e={},r={})=>{let n=r.contains?"":"^",i=r.contains?"":"$",s=`${n}(?:${t})${i}`;return e.negated===!0&&(s=`(?:^(?!${s}).*$)`),s}});var Cn=Le((Gf,Ln)=>{"use strict";var Tn=pt(),{CHAR_ASTERISK:Zt,CHAR_AT:vo,CHAR_BACKWARD_SLASH:Ke,CHAR_COMMA:xo,CHAR_DOT:Jt,CHAR_EXCLAMATION_MARK:er,CHAR_FORWARD_SLASH:bn,CHAR_LEFT_CURLY_BRACE:tr,CHAR_LEFT_PARENTHESES:rr,CHAR_LEFT_SQUARE_BRACKET:go,CHAR_PLUS:_o,CHAR_QUESTION_MARK:Mn,CHAR_RIGHT_CURLY_BRACE:yo,CHAR_RIGHT_PARENTHESES:Sn,CHAR_RIGHT_SQUARE_BRACKET:Eo}=Ge(),Rn=t=>t===bn||t===Ke,In=t=>{t.isPrefix!==!0&&(t.depth=t.isGlobstar?Infinity:1)},Ao=(t,e)=>{let r=e||{},n=t.length-1,i=r.parts===!0||r.scanToEnd===!0,s=[],a=[],o=[],l=t,h=-1,u=0,c=0,f=!1,m=!1,p=!1,v=!1,d=!1,E=!1,I=!1,T=!1,M=!1,S=!1,b=0,N,A,w={value:"",depth:0,isGlob:!1},D=()=>h>=n,x=()=>l.charCodeAt(h+1),P=()=>(N=A,l.charCodeAt(++h));for(;h<n;){A=P();let $;if(A===Ke){I=w.backslashes=!0,A=P(),A===tr&&(E=!0);continue}if(E===!0||A===tr){for(b++;D()!==!0&&(A=P());){if(A===Ke){I=w.backslashes=!0,P();continue}if(A===tr){b++;continue}if(E!==!0&&A===Jt&&(A=P())===Jt){if(f=w.isBrace=!0,p=w.isGlob=!0,S=!0,i===!0)continue;break}if(E!==!0&&A===xo){if(f=w.isBrace=!0,p=w.isGlob=!0,S=!0,i===!0)continue;break}if(A===yo&&(b--,b===0)){E=!1,f=w.isBrace=!0,S=!0;break}}if(i===!0)continue;break}if(A===bn){if(s.push(h),a.push(w),w={value:"",depth:0,isGlob:!1},S===!0)continue;if(N===Jt&&h===u+1){u+=2;continue}c=h+1;continue}if(r.noext!==!0&&(A===_o||A===vo||A===Zt||A===Mn||A===er)===!0&&x()===rr){if(p=w.isGlob=!0,v=w.isExtglob=!0,S=!0,A===er&&h===u&&(M=!0),i===!0){for(;D()!==!0&&(A=P());){if(A===Ke){I=w.backslashes=!0,A=P();continue}if(A===Sn){p=w.isGlob=!0,S=!0;break}}continue}break}if(A===Zt){if(N===Zt&&(d=w.isGlobstar=!0),p=w.isGlob=!0,S=!0,i===!0)continue;break}if(A===Mn){if(p=w.isGlob=!0,S=!0,i===!0)continue;break}if(A===go){for(;D()!==!0&&($=P());){if($===Ke){I=w.backslashes=!0,P();continue}if($===Eo){m=w.isBracket=!0,p=w.isGlob=!0,S=!0;break}}if(i===!0)continue;break}if(r.nonegate!==!0&&A===er&&h===u){T=w.negated=!0,u++;continue}if(r.noparen!==!0&&A===rr){if(p=w.isGlob=!0,i===!0){for(;D()!==!0&&(A=P());){if(A===rr){I=w.backslashes=!0,A=P();continue}if(A===Sn){S=!0;break}}continue}break}if(p===!0){if(S=!0,i===!0)continue;break}}r.noext===!0&&(v=!1,p=!1);let y=l,O="",g="";u>0&&(O=l.slice(0,u),l=l.slice(u),c-=u),y&&p===!0&&c>0?(y=l.slice(0,c),g=l.slice(c)):p===!0?(y="",g=l):y=l,y&&y!==""&&y!=="/"&&y!==l&&Rn(y.charCodeAt(y.length-1))&&(y=y.slice(0,-1)),r.unescape===!0&&(g&&(g=Tn.removeBackslashes(g)),y&&I===!0&&(y=Tn.removeBackslashes(y)));let _={prefix:O,input:t,start:u,base:y,glob:g,isBrace:f,isBracket:m,isGlob:p,isExtglob:v,isGlobstar:d,negated:T,negatedExtglob:M};if(r.tokens===!0&&(_.maxDepth=0,Rn(A)||a.push(w),_.tokens=a),r.parts===!0||r.tokens===!0){let $;for(let H=0;H<s.length;H++){let Z=$?$+1:u,J=s[H],te=t.slice(Z,J);r.tokens&&(H===0&&u!==0?(a[H].isPrefix=!0,a[H].value=O):a[H].value=te,In(a[H]),_.maxDepth+=a[H].depth),(H!==0||te!=="")&&o.push(te),$=J}if($&&$+1<t.length){let H=t.slice($+1);o.push(H),r.tokens&&(a[a.length-1].value=H,In(a[a.length-1]),_.maxDepth+=a[a.length-1].depth)}_.slashes=s,_.parts=o}return _};Ln.exports=Ao});var Bn=Le((Kf,On)=>{"use strict";var dt=Ge(),he=pt(),{MAX_LENGTH:mt,POSIX_REGEX_SOURCE:wo,REGEX_NON_SPECIAL_CHARS:To,REGEX_SPECIAL_CHARS_BACKREF:bo,REPLACEMENTS:Nn}=dt,Mo=(t,e)=>{if(typeof e.expandRange=="function")return e.expandRange(...t,e);t.sort();let r=`[${t.join("-")}]`;try{new RegExp(r)}catch(n){return t.map(i=>he.escapeRegex(i)).join("..")}return r},Ue=(t,e)=>`Missing ${t}: "${e}" - use "\\\\${e}" to match literal characters`,nr=(t,e)=>{if(typeof t!="string")throw new TypeError("Expected a string");t=Nn[t]||t;let r={...e},n=typeof r.maxLength=="number"?Math.min(mt,r.maxLength):mt,i=t.length;if(i>n)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${n}`);let s={type:"bos",value:"",output:r.prepend||""},a=[s],o=r.capture?"":"?:",l=he.isWindows(e),h=dt.globChars(l),u=dt.extglobChars(h),{DOT_LITERAL:c,PLUS_LITERAL:f,SLASH_LITERAL:m,ONE_CHAR:p,DOTS_SLASH:v,NO_DOT:d,NO_DOT_SLASH:E,NO_DOTS_SLASH:I,QMARK:T,QMARK_NO_DOT:M,STAR:S,START_ANCHOR:b}=h,N=C=>`(${o}(?:(?!${b}${C.dot?v:c}).)*?)`,A=r.dot?"":d,w=r.dot?T:M,D=r.bash===!0?N(r):S;r.capture&&(D=`(${D})`),typeof r.noext=="boolean"&&(r.noextglob=r.noext);let x={input:t,index:-1,start:0,dot:r.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:a};t=he.removePrefix(t,x),i=t.length;let P=[],y=[],O=[],g=s,_,$=()=>x.index===i-1,H=x.peek=(C=1)=>t[x.index+C],Z=x.advance=()=>t[++x.index]||"",J=()=>t.slice(x.index+1),te=(C="",G=0)=>{x.consumed+=C,x.index+=G},ve=C=>{x.output+=C.output!=null?C.output:C.value,te(C.value)},Ye=()=>{let C=1;for(;H()==="!"&&(H(2)!=="("||H(3)==="?");)Z(),x.start++,C++;return C%2==0?!1:(x.negated=!0,x.start++,!0)},Me=C=>{x[C]++,O.push(C)},xe=C=>{x[C]--,O.pop()},U=C=>{if(g.type==="globstar"){let G=x.braces>0&&(C.type==="comma"||C.type==="brace"),R=C.extglob===!0||P.length&&(C.type==="pipe"||C.type==="paren");C.type!=="slash"&&C.type!=="paren"&&!G&&!R&&(x.output=x.output.slice(0,-g.output.length),g.type="star",g.value="*",g.output=D,x.output+=g.output)}if(P.length&&C.type!=="paren"&&(P[P.length-1].inner+=C.value),(C.value||C.output)&&ve(C),g&&g.type==="text"&&C.type==="text"){g.value+=C.value,g.output=(g.output||"")+C.value;return}C.prev=g,a.push(C),g=C},Ie=(C,G)=>{let R={...u[G],conditions:1,inner:""};R.prev=g,R.parens=x.parens,R.output=x.output;let k=(r.capture?"(":"")+R.open;Me("parens"),U({type:C,value:G,output:x.output?"":p}),U({type:"paren",extglob:!0,value:Z(),output:k}),P.push(R)},rt=C=>{let G=C.close+(r.capture?")":""),R;if(C.type==="negate"){let k=D;if(C.inner&&C.inner.length>1&&C.inner.includes("/")&&(k=N(r)),(k!==D||$()||/^\)+$/.test(J()))&&(G=C.close=`)$))${k}`),C.inner.includes("*")&&(R=J())&&/^\.[^\\/.]+$/.test(R)){let q=nr(R,{...e,fastpaths:!1}).output;G=C.close=`)${q})${k})`}C.prev.type==="bos"&&(x.negatedExtglob=!0)}U({type:"paren",extglob:!0,value:_,output:G}),xe("parens")};if(r.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(t)){let C=!1,G=t.replace(bo,(R,k,q,re,Q,Nt)=>re==="\\"?(C=!0,R):re==="?"?k?k+re+(Q?T.repeat(Q.length):""):Nt===0?w+(Q?T.repeat(Q.length):""):T.repeat(q.length):re==="."?c.repeat(q.length):re==="*"?k?k+re+(Q?D:""):D:k?R:`\\${R}`);return C===!0&&(r.unescape===!0?G=G.replace(/\\/g,""):G=G.replace(/\\+/g,R=>R.length%2==0?"\\\\":R?"\\":"")),G===t&&r.contains===!0?(x.output=t,x):(x.output=he.wrapOutput(G,x,e),x)}for(;!$();){if(_=Z(),_==="\0")continue;if(_==="\\"){let R=H();if(R==="/"&&r.bash!==!0||R==="."||R===";")continue;if(!R){_+="\\",U({type:"text",value:_});continue}let k=/^\\+/.exec(J()),q=0;if(k&&k[0].length>2&&(q=k[0].length,x.index+=q,q%2!=0&&(_+="\\")),r.unescape===!0?_=Z():_+=Z(),x.brackets===0){U({type:"text",value:_});continue}}if(x.brackets>0&&(_!=="]"||g.value==="["||g.value==="[^")){if(r.posix!==!1&&_===":"){let R=g.value.slice(1);if(R.includes("[")&&(g.posix=!0,R.includes(":"))){let k=g.value.lastIndexOf("["),q=g.value.slice(0,k),re=g.value.slice(k+2),Q=wo[re];if(Q){g.value=q+Q,x.backtrack=!0,Z(),!s.output&&a.indexOf(g)===1&&(s.output=p);continue}}}(_==="["&&H()!==":"||_==="-"&&H()==="]")&&(_=`\\${_}`),_==="]"&&(g.value==="["||g.value==="[^")&&(_=`\\${_}`),r.posix===!0&&_==="!"&&g.value==="["&&(_="^"),g.value+=_,ve({value:_});continue}if(x.quotes===1&&_!=='"'){_=he.escapeRegex(_),g.value+=_,ve({value:_});continue}if(_==='"'){x.quotes=x.quotes===1?0:1,r.keepQuotes===!0&&U({type:"text",value:_});continue}if(_==="("){Me("parens"),U({type:"paren",value:_});continue}if(_===")"){if(x.parens===0&&r.strictBrackets===!0)throw new SyntaxError(Ue("opening","("));let R=P[P.length-1];if(R&&x.parens===R.parens+1){rt(P.pop());continue}U({type:"paren",value:_,output:x.parens?")":"\\)"}),xe("parens");continue}if(_==="["){if(r.nobracket===!0||!J().includes("]")){if(r.nobracket!==!0&&r.strictBrackets===!0)throw new SyntaxError(Ue("closing","]"));_=`\\${_}`}else Me("brackets");U({type:"bracket",value:_});continue}if(_==="]"){if(r.nobracket===!0||g&&g.type==="bracket"&&g.value.length===1){U({type:"text",value:_,output:`\\${_}`});continue}if(x.brackets===0){if(r.strictBrackets===!0)throw new SyntaxError(Ue("opening","["));U({type:"text",value:_,output:`\\${_}`});continue}xe("brackets");let R=g.value.slice(1);if(g.posix!==!0&&R[0]==="^"&&!R.includes("/")&&(_=`/${_}`),g.value+=_,ve({value:_}),r.literalBrackets===!1||he.hasRegexChars(R))continue;let k=he.escapeRegex(g.value);if(x.output=x.output.slice(0,-g.value.length),r.literalBrackets===!0){x.output+=k,g.value=k;continue}g.value=`(${o}${k}|${g.value})`,x.output+=g.value;continue}if(_==="{"&&r.nobrace!==!0){Me("braces");let R={type:"brace",value:_,output:"(",outputIndex:x.output.length,tokensIndex:x.tokens.length};y.push(R),U(R);continue}if(_==="}"){let R=y[y.length-1];if(r.nobrace===!0||!R){U({type:"text",value:_,output:_});continue}let k=")";if(R.dots===!0){let q=a.slice(),re=[];for(let Q=q.length-1;Q>=0&&(a.pop(),q[Q].type!=="brace");Q--)q[Q].type!=="dots"&&re.unshift(q[Q].value);k=Mo(re,r),x.backtrack=!0}if(R.comma!==!0&&R.dots!==!0){let q=x.output.slice(0,R.outputIndex),re=x.tokens.slice(R.tokensIndex);R.value=R.output="\\{",_=k="\\}",x.output=q;for(let Q of re)x.output+=Q.output||Q.value}U({type:"brace",value:_,output:k}),xe("braces"),y.pop();continue}if(_==="|"){P.length>0&&P[P.length-1].conditions++,U({type:"text",value:_});continue}if(_===","){let R=_,k=y[y.length-1];k&&O[O.length-1]==="braces"&&(k.comma=!0,R="|"),U({type:"comma",value:_,output:R});continue}if(_==="/"){if(g.type==="dot"&&x.index===x.start+1){x.start=x.index+1,x.consumed="",x.output="",a.pop(),g=s;continue}U({type:"slash",value:_,output:m});continue}if(_==="."){if(x.braces>0&&g.type==="dot"){g.value==="."&&(g.output=c);let R=y[y.length-1];g.type="dots",g.output+=_,g.value+=_,R.dots=!0;continue}if(x.braces+x.parens===0&&g.type!=="bos"&&g.type!=="slash"){U({type:"text",value:_,output:c});continue}U({type:"dot",value:_,output:c});continue}if(_==="?"){if(!(g&&g.value==="(")&&r.noextglob!==!0&&H()==="("&&H(2)!=="?"){Ie("qmark",_);continue}if(g&&g.type==="paren"){let k=H(),q=_;if(k==="<"&&!he.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(g.value==="("&&!/[!=<:]/.test(k)||k==="<"&&!/<([!=]|\w+>)/.test(J()))&&(q=`\\${_}`),U({type:"text",value:_,output:q});continue}if(r.dot!==!0&&(g.type==="slash"||g.type==="bos")){U({type:"qmark",value:_,output:M});continue}U({type:"qmark",value:_,output:T});continue}if(_==="!"){if(r.noextglob!==!0&&H()==="("&&(H(2)!=="?"||!/[!=<:]/.test(H(3)))){Ie("negate",_);continue}if(r.nonegate!==!0&&x.index===0){Ye();continue}}if(_==="+"){if(r.noextglob!==!0&&H()==="("&&H(2)!=="?"){Ie("plus",_);continue}if(g&&g.value==="("||r.regex===!1){U({type:"plus",value:_,output:f});continue}if(g&&(g.type==="bracket"||g.type==="paren"||g.type==="brace")||x.parens>0){U({type:"plus",value:_});continue}U({type:"plus",value:f});continue}if(_==="@"){if(r.noextglob!==!0&&H()==="("&&H(2)!=="?"){U({type:"at",extglob:!0,value:_,output:""});continue}U({type:"text",value:_});continue}if(_!=="*"){(_==="$"||_==="^")&&(_=`\\${_}`);let R=To.exec(J());R&&(_+=R[0],x.index+=R[0].length),U({type:"text",value:_});continue}if(g&&(g.type==="globstar"||g.star===!0)){g.type="star",g.star=!0,g.value+=_,g.output=D,x.backtrack=!0,x.globstar=!0,te(_);continue}let C=J();if(r.noextglob!==!0&&/^\([^?]/.test(C)){Ie("star",_);continue}if(g.type==="star"){if(r.noglobstar===!0){te(_);continue}let R=g.prev,k=R.prev,q=R.type==="slash"||R.type==="bos",re=k&&(k.type==="star"||k.type==="globstar");if(r.bash===!0&&(!q||C[0]&&C[0]!=="/")){U({type:"star",value:_,output:""});continue}let Q=x.braces>0&&(R.type==="comma"||R.type==="brace"),Nt=P.length&&(R.type==="pipe"||R.type==="paren");if(!q&&R.type!=="paren"&&!Q&&!Nt){U({type:"star",value:_,output:""});continue}for(;C.slice(0,3)==="/**";){let nt=t[x.index+4];if(nt&&nt!=="/")break;C=C.slice(3),te("/**",3)}if(R.type==="bos"&&$()){g.type="globstar",g.value+=_,g.output=N(r),x.output=g.output,x.globstar=!0,te(_);continue}if(R.type==="slash"&&R.prev.type!=="bos"&&!re&&$()){x.output=x.output.slice(0,-(R.output+g.output).length),R.output=`(?:${R.output}`,g.type="globstar",g.output=N(r)+(r.strictSlashes?")":"|$)"),g.value+=_,x.globstar=!0,x.output+=R.output+g.output,te(_);continue}if(R.type==="slash"&&R.prev.type!=="bos"&&C[0]==="/"){let nt=C[1]!==void 0?"|$":"";x.output=x.output.slice(0,-(R.output+g.output).length),R.output=`(?:${R.output}`,g.type="globstar",g.output=`${N(r)}${m}|${m}${nt})`,g.value+=_,x.output+=R.output+g.output,x.globstar=!0,te(_+Z()),U({type:"slash",value:"/",output:""});continue}if(R.type==="bos"&&C[0]==="/"){g.type="globstar",g.value+=_,g.output=`(?:^|${m}|${N(r)}${m})`,x.output=g.output,x.globstar=!0,te(_+Z()),U({type:"slash",value:"/",output:""});continue}x.output=x.output.slice(0,-g.output.length),g.type="globstar",g.output=N(r),g.value+=_,x.output+=g.output,x.globstar=!0,te(_);continue}let G={type:"star",value:_,output:D};if(r.bash===!0){G.output=".*?",(g.type==="bos"||g.type==="slash")&&(G.output=A+G.output),U(G);continue}if(g&&(g.type==="bracket"||g.type==="paren")&&r.regex===!0){G.output=_,U(G);continue}(x.index===x.start||g.type==="slash"||g.type==="dot")&&(g.type==="dot"?(x.output+=E,g.output+=E):r.dot===!0?(x.output+=I,g.output+=I):(x.output+=A,g.output+=A),H()!=="*"&&(x.output+=p,g.output+=p)),U(G)}for(;x.brackets>0;){if(r.strictBrackets===!0)throw new SyntaxError(Ue("closing","]"));x.output=he.escapeLast(x.output,"["),xe("brackets")}for(;x.parens>0;){if(r.strictBrackets===!0)throw new SyntaxError(Ue("closing",")"));x.output=he.escapeLast(x.output,"("),xe("parens")}for(;x.braces>0;){if(r.strictBrackets===!0)throw new SyntaxError(Ue("closing","}"));x.output=he.escapeLast(x.output,"{"),xe("braces")}if(r.strictSlashes!==!0&&(g.type==="star"||g.type==="bracket")&&U({type:"maybe_slash",value:"",output:`${m}?`}),x.backtrack===!0){x.output="";for(let C of x.tokens)x.output+=C.output!=null?C.output:C.value,C.suffix&&(x.output+=C.suffix)}return x};nr.fastpaths=(t,e)=>{let r={...e},n=typeof r.maxLength=="number"?Math.min(mt,r.maxLength):mt,i=t.length;if(i>n)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${n}`);t=Nn[t]||t;let s=he.isWindows(e),{DOT_LITERAL:a,SLASH_LITERAL:o,ONE_CHAR:l,DOTS_SLASH:h,NO_DOT:u,NO_DOTS:c,NO_DOTS_SLASH:f,STAR:m,START_ANCHOR:p}=dt.globChars(s),v=r.dot?c:u,d=r.dot?f:u,E=r.capture?"":"?:",I={negated:!1,prefix:""},T=r.bash===!0?".*?":m;r.capture&&(T=`(${T})`);let M=A=>A.noglobstar===!0?T:`(${E}(?:(?!${p}${A.dot?h:a}).)*?)`,S=A=>{switch(A){case"*":return`${v}${l}${T}`;case".*":return`${a}${l}${T}`;case"*.*":return`${v}${T}${a}${l}${T}`;case"*/*":return`${v}${T}${o}${l}${d}${T}`;case"**":return v+M(r);case"**/*":return`(?:${v}${M(r)}${o})?${d}${l}${T}`;case"**/*.*":return`(?:${v}${M(r)}${o})?${d}${T}${a}${l}${T}`;case"**/.*":return`(?:${v}${M(r)}${o})?${a}${l}${T}`;default:{let w=/^(.*?)\.(\w+)$/.exec(A);if(!w)return;let D=S(w[1]);return D?D+a+w[2]:void 0}}},b=he.removePrefix(t,I),N=S(b);return N&&r.strictSlashes!==!0&&(N+=`${o}?`),N};On.exports=nr});var Dn=Le(($f,Pn)=>{"use strict";var So=ct(),Ro=Cn(),ir=Bn(),sr=pt(),Io=Ge(),Lo=t=>t&&typeof t=="object"&&!Array.isArray(t),X=(t,e,r=!1)=>{if(Array.isArray(t)){let u=t.map(f=>X(f,e,r));return f=>{for(let m of u){let p=m(f);if(p)return p}return!1}}let n=Lo(t)&&t.tokens&&t.input;if(t===""||typeof t!="string"&&!n)throw new TypeError("Expected pattern to be a non-empty string");let i=e||{},s=sr.isWindows(e),a=n?X.compileRe(t,e):X.makeRe(t,e,!1,!0),o=a.state;delete a.state;let l=()=>!1;if(i.ignore){let u={...e,ignore:null,onMatch:null,onResult:null};l=X(i.ignore,u,r)}let h=(u,c=!1)=>{let{isMatch:f,match:m,output:p}=X.test(u,a,e,{glob:t,posix:s}),v={glob:t,state:o,regex:a,posix:s,input:u,output:p,match:m,isMatch:f};return typeof i.onResult=="function"&&i.onResult(v),f===!1?(v.isMatch=!1,c?v:!1):l(u)?(typeof i.onIgnore=="function"&&i.onIgnore(v),v.isMatch=!1,c?v:!1):(typeof i.onMatch=="function"&&i.onMatch(v),c?v:!0)};return r&&(h.state=o),h};X.test=(t,e,r,{glob:n,posix:i}={})=>{if(typeof t!="string")throw new TypeError("Expected input to be a string");if(t==="")return{isMatch:!1,output:""};let s=r||{},a=s.format||(i?sr.toPosixSlashes:null),o=t===n,l=o&&a?a(t):t;return o===!1&&(l=a?a(t):t,o=l===n),(o===!1||s.capture===!0)&&(s.matchBase===!0||s.basename===!0?o=X.matchBase(t,e,r,i):o=e.exec(l)),{isMatch:Boolean(o),match:o,output:l}};X.matchBase=(t,e,r,n=sr.isWindows(r))=>(e instanceof RegExp?e:X.makeRe(e,r)).test(So.basename(t));X.isMatch=(t,e,r)=>X(e,r)(t);X.parse=(t,e)=>Array.isArray(t)?t.map(r=>X.parse(r,e)):ir(t,{...e,fastpaths:!1});X.scan=(t,e)=>Ro(t,e);X.compileRe=(t,e,r=!1,n=!1)=>{if(r===!0)return t.output;let i=e||{},s=i.contains?"":"^",a=i.contains?"":"$",o=`${s}(?:${t.output})${a}`;t&&t.negated===!0&&(o=`^(?!${o}).*$`);let l=X.toRegex(o,e);return n===!0&&(l.state=t),l};X.makeRe=(t,e={},r=!1,n=!1)=>{if(!t||typeof t!="string")throw new TypeError("Expected a non-empty string");let i={negated:!1,fastpaths:!0};return e.fastpaths!==!1&&(t[0]==="."||t[0]==="*")&&(i.output=ir.fastpaths(t,e)),i.output||(i=ir(t,e)),X.compileRe(i,e,r,n)};X.toRegex=(t,e)=>{try{let r=e||{};return new RegExp(t,r.flags||(r.nocase?"i":""))}catch(r){if(e&&e.debug===!0)throw r;return/$^/}};X.constants=Io;Pn.exports=X});var Un=Le((qf,Fn)=>{"use strict";Fn.exports=Dn()});var As=`<div class="container">
  <label class="hidden" id="title">display-port</label>
  <label class="hidden" id="fps">00</label>
  <label class="hidden" id="dimension">0x0</label>
  <div class="content">
    <canvas> Oh no! Your browser does not support canvas. </canvas>
    <slot id="inner"></slot>
  </div>
  <slot name="frame"></slot>
</div>
`,ws=`:host {
  display: inline-block;
  color: #555555;
}

.container {
  display: flex;
  position: relative;
  width: 100%;
  height: 100%;
}

.content {
  position: relative;
  margin: auto;
}

.content > *:not(canvas) {
  width: 100%;
  height: 100%;
}

canvas {
  background: #000000;
  image-rendering: pixelated;
}

label {
  position: absolute;
  font-family: monospace;
  color: currentColor;
}

#inner {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: 0;
  left: 0;
  pointer-events: none;
}

#title {
  left: 0.5rem;
  top: 0.5rem;
}

#fps {
  right: 0.5rem;
  top: 0.5rem;
}

#dimension {
  left: 0.5rem;
  bottom: 0.5rem;
}

.hidden {
  display: none;
}

:host([debug]) .container {
  outline: 6px dashed rgba(0, 0, 0, 0.1);
  outline-offset: -4px;
  background-color: rgba(0, 0, 0, 0.1);
}

:host([mode='noscale']) canvas {
  margin: 0;
  top: 0;
  left: 0;
}

:host([mode='stretch']) canvas,
:host([mode='scale']) canvas {
  width: 100%;
  height: 100%;
}

:host([mode='fit']),
:host([mode='scale']),
:host([mode='center']),
:host([mode='stretch']),
:host([mode='fill']) {
  width: 100%;
  height: 100%;
}

:host([full]) {
  width: 100vw !important;
  height: 100vh !important;
}

:host([disabled]) {
  display: none;
}

slot {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  pointer-events: none;
}

::slotted(*) {
  pointer-events: auto;
}
`,$r="noscale";var Ot="fit",qr="scale",Wr="fill",Xr="stretch",Qr=300,Zr=150,Jr=Ot,Ts=200,st=class extends HTMLElement{static create(e={}){let{root:r=document.body,mode:n=Jr,width:i=Qr,height:s=Zr,debug:a=!1}=e||{},o=new st;return o.mode=n,o.width=i,o.height=s,o.debug=a,r.appendChild(o),o}static get[Symbol.for("templateNode")](){let e=document.createElement("template");return e.innerHTML=As,Object.defineProperty(this,Symbol.for("templateNode"),{value:e}),e}static get[Symbol.for("styleNode")](){let e=document.createElement("style");return e.innerHTML=ws,Object.defineProperty(this,Symbol.for("styleNode"),{value:e}),e}static define(e=window.customElements){e.define("display-port",this)}static get observedAttributes(){return["debug","disabled","width","height","onframe","id","class"]}get mode(){return this.getAttribute("mode")}set mode(e){this.setAttribute("mode",e)}get debug(){return this._debug}set debug(e){this.toggleAttribute("debug",e)}get disabled(){return this._disabled}set disabled(e){this.toggleAttribute("disabled",e)}get width(){return this._width}set width(e){this.setAttribute("width",String(e))}get height(){return this._height}set height(e){this.setAttribute("height",String(e))}get onframe(){return this._onframe}set onframe(e){this._onframe&&this.removeEventListener("frame",this._onframe),this._onframe=e,this._onframe&&this.addEventListener("frame",e)}constructor(){super();let e=this.attachShadow({mode:"open"});e.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),e.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._canvasElement=e.querySelector("canvas"),this._contentElement=e.querySelector(".content"),this._innerElement=e.querySelector("#inner"),this._titleElement=e.querySelector("#title"),this._fpsElement=e.querySelector("#fps"),this._dimensionElement=e.querySelector("#dimension"),this._debug=!1,this._disabled=!1,this._width=Qr,this._height=Zr,this._onframe=void 0,this._animationRequestHandle=0,this._prevAnimationFrameTime=0,this._resizeTimeoutHandle=0,this._resizeCanvasWidth=0,this._resizeCanvasHeight=0,this._frameEvent=new CustomEvent("frame",{composed:!0,bubbles:!1,detail:{now:0,prevTime:0,deltaTime:0,canvas:this._canvasElement}}),this._resizeEvent=new CustomEvent("resize",{composed:!0,bubbles:!1,detail:{width:0,height:0}}),this.update=this.update.bind(this),this.onDelayCanvasResize=this.onDelayCanvasResize.bind(this)}get canvas(){return this._canvasElement}connectedCallback(){Fe(this,"mode"),Fe(this,"debug"),Fe(this,"disabled"),Fe(this,"width"),Fe(this,"height"),Fe(this,"onframe"),this.hasAttribute("mode")||this.setAttribute("mode",Jr),this.hasAttribute("tabindex")||this.setAttribute("tabindex","0"),this.updateCanvasSize(!0),this.resume()}disconnectedCallback(){this.pause()}attributeChangedCallback(e,r,n){switch(e){case"debug":this._debug=n!==null;break;case"disabled":this._disabled=n!==null;break;case"width":this._width=Number(n);break;case"height":this._height=Number(n);break;case"onframe":this.onframe=new Function("event","with(document){with(this){"+n+"}}").bind(this);break}switch(e){case"disabled":n?(this.update(0),this.pause()):this.resume();break;case"id":case"class":this._titleElement.innerHTML=`display-port${this.className?"."+this.className:""}${this.hasAttribute("id")?"#"+this.getAttribute("id"):""}`;break;case"debug":this._titleElement.classList.toggle("hidden",n),this._fpsElement.classList.toggle("hidden",n),this._dimensionElement.classList.toggle("hidden",n);break}}getContext(e="2d",r=void 0){return this._canvasElement.getContext(e,r)}pause(){window.cancelAnimationFrame(this._animationRequestHandle)}resume(){this._animationRequestHandle=window.requestAnimationFrame(this.update)}update(e){this._animationRequestHandle=window.requestAnimationFrame(this.update),this.updateCanvasSize(!1);let r=e-this._prevAnimationFrameTime;if(this._prevAnimationFrameTime=e,this._debug){let s=r<=0?"--":String(Math.round(1e3/r)).padStart(2,"0");if(this._fpsElement.textContent!==s&&(this._fpsElement.textContent=s),this.mode===$r){let o=`${this._width}x${this._height}`;this._dimensionElement.textContent!==o&&(this._dimensionElement.textContent=o)}else{let o=`${this._width}x${this._height}|${this.shadowRoot.host.clientWidth}x${this.shadowRoot.host.clientHeight}`;this._dimensionElement.textContent!==o&&(this._dimensionElement.textContent=o)}}let i=this._frameEvent.detail;i.now=e,i.prevTime=this._prevAnimationFrameTime,i.deltaTime=r,this.dispatchEvent(this._frameEvent)}onDelayCanvasResize(){this._resizeTimeoutHandle=null,this.updateCanvasSize(!0)}delayCanvasResize(e,r){(e!==this._resizeCanvasWidth||r!==this._resizeCanvasHeight)&&(this._resizeCanvasWidth=e,this._resizeCanvasHeight=r,this._resizeTimeoutHandle&&window.clearTimeout(this._resizeTimeoutHandle),this._resizeTimeoutHandle=window.setTimeout(this.onDelayCanvasResize,Ts))}updateCanvasSize(e=!0){let r=this.shadowRoot.host.getBoundingClientRect(),n=r.width,i=r.height,s=this._canvasElement,a=this._width,o=this._height,l=this.mode;if(l===Xr||l===Wr)a=n,o=i;else if(l!==$r&&(n<a||i<o||l===Ot||l==qr)){let u=n/a,c=i/o;u<c?(a=n,o=o*u):(a=a*c,o=i)}if(a=Math.floor(a),o=Math.floor(o),typeof e=="undefined"&&(e=s.clientWidth!==a||s.clientHeight!==o),!e){this.delayCanvasResize(a,o);return}let h=Math.min(a/this._width,o/this._height)*.5;if(this._innerElement.style.fontSize=`font-size: ${h}em`,e){l===qr?(s.width=this._width,s.height=this._height):l!==Xr&&(s.width=a,s.height=o);let u=this._contentElement.style;u.width=`${a}px`,u.height=`${o}px`,(l===Ot||l===Wr)&&(this._width=a,this._height=o);let f=this._resizeEvent.detail;f.width=a,f.height=o,this.dispatchEvent(this._resizeEvent)}}};st.define();function Fe(t,e){if(Object.prototype.hasOwnProperty.call(t,e)){let r=t[e];delete t[e],t[e]=r}}var Bt=class{get polling(){return performance.now()-this._lastPollingTime<1e3}get value(){return 0}get size(){return this._size}constructor(e){this._size=e,this._lastPollingTime=Number.MIN_SAFE_INTEGER}resize(e){this._size=e}getState(e){throw new Error("Missing implementation.")}onUpdate(e,r,n){throw new Error("Missing implementation.")}onStatus(e,r){throw new Error("Missing implementation.")}onPoll(e){this._lastPollingTime=e}onBind(e,r=void 0){e>=this._size&&this.resize(e+1)}onUnbind(){this.resize(0)}},je=class extends Bt{static createAxisBindingState(){return{value:0,delta:0,inverted:!1}}get delta(){return this._delta}get value(){return this._value}constructor(e=0){super(e);let r=new Array,n=this.constructor;for(let i=0;i<e;++i)r.push(n.createAxisBindingState());this._state=r,this._value=0,this._delta=0}resize(e){let r=this._state,n=r.length,i;if(e<=n)i=r.slice(0,e);else{i=r;let s=this.constructor;for(let a=n;a<e;++a)i.push(s.createAxisBindingState())}this._state=i,super.resize(e)}getState(e){return this._state[e].value}onPoll(e){let r=this._state,n=0,i=0,s=r.length;for(let a=0;a<s;++a){let o=r[a];n+=o.value*(o.inverted?-1:1),i+=o.delta,r[a].delta=0}this._value=n,this._delta=i,super.onPoll(e)}onUpdate(e,r,n){typeof r=="undefined"?this.onAxisChange(e,n):this.onAxisMove(e,r,n)}onStatus(e,r){this.onAxisStatus(e,r)}onBind(e,r=void 0){super.onBind(e,r);let{inverted:n=!1}=r||{},i=this._state;i[e].inverted=n}onAxisMove(e,r,n){let i=this._state[e];i.value=r,i.delta+=n}onAxisChange(e,r){let n=this._state[e];n.value+=r,n.delta+=r}onAxisStatus(e,r){let n=this._state[e],i=n.value;n.value=r,n.delta=r-i}},bs=241,en=254,Ms=239,Ce=1,Pt=2,Dt=4,Ft=8,Ut=16,at=class extends Bt{get pressed(){return this._pressed}get repeated(){return this._repeated}get released(){return this._released}get down(){return this._down}get value(){return this._value}constructor(e=0){super(e);this._state=new Uint8Array(e),this._value=0,this._down=!1,this._pressed=!1,this._repeated=!1,this._released=!1}resize(e){let r=this._state,n=r.length,i;e<=n?i=r.slice(0,e):(i=new Uint8Array(e),i.set(r)),this._state=i,super.resize(e)}getState(e){let r=this._state[e],n=r&Ut?-1:1;return(r&Ce?1:0)*n}onPoll(e){let r=this._state,n=0,i=0,s=0,a=0,o=0,l=r.length;for(let h=0;h<l;++h){let u=r[h],c=u&Ce,f=u&Ut;i|=c,s|=u&Pt,a|=u&Dt,o|=u&Ft,n+=(c?1:0)*(f?-1:1),r[h]&=bs}this._value=n,this._down=i!==0,this._pressed=s!==0,this._repeated=a!==0,this._released=o!==0,super.onPoll(e)}onUpdate(e,r,n){n>0?this.onButtonPressed(e):this.onButtonReleased(e)}onStatus(e,r){this.onButtonStatus(e,r!==0)}onBind(e,r={inverted:!1}){super.onBind(e,r);let{inverted:n=!1}=r,i=this._state;n?i[e]|=Ut:i[e]&=Ms}onButtonPressed(e){let r=this._state,n=r[e];n&Ce||(n|=Pt,n|=Ce),n|=Dt,r[e]=n}onButtonReleased(e){let r=this._state,n=r[e];n&Ce&&(n|=Ft,n&=en),r[e]=n}onButtonStatus(e,r){let n=this._state,i=n[e],s=Boolean(i&Ce);r?i|=Ce:i&=en,s&&!r&&(i|=Ft),!s&&r&&(i|=Pt,i|=Dt),n[e]=i}},L=class{static parse(e){e=e.trim();let r=e.indexOf(".");if(r<0)throw new Error("Missing device separator for key code.");let n=e.substring(0,r);if(n.length<0)throw new Error("Missing device for key code.");let i=e.substring(r+1);if(i.length<0)throw new Error("Missing code for key code.");return new L(n,i)}constructor(e,r){this.device=e,this.code=r}toString(){return`${this.device}.${this.code}`}};function kt(t,e){return new L(t,e)}function Ss(t){return"device"in t&&"code"in t}var B="Keyboard",ce="Mouse",Rs=new L(B,"KeyA"),Is=new L(B,"KeyB"),Ls=new L(B,"KeyC"),Cs=new L(B,"KeyD"),Ns=new L(B,"KeyE"),Os=new L(B,"KeyF"),Bs=new L(B,"KeyG"),Ps=new L(B,"KeyH"),Ds=new L(B,"KeyI"),Fs=new L(B,"KeyJ"),Us=new L(B,"KeyK"),ks=new L(B,"KeyL"),zs=new L(B,"KeyM"),Hs=new L(B,"KeyN"),Vs=new L(B,"KeyO"),Ys=new L(B,"KeyP"),js=new L(B,"KeyQ"),Gs=new L(B,"KeyR"),Ks=new L(B,"KeyS"),$s=new L(B,"KeyT"),qs=new L(B,"KeyU"),Ws=new L(B,"KeyV"),Xs=new L(B,"KeyW"),Qs=new L(B,"KeyX"),Zs=new L(B,"KeyY"),Js=new L(B,"KeyZ"),ea=new L(B,"Digit0"),ta=new L(B,"Digit1"),ra=new L(B,"Digit2"),na=new L(B,"Digit3"),ia=new L(B,"Digit4"),sa=new L(B,"Digit5"),aa=new L(B,"Digit6"),oa=new L(B,"Digit7"),la=new L(B,"Digit8"),ha=new L(B,"Digit9"),ua=new L(B,"Minus"),ca=new L(B,"Equal"),fa=new L(B,"BracketLeft"),pa=new L(B,"BracketRight"),da=new L(B,"Semicolon"),ma=new L(B,"Quote"),va=new L(B,"Backquote"),xa=new L(B,"Backslash"),ga=new L(B,"Comma"),_a=new L(B,"Period"),ya=new L(B,"Slash"),Ea=new L(B,"Escape"),Aa=new L(B,"Space"),wa=new L(B,"CapsLock"),Ta=new L(B,"Backspace"),ba=new L(B,"Delete"),Ma=new L(B,"Tab"),Sa=new L(B,"Enter"),Ra=new L(B,"ArrowUp"),Ia=new L(B,"ArrowDown"),La=new L(B,"ArrowLeft"),Ca=new L(B,"ArrowRight"),Na=new L(ce,"Button0"),Oa=new L(ce,"Button1"),Ba=new L(ce,"Button2"),Pa=new L(ce,"Button3"),Da=new L(ce,"Button4"),Fa=new L(ce,"PosX"),Ua=new L(ce,"PosY"),ka=new L(ce,"WheelX"),za=new L(ce,"WheelY"),Ha=new L(ce,"WheelZ"),le=Object.freeze({__proto__:null,ARROW_DOWN:Ia,ARROW_LEFT:La,ARROW_RIGHT:Ca,ARROW_UP:Ra,BACKQUOTE:va,BACKSLASH:xa,BACKSPACE:Ta,BRACKET_LEFT:fa,BRACKET_RIGHT:pa,CAPS_LOCK:wa,COMMA:ga,DELETE:ba,DIGIT_0:ea,DIGIT_1:ta,DIGIT_2:ra,DIGIT_3:na,DIGIT_4:ia,DIGIT_5:sa,DIGIT_6:aa,DIGIT_7:oa,DIGIT_8:la,DIGIT_9:ha,ENTER:Sa,EQUAL:ca,ESCAPE:Ea,KEYBOARD:B,KEY_A:Rs,KEY_B:Is,KEY_C:Ls,KEY_D:Cs,KEY_E:Ns,KEY_F:Os,KEY_G:Bs,KEY_H:Ps,KEY_I:Ds,KEY_J:Fs,KEY_K:Us,KEY_L:ks,KEY_M:zs,KEY_N:Hs,KEY_O:Vs,KEY_P:Ys,KEY_Q:js,KEY_R:Gs,KEY_S:Ks,KEY_T:$s,KEY_U:qs,KEY_V:Ws,KEY_W:Xs,KEY_X:Qs,KEY_Y:Zs,KEY_Z:Js,MINUS:ua,MOUSE:ce,MOUSE_BUTTON_0:Na,MOUSE_BUTTON_1:Oa,MOUSE_BUTTON_2:Ba,MOUSE_BUTTON_3:Pa,MOUSE_BUTTON_4:Da,MOUSE_POS_X:Fa,MOUSE_POS_Y:Ua,MOUSE_WHEEL_X:ka,MOUSE_WHEEL_Y:za,MOUSE_WHEEL_Z:Ha,PERIOD:_a,QUOTE:ma,SEMICOLON:da,SLASH:ya,SPACE:Aa,TAB:Ma,from:kt,isKeyCode:Ss}),zt=class{get polling(){return this.ref?this.ref.polling:!1}get value(){return!this.ref||this.disabled?0:this.ref.value}constructor(e){this.name=e,this.ref=null,this.disabled=!1}bindTo(e){throw new Error("Unsupported operation.")}disable(e=!0){return this.disabled=e,this}getState(e){return!this.ref||this.disabled?0:this.ref.getState(e)}};function tn(t){Array.isArray(t)||(t=[t]);let e=[];for(let r of t){let n;try{n=L.parse(r)}catch(i){let s=Va(r).toUpperCase();if(!(s in le))throw new Error("Invalid key code string - "+i);n=le[s]}e.push(n)}return e}function Va(t){return t.replace(/([a-z]|(?:[A-Z0-9]+))([A-Z0-9]|$)/g,function(e,r,n){return r+(n&&"_"+n)}).toLowerCase()}var ge=class extends zt{static fromBind(e,r,n,i=void 0){return new ge(e,kt(r,n),i)}static fromString(e,...r){let n=tn(r);return new ge(e,n)}get delta(){return!this.ref||this.disabled?0:this.ref.delta}constructor(e,r,n=void 0){super(e);this.keyCodes=Array.isArray(r)?r:[r],this.opts=n}bindTo(e){let r=this.name,n=this.opts;for(let i of this.keyCodes)e.bindAxis(r,i.device,i.code,n);return this.ref=e.getAxis(r),this}},W=class extends zt{static fromBind(e,r,n,i=void 0){return new W(e,kt(r,n),i)}static fromString(e,...r){let n=tn(r);return new W(e,n)}get pressed(){return!this.ref||this.disabled?!1:this.ref.pressed}get repeated(){return!this.ref||this.disabled?!1:this.ref.repeated}get released(){return!this.ref||this.disabled?!1:this.ref.released}get down(){return!this.ref||this.disabled?!1:this.ref.down}constructor(e,r,n=void 0){super(e);this.keyCodes=Array.isArray(r)?r:[r],this.opts=n}bindTo(e){let r=this.name,n=this.opts;for(let i of this.keyCodes)e.bindButton(r,i.device,i.code,n);return this.ref=e.getButton(r),this}};var Ht=class{static isAxis(e){return!1}static isButton(e){return!1}constructor(e,r){if(!r)throw new Error(`Missing event target for device ${e}.`);this.name=e,this.eventTarget=r,this.listeners={input:[]}}setEventTarget(e){if(!e)throw new Error(`Missing event target for device ${this.name}.`);this.eventTarget=e}destroy(){let e=this.listeners;for(let r in e)e[r].length=0}addEventListener(e,r){let n=this.listeners;e in n?n[e].push(r):n[e]=[r]}removeEventListener(e,r){let n=this.listeners;if(e in n){let i=n[e],s=i.indexOf(r);s>=0&&i.splice(s,1)}}dispatchInputEvent(e){let r=0;for(let n of this.listeners.input)r|=n(e);return Boolean(r)}},rn=class extends Ht{static isAxis(e){return!1}static isButton(e){return!0}constructor(e,r,n={}){super(e,r);let{ignoreRepeat:i=!0}=n;this.ignoreRepeat=i,this._eventObject={target:r,device:e,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),r.addEventListener("keydown",this.onKeyDown),r.addEventListener("keyup",this.onKeyUp)}setEventTarget(e){this.eventTarget&&this.destroy(),super.setEventTarget(e),e.addEventListener("keydown",this.onKeyDown),e.addEventListener("keyup",this.onKeyUp)}destroy(){let e=this.eventTarget;e.removeEventListener("keydown",this.onKeyDown),e.removeEventListener("keyup",this.onKeyUp),super.destroy()}onKeyDown(e){if(e.repeat&&this.ignoreRepeat)return e.preventDefault(),e.stopPropagation(),!1;let r=this._eventObject;if(r.code=e.code,r.event="pressed",r.value=1,r.control=e.ctrlKey,r.shift=e.shiftKey,r.alt=e.altKey,this.dispatchInputEvent(r))return e.preventDefault(),e.stopPropagation(),!1}onKeyUp(e){let r=this._eventObject;if(r.code=e.code,r.event="released",r.value=1,r.control=e.ctrlKey,r.shift=e.shiftKey,r.alt=e.altKey,this.dispatchInputEvent(r))return e.preventDefault(),e.stopPropagation(),!1}},Vt=10,Yt=100,nn=class extends Ht{static isAxis(e){return e==="PosX"||e==="PosY"||e==="WheelX"||e==="WheelY"||e==="WheelZ"}static isButton(e){return!this.isAxis(e)}constructor(e,r,n={}){super(e,r);let{eventsOnFocus:i=!0}=n;this.eventsOnFocus=i,this.canvasTarget=this.getCanvasFromEventTarget(r),this._downHasFocus=!1,this._eventObject={target:r,device:e,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this._positionObject={target:r,device:e,code:"",event:"move",value:0,movement:0},this._wheelObject={target:r,device:e,code:"",event:"wheel",movement:0},this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onWheel=this.onWheel.bind(this),r.addEventListener("mousedown",this.onMouseDown),r.addEventListener("contextmenu",this.onContextMenu),r.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}setEventTarget(e){this.eventTarget&&this.destroy(),super.setEventTarget(e),this.canvasTarget=this.getCanvasFromEventTarget(e),e.addEventListener("mousedown",this.onMouseDown),e.addEventListener("contextmenu",this.onContextMenu),e.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}destroy(){let e=this.eventTarget;e.removeEventListener("mousedown",this.onMouseDown),e.removeEventListener("contextmenu",this.onContextMenu),e.removeEventListener("wheel",this.onWheel),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),super.destroy()}setPointerLock(e=!0){e?this.eventTarget.requestPointerLock():this.eventTarget.exitPointerLock()}hasPointerLock(){return document.pointerLockElement===this.eventTarget}onMouseDown(e){this._downHasFocus=!0;let r=this._eventObject;if(r.code="Button"+e.button,r.event="pressed",r.value=1,r.control=e.ctrlKey,r.shift=e.shiftKey,r.alt=e.altKey,this.dispatchInputEvent(r)&&document.activeElement===this.eventTarget)return e.preventDefault(),e.stopPropagation(),!1}onContextMenu(e){return e.preventDefault(),e.stopPropagation(),!1}onWheel(e){let r,n,i;switch(e.deltaMode){case WheelEvent.DOM_DELTA_LINE:r=e.deltaX*Vt,n=e.deltaY*Vt,i=e.deltaZ*Vt;break;case WheelEvent.DOM_DELTA_PAGE:r=e.deltaX*Yt,n=e.deltaY*Yt,i=e.deltaZ*Yt;break;case WheelEvent.DOM_DELTA_PIXEL:default:r=e.deltaX,n=e.deltaY,i=e.deltaZ;break}let s=0,a=this._wheelObject;if(a.code="WheelX",a.movement=r,s|=this.dispatchInputEvent(a),a.code="WheelY",a.movement=n,s|=this.dispatchInputEvent(a),a.code="WheelZ",a.movement=i,s|=this.dispatchInputEvent(a),s)return e.preventDefault(),e.stopPropagation(),!1}onMouseUp(e){if(!this._downHasFocus)return;this._downHasFocus=!1;let r=this._eventObject;if(r.code="Button"+e.button,r.event="released",r.value=1,r.control=e.ctrlKey,r.shift=e.shiftKey,r.alt=e.altKey,this.dispatchInputEvent(r))return e.preventDefault(),e.stopPropagation(),!1}onMouseMove(e){if(this.eventsOnFocus&&document.activeElement!==this.eventTarget)return;let r=this.canvasTarget,{clientWidth:n,clientHeight:i}=r,s=r.getBoundingClientRect(),a=e.movementX/n,o=e.movementY/i,l=(e.clientX-s.left)/n,h=(e.clientY-s.top)/i,u=this._positionObject;u.code="PosX",u.value=l,u.movement=a,this.dispatchInputEvent(u),u.code="PosY",u.value=h,u.movement=o,this.dispatchInputEvent(u)}getCanvasFromEventTarget(e){return e instanceof HTMLCanvasElement?e:e.canvas||e.querySelector("canvas")||e.shadowRoot&&e.shadowRoot.querySelector("canvas")||e}},Ya=`<kbd>
  <span id="name"><slot></slot></span>
  <span id="value" class="hidden"></span>
</kbd>
`,ja=`kbd {
  position: relative;
  display: inline-block;
  border-radius: 3px;
  border: 1px solid #888888;
  font-size: 0.85em;
  font-weight: 700;
  text-rendering: optimizeLegibility;
  line-height: 12px;
  height: 14px;
  padding: 2px 4px;
  color: #444444;
  background-color: #eeeeee;
  box-shadow: inset 0 -3px 0 #aaaaaa;
  overflow: hidden;
}

kbd:empty::after {
  content: '<?>';
  opacity: 0.6;
}

.disabled {
  opacity: 0.6;
  box-shadow: none;
  background-color: #aaaaaa;
}

.hidden {
  display: none;
}

#value {
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  font-size: 0.85em;
  padding: 0 4px;
  padding-top: 2px;
  color: #cccccc;
  background-color: #333333;
  box-shadow: inset 0 3px 0 #222222;
}
`,jt=class extends HTMLElement{static get[Symbol.for("templateNode")](){let e=document.createElement("template");return e.innerHTML=Ya,Object.defineProperty(this,Symbol.for("templateNode"),{value:e}),e}static get[Symbol.for("styleNode")](){let e=document.createElement("style");return e.innerHTML=ja,Object.defineProperty(this,Symbol.for("styleNode"),{value:e}),e}static define(e=window.customElements){e.define("input-code",this)}static get observedAttributes(){return["name","value","disabled"]}get disabled(){return this._disabled}set disabled(e){this.toggleAttribute("disabled",e)}get value(){return this._value}set value(e){this.setAttribute("value",e)}get name(){return this._name}set name(e){this.setAttribute("name",e)}constructor(){super();let e=this.constructor,r=this.attachShadow({mode:"open"});r.appendChild(e[Symbol.for("templateNode")].content.cloneNode(!0)),r.appendChild(e[Symbol.for("styleNode")].cloneNode(!0)),this._name="",this._value="",this._disabled=!1,this._kbdElement=r.querySelector("kbd"),this._nameElement=r.querySelector("#name"),this._valueElement=r.querySelector("#value")}attributeChangedCallback(e,r,n){switch(e){case"name":this._name=n,this._nameElement.textContent=n;break;case"value":this._value=n,n!==null?(this._valueElement.classList.toggle("hidden",!1),this._valueElement.textContent=n,this._kbdElement.style.paddingRight=`${this._valueElement.clientWidth+4}px`):this._valueElement.classList.toggle("hidden",!0);break;case"disabled":this._disabled=n!==null,this._kbdElement.classList.toggle("disabled",n!==null);break}}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"name")){let e=this.name;delete this.name,this.name=e}if(Object.prototype.hasOwnProperty.call(this,"value")){let e=this.value;delete this.value,this.value=e}if(Object.prototype.hasOwnProperty.call(this,"disabled")){let e=this.disabled;delete this.disabled,this.disabled=e}}};jt.define();var Ga=`<table>
  <thead>
    <tr class="tableHeader">
      <th colspan="3">
        <span class="tableTitle">
          <label id="title"> input-source </label>
          <span id="slotContainer">
            <slot></slot>
          </span>
          <p>
            <label for="poll">poll</label>
            <output id="poll"></output>
          </p>
          <p>
            <label for="focus">focus</label>
            <output id="focus"></output>
          </p>
        </span>
      </th>
    </tr>
    <tr class="colHeader">
      <th>name</th>
      <th>value</th>
      <th>key</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
`,Ka=`:host {
  display: block;
}

table {
  border-collapse: collapse;
  font-family: monospace;
}

table,
th,
td {
  border: 1px solid #666666;
}

th,
td {
  padding: 5px 10px;
}

td {
  text-align: center;
}

thead th {
  padding: 0;
}

.colHeader > th {
  font-size: 0.8em;
  padding: 0 10px;
  letter-spacing: 3px;
  background-color: #aaaaaa;
  color: #666666;
}

tbody output {
  border-radius: 0.3em;
  padding: 3px;
}

tr:not(.primary) .name,
tr:not(.primary) .value {
  opacity: 0.3;
}

tr:nth-child(2n) {
  background-color: #eeeeee;
}

.tableHeader {
  color: #666666;
}

.tableTitle {
  display: flex;
  flex-direction: row;
  align-items: center;
  padding: 4px;
}

#slotContainer {
  flex: 1;
}

p {
  display: inline;
  margin: 0;
  padding: 0;
  padding-right: 10px;
}

#poll:empty::after,
#focus:empty::after {
  content: '\u2717';
  color: #ff0000;
}
`,sn=class{constructor(e){this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null,this.pollable=e}get running(){return this.animationFrameHandle!==null}start(){let e=this.animationFrameHandle;e&&cancelAnimationFrame(e),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}stop(){let e=this.animationFrameHandle;e&&cancelAnimationFrame(e),this.animationFrameHandle=null}onAnimationFrame(e){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.pollable.onPoll(e)}},an=class{constructor(e){this.onInput=this.onInput.bind(this),this.onPoll=this.onPoll.bind(this),this.bindings=e}onPoll(e){for(let r of this.bindings.getInputs())r.onPoll(e)}onInput(e){let{device:r,code:n,event:i,value:s,movement:a,control:o,shift:l,alt:h}=e,u=this.bindings.getBindings(r,n);switch(i){case"pressed":for(let{input:c,index:f}of u)c.onUpdate(f,1,1);break;case"released":for(let{input:c,index:f}of u)c.onUpdate(f,0,-1);break;case"move":for(let{input:c,index:f}of u)c.onUpdate(f,s,a);break;case"wheel":for(let{input:c,index:f}of u)c.onUpdate(f,void 0,a);break}return u.length>0}},Gt=class{constructor(e,r,n,i){this.device=e,this.code=r,this.input=n,this.index=i}},on=class{constructor(){this.bindingMap={},this.inputMap=new Map}clear(){for(let e of this.inputMap.keys())e.onUnbind();this.inputMap.clear(),this.bindingMap={}}bind(e,r,n,i={inverted:!1}){let s,a=this.inputMap;if(a.has(e)){let l=a.get(e),h=e.size;e.onBind(h,i),s=new Gt(r,n,e,h),l.push(s)}else{let l=[];a.set(e,l);let h=0;e.onBind(h,i),s=new Gt(r,n,e,h),l.push(s)}let o=this.bindingMap;r in o?n in o[r]?o[r][n].push(s):o[r][n]=[s]:o[r]={[n]:[s]}}unbind(e){let r=this.inputMap;if(r.has(e)){let n=this.bindingMap,i=r.get(e);for(let s of i){let{device:a,code:o}=s,l=n[a][o],h=l.indexOf(s);l.splice(h,1)}i.length=0,e.onUnbind(),r.delete(e)}}isBound(e){return this.inputMap.has(e)}getInputs(){return this.inputMap.keys()}getBindingsByInput(e){return this.inputMap.get(e)}getBindings(e,r){let n=this.bindingMap;if(e in n){let i=n[e];if(r in i)return i[r]}return[]}},ln=class{constructor(e,r=void 0){this.inputs={},this.devices=[new nn("Mouse",e),new rn("Keyboard",e)],this.bindings=new on,this.adapter=new an(this.bindings),this.autopoller=new sn(this.adapter),this.eventTarget=e,this.anyButton=new at(1),this.anyButtonDevice="",this.anyButtonCode="",this.anyAxis=new je(1),this.anyAxisDevice="",this.anyAxisCode="",this.listeners={bind:[],unbind:[],focus:[],blur:[]},this.onInput=this.onInput.bind(this),this.onEventTargetBlur=this.onEventTargetBlur.bind(this),this.onEventTargetFocus=this.onEventTargetFocus.bind(this),e.addEventListener("focus",this.onEventTargetFocus),e.addEventListener("blur",this.onEventTargetBlur);for(let n of this.devices)n.addEventListener("input",this.onInput)}get autopoll(){return this.autopoller.running}set autopoll(e){this.toggleAutoPoll(e)}destroy(){let e=this.listeners;for(let n in e)e[n].length=0;this.autopoller.running&&this.autopoller.stop();for(let n of this.devices)n.removeEventListener("input",this.onInput),n.destroy();let r=this.eventTarget;r.removeEventListener("focus",this.onEventTargetFocus),r.removeEventListener("blur",this.onEventTargetBlur)}setEventTarget(e){let r=this.eventTarget;r.removeEventListener("focus",this.onEventTargetFocus),r.removeEventListener("blur",this.onEventTargetBlur),this.eventTarget=e;for(let n of this.devices)n.setEventTarget(e);e.addEventListener("focus",this.onEventTargetFocus),e.addEventListener("blur",this.onEventTargetBlur)}toggleAutoPoll(e=void 0){let r=this.autopoller.running,n=typeof e=="undefined"?!r:Boolean(e);n!==r&&(n?this.autopoller.start():this.autopoller.stop())}addEventListener(e,r){let n=this.listeners;e in n?n[e].push(r):n[e]=[r]}removeEventListener(e,r){let n=this.listeners;if(e in n){let i=n[e],s=i.indexOf(r);s>=0&&i.splice(s,1)}}dispatchEvent(e){let{type:r}=e,n=0;for(let i of this.listeners[r])n|=i(e)?1:0;return Boolean(n)}poll(e=performance.now()){if(this.autopoller.running)throw new Error("Should not manually poll() while autopolling.");this.onPoll(e)}onInput(e){let r=this.adapter.onInput(e);switch(e.event){case"pressed":this.anyButtonDevice=e.device,this.anyButtonCode=e.code,this.anyButton.onUpdate(0,1,1);break;case"released":this.anyButtonDevice=e.device,this.anyButtonCode=e.code,this.anyButton.onUpdate(0,0,-1);break;case"move":case"wheel":this.anyAxisDevice=e.device,this.anyAxisCode=e.code,this.anyAxis.onUpdate(0,e.value,e.movement);break}return r}onPoll(e){this.adapter.onPoll(e),this.anyButton.onPoll(e),this.anyAxis.onPoll(e)}onBind(){this.dispatchEvent({type:"bind"})}onUnbind(){this.dispatchEvent({type:"unbind"})}onEventTargetFocus(){this.dispatchEvent({type:"focus"})}onEventTargetBlur(){for(let e of this.bindings.getInputs())e.onStatus(0,0);this.anyButton.onStatus(0,0),this.anyAxis.onStatus(0,0),this.dispatchEvent({type:"blur"})}bindBindings(e){Array.isArray(e)||(e=Object.values(e));for(let r of e)r.bindTo(this)}bindBinding(e){e.bindTo(this)}bindButton(e,r,n,i=void 0){let s;this.hasButton(e)?s=this.getButton(e):(s=new at(1),this.inputs[e]=s),this.bindings.bind(s,r,n,i),this.onBind()}bindAxis(e,r,n,i=void 0){let s;this.hasAxis(e)?s=this.getAxis(e):(s=new je(1),this.inputs[e]=s),this.bindings.bind(s,r,n,i),this.onBind()}bindAxisButtons(e,r,n,i){let s;this.hasAxis(e)?s=this.getAxis(e):(s=new je(2),this.inputs[e]=s),this.bindings.bind(s,r,i),this.bindings.bind(s,r,n,{inverted:!0}),this.onBind()}unbindButton(e){if(this.hasButton(e)){let r=this.getButton(e);delete this.inputs[e],this.bindings.unbind(r),this.onUnbind()}}unbindAxis(e){if(this.hasAxis(e)){let r=this.getAxis(e);delete this.inputs[e],this.bindings.unbind(r),this.onUnbind()}}getInput(e){return this.inputs[e]}getButton(e){return this.inputs[e]}getAxis(e){return this.inputs[e]}hasButton(e){return e in this.inputs&&this.inputs[e]instanceof at}hasAxis(e){return e in this.inputs&&this.inputs[e]instanceof je}isButtonDown(e){return this.inputs[e].down}isButtonPressed(e){return this.inputs[e].pressed}isButtonReleased(e){return this.inputs[e].released}getInputValue(e){return this.inputs[e].value}getButtonValue(e){return this.inputs[e].value}getAxisValue(e){return this.inputs[e].value}getAxisDelta(e){return this.inputs[e].delta}isAnyButtonDown(e=void 0){if(typeof e=="undefined")return this.anyButton.down;{let r=this.inputs;for(let n of e)if(r[n].down)return!0}return!1}isAnyButtonPressed(e=void 0){if(typeof e=="undefined")return this.anyButton.pressed;{let r=this.inputs;for(let n of e)if(r[n].pressed)return!0}return!1}isAnyButtonReleased(e=void 0){if(typeof e=="undefined")return this.anyButton.released;{let r=this.inputs;for(let n of e)if(r[n].released)return!0}return!1}getAnyAxisValue(e=void 0){if(typeof e=="undefined")return this.anyAxis.value;{let r=this.inputs;for(let n of e){let i=r[n];if(i.value)return i.value}}return 0}getAnyAxisDelta(e=void 0){if(typeof e=="undefined")return this.anyAxis.delta;{let r=this.inputs;for(let n of e){let i=r[n];if(i.delta)return i.delta}}return 0}getLastButtonDevice(){return this.anyButtonDevice}getLastButtonCode(){return this.anyButtonCode}getLastAxisDevice(){return this.anyAxisDevice}getLastAxisCode(){return this.anyAxisCode}getMouse(){return this.devices[0]}getKeyboard(){return this.devices[1]}},ot=class extends HTMLElement{static create(e={}){let{root:r=document.body,for:n=void 0,autopoll:i=!1}=e||{},s=new ot;return s.for=n,s.autopoll=i,r.appendChild(s),s}static get[Symbol.for("templateNode")](){let e=document.createElement("template");return e.innerHTML=Ga,Object.defineProperty(this,Symbol.for("templateNode"),{value:e}),e}static get[Symbol.for("styleNode")](){let e=document.createElement("style");return e.innerHTML=Ka,Object.defineProperty(this,Symbol.for("styleNode"),{value:e}),e}static define(e=window.customElements){e.define("input-port",this)}static get observedAttributes(){return["autopoll","for"]}get autopoll(){return this._autopoll}set autopoll(e){this.toggleAttribute("autopoll",e)}get for(){return this._for}set for(e){this.setAttribute("for",e)}constructor(){super();let e=this.attachShadow({mode:"open"});e.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),e.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._titleElement=e.querySelector("#title"),this._pollElement=e.querySelector("#poll"),this._focusElement=e.querySelector("#focus"),this._bodyElement=e.querySelector("tbody"),this._outputElements={},this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null;let r=this;this._for="",this._eventTarget=r,this._autopoll=!1,this._context=null,this.onInputContextBind=this.onInputContextBind.bind(this),this.onInputContextUnbind=this.onInputContextUnbind.bind(this),this.onInputContextFocus=this.onInputContextFocus.bind(this),this.onInputContextBlur=this.onInputContextBlur.bind(this)}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"for")){let e=this.for;delete this.for,this.for=e}if(Object.prototype.hasOwnProperty.call(this,"autopoll")){let e=this.autopoll;delete this.autopoll,this.autopoll=e}this.updateTable(),this.updateTableValues(),this.animationFrameHandle=window.requestAnimationFrame(this.onAnimationFrame)}disconnectedCallback(){let e=this._context;e&&(e.removeEventListener("bind",this.onInputContextBind),e.removeEventListener("unbind",this.onInputContextUnbind),e.removeEventListener("blur",this.onInputContextBlur),e.removeEventListener("focus",this.onInputContextFocus),e.destroy(),this._context=null)}attributeChangedCallback(e,r,n){switch(e){case"for":{this._for=n;let i,s;n?(i=document.getElementById(n),s=`${i.tagName.toLowerCase()}#${n}`):(i=this,s="input-port"),this._eventTarget=i,this._context&&this._context.setEventTarget(this._eventTarget),this._titleElement.innerHTML=`for ${s}`}break;case"autopoll":this._autopoll=n!==null,this._context&&this._context.toggleAutoPoll(this._autopoll);break}}onAnimationFrame(){this.animationFrameHandle=window.requestAnimationFrame(this.onAnimationFrame),this.updateTableValues(),this.updatePollStatus()}onInputContextBind(){return this.updateTable(),!0}onInputContextUnbind(){return this.updateTable(),!0}onInputContextFocus(){return this._focusElement.innerHTML="\u2713",!0}onInputContextBlur(){return this._focusElement.innerHTML="",!0}getContext(e="axisbutton",r=void 0){switch(e){case"axisbutton":if(!this._context){let n=new ln(this._eventTarget,r);n.addEventListener("bind",this.onInputContextBind),n.addEventListener("unbind",this.onInputContextUnbind),n.addEventListener("blur",this.onInputContextBlur),n.addEventListener("focus",this.onInputContextFocus),this._autopoll&&n.toggleAutoPoll(!0),this._context=n}return this._context;default:throw new Error(`Input context id '${e}' is not supported.`)}}updateTable(){if(this.isConnected)if(this._context){let e=this._context,r=e.inputs,n=e.bindings,i={},s=[];for(let a of Object.keys(r)){let o=r[a],l=!0;for(let h of n.getBindingsByInput(o)){let u=$a(`${o.constructor.name}.${a}`,`${h.device}.${h.code}`,0,l);s.push(u),l&&(i[a]=u.querySelector("output"),l=!1)}}this._outputElements=i,this._bodyElement.innerHTML="";for(let a of s)this._bodyElement.appendChild(a)}else{this._outputElements={},this._bodyElement.innerHTML="";return}else return}updateTableValues(){if(this.isConnected)if(this._context){let r=this._context.inputs;for(let n of Object.keys(this._outputElements)){let i=this._outputElements[n],s=r[n].value;i.innerText=Number(s).toFixed(2)}}else{for(let e of Object.keys(this._outputElements)){let r=this._outputElements[e];r.innerText="---"}return}else return}updatePollStatus(){if(this.isConnected)if(this._context){let r=this._context.inputs;for(let n of Object.values(r))if(!n.polling){this._pollElement.innerHTML="";return}this._pollElement.innerHTML="\u2713"}else{this._pollElement.innerHTML="-";return}else return}};ot.define();function $a(t,e,r,n=!0){let i=document.createElement("tr");n&&i.classList.add("primary");{let s=document.createElement("td");s.textContent=t,s.classList.add("name"),i.appendChild(s)}{let s=document.createElement("td"),a=document.createElement("output");n?a.innerText=Number(r).toFixed(2):a.innerText="---",a.classList.add("value"),s.appendChild(a),i.appendChild(s)}{let s=document.createElement("td");s.classList.add("key");let a=new jt;a.innerText=e,s.appendChild(a),i.appendChild(s)}return i}var Uf=Symbol("keyboardSource");var kf=Symbol("mouseSource");window.addEventListener("error",lt,!0);window.addEventListener("unhandledrejection",lt,!0);function lt(t){typeof t=="object"?t instanceof PromiseRejectionEvent?lt(t.reason):t instanceof ErrorEvent?lt(t.error):t instanceof Error?window.alert(t.stack):window.alert(JSON.stringify(t)):window.alert(t)}var ri=Es(Un());var kn={},Co=function(t,e,r,n,i){var s=new Worker(kn[e]||(kn[e]=URL.createObjectURL(new Blob([t+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return s.onmessage=function(a){var o=a.data,l=o.$e$;if(l){var h=new Error(l[0]);h.code=l[1],h.stack=l[2],i(h,null)}else i(null,o)},s.postMessage(r,n),s},ne=Uint8Array,Se=Uint16Array,ar=Uint32Array,or=new ne([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),lr=new ne([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),zn=new ne([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Hn=function(t,e){for(var r=new Se(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var i=new ar(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)i[s]=s-r[n]<<5|n;return[r,i]},Vn=Hn(or,2),hr=Vn[0],No=Vn[1];hr[28]=258,No[258]=28;var Yn=Hn(lr,0),jn=Yn[0],Wf=Yn[1],vt=new Se(32768);for(var K=0;K<32768;++K)Te=(K&43690)>>>1|(K&21845)<<1,Te=(Te&52428)>>>2|(Te&13107)<<2,Te=(Te&61680)>>>4|(Te&3855)<<4,vt[K]=((Te&65280)>>>8|(Te&255)<<8)>>>1;var Te,ke=function(t,e,r){for(var n=t.length,i=0,s=new Se(e);i<n;++i)t[i]&&++s[t[i]-1];var a=new Se(e);for(i=0;i<e;++i)a[i]=a[i-1]+s[i-1]<<1;var o;if(r){o=new Se(1<<e);var l=15-e;for(i=0;i<n;++i)if(t[i])for(var h=i<<4|t[i],u=e-t[i],c=a[t[i]-1]++<<u,f=c|(1<<u)-1;c<=f;++c)o[vt[c]>>>l]=h}else for(o=new Se(n),i=0;i<n;++i)t[i]&&(o[i]=vt[a[t[i]-1]++]>>>15-t[i]);return o},$e=new ne(288);for(var K=0;K<144;++K)$e[K]=8;for(var K=144;K<256;++K)$e[K]=9;for(var K=256;K<280;++K)$e[K]=7;for(var K=280;K<288;++K)$e[K]=8;var Gn=new ne(32);for(var K=0;K<32;++K)Gn[K]=5;var Kn=ke($e,9,1);var $n=ke(Gn,5,1),xt=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},ue=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},gt=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},qn=function(t){return(t+7)/8|0},_t=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new(t.BYTES_PER_ELEMENT==2?Se:t.BYTES_PER_ELEMENT==4?ar:ne)(r-e);return n.set(t.subarray(e,r)),n};var Wn=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ae=function(t,e,r){var n=new Error(e||Wn[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,ae),!r)throw n;return n},Xn=function(t,e,r){var n=t.length;if(!n||r&&r.f&&!r.l)return e||new ne(0);var i=!e||r,s=!r||r.i;r||(r={}),e||(e=new ne(n*3));var a=function(U){var Ie=e.length;if(U>Ie){var rt=new ne(Math.max(Ie*2,U));rt.set(e),e=rt}},o=r.f||0,l=r.p||0,h=r.b||0,u=r.l,c=r.d,f=r.m,m=r.n,p=n*8;do{if(!u){o=ue(t,l,1);var v=ue(t,l+1,3);if(l+=3,v)if(v==1)u=Kn,c=$n,f=9,m=5;else if(v==2){var T=ue(t,l,31)+257,M=ue(t,l+10,15)+4,S=T+ue(t,l+5,31)+1;l+=14;for(var b=new ne(S),N=new ne(19),A=0;A<M;++A)N[zn[A]]=ue(t,l+A*3,7);l+=M*3;for(var w=xt(N),D=(1<<w)-1,x=ke(N,w,1),A=0;A<S;){var P=x[ue(t,l,D)];l+=P&15;var d=P>>>4;if(d<16)b[A++]=d;else{var y=0,O=0;for(d==16?(O=3+ue(t,l,3),l+=2,y=b[A-1]):d==17?(O=3+ue(t,l,7),l+=3):d==18&&(O=11+ue(t,l,127),l+=7);O--;)b[A++]=y}}var g=b.subarray(0,T),_=b.subarray(T);f=xt(g),m=xt(_),u=ke(g,f,1),c=ke(_,m,1)}else ae(1);else{var d=qn(l)+4,E=t[d-4]|t[d-3]<<8,I=d+E;if(I>n){s&&ae(0);break}i&&a(h+E),e.set(t.subarray(d,I),h),r.b=h+=E,r.p=l=I*8,r.f=o;continue}if(l>p){s&&ae(0);break}}i&&a(h+131072);for(var $=(1<<f)-1,H=(1<<m)-1,Z=l;;Z=l){var y=u[gt(t,l)&$],J=y>>>4;if(l+=y&15,l>p){s&&ae(0);break}if(y||ae(2),J<256)e[h++]=J;else if(J==256){Z=l,u=null;break}else{var te=J-254;if(J>264){var A=J-257,ve=or[A];te=ue(t,l,(1<<ve)-1)+hr[A],l+=ve}var Ye=c[gt(t,l)&H],Me=Ye>>>4;Ye||ae(3),l+=Ye&15;var _=jn[Me];if(Me>3){var ve=lr[Me];_+=gt(t,l)&(1<<ve)-1,l+=ve}if(l>p){s&&ae(0);break}i&&a(h+131072);for(var xe=h+te;h<xe;h+=4)e[h]=e[h-_],e[h+1]=e[h+1-_],e[h+2]=e[h+2-_],e[h+3]=e[h+3-_];h=xe}}r.l=u,r.p=Z,r.b=h,r.f=o,u&&(o=1,r.m=f,r.d=c,r.n=m)}while(!o);return h==e.length?e:_t(e,0,h)};var Oo=new ne(0);var Bo=function(t,e){var r={};for(var n in t)r[n]=t[n];for(var n in e)r[n]=e[n];return r},Qn=function(t,e,r){for(var n=t(),i=t.toString(),s=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/\s+/g,"").split(","),a=0;a<n.length;++a){var o=n[a],l=s[a];if(typeof o=="function"){e+=";"+l+"=";var h=o.toString();if(o.prototype)if(h.indexOf("[native code]")!=-1){var u=h.indexOf(" ",8)+1;e+=h.slice(u,h.indexOf("(",u))}else{e+=h;for(var c in o.prototype)e+=";"+l+".prototype."+c+"="+o.prototype[c].toString()}else e+=h}else r[l]=o}return[e,r]},yt=[],Po=function(t){var e=[];for(var r in t)t[r].buffer&&e.push((t[r]=new t[r].constructor(t[r])).buffer);return e},Do=function(t,e,r,n){var i;if(!yt[r]){for(var s="",a={},o=t.length-1,l=0;l<o;++l)i=Qn(t[l],s,a),s=i[0],a=i[1];yt[r]=Qn(t[o],s,a)}var h=Bo({},yt[r][1]);return Co(yt[r][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",r,h,Po(h),n)},Fo=function(){return[ne,Se,ar,or,lr,zn,hr,jn,Kn,$n,vt,Wn,ke,xt,ue,gt,qn,_t,ae,Xn,cr,Zn,Jn]};var Zn=function(t){return postMessage(t,[t.buffer])},Jn=function(t){return t&&t.size&&new ne(t.size)},Uo=function(t,e,r,n,i,s){var a=Do(r,n,i,function(o,l){a.terminate(),s(o,l)});return a.postMessage([t,e],e.consume?[t.buffer]:[]),function(){a.terminate()}};var ye=function(t,e){return t[e]|t[e+1]<<8},fe=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},ur=function(t,e){return fe(t,e)+fe(t,e+4)*4294967296};function ko(t,e,r){return r||(r=e,e={}),typeof r!="function"&&ae(7),Uo(t,e,[Fo],function(n){return Zn(cr(n.data[0],Jn(n.data[1])))},1,r)}function cr(t,e){return Xn(t,e)}var Xf=typeof TextEncoder!="undefined"&&new TextEncoder,fr=typeof TextDecoder!="undefined"&&new TextDecoder,zo=0;try{fr.decode(Oo,{stream:!0}),zo=1}catch(t){}var Ho=function(t){for(var e="",r=0;;){var n=t[r++],i=(n>127)+(n>223)+(n>239);if(r+i>t.length)return[e,_t(t,r-1)];i?i==3?(n=((n&15)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,e+=String.fromCharCode(55296|n>>10,56320|n&1023)):i&1?e+=String.fromCharCode((n&31)<<6|t[r++]&63):e+=String.fromCharCode((n&15)<<12|(t[r++]&63)<<6|t[r++]&63):e+=String.fromCharCode(n)}};function Vo(t,e){if(e){for(var r="",n=0;n<t.length;n+=16384)r+=String.fromCharCode.apply(null,t.subarray(n,n+16384));return r}else{if(fr)return fr.decode(t);var i=Ho(t),s=i[0],a=i[1];return a.length&&ae(8),s}}var Yo=function(t,e){return e+30+ye(t,e+26)+ye(t,e+28)},jo=function(t,e,r){var n=ye(t,e+28),i=Vo(t.subarray(e+46,e+46+n),!(ye(t,e+8)&2048)),s=e+46+n,a=fe(t,e+20),o=r&&a==4294967295?Go(t,s):[a,fe(t,e+24),fe(t,e+42)],l=o[0],h=o[1],u=o[2];return[ye(t,e+10),l,h,i,s+ye(t,e+30)+ye(t,e+32),u]},Go=function(t,e){for(;ye(t,e)!=1;e+=4+ye(t,e+2));return[ur(t,e+12),ur(t,e+4),ur(t,e+20)]};var ei=typeof queueMicrotask=="function"?queueMicrotask:typeof setTimeout=="function"?setTimeout:function(t){t()};function ti(t,e,r){r||(r=e,e={}),typeof r!="function"&&ae(7);var n=[],i=function(){for(var d=0;d<n.length;++d)n[d]()},s={},a=function(d,E){ei(function(){r(d,E)})};ei(function(){a=r});for(var o=t.length-22;fe(t,o)!=101010256;--o)if(!o||t.length-o>65558)return a(ae(13,0,1),null),i;var l=ye(t,o+8);if(l){var h=l,u=fe(t,o+16),c=u==4294967295||h==65535;if(c){var f=fe(t,o-12);c=fe(t,f)==101075792,c&&(h=l=fe(t,f+32),u=fe(t,f+48))}for(var m=e&&e.filter,p=function(d){var E=jo(t,u,c),I=E[0],T=E[1],M=E[2],S=E[3],b=E[4],N=E[5],A=Yo(t,N);u=b;var w=function(x,P){x?(i(),a(x,null)):(P&&(s[S]=P),--l||a(null,s))};if(!m||m({name:S,size:T,originalSize:M,compression:I}))if(!I)w(null,_t(t,A,A+T));else if(I==8){var D=t.subarray(A,A+T);if(T<32e4)try{w(null,cr(D,new ne(M)))}catch(x){w(x,null)}else n.push(ko(D,{size:M},w))}else w(ae(14,"unknown compression type "+I,1),null);else w(null,null)},v=0;v<h;++v)p(v)}else a(null,{});return i}var Oe=class{constructor(e){let r;typeof e=="object"&&e instanceof Oe?r=e.source:r=String(e),this.source=r,this._re=(0,ri.makeRe)(r)}test(e){return this._re.test(e)}},Ko=/^([_\w\d]+)\:\/\//;async function ni(t,e,r,n,i,s){let{loadings:a}=t,o;e in a?o=a[e]:(o=new ze(s),a[e]=o);let l=ze.nextAttempt(o),h=[o.promise];return Ko.test(r)?h.push(ii(t,r,s).then(u=>n(u,i)).then(u=>ze.isCurrentAttempt(o,l)?qe(t,e,u):void 0)):h.push(fetch(r).then(u=>u.arrayBuffer()).then(u=>n(u)).then(u=>ze.isCurrentAttempt(o,l)?qe(t,e,u):void 0)),await Promise.race(h)}function qe(t,e,r){let{store:n,loadings:i}=t;return n[e]=r,e in i&&(i[e].resolve(r),delete i[e]),r}function $o(t,e,r){let{defaults:n}=t;typeof e=="string"&&(e=new Oe(e));let i=`__default://[${n.length}]`;return qe(t,i,r),n.push(new oi(e,i)),r}function qo(t,e){let{store:r,loadings:n}=t;e in n&&(n[e].reject(new Error("Stop loading to delete asset.")),delete n[e]),e in r&&delete r[e]}function Wo(t,e){typeof e=="string"&&(e=new Oe(e));let{store:r,loadings:n}=t;for(let[i,s]of Object.entries(n))e.test(i)&&(s.reject(new Error(`Stop loading to clear assets matching ${e}`)),delete n[i]);for(let i of Object.keys(r))e.test(i)&&delete r[i]}function Xo(t){let{store:e,loadings:r,defaults:n}=t;for(let[i,s]of Object.entries(r))s.reject(new Error("Stop loading to clear all assets.")),delete r[i];for(let i of Object.keys(e))delete e[i];n.length=0}function Qo(t,e){let{loadings:r}=t;return e in r?r[e].promise:null}async function ii(t,e,r){let{store:n,loadings:i}=t;if(e in n)return n[e];if(e in i)return i[e].promise;{let s=new ze(r);return i[e]=s,s.promise}}function Zo(t,e){let{defaults:r}=t;for(let n of r)if(n.glob.test(e))return Et(t,n.uri);return null}function Et(t,e){return t.store[e]}function Jo(t,e){return Boolean(t.store[e])}function el(t){return Object.keys(t.store)}function si(t,e){return e in t.store}function ai(t,e){return e in t.loadings}var oi=class{constructor(e,r){this.glob=e,this.uri=r}},ze=class{static nextAttempt(e){return++e._promiseHandle}static isCurrentAttempt(e,r){return e._promiseHandle===r}constructor(e){this._promiseHandle=0,this._resolve=null,this._reject=null,this._reason=null,this._value=null,this._timeoutHandle=Number.isFinite(e)&&e>0?setTimeout(()=>{this.reject(`Asset loading exceeded timeout of ${e} ms.`)},e):null,this._promise=new Promise((r,n)=>{this._value?r(this._value):this._resolve=r,this._reason?n(this._reason):this._reject=n})}get promise(){return this._promise}resolve(e){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._resolve?this._resolve(e):this._value=e}reject(e){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._reject?this._reject(e):this._reason=e}},We=class{constructor(e=null){this.parent=e,this.store={},this.loadings={},this.defaults=[]}get(e){let r=this;if(si(r,e))return Et(r,e);let n=Zo(r,e);return n||null}async resolve(e,r,n,i,s){return this.get(e)||await this.load(e,r,n,i,s)}fallback(e,r){return $o(this,e,r)}cache(e,r){return qe(this,e,r)}async load(e,r,n,i,s){let a=this;return si(a,e)?Et(a,e):ai(a,e)?await ii(a,e,s):await ni(a,e,r,n,i,s)}async reload(e,r,n,i,s){return await ni(this,e,r,n,i,s)}unload(e){qo(this,e)}clear(e){Wo(this,e)}current(e){return Et(this,e)}exists(e){return Jo(this,e)}loading(e){let r=this;return ai(r,e)?Qo(r,e):null}keys(){return el(this)}reset(){Xo(this)}},li=5e3,pe=class{constructor(e,r,n=void 0,i=e,s=null){this.uri=e,this.loader=r,this.opts=n,this.initial=s,this.filepath=i,this.source=null,this.current=null}cache(e,r){return e.cache(this.uri,r),this.source=e,this.current=r,this}get(e){let r;return e.exists(this.uri)?r=e.current(this.uri):this.initial&&this.initial instanceof pe?r=this.initial.get(e):r=this.initial,this.source=e,this.current=r,r}async load(e,r=li){let n;if(e.exists(this.uri))n=e.current(this.uri);else if(n=await e.load(this.uri,this.filepath,this.loader,this.opts,r),!n)if(this.initial&&this.initial instanceof pe){let i=this.initial;n=await e.load(i.uri,i.filepath,i.loader,i.opts,r)}else n=this.initial;return this.source=e,this.current=n,n}async reload(e,r=li){let n=await e.reload(this.uri,this.filepath,this.loader,this.opts,r);return this.source=e,this.current=n,n}};async function hi(t,e,r=void 0){let n=t,i="raw://",a=await(await fetch(e)).arrayBuffer();await new Promise((o,l)=>{ti(new Uint8Array(a),(h,u)=>{if(h)l(h);else{for(let[c,f]of Object.entries(u)){c=c.replaceAll("\\","/");let m=c.indexOf("/");m>=0&&(c=c.substring(m+1));let p=i+c;qe(n,p,f),r&&r(f,p,c)}o()}})})}async function pr(t,e=void 0){let{imageType:r=void 0}=e||{};if(typeof t=="string"){let l=await(await fetch(t)).arrayBuffer();if(typeof r=="undefined"){let h=t.lastIndexOf(".");if(h<0)throw new Error("Cannot load from url - unknown image type.");r="image/"+t.slice(h+1)}return pr(l,{...e,imageType:r})}else if(!(t instanceof ArrayBuffer||ArrayBuffer.isView(t)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let n=t;typeof r=="undefined"&&(r="image/png");let i=new Blob([n],{type:r}),s=URL.createObjectURL(i),a=new Image;return new Promise((o,l)=>{a.addEventListener("load",()=>{o(a)}),a.addEventListener("error",h=>{l(h)}),a.src=s})}var dr=class{constructor(e){this._pipeline={},this.assets=e}async pipe(e,r){let n=new Oe(e),i=n.source,s;i in this._pipeline?s=this._pipeline[i]:(s=new ui(n),this._pipeline[i]=s),s.addHandler(r);for(let a of this.assets.keys())s.matches(a)&&await r(this.assets.current(a),a)}},ui=class{constructor(e){this.filter=e,this.handlers=[]}matches(e){return this.filter.test(e)}async process(e,r){return Promise.all(this.handlers.map(n=>n(e,r)))}addHandler(e){this.handlers.push(e)}};var mr={on(t,e,r=e){let n;if(this.__events.has(t)?n=this.__events.get(t):(n=new Map,this.__events.set(t,n)),!n.has(r))n.set(r,e);else throw new Error(`Found callback for event '${t}' with the same handle '${r}'.`);return this},off(t,e){if(this.__events.has(t)){let r=this.__events.get(t);if(r.has(e))r.delete(e);else throw new Error(`Unable to find callback for event '${t}' with handle '${e}'.`)}else throw new Error(`Unable to find event '${t}'.`);return this},once(t,e,r=e){let n=(...i)=>{this.off(t,r),e.apply(this.__context||this,i)};return this.on(t,n,r)},emit(t,...e){if(this.__events.has(t)){let r=[],n=Array.from(this.__events.get(t).values());for(let i of n){let s=i.apply(this.__context||this,e);s&&r.push(s)}return r}else return this.__events.set(t,new Map),[]}};function tl(t=void 0){let e=Object.create(mr);return e.__events=new Map,e.__context=t,e}function rl(t,e=void 0){let r=Object.assign(t,mr);return r.__events=new Map,r.__context=e,r}function nl(t,e=void 0){let r=t.prototype;return Object.assign(r,mr),r.__events=new Map,r.__context=e,r}var ci={create:tl,assign:rl,mixin:nl},il=5,sl=4,al=3,ol=2,ll=1,hl=0,np={[il]:Xe("#7F8C8D"),[sl]:Xe("#2ECC71"),[al]:Xe("#4794C8"),[ol]:Xe("#F39C12"),[ll]:Xe("#C0392B"),[hl]:[""]};function Xe(t){return[`background: ${t}`,"border-radius: 0.5em","color: white","font-weight: bold","padding: 2px 0.5em"]}var ip=Symbol("level"),sp=Symbol("domain");var He=0,ul=class{constructor(e){this._heap=[],this._comparator=e}get size(){return this._heap.length}clear(){this._heap.length=0}push(...e){for(let r of e)this._heap.push(r),this._shiftUp()}pop(){let e=this.peek(),r=cl(this);return r>He&&this._swap(He,r),this._heap.pop(),this._shiftDown(),e}replace(e){let r=this.peek();return this._heap[He]=e,this._shiftDown(),r}peek(){return this._heap[He]}at(e){return this._heap[e]}indexOf(e,r=void 0){return this._heap.indexOf(e,r)}splice(e,r=void 0){return this._heap.splice(e,r)}_compare(e,r){return this._comparator(this._heap[e],this._heap[r])}_swap(e,r){let n=this._heap[e];this._heap[e]=this._heap[r],this._heap[r]=n}_shiftUp(){let e=this._heap.length-1,r;for(;e>He&&this._compare(e,r=fl(e));)this._swap(e,r),e=r}_shiftDown(){let e=this._heap.length,r=He,n,i=fi(r),s=i<e,a=pi(r),o=a<e;for(;s&&this._compare(i,r)||o&&this._compare(a,r);)n=o&&this._compare(a,i)?a:i,this._swap(r,n),r=n,i=fi(r),s=i<e,a=pi(r),o=a<e}values(){return this._heap}[Symbol.iterator](){return this._heap[Symbol.iterator]()}};function cl(t){return t._heap.length-1}function fl(t){return(t+1>>>1)-1}function fi(t){return(t<<1)+1}function pi(t){return t+1<<1}function vr(t,e,r){return Math.min(r,Math.max(e,t))}var ap=Math.PI/180,op=180/Math.PI;var xr=class{constructor(e,r){this.display=e,this.inputs=r,this.assets=new We,this.deltaTime=0,this.prevTime=0,this.now=0,this.events=ci.create()}on(e,r){return this.events.on(e,r),this}off(e,r){return this.events.off(e,r),this}once(e,r){return this.events.once(e,r),this}emit(e,...r){this.events.emit(e,...r)}};async function gr(t){if(typeof t=="string"){let n=await(await fetch(t)).arrayBuffer();return gr(n)}else if(!(t instanceof ArrayBuffer||ArrayBuffer.isView(t)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let e=t;return pl(new TextDecoder().decode(e))}function pl(t){let e=[],r=[],n=[],i=[],s=[],a=[],o=/^#.*/g,l=/v\s+(\S+)\s+(\S+)\s+(\S+)/g,h=/vn\s+(\S+)\s+(\S+)\s+(\S+)/g,u=/vt\s+(\S+)\s+(\S+)/g,c=/f\s+(([^/\s]*)\/([^/\s]*)\/?([^/\s]*))\s+(([^/\s]*)\/([^/\s]*)\/?([^/\s]*))\s+(([^/\s]*)\/([^/\s]*)\/?([^/\s]*))(\s+(([^/\s]*)\/([^/\s]*)\/?([^/\s]*)))?/g,f=/f\s+([^/\s]+)\s+([^/\s]+)\s+([^/\s]+)/g,m=!1,p=null,v,d,E,I;for(t=t.replace(o,"");(p=l.exec(t))!=null;)v=Number.parseFloat(p[1]),d=Number.parseFloat(p[2]),E=Number.parseFloat(p[3]),e.push(v),e.push(d),e.push(E);for(;(p=h.exec(t))!=null;)v=Number.parseFloat(p[1]),d=Number.parseFloat(p[2]),E=Number.parseFloat(p[3]),n.push(v),n.push(d),n.push(E);for(;(p=u.exec(t))!=null;)v=Number.parseFloat(p[1]),d=Number.parseFloat(p[2]),r.push(v),r.push(d);for(;(p=c.exec(t))!=null;)v=Number.parseInt(p[2]),Number.isNaN(v)&&(v=1),d=Number.parseInt(p[6]),Number.isNaN(d)&&(d=1),E=Number.parseInt(p[10]),Number.isNaN(E)&&(E=1),i.push(v),i.push(d),i.push(E),v=Number.parseInt(p[4]),Number.isNaN(v)?(v=Number.parseInt(p[3]),d=Number.parseInt(p[7]),E=Number.parseInt(p[11]),a.push(v),a.push(d),a.push(E),s.push(1),s.push(1),s.push(1)):(d=Number.parseInt(p[8]),Number.isNaN(d)&&(d=1),E=Number.parseInt(p[12]),Number.isNaN(E)&&(E=1),a.push(v),a.push(d),a.push(E),v=Number.parseInt(p[3]),Number.isNaN(v)&&(v=1),d=Number.parseInt(p[7]),Number.isNaN(d)&&(d=1),E=Number.parseInt(p[11]),Number.isNaN(E)&&(E=1),s.push(v),s.push(d),s.push(E)),typeof p[13]!="undefined"&&(I=Number.parseInt(p[15]),Number.isNaN(I)&&(I=1),i.push(I),I=Number.parseInt(p[17]),Number.isNaN(I)?(I=Number.parseInt(p[16]),a.push(I),s.push(1)):(a.push(I),I=Number.parseInt(p[16]),s.push(I)),m=!0);for(;(p=f.exec(t))!=null;)v=Number.parseInt(p[2]),d=Number.parseInt(p[6]),E=Number.parseInt(p[10]),i.push(v),i.push(d),i.push(E),s.push(1),s.push(1),s.push(1),a.push(1),a.push(1),a.push(1),typeof p[13]!="undefined"&&(I=Number.parseInt(p[14]),i.push(I),s.push(1),a.push(1),m=!0);let T,M;M=i.length;let S=new Float32Array(M*3);for(let w=0;w<M;++w)T=i[w]-1,S[w*3+0]=e[T*3+0],S[w*3+1]=e[T*3+1],S[w*3+2]=e[T*3+2];M=s.length;let b=new Float32Array(M*2);for(let w=0;w<M;++w)T=s[w]-1,b[w*2+0]=r[T*2+0],b[w*2+1]=r[T*2+1];M=a.length;let N=new Float32Array(M*3);for(let w=0;w<M;++w)T=a[w]-1,N[w*3+0]=n[T*3+0],N[w*3+1]=n[T*3+1],N[w*3+2]=n[T*3+2];M=i.length;let A=new Uint16Array(M);for(let w=0;w<M;++w)A[w]=w;return m&&console.warn("WebGL does not support quad faces, only triangles."),{positions:S,texcoords:b,normals:N,indices:A}}async function _r(t){if(typeof t=="string"){let s=await(await fetch(t)).arrayBuffer();return _r(s)}else if(!(t instanceof ArrayBuffer||ArrayBuffer.isView(t)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let e=t,r=new TextDecoder().decode(e),n={};for(let i of r.split(`
`)){if(i=i.trim(),i<=0||i.startsWith("#")||i.startsWith("//"))continue;let s=[],a=0,o=i.indexOf(" ");for(;o>=0;)s.push(i.substring(a,o)),a=o+1,o=i.indexOf(" ",a);s.push(i.substring(a));let l=s[0],h=Number.parseInt(s[1]),u=Number.parseInt(s[2]),c=Number.parseInt(s[3]),f=Number.parseInt(s[4]),m=s.length>=6?Number.parseInt(s[5]):1,p=s.length>=7?Number.parseInt(s[6]):m,v=s.length>=8?Number.parseInt(s[7]):m>p?Math.ceil(m/p):1;n[l]={u:h,v:u,w:c,h:f,frames:m,cols:p,rows:v,name:l}}return n}async function Qe(t,e){if(typeof t=="string"){let a=await(await fetch(t)).arrayBuffer();return Qe(a)}else if(!(t instanceof ArrayBuffer||ArrayBuffer.isView(t)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let r=t,n=new ArrayBuffer(r.byteLength);return new Uint8Array(n).set(r),await e.decodeAudioData(n)}async function yr(t){if(typeof t=="string"){let n=await(await fetch(t)).arrayBuffer();return yr(n)}else if(!(t instanceof ArrayBuffer||ArrayBuffer.isView(t)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let e=t;return vl(new TextDecoder().decode(e))}var dl=/(.+?)\s+(.*)/,ml=/(.+)=(.+)/;function vl(t){let e=t.split(`
`),r={},n={},i={},s=[],a=[];for(let l of e){let h=dl.exec(l);if(!h)continue;let[u,c,f]=h;switch(c){case"info":Ze(r,f);break;case"common":Ze(n,f);break;case"page":Ze(i,f);break;case"chars":break;case"char":let m={};Ze(m,f),"id"in m&&s.push(m);break;case"kerning":let p={};Ze(p,f),"first"in p&&a.push(p);break;default:}}return{info:r,common:n,page:i,chars:s,kernings:a}}function Ze(t,e){let r=e.split(/\s+/);for(let n of r){let i=ml.exec(n);if(!i)continue;let[s,a,o]=i,l=JSON.parse(`[${o}]`);l.length===1?t[a]=l[0]:t[a]=l}}async function At(t){if(typeof t=="string"){let n=await(await fetch(t)).arrayBuffer();return At(n)}else if(!(t instanceof ArrayBuffer||ArrayBuffer.isView(t)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let e=t;return new TextDecoder().decode(e)}var Er=Symbol("audioContext"),Be=class{static getAudioContext(){if(Er in this)return this[Er];{let e=new AudioContext;return xl(e),this[Er]=e,e}}constructor(e,r){this.audioContext=e,this.audioBuffer=r,this._playing=!1,this._started=!1,this._source=null,this.onAudioSourceEnded=this.onAudioSourceEnded.bind(this)}destroy(){this._source&&this._source.disconnect(),this._source=null,this._started=!1,this._playing=!1}onAudioSourceEnded(){this._playing=!1}play(e={}){let r=this.audioBuffer;if(!r)return;this._source&&this.destroy();let{pitch:n=void 0,gain:i=void 0,pan:s=void 0,loop:a=!1}=e,o=this.audioContext,l=o.createBufferSource();l.addEventListener("ended",this.onAudioSourceEnded),l.buffer=r,l.loop=a;let h=l;if(n&&(l.detune.value=n*100),i){let u=o.createGain();u.gain.value=i,h=h.connect(u)}if(s){let u=o.createStereoPanner();u.pan.value=s,h=h.connect(u)}h.connect(o.destination),l.start(),this._source=l,this._started=!0,this._playing=!0}pause(){this._source.stop(),this._playing=!1}isStarted(){return this._started}isPlaying(){return this._playing}isPaused(){return this._started&&!this._playing}};function xl(t){let e=()=>{t.state==="suspended"&&t.resume()};document.addEventListener("click",e)}var _p=ge.fromString("cursorX","Mouse.PosX"),yp=ge.fromString("cursorY","Mouse.PosY"),Ep=W.fromString("activate","Mouse.Button0"),Ap=W.fromString("mark","Mouse.Button2"),wp=W.fromString("restart","Keyboard.KeyR");var Tp=Symbol("IslandRendererInfo");var Ar=class{next(){return 0}},di=class extends Ar{next(){return Math.random()}},mi=class extends Ar{constructor(e){super();this.seed=e,this.a=e}next(){var e=this.a+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}},F=class{static get RAND(){let e=new this;return this.next=this.next.bind(this),this.choose=this.choose.bind(this),this.range=this.range.bind(this),this.rangeInt=this.rangeInt.bind(this),this.sign=this.sign.bind(this),Object.defineProperty(this,"RAND",{value:e}),e}constructor(e=void 0){typeof e=="number"?this.generator=new mi(e):e?this.generator=e:this.generator=new di,this.next=this.next.bind(this),this.choose=this.choose.bind(this),this.range=this.range.bind(this),this.rangeInt=this.rangeInt.bind(this),this.sign=this.sign.bind(this)}static next(){return this.RAND.next()}next(){return this.generator.next()}static choose(e){return this.RAND.choose(e)}choose(e){return e[Math.floor(this.generator.next()*e.length)]}static range(e,r){return this.RAND.range(e,r)}range(e,r){return(r-e)*this.generator.next()+e}static rangeInt(e,r){return this.RAND.rangeInt(e,r)}rangeInt(e,r){return Math.trunc(this.range(e,r))}static sign(){return this.RAND.sign()}sign(){return this.generator.next()<.5?-1:1}};document.title="Archaea";document.title="Architect";var _l=W.fromString("moveLeft","Keyboard.KeyA"),yl=W.fromString("moveRight","Keyboard.KeyD"),El=W.fromString("moveUp","Keyboard.KeyW"),Al=W.fromString("moveDown","Keyboard.KeyS"),ld=ge.fromString("cursorX","Mouse.PosX"),hd=ge.fromString("cursorY","Mouse.PosY"),wl=W.fromString("shoot","Keyboard.Space");document.title="Bioform";var z=1e-6,j=typeof Float32Array!="undefined"?Float32Array:Array,oe=Math.random;var bd=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function vi(){var t=new j(9);return j!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}var Y={};De(Y,{add:()=>uh,adjoint:()=>Bl,clone:()=>Rl,copy:()=>Il,create:()=>Sl,determinant:()=>Pl,equals:()=>dh,exactEquals:()=>ph,frob:()=>hh,fromQuat:()=>Jl,fromQuat2:()=>ql,fromRotation:()=>jl,fromRotationTranslation:()=>_i,fromRotationTranslationScale:()=>Ql,fromRotationTranslationScaleOrigin:()=>Zl,fromScaling:()=>Yl,fromTranslation:()=>Vl,fromValues:()=>Ll,fromXRotation:()=>Gl,fromYRotation:()=>Kl,fromZRotation:()=>$l,frustum:()=>eh,getRotation:()=>Xl,getScaling:()=>yi,getTranslation:()=>Wl,identity:()=>xi,invert:()=>Ol,lookAt:()=>ah,mul:()=>mh,multiply:()=>gi,multiplyScalar:()=>ch,multiplyScalarAndAdd:()=>fh,ortho:()=>ih,orthoNO:()=>Ai,orthoZO:()=>sh,perspective:()=>th,perspectiveFromFieldOfView:()=>nh,perspectiveNO:()=>Ei,perspectiveZO:()=>rh,rotate:()=>Ul,rotateX:()=>kl,rotateY:()=>zl,rotateZ:()=>Hl,scale:()=>Fl,set:()=>Cl,str:()=>lh,sub:()=>vh,subtract:()=>wi,targetTo:()=>oh,translate:()=>Dl,transpose:()=>Nl});function Sl(){var t=new j(16);return j!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Rl(t){var e=new j(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Il(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Ll(t,e,r,n,i,s,a,o,l,h,u,c,f,m,p,v){var d=new j(16);return d[0]=t,d[1]=e,d[2]=r,d[3]=n,d[4]=i,d[5]=s,d[6]=a,d[7]=o,d[8]=l,d[9]=h,d[10]=u,d[11]=c,d[12]=f,d[13]=m,d[14]=p,d[15]=v,d}function Cl(t,e,r,n,i,s,a,o,l,h,u,c,f,m,p,v,d){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=s,t[5]=a,t[6]=o,t[7]=l,t[8]=h,t[9]=u,t[10]=c,t[11]=f,t[12]=m,t[13]=p,t[14]=v,t[15]=d,t}function xi(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Nl(t,e){if(t===e){var r=e[1],n=e[2],i=e[3],s=e[6],a=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=s,t[11]=e[14],t[12]=i,t[13]=a,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Ol(t,e){var r=e[0],n=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],h=e[7],u=e[8],c=e[9],f=e[10],m=e[11],p=e[12],v=e[13],d=e[14],E=e[15],I=r*o-n*a,T=r*l-i*a,M=r*h-s*a,S=n*l-i*o,b=n*h-s*o,N=i*h-s*l,A=u*v-c*p,w=u*d-f*p,D=u*E-m*p,x=c*d-f*v,P=c*E-m*v,y=f*E-m*d,O=I*y-T*P+M*x+S*D-b*w+N*A;return O?(O=1/O,t[0]=(o*y-l*P+h*x)*O,t[1]=(i*P-n*y-s*x)*O,t[2]=(v*N-d*b+E*S)*O,t[3]=(f*b-c*N-m*S)*O,t[4]=(l*D-a*y-h*w)*O,t[5]=(r*y-i*D+s*w)*O,t[6]=(d*M-p*N-E*T)*O,t[7]=(u*N-f*M+m*T)*O,t[8]=(a*P-o*D+h*A)*O,t[9]=(n*D-r*P-s*A)*O,t[10]=(p*b-v*M+E*I)*O,t[11]=(c*M-u*b-m*I)*O,t[12]=(o*w-a*x-l*A)*O,t[13]=(r*x-n*w+i*A)*O,t[14]=(v*T-p*S-d*I)*O,t[15]=(u*S-c*T+f*I)*O,t):null}function Bl(t,e){var r=e[0],n=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],h=e[7],u=e[8],c=e[9],f=e[10],m=e[11],p=e[12],v=e[13],d=e[14],E=e[15];return t[0]=o*(f*E-m*d)-c*(l*E-h*d)+v*(l*m-h*f),t[1]=-(n*(f*E-m*d)-c*(i*E-s*d)+v*(i*m-s*f)),t[2]=n*(l*E-h*d)-o*(i*E-s*d)+v*(i*h-s*l),t[3]=-(n*(l*m-h*f)-o*(i*m-s*f)+c*(i*h-s*l)),t[4]=-(a*(f*E-m*d)-u*(l*E-h*d)+p*(l*m-h*f)),t[5]=r*(f*E-m*d)-u*(i*E-s*d)+p*(i*m-s*f),t[6]=-(r*(l*E-h*d)-a*(i*E-s*d)+p*(i*h-s*l)),t[7]=r*(l*m-h*f)-a*(i*m-s*f)+u*(i*h-s*l),t[8]=a*(c*E-m*v)-u*(o*E-h*v)+p*(o*m-h*c),t[9]=-(r*(c*E-m*v)-u*(n*E-s*v)+p*(n*m-s*c)),t[10]=r*(o*E-h*v)-a*(n*E-s*v)+p*(n*h-s*o),t[11]=-(r*(o*m-h*c)-a*(n*m-s*c)+u*(n*h-s*o)),t[12]=-(a*(c*d-f*v)-u*(o*d-l*v)+p*(o*f-l*c)),t[13]=r*(c*d-f*v)-u*(n*d-i*v)+p*(n*f-i*c),t[14]=-(r*(o*d-l*v)-a*(n*d-i*v)+p*(n*l-i*o)),t[15]=r*(o*f-l*c)-a*(n*f-i*c)+u*(n*l-i*o),t}function Pl(t){var e=t[0],r=t[1],n=t[2],i=t[3],s=t[4],a=t[5],o=t[6],l=t[7],h=t[8],u=t[9],c=t[10],f=t[11],m=t[12],p=t[13],v=t[14],d=t[15],E=e*a-r*s,I=e*o-n*s,T=e*l-i*s,M=r*o-n*a,S=r*l-i*a,b=n*l-i*o,N=h*p-u*m,A=h*v-c*m,w=h*d-f*m,D=u*v-c*p,x=u*d-f*p,P=c*d-f*v;return E*P-I*x+T*D+M*w-S*A+b*N}function gi(t,e,r){var n=e[0],i=e[1],s=e[2],a=e[3],o=e[4],l=e[5],h=e[6],u=e[7],c=e[8],f=e[9],m=e[10],p=e[11],v=e[12],d=e[13],E=e[14],I=e[15],T=r[0],M=r[1],S=r[2],b=r[3];return t[0]=T*n+M*o+S*c+b*v,t[1]=T*i+M*l+S*f+b*d,t[2]=T*s+M*h+S*m+b*E,t[3]=T*a+M*u+S*p+b*I,T=r[4],M=r[5],S=r[6],b=r[7],t[4]=T*n+M*o+S*c+b*v,t[5]=T*i+M*l+S*f+b*d,t[6]=T*s+M*h+S*m+b*E,t[7]=T*a+M*u+S*p+b*I,T=r[8],M=r[9],S=r[10],b=r[11],t[8]=T*n+M*o+S*c+b*v,t[9]=T*i+M*l+S*f+b*d,t[10]=T*s+M*h+S*m+b*E,t[11]=T*a+M*u+S*p+b*I,T=r[12],M=r[13],S=r[14],b=r[15],t[12]=T*n+M*o+S*c+b*v,t[13]=T*i+M*l+S*f+b*d,t[14]=T*s+M*h+S*m+b*E,t[15]=T*a+M*u+S*p+b*I,t}function Dl(t,e,r){var n=r[0],i=r[1],s=r[2],a,o,l,h,u,c,f,m,p,v,d,E;return e===t?(t[12]=e[0]*n+e[4]*i+e[8]*s+e[12],t[13]=e[1]*n+e[5]*i+e[9]*s+e[13],t[14]=e[2]*n+e[6]*i+e[10]*s+e[14],t[15]=e[3]*n+e[7]*i+e[11]*s+e[15]):(a=e[0],o=e[1],l=e[2],h=e[3],u=e[4],c=e[5],f=e[6],m=e[7],p=e[8],v=e[9],d=e[10],E=e[11],t[0]=a,t[1]=o,t[2]=l,t[3]=h,t[4]=u,t[5]=c,t[6]=f,t[7]=m,t[8]=p,t[9]=v,t[10]=d,t[11]=E,t[12]=a*n+u*i+p*s+e[12],t[13]=o*n+c*i+v*s+e[13],t[14]=l*n+f*i+d*s+e[14],t[15]=h*n+m*i+E*s+e[15]),t}function Fl(t,e,r){var n=r[0],i=r[1],s=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Ul(t,e,r,n){var i=n[0],s=n[1],a=n[2],o=Math.hypot(i,s,a),l,h,u,c,f,m,p,v,d,E,I,T,M,S,b,N,A,w,D,x,P,y,O,g;return o<z?null:(o=1/o,i*=o,s*=o,a*=o,l=Math.sin(r),h=Math.cos(r),u=1-h,c=e[0],f=e[1],m=e[2],p=e[3],v=e[4],d=e[5],E=e[6],I=e[7],T=e[8],M=e[9],S=e[10],b=e[11],N=i*i*u+h,A=s*i*u+a*l,w=a*i*u-s*l,D=i*s*u-a*l,x=s*s*u+h,P=a*s*u+i*l,y=i*a*u+s*l,O=s*a*u-i*l,g=a*a*u+h,t[0]=c*N+v*A+T*w,t[1]=f*N+d*A+M*w,t[2]=m*N+E*A+S*w,t[3]=p*N+I*A+b*w,t[4]=c*D+v*x+T*P,t[5]=f*D+d*x+M*P,t[6]=m*D+E*x+S*P,t[7]=p*D+I*x+b*P,t[8]=c*y+v*O+T*g,t[9]=f*y+d*O+M*g,t[10]=m*y+E*O+S*g,t[11]=p*y+I*O+b*g,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function kl(t,e,r){var n=Math.sin(r),i=Math.cos(r),s=e[4],a=e[5],o=e[6],l=e[7],h=e[8],u=e[9],c=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+h*n,t[5]=a*i+u*n,t[6]=o*i+c*n,t[7]=l*i+f*n,t[8]=h*i-s*n,t[9]=u*i-a*n,t[10]=c*i-o*n,t[11]=f*i-l*n,t}function zl(t,e,r){var n=Math.sin(r),i=Math.cos(r),s=e[0],a=e[1],o=e[2],l=e[3],h=e[8],u=e[9],c=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-h*n,t[1]=a*i-u*n,t[2]=o*i-c*n,t[3]=l*i-f*n,t[8]=s*n+h*i,t[9]=a*n+u*i,t[10]=o*n+c*i,t[11]=l*n+f*i,t}function Hl(t,e,r){var n=Math.sin(r),i=Math.cos(r),s=e[0],a=e[1],o=e[2],l=e[3],h=e[4],u=e[5],c=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+h*n,t[1]=a*i+u*n,t[2]=o*i+c*n,t[3]=l*i+f*n,t[4]=h*i-s*n,t[5]=u*i-a*n,t[6]=c*i-o*n,t[7]=f*i-l*n,t}function Vl(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function Yl(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function jl(t,e,r){var n=r[0],i=r[1],s=r[2],a=Math.hypot(n,i,s),o,l,h;return a<z?null:(a=1/a,n*=a,i*=a,s*=a,o=Math.sin(e),l=Math.cos(e),h=1-l,t[0]=n*n*h+l,t[1]=i*n*h+s*o,t[2]=s*n*h-i*o,t[3]=0,t[4]=n*i*h-s*o,t[5]=i*i*h+l,t[6]=s*i*h+n*o,t[7]=0,t[8]=n*s*h+i*o,t[9]=i*s*h-n*o,t[10]=s*s*h+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function Gl(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Kl(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function $l(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function _i(t,e,r){var n=e[0],i=e[1],s=e[2],a=e[3],o=n+n,l=i+i,h=s+s,u=n*o,c=n*l,f=n*h,m=i*l,p=i*h,v=s*h,d=a*o,E=a*l,I=a*h;return t[0]=1-(m+v),t[1]=c+I,t[2]=f-E,t[3]=0,t[4]=c-I,t[5]=1-(u+v),t[6]=p+d,t[7]=0,t[8]=f+E,t[9]=p-d,t[10]=1-(u+m),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function ql(t,e){var r=new j(3),n=-e[0],i=-e[1],s=-e[2],a=e[3],o=e[4],l=e[5],h=e[6],u=e[7],c=n*n+i*i+s*s+a*a;return c>0?(r[0]=(o*a+u*n+l*s-h*i)*2/c,r[1]=(l*a+u*i+h*n-o*s)*2/c,r[2]=(h*a+u*s+o*i-l*n)*2/c):(r[0]=(o*a+u*n+l*s-h*i)*2,r[1]=(l*a+u*i+h*n-o*s)*2,r[2]=(h*a+u*s+o*i-l*n)*2),_i(t,e,r),t}function Wl(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function yi(t,e){var r=e[0],n=e[1],i=e[2],s=e[4],a=e[5],o=e[6],l=e[8],h=e[9],u=e[10];return t[0]=Math.hypot(r,n,i),t[1]=Math.hypot(s,a,o),t[2]=Math.hypot(l,h,u),t}function Xl(t,e){var r=new j(3);yi(r,e);var n=1/r[0],i=1/r[1],s=1/r[2],a=e[0]*n,o=e[1]*i,l=e[2]*s,h=e[4]*n,u=e[5]*i,c=e[6]*s,f=e[8]*n,m=e[9]*i,p=e[10]*s,v=a+u+p,d=0;return v>0?(d=Math.sqrt(v+1)*2,t[3]=.25*d,t[0]=(c-m)/d,t[1]=(f-l)/d,t[2]=(o-h)/d):a>u&&a>p?(d=Math.sqrt(1+a-u-p)*2,t[3]=(c-m)/d,t[0]=.25*d,t[1]=(o+h)/d,t[2]=(f+l)/d):u>p?(d=Math.sqrt(1+u-a-p)*2,t[3]=(f-l)/d,t[0]=(o+h)/d,t[1]=.25*d,t[2]=(c+m)/d):(d=Math.sqrt(1+p-a-u)*2,t[3]=(o-h)/d,t[0]=(f+l)/d,t[1]=(c+m)/d,t[2]=.25*d),t}function Ql(t,e,r,n){var i=e[0],s=e[1],a=e[2],o=e[3],l=i+i,h=s+s,u=a+a,c=i*l,f=i*h,m=i*u,p=s*h,v=s*u,d=a*u,E=o*l,I=o*h,T=o*u,M=n[0],S=n[1],b=n[2];return t[0]=(1-(p+d))*M,t[1]=(f+T)*M,t[2]=(m-I)*M,t[3]=0,t[4]=(f-T)*S,t[5]=(1-(c+d))*S,t[6]=(v+E)*S,t[7]=0,t[8]=(m+I)*b,t[9]=(v-E)*b,t[10]=(1-(c+p))*b,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function Zl(t,e,r,n,i){var s=e[0],a=e[1],o=e[2],l=e[3],h=s+s,u=a+a,c=o+o,f=s*h,m=s*u,p=s*c,v=a*u,d=a*c,E=o*c,I=l*h,T=l*u,M=l*c,S=n[0],b=n[1],N=n[2],A=i[0],w=i[1],D=i[2],x=(1-(v+E))*S,P=(m+M)*S,y=(p-T)*S,O=(m-M)*b,g=(1-(f+E))*b,_=(d+I)*b,$=(p+T)*N,H=(d-I)*N,Z=(1-(f+v))*N;return t[0]=x,t[1]=P,t[2]=y,t[3]=0,t[4]=O,t[5]=g,t[6]=_,t[7]=0,t[8]=$,t[9]=H,t[10]=Z,t[11]=0,t[12]=r[0]+A-(x*A+O*w+$*D),t[13]=r[1]+w-(P*A+g*w+H*D),t[14]=r[2]+D-(y*A+_*w+Z*D),t[15]=1,t}function Jl(t,e){var r=e[0],n=e[1],i=e[2],s=e[3],a=r+r,o=n+n,l=i+i,h=r*a,u=n*a,c=n*o,f=i*a,m=i*o,p=i*l,v=s*a,d=s*o,E=s*l;return t[0]=1-c-p,t[1]=u+E,t[2]=f-d,t[3]=0,t[4]=u-E,t[5]=1-h-p,t[6]=m+v,t[7]=0,t[8]=f+d,t[9]=m-v,t[10]=1-h-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function eh(t,e,r,n,i,s,a){var o=1/(r-e),l=1/(i-n),h=1/(s-a);return t[0]=s*2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*l,t[6]=0,t[7]=0,t[8]=(r+e)*o,t[9]=(i+n)*l,t[10]=(a+s)*h,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*s*2*h,t[15]=0,t}function Ei(t,e,r,n,i){var s=1/Math.tan(e/2),a;return t[0]=s/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==Infinity?(a=1/(n-i),t[10]=(i+n)*a,t[14]=2*i*n*a):(t[10]=-1,t[14]=-2*n),t}var th=Ei;function rh(t,e,r,n,i){var s=1/Math.tan(e/2),a;return t[0]=s/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==Infinity?(a=1/(n-i),t[10]=i*a,t[14]=i*n*a):(t[10]=-1,t[14]=-n),t}function nh(t,e,r,n){var i=Math.tan(e.upDegrees*Math.PI/180),s=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),o=Math.tan(e.rightDegrees*Math.PI/180),l=2/(a+o),h=2/(i+s);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=h,t[6]=0,t[7]=0,t[8]=-((a-o)*l*.5),t[9]=(i-s)*h*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t}function Ai(t,e,r,n,i,s,a){var o=1/(e-r),l=1/(n-i),h=1/(s-a);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(e+r)*o,t[13]=(i+n)*l,t[14]=(a+s)*h,t[15]=1,t}var ih=Ai;function sh(t,e,r,n,i,s,a){var o=1/(e-r),l=1/(n-i),h=1/(s-a);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=h,t[11]=0,t[12]=(e+r)*o,t[13]=(i+n)*l,t[14]=s*h,t[15]=1,t}function ah(t,e,r,n){var i,s,a,o,l,h,u,c,f,m,p=e[0],v=e[1],d=e[2],E=n[0],I=n[1],T=n[2],M=r[0],S=r[1],b=r[2];return Math.abs(p-M)<z&&Math.abs(v-S)<z&&Math.abs(d-b)<z?xi(t):(u=p-M,c=v-S,f=d-b,m=1/Math.hypot(u,c,f),u*=m,c*=m,f*=m,i=I*f-T*c,s=T*u-E*f,a=E*c-I*u,m=Math.hypot(i,s,a),m?(m=1/m,i*=m,s*=m,a*=m):(i=0,s=0,a=0),o=c*a-f*s,l=f*i-u*a,h=u*s-c*i,m=Math.hypot(o,l,h),m?(m=1/m,o*=m,l*=m,h*=m):(o=0,l=0,h=0),t[0]=i,t[1]=o,t[2]=u,t[3]=0,t[4]=s,t[5]=l,t[6]=c,t[7]=0,t[8]=a,t[9]=h,t[10]=f,t[11]=0,t[12]=-(i*p+s*v+a*d),t[13]=-(o*p+l*v+h*d),t[14]=-(u*p+c*v+f*d),t[15]=1,t)}function oh(t,e,r,n){var i=e[0],s=e[1],a=e[2],o=n[0],l=n[1],h=n[2],u=i-r[0],c=s-r[1],f=a-r[2],m=u*u+c*c+f*f;m>0&&(m=1/Math.sqrt(m),u*=m,c*=m,f*=m);var p=l*f-h*c,v=h*u-o*f,d=o*c-l*u;return m=p*p+v*v+d*d,m>0&&(m=1/Math.sqrt(m),p*=m,v*=m,d*=m),t[0]=p,t[1]=v,t[2]=d,t[3]=0,t[4]=c*d-f*v,t[5]=f*p-u*d,t[6]=u*v-c*p,t[7]=0,t[8]=u,t[9]=c,t[10]=f,t[11]=0,t[12]=i,t[13]=s,t[14]=a,t[15]=1,t}function lh(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function hh(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function uh(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}function wi(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function ch(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}function fh(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t}function ph(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function dh(t,e){var r=t[0],n=t[1],i=t[2],s=t[3],a=t[4],o=t[5],l=t[6],h=t[7],u=t[8],c=t[9],f=t[10],m=t[11],p=t[12],v=t[13],d=t[14],E=t[15],I=e[0],T=e[1],M=e[2],S=e[3],b=e[4],N=e[5],A=e[6],w=e[7],D=e[8],x=e[9],P=e[10],y=e[11],O=e[12],g=e[13],_=e[14],$=e[15];return Math.abs(r-I)<=z*Math.max(1,Math.abs(r),Math.abs(I))&&Math.abs(n-T)<=z*Math.max(1,Math.abs(n),Math.abs(T))&&Math.abs(i-M)<=z*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(s-S)<=z*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(a-b)<=z*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(o-N)<=z*Math.max(1,Math.abs(o),Math.abs(N))&&Math.abs(l-A)<=z*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(h-w)<=z*Math.max(1,Math.abs(h),Math.abs(w))&&Math.abs(u-D)<=z*Math.max(1,Math.abs(u),Math.abs(D))&&Math.abs(c-x)<=z*Math.max(1,Math.abs(c),Math.abs(x))&&Math.abs(f-P)<=z*Math.max(1,Math.abs(f),Math.abs(P))&&Math.abs(m-y)<=z*Math.max(1,Math.abs(m),Math.abs(y))&&Math.abs(p-O)<=z*Math.max(1,Math.abs(p),Math.abs(O))&&Math.abs(v-g)<=z*Math.max(1,Math.abs(v),Math.abs(g))&&Math.abs(d-_)<=z*Math.max(1,Math.abs(d),Math.abs(_))&&Math.abs(E-$)<=z*Math.max(1,Math.abs(E),Math.abs($))}var mh=gi,vh=wi;var ee={};De(ee,{add:()=>Fu,calculateW:()=>Mu,clone:()=>Ou,conjugate:()=>Lu,copy:()=>Pu,create:()=>Dr,dot:()=>Yi,equals:()=>Yu,exactEquals:()=>Vu,exp:()=>ki,fromEuler:()=>Cu,fromMat3:()=>Hi,fromValues:()=>Bu,getAngle:()=>Au,getAxisAngle:()=>Eu,identity:()=>yu,invert:()=>Iu,len:()=>zu,length:()=>ji,lerp:()=>ku,ln:()=>zi,mul:()=>Uu,multiply:()=>Ui,normalize:()=>Fr,pow:()=>Su,random:()=>Ru,rotateX:()=>wu,rotateY:()=>Tu,rotateZ:()=>bu,rotationTo:()=>ju,scale:()=>Vi,set:()=>Du,setAxes:()=>Ku,setAxisAngle:()=>Fi,slerp:()=>Rt,sqlerp:()=>Gu,sqrLen:()=>Hu,squaredLength:()=>Gi,str:()=>Nu});var V={};De(V,{add:()=>yh,angle:()=>zh,bezier:()=>Nh,ceil:()=>Eh,clone:()=>xh,copy:()=>gh,create:()=>wt,cross:()=>Je,dist:()=>qh,distance:()=>Ri,div:()=>$h,divide:()=>Si,dot:()=>bt,equals:()=>jh,exactEquals:()=>Yh,floor:()=>Ah,forEach:()=>Qh,fromValues:()=>Tt,hermite:()=>Ch,inverse:()=>Ih,len:()=>Tr,length:()=>Ti,lerp:()=>Lh,max:()=>Th,min:()=>wh,mul:()=>Kh,multiply:()=>Mi,negate:()=>Rh,normalize:()=>wr,random:()=>Oh,rotateX:()=>Fh,rotateY:()=>Uh,rotateZ:()=>kh,round:()=>bh,scale:()=>Mh,scaleAndAdd:()=>Sh,set:()=>_h,sqrDist:()=>Wh,sqrLen:()=>Xh,squaredDistance:()=>Ii,squaredLength:()=>Li,str:()=>Vh,sub:()=>Gh,subtract:()=>bi,transformMat3:()=>Ph,transformMat4:()=>Bh,transformQuat:()=>Dh,zero:()=>Hh});function wt(){var t=new j(3);return j!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function xh(t){var e=new j(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Ti(t){var e=t[0],r=t[1],n=t[2];return Math.hypot(e,r,n)}function Tt(t,e,r){var n=new j(3);return n[0]=t,n[1]=e,n[2]=r,n}function gh(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function _h(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t}function yh(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function bi(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function Mi(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function Si(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function Eh(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function Ah(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function wh(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t}function Th(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t}function bh(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function Mh(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function Sh(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t}function Ri(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return Math.hypot(r,n,i)}function Ii(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return r*r+n*n+i*i}function Li(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n}function Rh(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Ih(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function wr(t,e){var r=e[0],n=e[1],i=e[2],s=r*r+n*n+i*i;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function bt(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Je(t,e,r){var n=e[0],i=e[1],s=e[2],a=r[0],o=r[1],l=r[2];return t[0]=i*l-s*o,t[1]=s*a-n*l,t[2]=n*o-i*a,t}function Lh(t,e,r,n){var i=e[0],s=e[1],a=e[2];return t[0]=i+n*(r[0]-i),t[1]=s+n*(r[1]-s),t[2]=a+n*(r[2]-a),t}function Ch(t,e,r,n,i,s){var a=s*s,o=a*(2*s-3)+1,l=a*(s-2)+s,h=a*(s-1),u=a*(3-2*s);return t[0]=e[0]*o+r[0]*l+n[0]*h+i[0]*u,t[1]=e[1]*o+r[1]*l+n[1]*h+i[1]*u,t[2]=e[2]*o+r[2]*l+n[2]*h+i[2]*u,t}function Nh(t,e,r,n,i,s){var a=1-s,o=a*a,l=s*s,h=o*a,u=3*s*o,c=3*l*a,f=l*s;return t[0]=e[0]*h+r[0]*u+n[0]*c+i[0]*f,t[1]=e[1]*h+r[1]*u+n[1]*c+i[1]*f,t[2]=e[2]*h+r[2]*u+n[2]*c+i[2]*f,t}function Oh(t,e){e=e||1;var r=oe()*2*Math.PI,n=oe()*2-1,i=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*i,t[1]=Math.sin(r)*i,t[2]=n*e,t}function Bh(t,e,r){var n=e[0],i=e[1],s=e[2],a=r[3]*n+r[7]*i+r[11]*s+r[15];return a=a||1,t[0]=(r[0]*n+r[4]*i+r[8]*s+r[12])/a,t[1]=(r[1]*n+r[5]*i+r[9]*s+r[13])/a,t[2]=(r[2]*n+r[6]*i+r[10]*s+r[14])/a,t}function Ph(t,e,r){var n=e[0],i=e[1],s=e[2];return t[0]=n*r[0]+i*r[3]+s*r[6],t[1]=n*r[1]+i*r[4]+s*r[7],t[2]=n*r[2]+i*r[5]+s*r[8],t}function Dh(t,e,r){var n=r[0],i=r[1],s=r[2],a=r[3],o=e[0],l=e[1],h=e[2],u=i*h-s*l,c=s*o-n*h,f=n*l-i*o,m=i*f-s*c,p=s*u-n*f,v=n*c-i*u,d=a*2;return u*=d,c*=d,f*=d,m*=2,p*=2,v*=2,t[0]=o+u+m,t[1]=l+c+p,t[2]=h+f+v,t}function Fh(t,e,r,n){var i=[],s=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],s[0]=i[0],s[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),s[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),t[0]=s[0]+r[0],t[1]=s[1]+r[1],t[2]=s[2]+r[2],t}function Uh(t,e,r,n){var i=[],s=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],s[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),s[1]=i[1],s[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),t[0]=s[0]+r[0],t[1]=s[1]+r[1],t[2]=s[2]+r[2],t}function kh(t,e,r,n){var i=[],s=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],s[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),s[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),s[2]=i[2],t[0]=s[0]+r[0],t[1]=s[1]+r[1],t[2]=s[2]+r[2],t}function zh(t,e){var r=t[0],n=t[1],i=t[2],s=e[0],a=e[1],o=e[2],l=Math.sqrt(r*r+n*n+i*i),h=Math.sqrt(s*s+a*a+o*o),u=l*h,c=u&&bt(t,e)/u;return Math.acos(Math.min(Math.max(c,-1),1))}function Hh(t){return t[0]=0,t[1]=0,t[2]=0,t}function Vh(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Yh(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function jh(t,e){var r=t[0],n=t[1],i=t[2],s=e[0],a=e[1],o=e[2];return Math.abs(r-s)<=z*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-a)<=z*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-o)<=z*Math.max(1,Math.abs(i),Math.abs(o))}var Gh=bi,Kh=Mi,$h=Si,qh=Ri,Wh=Ii,Tr=Ti,Xh=Li,Qh=function(){var t=wt();return function(e,r,n,i,s,a){var o,l;for(r||(r=3),n||(n=0),i?l=Math.min(i*r+n,e.length):l=e.length,o=n;o<l;o+=r)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],s(t,t,a),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}}();var Ee={};De(Ee,{add:()=>Ir,ceil:()=>Zh,clone:()=>br,copy:()=>Sr,create:()=>Ci,cross:()=>au,dist:()=>mu,distance:()=>Pi,div:()=>du,divide:()=>Bi,dot:()=>Nr,equals:()=>Pr,exactEquals:()=>Br,floor:()=>Jh,forEach:()=>_u,fromValues:()=>Mr,inverse:()=>su,len:()=>xu,length:()=>Mt,lerp:()=>Or,max:()=>tu,min:()=>eu,mul:()=>pu,multiply:()=>Oi,negate:()=>iu,normalize:()=>Cr,random:()=>ou,round:()=>ru,scale:()=>Lr,scaleAndAdd:()=>nu,set:()=>Rr,sqrDist:()=>vu,sqrLen:()=>gu,squaredDistance:()=>Di,squaredLength:()=>St,str:()=>cu,sub:()=>fu,subtract:()=>Ni,transformMat4:()=>lu,transformQuat:()=>hu,zero:()=>uu});function Ci(){var t=new j(4);return j!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function br(t){var e=new j(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Mr(t,e,r,n){var i=new j(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i}function Sr(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Rr(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t}function Ir(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function Ni(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function Oi(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function Bi(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function Zh(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Jh(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function eu(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t}function tu(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t}function ru(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function Lr(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function nu(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t}function Pi(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],s=e[3]-t[3];return Math.hypot(r,n,i,s)}function Di(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],s=e[3]-t[3];return r*r+n*n+i*i+s*s}function Mt(t){var e=t[0],r=t[1],n=t[2],i=t[3];return Math.hypot(e,r,n,i)}function St(t){var e=t[0],r=t[1],n=t[2],i=t[3];return e*e+r*r+n*n+i*i}function iu(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function su(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function Cr(t,e){var r=e[0],n=e[1],i=e[2],s=e[3],a=r*r+n*n+i*i+s*s;return a>0&&(a=1/Math.sqrt(a)),t[0]=r*a,t[1]=n*a,t[2]=i*a,t[3]=s*a,t}function Nr(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function au(t,e,r,n){var i=r[0]*n[1]-r[1]*n[0],s=r[0]*n[2]-r[2]*n[0],a=r[0]*n[3]-r[3]*n[0],o=r[1]*n[2]-r[2]*n[1],l=r[1]*n[3]-r[3]*n[1],h=r[2]*n[3]-r[3]*n[2],u=e[0],c=e[1],f=e[2],m=e[3];return t[0]=c*h-f*l+m*o,t[1]=-(u*h)+f*a-m*s,t[2]=u*l-c*a+m*i,t[3]=-(u*o)+c*s-f*i,t}function Or(t,e,r,n){var i=e[0],s=e[1],a=e[2],o=e[3];return t[0]=i+n*(r[0]-i),t[1]=s+n*(r[1]-s),t[2]=a+n*(r[2]-a),t[3]=o+n*(r[3]-o),t}function ou(t,e){e=e||1;var r,n,i,s,a,o;do r=oe()*2-1,n=oe()*2-1,a=r*r+n*n;while(a>=1);do i=oe()*2-1,s=oe()*2-1,o=i*i+s*s;while(o>=1);var l=Math.sqrt((1-a)/o);return t[0]=e*r,t[1]=e*n,t[2]=e*i*l,t[3]=e*s*l,t}function lu(t,e,r){var n=e[0],i=e[1],s=e[2],a=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*s+r[12]*a,t[1]=r[1]*n+r[5]*i+r[9]*s+r[13]*a,t[2]=r[2]*n+r[6]*i+r[10]*s+r[14]*a,t[3]=r[3]*n+r[7]*i+r[11]*s+r[15]*a,t}function hu(t,e,r){var n=e[0],i=e[1],s=e[2],a=r[0],o=r[1],l=r[2],h=r[3],u=h*n+o*s-l*i,c=h*i+l*n-a*s,f=h*s+a*i-o*n,m=-a*n-o*i-l*s;return t[0]=u*h+m*-a+c*-l-f*-o,t[1]=c*h+m*-o+f*-a-u*-l,t[2]=f*h+m*-l+u*-o-c*-a,t[3]=e[3],t}function uu(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function cu(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function Br(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function Pr(t,e){var r=t[0],n=t[1],i=t[2],s=t[3],a=e[0],o=e[1],l=e[2],h=e[3];return Math.abs(r-a)<=z*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-o)<=z*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-l)<=z*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(s-h)<=z*Math.max(1,Math.abs(s),Math.abs(h))}var fu=Ni,pu=Oi,du=Bi,mu=Pi,vu=Di,xu=Mt,gu=St,_u=function(){var t=Ci();return function(e,r,n,i,s,a){var o,l;for(r||(r=4),n||(n=0),i?l=Math.min(i*r+n,e.length):l=e.length,o=n;o<l;o+=r)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],s(t,t,a),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}}();function Dr(){var t=new j(4);return j!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function yu(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Fi(t,e,r){r=r*.5;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function Eu(t,e){var r=Math.acos(e[3])*2,n=Math.sin(r/2);return n>z?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),r}function Au(t,e){var r=Yi(t,e);return Math.acos(2*r*r-1)}function Ui(t,e,r){var n=e[0],i=e[1],s=e[2],a=e[3],o=r[0],l=r[1],h=r[2],u=r[3];return t[0]=n*u+a*o+i*h-s*l,t[1]=i*u+a*l+s*o-n*h,t[2]=s*u+a*h+n*l-i*o,t[3]=a*u-n*o-i*l-s*h,t}function wu(t,e,r){r*=.5;var n=e[0],i=e[1],s=e[2],a=e[3],o=Math.sin(r),l=Math.cos(r);return t[0]=n*l+a*o,t[1]=i*l+s*o,t[2]=s*l-i*o,t[3]=a*l-n*o,t}function Tu(t,e,r){r*=.5;var n=e[0],i=e[1],s=e[2],a=e[3],o=Math.sin(r),l=Math.cos(r);return t[0]=n*l-s*o,t[1]=i*l+a*o,t[2]=s*l+n*o,t[3]=a*l-i*o,t}function bu(t,e,r){r*=.5;var n=e[0],i=e[1],s=e[2],a=e[3],o=Math.sin(r),l=Math.cos(r);return t[0]=n*l+i*o,t[1]=i*l-n*o,t[2]=s*l+a*o,t[3]=a*l-s*o,t}function Mu(t,e){var r=e[0],n=e[1],i=e[2];return t[0]=r,t[1]=n,t[2]=i,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),t}function ki(t,e){var r=e[0],n=e[1],i=e[2],s=e[3],a=Math.sqrt(r*r+n*n+i*i),o=Math.exp(s),l=a>0?o*Math.sin(a)/a:0;return t[0]=r*l,t[1]=n*l,t[2]=i*l,t[3]=o*Math.cos(a),t}function zi(t,e){var r=e[0],n=e[1],i=e[2],s=e[3],a=Math.sqrt(r*r+n*n+i*i),o=a>0?Math.atan2(a,s)/a:0;return t[0]=r*o,t[1]=n*o,t[2]=i*o,t[3]=.5*Math.log(r*r+n*n+i*i+s*s),t}function Su(t,e,r){return zi(t,e),Vi(t,t,r),ki(t,t),t}function Rt(t,e,r,n){var i=e[0],s=e[1],a=e[2],o=e[3],l=r[0],h=r[1],u=r[2],c=r[3],f,m,p,v,d;return m=i*l+s*h+a*u+o*c,m<0&&(m=-m,l=-l,h=-h,u=-u,c=-c),1-m>z?(f=Math.acos(m),p=Math.sin(f),v=Math.sin((1-n)*f)/p,d=Math.sin(n*f)/p):(v=1-n,d=n),t[0]=v*i+d*l,t[1]=v*s+d*h,t[2]=v*a+d*u,t[3]=v*o+d*c,t}function Ru(t){var e=oe(),r=oe(),n=oe(),i=Math.sqrt(1-e),s=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*r),t[1]=i*Math.cos(2*Math.PI*r),t[2]=s*Math.sin(2*Math.PI*n),t[3]=s*Math.cos(2*Math.PI*n),t}function Iu(t,e){var r=e[0],n=e[1],i=e[2],s=e[3],a=r*r+n*n+i*i+s*s,o=a?1/a:0;return t[0]=-r*o,t[1]=-n*o,t[2]=-i*o,t[3]=s*o,t}function Lu(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Hi(t,e){var r=e[0]+e[4]+e[8],n;if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var s=(i+1)%3,a=(i+2)%3;n=Math.sqrt(e[i*3+i]-e[s*3+s]-e[a*3+a]+1),t[i]=.5*n,n=.5/n,t[3]=(e[s*3+a]-e[a*3+s])*n,t[s]=(e[s*3+i]+e[i*3+s])*n,t[a]=(e[a*3+i]+e[i*3+a])*n}return t}function Cu(t,e,r,n){var i=.5*Math.PI/180;e*=i,r*=i,n*=i;var s=Math.sin(e),a=Math.cos(e),o=Math.sin(r),l=Math.cos(r),h=Math.sin(n),u=Math.cos(n);return t[0]=s*l*u-a*o*h,t[1]=a*o*u+s*l*h,t[2]=a*l*h-s*o*u,t[3]=a*l*u+s*o*h,t}function Nu(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var Ou=br,Bu=Mr,Pu=Sr,Du=Rr,Fu=Ir,Uu=Ui,Vi=Lr,Yi=Nr,ku=Or,ji=Mt,zu=ji,Gi=St,Hu=Gi,Fr=Cr,Vu=Br,Yu=Pr,ju=function(){var t=wt(),e=Tt(1,0,0),r=Tt(0,1,0);return function(n,i,s){var a=bt(i,s);return a<-.999999?(Je(t,e,i),Tr(t)<1e-6&&Je(t,r,i),wr(t,t),Fi(n,t,Math.PI),n):a>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(Je(t,i,s),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+a,Fr(n,n))}}(),Gu=function(){var t=Dr(),e=Dr();return function(r,n,i,s,a,o){return Rt(t,n,a,o),Rt(e,i,s,o),Rt(r,t,e,2*o*(1-o)),r}}(),Ku=function(){var t=vi();return function(e,r,n,i){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],Fr(e,Hi(e,t))}}();var Ve={};De(Ve,{add:()=>Qu,angle:()=>xc,ceil:()=>Zu,clone:()=>$u,copy:()=>Wu,create:()=>Ki,cross:()=>hc,dist:()=>Mc,distance:()=>Xi,div:()=>bc,divide:()=>Wi,dot:()=>lc,equals:()=>Ec,exactEquals:()=>yc,floor:()=>Ju,forEach:()=>Ic,fromValues:()=>qu,inverse:()=>ac,len:()=>Ac,length:()=>Zi,lerp:()=>uc,max:()=>tc,min:()=>ec,mul:()=>Tc,multiply:()=>qi,negate:()=>sc,normalize:()=>oc,random:()=>cc,rotate:()=>vc,round:()=>rc,scale:()=>nc,scaleAndAdd:()=>ic,set:()=>Xu,sqrDist:()=>Sc,sqrLen:()=>Rc,squaredDistance:()=>Qi,squaredLength:()=>Ji,str:()=>_c,sub:()=>wc,subtract:()=>$i,transformMat2:()=>fc,transformMat2d:()=>pc,transformMat3:()=>dc,transformMat4:()=>mc,zero:()=>gc});function Ki(){var t=new j(2);return j!=Float32Array&&(t[0]=0,t[1]=0),t}function $u(t){var e=new j(2);return e[0]=t[0],e[1]=t[1],e}function qu(t,e){var r=new j(2);return r[0]=t,r[1]=e,r}function Wu(t,e){return t[0]=e[0],t[1]=e[1],t}function Xu(t,e,r){return t[0]=e,t[1]=r,t}function Qu(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function $i(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function qi(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function Wi(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function Zu(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function Ju(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function ec(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t}function tc(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t}function rc(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function nc(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t}function ic(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t}function Xi(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.hypot(r,n)}function Qi(t,e){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n}function Zi(t){var e=t[0],r=t[1];return Math.hypot(e,r)}function Ji(t){var e=t[0],r=t[1];return e*e+r*r}function sc(t,e){return t[0]=-e[0],t[1]=-e[1],t}function ac(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function oc(t,e){var r=e[0],n=e[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t}function lc(t,e){return t[0]*e[0]+t[1]*e[1]}function hc(t,e,r){var n=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=n,t}function uc(t,e,r,n){var i=e[0],s=e[1];return t[0]=i+n*(r[0]-i),t[1]=s+n*(r[1]-s),t}function cc(t,e){e=e||1;var r=oe()*2*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t}function fc(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i,t[1]=r[1]*n+r[3]*i,t}function pc(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i+r[4],t[1]=r[1]*n+r[3]*i+r[5],t}function dc(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[3]*i+r[6],t[1]=r[1]*n+r[4]*i+r[7],t}function mc(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[4]*i+r[12],t[1]=r[1]*n+r[5]*i+r[13],t}function vc(t,e,r,n){var i=e[0]-r[0],s=e[1]-r[1],a=Math.sin(n),o=Math.cos(n);return t[0]=i*o-s*a+r[0],t[1]=i*a+s*o+r[1],t}function xc(t,e){var r=t[0],n=t[1],i=e[0],s=e[1],a=Math.sqrt(r*r+n*n)*Math.sqrt(i*i+s*s),o=a&&(r*i+n*s)/a;return Math.acos(Math.min(Math.max(o,-1),1))}function gc(t){return t[0]=0,t[1]=0,t}function _c(t){return"vec2("+t[0]+", "+t[1]+")"}function yc(t,e){return t[0]===e[0]&&t[1]===e[1]}function Ec(t,e){var r=t[0],n=t[1],i=e[0],s=e[1];return Math.abs(r-i)<=z*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-s)<=z*Math.max(1,Math.abs(n),Math.abs(s))}var Ac=Zi,wc=$i,Tc=qi,bc=Wi,Mc=Xi,Sc=Qi,Rc=Ji,Ic=function(){var t=Ki();return function(e,r,n,i,s,a){var o,l;for(r||(r=2),n||(n=0),i?l=Math.min(i*r+n,e.length):l=e.length,o=n;o<l;o+=r)t[0]=e[o],t[1]=e[o+1],s(t,t,a),e[o]=t[0],e[o+1]=t[1];return e}}();var kd=V.fromValues(0,1,0);var es=class{constructor(e,r){this.projectionMatrix=e,this.viewMatrix=r}resize(e=void 0,r=void 0){return this}},zd=Math.PI/3;var et=class extends es{constructor(e=void 0,r=void 0,n=void 0,i=void 0,s=-1e3,a=1e3){super(Y.create(),Y.create());this.orthoBounds={left:typeof e=="undefined"?void 0:Number(e),top:typeof r=="undefined"?void 0:Number(r),right:typeof n=="undefined"?void 0:Number(n),bottom:typeof i=="undefined"?void 0:Number(i)},this.clippingPlane={near:Number(s),far:Number(a)}}resize(e=void 0,r=void 0){let{near:n,far:i}=this.clippingPlane,{left:s,top:a,right:o,bottom:l}=this.orthoBounds,h=this.projectionMatrix,u=typeof e!="undefined",c=typeof s!="undefined";if(u)if(c){let f=e/r;Y.ortho(h,s*f,o*f,l,a,n,i)}else Y.ortho(h,0,e,r,0,n,i);else c?Y.ortho(h,s,o,l,a,n,i):Y.ortho(h,-1,1,1,-1,-1,1);return this}},Hd=Math.PI/180;var Vd=Symbol("nextAvailableEntityId");function de(t){return typeof WebGL2RenderingContext!="undefined"&&t instanceof WebGL2RenderingContext}var Ur=class{constructor(e,r){this.gl=e,this.target=r}data(e,r=void 0){let n=this.gl,i=this.target;if(typeof e=="number")n.bufferData(i,e,r||n.STATIC_DRAW);else{if(!ArrayBuffer.isView(e))throw new Error("Source data must be a typed array.");n.bufferData(i,e,r||n.STATIC_DRAW)}return this}subData(e,r=0,n=void 0,i=void 0){let s=this.gl,a=this.target;if(ArrayBuffer.isView(e))if(typeof n!="undefined")if(de(s))s.bufferSubData(a,r,e,n,i);else{let o=i?e.subarray(n,n+i):e.subarray(n);s.bufferSubData(a,r,o)}else s.bufferSubData(a,r,e);else throw new Error("Source data must be a typed array.");return this}},ts=class{constructor(e,r,n=void 0){this.dataContext=new Ur(e,r),this.handle=n||e.createBuffer(),e.bindBuffer(r,this.handle)}get gl(){return this.dataContext.gl}get target(){return this.dataContext.target}data(e,r=void 0){return this.dataContext.data(e,r),this}subData(e,r=0,n=void 0,i=void 0){return this.dataContext.subData(e,r,n,i),this}build(){return this.handle}},rs=class{constructor(e,r,n,i){this.gl=e,this.target=r,this.handle=i,this.type=n,this.bindContext=new Ur(e,this.target)}bind(e){return e.bindBuffer(this.target,this.handle),this.bindContext.gl=e,this.bindContext}},Re={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,HALF_FLOAT:5131};function Lc(t,e,r){let n=kr(t,e);return new n(r)}function Cc(t,e,r,n=t.STATIC_DRAW){if(!ArrayBuffer.isView(r))throw new Error("Source data must be a typed array.");let i=t.createBuffer();return t.bindBuffer(e,i),t.bufferData(e,r,n),i}function kr(t,e){switch(e){case t.BYTE:return Int8Array;case t.UNSIGNED_BYTE:return Uint8Array;case t.SHORT:return Int16Array;case t.UNSIGNED_SHORT:return Uint16Array;case t.INT:return Int32Array;case t.UNSIGNED_INT:return Uint32Array;case t.FLOAT:return Float32Array;default:throw new Error(`Cannot find valid typed array for buffer type '${e}'.`)}}function tt(t,e){if(e instanceof Int8Array)return t.BYTE;if(e instanceof Uint8Array)return t.UNSIGNED_BYTE;if(e instanceof Int16Array)return t.SHORT;if(e instanceof Uint16Array)return t.UNSIGNED_SHORT;if(e instanceof Int32Array)return t.INT;if(e instanceof Uint32Array)return t.UNSIGNED_INT;if(e instanceof Float32Array)return t.FLOAT;throw new Error("Cannot find valid data type for buffer source.")}var Nc={[Re.BYTE]:1,[Re.UNSIGNED_BYTE]:1,[Re.SHORT]:2,[Re.UNSIGNED_SHORT]:2,[Re.INT]:4,[Re.UNSIGNED_INT]:4,[Re.FLOAT]:4,[Re.HALF_FLOAT]:2};function It(t,e){return Nc[e]}function Oc(t,e){switch(e){case Int8Array:return t.BYTE;case Uint8Array:return t.UNSIGNED_BYTE;case Int16Array:return t.SHORT;case Uint16Array:return t.UNSIGNED_SHORT;case Int32Array:return t.INT;case Uint32Array:return t.UNSIGNED_INT;case Float32Array:return t.FLOAT;default:throw new Error("Cannot find valid buffer type for typed array.")}}function Bc(t,e,r){return t.bindBuffer(e,r),t.getBufferParameter(e,t.BUFFER_USAGE)}function ns(t,e,r){return t.bindBuffer(e,r),t.getBufferParameter(e,t.BUFFER_SIZE)}function Pc(t,e,r,n){return Math.trunc(ns(t,e,r)/It(t,n))}var me=class{constructor(e,r,n=void 0){this.bufferBuilder=new ts(e,r,n),this.bufferType=e.FLOAT}get gl(){return this.bufferBuilder.gl}get handle(){return this.bufferBuilder.handle}get target(){return this.bufferBuilder.target}data(e,r=void 0){return this.bufferBuilder.data(e,r),typeof e!="number"&&(this.bufferType=tt(this.gl,e)),this}subData(e,r=void 0,n=void 0,i=void 0){return this.bufferBuilder.subData(e,r,n,i),this.bufferType=tt(this.gl,e),this}build(){let e=this.bufferBuilder.build(),r=this.gl,n=this.target,i=this.bufferType;return new rs(r,n,i,e)}};function Dc(t,e){let r=[],n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let i=0;i<n;++i){let s=t.getActiveUniform(e,i);if(!s)break;r.push(s)}return r}function Fc(t,e){let r=[],n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let i=0;i<n;++i){let s=t.getActiveAttrib(e,i);!s||r.push(s)}return r}function Lt(t,e){switch(e){case t.FLOAT:case t.INT:case t.UNSIGNED_INT:case t.BOOL:return 1;case t.FLOAT_VEC2:case t.INT_VEC2:case t.BOOL_VEC2:return 2;case t.FLOAT_VEC3:case t.INT_VEC3:case t.BOOL_VEC3:return 3;case t.FLOAT_VEC4:case t.INT_VEC4:case t.BOOL_VEC4:return 4;case t.FLOAT_MAT2:return 4;case t.FLOAT_MAT3:return 9;case t.FLOAT_MAT4:return 16;default:throw new Error("Invalid vertex attribute type.")}}function Uc(t,e){switch(e){case t.FLOAT:case t.FLOAT_VEC2:case t.FLOAT_VEC3:case t.FLOAT_VEC4:return kc}if(de(t)){let r=t;switch(e){case t.INT:case t.INT_VEC2:case t.INT_VEC3:case t.INT_VEC4:case t.BOOL:case t.BOOL_VEC2:case t.BOOL_VEC3:case t.BOOL_VEC4:return zc;case t.FLOAT_MAT2:return Vc;case t.FLOAT_MAT3:return Yc;case t.FLOAT_MAT4:return jc;case r.UNSIGNED_INT:case r.UNSIGNED_INT_VEC2:case r.UNSIGNED_INT_VEC3:case r.UNSIGNED_INT_VEC4:return Hc}}throw new Error("Cannot find attribute function for gl enum.")}function kc(t,e,r,n,i=!1,s=0,a=0,o=void 0){if(this.bindBuffer(this.ARRAY_BUFFER,e),this.enableVertexAttribArray(t),this.vertexAttribPointer(t,r,n,i,s,a),o!==void 0){if(!de(this))throw new Error("Cannot use attribute divisor in WebGL 1.");this.vertexAttribDivisor(t,o)}}function zc(t,e,r,n,i=!1,s=0,a=0,o=void 0){if(!de(this))throw new Error("Cannot use attribute divisor in WebGL 1.");let l=this;l.bindBuffer(l.ARRAY_BUFFER,e),l.enableVertexAttribArray(t),l.vertexAttribIPointer(t,r,n,s,a),o!==void 0&&l.vertexAttribDivisor(t,o)}function Hc(t,e,r,n,i=!1,s=0,a=0,o=void 0){if(!de(this))throw new Error("Cannot use attribute divisor in WebGL 1.");let l=this;l.bindBuffer(l.ARRAY_BUFFER,e),l.enableVertexAttribArray(t),l.vertexAttribIPointer(t,r,n,s,a),o!==void 0&&l.vertexAttribDivisor(t,o)}function Vc(t,e,r,n,i=!1,s=0,a=0,o=void 0){let l=Lt(this,this.FLOAT_MAT2),h=l*l;zr(h,l,t,e,r,n,i,s,a,o)}function Yc(t,e,r,n,i=!1,s=0,a=0,o=void 0){let l=Lt(this,this.FLOAT_MAT3),h=l*l;zr(h,l,t,e,r,n,i,s,a,o)}function jc(t,e,r,n,i=!1,s=0,a=0,o=void 0){let l=Lt(this,this.FLOAT_MAT4),h=l*l;zr(h,l,t,e,r,n,i,s,a,o)}function zr(t,e,r,n,i,s,a,o,l,h){if(!de(this))throw new Error("Cannot use attribute divisor in WebGL 1.");let u=this;u.bindBuffer(u.ARRAY_BUFFER,n);let c=i/e,f=t*i,m=o/e;for(let p=0;p<e;++p){let v=r+p;u.enableVertexAttribArray(v),u.vertexAttribPointer(v,c,s,a,f,l+m*p),h!==void 0&&u.vertexAttribDivisor(v,h)}}function Gc(t,e){let r={},n=Fc(t,e);for(let i of n){let s=i.name,a=i.size,o=i.type,l=t.getAttribLocation(e,s),h=Uc(t,o),u=Lt(t,o);r[s]={type:o,length:a,location:l,size:u,applier:h,set value([c,f,m,p,v,d,E]){this.applier(this.location,c,f,m,p,v,d,E)}}}return r}function Kc(t,e,r){let n=t.createShader(e);if(t.shaderSource(n,r),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS)){let s=t.getShaderInfoLog(n)+`
Failed to compile shader:
${r}`;throw t.deleteShader(n),new Error(s)}return n}async function $c(t,e,r){for(let s of r)t.attachShader(e,s);t.linkProgram(e);let n=t.getExtension("KHR_parallel_shader_compile");if(n){let s=1e3/60,a;do await new Promise((o,l)=>setTimeout(o,s)),a=t.getProgramParameter(e,n.COMPLETION_STATUS_KHR);while(!a)}for(let s of r)t.detachShader(e,s),t.deleteShader(s);if(!t.getProgramParameter(e,t.LINK_STATUS)){let s=t.getProgramInfoLog(e);throw t.deleteProgram(e),new Error(s)}return e}function qc(t,e,r,n,i=void 0){i?(t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i),t.drawElements(e,n,t.UNSIGNED_SHORT,r)):t.drawArrays(e,r,n)}function Wc(t,e){let r=t;switch(e){case r.FLOAT:return r.uniform1f;case r.FLOAT_VEC2:return r.uniform2fv;case r.FLOAT_VEC3:return r.uniform3fv;case r.FLOAT_VEC4:return r.uniform4fv;case r.INT:return r.uniform1i;case r.INT_VEC2:return r.uniform2iv;case r.INT_VEC3:return r.uniform3iv;case r.INT_VEC4:return r.uniform4iv;case r.BOOL:return r.uniform1i;case r.BOOL_VEC2:return r.uniform2iv;case r.BOOL_VEC3:return r.uniform3iv;case r.BOOL_VEC4:return r.uniform4iv;case r.FLOAT_MAT2:return Xc;case r.FLOAT_MAT3:return Qc;case r.FLOAT_MAT4:return Zc;case r.SAMPLER_2D:case r.SAMPLER_CUBE:return r.uniform1i}if(de(t)){let n=t;switch(e){case n.UNSIGNED_INT:return n.uniform1ui;case n.UNSIGNED_INT_VEC2:return n.uniform2uiv;case n.UNSIGNED_INT_VEC3:return n.uniform3uiv;case n.UNSIGNED_INT_VEC4:return n.uniform4uiv;case n.FLOAT_MAT2x3:return Jc;case n.FLOAT_MAT2x4:return ef;case n.FLOAT_MAT3x2:return tf;case n.FLOAT_MAT3x4:return rf;case n.FLOAT_MAT4x2:return nf;case n.FLOAT_MAT4x3:return sf;case n.SAMPLER_3D:case n.SAMPLER_2D_SHADOW:case n.SAMPLER_2D_ARRAY:case n.SAMPLER_2D_ARRAY_SHADOW:case n.SAMPLER_CUBE_SHADOW:case n.INT_SAMPLER_2D:case n.INT_SAMPLER_3D:case n.INT_SAMPLER_CUBE:case n.INT_SAMPLER_2D_ARRAY:case n.UNSIGNED_INT_SAMPLER_2D:case n.UNSIGNED_INT_SAMPLER_3D:case n.UNSIGNED_INT_SAMPLER_CUBE:case n.UNSIGNED_INT_SAMPLER_2D_ARRAY:return n.uniform1i}}throw new Error("Cannot find uniform function for gl enum.")}function Xc(t,e){this.uniformMatrix2fv(t,!1,e)}function Qc(t,e){this.uniformMatrix3fv(t,!1,e)}function Zc(t,e){this.uniformMatrix4fv(t,!1,e)}function Jc(t,e){this.uniformMatrix2x3fv(t,!1,e)}function ef(t,e){this.uniformMatrix2x4fv(t,!1,e)}function tf(t,e){this.uniformMatrix3x2fv(t,!1,e)}function rf(t,e){this.uniformMatrix3x4fv(t,!1,e)}function nf(t,e){this.uniformMatrix4x2fv(t,!1,e)}function sf(t,e){this.uniformMatrix4x3fv(t,!1,e)}function af(t,e){let r={},n=Dc(t,e);for(let i of n){let s=i.name,a=i.size,o=i.type,l=t.getUniformLocation(e,s),h=Wc(t,o);r[s]={type:o,length:a,location:l,applier:h,set value(u){this.applier.call(t,this.location,u)}}}return r}function of(t,e,r){if("handle"in r&&r.handle instanceof WebGLVertexArrayObject){if(!de(t))throw new Error("Vertex array objects are only supported in WebGL 2.");let n=t,i=r;n.bindVertexArray(i.handle)}else{let n=r,i=e.attributes;for(let s in i){if(!(s in n.attributes))throw new Error(`Missing buffer for attribute '${s}'.`);let a=n.attributes[s],{location:o,applier:l}=i[a.name];l.call(t,o,a.buffer,a.size,a.type,a.normalize,a.stride,a.offset,a.divisor)}n.element&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n.element.buffer)}}function lf(t,e,r=void 0){let n=ff(t,e),i=cf(t,r),s;if(i)s=i.length;else{let a=Object.keys(n);if(a.length>0){let o=n[a[0]];s=Math.trunc(o.length/o.size)}else s=0}return{attributes:n,element:i,vertexCount:s}}function hf(t,e,r){if(!de(t))throw new Error("Vertex array objects is only supported on WebGL2.");let n=t,i=n.createVertexArray();n.bindVertexArray(i);for(let s of r)of(n,s,e);return n.bindVertexArray(null),{handle:i,element:e.element,vertexCount:e.vertexCount}}function uf(t,e,r=t.TRIANGLES,n=0,i=e.vertexCount,s=void 0){let a=e.element;if(a){let o=a.type;if(s!==void 0){if(!de(t))throw new Error("Instanced element drawing is only supported on WebGL2.");t.drawElementsInstanced(r,i,o,n,s)}else t.drawElements(r,i,o,n)}else if(s!==void 0){if(!de(t))throw new Error("Instanced array drawing is only supported on WebGL2.");t.drawArraysInstanced(r,n,i,s)}else t.drawArrays(r,n,i)}function cf(t,e=void 0){if(!e)return null;if(typeof e!="object")throw new Error("Element attribute options must be an object.");let{type:r=t.UNSIGNED_SHORT,buffer:n,usage:i=t.STATIC_DRAW,length:s}=e;if(n instanceof WebGLBuffer)t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n);else if(ArrayBuffer.isView(n)){let a=n;n=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n),t.bufferData(t.ELEMENT_ARRAY_BUFFER,a,i),r===void 0&&(r=tt(t,a)),s===void 0&&(s=a.length)}else if(Array.isArray(n)){let a=n;n=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(a),i),s===void 0&&(s=a.length)}else if(typeof n=="number"){let a=n;n=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n),t.bufferData(t.ELEMENT_ARRAY_BUFFER,a,i),s===void 0&&(s=a)}else throw new Error("Invalid buffer for element attribute options.");if(r===void 0&&(r=t.UNSIGNED_SHORT),s===void 0){let a=t.getBufferParameter(t.ELEMENT_ARRAY_BUFFER,t.BUFFER_SIZE);s=Math.trunc(a/It(t,r))}return df(n,r,s)}function ff(t,e){let r={};for(let n of Object.keys(e)){let i=e[n];if(!i)continue;if(typeof i!="object")throw new Error("Array attribute options must be an object.");let{name:s=n,buffer:a,size:o=3,type:l,normalize:h=!1,stride:u=0,offset:c=0,divisor:f=void 0,usage:m=t.STATIC_DRAW,length:p}=i;if(a instanceof WebGLBuffer)t.bindBuffer(t.ARRAY_BUFFER,a);else if(ArrayBuffer.isView(a)){let v=a;a=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,a),t.bufferData(t.ARRAY_BUFFER,v,m),l===void 0&&(l=tt(t,v)),p===void 0&&(p=v.length)}else if(Array.isArray(a)){let v=a;l===void 0&&(l=t.FLOAT),p===void 0&&(p=v.length),a=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,a);let d=kr(t,l);t.bufferData(t.ARRAY_BUFFER,new d(v),m)}else if(typeof a=="number"){let v=a;a=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,a),t.bufferData(t.ARRAY_BUFFER,v,m),p===void 0&&(p=v)}else throw new Error(`Invalid buffer '${a}' for array attribute options.`);if(l===void 0&&(l=t.FLOAT),p===void 0){let v=t.getBufferParameter(t.ARRAY_BUFFER,t.BUFFER_SIZE);p=Math.trunc(v/It(t,l))}o===void 0&&(o=pf(s,p)),r[s]=mf(s,a,p,o,l,h,u,c,f)}return r}function pf(t,e){let r;if(t.includes("texcoord")?r=2:t.includes("color")?r=4:r=3,e%r!=0)throw new Error(`Could not determine vertex size - guessed ${r} but array length ${e} is not evenly divisible.`);return r}function df(t,e,r){return{buffer:t,type:e,length:r}}function mf(t,e,r,n,i,s,a,o,l){return{name:t,buffer:e,length:r,size:n,type:i,normalize:s,stride:a,offset:o,divisor:l}}var Ae=Object.freeze({__proto__:null,createBuffer:Cc,createBufferInfo:lf,createBufferSource:Lc,createVertexArrayInfo:hf,drawBufferInfo:uf,getBufferByteCount:ns,getBufferLength:Pc,getBufferTypeForBufferSource:tt,getBufferTypeForTypedArray:Oc,getBufferUsage:Bc,getByteCountForBufferType:It,getTypedArrayForBufferType:kr}),is=class{constructor(e,r){this.handle=r,this.activeUniforms=af(e,r),this.activeAttributes=Gc(e,r),this.drawContext=new ss(e,this)}bind(e){return e.useProgram(this.handle),this.drawContext.gl=e,this.drawContext}},ss=class{constructor(e,r){this.gl=e,this.parent=r}uniform(e,r){let n=this.parent.activeUniforms;if(e in n){let i=n[e],s=i.location;i.applier.call(this.gl,s,r)}return this}attribute(e,r,n,i=!1,s=0,a=0){let o=this.gl,l=this.parent.activeAttributes;if(e in l){let h=l[e],u=h.location,c=h.size;n?(o.bindBuffer(o.ARRAY_BUFFER,n),o.vertexAttribPointer(u,c,r,i,s,a),o.enableVertexAttribArray(u)):o.disableVertexAttribArray(u)}return this}draw(e,r,n,i,s=null){return qc(e,r,n,i,s),this.parent}},as=class{constructor(e,r=void 0){this.handle=r||e.createProgram(),this.shaders=[],this.gl=e}shader(e,r){let n=this.gl,i=Kc(n,e,r);return this.shaders.push(i),this}link(){let e=this.gl;return $c(e,this.handle,this.shaders),this.shaders.length=0,this.handle}},be=class{constructor(e,r=void 0){this.programBuilder=new as(e,r)}get gl(){return this.programBuilder.gl}get handle(){return this.programBuilder.handle}get shaders(){return this.programBuilder.shaders}shader(e,r){return this.programBuilder.shader(e,r),this}link(){let e=this.programBuilder.link();return new is(this.gl,e)}};var ie={red(t){return t>>16&255},redf(t){return(t>>16&255)/255},green(t){return t>>8&255},greenf(t){return(t>>8&255)/255},blue(t){return t&255},bluef(t){return(t&255)/255},alpha(t){return t>>24&255},alphaf(t){return(t>>24&255)/255},hexf(t,e,r,n=1){let i=Math.floor(Math.max(Math.min(t,1),0)*255),s=Math.floor(Math.max(Math.min(e,1),0)*255),a=Math.floor(Math.max(Math.min(r,1),0)*255);return(Math.floor(Math.max(Math.min(n,1),0)*255)&255)<<24|(i&255)<<16|(s&255)<<8|a&255},mix(t=0,e=16777215,r=.5){if(e<t){let c=t;t=e,e=c}let n=this.redf(t),i=this.greenf(t),s=this.bluef(t),a=this.alphaf(t),o=(this.redf(e)-n)*r+n,l=(this.greenf(e)-i)*r+i,h=(this.bluef(e)-s)*r+s,u=(this.alphaf(e)-a)*r+a;return u<.01&&(u=void 0),this.hexf(o,l,h,u)}};var os=16,xf=(()=>{let t=[],e=os,r=Math.PI*2/e,n=1,i=0,s,a;for(let o=0;o<=e;++o)s=Math.cos(o*r),a=Math.sin(o*r),t.push(0,0),t.push(n,i),t.push(s,a),n=s,i=a;return t})(),Qd=Math.trunc(xf.length/2),gf=(()=>{let t=[],e=os,r=Math.PI*2/e,n=1,i=0,s,a;for(let o=0;o<=e;++o)s=Math.cos(o*r),a=Math.sin(o*r),t.push(n,i),t.push(s,a),n=s,i=a;return t})(),Zd=Math.trunc(gf.length/2);var _f=16,Hr=16,s0=Hr/2,yf=_f*Hr,a0=1/yf;var Ef=.3,L0=1-Ef;var Vr=class{constructor(e,r=e.canvas,n=new et){this.gl=e,this.canvas=r,this.camera=n,this.projectionViewMatrix=Y.create(),this.modelMatrix=Y.create(),this.colorVector=V.create(),this.depthFloat=0,this.opacityFloat=1,this.transformStack=[],this.transformMatrix=Y.create(),this.translationVector=V.create(),this.rotationQuat=ee.create(),this.scaleVector=V.fromValues(1,1,1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA)}reset(){this.resize(),this.clear(0,0,0,1),this.setColorVector(1,1,1),this.setDepthFloat(0),this.setOpacityFloat(1),this.resetTransform(),this.transformStack.length=0}resize(){let e=this.gl,r=e.canvas.width,n=e.canvas.height;e.viewport(0,0,r,n);let i=this.camera;i.resize(r,n);let s=this.projectionViewMatrix;Y.mul(s,i.projectionMatrix,i.viewMatrix)}clear(e,r,n,i=1){let s=this.gl;s.clearColor(e,r,n,i),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT)}setColorVector(e,r,n){return V.set(this.colorVector,e,r,n),this}setColor(e){return this.setColorVector(ie.redf(e),ie.greenf(e),ie.bluef(e))}setDepthFloat(e){return this.depthFloat=e,this}setOpacityFloat(e){return this.opacityFloat=e,this}setTranslation(e,r,n=0){return V.set(this.translationVector,e,r,n),this}setRotation(e){return ee.fromEuler(this.rotationQuat,0,0,e),this}setScale(e,r){return V.set(this.scaleVector,e,r,1),this}resetTransform(){V.zero(this.translationVector),ee.identity(this.rotationQuat),V.set(this.scaleVector,1,1,1)}pushTransform(){let e=Y.fromRotationTranslationScale(Y.create(),this.rotationQuat,this.translationVector,this.scaleVector);this.transformStack.push(e),this.resetTransform()}popTransform(){let e=this.transformStack.pop();Y.getRotation(this.rotationQuat,e),Y.getTranslation(this.translationVector,e),Y.getScaling(this.scaleVector,e)}applyTransform(e){for(let r=this.transformStack.length-1;r>=0;--r)Y.mul(e,this.transformStack[r],e);return Y.mul(e,Y.fromRotationTranslationScale(this.transformMatrix,this.rotationQuat,this.translationVector,this.scaleVector),e),e}};var Af=`
attribute vec2 a_position;

uniform mat4 u_projection_view;
uniform mat4 u_model;

void main() {
    gl_Position = u_projection_view * u_model * vec4(a_position.xy, 0.0, 1.0);
}`,wf=`
precision mediump float;

uniform vec3 u_color;
uniform float u_opacity_inv;

void main() {
    gl_FragColor = vec4(u_color.rgb, 1.0 - u_opacity_inv);
}`,hs=16,us=(()=>{let t=[],e=hs,r=Math.PI*2/e,n=1,i=0,s,a;for(let o=0;o<=e;++o)s=Math.cos(o*r),a=Math.sin(o*r),t.push(0,0),t.push(n,i),t.push(s,a),n=s,i=a;return t})(),Tf=Math.trunc(us.length/2),cs=(()=>{let t=[],e=hs,r=Math.PI*2/e,n=1,i=0,s,a;for(let o=0;o<=e;++o)s=Math.cos(o*r),a=Math.sin(o*r),t.push(n,i),t.push(s,a),n=s,i=a;return t})(),bf=Math.trunc(cs.length/2),Ct=[0,0,1,0,0,1,1,1,1,0,0,1],Mf=[0,0,1,1],Yr=class extends Vr{constructor(e,r=void 0,n=void 0){super(e,r,n);this.shapeProgram=new be(e).shader(e.VERTEX_SHADER,Af).shader(e.FRAGMENT_SHADER,wf).link(),this.meshQuad=new me(e,e.ARRAY_BUFFER).data(Ae.createBufferSource(e,e.FLOAT,Ct)).build(),this.meshLine=new me(e,e.ARRAY_BUFFER).data(Ae.createBufferSource(e,e.FLOAT,Mf)).build(),this.meshCircle=new me(e,e.ARRAY_BUFFER).data(Ae.createBufferSource(e,e.FLOAT,us)).build(),this.meshLineCircle=new me(e,e.ARRAY_BUFFER).data(Ae.createBufferSource(e,e.FLOAT,cs)).build()}resize(){super.resize(),this.shapeProgram.bind(this.gl).uniform("u_projection_view",this.projectionViewMatrix)}setColorVector(e,r,n){return super.setColorVector(e,r,n),this.shapeProgram.bind(this.gl).uniform("u_color",this.colorVector),this}setOpacityFloat(e){return super.setOpacityFloat(e),this.shapeProgram.bind(this.gl).uniform("u_opacity_inv",1-this.opacityFloat),this}drawLine(e=0,r=0,n=e+16,i=r){let s=this.gl,a=this.depthFloat,o=n-e,l=i-r,h=this.modelMatrix;return Y.fromRotationTranslationScale(h,ee.create(),V.fromValues(e,r,a),V.fromValues(o,l,1)),this.applyTransform(h),this.shapeProgram.bind(s).attribute("a_position",s.FLOAT,this.meshLine.handle).uniform("u_model",h).draw(s,s.LINES,0,2),this}drawRay(e=0,r=0,n=0,i=16){let s=Math.PI*n/180;return this.drawLine(e,r,e+Math.cos(s)*i,r+Math.sin(s)*i)}drawBox(e=0,r=0,n=8,i=n){return this.drawBoxImpl(this.gl.TRIANGLES,e,r,this.depthFloat,n,i)}drawLineBox(e=0,r=0,n=8,i=n){return this.drawBoxImpl(this.gl.LINE_LOOP,e,r,this.depthFloat,n,i)}drawRect(e=0,r=0,n=16,i=16){let s=(n-e)/2,a=(i-r)/2;return this.drawBox(e+s,r+a,s,a)}drawLineRect(e=0,r=0,n=16,i=16){let s=(n-e)/2,a=(i-r)/2;return this.drawLineBox(e+s,r+a,s,a)}drawCircle(e=0,r=0,n=8){return this.drawCircleImpl(this.meshCircle,Tf,this.gl.TRIANGLES,e,r,this.depthFloat,n)}drawLineCircle(e=0,r=0,n=8){return this.drawCircleImpl(this.meshLineCircle,bf,this.gl.LINE_LOOP,e,r,this.depthFloat,n)}drawBoxImpl(e,r,n,i,s,a){let o=this.gl,l=this.modelMatrix;return Y.fromRotationTranslationScaleOrigin(l,ee.create(),V.fromValues(r,n,i),V.fromValues(s*2,a*2,1),V.fromValues(.5,.5,0)),this.applyTransform(l),this.shapeProgram.bind(o).attribute("a_position",o.FLOAT,this.meshQuad.handle).uniform("u_model",l).draw(o,e,0,6),this}drawCircleImpl(e,r,n,i,s,a,o){let l=this.gl,h=this.modelMatrix;return Y.fromRotationTranslationScale(h,ee.create(),V.fromValues(i,s,a),V.fromValues(o,o,1)),this.applyTransform(h),this.shapeProgram.bind(l).attribute("a_position",l.FLOAT,e.handle).uniform("u_model",h).draw(l,n,0,r),this}};var Sf=`
attribute vec2 a_position;
attribute vec2 a_texcoord;

varying vec2 v_texcoord;

uniform mat4 u_projection_view;
uniform mat4 u_model;

void main() {
    vec4 position = u_projection_view * u_model
        * vec4(a_position.xy, 0.0, 1.0);
    v_texcoord = a_texcoord;
    gl_Position = position;
}`,Rf=`
precision mediump float;

varying vec2 v_texcoord;

uniform sampler2D u_texture;
uniform vec2 u_texture_size;
uniform vec4 u_sprite;
uniform vec3 u_color;
uniform float u_opacity_inv;

void main() {
    float spriteWidth = u_sprite.z - u_sprite.x;
    float spriteHeight = u_sprite.w - u_sprite.y;
    vec2 texcoord = vec2(
        (u_sprite.x / u_texture_size.x) + v_texcoord.x * (spriteWidth / u_texture_size.x),
        (u_sprite.y / u_texture_size.y) + v_texcoord.y * (spriteHeight / u_texture_size.y));
    vec4 texcolor = texture2D(u_texture, texcoord);
    if (texcolor.a <= 0.0) discard;
    gl_FragColor = vec4(
        texcolor.r * u_color.r,
        texcolor.g * u_color.g,
        texcolor.b * u_color.b,
        texcolor.a * (1.0 - u_opacity_inv));
}`,jr=class extends Yr{constructor(e,r=void 0,n=void 0){super(e,r,n);this.texturedProgram=new be(e).shader(e.VERTEX_SHADER,Sf).shader(e.FRAGMENT_SHADER,Rf).link(),this.meshQuadTextured={position:new me(e,e.ARRAY_BUFFER).data(Ae.createBufferSource(e,e.FLOAT,Ct)).build(),texcoord:new me(e,e.ARRAY_BUFFER).data(Ae.createBufferSource(e,e.FLOAT,Ct)).build()},this.spriteVector=Ee.fromValues(0,0,1,1),this.textureSize=Ve.fromValues(1,1),this.textureHandle=null,this.textureList=new Array(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS))}resize(){super.resize(),this.texturedProgram.bind(this.gl).uniform("u_projection_view",this.projectionViewMatrix)}setColorVector(e,r,n){return super.setColorVector(e,r,n),this.texturedProgram.bind(this.gl).uniform("u_color",this.colorVector),this}setOpacityFloat(e){return super.setOpacityFloat(e),this.texturedProgram.bind(this.gl).uniform("u_opacity_inv",1-this.opacityFloat),this}setTextureImage(e,r){let n=this.textureList,i=n.length;if(e<0||e>=i)throw new Error(`Invalid texture unit - must be within range [0, ${i-1}]`);let s=this.gl,a=n[e];a&&Lf(s,a.handle);let o=If(s,r);return n[e]=o,s.activeTexture(s.TEXTURE0+e),s.bindTexture(s.TEXTURE_2D,o.handle),this}drawTexturedBox(e=0,r=0,n=0,i=void 0,s=void 0,a=0,o=0,l=void 0,h=void 0){let{width:u,height:c}=this.textureList[e];Ve.set(this.textureSize,u,c),typeof l=="undefined"&&(l=u),typeof h=="undefined"&&(h=c),Ee.set(this.spriteVector,a,o,l,h);let f=l-a,m=h-o,p=!1;typeof i=="undefined"?i=f/2:p=!0,typeof s=="undefined"&&(p?s=i:s=m/2);let v=i*2,d=s*2,E=v/f,I=d/m;return this.drawTexturedQuadImpl(e,r,n,this.depthFloat,E,I)}drawTexturedRect(e=0,r=0,n=0,i=void 0,s=void 0,a=0,o=0,l=void 0,h=void 0){let{width:u,height:c}=this.textureList[e];typeof l=="undefined"&&(l=u),typeof h=="undefined"&&(h=c),Ve.set(this.textureSize,u,c),Ee.set(this.spriteVector,a,o,l,h),typeof i=="undefined"&&(i=r+u),typeof s=="undefined"&&(s=n+c);let f=i-r,m=s-n,p=l-a,v=h-o,d=f/p,E=m/v,I=r+p/2*d,T=n+v/2*E;return this.drawTexturedQuadImpl(e,I,T,this.depthFloat,d,E)}drawTexturedQuadImpl(e,r,n,i,s,a){let o=this.gl,l=this.spriteVector,h=l[2]-l[0],u=l[3]-l[1],c=this.modelMatrix;Y.fromRotationTranslationScaleOrigin(c,ee.fromEuler(ee.create(),0,0,0),V.fromValues(r-h/2,n-u/2,i),V.fromValues(s,a,1),V.fromValues(h/2,u/2,0)),Y.scale(c,c,V.fromValues(h,u,1)),this.applyTransform(c);let f=this.meshQuadTextured,m=this.textureSize;return this.texturedProgram.bind(o).attribute("a_position",o.FLOAT,f.position.handle).attribute("a_texcoord",o.FLOAT,f.texcoord.handle).uniform("u_model",c).uniform("u_texture",e).uniform("u_sprite",l).uniform("u_texture_size",m).draw(o,o.TRIANGLES,0,6),this}};function If(t,e){if(!(e instanceof Image))throw new Error(`Not a valid image ${e}.`);let r=0,n=t.RGBA,i=t.RGBA,s=t.UNSIGNED_BYTE,a=t.createTexture();return t.bindTexture(t.TEXTURE_2D,a),t.texImage2D(t.TEXTURE_2D,r,n,i,s,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),{handle:a,width:e.width,height:e.height}}function Lf(t,e){t.deleteTexture(e)}var Cf=`
attribute vec2 a_position;

varying vec2 v_position;

uniform mat4 u_projection_view;
uniform mat4 u_model;

void main() {
    gl_Position = u_projection_view * u_model * vec4(a_position.xy, 0.0, 1.0);
    v_position = a_position;
}`,Nf=`
precision mediump float;

varying vec2 v_position;

uniform vec3 u_color;
uniform float u_opacity_inv;

uniform vec3 u_color_from;
uniform vec3 u_color_to;

uniform vec4 u_gradient_rect;

void main() {
    // float fx = (gl_FragCoord.x - u_gradient_rect.x) / u_gradient_rect.z;
    float fy = (gl_FragCoord.y - u_gradient_rect.y) / u_gradient_rect.w;
    gl_FragColor = vec4(mix(u_color_to, u_color_from, fy), 1.0 - u_opacity_inv);
}`,Gr=class extends jr{constructor(e,r=void 0,n=void 0){super(e,r,n);this.gradientProgram=new be(e).shader(e.VERTEX_SHADER,Cf).shader(e.FRAGMENT_SHADER,Nf).link(),this.gradientColor=V.create(),this.gradientVector=Ee.create()}resize(){super.resize(),this.gradientProgram.bind(this.gl).uniform("u_projection_view",this.projectionViewMatrix)}setColorVector(e,r,n){return super.setColorVector(e,r,n),this.gradientProgram.bind(this.gl).uniform("u_color",this.colorVector),this}setOpacityFloat(e){return super.setOpacityFloat(e),this.gradientProgram.bind(this.gl).uniform("u_opacity_inv",1-this.opacityFloat),this}drawGradientRect(e=16777215,r=0,n=0,i=0,s=this.canvas.width,a=this.canvas.height){let o=(s-n)/2,l=(a-i)/2,h=n+o,u=i+l,c=this.depthFloat,f=this.gl,m=this.modelMatrix;return Y.fromRotationTranslationScaleOrigin(m,ee.fromEuler(ee.create(),0,0,0),V.fromValues(h,u,c),V.fromValues(o*2,l*2,1),V.fromValues(.5,.5,0)),this.applyTransform(m),this.gradientProgram.bind(f).attribute("a_position",f.FLOAT,this.meshQuad.handle).uniform("u_model",m).uniform("u_color_from",V.set(this.gradientColor,ie.redf(e),ie.greenf(e),ie.bluef(e))).uniform("u_color_to",V.set(this.gradientColor,ie.redf(r),ie.greenf(r),ie.bluef(r))).uniform("u_gradient_rect",Ee.set(this.gradientVector,n,this.canvas.height-a,o*2,l*2)).draw(f,f.TRIANGLES,0,6),this}};var Kr=class extends Gr{constructor(e,r=void 0,n=void 0){super(e,r,n);this.bmFontMap={}}setBMFontTexture(e,r,n){let i={};for(let s of n.chars){let a=s.x,o=s.y,l=a+s.width,h=o+s.height;i[s.id]={u:a,v:o,s:l,t:h}}this.bmFontMap[e]=i,this.setTextureImage(e,r)}drawText(e,r,n,i){let s=n,a=13,o=18;for(let l=0;l<r.length;++l){let h=r.charAt(l);if(h===`
`){i+=o,n=s;continue}else if(h===" "){n+=a;continue}else{n+=a;let u=r.charCodeAt(l),{u:c,v:f,s:m,t:p}=this.bmFontMap[e][u],v=m-c,d=p-f;this.drawTexturedBox(e,n,i,v/2,d/2,c,f,m,p)}}}};document.title="Moonset";async function fs(t){let{display:e,assets:r}=t,n=e.canvas,i=new Kr(n.getContext("webgl"));i.reset();let s=r.get("image:water_tile.png"),a=r.get("fnt:m5x7.fnt"),o=r.get("image:m5x7.png"),l=r.get("image:star.png"),h=r.get("image:blur_stroke.png"),u=r.get("image:circle.png"),c=r.get("image:mountains.png"),f=r.get("image:cloud.png"),m=[16448250],p=8550580,v=11845350,d=[11837670,13484018],E=[],I=[],T=[],M=[];for(let b=0;b<40;++b)E.push({x:F.rangeInt(0,n.width),y:F.rangeInt(0,n.height),scale:F.range(.1,.4),opacity:F.range(.3,1),color:F.choose(m),wiggleSpeed:F.range(.8,1.2),wiggleOffset:F.range(0,2)});for(let b=0;b<12;++b){let N=F.range(-n.width/2,n.width),A=F.range(0,n.height),w;A<n.width*.6?w=d[0]:w=d[1];let D=F.range(1,2);I.push({x:N,y:A,color:w,progress:F.range(0,n.height),speed:F.range(.1,1.5),opacity:F.range(.1,.3),radius:F.range(.5,1)*D,length:F.range(1,2)*D})}for(let b=0;b<4;++b){let N=F.range(-n.width/2,n.width),A=F.rangeInt(0,n.height),w=d[1];T.push({x:N,y:A,color:w,progress:0,speed:F.range(.1,.5),opacity:F.range(.1,.5),radius:F.range(.5,1)*3,length:F.range(1,2)*3})}for(let b=0;b<6;++b){let N=F.range(0,n.width),A=F.range(0,n.height),w=ie.mix(v,p,vr(A/n.height-.06,0,1)),D=F.range(50,80);M.push({x:N,y:A,opacity:1,color:w,height:D})}let S=[];for(let b=0;b<8;++b){let N=F.range(0,n.width),A=F.range(0,n.height*.6),w=F.range(2,4),D=F.range(.2,1),x=16777215,P=14741247;S.push({x:N,y:A,w,h:D,highlight:x,lowlight:P,progress:0,speed:F.range(.5,3)})}e.addEventListener("frame",b=>{let{deltaTime:N,now:A}=b.detail,w=30;N*=w,A*=w;for(let y of I)if(y.progress+=N/50*y.speed,y.progress>y.y*2+y.length){let O=F.range(-n.width/2,n.width);y.x=O,y.y=n.height,y.progress=0,y.speed=F.range(.1,2),y.opacity=F.range(.1,.3),y.radius=F.range(.5,1),y.length=F.range(1,2)}for(let y of T)if(y.progress+=N/50*y.speed,y.progress>y.y*2+y.length){let O=F.range(-n.width/2,n.width);y.x=O,y.y=n.height,y.progress=0,y.speed=F.range(.1,.5),y.opacity=F.range(.1,.5),y.radius=F.range(.5,1)*3,y.length=F.range(1,2)*3}for(let y of S)y.progress+=N/100*y.speed,y.progress>n.width-y.x+300&&(y.w=F.range(2,4),y.h=F.range(.2,1),y.x=-n.width,y.y=F.range(0,n.height*.6),y.progress=0,y.speed=F.range(.5,3));i.resize(),i.reset(),i.drawGradientRect(p,v,0,0,n.width,n.height);for(let y of M)i.setColor(y.color),i.setScale(n.width/16,y.height/16),i.setTranslation(y.x,y.y),i.drawCircle(),i.resetTransform();i.setTextureImage(2,h),i.setRotation(-45);for(let y of I){let O=y.progress/100;i.setColor(y.color),i.setOpacityFloat(Math.min(O,y.opacity)),i.setScale(y.length,y.radius),i.setTranslation(y.x,y.y),i.drawTexturedBox(2,y.progress)}for(let y of T){let O=y.progress/100;i.setColor(y.color),i.setOpacityFloat(Math.min(O,y.opacity)),i.setScale(y.length,y.radius),i.setTranslation(y.x,y.y),i.drawTexturedBox(2,y.progress)}i.setOpacityFloat(1),i.resetTransform();let D=A/400%n.width,x=A/400%n.height;for(let y of E){i.setColor(y.color),i.setOpacityFloat(y.opacity),i.setTextureImage(0,l);let O=Math.sin(A/500*y.wiggleSpeed+y.wiggleOffset)+1,g=(y.x+D)%n.width,_=(y.y+x)%n.height;i.drawTexturedBox(0,g,n.height-_,16*y.scale,16*y.scale+O*y.scale*8)}i.setOpacityFloat(1),i.setColor(m[0]),i.setTextureImage(3,u),i.drawTexturedBox(3,n.width*.66,60),i.setTextureImage(4,f);let P=-f.height/2;for(let y of S){let O=y.x+y.progress;i.setColor(y.highlight),i.setScale(y.w*1.2,y.h*1.2),i.setTranslation(O,y.y);let g=O/n.width;i.drawTexturedBox(4,10*(-g*2+1),P),i.setColor(y.lowlight),i.setScale(y.w,y.h),i.setTranslation(O,y.y),i.drawTexturedBox(4,0,P)}i.resetTransform(),i.setColor(7496529),i.drawRect(0,n.height-100,n.width,n.height),i.setColor(15651071),i.setTextureImage(4,c),i.drawTexturedBox(4,n.width/2,n.height-100)})}var f1=new W("forward",[le.KEY_W,le.ARROW_UP]),p1=new W("backward",[le.KEY_S,le.ARROW_DOWN]),d1=new W("rotateLeft",[le.KEY_A,le.ARROW_LEFT]),m1=new W("rotateRight",[le.KEY_D,le.ARROW_RIGHT]),v1=new W("fire",le.SPACE),x1=new W("debug",le.BACKQUOTE);async function Pe(t){let e=Be.getAudioContext(),r=await Qe(t,e);return new Be(e,r)}var w1=new pe("sound://start.wav",void 0,Pe,"res/start.wav"),T1=new pe("sound://dead.wav",void 0,Pe,"res/dead.wav"),b1=new pe("sound://pop.wav",void 0,Pe,"res/boop.wav"),M1=new pe("sound://shoot.wav",void 0,Pe,"res/click.wav"),S1=new pe("sound://boom.wav",void 0,Pe,"res/boom.wav"),R1=new pe("sound://music.wav",void 0,Pe,"res/music.wav");document.title="Starfield";window.addEventListener("DOMContentLoaded",Pf);async function Pf(){let t=document.querySelector("#display"),e=document.querySelector("#inputs").getContext("axisbutton"),r=new We,n=new dr(r);await hi(r,"res.pack",(s,a,o)=>r.cache("res/"+o,s)),await n.pipe("res/**/*.md",async(s,a)=>this.asset.cache("txt:"+a.substring(4),await At(s))),await n.pipe("res/**/*.txt",async(s,a)=>this.asset.cache("txt:"+a.substring(4),await At(s))),await n.pipe("res/**/*.png",async(s,a)=>this.asset.cache("image:"+a.substring(4),await pr(s,{imageType:"image/png"}))),await n.pipe("res/**/*.obj",async(s,a)=>this.asset.cache("obj:"+a.substring(4),await gr(s))),await n.pipe("res/**/*.atlas",async(s,a)=>this.asset.cache("atlas:"+a.substring(4),await _r(s))),await n.pipe("res/**/*.fnt",async(s,a)=>this.asset.cache("fnt:"+a.substring(4),await yr(s))),await n.pipe("res/**/*.wav",async(s,a)=>{let o=Be.getAudioContext(),l=await Qe(s,o),h=new Be(o,l);return this.assets.cache("sound:"+a.substring(4),h)});let i=new xr(t,e);t.addEventListener("frame",s=>{let{deltaTime:a,prevTime:o,now:l}=s.detail;i.deltaTime=a,i.prevTime=o,i.now=l,e.poll(l),i.emit("frame")}),await fs(i)}})();
//# sourceMappingURL=main.js.map
