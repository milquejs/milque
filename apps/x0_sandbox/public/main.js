(()=>{var Ci=Object.create,Ue=Object.defineProperty,Ni=Object.getPrototypeOf,Oi=Object.prototype.hasOwnProperty,Pi=Object.getOwnPropertyNames,Fi=Object.getOwnPropertyDescriptor;var Bi=e=>Ue(e,"__esModule",{value:!0});var Di=(e,t)=>()=>(e&&(t=e(e=0)),t),me=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),_e=(e,t)=>{for(var r in t)Ue(e,r,{get:t[r],enumerable:!0})},Ui=(e,t,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Pi(t))!Oi.call(e,n)&&n!=="default"&&Ue(e,n,{get:()=>t[n],enumerable:!(r=Fi(t,n))||r.enumerable});return e},ki=e=>Ui(Bi(Ue(e!=null?Ci(Ni(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var $r={};_e($r,{basename:()=>Xr,default:()=>vs,delimiter:()=>qr,dirname:()=>Kr,extname:()=>Wr,isAbsolute:()=>Ct,join:()=>Vr,normalize:()=>Nt,relative:()=>Gr,resolve:()=>Ge,sep:()=>Yr});function jr(e,t){for(var r=0,n=e.length-1;n>=0;n--){var i=e[n];i==="."?e.splice(n,1):i===".."?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}function Ge(){for(var e="",t=!1,r=arguments.length-1;r>=-1&&!t;r--){var n=r>=0?arguments[r]:"/";if(typeof n!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!n)continue;e=n+"/"+e,t=n.charAt(0)==="/"}return e=jr(It(e.split("/"),function(i){return!!i}),!t).join("/"),(t?"/":"")+e||"."}function Nt(e){var t=Ct(e),r=ds(e,-1)==="/";return e=jr(It(e.split("/"),function(n){return!!n}),!t).join("/"),!e&&!t&&(e="."),e&&r&&(e+="/"),(t?"/":"")+e}function Ct(e){return e.charAt(0)==="/"}function Vr(){var e=Array.prototype.slice.call(arguments,0);return Nt(It(e,function(t,r){if(typeof t!="string")throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))}function Gr(e,t){e=Ge(e).substr(1),t=Ge(t).substr(1);function r(h){for(var c=0;c<h.length&&h[c]==="";c++);for(var u=h.length-1;u>=0&&h[u]==="";u--);return c>u?[]:h.slice(c,u-c+1)}for(var n=r(e.split("/")),i=r(t.split("/")),s=Math.min(n.length,i.length),a=s,o=0;o<s;o++)if(n[o]!==i[o]){a=o;break}for(var l=[],o=a;o<n.length;o++)l.push("..");return l=l.concat(i.slice(a)),l.join("/")}function Kr(e){var t=Lt(e),r=t[0],n=t[1];return!r&&!n?".":(n&&(n=n.substr(0,n.length-1)),r+n)}function Xr(e,t){var r=Lt(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r}function Wr(e){return Lt(e)[3]}function It(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}var ps,Lt,Yr,qr,vs,ds,Zr=Di(()=>{ps=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,Lt=function(e){return ps.exec(e).slice(1)};Yr="/",qr=":";vs={extname:Wr,basename:Xr,dirname:Kr,sep:Yr,delimiter:qr,relative:Gr,join:Vr,isAbsolute:Ct,normalize:Nt,resolve:Ge};ds="ab".substr(-1)==="b"?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)}});var qe=me((Jh,Ye)=>{var de=(Zr(),$r);de&&de.default?Ye.exports=de.default:de&&(Ye.exports=de);if(de)for(let e in de)Ye.exports[e]=de[e]});var Ie=me((ec,Qr)=>{"use strict";var ms=qe(),he="\\\\/",Jr=`[^${he}]`,ue="\\.",xs="\\+",_s="\\?",Ke="\\/",gs="(?=.)",en="[^/]",Ot=`(?:${Ke}|$)`,tn=`(?:^|${Ke})`,Pt=`${ue}{1,2}${Ot}`,ys=`(?!${ue})`,As=`(?!${tn}${Pt})`,Es=`(?!${ue}{0,1}${Ot})`,Ms=`(?!${Pt})`,ws=`[^.${Ke}]`,bs=`${en}*?`,rn={DOT_LITERAL:ue,PLUS_LITERAL:xs,QMARK_LITERAL:_s,SLASH_LITERAL:Ke,ONE_CHAR:gs,QMARK:en,END_ANCHOR:Ot,DOTS_SLASH:Pt,NO_DOT:ys,NO_DOTS:As,NO_DOT_SLASH:Es,NO_DOTS_SLASH:Ms,QMARK_NO_DOT:ws,STAR:bs,START_ANCHOR:tn},Ts={...rn,SLASH_LITERAL:`[${he}]`,QMARK:Jr,STAR:`${Jr}*?`,DOTS_SLASH:`${ue}{1,2}(?:[${he}]|$)`,NO_DOT:`(?!${ue})`,NO_DOTS:`(?!(?:^|[${he}])${ue}{1,2}(?:[${he}]|$))`,NO_DOT_SLASH:`(?!${ue}{0,1}(?:[${he}]|$))`,NO_DOTS_SLASH:`(?!${ue}{1,2}(?:[${he}]|$))`,QMARK_NO_DOT:`[^.${he}]`,START_ANCHOR:`(?:^|[${he}])`,END_ANCHOR:`(?:[${he}]|$)`},Ss={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};Qr.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:Ss,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:ms.sep,extglobChars(e){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${e.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(e){return e===!0?Ts:rn}}});var Xe=me(J=>{"use strict";var Rs=qe(),Ls=!1,{REGEX_BACKSLASH:Is,REGEX_REMOVE_BACKSLASH:Cs,REGEX_SPECIAL_CHARS:Ns,REGEX_SPECIAL_CHARS_GLOBAL:Os}=Ie();J.isObject=e=>e!==null&&typeof e=="object"&&!Array.isArray(e);J.hasRegexChars=e=>Ns.test(e);J.isRegexChar=e=>e.length===1&&J.hasRegexChars(e);J.escapeRegex=e=>e.replace(Os,"\\$1");J.toPosixSlashes=e=>e.replace(Is,"/");J.removeBackslashes=e=>e.replace(Cs,t=>t==="\\"?"":t);J.supportsLookbehinds=()=>{let e=process.version.slice(1).split(".").map(Number);return e.length===3&&e[0]>=9||e[0]===8&&e[1]>=10};J.isWindows=e=>e&&typeof e.windows=="boolean"?e.windows:Ls===!0||Rs.sep==="\\";J.escapeLast=(e,t,r)=>{let n=e.lastIndexOf(t,r);return n===-1?e:e[n-1]==="\\"?J.escapeLast(e,t,n-1):`${e.slice(0,n)}\\${e.slice(n)}`};J.removePrefix=(e,t={})=>{let r=e;return r.startsWith("./")&&(r=r.slice(2),t.prefix="./"),r};J.wrapOutput=(e,t={},r={})=>{let n=r.contains?"":"^",i=r.contains?"":"$",s=`${n}(?:${e})${i}`;return t.negated===!0&&(s=`(?:^(?!${s}).*$)`),s}});var un=me((rc,nn)=>{"use strict";var sn=Xe(),{CHAR_ASTERISK:Ft,CHAR_AT:Ps,CHAR_BACKWARD_SLASH:Ce,CHAR_COMMA:Fs,CHAR_DOT:Bt,CHAR_EXCLAMATION_MARK:Dt,CHAR_FORWARD_SLASH:an,CHAR_LEFT_CURLY_BRACE:Ut,CHAR_LEFT_PARENTHESES:kt,CHAR_LEFT_SQUARE_BRACKET:Bs,CHAR_PLUS:Ds,CHAR_QUESTION_MARK:on,CHAR_RIGHT_CURLY_BRACE:Us,CHAR_RIGHT_PARENTHESES:ln,CHAR_RIGHT_SQUARE_BRACKET:ks}=Ie(),hn=e=>e===an||e===Ce,cn=e=>{e.isPrefix!==!0&&(e.depth=e.isGlobstar?Infinity:1)},zs=(e,t)=>{let r=t||{},n=e.length-1,i=r.parts===!0||r.scanToEnd===!0,s=[],a=[],o=[],l=e,h=-1,c=0,u=0,f=!1,d=!1,v=!1,m=!1,p=!1,y=!1,L=!1,A=!1,w=!1,b=!1,S=0,I,E,M={value:"",depth:0,isGlob:!1},P=()=>h>=n,g=()=>l.charCodeAt(h+1),N=()=>(I=E,l.charCodeAt(++h));for(;h<n;){E=N();let j;if(E===Ce){L=M.backslashes=!0,E=N(),E===Ut&&(y=!0);continue}if(y===!0||E===Ut){for(S++;P()!==!0&&(E=N());){if(E===Ce){L=M.backslashes=!0,N();continue}if(E===Ut){S++;continue}if(y!==!0&&E===Bt&&(E=N())===Bt){if(f=M.isBrace=!0,v=M.isGlob=!0,b=!0,i===!0)continue;break}if(y!==!0&&E===Fs){if(f=M.isBrace=!0,v=M.isGlob=!0,b=!0,i===!0)continue;break}if(E===Us&&(S--,S===0)){y=!1,f=M.isBrace=!0,b=!0;break}}if(i===!0)continue;break}if(E===an){if(s.push(h),a.push(M),M={value:"",depth:0,isGlob:!1},b===!0)continue;if(I===Bt&&h===c+1){c+=2;continue}u=h+1;continue}if(r.noext!==!0&&(E===Ds||E===Ps||E===Ft||E===on||E===Dt)===!0&&g()===kt){if(v=M.isGlob=!0,m=M.isExtglob=!0,b=!0,E===Dt&&h===c&&(w=!0),i===!0){for(;P()!==!0&&(E=N());){if(E===Ce){L=M.backslashes=!0,E=N();continue}if(E===ln){v=M.isGlob=!0,b=!0;break}}continue}break}if(E===Ft){if(I===Ft&&(p=M.isGlobstar=!0),v=M.isGlob=!0,b=!0,i===!0)continue;break}if(E===on){if(v=M.isGlob=!0,b=!0,i===!0)continue;break}if(E===Bs){for(;P()!==!0&&(j=N());){if(j===Ce){L=M.backslashes=!0,N();continue}if(j===ks){d=M.isBracket=!0,v=M.isGlob=!0,b=!0;break}}if(i===!0)continue;break}if(r.nonegate!==!0&&E===Dt&&h===c){A=M.negated=!0,c++;continue}if(r.noparen!==!0&&E===kt){if(v=M.isGlob=!0,i===!0){for(;P()!==!0&&(E=N());){if(E===kt){L=M.backslashes=!0,E=N();continue}if(E===ln){b=!0;break}}continue}break}if(v===!0){if(b=!0,i===!0)continue;break}}r.noext===!0&&(m=!1,v=!1);let C=l,O="",x="";c>0&&(O=l.slice(0,c),l=l.slice(c),u-=c),C&&v===!0&&u>0?(C=l.slice(0,u),x=l.slice(u)):v===!0?(C="",x=l):C=l,C&&C!==""&&C!=="/"&&C!==l&&hn(C.charCodeAt(C.length-1))&&(C=C.slice(0,-1)),r.unescape===!0&&(x&&(x=sn.removeBackslashes(x)),C&&L===!0&&(C=sn.removeBackslashes(C)));let _={prefix:O,input:e,start:c,base:C,glob:x,isBrace:f,isBracket:d,isGlob:v,isExtglob:m,isGlobstar:p,negated:A,negatedExtglob:w};if(r.tokens===!0&&(_.maxDepth=0,hn(E)||a.push(M),_.tokens=a),r.parts===!0||r.tokens===!0){let j;for(let U=0;U<s.length;U++){let K=j?j+1:c,X=s[U],W=e.slice(K,X);r.tokens&&(U===0&&c!==0?(a[U].isPrefix=!0,a[U].value=O):a[U].value=W,cn(a[U]),_.maxDepth+=a[U].depth),(U!==0||W!=="")&&o.push(W),j=X}if(j&&j+1<e.length){let U=e.slice(j+1);o.push(U),r.tokens&&(a[a.length-1].value=U,cn(a[a.length-1]),_.maxDepth+=a[a.length-1].depth)}_.slashes=s,_.parts=o}return _};nn.exports=zs});var vn=me((nc,fn)=>{"use strict";var We=Ie(),te=Xe(),{MAX_LENGTH:Ze,POSIX_REGEX_SOURCE:Hs,REGEX_NON_SPECIAL_CHARS:$s,REGEX_SPECIAL_CHARS_BACKREF:js,REPLACEMENTS:pn}=We,Vs=(e,t)=>{if(typeof t.expandRange=="function")return t.expandRange(...e,t);e.sort();let r=`[${e.join("-")}]`;try{new RegExp(r)}catch(n){return e.map(i=>te.escapeRegex(i)).join("..")}return r},Ae=(e,t)=>`Missing ${e}: "${t}" - use "\\\\${t}" to match literal characters`,dn=(e,t)=>{if(typeof e!="string")throw new TypeError("Expected a string");e=pn[e]||e;let r={...t},n=typeof r.maxLength=="number"?Math.min(Ze,r.maxLength):Ze,i=e.length;if(i>n)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${n}`);let s={type:"bos",value:"",output:r.prepend||""},a=[s],o=r.capture?"":"?:",l=te.isWindows(t),h=We.globChars(l),c=We.extglobChars(h),{DOT_LITERAL:u,PLUS_LITERAL:f,SLASH_LITERAL:d,ONE_CHAR:v,DOTS_SLASH:m,NO_DOT:p,NO_DOT_SLASH:y,NO_DOTS_SLASH:L,QMARK:A,QMARK_NO_DOT:w,STAR:b,START_ANCHOR:S}=h,I=R=>`(${o}(?:(?!${S}${R.dot?m:u}).)*?)`,E=r.dot?"":p,M=r.dot?A:w,P=r.bash===!0?I(r):b;r.capture&&(P=`(${P})`),typeof r.noext=="boolean"&&(r.noextglob=r.noext);let g={input:e,index:-1,start:0,dot:r.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:a};e=te.removePrefix(e,g),i=e.length;let N=[],C=[],O=[],x=s,_,j=()=>g.index===i-1,U=g.peek=(R=1)=>e[g.index+R],K=g.advance=()=>e[++g.index]||"",X=()=>e.slice(g.index+1),W=(R="",H=0)=>{g.consumed+=R,g.index+=H},se=R=>{g.output+=R.output!=null?R.output:R.value,W(R.value)},Te=()=>{let R=1;for(;U()==="!"&&(U(2)!=="("||U(3)==="?");)K(),g.start++,R++;return R%2==0?!1:(g.negated=!0,g.start++,!0)},pe=R=>{g[R]++,O.push(R)},ae=R=>{g[R]--,O.pop()},F=R=>{if(x.type==="globstar"){let H=g.braces>0&&(R.type==="comma"||R.type==="brace"),T=R.extglob===!0||N.length&&(R.type==="pipe"||R.type==="paren");R.type!=="slash"&&R.type!=="paren"&&!H&&!T&&(g.output=g.output.slice(0,-x.output.length),x.type="star",x.value="*",x.output=P,g.output+=x.output)}if(N.length&&R.type!=="paren"&&(N[N.length-1].inner+=R.value),(R.value||R.output)&&se(R),x&&x.type==="text"&&R.type==="text"){x.value+=R.value,x.output=(x.output||"")+R.value;return}R.prev=x,a.push(R),x=R},ve=(R,H)=>{let T={...c[H],conditions:1,inner:""};T.prev=x,T.parens=g.parens,T.output=g.output;let B=(r.capture?"(":"")+T.open;pe("parens"),F({type:R,value:H,output:g.output?"":v}),F({type:"paren",extglob:!0,value:K(),output:B}),N.push(T)},Be=R=>{let H=R.close+(r.capture?")":""),T;if(R.type==="negate"){let B=P;R.inner&&R.inner.length>1&&R.inner.includes("/")&&(B=I(r)),(B!==P||j()||/^\)+$/.test(X()))&&(H=R.close=`)$))${B}`),R.inner.includes("*")&&(T=X())&&/^\.[^\\/.]+$/.test(T)&&(H=R.close=`)${T})${B})`),R.prev.type==="bos"&&(g.negatedExtglob=!0)}F({type:"paren",extglob:!0,value:_,output:H}),ae("parens")};if(r.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(e)){let R=!1,H=e.replace(js,(T,B,V,Q,q,ut)=>Q==="\\"?(R=!0,T):Q==="?"?B?B+Q+(q?A.repeat(q.length):""):ut===0?M+(q?A.repeat(q.length):""):A.repeat(V.length):Q==="."?u.repeat(V.length):Q==="*"?B?B+Q+(q?P:""):P:B?T:`\\${T}`);return R===!0&&(r.unescape===!0?H=H.replace(/\\/g,""):H=H.replace(/\\+/g,T=>T.length%2==0?"\\\\":T?"\\":"")),H===e&&r.contains===!0?(g.output=e,g):(g.output=te.wrapOutput(H,g,t),g)}for(;!j();){if(_=K(),_==="\0")continue;if(_==="\\"){let T=U();if(T==="/"&&r.bash!==!0||T==="."||T===";")continue;if(!T){_+="\\",F({type:"text",value:_});continue}let B=/^\\+/.exec(X()),V=0;if(B&&B[0].length>2&&(V=B[0].length,g.index+=V,V%2!=0&&(_+="\\")),r.unescape===!0?_=K():_+=K(),g.brackets===0){F({type:"text",value:_});continue}}if(g.brackets>0&&(_!=="]"||x.value==="["||x.value==="[^")){if(r.posix!==!1&&_===":"){let T=x.value.slice(1);if(T.includes("[")&&(x.posix=!0,T.includes(":"))){let B=x.value.lastIndexOf("["),V=x.value.slice(0,B),Q=x.value.slice(B+2),q=Hs[Q];if(q){x.value=V+q,g.backtrack=!0,K(),!s.output&&a.indexOf(x)===1&&(s.output=v);continue}}}(_==="["&&U()!==":"||_==="-"&&U()==="]")&&(_=`\\${_}`),_==="]"&&(x.value==="["||x.value==="[^")&&(_=`\\${_}`),r.posix===!0&&_==="!"&&x.value==="["&&(_="^"),x.value+=_,se({value:_});continue}if(g.quotes===1&&_!=='"'){_=te.escapeRegex(_),x.value+=_,se({value:_});continue}if(_==='"'){g.quotes=g.quotes===1?0:1,r.keepQuotes===!0&&F({type:"text",value:_});continue}if(_==="("){pe("parens"),F({type:"paren",value:_});continue}if(_===")"){if(g.parens===0&&r.strictBrackets===!0)throw new SyntaxError(Ae("opening","("));let T=N[N.length-1];if(T&&g.parens===T.parens+1){Be(N.pop());continue}F({type:"paren",value:_,output:g.parens?")":"\\)"}),ae("parens");continue}if(_==="["){if(r.nobracket===!0||!X().includes("]")){if(r.nobracket!==!0&&r.strictBrackets===!0)throw new SyntaxError(Ae("closing","]"));_=`\\${_}`}else pe("brackets");F({type:"bracket",value:_});continue}if(_==="]"){if(r.nobracket===!0||x&&x.type==="bracket"&&x.value.length===1){F({type:"text",value:_,output:`\\${_}`});continue}if(g.brackets===0){if(r.strictBrackets===!0)throw new SyntaxError(Ae("opening","["));F({type:"text",value:_,output:`\\${_}`});continue}ae("brackets");let T=x.value.slice(1);if(x.posix!==!0&&T[0]==="^"&&!T.includes("/")&&(_=`/${_}`),x.value+=_,se({value:_}),r.literalBrackets===!1||te.hasRegexChars(T))continue;let B=te.escapeRegex(x.value);if(g.output=g.output.slice(0,-x.value.length),r.literalBrackets===!0){g.output+=B,x.value=B;continue}x.value=`(${o}${B}|${x.value})`,g.output+=x.value;continue}if(_==="{"&&r.nobrace!==!0){pe("braces");let T={type:"brace",value:_,output:"(",outputIndex:g.output.length,tokensIndex:g.tokens.length};C.push(T),F(T);continue}if(_==="}"){let T=C[C.length-1];if(r.nobrace===!0||!T){F({type:"text",value:_,output:_});continue}let B=")";if(T.dots===!0){let V=a.slice(),Q=[];for(let q=V.length-1;q>=0&&(a.pop(),V[q].type!=="brace");q--)V[q].type!=="dots"&&Q.unshift(V[q].value);B=Vs(Q,r),g.backtrack=!0}if(T.comma!==!0&&T.dots!==!0){let V=g.output.slice(0,T.outputIndex),Q=g.tokens.slice(T.tokensIndex);T.value=T.output="\\{",_=B="\\}",g.output=V;for(let q of Q)g.output+=q.output||q.value}F({type:"brace",value:_,output:B}),ae("braces"),C.pop();continue}if(_==="|"){N.length>0&&N[N.length-1].conditions++,F({type:"text",value:_});continue}if(_===","){let T=_,B=C[C.length-1];B&&O[O.length-1]==="braces"&&(B.comma=!0,T="|"),F({type:"comma",value:_,output:T});continue}if(_==="/"){if(x.type==="dot"&&g.index===g.start+1){g.start=g.index+1,g.consumed="",g.output="",a.pop(),x=s;continue}F({type:"slash",value:_,output:d});continue}if(_==="."){if(g.braces>0&&x.type==="dot"){x.value==="."&&(x.output=u);let T=C[C.length-1];x.type="dots",x.output+=_,x.value+=_,T.dots=!0;continue}if(g.braces+g.parens===0&&x.type!=="bos"&&x.type!=="slash"){F({type:"text",value:_,output:u});continue}F({type:"dot",value:_,output:u});continue}if(_==="?"){if(!(x&&x.value==="(")&&r.noextglob!==!0&&U()==="("&&U(2)!=="?"){ve("qmark",_);continue}if(x&&x.type==="paren"){let B=U(),V=_;if(B==="<"&&!te.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(x.value==="("&&!/[!=<:]/.test(B)||B==="<"&&!/<([!=]|\w+>)/.test(X()))&&(V=`\\${_}`),F({type:"text",value:_,output:V});continue}if(r.dot!==!0&&(x.type==="slash"||x.type==="bos")){F({type:"qmark",value:_,output:w});continue}F({type:"qmark",value:_,output:A});continue}if(_==="!"){if(r.noextglob!==!0&&U()==="("&&(U(2)!=="?"||!/[!=<:]/.test(U(3)))){ve("negate",_);continue}if(r.nonegate!==!0&&g.index===0){Te();continue}}if(_==="+"){if(r.noextglob!==!0&&U()==="("&&U(2)!=="?"){ve("plus",_);continue}if(x&&x.value==="("||r.regex===!1){F({type:"plus",value:_,output:f});continue}if(x&&(x.type==="bracket"||x.type==="paren"||x.type==="brace")||g.parens>0){F({type:"plus",value:_});continue}F({type:"plus",value:f});continue}if(_==="@"){if(r.noextglob!==!0&&U()==="("&&U(2)!=="?"){F({type:"at",extglob:!0,value:_,output:""});continue}F({type:"text",value:_});continue}if(_!=="*"){(_==="$"||_==="^")&&(_=`\\${_}`);let T=$s.exec(X());T&&(_+=T[0],g.index+=T[0].length),F({type:"text",value:_});continue}if(x&&(x.type==="globstar"||x.star===!0)){x.type="star",x.star=!0,x.value+=_,x.output=P,g.backtrack=!0,g.globstar=!0,W(_);continue}let R=X();if(r.noextglob!==!0&&/^\([^?]/.test(R)){ve("star",_);continue}if(x.type==="star"){if(r.noglobstar===!0){W(_);continue}let T=x.prev,B=T.prev,V=T.type==="slash"||T.type==="bos",Q=B&&(B.type==="star"||B.type==="globstar");if(r.bash===!0&&(!V||R[0]&&R[0]!=="/")){F({type:"star",value:_,output:""});continue}let q=g.braces>0&&(T.type==="comma"||T.type==="brace"),ut=N.length&&(T.type==="pipe"||T.type==="paren");if(!V&&T.type!=="paren"&&!q&&!ut){F({type:"star",value:_,output:""});continue}for(;R.slice(0,3)==="/**";){let De=e[g.index+4];if(De&&De!=="/")break;R=R.slice(3),W("/**",3)}if(T.type==="bos"&&j()){x.type="globstar",x.value+=_,x.output=I(r),g.output=x.output,g.globstar=!0,W(_);continue}if(T.type==="slash"&&T.prev.type!=="bos"&&!Q&&j()){g.output=g.output.slice(0,-(T.output+x.output).length),T.output=`(?:${T.output}`,x.type="globstar",x.output=I(r)+(r.strictSlashes?")":"|$)"),x.value+=_,g.globstar=!0,g.output+=T.output+x.output,W(_);continue}if(T.type==="slash"&&T.prev.type!=="bos"&&R[0]==="/"){let De=R[1]!==void 0?"|$":"";g.output=g.output.slice(0,-(T.output+x.output).length),T.output=`(?:${T.output}`,x.type="globstar",x.output=`${I(r)}${d}|${d}${De})`,x.value+=_,g.output+=T.output+x.output,g.globstar=!0,W(_+K()),F({type:"slash",value:"/",output:""});continue}if(T.type==="bos"&&R[0]==="/"){x.type="globstar",x.value+=_,x.output=`(?:^|${d}|${I(r)}${d})`,g.output=x.output,g.globstar=!0,W(_+K()),F({type:"slash",value:"/",output:""});continue}g.output=g.output.slice(0,-x.output.length),x.type="globstar",x.output=I(r),x.value+=_,g.output+=x.output,g.globstar=!0,W(_);continue}let H={type:"star",value:_,output:P};if(r.bash===!0){H.output=".*?",(x.type==="bos"||x.type==="slash")&&(H.output=E+H.output),F(H);continue}if(x&&(x.type==="bracket"||x.type==="paren")&&r.regex===!0){H.output=_,F(H);continue}(g.index===g.start||x.type==="slash"||x.type==="dot")&&(x.type==="dot"?(g.output+=y,x.output+=y):r.dot===!0?(g.output+=L,x.output+=L):(g.output+=E,x.output+=E),U()!=="*"&&(g.output+=v,x.output+=v)),F(H)}for(;g.brackets>0;){if(r.strictBrackets===!0)throw new SyntaxError(Ae("closing","]"));g.output=te.escapeLast(g.output,"["),ae("brackets")}for(;g.parens>0;){if(r.strictBrackets===!0)throw new SyntaxError(Ae("closing",")"));g.output=te.escapeLast(g.output,"("),ae("parens")}for(;g.braces>0;){if(r.strictBrackets===!0)throw new SyntaxError(Ae("closing","}"));g.output=te.escapeLast(g.output,"{"),ae("braces")}if(r.strictSlashes!==!0&&(x.type==="star"||x.type==="bracket")&&F({type:"maybe_slash",value:"",output:`${d}?`}),g.backtrack===!0){g.output="";for(let R of g.tokens)g.output+=R.output!=null?R.output:R.value,R.suffix&&(g.output+=R.suffix)}return g};dn.fastpaths=(e,t)=>{let r={...t},n=typeof r.maxLength=="number"?Math.min(Ze,r.maxLength):Ze,i=e.length;if(i>n)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${n}`);e=pn[e]||e;let s=te.isWindows(t),{DOT_LITERAL:a,SLASH_LITERAL:o,ONE_CHAR:l,DOTS_SLASH:h,NO_DOT:c,NO_DOTS:u,NO_DOTS_SLASH:f,STAR:d,START_ANCHOR:v}=We.globChars(s),m=r.dot?u:c,p=r.dot?f:c,y=r.capture?"":"?:",L={negated:!1,prefix:""},A=r.bash===!0?".*?":d;r.capture&&(A=`(${A})`);let w=E=>E.noglobstar===!0?A:`(${y}(?:(?!${v}${E.dot?h:a}).)*?)`,b=E=>{switch(E){case"*":return`${m}${l}${A}`;case".*":return`${a}${l}${A}`;case"*.*":return`${m}${A}${a}${l}${A}`;case"*/*":return`${m}${A}${o}${l}${p}${A}`;case"**":return m+w(r);case"**/*":return`(?:${m}${w(r)}${o})?${p}${l}${A}`;case"**/*.*":return`(?:${m}${w(r)}${o})?${p}${A}${a}${l}${A}`;case"**/.*":return`(?:${m}${w(r)}${o})?${a}${l}${A}`;default:{let M=/^(.*?)\.(\w+)$/.exec(E);if(!M)return;let P=b(M[1]);return P?P+a+M[2]:void 0}}},S=te.removePrefix(e,L),I=b(S);return I&&r.strictSlashes!==!0&&(I+=`${o}?`),I};fn.exports=dn});var xn=me((ic,mn)=>{"use strict";var Gs=qe(),Ys=un(),zt=vn(),Ht=Xe(),qs=Ie(),Ks=e=>e&&typeof e=="object"&&!Array.isArray(e),G=(e,t,r=!1)=>{if(Array.isArray(e)){let c=e.map(f=>G(f,t,r));return f=>{for(let d of c){let v=d(f);if(v)return v}return!1}}let n=Ks(e)&&e.tokens&&e.input;if(e===""||typeof e!="string"&&!n)throw new TypeError("Expected pattern to be a non-empty string");let i=t||{},s=Ht.isWindows(t),a=n?G.compileRe(e,t):G.makeRe(e,t,!1,!0),o=a.state;delete a.state;let l=()=>!1;if(i.ignore){let c={...t,ignore:null,onMatch:null,onResult:null};l=G(i.ignore,c,r)}let h=(c,u=!1)=>{let{isMatch:f,match:d,output:v}=G.test(c,a,t,{glob:e,posix:s}),m={glob:e,state:o,regex:a,posix:s,input:c,output:v,match:d,isMatch:f};return typeof i.onResult=="function"&&i.onResult(m),f===!1?(m.isMatch=!1,u?m:!1):l(c)?(typeof i.onIgnore=="function"&&i.onIgnore(m),m.isMatch=!1,u?m:!1):(typeof i.onMatch=="function"&&i.onMatch(m),u?m:!0)};return r&&(h.state=o),h};G.test=(e,t,r,{glob:n,posix:i}={})=>{if(typeof e!="string")throw new TypeError("Expected input to be a string");if(e==="")return{isMatch:!1,output:""};let s=r||{},a=s.format||(i?Ht.toPosixSlashes:null),o=e===n,l=o&&a?a(e):e;return o===!1&&(l=a?a(e):e,o=l===n),(o===!1||s.capture===!0)&&(s.matchBase===!0||s.basename===!0?o=G.matchBase(e,t,r,i):o=t.exec(l)),{isMatch:Boolean(o),match:o,output:l}};G.matchBase=(e,t,r,n=Ht.isWindows(r))=>(t instanceof RegExp?t:G.makeRe(t,r)).test(Gs.basename(e));G.isMatch=(e,t,r)=>G(t,r)(e);G.parse=(e,t)=>Array.isArray(e)?e.map(r=>G.parse(r,t)):zt(e,{...t,fastpaths:!1});G.scan=(e,t)=>Ys(e,t);G.compileRe=(e,t,r=!1,n=!1)=>{if(r===!0)return e.output;let i=t||{},s=i.contains?"":"^",a=i.contains?"":"$",o=`${s}(?:${e.output})${a}`;e&&e.negated===!0&&(o=`^(?!${o}).*$`);let l=G.toRegex(o,t);return n===!0&&(l.state=e),l};G.makeRe=(e,t={},r=!1,n=!1)=>{if(!e||typeof e!="string")throw new TypeError("Expected a non-empty string");let i={negated:!1,fastpaths:!0};return t.fastpaths!==!1&&(e[0]==="."||e[0]==="*")&&(i.output=zt.fastpaths(e,t)),i.output||(i=zt(e,t)),G.compileRe(i,t,r,n)};G.toRegex=(e,t)=>{try{let r=t||{};return new RegExp(e,r.flags||(r.nocase?"i":""))}catch(r){if(t&&t.debug===!0)throw r;return/$^/}};G.constants=qs;mn.exports=G});var gn=me((sc,_n)=>{"use strict";_n.exports=xn()});var zi=`<div class="container">
    <label class="hidden" id="title">display-port</label>
    <label class="hidden" id="fps">00</label>
    <label class="hidden" id="dimension">0x0</label>
    <div class="content">
        <canvas>
            Oh no! Your browser does not support canvas.
        </canvas>
        <slot id="inner"></slot>
    </div>
    <slot name="frame"></slot>
</div>`,Hi=`:host {
    display: inline-block;
    color: #555555;
}

.container {
    display: flex;
    position: relative;
    width: 100%;
    height: 100%;
}

.content {
    position: relative;
    margin: auto;
}

.content > * {
    width: 100%;
    height: 100%;
}

canvas {
    background: #000000;
    image-rendering: pixelated;
}

label {
    position: absolute;
    font-family: monospace;
    color: currentColor;
}

#inner {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    pointer-events: none;
}

#title {
    left: 0.5rem;
    top: 0.5rem;
}

#fps {
    right: 0.5rem;
    top: 0.5rem;
}

#dimension {
    left: 0.5rem;
    bottom: 0.5rem;
}

.hidden {
    display: none;
}

:host([debug]) .container {
    outline: 6px dashed rgba(0, 0, 0, 0.1);
    outline-offset: -4px;
    background-color: rgba(0, 0, 0, 0.1);
}

:host([mode="noscale"]) canvas {
    margin: 0;
    top: 0;
    left: 0;
}

:host([mode="fit"]),
:host([mode="scale"]),
:host([mode="center"]),
:host([mode="stretch"]),
:host([mode="fill"]) {
    width: 100%;
    height: 100%;
}

:host([full]) {
    width: 100vw !important;
    height: 100vh !important;
}

:host([disabled]) {
    display: none;
}

slot {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    pointer-events: none;
}

::slotted(*) {
    pointer-events: auto;
}
`,dr="noscale",ft="fit",vr="scale",mr="fill",xr="stretch",$i=300,ji=150,Vi=ft,_r=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=zi,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Hi,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("display-port",this)}static get observedAttributes(){return["debug","disabled","width","height","onframe","id","class"]}get mode(){return this.getAttribute("mode")}set mode(t){this.setAttribute("mode",t)}get debug(){return this._debug}set debug(t){this.toggleAttribute("debug",t)}get disabled(){return this._disabled}set disabled(t){this.toggleAttribute("disabled",t)}get width(){return this._width}set width(t){this.setAttribute("width",String(t))}get height(){return this._height}set height(t){this.setAttribute("height",String(t))}get onframe(){return this._onframe}set onframe(t){this._onframe&&this.removeEventListener("frame",this._onframe),this._onframe=t,this._onframe&&this.addEventListener("frame",t)}constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._canvasElement=this.shadowRoot.querySelector("canvas"),this._contentElement=this.shadowRoot.querySelector(".content"),this._innerElement=this.shadowRoot.querySelector("#inner"),this._titleElement=this.shadowRoot.querySelector("#title"),this._fpsElement=this.shadowRoot.querySelector("#fps"),this._dimensionElement=this.shadowRoot.querySelector("#dimension"),this._debug=!1,this._disabled=!1,this._width=$i,this._height=ji,this._onframe=void 0,this._animationRequestHandle=0,this._prevAnimationFrameTime=0,this.update=this.update.bind(this)}get canvas(){return this._canvasElement}connectedCallback(){ge(this,"mode"),ge(this,"debug"),ge(this,"disabled"),ge(this,"width"),ge(this,"height"),ge(this,"onframe"),this.hasAttribute("mode")||this.setAttribute("mode",Vi),this.hasAttribute("tabindex")||this.setAttribute("tabindex","0"),this.updateCanvasSize(),this.resume()}disconnectedCallback(){this.pause()}attributeChangedCallback(t,r,n){switch(t){case"debug":this._debug=n!==null;break;case"disabled":this._disabled=n!==null;break;case"width":this._width=Number(n);break;case"height":this._height=Number(n);break;case"onframe":this.onframe=new Function("event","with(document){with(this){"+n+"}}").bind(this);break}switch(t){case"disabled":n?(this.update(0),this.pause()):this.resume();break;case"id":case"class":this._titleElement.innerHTML=`display-port${this.className?"."+this.className:""}${this.hasAttribute("id")?"#"+this.getAttribute("id"):""}`;break;case"debug":this._titleElement.classList.toggle("hidden",n),this._fpsElement.classList.toggle("hidden",n),this._dimensionElement.classList.toggle("hidden",n);break}}getContext(t="2d",r=void 0){return this._canvasElement.getContext(t,r)}pause(){cancelAnimationFrame(this._animationRequestHandle)}resume(){this._animationRequestHandle=requestAnimationFrame(this.update)}update(t){this._animationRequestHandle=requestAnimationFrame(this.update),this.updateCanvasSize();let r=t-this._prevAnimationFrameTime;if(this._prevAnimationFrameTime=t,this._debug){let n=r<=0?"--":String(Math.round(1e3/r)).padStart(2,"0");if(this._fpsElement.textContent!==n&&(this._fpsElement.textContent=n),this.mode===dr){let s=`${this._width}x${this._height}`;this._dimensionElement.textContent!==s&&(this._dimensionElement.textContent=s)}else{let s=`${this._width}x${this._height}|${this.shadowRoot.host.clientWidth}x${this.shadowRoot.host.clientHeight}`;this._dimensionElement.textContent!==s&&(this._dimensionElement.textContent=s)}}this.dispatchEvent(new CustomEvent("frame",{detail:{now:t,prevTime:this._prevAnimationFrameTime,deltaTime:r,canvas:this._canvasElement},bubbles:!1,composed:!0}))}updateCanvasSize(){let t=this.shadowRoot.host.getBoundingClientRect(),r=t.width,n=t.height,i=this._canvasElement,s=this._width,a=this._height,o=this.mode;if(o===xr||o===mr)s=r,a=n;else if(o!==dr&&(r<s||n<a||o===ft||o==vr)){let h=r/s,c=n/a;h<c?(s=r,a=a*h):(s=s*c,a=n)}s=Math.floor(s),a=Math.floor(a);let l=Math.min(s/this._width,a/this._height)*.5;if(this._innerElement.style.fontSize=`font-size: ${l}em`,i.clientWidth!==s||i.clientHeight!==a){o===vr||o===xr?(i.width=this._width,i.height=this._height):(i.width=s,i.height=a);let h=this._contentElement.style;h.width=`${s}px`,h.height=`${a}px`,(o===ft||o===mr)&&(this._width=s,this._height=a),this.dispatchEvent(new CustomEvent("resize",{detail:{width:s,height:a},bubbles:!1,composed:!0}))}}};_r.define();function ge(e,t){if(Object.prototype.hasOwnProperty.call(e,t)){let r=e[t];delete e[t],e[t]=r}}var pt=class{get polling(){return performance.now()-this._lastPollingTime<1e3}get value(){return 0}get size(){return this._size}constructor(t){this._size=t,this._lastPollingTime=Number.MIN_SAFE_INTEGER}resize(t){this._size=t}getState(t){throw new Error("Missing implementation.")}onUpdate(t,r,n){throw new Error("Missing implementation.")}onStatus(t,r){throw new Error("Missing implementation.")}onPoll(t){this._lastPollingTime=t}onBind(t,r={}){t>=this._size&&this.resize(t+1)}onUnbind(){this.resize(0)}},Se=class extends pt{static createAxisBindingState(){return{value:0,delta:0,inverted:!1}}get delta(){return this._delta}get value(){return this._value}constructor(t=0){super(t);let r=new Array;for(let n=0;n<t;++n)r.push(this.constructor.createAxisBindingState());this._state=r,this._value=0,this._delta=0}resize(t){let r=this._state,n=r.length,i;if(t<=n)i=r.slice(0,t);else{i=r;for(let s=n;s<t;++s)i.push(this.constructor.createAxisBindingState())}this._state=i,super.resize(t)}getState(t){return this._state[t].value}onPoll(t){let r=this._state,n=0,i=0,s=r.length;for(let a=0;a<s;++a){let o=r[a];n+=o.value*(o.inverted?-1:1),i+=o.delta,r[a].delta=0}this._value=n,this._delta=i,super.onPoll(t)}onUpdate(t,r,n){typeof r=="undefined"?this.onAxisChange(t,n):this.onAxisMove(t,r,n)}onStatus(t,r){this.onAxisStatus(t,r)}onBind(t,r={}){super.onBind(t,r);let{inverted:n=!1}=r,i=this._state;i[t].inverted=n}onAxisMove(t,r,n){let i=this._state[t];i.value=r,i.delta+=n}onAxisChange(t,r){let n=this._state[t];n.value+=r,n.delta+=r}onAxisStatus(t,r){let n=this._state[t],i=n.value;n.value=r,n.delta=r-i}},Gi=241,gr=254,Yi=239,xe=1,dt=2,vt=4,mt=8,xt=16,ke=class extends pt{get pressed(){return this._pressed}get repeated(){return this._repeated}get released(){return this._released}get down(){return this._down}get value(){return this._value}constructor(t=0){super(t);this._state=new Uint8Array(t),this._value=0,this._down=!1,this._pressed=!1,this._repeated=!1,this._released=!1}resize(t){let r=this._state,n=r.length,i;t<=n?i=r.slice(0,t):(i=new Uint8Array(t),i.set(r)),this._state=i,super.resize(t)}getState(t){let r=this._state[t],n=r&xt?-1:1;return(r&xe?1:0)*n}onPoll(t){let r=this._state,n=0,i=0,s=0,a=0,o=0,l=r.length;for(let h=0;h<l;++h){let c=r[h],u=c&xe,f=c&xt;i|=u,s|=c&dt,a|=c&vt,o|=c&mt,n+=(u?1:0)*(f?-1:1),r[h]&=Gi}this._value=n,this._down=i!==0,this._pressed=s!==0,this._repeated=a!==0,this._released=o!==0,super.onPoll(t)}onUpdate(t,r,n){n>0?this.onButtonPressed(t):this.onButtonReleased(t)}onStatus(t,r){this.onButtonStatus(t,r!==0)}onBind(t,r={}){super.onBind(t,r);let{inverted:n=!1}=r,i=this._state;n?i[t]|=xt:i[t]&=Yi}onButtonPressed(t){let r=this._state,n=r[t];n&xe||(n|=dt,n|=xe),n|=vt,r[t]=n}onButtonReleased(t){let r=this._state,n=r[t];n&xe&&(n|=mt,n&=gr),r[t]=n}onButtonStatus(t,r){let n=this._state,i=n[t],s=Boolean(i&xe);r?i|=xe:i&=gr,s&&!r&&(i|=mt),!s&&r&&(i|=dt,i|=vt),n[t]=i}},_t=class{static isAxis(t){return!1}static isButton(t){return!1}constructor(t,r){if(!r)throw new Error(`Missing event target for device ${t}.`);this.name=t,this.eventTarget=r,this.listeners={input:[]}}setEventTarget(t){if(!t)throw new Error(`Missing event target for device ${this.name}.`);this.eventTarget=t}destroy(){let t=this.listeners;for(let r in t)t[r].length=0}addEventListener(t,r){let n=this.listeners;t in n?n[t].push(r):n[t]=[r]}removeEventListener(t,r){let n=this.listeners;if(t in n){let i=n[t],s=i.indexOf(r);s>=0&&i.splice(s,1)}}dispatchInputEvent(t){let r=0;for(let n of this.listeners.input)r|=n(t);return Boolean(r)}},yr=class extends _t{static isAxis(t){return!1}static isButton(t){return!0}constructor(t,r,n={}){super(t,r);let{ignoreRepeat:i=!0}=n;this.ignoreRepeat=i,this._eventObject={target:r,device:t,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),r.addEventListener("keydown",this.onKeyDown),r.addEventListener("keyup",this.onKeyUp)}setEventTarget(t){this.eventTarget&&this.destroy(),super.setEventTarget(t),t.addEventListener("keydown",this.onKeyDown),t.addEventListener("keyup",this.onKeyUp)}destroy(){let t=this.eventTarget;t.removeEventListener("keydown",this.onKeyDown),t.removeEventListener("keyup",this.onKeyUp),super.destroy()}onKeyDown(t){if(t.repeat&&this.ignoreRepeat)return t.preventDefault(),t.stopPropagation(),!1;let r=this._eventObject;if(r.code=t.code,r.event="pressed",r.value=1,r.control=t.ctrlKey,r.shift=t.shiftKey,r.alt=t.altKey,this.dispatchInputEvent(r))return t.preventDefault(),t.stopPropagation(),!1}onKeyUp(t){let r=this._eventObject;if(r.code=t.code,r.event="released",r.value=1,r.control=t.ctrlKey,r.shift=t.shiftKey,r.alt=t.altKey,this.dispatchInputEvent(r))return t.preventDefault(),t.stopPropagation(),!1}},gt=10,yt=100,Ar=class extends _t{static isAxis(t){return t==="PosX"||t==="PosY"||t==="WheelX"||t==="WheelY"||t==="WheelZ"}static isButton(t){return!this.isAxis(t)}constructor(t,r,n={}){super(t,r);let{eventsOnFocus:i=!0}=n;this.eventsOnFocus=i,this.canvasTarget=this.getCanvasFromEventTarget(r),this._downHasFocus=!1,this._eventObject={target:r,device:t,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this._positionObject={target:r,device:t,code:"",event:"move",value:0,movement:0},this._wheelObject={target:r,device:t,code:"",event:"wheel",movement:0},this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onWheel=this.onWheel.bind(this),r.addEventListener("mousedown",this.onMouseDown),r.addEventListener("contextmenu",this.onContextMenu),r.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}setEventTarget(t){this.eventTarget&&this.destroy(),super.setEventTarget(t),this.canvasTarget=this.getCanvasFromEventTarget(t),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("contextmenu",this.onContextMenu),t.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}destroy(){let t=this.eventTarget;t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("contextmenu",this.onContextMenu),t.removeEventListener("wheel",this.onWheel),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),super.destroy()}setPointerLock(t=!0){t?this.eventTarget.requestPointerLock():this.eventTarget.exitPointerLock()}hasPointerLock(){return document.pointerLockElement===this.eventTarget}onMouseDown(t){this._downHasFocus=!0;let r=this._eventObject;if(r.code="Button"+t.button,r.event="pressed",r.value=1,r.control=t.ctrlKey,r.shift=t.shiftKey,r.alt=t.altKey,this.dispatchInputEvent(r)&&document.activeElement===this.eventTarget)return t.preventDefault(),t.stopPropagation(),!1}onContextMenu(t){return t.preventDefault(),t.stopPropagation(),!1}onWheel(t){let r,n,i;switch(t.deltaMode){case WheelEvent.DOM_DELTA_LINE:r=t.deltaX*gt,n=t.deltaY*gt,i=t.deltaZ*gt;break;case WheelEvent.DOM_DELTA_PAGE:r=t.deltaX*yt,n=t.deltaY*yt,i=t.deltaZ*yt;break;case WheelEvent.DOM_DELTA_PIXEL:default:r=t.deltaX,n=t.deltaY,i=t.deltaZ;break}let s=0,a=this._wheelObject;if(a.code="WheelX",a.movement=r,s|=this.dispatchInputEvent(a),a.code="WheelY",a.movement=n,s|=this.dispatchInputEvent(a),a.code="WheelZ",a.movement=i,s|=this.dispatchInputEvent(a),s)return t.preventDefault(),t.stopPropagation(),!1}onMouseUp(t){if(!this._downHasFocus)return;this._downHasFocus=!1;let r=this._eventObject;if(r.code="Button"+t.button,r.event="released",r.value=1,r.control=t.ctrlKey,r.shift=t.shiftKey,r.alt=t.altKey,this.dispatchInputEvent(r))return t.preventDefault(),t.stopPropagation(),!1}onMouseMove(t){if(this.eventsOnFocus&&document.activeElement!==this.eventTarget)return;let r=this.canvasTarget,{clientWidth:n,clientHeight:i}=r,s=r.getBoundingClientRect(),a=t.movementX/n,o=t.movementY/i,l=(t.clientX-s.left)/n,h=(t.clientY-s.top)/i,c=this._positionObject;c.code="PosX",c.value=l,c.movement=a,this.dispatchInputEvent(c),c.code="PosY",c.value=h,c.movement=o,this.dispatchInputEvent(c)}getCanvasFromEventTarget(t){return t instanceof HTMLCanvasElement?t:t.canvas||t.querySelector("canvas")||t.shadowRoot&&t.shadowRoot.querySelector("canvas")||t}},qi=`<kbd>
    <span id="name"><slot></slot></span>
    <span id="value" class="hidden"></span>
</kbd>
`,Ki=`kbd {
    position: relative;
    display: inline-block;
    border-radius: 3px;
    border: 1px solid #888888;
    font-size: 0.85em;
    font-weight: 700;
    text-rendering: optimizeLegibility;
    line-height: 12px;
    height: 14px;
    padding: 2px 4px;
    color: #444444;
    background-color: #eeeeee;
    box-shadow: inset 0 -3px 0 #aaaaaa;
    overflow: hidden;
}

kbd:empty::after {
    content: "<?>";
    opacity: 0.6;
}

.disabled {
    opacity: 0.6;
    box-shadow: none;
    background-color: #aaaaaa;
}

.hidden {
    display: none;
}

#value {
    position: absolute;
    top: 0;
    bottom: 0;
    right: 0;
    font-size: 0.85em;
    padding: 0 4px;
    padding-top: 2px;
    color: #cccccc;
    background-color: #333333;
    box-shadow: inset 0 3px 0 #222222;
}
`,At=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=qi,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Ki,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("input-code",this)}static get observedAttributes(){return["name","value","disabled"]}get disabled(){return this._disabled}set disabled(t){this.toggleAttribute("disabled",t)}get value(){return this._value}set value(t){this.setAttribute("value",t)}get name(){return this._name}set name(t){this.setAttribute("name",t)}constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._name="",this._value="",this._disabled=!1,this._kbdElement=this.shadowRoot.querySelector("kbd"),this._nameElement=this.shadowRoot.querySelector("#name"),this._valueElement=this.shadowRoot.querySelector("#value")}attributeChangedCallback(t,r,n){switch(t){case"name":this._name=n,this._nameElement.textContent=n;break;case"value":this._value=n,n!==null?(this._valueElement.classList.toggle("hidden",!1),this._valueElement.textContent=n,this._kbdElement.style.paddingRight=`${this._valueElement.clientWidth+4}px`):this._valueElement.classList.toggle("hidden",!0);break;case"disabled":this._disabled=n!==null,this._kbdElement.classList.toggle("disabled",n!==null);break}}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"name")){let t=this.name;delete this.name,this.name=t}if(Object.prototype.hasOwnProperty.call(this,"value")){let t=this.value;delete this.value,this.value=t}if(Object.prototype.hasOwnProperty.call(this,"disabled")){let t=this.disabled;delete this.disabled,this.disabled=t}}};At.define();var Xi=`<table>
    <thead>
        <tr class="tableHeader">
            <th colspan=3>
                <span class="tableTitle">
                    <label id="title">
                        input-source
                    </label>
                    <span id="slotContainer">
                        <slot></slot>
                    </span>
                    <p>
                        <label for="poll">poll</label>
                        <output id="poll"></output>
                    </p>
                    <p>
                        <label for="focus">focus</label>
                        <output id="focus"></output>
                    </p>
                </span>
            </th>
        </tr>
        <tr class="colHeader">
            <th>name</th>
            <th>value</th>
            <th>key</th>
        </tr>
    </thead>
    <tbody>
    </tbody>
</table>
`,Wi=`:host {
    display: block;
}

table {
    border-collapse: collapse;
    font-family: monospace;
}

table,
th,
td {
    border: 1px solid #666666;
}

th,
td {
    padding: 5px 10px;
}

td {
    text-align: center;
}

thead th {
    padding: 0;
}

.colHeader > th {
    font-size: 0.8em;
    padding: 0 10px;
    letter-spacing: 3px;
    background-color: #aaaaaa;
    color: #666666;
}

tbody output {
    border-radius: 0.3em;
    padding: 3px;
}

tr:not(.primary) .name,
tr:not(.primary) .value {
    opacity: 0.3;
}

tr:nth-child(2n) {
    background-color: #eeeeee;
}

.tableHeader {
    color: #666666;
}

.tableTitle {
    display: flex;
    flex-direction: row;
    align-items: center;
    padding: 4px;
}

#slotContainer {
    flex: 1;
}

p {
    display: inline;
    margin: 0;
    padding: 0;
    padding-right: 10px;
}

#poll:empty::after,
#focus:empty::after {
    content: "\u2717";
    color: #ff0000;
}
`,Er=class{constructor(t){this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null,this.pollable=t}get running(){return this.animationFrameHandle!==null}start(){let t=this.animationFrameHandle;t&&cancelAnimationFrame(t),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}stop(){let t=this.animationFrameHandle;t&&cancelAnimationFrame(t),this.animationFrameHandle=null}onAnimationFrame(t){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.pollable.onPoll(t)}},Mr=class{constructor(t){this.onInput=this.onInput.bind(this),this.onPoll=this.onPoll.bind(this),this.bindings=t}onPoll(t){for(let r of this.bindings.getInputs())r.onPoll(t)}onInput(t){let{device:r,code:n,event:i,value:s,movement:a,control:o,shift:l,alt:h}=t,c=this.bindings.getBindings(r,n);switch(i){case"pressed":for(let{input:u,index:f}of c)u.onUpdate(f,1,1);break;case"released":for(let{input:u,index:f}of c)u.onUpdate(f,0,-1);break;case"move":for(let{input:u,index:f}of c)u.onUpdate(f,s,a);break;case"wheel":for(let{input:u,index:f}of c)u.onUpdate(f,void 0,a);break}return c.length>0}},Et=class{constructor(t,r,n,i){this.device=t,this.code=r,this.input=n,this.index=i}},wr=class{constructor(){this.bindingMap={},this.inputMap=new Map}clear(){for(let t of this.inputMap.keys())t.onUnbind();this.inputMap.clear(),this.bindingMap={}}bind(t,r,n,i={}){let s,a=this.inputMap;if(a.has(t)){let l=a.get(t),h=t.size;t.onBind(h,i),s=new Et(r,n,t,h),l.push(s)}else{let l=[];a.set(t,l);let h=0;t.onBind(h,i),s=new Et(r,n,t,h),l.push(s)}let o=this.bindingMap;r in o?n in o[r]?o[r][n].push(s):o[r][n]=[s]:o[r]={[n]:[s]}}unbind(t){let r=this.inputMap;if(r.has(t)){let n=this.bindingMap,i=r.get(t);for(let s of i){let{device:a,code:o}=s,l=n[a][o],h=l.indexOf(s);l.splice(h,1)}i.length=0,t.onUnbind(),r.delete(t)}}isBound(t){return this.inputMap.has(t)}getInputs(){return this.inputMap.keys()}getBindingsByInput(t){return this.inputMap.get(t)}getBindings(t,r){let n=this.bindingMap;if(t in n){let i=n[t];if(r in i)return i[r]}return[]}},br=class{constructor(t,r={}){this.inputs={},this.devices=[new Ar("Mouse",t),new yr("Keyboard",t)],this.bindings=new wr,this.adapter=new Mr(this.bindings),this.autopoller=new Er(this.adapter),this.eventTarget=t,this.anyButton=new ke(1),this.anyButtonDevice="",this.anyButtonCode="",this.anyAxis=new Se(1),this.anyAxisDevice="",this.anyAxisCode="",this.listeners={bind:[],unbind:[],focus:[],blur:[]},this.onInput=this.onInput.bind(this),this.onEventTargetBlur=this.onEventTargetBlur.bind(this),this.onEventTargetFocus=this.onEventTargetFocus.bind(this),t.addEventListener("focus",this.onEventTargetFocus),t.addEventListener("blur",this.onEventTargetBlur);for(let n of this.devices)n.addEventListener("input",this.onInput)}get autopoll(){return this.autopoller.running}set autopoll(t=void 0){this.toggleAutoPoll(t)}destroy(){let t=this.listeners;for(let n in t)t[n].length=0;this.autopoller.running&&this.autopoller.stop();for(let n of this.devices)n.removeEventListener("input",this.onInput),n.destroy();let r=this.eventTarget;r.removeEventListener("focus",this.onEventTargetFocus),r.removeEventListener("blur",this.onEventTargetBlur)}setEventTarget(t){let r=this.eventTarget;r.removeEventListener("focus",this.onEventTargetFocus),r.removeEventListener("blur",this.onEventTargetBlur),this.eventTarget=t;for(let n of this.devices)n.setEventTarget(t);t.addEventListener("focus",this.onEventTargetFocus),t.addEventListener("blur",this.onEventTargetBlur)}toggleAutoPoll(t=void 0){let r=this.autopoller.running,n=typeof t=="undefined"?!r:Boolean(t);n!==r&&(n?this.autopoller.start():this.autopoller.stop())}addEventListener(t,r){let n=this.listeners;t in n?n[t].push(r):n[t]=[r]}removeEventListener(t,r){let n=this.listeners;if(t in n){let i=n[t],s=i.indexOf(r);s>=0&&i.splice(s,1)}}dispatchEvent(t){let{type:r}=t,n=0;for(let i of this.listeners[r])n|=i(t);return Boolean(n)}poll(t=performance.now()){if(this.autopoller.running)throw new Error("Should not manually poll() while autopolling.");this.onPoll(t)}onInput(t){let r=this.adapter.onInput(t);switch(t.event){case"pressed":this.anyButtonDevice=t.device,this.anyButtonCode=t.code,this.anyButton.onUpdate(0,1,1);break;case"released":this.anyButtonDevice=t.device,this.anyButtonCode=t.code,this.anyButton.onUpdate(0,0,-1);break;case"move":case"wheel":this.anyAxisDevice=t.device,this.anyAxisCode=t.code,this.anyAxis.onUpdate(0,t.value,t.movement);break}return r}onPoll(t){this.adapter.onPoll(t),this.anyButton.onPoll(t),this.anyAxis.onPoll(t)}onBind(){this.dispatchEvent({type:"bind"})}onUnbind(){this.dispatchEvent({type:"unbind"})}onEventTargetFocus(){this.dispatchEvent({type:"focus"})}onEventTargetBlur(){for(let t of this.bindings.getInputs())t.onStatus(0,0);this.anyButton.onStatus(0,0),this.anyAxis.onStatus(0,0),this.dispatchEvent({type:"blur"})}bindButton(t,r,n,i=void 0){let s;this.hasButton(t)?s=this.getButton(t):(s=new ke(1),this.inputs[t]=s),this.bindings.bind(s,r,n,i),this.onBind()}bindAxis(t,r,n,i=void 0){let s;this.hasAxis(t)?s=this.getAxis(t):(s=new Se(1),this.inputs[t]=s),this.bindings.bind(s,r,n,i),this.onBind()}bindAxisButtons(t,r,n,i){let s;this.hasAxis(t)?s=this.getAxis(t):(s=new Se(2),this.inputs[t]=s),this.bindings.bind(s,r,i),this.bindings.bind(s,r,n,{inverted:!0}),this.onBind()}unbindButton(t){if(this.hasButton(t)){let r=this.getButton(t);delete this.inputs[t],this.bindings.unbind(r),this.onUnbind()}}unbindAxis(t){if(this.hasAxis(t)){let r=this.getAxis(t);delete this.inputs[t],this.bindings.unbind(r),this.onUnbind()}}getInput(t){return this.inputs[t]}getButton(t){return this.inputs[t]}getAxis(t){return this.inputs[t]}hasButton(t){return t in this.inputs&&this.inputs[t]instanceof ke}hasAxis(t){return t in this.inputs&&this.inputs[t]instanceof Se}isButtonDown(t){return this.inputs[t].down}isButtonPressed(t){return this.inputs[t].pressed}isButtonReleased(t){return this.inputs[t].released}getInputValue(t){return this.inputs[t].value}getButtonValue(t){return this.buttons[t].value}getAxisValue(t){return this.inputs[t].value}getAxisDelta(t){return this.inputs[t].delta}isAnyButtonDown(t=void 0){if(typeof t=="undefined")return this.anyButton.down;{let r=this.inputs;for(let n of t)if(r[n].down)return!0}return!1}isAnyButtonPressed(t=void 0){if(typeof t=="undefined")return this.anyButton.pressed;{let r=this.inputs;for(let n of t)if(r[n].pressed)return!0}return!1}isAnyButtonReleased(t=void 0){if(typeof t=="undefined")return this.anyButton.released;{let r=this.inputs;for(let n of t)if(r[n].released)return!0}return!1}getAnyAxisValue(t=void 0){if(typeof t=="undefined")return this.anyAxis.value;{let r=this.inputs;for(let n of t){let i=r[n];if(i.value)return i.value}}return 0}getAnyAxisDelta(t=void 0){if(typeof t=="undefined")return this.anyAxis.delta;{let r=this.inputs;for(let n of t){let i=r[n];if(i.delta)return i.delta}}return 0}getLastButtonDevice(){return this.anyButtonDevice}getLastButtonCode(){return this.anyButtonCode}getLastAxisDevice(){return this.anyAxisDevice}getLastAxisCode(){return this.anyAxisCode}getMouse(){return this.devices[0]}getKeyboard(){return this.devices[1]}},Tr=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=Xi,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Wi,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("input-port",this)}static get observedAttributes(){return["autopoll","for"]}get autopoll(){return this._autopoll}set autopoll(t){this.toggleAttribute("autopoll",t)}get for(){return this._for}set for(t){this.setAttribute("for",t)}constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._titleElement=this.shadowRoot.querySelector("#title"),this._pollElement=this.shadowRoot.querySelector("#poll"),this._focusElement=this.shadowRoot.querySelector("#focus"),this._bodyElement=this.shadowRoot.querySelector("tbody"),this._outputElements={},this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null;let t=this;this._for="",this._eventTarget=t,this._autopoll=!1,this._context=null,this.onInputContextBind=this.onInputContextBind.bind(this),this.onInputContextUnbind=this.onInputContextUnbind.bind(this),this.onInputContextFocus=this.onInputContextFocus.bind(this),this.onInputContextBlur=this.onInputContextBlur.bind(this)}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"for")){let t=this.for;delete this.for,this.for=t}if(Object.prototype.hasOwnProperty.call(this,"autopoll")){let t=this.autopoll;delete this.autopoll,this.autopoll=t}this.updateTable(),this.updateTableValues(),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}disconnectedCallback(){this._context&&(this._context.removeEventListener("bind",this.onInputContextBind),this._context.removeEventListener("unbind",this.onInputContextUnbind),this._context.removeEventListener("blur",this.onInputContextBlur),this._context.removeEventListener("focus",this.onInputContextFocus),this._context.destroy(),this._context=null)}attributeChangedCallback(t,r,n){switch(t){case"for":{this._for=n;let i,s;n?(i=document.getElementById(n),s=`${i.tagName.toLowerCase()}#${n}`):(i=this,s="input-port"),this._eventTarget=i,this._context&&this._context.setEventTarget(this._eventTarget),this._titleElement.innerHTML=`for ${s}`}break;case"autopoll":this._autopoll=n!==null,this._context&&this._context.toggleAutoPoll(this._autopoll);break}}onAnimationFrame(){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.updateTableValues(),this.updatePollStatus()}onInputContextBind(){this.updateTable()}onInputContextUnbind(){this.updateTable()}onInputContextFocus(){this._focusElement.innerHTML="\u2713"}onInputContextBlur(){this._focusElement.innerHTML=""}getContext(t="axisbutton",r=void 0){switch(t){case"axisbutton":return this._context||(this._context=new br(this._eventTarget,r),this._context.addEventListener("bind",this.onInputContextBind),this._context.addEventListener("unbind",this.onInputContextUnbind),this._context.addEventListener("blur",this.onInputContextBlur),this._context.addEventListener("focus",this.onInputContextFocus),this._autopoll&&this._context.toggleAutoPoll(!0)),this._context;default:throw new Error(`Input context id '${t}' is not supported.`)}}updateTable(){if(this.isConnected)if(this._context){let t=this._context,r=t.inputs,n=t.bindings,i={},s=[];for(let a of Object.keys(r)){let o=r[a],l=!0;for(let h of n.getBindingsByInput(o)){let c=Zi(`${o.constructor.name}.${a}`,`${h.device}.${h.code}`,0,l);s.push(c),l&&(i[a]=c.querySelector("output"),l=!1)}}this._outputElements=i,this._bodyElement.innerHTML="";for(let a of s)this._bodyElement.appendChild(a)}else{this._outputElements={},this._bodyElement.innerHTML="";return}else return}updateTableValues(){if(this.isConnected)if(this._context){let r=this._context.inputs;for(let n of Object.keys(this._outputElements)){let i=this._outputElements[n],s=r[n].value;i.innerText=Number(s).toFixed(2)}}else{for(let t of Object.keys(this._outputElements)){let r=this._outputElements[t];r.innerText="---"}return}else return}updatePollStatus(){if(this.isConnected)if(this._context){let r=this._context.inputs;for(let n of Object.values(r))if(!n.polling){this._pollElement.innerHTML="";return}this._pollElement.innerHTML="\u2713"}else{this._pollElement.innerHTML="-";return}else return}};Tr.define();function Zi(e,t,r,n=!0){let i=document.createElement("tr");n&&i.classList.add("primary");{let s=document.createElement("td");s.textContent=e,s.classList.add("name"),i.appendChild(s)}{let s=document.createElement("td"),a=document.createElement("output");n?a.innerText=Number(r).toFixed(2):a.innerText="---",a.classList.add("value"),s.appendChild(a),i.appendChild(s)}{let s=document.createElement("td");s.classList.add("key");let a=new At;a.innerText=t,s.appendChild(a),i.appendChild(s)}return i}var Kh=Symbol("keyboardSource");var Xh=Symbol("mouseSource");var Sr={},Qi=function(e,t,r,n,i){var s=new Worker(Sr[t]||(Sr[t]=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))));return s.onerror=function(a){return i(a.error,null)},s.onmessage=function(a){return i(null,a.data)},s.postMessage(r,n),s},Z=Uint8Array,oe=Uint16Array,Re=Uint32Array,Mt=new Z([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),wt=new Z([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Rr=new Z([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Lr=function(e,t){for(var r=new oe(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var i=new Re(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)i[s]=s-r[n]<<5|n;return[r,i]},Ir=Lr(Mt,2),bt=Ir[0],Ji=Ir[1];bt[28]=258,Ji[258]=28;var Cr=Lr(wt,0),Nr=Cr[0],Zh=Cr[1],ze=new oe(32768);for(var $=0;$<32768;++$)ce=($&43690)>>>1|($&21845)<<1,ce=(ce&52428)>>>2|(ce&13107)<<2,ce=(ce&61680)>>>4|(ce&3855)<<4,ze[$]=((ce&65280)>>>8|(ce&255)<<8)>>>1;var ce,ye=function(e,t,r){for(var n=e.length,i=0,s=new oe(t);i<n;++i)++s[e[i]-1];var a=new oe(t);for(i=0;i<t;++i)a[i]=a[i-1]+s[i-1]<<1;var o;if(r){o=new oe(1<<t);var l=15-t;for(i=0;i<n;++i)if(e[i])for(var h=i<<4|e[i],c=t-e[i],u=a[e[i]-1]++<<c,f=u|(1<<c)-1;u<=f;++u)o[ze[u]>>>l]=h}else for(o=new oe(n),i=0;i<n;++i)e[i]&&(o[i]=ze[a[e[i]-1]++]>>>15-e[i]);return o},Le=new Z(288);for(var $=0;$<144;++$)Le[$]=8;for(var $=144;$<256;++$)Le[$]=9;for(var $=256;$<280;++$)Le[$]=7;for(var $=280;$<288;++$)Le[$]=8;var Or=new Z(32);for(var $=0;$<32;++$)Or[$]=5;var Pr=ye(Le,9,1);var Fr=ye(Or,5,1),He=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},re=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(t&7)&r},$e=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(t&7)},Br=function(e){return(e/8|0)+(e&7&&1)},je=function(e,t,r){(t==null||t<0)&&(t=0),(r==null||r>e.length)&&(r=e.length);var n=new(e instanceof oe?oe:e instanceof Re?Re:Z)(r-t);return n.set(e.subarray(t,r)),n},Dr=function(e,t,r){var n=e.length;if(!n||r&&!r.l&&n<5)return t||new Z(0);var i=!t||r,s=!r||r.i;r||(r={}),t||(t=new Z(n*3));var a=function(F){var ve=t.length;if(F>ve){var Be=new Z(Math.max(ve*2,F));Be.set(t),t=Be}},o=r.f||0,l=r.p||0,h=r.b||0,c=r.l,u=r.d,f=r.m,d=r.n,v=n*8;do{if(!c){r.f=o=re(e,l,1);var m=re(e,l+1,3);if(l+=3,m)if(m==1)c=Pr,u=Fr,f=9,d=5;else if(m==2){var A=re(e,l,31)+257,w=re(e,l+10,15)+4,b=A+re(e,l+5,31)+1;l+=14;for(var S=new Z(b),I=new Z(19),E=0;E<w;++E)I[Rr[E]]=re(e,l+E*3,7);l+=w*3;for(var M=He(I),P=(1<<M)-1,g=ye(I,M,1),E=0;E<b;){var N=g[re(e,l,P)];l+=N&15;var p=N>>>4;if(p<16)S[E++]=p;else{var C=0,O=0;for(p==16?(O=3+re(e,l,3),l+=2,C=S[E-1]):p==17?(O=3+re(e,l,7),l+=3):p==18&&(O=11+re(e,l,127),l+=7);O--;)S[E++]=C}}var x=S.subarray(0,A),_=S.subarray(A);f=He(x),d=He(_),c=ye(x,f,1),u=ye(_,d,1)}else throw"invalid block type";else{var p=Br(l)+4,y=e[p-4]|e[p-3]<<8,L=p+y;if(L>n){if(s)throw"unexpected EOF";break}i&&a(h+y),t.set(e.subarray(p,L),h),r.b=h+=y,r.p=l=L*8;continue}if(l>v){if(s)throw"unexpected EOF";break}}i&&a(h+131072);for(var j=(1<<f)-1,U=(1<<d)-1,K=l;;K=l){var C=c[$e(e,l)&j],X=C>>>4;if(l+=C&15,l>v){if(s)throw"unexpected EOF";break}if(!C)throw"invalid length/literal";if(X<256)t[h++]=X;else if(X==256){K=l,c=null;break}else{var W=X-254;if(X>264){var E=X-257,se=Mt[E];W=re(e,l,(1<<se)-1)+bt[E],l+=se}var Te=u[$e(e,l)&U],pe=Te>>>4;if(!Te)throw"invalid distance";l+=Te&15;var _=Nr[pe];if(pe>3){var se=wt[pe];_+=$e(e,l)&(1<<se)-1,l+=se}if(l>v){if(s)throw"unexpected EOF";break}i&&a(h+131072);for(var ae=h+W;h<ae;h+=4)t[h]=t[h-_],t[h+1]=t[h+1-_],t[h+2]=t[h+2-_],t[h+3]=t[h+3-_];h=ae}}r.l=c,r.p=K,r.b=h,c&&(o=1,r.m=f,r.d=u,r.n=d)}while(!o);return h==t.length?t:je(t,0,h)};var es=new Z(0);var ts=function(e,t){var r={};for(var n in e)r[n]=e[n];for(var n in t)r[n]=t[n];return r},Ur=function(e,t,r){for(var n=e(),i=e.toString(),s=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/ /g,"").split(","),a=0;a<n.length;++a){var o=n[a],l=s[a];if(typeof o=="function"){t+=";"+l+"=";var h=o.toString();if(o.prototype)if(h.indexOf("[native code]")!=-1){var c=h.indexOf(" ",8)+1;t+=h.slice(c,h.indexOf("(",c))}else{t+=h;for(var u in o.prototype)t+=";"+l+".prototype."+u+"="+o.prototype[u].toString()}else t+=h}else r[l]=o}return[t,r]},Ve=[],rs=function(e){var t=[];for(var r in e)(e[r]instanceof Z||e[r]instanceof oe||e[r]instanceof Re)&&t.push((e[r]=new e[r].constructor(e[r])).buffer);return t},ns=function(e,t,r,n){var i;if(!Ve[r]){for(var s="",a={},o=e.length-1,l=0;l<o;++l)i=Ur(e[l],s,a),s=i[0],a=i[1];Ve[r]=Ur(e[o],s,a)}var h=ts({},Ve[r][1]);return Qi(Ve[r][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",r,h,rs(h),n)},is=function(){return[Z,oe,Re,Mt,wt,Rr,bt,Nr,Pr,Fr,ze,ye,He,re,$e,Br,je,Dr,Tt,kr,zr]};var kr=function(e){return postMessage(e,[e.buffer])},zr=function(e){return e&&e.size&&new Z(e.size)},ss=function(e,t,r,n,i,s){var a=ns(r,n,i,function(o,l){a.terminate(),s(o,l)});return a.postMessage([e,t],t.consume?[e.buffer]:[]),function(){a.terminate()}};var le=function(e,t){return e[t]|e[t+1]<<8},ne=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0},St=function(e,t){return ne(e,t)+ne(e,t+4)*4294967296};function as(e,t,r){if(r||(r=t,t={}),typeof r!="function")throw"no callback";return ss(e,t,[is],function(n){return kr(Tt(n.data[0],zr(n.data[1])))},1,r)}function Tt(e,t){return Dr(e,t)}var Qh=typeof TextEncoder!="undefined"&&new TextEncoder,Rt=typeof TextDecoder!="undefined"&&new TextDecoder,os=0;try{Rt.decode(es,{stream:!0}),os=1}catch(e){}var ls=function(e){for(var t="",r=0;;){var n=e[r++],i=(n>127)+(n>223)+(n>239);if(r+i>e.length)return[t,je(e,r-1)];i?i==3?(n=((n&15)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,t+=String.fromCharCode(55296|n>>10,56320|n&1023)):i&1?t+=String.fromCharCode((n&31)<<6|e[r++]&63):t+=String.fromCharCode((n&15)<<12|(e[r++]&63)<<6|e[r++]&63):t+=String.fromCharCode(n)}};function hs(e,t){if(t){for(var r="",n=0;n<e.length;n+=16384)r+=String.fromCharCode.apply(null,e.subarray(n,n+16384));return r}else{if(Rt)return Rt.decode(e);var i=ls(e),s=i[0],a=i[1];if(a.length)throw"invalid utf-8 data";return s}}var cs=function(e,t){return t+30+le(e,t+26)+le(e,t+28)},fs=function(e,t,r){var n=le(e,t+28),i=hs(e.subarray(t+46,t+46+n),!(le(e,t+8)&2048)),s=t+46+n,a=ne(e,t+20),o=r&&a==4294967295?us(e,s):[a,ne(e,t+24),ne(e,t+42)],l=o[0],h=o[1],c=o[2];return[le(e,t+10),l,h,i,s+le(e,t+30)+le(e,t+32),c]},us=function(e,t){for(;le(e,t)!=1;t+=4+le(e,t+2));return[St(e,t+12),St(e,t+4),St(e,t+20)]};function Hr(e,t){if(typeof t!="function")throw"no callback";for(var r=[],n=function(){for(var f=0;f<r.length;++f)r[f]()},i={},s=e.length-22;ne(e,s)!=101010256;--s)if(!s||e.length-s>65558){t("invalid zip file",null);return}var a=le(e,s+8);a||t(null,{});var o=a,l=ne(e,s+16),h=l==4294967295;if(h){if(s=ne(e,s-12),ne(e,s)!=101075792){t("invalid zip file",null);return}o=a=ne(e,s+32),l=ne(e,s+48)}for(var c=function(f){var d=fs(e,l,h),v=d[0],m=d[1],p=d[2],y=d[3],L=d[4],A=d[5],w=cs(e,A);l=L;var b=function(I,E){I?(n(),t(I,null)):(i[y]=E,--a||t(null,i))};if(!v)b(null,je(e,w,w+m));else if(v==8){var S=e.subarray(w,w+m);if(m<32e4)try{b(null,Tt(S,new Z(p)))}catch(I){b(I,null)}else r.push(as(S,{size:p},b))}else b("unknown compression type "+v,null)},u=0;u<o;++u)c(u);return n}var yn=ki(gn()),An=class{constructor(){this._buffers={}}clear(){this._buffers={}}put(t,r){this._buffers[t]=r}get(t){return this._buffers[t]}keys(){return Object.keys(this._buffers)}},Xs="",Ws="",Zs=5e3,Qe=class extends HTMLElement{static get[Symbol.for("templateNode")](){let t=document.createElement("template");return t.innerHTML=Xs,Object.defineProperty(this,Symbol.for("templateNode"),{value:t}),t}static get[Symbol.for("styleNode")](){let t=document.createElement("style");return t.innerHTML=Ws,Object.defineProperty(this,Symbol.for("styleNode"),{value:t}),t}static define(t=window.customElements){t.define("asset-pack",Qe)}static get observedAttributes(){return["src"]}set src(t){this.setAttribute("src",t)}get src(){return this._src}constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._src="",this._files=new An,this._cache={},this._loading={},this._pipeline={},this.onLoad=this.onLoad.bind(this)}get files(){return this._files}async pipe(t,r){let n;if(typeof t=="string")n=t,n in this._pipeline||(t=(0,yn.makeRe)(t));else if(t instanceof RegExp)n=t.source;else throw new Error("Filter must be either a RegExp or glob string.");let i;n in this._pipeline?i=this._pipeline[n]:(i=new En(t),this._pipeline[n]=i),i.addHandler(r),await Promise.all(Object.entries(this._cache).map(([s,a])=>i.matches(s)?r(a,s):null))}async cache(t,r,n={}){let{ephemeral:i}=n,s=this._cache[t],a=this._loading[t];this._cache[t]=r,await Promise.all(Object.values(this._pipeline).map(o=>o.matches(t)?o.process(t,r):null)),a&&(a.resolve(r),delete this._loading[r]),i&&this._cache[r]===r&&(s?this._cache[r]=s:delete this._cache[r])}async loadAsset(t,r=Zs){let n=this._cache[t];if(n)return n;if(t in this._loading)return this._loading[t].promise;{let i=new Mn(r);return this._loading[t]=i,i.promise}}clearAssets(){for(let t of Object.values(this._loading))t.reject(new Error("Stop loading to clear all assets."));this._loading={},this._cache={}}deleteAsset(t){t in this._loading&&(this._loading[t].reject(new Error("Stop loading to delete asset.")),delete this._loading[t]),t in this._cache&&delete this._cache[t]}getAsset(t){return this._cache[t]}hasAsset(t){let r=this._cache[t];return r||!1}connectedCallback(){Qs(this,"src")}attributeChangedCallback(t,r,n){switch(t){case"src":this._src=n,n&&fetch(n).then(this.onLoad).catch(i=>console.error(`Failed to load asset pack: ${i}`));break}}async onLoad(t){let r=await t.arrayBuffer();await new Promise((n,i)=>{Hr(new Uint8Array(r),(s,a)=>{if(s)i(s);else{let o=this._files;Promise.all(Object.entries(a).map(([l,h])=>(o.put(l,h),this.cache(l,h)))).then(()=>n()).catch(i)}})}),this.dispatchEvent(new CustomEvent("load",{composed:!0}))}};Qe.define();function Qs(e,t){if(Object.prototype.hasOwnProperty.call(e,t)){let r=e[t];delete e[t],e[t]=r}}var En=class{constructor(t){this.filter=t,this.handlers=[]}matches(t){return this.filter.test(t)}async process(t,r){return Promise.all(this.handlers.map(n=>n(t,r)))}addHandler(t){this.handlers.push(t)}},Mn=class{constructor(t){this._resolve=null,this._reject=null,this._reason=null,this._value=null,this._timeoutHandle=t>0?setTimeout(()=>{this.reject(`Asset loading exceeded timeout of ${t} ms.`)},t):null,this._promise=new Promise((r,n)=>{this._value?r(this._value):this._resolve=r,this._reason?n(this._reason):this._reject=n})}get promise(){return this._promise}resolve(t){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._resolve?this._resolve(t):this._value=t}reject(t){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._reject?this._reject(t):this._reason=t}};window.addEventListener("error",Je,!0);window.addEventListener("unhandledrejection",Je,!0);function Je(e){typeof e=="object"?e instanceof PromiseRejectionEvent?Je(e.reason):e instanceof ErrorEvent?Je(e.error):e instanceof Error?window.alert(e.stack):window.alert(JSON.stringify(e)):window.alert(e)}var $t={on(e,t,r=t){let n;if(this.__events.has(e)?n=this.__events.get(e):(n=new Map,this.__events.set(e,n)),!n.has(r))n.set(r,t);else throw new Error(`Found callback for event '${e}' with the same handle '${r}'.`);return this},off(e,t){if(this.__events.has(e)){let r=this.__events.get(e);if(r.has(t))r.delete(t);else throw new Error(`Unable to find callback for event '${e}' with handle '${t}'.`)}else throw new Error(`Unable to find event '${e}'.`);return this},once(e,t,r=t){let n=(...i)=>{this.off(e,r),t.apply(this.__context||this,i)};return this.on(e,n,r)},emit(e,...t){if(this.__events.has(e)){let r=[],n=Array.from(this.__events.get(e).values());for(let i of n){let s=i.apply(this.__context||this,t);s&&r.push(s)}return r}else return this.__events.set(e,new Map),[]}};function Js(e=void 0){let t=Object.create($t);return t.__events=new Map,t.__context=e,t}function ea(e,t=void 0){let r=Object.assign(e,$t);return r.__events=new Map,r.__context=t,r}function ta(e,t=void 0){let r=e.prototype;return Object.assign(r,$t),r.__events=new Map,r.__context=t,r}var wn={create:Js,assign:ea,mixin:ta},ra=5,na=4,ia=3,sa=2,aa=1,oa=0,cc={[ra]:Ne("#7F8C8D"),[na]:Ne("#2ECC71"),[ia]:Ne("#4794C8"),[sa]:Ne("#F39C12"),[aa]:Ne("#C0392B"),[oa]:[""]};function Ne(e){return[`background: ${e}`,"border-radius: 0.5em","color: white","font-weight: bold","padding: 2px 0.5em"]}var uc=Symbol("level"),fc=Symbol("domain");var Ee=0,la=class{constructor(t){this._heap=[],this._comparator=t}get size(){return this._heap.length}clear(){this._heap.length=0}push(...t){for(let r of t)this._heap.push(r),this._shiftUp()}pop(){let t=this.peek(),r=ha(this);return r>Ee&&this._swap(Ee,r),this._heap.pop(),this._shiftDown(),t}replace(t){let r=this.peek();return this._heap[Ee]=t,this._shiftDown(),r}peek(){return this._heap[Ee]}_compare(t,r){return this._comparator(this._heap[t],this._heap[r])}_swap(t,r){let n=this._heap[t];this._heap[t]=this._heap[r],this._heap[r]=n}_shiftUp(){let t=this._heap.length-1,r;for(;t>Ee&&this._compare(t,r=ca(t));)this._swap(t,r),t=r}_shiftDown(){let t=this._heap.length,r=Ee,n,i=bn(r),s=i<t,a=Tn(r),o=a<t;for(;s&&this._compare(i,r)||o&&this._compare(a,r);)n=o&&this._compare(a,i)?a:i,this._swap(r,n),r=n,i=bn(r),s=i<t,a=Tn(r),o=a<t}values(){return this._heap}[Symbol.iterator](){return this._heap[Symbol.iterator]()}};function ha(e){return e._heap.length-1}function ca(e){return(e+1>>>1)-1}function bn(e){return(e<<1)+1}function Tn(e){return e+1<<1}var pc=Math.PI/180,dc=180/Math.PI;var jt=class{constructor(t,r,n){this.display=t,this.inputs=r,this.assets=n,this.deltaTime=0,this.prevTime=0,this.now=0,this.events=wn.create()}on(t,r){return this.events.on(t,r),this}off(t,r){return this.events.off(t,r),this}once(t,r){return this.events.once(t,r),this}emit(t,...r){this.events.emit(t,...r)}};async function Vt(e,t=void 0){if(typeof e=="string"){let o=await(await fetch(e)).arrayBuffer();if(typeof t=="undefined"){let l=e.lastIndexOf(".");if(l<0)throw new Error("Cannot load from url - unknown image type.");t="image/"+e.slice(l+1)}return Vt(o,t)}else if(!(e instanceof ArrayBuffer||ArrayBuffer.isView(e)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let r=e;typeof t=="undefined"&&(t="image/png");let n=new Blob([r],{type:t}),i=URL.createObjectURL(n),s=new Image;return new Promise((a,o)=>{s.addEventListener("load",()=>{a(s)}),s.addEventListener("error",l=>{o(l)}),s.src=i})}async function Gt(e){if(typeof e=="string"){let n=await(await fetch(e)).arrayBuffer();return Gt(n)}else if(!(e instanceof ArrayBuffer||ArrayBuffer.isView(e)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let t=e;return ua(new TextDecoder().decode(t))}function ua(e){let t=[],r=[],n=[],i=[],s=[],a=[],o=/^#.*/g,l=/v\s+(\S+)\s+(\S+)\s+(\S+)/g,h=/vn\s+(\S+)\s+(\S+)\s+(\S+)/g,c=/vt\s+(\S+)\s+(\S+)/g,u=/f\s+(([^/\s]*)\/([^/\s]*)\/?([^/\s]*))\s+(([^/\s]*)\/([^/\s]*)\/?([^/\s]*))\s+(([^/\s]*)\/([^/\s]*)\/?([^/\s]*))(\s+(([^/\s]*)\/([^/\s]*)\/?([^/\s]*)))?/g,f=/f\s+([^/\s]+)\s+([^/\s]+)\s+([^/\s]+)/g,d=!1,v=null,m,p,y,L;for(e=e.replace(o,"");(v=l.exec(e))!=null;)m=Number.parseFloat(v[1]),p=Number.parseFloat(v[2]),y=Number.parseFloat(v[3]),t.push(m),t.push(p),t.push(y);for(;(v=h.exec(e))!=null;)m=Number.parseFloat(v[1]),p=Number.parseFloat(v[2]),y=Number.parseFloat(v[3]),n.push(m),n.push(p),n.push(y);for(;(v=c.exec(e))!=null;)m=Number.parseFloat(v[1]),p=Number.parseFloat(v[2]),r.push(m),r.push(p);for(;(v=u.exec(e))!=null;)m=Number.parseInt(v[2]),Number.isNaN(m)&&(m=1),p=Number.parseInt(v[6]),Number.isNaN(p)&&(p=1),y=Number.parseInt(v[10]),Number.isNaN(y)&&(y=1),i.push(m),i.push(p),i.push(y),m=Number.parseInt(v[4]),Number.isNaN(m)?(m=Number.parseInt(v[3]),p=Number.parseInt(v[7]),y=Number.parseInt(v[11]),a.push(m),a.push(p),a.push(y),s.push(1),s.push(1),s.push(1)):(p=Number.parseInt(v[8]),Number.isNaN(p)&&(p=1),y=Number.parseInt(v[12]),Number.isNaN(y)&&(y=1),a.push(m),a.push(p),a.push(y),m=Number.parseInt(v[3]),Number.isNaN(m)&&(m=1),p=Number.parseInt(v[7]),Number.isNaN(p)&&(p=1),y=Number.parseInt(v[11]),Number.isNaN(y)&&(y=1),s.push(m),s.push(p),s.push(y)),typeof v[13]!="undefined"&&(L=Number.parseInt(v[15]),Number.isNaN(L)&&(L=1),i.push(L),L=Number.parseInt(v[17]),Number.isNaN(L)?(L=Number.parseInt(v[16]),a.push(L),s.push(1)):(a.push(L),L=Number.parseInt(v[16]),s.push(L)),d=!0);for(;(v=f.exec(e))!=null;)m=Number.parseInt(v[2]),p=Number.parseInt(v[6]),y=Number.parseInt(v[10]),i.push(m),i.push(p),i.push(y),s.push(1),s.push(1),s.push(1),a.push(1),a.push(1),a.push(1),typeof v[13]!="undefined"&&(L=Number.parseInt(v[14]),i.push(L),s.push(1),a.push(1),d=!0);let A,w;w=i.length;let b=new Float32Array(w*3);for(let M=0;M<w;++M)A=i[M]-1,b[M*3+0]=t[A*3+0],b[M*3+1]=t[A*3+1],b[M*3+2]=t[A*3+2];w=s.length;let S=new Float32Array(w*2);for(let M=0;M<w;++M)A=s[M]-1,S[M*2+0]=r[A*2+0],S[M*2+1]=r[A*2+1];w=a.length;let I=new Float32Array(w*3);for(let M=0;M<w;++M)A=a[M]-1,I[M*3+0]=n[A*3+0],I[M*3+1]=n[A*3+1],I[M*3+2]=n[A*3+2];w=i.length;let E=new Uint16Array(w);for(let M=0;M<w;++M)E[M]=M;return d&&console.warn("WebGL does not support quad faces, only triangles."),{positions:b,texcoords:S,normals:I,indices:E}}async function Yt(e){if(typeof e=="string"){let s=await(await fetch(e)).arrayBuffer();return Yt(s)}else if(!(e instanceof ArrayBuffer||ArrayBuffer.isView(e)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let t=e,r=new TextDecoder().decode(t),n={};for(let i of r.split(`
`)){if(i=i.trim(),i<=0||i.startsWith("#")||i.startsWith("//"))continue;let s=[],a=0,o=i.indexOf(" ");for(;o>=0;)s.push(i.substring(a,o)),a=o+1,o=i.indexOf(" ",a);s.push(i.substring(a));let l=s[0],h=Number.parseInt(s[1]),c=Number.parseInt(s[2]),u=Number.parseInt(s[3]),f=Number.parseInt(s[4]),d=s.length>=6?Number.parseInt(s[5]):1,v=s.length>=7?Number.parseInt(s[6]):d,m=s.length>=8?Number.parseInt(s[7]):d>v?Math.ceil(d/v):1;n[l]={u:h,v:c,w:u,h:f,frames:d,cols:v,rows:m,name:l}}return n}async function qt(e,t){if(typeof e=="string"){let a=await(await fetch(e)).arrayBuffer();return qt(a)}else if(!(e instanceof ArrayBuffer||ArrayBuffer.isView(e)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let r=e,n=new ArrayBuffer(r.byteLength);return new Uint8Array(n).set(r),await t.decodeAudioData(n)}var Kt=Symbol("audioContext"),et=class{static getAudioContext(){if(Kt in this)return this[Kt];{let t=new AudioContext;return fa(t),this[Kt]=t,t}}constructor(t,r){this.audioContext=t,this.audioBuffer=r,this._playing=!1,this._started=!1,this._source=null,this.onAudioSourceEnded=this.onAudioSourceEnded.bind(this)}destroy(){this._source&&this._source.disconnect(),this._source=null,this._started=!1,this._playing=!1}onAudioSourceEnded(){this._playing=!1}play(t={}){let r=this.audioBuffer;if(!r)return;this._source&&this.destroy();let{pitch:n=void 0,gain:i=void 0,pan:s=void 0,loop:a=!1}=t,o=this.audioContext,l=o.createBufferSource();l.addEventListener("ended",this.onAudioSourceEnded),l.buffer=r,l.loop=a;let h=l;if(n&&(l.detune.value=n*100),i){let c=o.createGain();c.gain.value=i,h=h.connect(c)}if(s){let c=o.createStereoPanner();c.pan.value=s,h=h.connect(c)}h.connect(o.destination),l.start(),this._source=l,this._started=!0,this._playing=!0}pause(){this._source.stop(),this._playing=!1}isStarted(){return this._started}isPlaying(){return this._playing}isPaused(){return this._started&&!this._playing}};function fa(e){let t=()=>{e.state==="suspended"&&e.resume()};document.addEventListener("click",t)}var D=1e-6,z=typeof Float32Array!="undefined"?Float32Array:Array,ee=Math.random;var Mc=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});function Sn(){var e=new z(9);return z!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}var k={};_e(k,{add:()=>Ka,adjoint:()=>ya,clone:()=>da,copy:()=>va,create:()=>pa,determinant:()=>Aa,equals:()=>Qa,exactEquals:()=>Za,frob:()=>qa,fromQuat:()=>ka,fromQuat2:()=>Pa,fromRotation:()=>Ia,fromRotationTranslation:()=>In,fromRotationTranslationScale:()=>Da,fromRotationTranslationScaleOrigin:()=>Ua,fromScaling:()=>La,fromTranslation:()=>Ra,fromValues:()=>ma,fromXRotation:()=>Ca,fromYRotation:()=>Na,fromZRotation:()=>Oa,frustum:()=>za,getRotation:()=>Ba,getScaling:()=>Cn,getTranslation:()=>Fa,identity:()=>Rn,invert:()=>ga,lookAt:()=>Va,mul:()=>Ja,multiply:()=>Ln,multiplyScalar:()=>Xa,multiplyScalarAndAdd:()=>Wa,ortho:()=>ja,perspective:()=>Ha,perspectiveFromFieldOfView:()=>$a,rotate:()=>wa,rotateX:()=>ba,rotateY:()=>Ta,rotateZ:()=>Sa,scale:()=>Ma,set:()=>xa,str:()=>Ya,sub:()=>eo,subtract:()=>Nn,targetTo:()=>Ga,translate:()=>Ea,transpose:()=>_a});function pa(){var e=new z(16);return z!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function da(e){var t=new z(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function va(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function ma(e,t,r,n,i,s,a,o,l,h,c,u,f,d,v,m){var p=new z(16);return p[0]=e,p[1]=t,p[2]=r,p[3]=n,p[4]=i,p[5]=s,p[6]=a,p[7]=o,p[8]=l,p[9]=h,p[10]=c,p[11]=u,p[12]=f,p[13]=d,p[14]=v,p[15]=m,p}function xa(e,t,r,n,i,s,a,o,l,h,c,u,f,d,v,m,p){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=s,e[5]=a,e[6]=o,e[7]=l,e[8]=h,e[9]=c,e[10]=u,e[11]=f,e[12]=d,e[13]=v,e[14]=m,e[15]=p,e}function Rn(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function _a(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],s=t[6],a=t[7],o=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=s,e[11]=t[14],e[12]=i,e[13]=a,e[14]=o}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function ga(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],a=t[4],o=t[5],l=t[6],h=t[7],c=t[8],u=t[9],f=t[10],d=t[11],v=t[12],m=t[13],p=t[14],y=t[15],L=r*o-n*a,A=r*l-i*a,w=r*h-s*a,b=n*l-i*o,S=n*h-s*o,I=i*h-s*l,E=c*m-u*v,M=c*p-f*v,P=c*y-d*v,g=u*p-f*m,N=u*y-d*m,C=f*y-d*p,O=L*C-A*N+w*g+b*P-S*M+I*E;return O?(O=1/O,e[0]=(o*C-l*N+h*g)*O,e[1]=(i*N-n*C-s*g)*O,e[2]=(m*I-p*S+y*b)*O,e[3]=(f*S-u*I-d*b)*O,e[4]=(l*P-a*C-h*M)*O,e[5]=(r*C-i*P+s*M)*O,e[6]=(p*w-v*I-y*A)*O,e[7]=(c*I-f*w+d*A)*O,e[8]=(a*N-o*P+h*E)*O,e[9]=(n*P-r*N-s*E)*O,e[10]=(v*S-m*w+y*L)*O,e[11]=(u*w-c*S-d*L)*O,e[12]=(o*M-a*g-l*E)*O,e[13]=(r*g-n*M+i*E)*O,e[14]=(m*A-v*b-p*L)*O,e[15]=(c*b-u*A+f*L)*O,e):null}function ya(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],a=t[4],o=t[5],l=t[6],h=t[7],c=t[8],u=t[9],f=t[10],d=t[11],v=t[12],m=t[13],p=t[14],y=t[15];return e[0]=o*(f*y-d*p)-u*(l*y-h*p)+m*(l*d-h*f),e[1]=-(n*(f*y-d*p)-u*(i*y-s*p)+m*(i*d-s*f)),e[2]=n*(l*y-h*p)-o*(i*y-s*p)+m*(i*h-s*l),e[3]=-(n*(l*d-h*f)-o*(i*d-s*f)+u*(i*h-s*l)),e[4]=-(a*(f*y-d*p)-c*(l*y-h*p)+v*(l*d-h*f)),e[5]=r*(f*y-d*p)-c*(i*y-s*p)+v*(i*d-s*f),e[6]=-(r*(l*y-h*p)-a*(i*y-s*p)+v*(i*h-s*l)),e[7]=r*(l*d-h*f)-a*(i*d-s*f)+c*(i*h-s*l),e[8]=a*(u*y-d*m)-c*(o*y-h*m)+v*(o*d-h*u),e[9]=-(r*(u*y-d*m)-c*(n*y-s*m)+v*(n*d-s*u)),e[10]=r*(o*y-h*m)-a*(n*y-s*m)+v*(n*h-s*o),e[11]=-(r*(o*d-h*u)-a*(n*d-s*u)+c*(n*h-s*o)),e[12]=-(a*(u*p-f*m)-c*(o*p-l*m)+v*(o*f-l*u)),e[13]=r*(u*p-f*m)-c*(n*p-i*m)+v*(n*f-i*u),e[14]=-(r*(o*p-l*m)-a*(n*p-i*m)+v*(n*l-i*o)),e[15]=r*(o*f-l*u)-a*(n*f-i*u)+c*(n*l-i*o),e}function Aa(e){var t=e[0],r=e[1],n=e[2],i=e[3],s=e[4],a=e[5],o=e[6],l=e[7],h=e[8],c=e[9],u=e[10],f=e[11],d=e[12],v=e[13],m=e[14],p=e[15],y=t*a-r*s,L=t*o-n*s,A=t*l-i*s,w=r*o-n*a,b=r*l-i*a,S=n*l-i*o,I=h*v-c*d,E=h*m-u*d,M=h*p-f*d,P=c*m-u*v,g=c*p-f*v,N=u*p-f*m;return y*N-L*g+A*P+w*M-b*E+S*I}function Ln(e,t,r){var n=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],h=t[6],c=t[7],u=t[8],f=t[9],d=t[10],v=t[11],m=t[12],p=t[13],y=t[14],L=t[15],A=r[0],w=r[1],b=r[2],S=r[3];return e[0]=A*n+w*o+b*u+S*m,e[1]=A*i+w*l+b*f+S*p,e[2]=A*s+w*h+b*d+S*y,e[3]=A*a+w*c+b*v+S*L,A=r[4],w=r[5],b=r[6],S=r[7],e[4]=A*n+w*o+b*u+S*m,e[5]=A*i+w*l+b*f+S*p,e[6]=A*s+w*h+b*d+S*y,e[7]=A*a+w*c+b*v+S*L,A=r[8],w=r[9],b=r[10],S=r[11],e[8]=A*n+w*o+b*u+S*m,e[9]=A*i+w*l+b*f+S*p,e[10]=A*s+w*h+b*d+S*y,e[11]=A*a+w*c+b*v+S*L,A=r[12],w=r[13],b=r[14],S=r[15],e[12]=A*n+w*o+b*u+S*m,e[13]=A*i+w*l+b*f+S*p,e[14]=A*s+w*h+b*d+S*y,e[15]=A*a+w*c+b*v+S*L,e}function Ea(e,t,r){var n=r[0],i=r[1],s=r[2],a,o,l,h,c,u,f,d,v,m,p,y;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*s+t[12],e[13]=t[1]*n+t[5]*i+t[9]*s+t[13],e[14]=t[2]*n+t[6]*i+t[10]*s+t[14],e[15]=t[3]*n+t[7]*i+t[11]*s+t[15]):(a=t[0],o=t[1],l=t[2],h=t[3],c=t[4],u=t[5],f=t[6],d=t[7],v=t[8],m=t[9],p=t[10],y=t[11],e[0]=a,e[1]=o,e[2]=l,e[3]=h,e[4]=c,e[5]=u,e[6]=f,e[7]=d,e[8]=v,e[9]=m,e[10]=p,e[11]=y,e[12]=a*n+c*i+v*s+t[12],e[13]=o*n+u*i+m*s+t[13],e[14]=l*n+f*i+p*s+t[14],e[15]=h*n+d*i+y*s+t[15]),e}function Ma(e,t,r){var n=r[0],i=r[1],s=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function wa(e,t,r,n){var i=n[0],s=n[1],a=n[2],o=Math.hypot(i,s,a),l,h,c,u,f,d,v,m,p,y,L,A,w,b,S,I,E,M,P,g,N,C,O,x;return o<D?null:(o=1/o,i*=o,s*=o,a*=o,l=Math.sin(r),h=Math.cos(r),c=1-h,u=t[0],f=t[1],d=t[2],v=t[3],m=t[4],p=t[5],y=t[6],L=t[7],A=t[8],w=t[9],b=t[10],S=t[11],I=i*i*c+h,E=s*i*c+a*l,M=a*i*c-s*l,P=i*s*c-a*l,g=s*s*c+h,N=a*s*c+i*l,C=i*a*c+s*l,O=s*a*c-i*l,x=a*a*c+h,e[0]=u*I+m*E+A*M,e[1]=f*I+p*E+w*M,e[2]=d*I+y*E+b*M,e[3]=v*I+L*E+S*M,e[4]=u*P+m*g+A*N,e[5]=f*P+p*g+w*N,e[6]=d*P+y*g+b*N,e[7]=v*P+L*g+S*N,e[8]=u*C+m*O+A*x,e[9]=f*C+p*O+w*x,e[10]=d*C+y*O+b*x,e[11]=v*C+L*O+S*x,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function ba(e,t,r){var n=Math.sin(r),i=Math.cos(r),s=t[4],a=t[5],o=t[6],l=t[7],h=t[8],c=t[9],u=t[10],f=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*i+h*n,e[5]=a*i+c*n,e[6]=o*i+u*n,e[7]=l*i+f*n,e[8]=h*i-s*n,e[9]=c*i-a*n,e[10]=u*i-o*n,e[11]=f*i-l*n,e}function Ta(e,t,r){var n=Math.sin(r),i=Math.cos(r),s=t[0],a=t[1],o=t[2],l=t[3],h=t[8],c=t[9],u=t[10],f=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i-h*n,e[1]=a*i-c*n,e[2]=o*i-u*n,e[3]=l*i-f*n,e[8]=s*n+h*i,e[9]=a*n+c*i,e[10]=o*n+u*i,e[11]=l*n+f*i,e}function Sa(e,t,r){var n=Math.sin(r),i=Math.cos(r),s=t[0],a=t[1],o=t[2],l=t[3],h=t[4],c=t[5],u=t[6],f=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i+h*n,e[1]=a*i+c*n,e[2]=o*i+u*n,e[3]=l*i+f*n,e[4]=h*i-s*n,e[5]=c*i-a*n,e[6]=u*i-o*n,e[7]=f*i-l*n,e}function Ra(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function La(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ia(e,t,r){var n=r[0],i=r[1],s=r[2],a=Math.hypot(n,i,s),o,l,h;return a<D?null:(a=1/a,n*=a,i*=a,s*=a,o=Math.sin(t),l=Math.cos(t),h=1-l,e[0]=n*n*h+l,e[1]=i*n*h+s*o,e[2]=s*n*h-i*o,e[3]=0,e[4]=n*i*h-s*o,e[5]=i*i*h+l,e[6]=s*i*h+n*o,e[7]=0,e[8]=n*s*h+i*o,e[9]=i*s*h-n*o,e[10]=s*s*h+l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function Ca(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Na(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Oa(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function In(e,t,r){var n=t[0],i=t[1],s=t[2],a=t[3],o=n+n,l=i+i,h=s+s,c=n*o,u=n*l,f=n*h,d=i*l,v=i*h,m=s*h,p=a*o,y=a*l,L=a*h;return e[0]=1-(d+m),e[1]=u+L,e[2]=f-y,e[3]=0,e[4]=u-L,e[5]=1-(c+m),e[6]=v+p,e[7]=0,e[8]=f+y,e[9]=v-p,e[10]=1-(c+d),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function Pa(e,t){var r=new z(3),n=-t[0],i=-t[1],s=-t[2],a=t[3],o=t[4],l=t[5],h=t[6],c=t[7],u=n*n+i*i+s*s+a*a;return u>0?(r[0]=(o*a+c*n+l*s-h*i)*2/u,r[1]=(l*a+c*i+h*n-o*s)*2/u,r[2]=(h*a+c*s+o*i-l*n)*2/u):(r[0]=(o*a+c*n+l*s-h*i)*2,r[1]=(l*a+c*i+h*n-o*s)*2,r[2]=(h*a+c*s+o*i-l*n)*2),In(e,t,r),e}function Fa(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Cn(e,t){var r=t[0],n=t[1],i=t[2],s=t[4],a=t[5],o=t[6],l=t[8],h=t[9],c=t[10];return e[0]=Math.hypot(r,n,i),e[1]=Math.hypot(s,a,o),e[2]=Math.hypot(l,h,c),e}function Ba(e,t){var r=new z(3);Cn(r,t);var n=1/r[0],i=1/r[1],s=1/r[2],a=t[0]*n,o=t[1]*i,l=t[2]*s,h=t[4]*n,c=t[5]*i,u=t[6]*s,f=t[8]*n,d=t[9]*i,v=t[10]*s,m=a+c+v,p=0;return m>0?(p=Math.sqrt(m+1)*2,e[3]=.25*p,e[0]=(u-d)/p,e[1]=(f-l)/p,e[2]=(o-h)/p):a>c&&a>v?(p=Math.sqrt(1+a-c-v)*2,e[3]=(u-d)/p,e[0]=.25*p,e[1]=(o+h)/p,e[2]=(f+l)/p):c>v?(p=Math.sqrt(1+c-a-v)*2,e[3]=(f-l)/p,e[0]=(o+h)/p,e[1]=.25*p,e[2]=(u+d)/p):(p=Math.sqrt(1+v-a-c)*2,e[3]=(o-h)/p,e[0]=(f+l)/p,e[1]=(u+d)/p,e[2]=.25*p),e}function Da(e,t,r,n){var i=t[0],s=t[1],a=t[2],o=t[3],l=i+i,h=s+s,c=a+a,u=i*l,f=i*h,d=i*c,v=s*h,m=s*c,p=a*c,y=o*l,L=o*h,A=o*c,w=n[0],b=n[1],S=n[2];return e[0]=(1-(v+p))*w,e[1]=(f+A)*w,e[2]=(d-L)*w,e[3]=0,e[4]=(f-A)*b,e[5]=(1-(u+p))*b,e[6]=(m+y)*b,e[7]=0,e[8]=(d+L)*S,e[9]=(m-y)*S,e[10]=(1-(u+v))*S,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function Ua(e,t,r,n,i){var s=t[0],a=t[1],o=t[2],l=t[3],h=s+s,c=a+a,u=o+o,f=s*h,d=s*c,v=s*u,m=a*c,p=a*u,y=o*u,L=l*h,A=l*c,w=l*u,b=n[0],S=n[1],I=n[2],E=i[0],M=i[1],P=i[2],g=(1-(m+y))*b,N=(d+w)*b,C=(v-A)*b,O=(d-w)*S,x=(1-(f+y))*S,_=(p+L)*S,j=(v+A)*I,U=(p-L)*I,K=(1-(f+m))*I;return e[0]=g,e[1]=N,e[2]=C,e[3]=0,e[4]=O,e[5]=x,e[6]=_,e[7]=0,e[8]=j,e[9]=U,e[10]=K,e[11]=0,e[12]=r[0]+E-(g*E+O*M+j*P),e[13]=r[1]+M-(N*E+x*M+U*P),e[14]=r[2]+P-(C*E+_*M+K*P),e[15]=1,e}function ka(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],a=r+r,o=n+n,l=i+i,h=r*a,c=n*a,u=n*o,f=i*a,d=i*o,v=i*l,m=s*a,p=s*o,y=s*l;return e[0]=1-u-v,e[1]=c+y,e[2]=f-p,e[3]=0,e[4]=c-y,e[5]=1-h-v,e[6]=d+m,e[7]=0,e[8]=f+p,e[9]=d-m,e[10]=1-h-u,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function za(e,t,r,n,i,s,a){var o=1/(r-t),l=1/(i-n),h=1/(s-a);return e[0]=s*2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s*2*l,e[6]=0,e[7]=0,e[8]=(r+t)*o,e[9]=(i+n)*l,e[10]=(a+s)*h,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*s*2*h,e[15]=0,e}function Ha(e,t,r,n,i){var s=1/Math.tan(t/2),a;return e[0]=s/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==Infinity?(a=1/(n-i),e[10]=(i+n)*a,e[14]=2*i*n*a):(e[10]=-1,e[14]=-2*n),e}function $a(e,t,r,n){var i=Math.tan(t.upDegrees*Math.PI/180),s=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),o=Math.tan(t.rightDegrees*Math.PI/180),l=2/(a+o),h=2/(i+s);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=h,e[6]=0,e[7]=0,e[8]=-((a-o)*l*.5),e[9]=(i-s)*h*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e}function ja(e,t,r,n,i,s,a){var o=1/(t-r),l=1/(n-i),h=1/(s-a);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*h,e[11]=0,e[12]=(t+r)*o,e[13]=(i+n)*l,e[14]=(a+s)*h,e[15]=1,e}function Va(e,t,r,n){var i,s,a,o,l,h,c,u,f,d,v=t[0],m=t[1],p=t[2],y=n[0],L=n[1],A=n[2],w=r[0],b=r[1],S=r[2];return Math.abs(v-w)<D&&Math.abs(m-b)<D&&Math.abs(p-S)<D?Rn(e):(c=v-w,u=m-b,f=p-S,d=1/Math.hypot(c,u,f),c*=d,u*=d,f*=d,i=L*f-A*u,s=A*c-y*f,a=y*u-L*c,d=Math.hypot(i,s,a),d?(d=1/d,i*=d,s*=d,a*=d):(i=0,s=0,a=0),o=u*a-f*s,l=f*i-c*a,h=c*s-u*i,d=Math.hypot(o,l,h),d?(d=1/d,o*=d,l*=d,h*=d):(o=0,l=0,h=0),e[0]=i,e[1]=o,e[2]=c,e[3]=0,e[4]=s,e[5]=l,e[6]=u,e[7]=0,e[8]=a,e[9]=h,e[10]=f,e[11]=0,e[12]=-(i*v+s*m+a*p),e[13]=-(o*v+l*m+h*p),e[14]=-(c*v+u*m+f*p),e[15]=1,e)}function Ga(e,t,r,n){var i=t[0],s=t[1],a=t[2],o=n[0],l=n[1],h=n[2],c=i-r[0],u=s-r[1],f=a-r[2],d=c*c+u*u+f*f;d>0&&(d=1/Math.sqrt(d),c*=d,u*=d,f*=d);var v=l*f-h*u,m=h*c-o*f,p=o*u-l*c;return d=v*v+m*m+p*p,d>0&&(d=1/Math.sqrt(d),v*=d,m*=d,p*=d),e[0]=v,e[1]=m,e[2]=p,e[3]=0,e[4]=u*p-f*m,e[5]=f*v-c*p,e[6]=c*m-u*v,e[7]=0,e[8]=c,e[9]=u,e[10]=f,e[11]=0,e[12]=i,e[13]=s,e[14]=a,e[15]=1,e}function Ya(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function qa(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function Ka(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function Nn(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function Xa(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function Wa(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e}function Za(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Qa(e,t){var r=e[0],n=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],h=e[7],c=e[8],u=e[9],f=e[10],d=e[11],v=e[12],m=e[13],p=e[14],y=e[15],L=t[0],A=t[1],w=t[2],b=t[3],S=t[4],I=t[5],E=t[6],M=t[7],P=t[8],g=t[9],N=t[10],C=t[11],O=t[12],x=t[13],_=t[14],j=t[15];return Math.abs(r-L)<=D*Math.max(1,Math.abs(r),Math.abs(L))&&Math.abs(n-A)<=D*Math.max(1,Math.abs(n),Math.abs(A))&&Math.abs(i-w)<=D*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(s-b)<=D*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(a-S)<=D*Math.max(1,Math.abs(a),Math.abs(S))&&Math.abs(o-I)<=D*Math.max(1,Math.abs(o),Math.abs(I))&&Math.abs(l-E)<=D*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(h-M)<=D*Math.max(1,Math.abs(h),Math.abs(M))&&Math.abs(c-P)<=D*Math.max(1,Math.abs(c),Math.abs(P))&&Math.abs(u-g)<=D*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(f-N)<=D*Math.max(1,Math.abs(f),Math.abs(N))&&Math.abs(d-C)<=D*Math.max(1,Math.abs(d),Math.abs(C))&&Math.abs(v-O)<=D*Math.max(1,Math.abs(v),Math.abs(O))&&Math.abs(m-x)<=D*Math.max(1,Math.abs(m),Math.abs(x))&&Math.abs(p-_)<=D*Math.max(1,Math.abs(p),Math.abs(_))&&Math.abs(y-j)<=D*Math.max(1,Math.abs(y),Math.abs(j))}var Ja=Ln,eo=Nn;var ie={};_e(ie,{add:()=>El,calculateW:()=>ul,clone:()=>_l,conjugate:()=>vl,copy:()=>yl,create:()=>lr,dot:()=>qn,equals:()=>Rl,exactEquals:()=>Sl,exp:()=>Xn,fromEuler:()=>ml,fromMat3:()=>Qn,fromValues:()=>gl,getAngle:()=>ol,getAxisAngle:()=>al,identity:()=>sl,invert:()=>dl,len:()=>bl,length:()=>Jn,lerp:()=>wl,ln:()=>Wn,mul:()=>Ml,multiply:()=>Kn,normalize:()=>hr,pow:()=>fl,random:()=>pl,rotateX:()=>ll,rotateY:()=>hl,rotateZ:()=>cl,rotationTo:()=>Ll,scale:()=>Zn,set:()=>Al,setAxes:()=>Cl,setAxisAngle:()=>Yn,slerp:()=>at,sqlerp:()=>Il,sqrLen:()=>Tl,squaredLength:()=>ei,str:()=>xl});var Y={};_e(Y,{add:()=>io,angle:()=>bo,bezier:()=>xo,ceil:()=>so,clone:()=>to,copy:()=>ro,create:()=>tt,cross:()=>Oe,dist:()=>Oo,distance:()=>Dn,div:()=>No,divide:()=>Bn,dot:()=>nt,equals:()=>Lo,exactEquals:()=>Ro,floor:()=>ao,forEach:()=>Bo,fromValues:()=>rt,hermite:()=>mo,inverse:()=>po,len:()=>Wt,length:()=>On,lerp:()=>vo,max:()=>lo,min:()=>oo,mul:()=>Co,multiply:()=>Fn,negate:()=>fo,normalize:()=>Xt,random:()=>_o,rotateX:()=>Eo,rotateY:()=>Mo,rotateZ:()=>wo,round:()=>ho,scale:()=>co,scaleAndAdd:()=>uo,set:()=>no,sqrDist:()=>Po,sqrLen:()=>Fo,squaredDistance:()=>Un,squaredLength:()=>kn,str:()=>So,sub:()=>Io,subtract:()=>Pn,transformMat3:()=>yo,transformMat4:()=>go,transformQuat:()=>Ao,zero:()=>To});function tt(){var e=new z(3);return z!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function to(e){var t=new z(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function On(e){var t=e[0],r=e[1],n=e[2];return Math.hypot(t,r,n)}function rt(e,t,r){var n=new z(3);return n[0]=e,n[1]=t,n[2]=r,n}function ro(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function no(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e}function io(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function Pn(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function Fn(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function Bn(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function so(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function ao(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function oo(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e}function lo(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e}function ho(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function co(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function uo(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e}function Dn(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.hypot(r,n,i)}function Un(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return r*r+n*n+i*i}function kn(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}function fo(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function po(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function Xt(e,t){var r=t[0],n=t[1],i=t[2],s=r*r+n*n+i*i;return s>0&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e}function nt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Oe(e,t,r){var n=t[0],i=t[1],s=t[2],a=r[0],o=r[1],l=r[2];return e[0]=i*l-s*o,e[1]=s*a-n*l,e[2]=n*o-i*a,e}function vo(e,t,r,n){var i=t[0],s=t[1],a=t[2];return e[0]=i+n*(r[0]-i),e[1]=s+n*(r[1]-s),e[2]=a+n*(r[2]-a),e}function mo(e,t,r,n,i,s){var a=s*s,o=a*(2*s-3)+1,l=a*(s-2)+s,h=a*(s-1),c=a*(3-2*s);return e[0]=t[0]*o+r[0]*l+n[0]*h+i[0]*c,e[1]=t[1]*o+r[1]*l+n[1]*h+i[1]*c,e[2]=t[2]*o+r[2]*l+n[2]*h+i[2]*c,e}function xo(e,t,r,n,i,s){var a=1-s,o=a*a,l=s*s,h=o*a,c=3*s*o,u=3*l*a,f=l*s;return e[0]=t[0]*h+r[0]*c+n[0]*u+i[0]*f,e[1]=t[1]*h+r[1]*c+n[1]*u+i[1]*f,e[2]=t[2]*h+r[2]*c+n[2]*u+i[2]*f,e}function _o(e,t){t=t||1;var r=ee()*2*Math.PI,n=ee()*2-1,i=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*i,e[1]=Math.sin(r)*i,e[2]=n*t,e}function go(e,t,r){var n=t[0],i=t[1],s=t[2],a=r[3]*n+r[7]*i+r[11]*s+r[15];return a=a||1,e[0]=(r[0]*n+r[4]*i+r[8]*s+r[12])/a,e[1]=(r[1]*n+r[5]*i+r[9]*s+r[13])/a,e[2]=(r[2]*n+r[6]*i+r[10]*s+r[14])/a,e}function yo(e,t,r){var n=t[0],i=t[1],s=t[2];return e[0]=n*r[0]+i*r[3]+s*r[6],e[1]=n*r[1]+i*r[4]+s*r[7],e[2]=n*r[2]+i*r[5]+s*r[8],e}function Ao(e,t,r){var n=r[0],i=r[1],s=r[2],a=r[3],o=t[0],l=t[1],h=t[2],c=i*h-s*l,u=s*o-n*h,f=n*l-i*o,d=i*f-s*u,v=s*c-n*f,m=n*u-i*c,p=a*2;return c*=p,u*=p,f*=p,d*=2,v*=2,m*=2,e[0]=o+c+d,e[1]=l+u+v,e[2]=h+f+m,e}function Eo(e,t,r,n){var i=[],s=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],s[0]=i[0],s[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),s[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function Mo(e,t,r,n){var i=[],s=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],s[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),s[1]=i[1],s[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function wo(e,t,r,n){var i=[],s=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],s[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),s[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),s[2]=i[2],e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function bo(e,t){var r=e[0],n=e[1],i=e[2],s=t[0],a=t[1],o=t[2],l=Math.sqrt(r*r+n*n+i*i),h=Math.sqrt(s*s+a*a+o*o),c=l*h,u=c&&nt(e,t)/c;return Math.acos(Math.min(Math.max(u,-1),1))}function To(e){return e[0]=0,e[1]=0,e[2]=0,e}function So(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function Ro(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function Lo(e,t){var r=e[0],n=e[1],i=e[2],s=t[0],a=t[1],o=t[2];return Math.abs(r-s)<=D*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-a)<=D*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-o)<=D*Math.max(1,Math.abs(i),Math.abs(o))}var Io=Pn,Co=Fn,No=Bn,Oo=Dn,Po=Un,Wt=On,Fo=kn,Bo=function(){var e=tt();return function(t,r,n,i,s,a){var o,l;for(r||(r=3),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,o=n;o<l;o+=r)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],s(e,e,a),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2];return t}}();var Me={};_e(Me,{add:()=>tr,ceil:()=>Do,clone:()=>Zt,copy:()=>Jt,create:()=>zn,cross:()=>Go,dist:()=>el,distance:()=>Vn,div:()=>Jo,divide:()=>jn,dot:()=>ir,equals:()=>or,exactEquals:()=>ar,floor:()=>Uo,forEach:()=>il,fromValues:()=>Qt,inverse:()=>Vo,len:()=>rl,length:()=>it,lerp:()=>sr,max:()=>zo,min:()=>ko,mul:()=>Qo,multiply:()=>$n,negate:()=>jo,normalize:()=>nr,random:()=>Yo,round:()=>Ho,scale:()=>rr,scaleAndAdd:()=>$o,set:()=>er,sqrDist:()=>tl,sqrLen:()=>nl,squaredDistance:()=>Gn,squaredLength:()=>st,str:()=>Wo,sub:()=>Zo,subtract:()=>Hn,transformMat4:()=>qo,transformQuat:()=>Ko,zero:()=>Xo});function zn(){var e=new z(4);return z!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Zt(e){var t=new z(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Qt(e,t,r,n){var i=new z(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function Jt(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function er(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}function tr(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function Hn(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function $n(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function jn(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function Do(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function Uo(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function ko(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e}function zo(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e}function Ho(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function rr(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function $o(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e}function Vn(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],s=t[3]-e[3];return Math.hypot(r,n,i,s)}function Gn(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],s=t[3]-e[3];return r*r+n*n+i*i+s*s}function it(e){var t=e[0],r=e[1],n=e[2],i=e[3];return Math.hypot(t,r,n,i)}function st(e){var t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}function jo(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function Vo(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function nr(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],a=r*r+n*n+i*i+s*s;return a>0&&(a=1/Math.sqrt(a)),e[0]=r*a,e[1]=n*a,e[2]=i*a,e[3]=s*a,e}function ir(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Go(e,t,r,n){var i=r[0]*n[1]-r[1]*n[0],s=r[0]*n[2]-r[2]*n[0],a=r[0]*n[3]-r[3]*n[0],o=r[1]*n[2]-r[2]*n[1],l=r[1]*n[3]-r[3]*n[1],h=r[2]*n[3]-r[3]*n[2],c=t[0],u=t[1],f=t[2],d=t[3];return e[0]=u*h-f*l+d*o,e[1]=-(c*h)+f*a-d*s,e[2]=c*l-u*a+d*i,e[3]=-(c*o)+u*s-f*i,e}function sr(e,t,r,n){var i=t[0],s=t[1],a=t[2],o=t[3];return e[0]=i+n*(r[0]-i),e[1]=s+n*(r[1]-s),e[2]=a+n*(r[2]-a),e[3]=o+n*(r[3]-o),e}function Yo(e,t){t=t||1;var r,n,i,s,a,o;do r=ee()*2-1,n=ee()*2-1,a=r*r+n*n;while(a>=1);do i=ee()*2-1,s=ee()*2-1,o=i*i+s*s;while(o>=1);var l=Math.sqrt((1-a)/o);return e[0]=t*r,e[1]=t*n,e[2]=t*i*l,e[3]=t*s*l,e}function qo(e,t,r){var n=t[0],i=t[1],s=t[2],a=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*s+r[12]*a,e[1]=r[1]*n+r[5]*i+r[9]*s+r[13]*a,e[2]=r[2]*n+r[6]*i+r[10]*s+r[14]*a,e[3]=r[3]*n+r[7]*i+r[11]*s+r[15]*a,e}function Ko(e,t,r){var n=t[0],i=t[1],s=t[2],a=r[0],o=r[1],l=r[2],h=r[3],c=h*n+o*s-l*i,u=h*i+l*n-a*s,f=h*s+a*i-o*n,d=-a*n-o*i-l*s;return e[0]=c*h+d*-a+u*-l-f*-o,e[1]=u*h+d*-o+f*-a-c*-l,e[2]=f*h+d*-l+c*-o-u*-a,e[3]=t[3],e}function Xo(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function Wo(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function ar(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function or(e,t){var r=e[0],n=e[1],i=e[2],s=e[3],a=t[0],o=t[1],l=t[2],h=t[3];return Math.abs(r-a)<=D*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-o)<=D*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-l)<=D*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(s-h)<=D*Math.max(1,Math.abs(s),Math.abs(h))}var Zo=Hn,Qo=$n,Jo=jn,el=Vn,tl=Gn,rl=it,nl=st,il=function(){var e=zn();return function(t,r,n,i,s,a){var o,l;for(r||(r=4),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,o=n;o<l;o+=r)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],e[3]=t[o+3],s(e,e,a),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2],t[o+3]=e[3];return t}}();function lr(){var e=new z(4);return z!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function sl(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Yn(e,t,r){r=r*.5;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function al(e,t){var r=Math.acos(t[3])*2,n=Math.sin(r/2);return n>D?(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n):(e[0]=1,e[1]=0,e[2]=0),r}function ol(e,t){var r=qn(e,t);return Math.acos(2*r*r-1)}function Kn(e,t,r){var n=t[0],i=t[1],s=t[2],a=t[3],o=r[0],l=r[1],h=r[2],c=r[3];return e[0]=n*c+a*o+i*h-s*l,e[1]=i*c+a*l+s*o-n*h,e[2]=s*c+a*h+n*l-i*o,e[3]=a*c-n*o-i*l-s*h,e}function ll(e,t,r){r*=.5;var n=t[0],i=t[1],s=t[2],a=t[3],o=Math.sin(r),l=Math.cos(r);return e[0]=n*l+a*o,e[1]=i*l+s*o,e[2]=s*l-i*o,e[3]=a*l-n*o,e}function hl(e,t,r){r*=.5;var n=t[0],i=t[1],s=t[2],a=t[3],o=Math.sin(r),l=Math.cos(r);return e[0]=n*l-s*o,e[1]=i*l+a*o,e[2]=s*l+n*o,e[3]=a*l-i*o,e}function cl(e,t,r){r*=.5;var n=t[0],i=t[1],s=t[2],a=t[3],o=Math.sin(r),l=Math.cos(r);return e[0]=n*l+i*o,e[1]=i*l-n*o,e[2]=s*l+a*o,e[3]=a*l-s*o,e}function ul(e,t){var r=t[0],n=t[1],i=t[2];return e[0]=r,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),e}function Xn(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],a=Math.sqrt(r*r+n*n+i*i),o=Math.exp(s),l=a>0?o*Math.sin(a)/a:0;return e[0]=r*l,e[1]=n*l,e[2]=i*l,e[3]=o*Math.cos(a),e}function Wn(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],a=Math.sqrt(r*r+n*n+i*i),o=a>0?Math.atan2(a,s)/a:0;return e[0]=r*o,e[1]=n*o,e[2]=i*o,e[3]=.5*Math.log(r*r+n*n+i*i+s*s),e}function fl(e,t,r){return Wn(e,t),Zn(e,e,r),Xn(e,e),e}function at(e,t,r,n){var i=t[0],s=t[1],a=t[2],o=t[3],l=r[0],h=r[1],c=r[2],u=r[3],f,d,v,m,p;return d=i*l+s*h+a*c+o*u,d<0&&(d=-d,l=-l,h=-h,c=-c,u=-u),1-d>D?(f=Math.acos(d),v=Math.sin(f),m=Math.sin((1-n)*f)/v,p=Math.sin(n*f)/v):(m=1-n,p=n),e[0]=m*i+p*l,e[1]=m*s+p*h,e[2]=m*a+p*c,e[3]=m*o+p*u,e}function pl(e){var t=ee(),r=ee(),n=ee(),i=Math.sqrt(1-t),s=Math.sqrt(t);return e[0]=i*Math.sin(2*Math.PI*r),e[1]=i*Math.cos(2*Math.PI*r),e[2]=s*Math.sin(2*Math.PI*n),e[3]=s*Math.cos(2*Math.PI*n),e}function dl(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],a=r*r+n*n+i*i+s*s,o=a?1/a:0;return e[0]=-r*o,e[1]=-n*o,e[2]=-i*o,e[3]=s*o,e}function vl(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function Qn(e,t){var r=t[0]+t[4]+t[8],n;if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);var s=(i+1)%3,a=(i+2)%3;n=Math.sqrt(t[i*3+i]-t[s*3+s]-t[a*3+a]+1),e[i]=.5*n,n=.5/n,e[3]=(t[s*3+a]-t[a*3+s])*n,e[s]=(t[s*3+i]+t[i*3+s])*n,e[a]=(t[a*3+i]+t[i*3+a])*n}return e}function ml(e,t,r,n){var i=.5*Math.PI/180;t*=i,r*=i,n*=i;var s=Math.sin(t),a=Math.cos(t),o=Math.sin(r),l=Math.cos(r),h=Math.sin(n),c=Math.cos(n);return e[0]=s*l*c-a*o*h,e[1]=a*o*c+s*l*h,e[2]=a*l*h-s*o*c,e[3]=a*l*c+s*o*h,e}function xl(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var _l=Zt,gl=Qt,yl=Jt,Al=er,El=tr,Ml=Kn,Zn=rr,qn=ir,wl=sr,Jn=it,bl=Jn,ei=st,Tl=ei,hr=nr,Sl=ar,Rl=or,Ll=function(){var e=tt(),t=rt(1,0,0),r=rt(0,1,0);return function(n,i,s){var a=nt(i,s);return a<-.999999?(Oe(e,t,i),Wt(e)<1e-6&&Oe(e,r,i),Xt(e,e),Yn(n,e,Math.PI),n):a>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(Oe(e,i,s),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+a,hr(n,n))}}(),Il=function(){var e=lr(),t=lr();return function(r,n,i,s,a,o){return at(e,n,a,o),at(t,i,s,o),at(r,e,t,2*o*(1-o)),r}}(),Cl=function(){var e=Sn();return function(t,r,n,i){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],hr(t,Qn(t,e))}}();var Pe={};_e(Pe,{add:()=>Bl,angle:()=>rh,ceil:()=>Dl,clone:()=>Nl,copy:()=>Pl,create:()=>ti,cross:()=>Kl,dist:()=>uh,distance:()=>si,div:()=>ch,divide:()=>ii,dot:()=>ql,equals:()=>ah,exactEquals:()=>sh,floor:()=>Ul,forEach:()=>dh,fromValues:()=>Ol,inverse:()=>Gl,len:()=>oh,length:()=>oi,lerp:()=>Xl,max:()=>zl,min:()=>kl,mul:()=>hh,multiply:()=>ni,negate:()=>Vl,normalize:()=>Yl,random:()=>Wl,rotate:()=>th,round:()=>Hl,scale:()=>$l,scaleAndAdd:()=>jl,set:()=>Fl,sqrDist:()=>fh,sqrLen:()=>ph,squaredDistance:()=>ai,squaredLength:()=>li,str:()=>ih,sub:()=>lh,subtract:()=>ri,transformMat2:()=>Zl,transformMat2d:()=>Ql,transformMat3:()=>Jl,transformMat4:()=>eh,zero:()=>nh});function ti(){var e=new z(2);return z!=Float32Array&&(e[0]=0,e[1]=0),e}function Nl(e){var t=new z(2);return t[0]=e[0],t[1]=e[1],t}function Ol(e,t){var r=new z(2);return r[0]=e,r[1]=t,r}function Pl(e,t){return e[0]=t[0],e[1]=t[1],e}function Fl(e,t,r){return e[0]=t,e[1]=r,e}function Bl(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function ri(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function ni(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function ii(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function Dl(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function Ul(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function kl(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}function zl(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}function Hl(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function $l(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function jl(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e}function si(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.hypot(r,n)}function ai(e,t){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function oi(e){var t=e[0],r=e[1];return Math.hypot(t,r)}function li(e){var t=e[0],r=e[1];return t*t+r*r}function Vl(e,t){return e[0]=-t[0],e[1]=-t[1],e}function Gl(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function Yl(e,t){var r=t[0],n=t[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e}function ql(e,t){return e[0]*t[0]+e[1]*t[1]}function Kl(e,t,r){var n=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=n,e}function Xl(e,t,r,n){var i=t[0],s=t[1];return e[0]=i+n*(r[0]-i),e[1]=s+n*(r[1]-s),e}function Wl(e,t){t=t||1;var r=ee()*2*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e}function Zl(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e}function Ql(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e}function Jl(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e}function eh(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e}function th(e,t,r,n){var i=t[0]-r[0],s=t[1]-r[1],a=Math.sin(n),o=Math.cos(n);return e[0]=i*o-s*a+r[0],e[1]=i*a+s*o+r[1],e}function rh(e,t){var r=e[0],n=e[1],i=t[0],s=t[1],a=Math.sqrt(r*r+n*n)*Math.sqrt(i*i+s*s),o=a&&(r*i+n*s)/a;return Math.acos(Math.min(Math.max(o,-1),1))}function nh(e){return e[0]=0,e[1]=0,e}function ih(e){return"vec2("+e[0]+", "+e[1]+")"}function sh(e,t){return e[0]===t[0]&&e[1]===t[1]}function ah(e,t){var r=e[0],n=e[1],i=t[0],s=t[1];return Math.abs(r-i)<=D*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-s)<=D*Math.max(1,Math.abs(n),Math.abs(s))}var oh=oi,lh=ri,hh=ni,ch=ii,uh=si,fh=ai,ph=li,dh=function(){var e=ti();return function(t,r,n,i,s,a){var o,l;for(r||(r=2),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,o=n;o<l;o+=r)e[0]=t[o],e[1]=t[o+1],s(e,e,a),t[o]=e[0],t[o+1]=e[1];return t}}();var Dc=Y.fromValues(0,1,0);var hi=class{constructor(t,r){this.projectionMatrix=t,this.viewMatrix=r}resize(t=void 0,r=void 0){return this}},Uc=Math.PI/3;var ot=class extends hi{constructor(t=void 0,r=void 0,n=void 0,i=void 0,s=-1e3,a=1e3){super(k.create(),k.create());this.orthoBounds={left:typeof t=="undefined"?void 0:Number(t),top:typeof r=="undefined"?void 0:Number(r),right:typeof n=="undefined"?void 0:Number(n),bottom:typeof i=="undefined"?void 0:Number(i)},this.clippingPlane={near:Number(s),far:Number(a)}}resize(t=void 0,r=void 0){let{near:n,far:i}=this.clippingPlane,{left:s,top:a,right:o,bottom:l}=this.orthoBounds,h=this.projectionMatrix,c=typeof t!="undefined",u=typeof s!="undefined";if(c)if(u){let f=t/r;k.ortho(h,s*f,o*f,l,a,n,i)}else k.ortho(h,0,t,r,0,n,i);else u?k.ortho(h,s,o,l,a,n,i):k.ortho(h,-1,1,1,-1,-1,1);return this}},kc=Math.PI/180;function cr(e){return typeof WebGL2RenderingContext!="undefined"&&e instanceof WebGL2RenderingContext}var ur=class{constructor(t,r){this.gl=t,this.target=r}data(t,r=void 0){let n=this.gl,i=this.target;if(typeof t=="number")n.bufferData(i,t,r||n.STATIC_DRAW);else{if(!ArrayBuffer.isView(t))throw new Error("Source data must be a typed array.");n.bufferData(i,t,r||n.STATIC_DRAW)}return this}subData(t,r=0,n=void 0,i=void 0){let s=this.gl,a=this.target;if(!ArrayBuffer.isView(t))throw new Error("Source data must be a typed array.");if(n)if(cr(s))s.bufferSubData(a,r,t,n,i);else{let o=i?t.subarray(n,n+i):t.subarray(n);s.bufferSubData(a,r,o)}else s.bufferSubData(a,r,t);return this}},ci=class extends ur{constructor(t,r,n=void 0){super(t,r);this.handle=n||t.createBuffer(),t.bindBuffer(r,this.handle)}build(){return this.handle}};function vh(e,t,r){let n=ui(e,t);return new n(r)}function mh(e,t,r,n=void 0){let i=e.createBuffer();if(e.bindBuffer(t,i),!ArrayBuffer.isView(r))throw new Error("Source data must be a typed array.");return e.bufferData(t,r,n||e.STATIC_DRAW),i}function ui(e,t){switch(t){case e.BYTE:return Int8Array;case e.UNSIGNED_BYTE:return Uint8Array;case e.SHORT:return Int16Array;case e.UNSIGNED_SHORT:return Uint16Array;case e.INT:return Int32Array;case e.UNSIGNED_INT:return Uint32Array;case e.FLOAT:return Float32Array;default:throw new Error("Cannot find valid typed array for buffer type.")}}function fr(e,t){switch(t){case Int8Array:return e.BYTE;case Uint8Array:return e.UNSIGNED_BYTE;case Int16Array:return e.SHORT;case Uint16Array:return e.UNSIGNED_SHORT;case Int32Array:return e.INT;case Uint32Array:return e.UNSIGNED_INT;case Float32Array:return e.FLOAT;default:throw new Error("Cannot find valid buffer type for typed array.")}}function xh(e,t,r){return e.bindBuffer(t,r),e.getBufferParameter(t,e.BUFFER_USAGE)}var lt=Object.freeze({__proto__:null,createBufferSource:vh,createBuffer:mh,getBufferTypedArray:ui,getTypedArrayBufferType:fr,getBufferUsage:xh}),we=class{static builder(t,r){return new pi(t,r)}constructor(t,r,n,i){this.gl=t,this.target=r,this.handle=i,this.type=n,this.bindContext=new fi(t,this)}bind(t){return t.bindBuffer(this.target,this.handle),this.bindContext.gl=t,this.bindContext}},fi=class extends ur{constructor(t,r){super(t,r.target);this.parent=r}},pi=class extends ci{constructor(t,r){super(t,r);this.bufferType=t.FLOAT}data(t,r=void 0){if(super.data(t,r),typeof t!="number"){let n=t.constructor;this.bufferType=fr(this.gl,n)}return this}subData(t,r=void 0,n=void 0,i=void 0){super.subData(t,r,n,i);let s=t.constructor;return this.bufferType=fr(this.gl,s),this}build(){let t=super.build(),r=this.gl,n=this.target,i=this.bufferType;return new we(r,n,i,t)}};function _h(e,t){switch(t){case e.FLOAT:return e.uniform1f;case e.FLOAT_VEC2:return e.uniform2fv;case e.FLOAT_VEC3:return e.uniform3fv;case e.FLOAT_VEC4:return e.uniform4fv;case e.INT:return e.uniform1i;case e.INT_VEC2:return e.uniform2iv;case e.INT_VEC3:return e.uniform3iv;case e.INT_VEC4:return e.uniform4iv;case e.BOOL:return e.uniform1i;case e.BOOL_VEC2:return e.uniform2iv;case e.BOOL_VEC3:return e.uniform3iv;case e.BOOL_VEC4:return e.uniform4iv;case e.FLOAT_MAT2:return di;case e.FLOAT_MAT3:return vi;case e.FLOAT_MAT4:return mi;case e.SAMPLER_2D:case e.SAMPLER_CUBE:return e.uniform1i}if(cr(e))switch(t){case e.UNSIGNED_INT:return e.uniform1ui;case e.UNSIGNED_INT_VEC2:return e.uniform2uiv;case e.UNSIGNED_INT_VEC3:return e.uniform3uiv;case e.UNSIGNED_INT_VEC4:return e.uniform4uiv;case e.FLOAT_MAT2x3:return xi;case e.FLOAT_MAT2x4:return _i;case e.FLOAT_MAT3x2:return gi;case e.FLOAT_MAT3x4:return yi;case e.FLOAT_MAT4x2:return Ai;case e.FLOAT_MAT4x3:return Ei;case e.SAMPLER_3D:case e.SAMPLER_2D_SHADOW:case e.SAMPLER_2D_ARRAY:case e.SAMPLER_2D_ARRAY_SHADOW:case e.SAMPLER_CUBE_SHADOW:case e.INT_SAMPLER_2D:case e.INT_SAMPLER_3D:case e.INT_SAMPLER_CUBE:case e.INT_SAMPLER_2D_ARRAY:case e.UNSIGNED_INT_SAMPLER_2D:case e.UNSIGNED_INT_SAMPLER_3D:case e.UNSIGNED_INT_SAMPLER_CUBE:case e.UNSIGNED_INT_SAMPLER_2D_ARRAY:return e.uniform1i}throw new Error("Cannot find uniform function for gl enum.")}function gh(e,t){switch(t){case e.FLOAT:return e.uniform1fv;case e.FLOAT_VEC2:return e.uniform2fv;case e.FLOAT_VEC3:return e.uniform3fv;case e.FLOAT_VEC4:return e.uniform4fv;case e.INT:return e.uniform1iv;case e.INT_VEC2:return e.uniform2iv;case e.INT_VEC3:return e.uniform3iv;case e.INT_VEC4:return e.uniform4iv;case e.BOOL:return e.uniform1iv;case e.BOOL_VEC2:return e.uniform2iv;case e.BOOL_VEC3:return e.uniform3iv;case e.BOOL_VEC4:return e.uniform4iv;case e.FLOAT_MAT2:return di;case e.FLOAT_MAT3:return vi;case e.FLOAT_MAT4:return mi;case e.SAMPLER_2D:case e.SAMPLER_CUBE:return e.uniform1iv}if(cr(e))switch(t){case e.UNSIGNED_INT:return e.uniform1uiv;case e.UNSIGNED_INT_VEC2:return e.uniform2uiv;case e.UNSIGNED_INT_VEC3:return e.uniform3uiv;case e.UNSIGNED_INT_VEC4:return e.uniform4uiv;case e.FLOAT_MAT2x3:return xi;case e.FLOAT_MAT2x4:return _i;case e.FLOAT_MAT3x2:return gi;case e.FLOAT_MAT3x4:return yi;case e.FLOAT_MAT4x2:return Ai;case e.FLOAT_MAT4x3:return Ei;case e.SAMPLER_3D:case e.SAMPLER_2D_SHADOW:case e.SAMPLER_2D_ARRAY:case e.SAMPLER_2D_ARRAY_SHADOW:case e.SAMPLER_CUBE_SHADOW:case e.INT_SAMPLER_2D:case e.INT_SAMPLER_3D:case e.INT_SAMPLER_CUBE:case e.INT_SAMPLER_2D_ARRAY:case e.UNSIGNED_INT_SAMPLER_2D:case e.UNSIGNED_INT_SAMPLER_3D:case e.UNSIGNED_INT_SAMPLER_CUBE:case e.UNSIGNED_INT_SAMPLER_2D_ARRAY:return e.uniform1iv}throw new Error("Cannot find array uniform function for gl enum.")}function di(e,t){this.uniformMatrix2fv(e,!1,t)}function vi(e,t){this.uniformMatrix3fv(e,!1,t)}function mi(e,t){this.uniformMatrix4fv(e,!1,t)}function xi(e,t){this.uniformMatrix2x3fv(e,!1,t)}function _i(e,t){this.uniformMatrix2x4fv(e,!1,t)}function gi(e,t){this.uniformMatrix3x2fv(e,!1,t)}function yi(e,t){this.uniformMatrix3x4fv(e,!1,t)}function Ai(e,t){this.uniformMatrix4x2fv(e,!1,t)}function Ei(e,t){this.uniformMatrix4x3fv(e,!1,t)}function yh(e,t){let r=[],n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;++i){let s=e.getActiveUniform(t,i);if(!s)break;r.push(s)}return r}function Ah(e,t){let r=[],n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<n;++i){let s=e.getActiveAttrib(t,i);!s||r.push(s)}return r}function Eh(e,t){let r={},n=yh(e,t);for(let i of n){let s=i.name,a=i.size,o=i.type,l=e.getUniformLocation(t,s),h;a<=1?h=_h(e,o):h=gh(e,o),r[s]={type:o,length:a,location:l,set:h}}return r}function Mh(e,t){switch(t){case e.FLOAT:return 1;case e.FLOAT_VEC2:return 2;case e.FLOAT_VEC3:return 3;case e.FLOAT_VEC4:return 4;case e.FLOAT_MAT2:return 4;case e.FLOAT_MAT3:return 9;case e.FLOAT_MAT4:return 16;default:throw new Error("Invalid vertex attribute type.")}}function wh(e,t){let r={},n=Ah(e,t);for(let i of n){let s=i.name,a=i.size,o=i.type,l=e.getAttribLocation(t,s),h=Mh(e,o);r[s]={type:o,length:a,location:l,size:h}}return r}function bh(e,t,r){let n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)||(console.error(e.getShaderInfoLog(n)+`
Failed to compile shader:
${r}`),e.deleteShader(n)),n}function Th(e,t,r){for(let i of r)e.attachShader(t,i);e.linkProgram(t);for(let i of r)e.detachShader(t,i),e.deleteShader(i);return e.getProgramParameter(t,e.LINK_STATUS)||(console.error(e.getProgramInfoLog(t)),e.deleteProgram(t)),t}function Sh(e,t,r,n,i=void 0){i?(e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,i),e.drawElements(t,n,e.UNSIGNED_SHORT,r)):e.drawArrays(t,r,n)}var Mi=class{constructor(t,r=void 0){this.handle=r||t.createProgram(),this.shaders=[],this.gl=t}shader(t,r){let n=this.gl,i=bh(n,t,r);return this.shaders.push(i),this}link(){let t=this.gl;return Th(t,this.handle,this.shaders),this.shaders.length=0,this.handle}},Fe=class{static builder(t){return new bi(t)}constructor(t,r){this.handle=r,this.activeUniforms=Eh(t,r),this.activeAttributes=wh(t,r),this.drawContext=new wi(t,this)}bind(t){return t.useProgram(this.handle),this.drawContext.gl=t,this.drawContext}},wi=class{constructor(t,r){this.gl=t,this.parent=r}uniform(t,r){let n=this.parent.activeUniforms;if(t in n){let i=n[t],s=i.location;i.set.call(this.gl,s,r)}return this}attribute(t,r,n,i=!1,s=0,a=0){let o=this.gl,l=this.parent.activeAttributes;if(t in l){let h=l[t],c=h.location,u=h.size;n?(o.bindBuffer(o.ARRAY_BUFFER,n),o.vertexAttribPointer(c,u,r,i,s,a),o.enableVertexAttribArray(c)):o.disableVertexAttribArray(c)}return this}draw(t,r,n,i,s=null){return Sh(t,r,n,i,s),this.parent}},bi=class extends Mi{constructor(t){super(t)}link(){let t=super.link();return new Fe(this.gl,t)}};var fe={red(e){return e>>16&255},redf(e){return(e>>16&255)/255},green(e){return e>>8&255},greenf(e){return(e>>8&255)/255},blue(e){return e&255},bluef(e){return(e&255)/255},alpha(e){return e>>24&255},alphaf(e){return(e>>24&255)/255}};var ht=class{constructor(t){let r=t.getContext("webgl");this.gl=r,this.transformStack=[]}pushTranslation(t,r,n=0){let i=k.create();return k.fromTranslation(i,Y.fromValues(t,r,n)),this.pushTransform(i)}pushRotation(t,r=0,n=0){let i=k.create();return!r&&!n?k.fromZRotation(i,Math.PI*t/180):k.fromRotationTranslationScaleOrigin(i,ie.fromEuler(ie.create(),0,0,t),Y.fromValues(0,0,0),Y.fromValues(1,1,1),Y.fromValues(r,n,0)),this.pushTransform(i)}pushScaling(t,r,n=0,i=0){let s=k.create();return!n&&!i?k.fromScaling(s,Y.fromValues(t,r,1)):k.fromRotationTranslationScaleOrigin(s,ie.fromEuler(ie.create(),0,0,0),Y.fromValues(0,0,0),Y.fromValues(t,r,1),Y.fromValues(n,i,0)),this.pushTransform(s)}pushTransform(t){if(this.transformStack.length>0){let r=this.transformStack.length-1,n=this.transformStack[r],i=k.mul(k.create(),n,t);this.transformStack.push(i)}else this.transformStack.push(k.copy(k.create(),t));return this}popTransform(){return this.transformStack.pop(),this}peekTransform(){let t=this.transformStack.length-1;return t>=0?this.transformStack[t]:null}resetTransform(){return this.transformStack.length=0,this}};var Ti=16,Rh=(()=>{let e=[],t=Ti,r=Math.PI*2/t,n=1,i=0,s,a;for(let o=0;o<=t;++o)s=Math.cos(o*r),a=Math.sin(o*r),e.push(0,0),e.push(n,i),e.push(s,a),n=s,i=a;return e})(),Xc=Math.trunc(Rh.length/2),Lh=(()=>{let e=[],t=Ti,r=Math.PI*2/t,n=1,i=0,s,a;for(let o=0;o<=t;++o)s=Math.cos(o*r),a=Math.sin(o*r),e.push(n,i),e.push(s,a),n=s,i=a;return e})(),Wc=Math.trunc(Lh.length/2);var Ih=`
attribute vec2 a_position;
attribute vec2 a_texcoord;

varying vec2 v_texcoord;

uniform mat4 u_projection_view;
uniform mat4 u_model;

void main()
{
    vec4 position = u_projection_view * u_model
        * vec4(a_position.xy, 0.0, 1.0);
    v_texcoord = a_texcoord;
    gl_Position = position;
}`,Ch=`
precision mediump float;

varying vec2 v_texcoord;

uniform sampler2D u_texture;
uniform vec2 u_texture_size;
uniform vec4 u_sprite;
uniform vec3 u_color;

void main()
{
    float spriteWidth = u_sprite.z - u_sprite.x;
    float spriteHeight = u_sprite.w - u_sprite.y;
    vec2 texcoord = vec2(
        (u_sprite.x / u_texture_size.x) + v_texcoord.x * (spriteWidth / u_texture_size.x),
        (u_sprite.y / u_texture_size.y) + v_texcoord.y * (spriteHeight / u_texture_size.y));
    vec4 texcolor = texture2D(u_texture, texcoord);
    if (texcolor.a < 0.5) discard;
    gl_FragColor = vec4(
        texcolor.r * u_color.r,
        texcolor.g * u_color.g,
        texcolor.b * u_color.b,
        texcolor.a);
}`,Si=[0,0,1,0,0,1,1,1,1,0,0,1],be=class extends ht{constructor(t){super(t);let r=this.gl;r.enable(r.DEPTH_TEST),this.program=Fe.builder(r).shader(r.VERTEX_SHADER,Ih).shader(r.FRAGMENT_SHADER,Ch).link(),this.meshQuad={position:we.builder(r,r.ARRAY_BUFFER).data(lt.createBufferSource(r,r.FLOAT,Si)).build(),texcoord:we.builder(r,r.ARRAY_BUFFER).data(lt.createBufferSource(r,r.FLOAT,Si)).build()},this.program.bind(r).attribute("a_position",r.FLOAT,this.meshQuad.position.handle).attribute("a_texcoord",r.FLOAT,this.meshQuad.texcoord.handle),this.camera=new ot,this.projectionViewMatrix=k.create(),this.modelMatrix=k.create(),this.spriteVector=Me.fromValues(0,0,1,1),this.textureSize=Pe.fromValues(1,1),this.textureHandle=null,this.textureList=new Array(r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS)),this.frameMap={},this.spriteMap={},this.defaultSprite={frames:[]},this.spriteColor=Y.fromValues(1,1,1),this.program.bind(r).uniform("u_color",this.spriteColor),this.spriteDepth=0}prepare(){this.resetTransform(),this.resize(),this.clear(),this.color(16777215),this.zLevel(0)}resize(){let t=this.gl,r=t.canvas.width,n=t.canvas.height;t.viewport(0,0,r,n);let i=this.camera;i.resize(r,n);let s=this.projectionViewMatrix;k.mul(s,i.projectionMatrix,i.viewMatrix),this.program.bind(t).uniform("u_projection_view",s)}clear(t=0){let r=this.gl;r.clearColor(fe.redf(t),fe.greenf(t),fe.bluef(t),fe.alphaf(t)),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),this.resetTransform()}texture(t,r,n=void 0){let i=this.textureList.length;if(t<0||t>=i)throw new Error(`Invalid texture unit - must be within range [0, ${i-1}]`);let s=this.gl,a=this.textureList[t];return a&&Oh(s,a.handle),this.textureList[t]=Nh(s,r),s.activeTexture(s.TEXTURE0+t),typeof n!="undefined"&&this.frame(n,t),this}frame(t,r=0,n=0,i=0,s=void 0,a=void 0){let o=this.textureList[r];if(!o)throw new Error(`Missing bound texture for texture unit ${r}.`);typeof s=="undefined"&&(s=o.width),typeof a=="undefined"&&(a=o.height);let l=this.frameMap;return l[t]=[r,n,i,s,a],this}sprite(t,r){let n=this.spriteMap;return n[t]={frames:r},this}color(t=16777215){let r=this.gl,n=this.program,i=this.spriteColor;return Y.set(i,fe.redf(t),fe.greenf(t),fe.bluef(t)),n.bind(r).uniform("u_color",i),this}zLevel(t=0){return this.spriteDepth=t,this}draw(t,r=0,n=0,i=0,s=0,a=1,o=a){let l=this.spriteMap,h;if(t in l)h=l[t];else{let E=this.frameMap,M=this.defaultSprite,P=M.frames;P.length=0,t in E&&P.push(t),h=M}let c=h.frames.length;if(c<=0)return this;r=Math.floor(r)%c;let u=this.frameMap,f=h.frames[r],d=u[f],[v,m,p,y,L]=d,A=this.textureList[v],{handle:w,width:b,height:S}=A;this.textureHandle=w,Pe.set(this.textureSize,b,S),Me.set(this.spriteVector,m,p,y,L);let I=this.gl;return Ph(I,this.program,this.meshQuad,this.peekTransform(),this.modelMatrix,this.textureHandle,this.textureSize,this.spriteVector,n,i,this.spriteDepth,s,a,o),this}};function Nh(e,t){if(!(t instanceof Image))throw new Error(`Not a valid image ${t}.`);let r=0,n=e.RGBA,i=e.RGBA,s=e.UNSIGNED_BYTE,a=e.createTexture();return e.bindTexture(e.TEXTURE_2D,a),e.texImage2D(e.TEXTURE_2D,r,n,i,s,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),{handle:a,width:t.width,height:t.height}}function Oh(e,t){e.deleteTexture(t)}function Ph(e,t,r,n,i,s,a,o,l,h,c,u,f,d){let{position:v,texcoord:m}=r,p=o[2]-o[0],y=o[3]-o[1];k.fromRotationTranslationScaleOrigin(i,ie.fromEuler(ie.create(),0,0,u),Y.fromValues(l,h,c),Y.fromValues(f,d,1),Y.fromValues(p/2,y/2,0)),k.scale(i,i,Y.fromValues(p,y,1)),n&&k.mul(i,n,i),s&&(e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,s)),t.bind(e).attribute("a_position",e.FLOAT,v.handle).attribute("a_texcoord",e.FLOAT,m.handle).uniform("u_model",i).uniform("u_texture",0).uniform("u_sprite",o).uniform("u_texture_size",a).draw(e,e.TRIANGLES,0,6)}var Fh=16,pr=16,iu=pr/2,Bh=Fh*pr,su=1/Bh;var Dh=.3,Iu=1-Dh;var Uh={spriteName:"font.0",spriteIndex:0,spriteSpeed:0},kh=60,zh=1e3/kh,ct=class{constructor(t){this.game=t,this.renderer=new be(t.display.canvas),this.objects=[]}async load(){let{assets:t}=this.game,r=this.renderer;r.texture(0,t.getAsset("image:font.png"),"font.all"),$h(r,0)}registerTextureAtlas(t,r,n){let i=this.renderer;return i.texture(t,r),jh(i,1,n),this}registerTexture(t,r,n=void 0){return this.renderer.texture(t,r,n),this}createSprite(t,r=0,n=0){let i=this.createObject(r,n);return i.renderType="sprite",i.renderInfo={spriteName:t,spriteIndex:0,spriteSpeed:1},i}createText(t,r=0,n=0){let i=this.createObject(r,n);return i.renderType="text",i.renderInfo={text:t},i}createObject(t=0,r=0){let n=new Li(this);return n.x=t,n.y=r,this.objects.push(n),n}destroyObject(t){let r=this.objects.indexOf(t);r>=0&&this.objects.splice(r,1)}getObjects(){return this.objects}draw(){let{deltaTime:t}=this.game,r=t/zh,n=this.renderer;n.prepare();for(let i of this.objects)switch(i.renderType){case"null":Ri(n,i,Uh);break;case"sprite":Ri(n,i,i.renderInfo),i.renderInfo.spriteIndex+=i.renderInfo.spriteSpeed*r;break;case"text":Hh(n,i,i.renderInfo);break}}};function Ri(e,t,r){e.draw(r.spriteName,r.spriteIndex,t.x,t.y,t.rotation,t.scaleX,t.scaleY)}function Hh(e,t,r){let{x:n,y:i}=t,s=r.text,a=n,o="A".charCodeAt(0);s=s.toUpperCase();for(let l=0;l<s.length;++l){let h=s.charAt(l);if(h===`
`){i+=8,n=a;continue}else if(h===" "){n+=8;continue}else{n+=8;let c=Math.abs(s.charCodeAt(l)-o)%40;e.draw("font",c,n,i)}}}var Li=class{constructor(t){this.world=t,this.x=0,this.y=0,this.z=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.renderType="null",this.renderInfo=null}};function $h(e,t){let r=[],n=8,i=8;for(let s=0;s<40;++s){let a=s%8*n,o=Math.floor(s/8)*i,l=a+n,h=o+i,c=`font.${s}`;r.push(c),e.frame(c,t,a,o,l,h)}e.sprite("font",r)}function jh(e,t,r){for(let n of Object.values(r)){let{u:i,v:s,w:a,h:o,cols:l,rows:h,name:c}=n,u=[];for(let f=0;f<l;++f)for(let d=0;d<h;++d){let v=`${c}.${f}`;u.push(v),e.frame(v,t,i+f*a,s+d*o,i+(f+1)*a,s+(d+1)*o)}e.sprite(`${c}`,u)}}async function Ii(e){let{display:t,inputs:r,assets:n}=e;r.bindAxis("cursorX","Mouse","PosX"),r.bindAxis("cursorY","Mouse","PosY"),r.bindButton("activate","Mouse","Button0"),r.bindButton("activate","Mouse","Button2");let i=new ct(e);await i.load(),i.registerTexture(1,n.getAsset("image:water_tile.png"),"water_tile");let s=i.createSprite("water_tile");s.x=10,s.y=10,s.scaleX=2,s.scaleY=2,e.on("frame",()=>{if(i.draw(),r.isButtonReleased("activate")){let a=i.createSprite("water_tile");a.x=r.getAxisValue("cursorX")*t.width,a.y=r.getAxisValue("cursorY")*t.height}})}window.addEventListener("DOMContentLoaded",Vh);async function Vh(){let e=document.querySelector("#display"),t=document.querySelector("#inputs").getContext("axisbutton"),r=document.querySelector("#assets"),n=new Promise((s,a)=>{r.addEventListener("load",s),r.addEventListener("error",a)});r.src="res.pack",await n,await r.pipe("res/**/*.png",async(s,a)=>r.cache("image:"+a.substring(4),await Vt(s,"image/png"))),await r.pipe("res/**/*.obj",async(s,a)=>r.cache("obj:"+a.substring(4),await Gt(s))),await r.pipe("res/**/*.atlas",async(s,a)=>r.cache("atlas:"+a.substring(4),await Yt(s))),await r.pipe("res/**/*.wav",async(s,a)=>{let o=et.getAudioContext(),l=await qt(s,o),h=new et(o,l);return r.cache("sound:"+a.substring(4),h)});let i=new jt(e,t,r);e.addEventListener("frame",s=>{let{deltaTime:a,prevTime:o,now:l}=s.detail;i.deltaTime=a,i.prevTime=o,i.now=l,t.poll(l),i.emit("frame")}),await Ii(i)}})();
//# sourceMappingURL=main.js.map
