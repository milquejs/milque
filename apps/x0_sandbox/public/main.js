(()=>{var Li=Object.create,Qe=Object.defineProperty,Ci=Object.getPrototypeOf,Ii=Object.prototype.hasOwnProperty,Oi=Object.getOwnPropertyNames,Ni=Object.getOwnPropertyDescriptor;var Bi=t=>Qe(t,"__esModule",{value:!0});var Di=(t,e)=>()=>(t&&(e=t(t=0)),e),Re=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),_t=(t,e)=>{for(var r in e)Qe(t,r,{get:e[r],enumerable:!0})},Fi=(t,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Oi(e))!Ii.call(t,n)&&n!=="default"&&Qe(t,n,{get:()=>e[n],enumerable:!(r=Ni(e,n))||r.enumerable});return t},Pi=t=>Fi(Bi(Qe(t!=null?Li(Ci(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var Nr={};_t(Nr,{basename:()=>Hr,default:()=>_o,delimiter:()=>Ur,dirname:()=>kr,extname:()=>Vr,isAbsolute:()=>Ot,join:()=>Dr,normalize:()=>Nt,relative:()=>Fr,resolve:()=>et,sep:()=>Pr});function Br(t,e){for(var r=0,n=t.length-1;n>=0;n--){var i=t[n];i==="."?t.splice(n,1):i===".."?(t.splice(n,1),r++):r&&(t.splice(n,1),r--)}if(e)for(;r--;r)t.unshift("..");return t}function et(){for(var t="",e=!1,r=arguments.length-1;r>=-1&&!e;r--){var n=r>=0?arguments[r]:"/";if(typeof n!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!n)continue;t=n+"/"+t,e=n.charAt(0)==="/"}return t=Br(It(t.split("/"),function(i){return!!i}),!e).join("/"),(e?"/":"")+t||"."}function Nt(t){var e=Ot(t),r=mo(t,-1)==="/";return t=Br(It(t.split("/"),function(n){return!!n}),!e).join("/"),!t&&!e&&(t="."),t&&r&&(t+="/"),(e?"/":"")+t}function Ot(t){return t.charAt(0)==="/"}function Dr(){var t=Array.prototype.slice.call(arguments,0);return Nt(It(t,function(e,r){if(typeof e!="string")throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))}function Fr(t,e){t=et(t).substr(1),e=et(e).substr(1);function r(h){for(var d=0;d<h.length&&h[d]==="";d++);for(var x=h.length-1;x>=0&&h[x]==="";x--);return d>x?[]:h.slice(d,x-d+1)}for(var n=r(t.split("/")),i=r(e.split("/")),s=Math.min(n.length,i.length),o=s,a=0;a<s;a++)if(n[a]!==i[a]){o=a;break}for(var l=[],a=o;a<n.length;a++)l.push("..");return l=l.concat(i.slice(o)),l.join("/")}function kr(t){var e=Ct(t),r=e[0],n=e[1];return!r&&!n?".":(n&&(n=n.substr(0,n.length-1)),r+n)}function Hr(t,e){var r=Ct(t)[2];return e&&r.substr(-1*e.length)===e&&(r=r.substr(0,r.length-e.length)),r}function Vr(t){return Ct(t)[3]}function It(t,e){if(t.filter)return t.filter(e);for(var r=[],n=0;n<t.length;n++)e(t[n],n,t)&&r.push(t[n]);return r}var po,Ct,Pr,Ur,_o,mo,jr=Di(()=>{po=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,Ct=function(t){return po.exec(t).slice(1)};Pr="/",Ur=":";_o={extname:Vr,basename:Hr,dirname:kr,sep:Pr,delimiter:Ur,relative:Fr,join:Dr,isAbsolute:Ot,normalize:Nt,resolve:et};mo="ab".substr(-1)==="b"?function(t,e,r){return t.substr(e,r)}:function(t,e,r){return e<0&&(e=t.length+e),t.substr(e,r)}});var rt=Re((_u,tt)=>{var we=(jr(),Nr);we&&we.default?tt.exports=we.default:we&&(tt.exports=we);if(we)for(let t in we)tt.exports[t]=we[t]});var Ve=Re((xu,zr)=>{"use strict";var xo=rt(),me="\\\\/",Gr=`[^${me}]`,Ee="\\.",go="\\+",vo="\\?",nt="\\/",Eo="(?=.)",Kr="[^/]",Bt=`(?:${nt}|$)`,Yr=`(?:^|${nt})`,Dt=`${Ee}{1,2}${Bt}`,yo=`(?!${Ee})`,wo=`(?!${Yr}${Dt})`,Ao=`(?!${Ee}{0,1}${Bt})`,To=`(?!${Dt})`,So=`[^.${nt}]`,bo=`${Kr}*?`,$r={DOT_LITERAL:Ee,PLUS_LITERAL:go,QMARK_LITERAL:vo,SLASH_LITERAL:nt,ONE_CHAR:Eo,QMARK:Kr,END_ANCHOR:Bt,DOTS_SLASH:Dt,NO_DOT:yo,NO_DOTS:wo,NO_DOT_SLASH:Ao,NO_DOTS_SLASH:To,QMARK_NO_DOT:So,STAR:bo,START_ANCHOR:Yr},Ro={...$r,SLASH_LITERAL:`[${me}]`,QMARK:Gr,STAR:`${Gr}*?`,DOTS_SLASH:`${Ee}{1,2}(?:[${me}]|$)`,NO_DOT:`(?!${Ee})`,NO_DOTS:`(?!(?:^|[${me}])${Ee}{1,2}(?:[${me}]|$))`,NO_DOT_SLASH:`(?!${Ee}{0,1}(?:[${me}]|$))`,NO_DOTS_SLASH:`(?!${Ee}{1,2}(?:[${me}]|$))`,QMARK_NO_DOT:`[^.${me}]`,START_ANCHOR:`(?:^|[${me}])`,END_ANCHOR:`(?:[${me}]|$)`},Mo={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};zr.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:Mo,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:xo.sep,extglobChars(t){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${t.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(t){return t===!0?Ro:$r}}});var it=Re(ne=>{"use strict";var Lo=rt(),Co=!1,{REGEX_BACKSLASH:Io,REGEX_REMOVE_BACKSLASH:Oo,REGEX_SPECIAL_CHARS:No,REGEX_SPECIAL_CHARS_GLOBAL:Bo}=Ve();ne.isObject=t=>t!==null&&typeof t=="object"&&!Array.isArray(t);ne.hasRegexChars=t=>No.test(t);ne.isRegexChar=t=>t.length===1&&ne.hasRegexChars(t);ne.escapeRegex=t=>t.replace(Bo,"\\$1");ne.toPosixSlashes=t=>t.replace(Io,"/");ne.removeBackslashes=t=>t.replace(Oo,e=>e==="\\"?"":e);ne.supportsLookbehinds=()=>{let t=process.version.slice(1).split(".").map(Number);return t.length===3&&t[0]>=9||t[0]===8&&t[1]>=10};ne.isWindows=t=>t&&typeof t.windows=="boolean"?t.windows:Co===!0||Lo.sep==="\\";ne.escapeLast=(t,e,r)=>{let n=t.lastIndexOf(e,r);return n===-1?t:t[n-1]==="\\"?ne.escapeLast(t,e,n-1):`${t.slice(0,n)}\\${t.slice(n)}`};ne.removePrefix=(t,e={})=>{let r=t;return r.startsWith("./")&&(r=r.slice(2),e.prefix="./"),r};ne.wrapOutput=(t,e={},r={})=>{let n=r.contains?"":"^",i=r.contains?"":"$",s=`${n}(?:${t})${i}`;return e.negated===!0&&(s=`(?:^(?!${s}).*$)`),s}});var tn=Re((vu,Wr)=>{"use strict";var Xr=it(),{CHAR_ASTERISK:Ft,CHAR_AT:Do,CHAR_BACKWARD_SLASH:je,CHAR_COMMA:Fo,CHAR_DOT:Pt,CHAR_EXCLAMATION_MARK:Ut,CHAR_FORWARD_SLASH:qr,CHAR_LEFT_CURLY_BRACE:kt,CHAR_LEFT_PARENTHESES:Ht,CHAR_LEFT_SQUARE_BRACKET:Po,CHAR_PLUS:Uo,CHAR_QUESTION_MARK:Qr,CHAR_RIGHT_CURLY_BRACE:ko,CHAR_RIGHT_PARENTHESES:Zr,CHAR_RIGHT_SQUARE_BRACKET:Ho}=Ve(),Jr=t=>t===qr||t===je,en=t=>{t.isPrefix!==!0&&(t.depth=t.isGlobstar?Infinity:1)},Vo=(t,e)=>{let r=e||{},n=t.length-1,i=r.parts===!0||r.scanToEnd===!0,s=[],o=[],a=[],l=t,h=-1,d=0,x=0,v=!1,S=!1,_=!1,A=!1,R=!1,C=!1,F=!1,I=!1,k=!1,P=!1,G=0,V,y,w={value:"",depth:0,isGlob:!1},K=()=>h>=n,p=()=>l.charCodeAt(h+1),B=()=>(V=y,l.charCodeAt(++h));for(;h<n;){y=B();let W;if(y===je){F=w.backslashes=!0,y=B(),y===kt&&(C=!0);continue}if(C===!0||y===kt){for(G++;K()!==!0&&(y=B());){if(y===je){F=w.backslashes=!0,B();continue}if(y===kt){G++;continue}if(C!==!0&&y===Pt&&(y=B())===Pt){if(v=w.isBrace=!0,_=w.isGlob=!0,P=!0,i===!0)continue;break}if(C!==!0&&y===Fo){if(v=w.isBrace=!0,_=w.isGlob=!0,P=!0,i===!0)continue;break}if(y===ko&&(G--,G===0)){C=!1,v=w.isBrace=!0,P=!0;break}}if(i===!0)continue;break}if(y===qr){if(s.push(h),o.push(w),w={value:"",depth:0,isGlob:!1},P===!0)continue;if(V===Pt&&h===d+1){d+=2;continue}x=h+1;continue}if(r.noext!==!0&&(y===Uo||y===Do||y===Ft||y===Qr||y===Ut)===!0&&p()===Ht){if(_=w.isGlob=!0,A=w.isExtglob=!0,P=!0,y===Ut&&h===d&&(k=!0),i===!0){for(;K()!==!0&&(y=B());){if(y===je){F=w.backslashes=!0,y=B();continue}if(y===Zr){_=w.isGlob=!0,P=!0;break}}continue}break}if(y===Ft){if(V===Ft&&(R=w.isGlobstar=!0),_=w.isGlob=!0,P=!0,i===!0)continue;break}if(y===Qr){if(_=w.isGlob=!0,P=!0,i===!0)continue;break}if(y===Po){for(;K()!==!0&&(W=B());){if(W===je){F=w.backslashes=!0,B();continue}if(W===Ho){S=w.isBracket=!0,_=w.isGlob=!0,P=!0;break}}if(i===!0)continue;break}if(r.nonegate!==!0&&y===Ut&&h===d){I=w.negated=!0,d++;continue}if(r.noparen!==!0&&y===Ht){if(_=w.isGlob=!0,i===!0){for(;K()!==!0&&(y=B());){if(y===Ht){F=w.backslashes=!0,y=B();continue}if(y===Zr){P=!0;break}}continue}break}if(_===!0){if(P=!0,i===!0)continue;break}}r.noext===!0&&(A=!1,_=!1);let U=l,ee="",f="";d>0&&(ee=l.slice(0,d),l=l.slice(d),x-=d),U&&_===!0&&x>0?(U=l.slice(0,x),f=l.slice(x)):_===!0?(U="",f=l):U=l,U&&U!==""&&U!=="/"&&U!==l&&Jr(U.charCodeAt(U.length-1))&&(U=U.slice(0,-1)),r.unescape===!0&&(f&&(f=Xr.removeBackslashes(f)),U&&F===!0&&(U=Xr.removeBackslashes(U)));let c={prefix:ee,input:t,start:d,base:U,glob:f,isBrace:v,isBracket:S,isGlob:_,isExtglob:A,isGlobstar:R,negated:I,negatedExtglob:k};if(r.tokens===!0&&(c.maxDepth=0,Jr(y)||o.push(w),c.tokens=o),r.parts===!0||r.tokens===!0){let W;for(let D=0;D<s.length;D++){let Z=W?W+1:d,X=s[D],q=t.slice(Z,X);r.tokens&&(D===0&&d!==0?(o[D].isPrefix=!0,o[D].value=ee):o[D].value=q,en(o[D]),c.maxDepth+=o[D].depth),(D!==0||q!=="")&&a.push(q),W=X}if(W&&W+1<t.length){let D=t.slice(W+1);a.push(D),r.tokens&&(o[o.length-1].value=D,en(o[o.length-1]),c.maxDepth+=o[o.length-1].depth)}c.slashes=s,c.parts=a}return c};Wr.exports=Vo});var on=Re((Eu,rn)=>{"use strict";var st=Ve(),oe=it(),{MAX_LENGTH:ot,POSIX_REGEX_SOURCE:jo,REGEX_NON_SPECIAL_CHARS:zo,REGEX_SPECIAL_CHARS_BACKREF:Go,REPLACEMENTS:nn}=st,Ko=(t,e)=>{if(typeof e.expandRange=="function")return e.expandRange(...t,e);t.sort();let r=`[${t.join("-")}]`;try{new RegExp(r)}catch(n){return t.map(i=>oe.escapeRegex(i)).join("..")}return r},Be=(t,e)=>`Missing ${t}: "${e}" - use "\\\\${e}" to match literal characters`,sn=(t,e)=>{if(typeof t!="string")throw new TypeError("Expected a string");t=nn[t]||t;let r={...e},n=typeof r.maxLength=="number"?Math.min(ot,r.maxLength):ot,i=t.length;if(i>n)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${n}`);let s={type:"bos",value:"",output:r.prepend||""},o=[s],a=r.capture?"":"?:",l=oe.isWindows(e),h=st.globChars(l),d=st.extglobChars(h),{DOT_LITERAL:x,PLUS_LITERAL:v,SLASH_LITERAL:S,ONE_CHAR:_,DOTS_SLASH:A,NO_DOT:R,NO_DOT_SLASH:C,NO_DOTS_SLASH:F,QMARK:I,QMARK_NO_DOT:k,STAR:P,START_ANCHOR:G}=h,V=E=>`(${a}(?:(?!${G}${E.dot?A:x}).)*?)`,y=r.dot?"":R,w=r.dot?I:k,K=r.bash===!0?V(r):P;r.capture&&(K=`(${K})`),typeof r.noext=="boolean"&&(r.noextglob=r.noext);let p={input:t,index:-1,start:0,dot:r.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:o};t=oe.removePrefix(t,p),i=t.length;let B=[],U=[],ee=[],f=s,c,W=()=>p.index===i-1,D=p.peek=(E=1)=>t[p.index+E],Z=p.advance=()=>t[++p.index]||"",X=()=>t.slice(p.index+1),q=(E="",j=0)=>{p.consumed+=E,p.index+=j},ae=E=>{p.output+=E.output!=null?E.output:E.value,q(E.value)},Se=()=>{let E=1;for(;D()==="!"&&(D(2)!=="("||D(3)==="?");)Z(),p.start++,E++;return E%2==0?!1:(p.negated=!0,p.start++,!0)},re=E=>{p[E]++,ee.push(E)},ie=E=>{p[E]--,ee.pop()},L=E=>{if(f.type==="globstar"){let j=p.braces>0&&(E.type==="comma"||E.type==="brace"),u=E.extglob===!0||B.length&&(E.type==="pipe"||E.type==="paren");E.type!=="slash"&&E.type!=="paren"&&!j&&!u&&(p.output=p.output.slice(0,-f.output.length),f.type="star",f.value="*",f.output=K,p.output+=f.output)}if(B.length&&E.type!=="paren"&&(B[B.length-1].inner+=E.value),(E.value||E.output)&&ae(E),f&&f.type==="text"&&E.type==="text"){f.value+=E.value,f.output=(f.output||"")+E.value;return}E.prev=f,o.push(E),f=E},ve=(E,j)=>{let u={...d[j],conditions:1,inner:""};u.prev=f,u.parens=p.parens,u.output=p.output;let m=(r.capture?"(":"")+u.open;re("parens"),L({type:E,value:j,output:p.output?"":_}),L({type:"paren",extglob:!0,value:Z(),output:m}),B.push(u)},be=E=>{let j=E.close+(r.capture?")":""),u;if(E.type==="negate"){let m=K;E.inner&&E.inner.length>1&&E.inner.includes("/")&&(m=V(r)),(m!==K||W()||/^\)+$/.test(X()))&&(j=E.close=`)$))${m}`),E.inner.includes("*")&&(u=X())&&/^\.[^\\/.]+$/.test(u)&&(j=E.close=`)${u})${m})`),E.prev.type==="bos"&&(p.negatedExtglob=!0)}L({type:"paren",extglob:!0,value:c,output:j}),ie("parens")};if(r.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(t)){let E=!1,j=t.replace(Go,(u,m,b,H,N,M)=>H==="\\"?(E=!0,u):H==="?"?m?m+H+(N?I.repeat(N.length):""):M===0?w+(N?I.repeat(N.length):""):I.repeat(b.length):H==="."?x.repeat(b.length):H==="*"?m?m+H+(N?K:""):K:m?u:`\\${u}`);return E===!0&&(r.unescape===!0?j=j.replace(/\\/g,""):j=j.replace(/\\+/g,u=>u.length%2==0?"\\\\":u?"\\":"")),j===t&&r.contains===!0?(p.output=t,p):(p.output=oe.wrapOutput(j,p,e),p)}for(;!W();){if(c=Z(),c==="\0")continue;if(c==="\\"){let u=D();if(u==="/"&&r.bash!==!0||u==="."||u===";")continue;if(!u){c+="\\",L({type:"text",value:c});continue}let m=/^\\+/.exec(X()),b=0;if(m&&m[0].length>2&&(b=m[0].length,p.index+=b,b%2!=0&&(c+="\\")),r.unescape===!0?c=Z():c+=Z(),p.brackets===0){L({type:"text",value:c});continue}}if(p.brackets>0&&(c!=="]"||f.value==="["||f.value==="[^")){if(r.posix!==!1&&c===":"){let u=f.value.slice(1);if(u.includes("[")&&(f.posix=!0,u.includes(":"))){let m=f.value.lastIndexOf("["),b=f.value.slice(0,m),H=f.value.slice(m+2),N=jo[H];if(N){f.value=b+N,p.backtrack=!0,Z(),!s.output&&o.indexOf(f)===1&&(s.output=_);continue}}}(c==="["&&D()!==":"||c==="-"&&D()==="]")&&(c=`\\${c}`),c==="]"&&(f.value==="["||f.value==="[^")&&(c=`\\${c}`),r.posix===!0&&c==="!"&&f.value==="["&&(c="^"),f.value+=c,ae({value:c});continue}if(p.quotes===1&&c!=='"'){c=oe.escapeRegex(c),f.value+=c,ae({value:c});continue}if(c==='"'){p.quotes=p.quotes===1?0:1,r.keepQuotes===!0&&L({type:"text",value:c});continue}if(c==="("){re("parens"),L({type:"paren",value:c});continue}if(c===")"){if(p.parens===0&&r.strictBrackets===!0)throw new SyntaxError(Be("opening","("));let u=B[B.length-1];if(u&&p.parens===u.parens+1){be(B.pop());continue}L({type:"paren",value:c,output:p.parens?")":"\\)"}),ie("parens");continue}if(c==="["){if(r.nobracket===!0||!X().includes("]")){if(r.nobracket!==!0&&r.strictBrackets===!0)throw new SyntaxError(Be("closing","]"));c=`\\${c}`}else re("brackets");L({type:"bracket",value:c});continue}if(c==="]"){if(r.nobracket===!0||f&&f.type==="bracket"&&f.value.length===1){L({type:"text",value:c,output:`\\${c}`});continue}if(p.brackets===0){if(r.strictBrackets===!0)throw new SyntaxError(Be("opening","["));L({type:"text",value:c,output:`\\${c}`});continue}ie("brackets");let u=f.value.slice(1);if(f.posix!==!0&&u[0]==="^"&&!u.includes("/")&&(c=`/${c}`),f.value+=c,ae({value:c}),r.literalBrackets===!1||oe.hasRegexChars(u))continue;let m=oe.escapeRegex(f.value);if(p.output=p.output.slice(0,-f.value.length),r.literalBrackets===!0){p.output+=m,f.value=m;continue}f.value=`(${a}${m}|${f.value})`,p.output+=f.value;continue}if(c==="{"&&r.nobrace!==!0){re("braces");let u={type:"brace",value:c,output:"(",outputIndex:p.output.length,tokensIndex:p.tokens.length};U.push(u),L(u);continue}if(c==="}"){let u=U[U.length-1];if(r.nobrace===!0||!u){L({type:"text",value:c,output:c});continue}let m=")";if(u.dots===!0){let b=o.slice(),H=[];for(let N=b.length-1;N>=0&&(o.pop(),b[N].type!=="brace");N--)b[N].type!=="dots"&&H.unshift(b[N].value);m=Ko(H,r),p.backtrack=!0}if(u.comma!==!0&&u.dots!==!0){let b=p.output.slice(0,u.outputIndex),H=p.tokens.slice(u.tokensIndex);u.value=u.output="\\{",c=m="\\}",p.output=b;for(let N of H)p.output+=N.output||N.value}L({type:"brace",value:c,output:m}),ie("braces"),U.pop();continue}if(c==="|"){B.length>0&&B[B.length-1].conditions++,L({type:"text",value:c});continue}if(c===","){let u=c,m=U[U.length-1];m&&ee[ee.length-1]==="braces"&&(m.comma=!0,u="|"),L({type:"comma",value:c,output:u});continue}if(c==="/"){if(f.type==="dot"&&p.index===p.start+1){p.start=p.index+1,p.consumed="",p.output="",o.pop(),f=s;continue}L({type:"slash",value:c,output:S});continue}if(c==="."){if(p.braces>0&&f.type==="dot"){f.value==="."&&(f.output=x);let u=U[U.length-1];f.type="dots",f.output+=c,f.value+=c,u.dots=!0;continue}if(p.braces+p.parens===0&&f.type!=="bos"&&f.type!=="slash"){L({type:"text",value:c,output:x});continue}L({type:"dot",value:c,output:x});continue}if(c==="?"){if(!(f&&f.value==="(")&&r.noextglob!==!0&&D()==="("&&D(2)!=="?"){ve("qmark",c);continue}if(f&&f.type==="paren"){let m=D(),b=c;if(m==="<"&&!oe.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(f.value==="("&&!/[!=<:]/.test(m)||m==="<"&&!/<([!=]|\w+>)/.test(X()))&&(b=`\\${c}`),L({type:"text",value:c,output:b});continue}if(r.dot!==!0&&(f.type==="slash"||f.type==="bos")){L({type:"qmark",value:c,output:k});continue}L({type:"qmark",value:c,output:I});continue}if(c==="!"){if(r.noextglob!==!0&&D()==="("&&(D(2)!=="?"||!/[!=<:]/.test(D(3)))){ve("negate",c);continue}if(r.nonegate!==!0&&p.index===0){Se();continue}}if(c==="+"){if(r.noextglob!==!0&&D()==="("&&D(2)!=="?"){ve("plus",c);continue}if(f&&f.value==="("||r.regex===!1){L({type:"plus",value:c,output:v});continue}if(f&&(f.type==="bracket"||f.type==="paren"||f.type==="brace")||p.parens>0){L({type:"plus",value:c});continue}L({type:"plus",value:v});continue}if(c==="@"){if(r.noextglob!==!0&&D()==="("&&D(2)!=="?"){L({type:"at",extglob:!0,value:c,output:""});continue}L({type:"text",value:c});continue}if(c!=="*"){(c==="$"||c==="^")&&(c=`\\${c}`);let u=zo.exec(X());u&&(c+=u[0],p.index+=u[0].length),L({type:"text",value:c});continue}if(f&&(f.type==="globstar"||f.star===!0)){f.type="star",f.star=!0,f.value+=c,f.output=K,p.backtrack=!0,p.globstar=!0,q(c);continue}let E=X();if(r.noextglob!==!0&&/^\([^?]/.test(E)){ve("star",c);continue}if(f.type==="star"){if(r.noglobstar===!0){q(c);continue}let u=f.prev,m=u.prev,b=u.type==="slash"||u.type==="bos",H=m&&(m.type==="star"||m.type==="globstar");if(r.bash===!0&&(!b||E[0]&&E[0]!=="/")){L({type:"star",value:c,output:""});continue}let N=p.braces>0&&(u.type==="comma"||u.type==="brace"),M=B.length&&(u.type==="pipe"||u.type==="paren");if(!b&&u.type!=="paren"&&!N&&!M){L({type:"star",value:c,output:""});continue}for(;E.slice(0,3)==="/**";){let ce=t[p.index+4];if(ce&&ce!=="/")break;E=E.slice(3),q("/**",3)}if(u.type==="bos"&&W()){f.type="globstar",f.value+=c,f.output=V(r),p.output=f.output,p.globstar=!0,q(c);continue}if(u.type==="slash"&&u.prev.type!=="bos"&&!H&&W()){p.output=p.output.slice(0,-(u.output+f.output).length),u.output=`(?:${u.output}`,f.type="globstar",f.output=V(r)+(r.strictSlashes?")":"|$)"),f.value+=c,p.globstar=!0,p.output+=u.output+f.output,q(c);continue}if(u.type==="slash"&&u.prev.type!=="bos"&&E[0]==="/"){let ce=E[1]!==void 0?"|$":"";p.output=p.output.slice(0,-(u.output+f.output).length),u.output=`(?:${u.output}`,f.type="globstar",f.output=`${V(r)}${S}|${S}${ce})`,f.value+=c,p.output+=u.output+f.output,p.globstar=!0,q(c+Z()),L({type:"slash",value:"/",output:""});continue}if(u.type==="bos"&&E[0]==="/"){f.type="globstar",f.value+=c,f.output=`(?:^|${S}|${V(r)}${S})`,p.output=f.output,p.globstar=!0,q(c+Z()),L({type:"slash",value:"/",output:""});continue}p.output=p.output.slice(0,-f.output.length),f.type="globstar",f.output=V(r),f.value+=c,p.output+=f.output,p.globstar=!0,q(c);continue}let j={type:"star",value:c,output:K};if(r.bash===!0){j.output=".*?",(f.type==="bos"||f.type==="slash")&&(j.output=y+j.output),L(j);continue}if(f&&(f.type==="bracket"||f.type==="paren")&&r.regex===!0){j.output=c,L(j);continue}(p.index===p.start||f.type==="slash"||f.type==="dot")&&(f.type==="dot"?(p.output+=C,f.output+=C):r.dot===!0?(p.output+=F,f.output+=F):(p.output+=y,f.output+=y),D()!=="*"&&(p.output+=_,f.output+=_)),L(j)}for(;p.brackets>0;){if(r.strictBrackets===!0)throw new SyntaxError(Be("closing","]"));p.output=oe.escapeLast(p.output,"["),ie("brackets")}for(;p.parens>0;){if(r.strictBrackets===!0)throw new SyntaxError(Be("closing",")"));p.output=oe.escapeLast(p.output,"("),ie("parens")}for(;p.braces>0;){if(r.strictBrackets===!0)throw new SyntaxError(Be("closing","}"));p.output=oe.escapeLast(p.output,"{"),ie("braces")}if(r.strictSlashes!==!0&&(f.type==="star"||f.type==="bracket")&&L({type:"maybe_slash",value:"",output:`${S}?`}),p.backtrack===!0){p.output="";for(let E of p.tokens)p.output+=E.output!=null?E.output:E.value,E.suffix&&(p.output+=E.suffix)}return p};sn.fastpaths=(t,e)=>{let r={...e},n=typeof r.maxLength=="number"?Math.min(ot,r.maxLength):ot,i=t.length;if(i>n)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${n}`);t=nn[t]||t;let s=oe.isWindows(e),{DOT_LITERAL:o,SLASH_LITERAL:a,ONE_CHAR:l,DOTS_SLASH:h,NO_DOT:d,NO_DOTS:x,NO_DOTS_SLASH:v,STAR:S,START_ANCHOR:_}=st.globChars(s),A=r.dot?x:d,R=r.dot?v:d,C=r.capture?"":"?:",F={negated:!1,prefix:""},I=r.bash===!0?".*?":S;r.capture&&(I=`(${I})`);let k=y=>y.noglobstar===!0?I:`(${C}(?:(?!${_}${y.dot?h:o}).)*?)`,P=y=>{switch(y){case"*":return`${A}${l}${I}`;case".*":return`${o}${l}${I}`;case"*.*":return`${A}${I}${o}${l}${I}`;case"*/*":return`${A}${I}${a}${l}${R}${I}`;case"**":return A+k(r);case"**/*":return`(?:${A}${k(r)}${a})?${R}${l}${I}`;case"**/*.*":return`(?:${A}${k(r)}${a})?${R}${I}${o}${l}${I}`;case"**/.*":return`(?:${A}${k(r)}${a})?${o}${l}${I}`;default:{let w=/^(.*?)\.(\w+)$/.exec(y);if(!w)return;let K=P(w[1]);return K?K+o+w[2]:void 0}}},G=oe.removePrefix(t,F),V=P(G);return V&&r.strictSlashes!==!0&&(V+=`${a}?`),V};rn.exports=sn});var ln=Re((yu,an)=>{"use strict";var Yo=rt(),$o=tn(),Vt=on(),jt=it(),Wo=Ve(),Xo=t=>t&&typeof t=="object"&&!Array.isArray(t),$=(t,e,r=!1)=>{if(Array.isArray(t)){let d=t.map(v=>$(v,e,r));return v=>{for(let S of d){let _=S(v);if(_)return _}return!1}}let n=Xo(t)&&t.tokens&&t.input;if(t===""||typeof t!="string"&&!n)throw new TypeError("Expected pattern to be a non-empty string");let i=e||{},s=jt.isWindows(e),o=n?$.compileRe(t,e):$.makeRe(t,e,!1,!0),a=o.state;delete o.state;let l=()=>!1;if(i.ignore){let d={...e,ignore:null,onMatch:null,onResult:null};l=$(i.ignore,d,r)}let h=(d,x=!1)=>{let{isMatch:v,match:S,output:_}=$.test(d,o,e,{glob:t,posix:s}),A={glob:t,state:a,regex:o,posix:s,input:d,output:_,match:S,isMatch:v};return typeof i.onResult=="function"&&i.onResult(A),v===!1?(A.isMatch=!1,x?A:!1):l(d)?(typeof i.onIgnore=="function"&&i.onIgnore(A),A.isMatch=!1,x?A:!1):(typeof i.onMatch=="function"&&i.onMatch(A),x?A:!0)};return r&&(h.state=a),h};$.test=(t,e,r,{glob:n,posix:i}={})=>{if(typeof t!="string")throw new TypeError("Expected input to be a string");if(t==="")return{isMatch:!1,output:""};let s=r||{},o=s.format||(i?jt.toPosixSlashes:null),a=t===n,l=a&&o?o(t):t;return a===!1&&(l=o?o(t):t,a=l===n),(a===!1||s.capture===!0)&&(s.matchBase===!0||s.basename===!0?a=$.matchBase(t,e,r,i):a=e.exec(l)),{isMatch:Boolean(a),match:a,output:l}};$.matchBase=(t,e,r,n=jt.isWindows(r))=>(e instanceof RegExp?e:$.makeRe(e,r)).test(Yo.basename(t));$.isMatch=(t,e,r)=>$(e,r)(t);$.parse=(t,e)=>Array.isArray(t)?t.map(r=>$.parse(r,e)):Vt(t,{...e,fastpaths:!1});$.scan=(t,e)=>$o(t,e);$.compileRe=(t,e,r=!1,n=!1)=>{if(r===!0)return t.output;let i=e||{},s=i.contains?"":"^",o=i.contains?"":"$",a=`${s}(?:${t.output})${o}`;t&&t.negated===!0&&(a=`^(?!${a}).*$`);let l=$.toRegex(a,e);return n===!0&&(l.state=t),l};$.makeRe=(t,e={},r=!1,n=!1)=>{if(!t||typeof t!="string")throw new TypeError("Expected a non-empty string");let i={negated:!1,fastpaths:!0};return e.fastpaths!==!1&&(t[0]==="."||t[0]==="*")&&(i.output=Vt.fastpaths(t,e)),i.output||(i=Vt(t,e)),$.compileRe(i,e,r,n)};$.toRegex=(t,e)=>{try{let r=e||{};return new RegExp(t,r.flags||(r.nocase?"i":""))}catch(r){if(e&&e.debug===!0)throw r;return/$^/}};$.constants=Wo;an.exports=$});var hn=Re((wu,un)=>{"use strict";un.exports=ln()});var Ui=`<div class="container">
  <label class="hidden" id="title">display-port</label>
  <label class="hidden" id="fps">00</label>
  <label class="hidden" id="dimension">0x0</label>
  <div class="content">
    <canvas> Oh no! Your browser does not support canvas. </canvas>
    <slot id="inner"></slot>
  </div>
  <slot name="frame"></slot>
</div>
`,ki=`:host {
  display: inline-block;
  color: #555555;
}

.container {
  display: flex;
  position: relative;
  width: 100%;
  height: 100%;
}

.content {
  position: relative;
  margin: auto;
}

.content > *:not(canvas) {
  width: 100%;
  height: 100%;
}

canvas {
  background: #000000;
  image-rendering: pixelated;
}

label {
  position: absolute;
  font-family: monospace;
  color: currentColor;
}

#inner {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: 0;
  left: 0;
  pointer-events: none;
}

#title {
  left: 0.5rem;
  top: 0.5rem;
}

#fps {
  right: 0.5rem;
  top: 0.5rem;
}

#dimension {
  left: 0.5rem;
  bottom: 0.5rem;
}

.hidden {
  display: none;
}

:host([debug]) .container {
  outline: 6px dashed rgba(0, 0, 0, 0.1);
  outline-offset: -4px;
  background-color: rgba(0, 0, 0, 0.1);
}

:host([mode='noscale']) canvas {
  margin: 0;
  top: 0;
  left: 0;
}

:host([mode='stretch']) canvas,
:host([mode='scale']) canvas {
  width: 100%;
  height: 100%;
}

:host([mode='fit']),
:host([mode='scale']),
:host([mode='center']),
:host([mode='stretch']),
:host([mode='fill']) {
  width: 100%;
  height: 100%;
}

:host([full]) {
  width: 100vw !important;
  height: 100vh !important;
}

:host([disabled]) {
  display: none;
}

slot {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  pointer-events: none;
}

::slotted(*) {
  pointer-events: auto;
}
`,vr="noscale",xt="fit",Er="scale",yr="fill",wr="stretch",Hi=300,Vi=150,ji=xt,zi=200,Ar=class extends HTMLElement{static get[Symbol.for("templateNode")](){let e=document.createElement("template");return e.innerHTML=Ui,Object.defineProperty(this,Symbol.for("templateNode"),{value:e}),e}static get[Symbol.for("styleNode")](){let e=document.createElement("style");return e.innerHTML=ki,Object.defineProperty(this,Symbol.for("styleNode"),{value:e}),e}static define(e=window.customElements){e.define("display-port",this)}static get observedAttributes(){return["debug","disabled","width","height","onframe","id","class"]}get mode(){return this.getAttribute("mode")}set mode(e){this.setAttribute("mode",e)}get debug(){return this._debug}set debug(e){this.toggleAttribute("debug",e)}get disabled(){return this._disabled}set disabled(e){this.toggleAttribute("disabled",e)}get width(){return this._width}set width(e){this.setAttribute("width",String(e))}get height(){return this._height}set height(e){this.setAttribute("height",String(e))}get onframe(){return this._onframe}set onframe(e){this._onframe&&this.removeEventListener("frame",this._onframe),this._onframe=e,this._onframe&&this.addEventListener("frame",e)}constructor(){super();let e=this.attachShadow({mode:"open"});e.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),e.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._canvasElement=e.querySelector("canvas"),this._contentElement=e.querySelector(".content"),this._innerElement=e.querySelector("#inner"),this._titleElement=e.querySelector("#title"),this._fpsElement=e.querySelector("#fps"),this._dimensionElement=e.querySelector("#dimension"),this._debug=!1,this._disabled=!1,this._width=Hi,this._height=Vi,this._onframe=void 0,this._animationRequestHandle=0,this._prevAnimationFrameTime=0,this._resizeTimeoutHandle=0,this._resizeCanvasWidth=0,this._resizeCanvasHeight=0,this._frameEvent=new CustomEvent("frame",{composed:!0,bubbles:!1,detail:{now:0,prevTime:0,deltaTime:0,canvas:this._canvasElement}}),this._resizeEvent=new CustomEvent("resize",{composed:!0,bubbles:!1,detail:{width:0,height:0}}),this.update=this.update.bind(this),this.onDelayCanvasResize=this.onDelayCanvasResize.bind(this)}get canvas(){return this._canvasElement}connectedCallback(){Ne(this,"mode"),Ne(this,"debug"),Ne(this,"disabled"),Ne(this,"width"),Ne(this,"height"),Ne(this,"onframe"),this.hasAttribute("mode")||this.setAttribute("mode",ji),this.hasAttribute("tabindex")||this.setAttribute("tabindex","0"),this.updateCanvasSize(!0),this.resume()}disconnectedCallback(){this.pause()}attributeChangedCallback(e,r,n){switch(e){case"debug":this._debug=n!==null;break;case"disabled":this._disabled=n!==null;break;case"width":this._width=Number(n);break;case"height":this._height=Number(n);break;case"onframe":this.onframe=new Function("event","with(document){with(this){"+n+"}}").bind(this);break}switch(e){case"disabled":n?(this.update(0),this.pause()):this.resume();break;case"id":case"class":this._titleElement.innerHTML=`display-port${this.className?"."+this.className:""}${this.hasAttribute("id")?"#"+this.getAttribute("id"):""}`;break;case"debug":this._titleElement.classList.toggle("hidden",n),this._fpsElement.classList.toggle("hidden",n),this._dimensionElement.classList.toggle("hidden",n);break}}getContext(e="2d",r=void 0){return this._canvasElement.getContext(e,r)}pause(){cancelAnimationFrame(this._animationRequestHandle)}resume(){this._animationRequestHandle=requestAnimationFrame(this.update)}update(e){this._animationRequestHandle=requestAnimationFrame(this.update),this.updateCanvasSize(!1);let r=e-this._prevAnimationFrameTime;if(this._prevAnimationFrameTime=e,this._debug){let s=r<=0?"--":String(Math.round(1e3/r)).padStart(2,"0");if(this._fpsElement.textContent!==s&&(this._fpsElement.textContent=s),this.mode===vr){let a=`${this._width}x${this._height}`;this._dimensionElement.textContent!==a&&(this._dimensionElement.textContent=a)}else{let a=`${this._width}x${this._height}|${this.shadowRoot.host.clientWidth}x${this.shadowRoot.host.clientHeight}`;this._dimensionElement.textContent!==a&&(this._dimensionElement.textContent=a)}}let i=this._frameEvent.detail;i.now=e,i.prevTime=this._prevAnimationFrameTime,i.deltaTime=r,this.dispatchEvent(this._frameEvent)}onDelayCanvasResize(){this._resizeTimeoutHandle=0,this.updateCanvasSize(!0)}delayCanvasResize(e,r){(e!==this._resizeCanvasWidth||r!==this._resizeCanvasHeight)&&(this._resizeCanvasWidth=e,this._resizeCanvasHeight=r,this._resizeTimeoutHandle&&clearTimeout(this._resizeTimeoutHandle),this._resizeTimeoutHandle=setTimeout(this.onDelayCanvasResize,zi))}updateCanvasSize(e=!0){let r=this.shadowRoot.host.getBoundingClientRect(),n=r.width,i=r.height,s=this._canvasElement,o=this._width,a=this._height,l=this.mode;if(l===wr||l===yr)o=n,a=i;else if(l!==vr&&(n<o||i<a||l===xt||l==Er)){let d=n/o,x=i/a;d<x?(o=n,a=a*d):(o=o*x,a=i)}if(o=Math.floor(o),a=Math.floor(a),typeof e=="undefined"&&(e=s.clientWidth!==o||s.clientHeight!==a),!e){this.delayCanvasResize(o,a);return}let h=Math.min(o/this._width,a/this._height)*.5;if(this._innerElement.style.fontSize=`font-size: ${h}em`,e){l===Er?(s.width=this._width,s.height=this._height):l!==wr&&(s.width=o,s.height=a);let d=this._contentElement.style;d.width=`${o}px`,d.height=`${a}px`,(l===xt||l===yr)&&(this._width=o,this._height=a);let v=this._resizeEvent.detail;v.width=o,v.height=a,this.dispatchEvent(this._resizeEvent)}}};Ar.define();function Ne(t,e){if(Object.prototype.hasOwnProperty.call(t,e)){let r=t[e];delete t[e],t[e]=r}}var gt=class{get polling(){return performance.now()-this._lastPollingTime<1e3}get value(){return 0}get size(){return this._size}constructor(e){this._size=e,this._lastPollingTime=Number.MIN_SAFE_INTEGER}resize(e){this._size=e}getState(e){throw new Error("Missing implementation.")}onUpdate(e,r,n){throw new Error("Missing implementation.")}onStatus(e,r){throw new Error("Missing implementation.")}onPoll(e){this._lastPollingTime=e}onBind(e,r={}){e>=this._size&&this.resize(e+1)}onUnbind(){this.resize(0)}},He=class extends gt{static createAxisBindingState(){return{value:0,delta:0,inverted:!1}}get delta(){return this._delta}get value(){return this._value}constructor(e=0){super(e);let r=new Array;for(let n=0;n<e;++n)r.push(this.constructor.createAxisBindingState());this._state=r,this._value=0,this._delta=0}resize(e){let r=this._state,n=r.length,i;if(e<=n)i=r.slice(0,e);else{i=r;for(let s=n;s<e;++s)i.push(this.constructor.createAxisBindingState())}this._state=i,super.resize(e)}getState(e){return this._state[e].value}onPoll(e){let r=this._state,n=0,i=0,s=r.length;for(let o=0;o<s;++o){let a=r[o];n+=a.value*(a.inverted?-1:1),i+=a.delta,r[o].delta=0}this._value=n,this._delta=i,super.onPoll(e)}onUpdate(e,r,n){typeof r=="undefined"?this.onAxisChange(e,n):this.onAxisMove(e,r,n)}onStatus(e,r){this.onAxisStatus(e,r)}onBind(e,r={}){super.onBind(e,r);let{inverted:n=!1}=r,i=this._state;i[e].inverted=n}onAxisMove(e,r,n){let i=this._state[e];i.value=r,i.delta+=n}onAxisChange(e,r){let n=this._state[e];n.value+=r,n.delta+=r}onAxisStatus(e,r){let n=this._state[e],i=n.value;n.value=r,n.delta=r-i}},Gi=241,Tr=254,Ki=239,Me=1,vt=2,Et=4,yt=8,wt=16,Ze=class extends gt{get pressed(){return this._pressed}get repeated(){return this._repeated}get released(){return this._released}get down(){return this._down}get value(){return this._value}constructor(e=0){super(e);this._state=new Uint8Array(e),this._value=0,this._down=!1,this._pressed=!1,this._repeated=!1,this._released=!1}resize(e){let r=this._state,n=r.length,i;e<=n?i=r.slice(0,e):(i=new Uint8Array(e),i.set(r)),this._state=i,super.resize(e)}getState(e){let r=this._state[e],n=r&wt?-1:1;return(r&Me?1:0)*n}onPoll(e){let r=this._state,n=0,i=0,s=0,o=0,a=0,l=r.length;for(let h=0;h<l;++h){let d=r[h],x=d&Me,v=d&wt;i|=x,s|=d&vt,o|=d&Et,a|=d&yt,n+=(x?1:0)*(v?-1:1),r[h]&=Gi}this._value=n,this._down=i!==0,this._pressed=s!==0,this._repeated=o!==0,this._released=a!==0,super.onPoll(e)}onUpdate(e,r,n){n>0?this.onButtonPressed(e):this.onButtonReleased(e)}onStatus(e,r){this.onButtonStatus(e,r!==0)}onBind(e,r={}){super.onBind(e,r);let{inverted:n=!1}=r,i=this._state;n?i[e]|=wt:i[e]&=Ki}onButtonPressed(e){let r=this._state,n=r[e];n&Me||(n|=vt,n|=Me),n|=Et,r[e]=n}onButtonReleased(e){let r=this._state,n=r[e];n&Me&&(n|=yt,n&=Tr),r[e]=n}onButtonStatus(e,r){let n=this._state,i=n[e],s=Boolean(i&Me);r?i|=Me:i&=Tr,s&&!r&&(i|=yt),!s&&r&&(i|=vt,i|=Et),n[e]=i}},g=class{static parse(e){e=e.trim();let r=e.indexOf(".");if(r<0)throw new Error("Missing device separator for key code.");let n=e.substring(0,r);if(n.length<0)throw new Error("Missing device for key code.");let i=e.substring(r+1);if(i.length<0)throw new Error("Missing code for key code.");return new g(n,i)}constructor(e,r){this.device=e,this.code=r}toString(){return`${this.device}.${this.code}`}};function At(t,e){return new g(t,e)}function Yi(t){return"device"in t&&"code"in t}var T="Keyboard",fe="Mouse",$i=new g(T,"KeyA"),Wi=new g(T,"KeyB"),Xi=new g(T,"KeyC"),qi=new g(T,"KeyD"),Qi=new g(T,"KeyE"),Zi=new g(T,"KeyF"),Ji=new g(T,"KeyG"),es=new g(T,"KeyH"),ts=new g(T,"KeyI"),rs=new g(T,"KeyJ"),ns=new g(T,"KeyK"),is=new g(T,"KeyL"),ss=new g(T,"KeyM"),os=new g(T,"KeyN"),as=new g(T,"KeyO"),ls=new g(T,"KeyP"),us=new g(T,"KeyQ"),hs=new g(T,"KeyR"),cs=new g(T,"KeyS"),fs=new g(T,"KeyT"),ds=new g(T,"KeyU"),ps=new g(T,"KeyV"),ms=new g(T,"KeyW"),_s=new g(T,"KeyX"),xs=new g(T,"KeyY"),gs=new g(T,"KeyZ"),vs=new g(T,"Digit0"),Es=new g(T,"Digit1"),ys=new g(T,"Digit2"),ws=new g(T,"Digit3"),As=new g(T,"Digit4"),Ts=new g(T,"Digit5"),Ss=new g(T,"Digit6"),bs=new g(T,"Digit7"),Rs=new g(T,"Digit8"),Ms=new g(T,"Digit9"),Ls=new g(T,"Minus"),Cs=new g(T,"Equal"),Is=new g(T,"BracketLeft"),Os=new g(T,"BracketRight"),Ns=new g(T,"Semicolon"),Bs=new g(T,"Quote"),Ds=new g(T,"Backquote"),Fs=new g(T,"Backslash"),Ps=new g(T,"Comma"),Us=new g(T,"Period"),ks=new g(T,"Slash"),Hs=new g(T,"Escape"),Vs=new g(T,"Space"),js=new g(T,"CapsLock"),zs=new g(T,"Backspace"),Gs=new g(T,"Delete"),Ks=new g(T,"Tab"),Ys=new g(T,"Enter"),$s=new g(T,"ArrowUp"),Ws=new g(T,"ArrowDown"),Xs=new g(T,"ArrowLeft"),qs=new g(T,"ArrowRight"),Qs=new g(fe,"Button0"),Zs=new g(fe,"Button1"),Js=new g(fe,"Button2"),eo=new g(fe,"Button3"),to=new g(fe,"Button4"),ro=new g(fe,"PosX"),no=new g(fe,"PosY"),io=new g(fe,"WheelX"),so=new g(fe,"WheelY"),oo=new g(fe,"WheelZ"),se=Object.freeze({__proto__:null,from:At,isKeyCode:Yi,KEYBOARD:T,MOUSE:fe,KEY_A:$i,KEY_B:Wi,KEY_C:Xi,KEY_D:qi,KEY_E:Qi,KEY_F:Zi,KEY_G:Ji,KEY_H:es,KEY_I:ts,KEY_J:rs,KEY_K:ns,KEY_L:is,KEY_M:ss,KEY_N:os,KEY_O:as,KEY_P:ls,KEY_Q:us,KEY_R:hs,KEY_S:cs,KEY_T:fs,KEY_U:ds,KEY_V:ps,KEY_W:ms,KEY_X:_s,KEY_Y:xs,KEY_Z:gs,DIGIT_0:vs,DIGIT_1:Es,DIGIT_2:ys,DIGIT_3:ws,DIGIT_4:As,DIGIT_5:Ts,DIGIT_6:Ss,DIGIT_7:bs,DIGIT_8:Rs,DIGIT_9:Ms,MINUS:Ls,EQUAL:Cs,BRACKET_LEFT:Is,BRACKET_RIGHT:Os,SEMICOLON:Ns,QUOTE:Bs,BACKQUOTE:Ds,BACKSLASH:Fs,COMMA:Ps,PERIOD:Us,SLASH:ks,ESCAPE:Hs,SPACE:Vs,CAPS_LOCK:js,BACKSPACE:zs,DELETE:Gs,TAB:Ks,ENTER:Ys,ARROW_UP:$s,ARROW_DOWN:Ws,ARROW_LEFT:Xs,ARROW_RIGHT:qs,MOUSE_BUTTON_0:Qs,MOUSE_BUTTON_1:Zs,MOUSE_BUTTON_2:Js,MOUSE_BUTTON_3:eo,MOUSE_BUTTON_4:to,MOUSE_POS_X:ro,MOUSE_POS_Y:no,MOUSE_WHEEL_X:io,MOUSE_WHEEL_Y:so,MOUSE_WHEEL_Z:oo}),Tt=class{get polling(){return this.ref?this.ref.polling:!1}get value(){return!this.ref||this.disabled?0:this.ref.value}constructor(e){this.name=e,this.ref=null,this.disabled=!1}register(e){throw new Error("Unsupported operation.")}disable(e=!0){return this.disabled=e,this}getState(e){return!this.ref||this.disabled?0:this.ref.getState(e)}};function Sr(t){Array.isArray(t)||(t=[t]);let e=[];for(let r of t){let n;try{n=g.parse(r)}catch(i){let s=ao(r).toUpperCase();if(!(s in se))throw new Error("Invalid key code string - "+i);n=se[s]}e.push(n)}return e}function ao(t){return t.replace(/([a-z]|(?:[A-Z0-9]+))([A-Z0-9]|$)/g,function(e,r,n){return r+(n&&"_"+n)}).toLowerCase()}var pe=class extends Tt{static fromBind(e,r,n,i=void 0){return new pe(e,At(r,n),i)}static fromString(e,...r){let n=Sr(r);return new pe(e,n)}get delta(){return!this.ref||this.disabled?0:this.ref.delta}constructor(e,r,n=void 0){super(e);this.keyCodes=Array.isArray(r)?r:[r],this.opts=n}register(e){let r=this.name,n=this.opts;for(let i of this.keyCodes)e.bindAxis(r,i.device,i.code,n);return this.ref=e.getAxis(r),this}},Y=class extends Tt{static fromBind(e,r,n,i=void 0){return new Y(e,At(r,n),i)}static fromString(e,...r){let n=Sr(r);return new Y(e,n)}get pressed(){return!this.ref||this.disabled?!1:this.ref.pressed}get repeated(){return!this.ref||this.disabled?!1:this.ref.repeated}get released(){return!this.ref||this.disabled?!1:this.ref.released}get down(){return!this.ref||this.disabled?!1:this.ref.down}constructor(e,r,n=void 0){super(e);this.keyCodes=Array.isArray(r)?r:[r],this.opts=n}register(e){let r=this.name,n=this.opts;for(let i of this.keyCodes)e.bindButton(r,i.device,i.code,n);return this.ref=e.getButton(r),this}};var St=class{static isAxis(e){return!1}static isButton(e){return!1}constructor(e,r){if(!r)throw new Error(`Missing event target for device ${e}.`);this.name=e,this.eventTarget=r,this.listeners={input:[]}}setEventTarget(e){if(!e)throw new Error(`Missing event target for device ${this.name}.`);this.eventTarget=e}destroy(){let e=this.listeners;for(let r in e)e[r].length=0}addEventListener(e,r){let n=this.listeners;e in n?n[e].push(r):n[e]=[r]}removeEventListener(e,r){let n=this.listeners;if(e in n){let i=n[e],s=i.indexOf(r);s>=0&&i.splice(s,1)}}dispatchInputEvent(e){let r=0;for(let n of this.listeners.input)r|=n(e);return Boolean(r)}},br=class extends St{static isAxis(e){return!1}static isButton(e){return!0}constructor(e,r,n={}){super(e,r);let{ignoreRepeat:i=!0}=n;this.ignoreRepeat=i,this._eventObject={target:r,device:e,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),r.addEventListener("keydown",this.onKeyDown),r.addEventListener("keyup",this.onKeyUp)}setEventTarget(e){this.eventTarget&&this.destroy(),super.setEventTarget(e),e.addEventListener("keydown",this.onKeyDown),e.addEventListener("keyup",this.onKeyUp)}destroy(){let e=this.eventTarget;e.removeEventListener("keydown",this.onKeyDown),e.removeEventListener("keyup",this.onKeyUp),super.destroy()}onKeyDown(e){if(e.repeat&&this.ignoreRepeat)return e.preventDefault(),e.stopPropagation(),!1;let r=this._eventObject;if(r.code=e.code,r.event="pressed",r.value=1,r.control=e.ctrlKey,r.shift=e.shiftKey,r.alt=e.altKey,this.dispatchInputEvent(r))return e.preventDefault(),e.stopPropagation(),!1}onKeyUp(e){let r=this._eventObject;if(r.code=e.code,r.event="released",r.value=1,r.control=e.ctrlKey,r.shift=e.shiftKey,r.alt=e.altKey,this.dispatchInputEvent(r))return e.preventDefault(),e.stopPropagation(),!1}},bt=10,Rt=100,Rr=class extends St{static isAxis(e){return e==="PosX"||e==="PosY"||e==="WheelX"||e==="WheelY"||e==="WheelZ"}static isButton(e){return!this.isAxis(e)}constructor(e,r,n={}){super(e,r);let{eventsOnFocus:i=!0}=n;this.eventsOnFocus=i,this.canvasTarget=this.getCanvasFromEventTarget(r),this._downHasFocus=!1,this._eventObject={target:r,device:e,code:"",event:"",value:0,control:!1,shift:!1,alt:!1},this._positionObject={target:r,device:e,code:"",event:"move",value:0,movement:0},this._wheelObject={target:r,device:e,code:"",event:"wheel",movement:0},this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onWheel=this.onWheel.bind(this),r.addEventListener("mousedown",this.onMouseDown),r.addEventListener("contextmenu",this.onContextMenu),r.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}setEventTarget(e){this.eventTarget&&this.destroy(),super.setEventTarget(e),this.canvasTarget=this.getCanvasFromEventTarget(e),e.addEventListener("mousedown",this.onMouseDown),e.addEventListener("contextmenu",this.onContextMenu),e.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}destroy(){let e=this.eventTarget;e.removeEventListener("mousedown",this.onMouseDown),e.removeEventListener("contextmenu",this.onContextMenu),e.removeEventListener("wheel",this.onWheel),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),super.destroy()}setPointerLock(e=!0){e?this.eventTarget.requestPointerLock():this.eventTarget.exitPointerLock()}hasPointerLock(){return document.pointerLockElement===this.eventTarget}onMouseDown(e){this._downHasFocus=!0;let r=this._eventObject;if(r.code="Button"+e.button,r.event="pressed",r.value=1,r.control=e.ctrlKey,r.shift=e.shiftKey,r.alt=e.altKey,this.dispatchInputEvent(r)&&document.activeElement===this.eventTarget)return e.preventDefault(),e.stopPropagation(),!1}onContextMenu(e){return e.preventDefault(),e.stopPropagation(),!1}onWheel(e){let r,n,i;switch(e.deltaMode){case WheelEvent.DOM_DELTA_LINE:r=e.deltaX*bt,n=e.deltaY*bt,i=e.deltaZ*bt;break;case WheelEvent.DOM_DELTA_PAGE:r=e.deltaX*Rt,n=e.deltaY*Rt,i=e.deltaZ*Rt;break;case WheelEvent.DOM_DELTA_PIXEL:default:r=e.deltaX,n=e.deltaY,i=e.deltaZ;break}let s=0,o=this._wheelObject;if(o.code="WheelX",o.movement=r,s|=this.dispatchInputEvent(o),o.code="WheelY",o.movement=n,s|=this.dispatchInputEvent(o),o.code="WheelZ",o.movement=i,s|=this.dispatchInputEvent(o),s)return e.preventDefault(),e.stopPropagation(),!1}onMouseUp(e){if(!this._downHasFocus)return;this._downHasFocus=!1;let r=this._eventObject;if(r.code="Button"+e.button,r.event="released",r.value=1,r.control=e.ctrlKey,r.shift=e.shiftKey,r.alt=e.altKey,this.dispatchInputEvent(r))return e.preventDefault(),e.stopPropagation(),!1}onMouseMove(e){if(this.eventsOnFocus&&document.activeElement!==this.eventTarget)return;let r=this.canvasTarget,{clientWidth:n,clientHeight:i}=r,s=r.getBoundingClientRect(),o=e.movementX/n,a=e.movementY/i,l=(e.clientX-s.left)/n,h=(e.clientY-s.top)/i,d=this._positionObject;d.code="PosX",d.value=l,d.movement=o,this.dispatchInputEvent(d),d.code="PosY",d.value=h,d.movement=a,this.dispatchInputEvent(d)}getCanvasFromEventTarget(e){return e instanceof HTMLCanvasElement?e:e.canvas||e.querySelector("canvas")||e.shadowRoot&&e.shadowRoot.querySelector("canvas")||e}},lo=`<kbd>
  <span id="name"><slot></slot></span>
  <span id="value" class="hidden"></span>
</kbd>
`,uo=`kbd {
  position: relative;
  display: inline-block;
  border-radius: 3px;
  border: 1px solid #888888;
  font-size: 0.85em;
  font-weight: 700;
  text-rendering: optimizeLegibility;
  line-height: 12px;
  height: 14px;
  padding: 2px 4px;
  color: #444444;
  background-color: #eeeeee;
  box-shadow: inset 0 -3px 0 #aaaaaa;
  overflow: hidden;
}

kbd:empty::after {
  content: '<?>';
  opacity: 0.6;
}

.disabled {
  opacity: 0.6;
  box-shadow: none;
  background-color: #aaaaaa;
}

.hidden {
  display: none;
}

#value {
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  font-size: 0.85em;
  padding: 0 4px;
  padding-top: 2px;
  color: #cccccc;
  background-color: #333333;
  box-shadow: inset 0 3px 0 #222222;
}
`,Mt=class extends HTMLElement{static get[Symbol.for("templateNode")](){let e=document.createElement("template");return e.innerHTML=lo,Object.defineProperty(this,Symbol.for("templateNode"),{value:e}),e}static get[Symbol.for("styleNode")](){let e=document.createElement("style");return e.innerHTML=uo,Object.defineProperty(this,Symbol.for("styleNode"),{value:e}),e}static define(e=window.customElements){e.define("input-code",this)}static get observedAttributes(){return["name","value","disabled"]}get disabled(){return this._disabled}set disabled(e){this.toggleAttribute("disabled",e)}get value(){return this._value}set value(e){this.setAttribute("value",e)}get name(){return this._name}set name(e){this.setAttribute("name",e)}constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._name="",this._value="",this._disabled=!1,this._kbdElement=this.shadowRoot.querySelector("kbd"),this._nameElement=this.shadowRoot.querySelector("#name"),this._valueElement=this.shadowRoot.querySelector("#value")}attributeChangedCallback(e,r,n){switch(e){case"name":this._name=n,this._nameElement.textContent=n;break;case"value":this._value=n,n!==null?(this._valueElement.classList.toggle("hidden",!1),this._valueElement.textContent=n,this._kbdElement.style.paddingRight=`${this._valueElement.clientWidth+4}px`):this._valueElement.classList.toggle("hidden",!0);break;case"disabled":this._disabled=n!==null,this._kbdElement.classList.toggle("disabled",n!==null);break}}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"name")){let e=this.name;delete this.name,this.name=e}if(Object.prototype.hasOwnProperty.call(this,"value")){let e=this.value;delete this.value,this.value=e}if(Object.prototype.hasOwnProperty.call(this,"disabled")){let e=this.disabled;delete this.disabled,this.disabled=e}}};Mt.define();var ho=`<table>
  <thead>
    <tr class="tableHeader">
      <th colspan="3">
        <span class="tableTitle">
          <label id="title"> input-source </label>
          <span id="slotContainer">
            <slot></slot>
          </span>
          <p>
            <label for="poll">poll</label>
            <output id="poll"></output>
          </p>
          <p>
            <label for="focus">focus</label>
            <output id="focus"></output>
          </p>
        </span>
      </th>
    </tr>
    <tr class="colHeader">
      <th>name</th>
      <th>value</th>
      <th>key</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
`,co=`:host {
  display: block;
}

table {
  border-collapse: collapse;
  font-family: monospace;
}

table,
th,
td {
  border: 1px solid #666666;
}

th,
td {
  padding: 5px 10px;
}

td {
  text-align: center;
}

thead th {
  padding: 0;
}

.colHeader > th {
  font-size: 0.8em;
  padding: 0 10px;
  letter-spacing: 3px;
  background-color: #aaaaaa;
  color: #666666;
}

tbody output {
  border-radius: 0.3em;
  padding: 3px;
}

tr:not(.primary) .name,
tr:not(.primary) .value {
  opacity: 0.3;
}

tr:nth-child(2n) {
  background-color: #eeeeee;
}

.tableHeader {
  color: #666666;
}

.tableTitle {
  display: flex;
  flex-direction: row;
  align-items: center;
  padding: 4px;
}

#slotContainer {
  flex: 1;
}

p {
  display: inline;
  margin: 0;
  padding: 0;
  padding-right: 10px;
}

#poll:empty::after,
#focus:empty::after {
  content: '\u2717';
  color: #ff0000;
}
`,Mr=class{constructor(e){this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null,this.pollable=e}get running(){return this.animationFrameHandle!==null}start(){let e=this.animationFrameHandle;e&&cancelAnimationFrame(e),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}stop(){let e=this.animationFrameHandle;e&&cancelAnimationFrame(e),this.animationFrameHandle=null}onAnimationFrame(e){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.pollable.onPoll(e)}},Lr=class{constructor(e){this.onInput=this.onInput.bind(this),this.onPoll=this.onPoll.bind(this),this.bindings=e}onPoll(e){for(let r of this.bindings.getInputs())r.onPoll(e)}onInput(e){let{device:r,code:n,event:i,value:s,movement:o,control:a,shift:l,alt:h}=e,d=this.bindings.getBindings(r,n);switch(i){case"pressed":for(let{input:x,index:v}of d)x.onUpdate(v,1,1);break;case"released":for(let{input:x,index:v}of d)x.onUpdate(v,0,-1);break;case"move":for(let{input:x,index:v}of d)x.onUpdate(v,s,o);break;case"wheel":for(let{input:x,index:v}of d)x.onUpdate(v,void 0,o);break}return d.length>0}},Lt=class{constructor(e,r,n,i){this.device=e,this.code=r,this.input=n,this.index=i}},Cr=class{constructor(){this.bindingMap={},this.inputMap=new Map}clear(){for(let e of this.inputMap.keys())e.onUnbind();this.inputMap.clear(),this.bindingMap={}}bind(e,r,n,i={inverted:!1}){let s,o=this.inputMap;if(o.has(e)){let l=o.get(e),h=e.size;e.onBind(h,i),s=new Lt(r,n,e,h),l.push(s)}else{let l=[];o.set(e,l);let h=0;e.onBind(h,i),s=new Lt(r,n,e,h),l.push(s)}let a=this.bindingMap;r in a?n in a[r]?a[r][n].push(s):a[r][n]=[s]:a[r]={[n]:[s]}}unbind(e){let r=this.inputMap;if(r.has(e)){let n=this.bindingMap,i=r.get(e);for(let s of i){let{device:o,code:a}=s,l=n[o][a],h=l.indexOf(s);l.splice(h,1)}i.length=0,e.onUnbind(),r.delete(e)}}isBound(e){return this.inputMap.has(e)}getInputs(){return this.inputMap.keys()}getBindingsByInput(e){return this.inputMap.get(e)}getBindings(e,r){let n=this.bindingMap;if(e in n){let i=n[e];if(r in i)return i[r]}return[]}},Ir=class{constructor(e,r={}){this.inputs={},this.devices=[new Rr("Mouse",e),new br("Keyboard",e)],this.bindings=new Cr,this.adapter=new Lr(this.bindings),this.autopoller=new Mr(this.adapter),this.eventTarget=e,this.anyButton=new Ze(1),this.anyButtonDevice="",this.anyButtonCode="",this.anyAxis=new He(1),this.anyAxisDevice="",this.anyAxisCode="",this.listeners={bind:[],unbind:[],focus:[],blur:[]},this.onInput=this.onInput.bind(this),this.onEventTargetBlur=this.onEventTargetBlur.bind(this),this.onEventTargetFocus=this.onEventTargetFocus.bind(this),e.addEventListener("focus",this.onEventTargetFocus),e.addEventListener("blur",this.onEventTargetBlur);for(let n of this.devices)n.addEventListener("input",this.onInput)}get autopoll(){return this.autopoller.running}set autopoll(e){this.toggleAutoPoll(e)}destroy(){let e=this.listeners;for(let n in e)e[n].length=0;this.autopoller.running&&this.autopoller.stop();for(let n of this.devices)n.removeEventListener("input",this.onInput),n.destroy();let r=this.eventTarget;r.removeEventListener("focus",this.onEventTargetFocus),r.removeEventListener("blur",this.onEventTargetBlur)}setEventTarget(e){let r=this.eventTarget;r.removeEventListener("focus",this.onEventTargetFocus),r.removeEventListener("blur",this.onEventTargetBlur),this.eventTarget=e;for(let n of this.devices)n.setEventTarget(e);e.addEventListener("focus",this.onEventTargetFocus),e.addEventListener("blur",this.onEventTargetBlur)}toggleAutoPoll(e=void 0){let r=this.autopoller.running,n=typeof e=="undefined"?!r:Boolean(e);n!==r&&(n?this.autopoller.start():this.autopoller.stop())}addEventListener(e,r){let n=this.listeners;e in n?n[e].push(r):n[e]=[r]}removeEventListener(e,r){let n=this.listeners;if(e in n){let i=n[e],s=i.indexOf(r);s>=0&&i.splice(s,1)}}dispatchEvent(e){let{type:r}=e,n=0;for(let i of this.listeners[r])n|=i(e)?1:0;return Boolean(n)}poll(e=performance.now()){if(this.autopoller.running)throw new Error("Should not manually poll() while autopolling.");this.onPoll(e)}onInput(e){let r=this.adapter.onInput(e);switch(e.event){case"pressed":this.anyButtonDevice=e.device,this.anyButtonCode=e.code,this.anyButton.onUpdate(0,1,1);break;case"released":this.anyButtonDevice=e.device,this.anyButtonCode=e.code,this.anyButton.onUpdate(0,0,-1);break;case"move":case"wheel":this.anyAxisDevice=e.device,this.anyAxisCode=e.code,this.anyAxis.onUpdate(0,e.value,e.movement);break}return r}onPoll(e){this.adapter.onPoll(e),this.anyButton.onPoll(e),this.anyAxis.onPoll(e)}onBind(){this.dispatchEvent({type:"bind"})}onUnbind(){this.dispatchEvent({type:"unbind"})}onEventTargetFocus(){this.dispatchEvent({type:"focus"})}onEventTargetBlur(){for(let e of this.bindings.getInputs())e.onStatus(0,0);this.anyButton.onStatus(0,0),this.anyAxis.onStatus(0,0),this.dispatchEvent({type:"blur"})}bindBindings(e){for(let r of e)r.register(this)}bindButton(e,r,n,i=void 0){let s;this.hasButton(e)?s=this.getButton(e):(s=new Ze(1),this.inputs[e]=s),this.bindings.bind(s,r,n,i),this.onBind()}bindAxis(e,r,n,i=void 0){let s;this.hasAxis(e)?s=this.getAxis(e):(s=new He(1),this.inputs[e]=s),this.bindings.bind(s,r,n,i),this.onBind()}bindAxisButtons(e,r,n,i){let s;this.hasAxis(e)?s=this.getAxis(e):(s=new He(2),this.inputs[e]=s),this.bindings.bind(s,r,i),this.bindings.bind(s,r,n,{inverted:!0}),this.onBind()}unbindButton(e){if(this.hasButton(e)){let r=this.getButton(e);delete this.inputs[e],this.bindings.unbind(r),this.onUnbind()}}unbindAxis(e){if(this.hasAxis(e)){let r=this.getAxis(e);delete this.inputs[e],this.bindings.unbind(r),this.onUnbind()}}getInput(e){return this.inputs[e]}getButton(e){return this.inputs[e]}getAxis(e){return this.inputs[e]}hasButton(e){return e in this.inputs&&this.inputs[e]instanceof Ze}hasAxis(e){return e in this.inputs&&this.inputs[e]instanceof He}isButtonDown(e){return this.inputs[e].down}isButtonPressed(e){return this.inputs[e].pressed}isButtonReleased(e){return this.inputs[e].released}getInputValue(e){return this.inputs[e].value}getButtonValue(e){return this.inputs[e].value}getAxisValue(e){return this.inputs[e].value}getAxisDelta(e){return this.inputs[e].delta}isAnyButtonDown(e=void 0){if(typeof e=="undefined")return this.anyButton.down;{let r=this.inputs;for(let n of e)if(r[n].down)return!0}return!1}isAnyButtonPressed(e=void 0){if(typeof e=="undefined")return this.anyButton.pressed;{let r=this.inputs;for(let n of e)if(r[n].pressed)return!0}return!1}isAnyButtonReleased(e=void 0){if(typeof e=="undefined")return this.anyButton.released;{let r=this.inputs;for(let n of e)if(r[n].released)return!0}return!1}getAnyAxisValue(e=void 0){if(typeof e=="undefined")return this.anyAxis.value;{let r=this.inputs;for(let n of e){let i=r[n];if(i.value)return i.value}}return 0}getAnyAxisDelta(e=void 0){if(typeof e=="undefined")return this.anyAxis.delta;{let r=this.inputs;for(let n of e){let i=r[n];if(i.delta)return i.delta}}return 0}getLastButtonDevice(){return this.anyButtonDevice}getLastButtonCode(){return this.anyButtonCode}getLastAxisDevice(){return this.anyAxisDevice}getLastAxisCode(){return this.anyAxisCode}getMouse(){return this.devices[0]}getKeyboard(){return this.devices[1]}},Or=class extends HTMLElement{static get[Symbol.for("templateNode")](){let e=document.createElement("template");return e.innerHTML=ho,Object.defineProperty(this,Symbol.for("templateNode"),{value:e}),e}static get[Symbol.for("styleNode")](){let e=document.createElement("style");return e.innerHTML=co,Object.defineProperty(this,Symbol.for("styleNode"),{value:e}),e}static define(e=window.customElements){e.define("input-port",this)}static get observedAttributes(){return["autopoll","for"]}get autopoll(){return this._autopoll}set autopoll(e){this.toggleAttribute("autopoll",e)}get for(){return this._for}set for(e){this.setAttribute("for",e)}constructor(){super();let e=this.attachShadow({mode:"open"});e.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),e.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._titleElement=e.querySelector("#title"),this._pollElement=e.querySelector("#poll"),this._focusElement=e.querySelector("#focus"),this._bodyElement=e.querySelector("tbody"),this._outputElements={},this.onAnimationFrame=this.onAnimationFrame.bind(this),this.animationFrameHandle=null;let r=this;this._for="",this._eventTarget=r,this._autopoll=!1,this._context=null,this.onInputContextBind=this.onInputContextBind.bind(this),this.onInputContextUnbind=this.onInputContextUnbind.bind(this),this.onInputContextFocus=this.onInputContextFocus.bind(this),this.onInputContextBlur=this.onInputContextBlur.bind(this)}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"for")){let e=this.for;delete this.for,this.for=e}if(Object.prototype.hasOwnProperty.call(this,"autopoll")){let e=this.autopoll;delete this.autopoll,this.autopoll=e}this.updateTable(),this.updateTableValues(),this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame)}disconnectedCallback(){let e=this._context;e&&(e.removeEventListener("bind",this.onInputContextBind),e.removeEventListener("unbind",this.onInputContextUnbind),e.removeEventListener("blur",this.onInputContextBlur),e.removeEventListener("focus",this.onInputContextFocus),e.destroy(),this._context=null)}attributeChangedCallback(e,r,n){switch(e){case"for":{this._for=n;let i,s;n?(i=document.getElementById(n),s=`${i.tagName.toLowerCase()}#${n}`):(i=this,s="input-port"),this._eventTarget=i,this._context&&this._context.setEventTarget(this._eventTarget),this._titleElement.innerHTML=`for ${s}`}break;case"autopoll":this._autopoll=n!==null,this._context&&this._context.toggleAutoPoll(this._autopoll);break}}onAnimationFrame(){this.animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.updateTableValues(),this.updatePollStatus()}onInputContextBind(){return this.updateTable(),!0}onInputContextUnbind(){return this.updateTable(),!0}onInputContextFocus(){return this._focusElement.innerHTML="\u2713",!0}onInputContextBlur(){return this._focusElement.innerHTML="",!0}getContext(e="axisbutton",r=void 0){switch(e){case"axisbutton":if(!this._context){let n=new Ir(this._eventTarget,r);n.addEventListener("bind",this.onInputContextBind),n.addEventListener("unbind",this.onInputContextUnbind),n.addEventListener("blur",this.onInputContextBlur),n.addEventListener("focus",this.onInputContextFocus),this._autopoll&&n.toggleAutoPoll(!0),this._context=n}return this._context;default:throw new Error(`Input context id '${e}' is not supported.`)}}updateTable(){if(this.isConnected)if(this._context){let e=this._context,r=e.inputs,n=e.bindings,i={},s=[];for(let o of Object.keys(r)){let a=r[o],l=!0;for(let h of n.getBindingsByInput(a)){let d=fo(`${a.constructor.name}.${o}`,`${h.device}.${h.code}`,0,l);s.push(d),l&&(i[o]=d.querySelector("output"),l=!1)}}this._outputElements=i,this._bodyElement.innerHTML="";for(let o of s)this._bodyElement.appendChild(o)}else{this._outputElements={},this._bodyElement.innerHTML="";return}else return}updateTableValues(){if(this.isConnected)if(this._context){let r=this._context.inputs;for(let n of Object.keys(this._outputElements)){let i=this._outputElements[n],s=r[n].value;i.innerText=Number(s).toFixed(2)}}else{for(let e of Object.keys(this._outputElements)){let r=this._outputElements[e];r.innerText="---"}return}else return}updatePollStatus(){if(this.isConnected)if(this._context){let r=this._context.inputs;for(let n of Object.values(r))if(!n.polling){this._pollElement.innerHTML="";return}this._pollElement.innerHTML="\u2713"}else{this._pollElement.innerHTML="-";return}else return}};Or.define();function fo(t,e,r,n=!0){let i=document.createElement("tr");n&&i.classList.add("primary");{let s=document.createElement("td");s.textContent=t,s.classList.add("name"),i.appendChild(s)}{let s=document.createElement("td"),o=document.createElement("output");n?o.innerText=Number(r).toFixed(2):o.innerText="---",o.classList.add("value"),s.appendChild(o),i.appendChild(s)}{let s=document.createElement("td");s.classList.add("key");let o=new Mt;o.innerText=e,s.appendChild(o),i.appendChild(s)}return i}var du=Symbol("keyboardSource");var pu=Symbol("mouseSource");window.addEventListener("error",Je,!0);window.addEventListener("unhandledrejection",Je,!0);function Je(t){typeof t=="object"?t instanceof PromiseRejectionEvent?Je(t.reason):t instanceof ErrorEvent?Je(t.error):t instanceof Error?window.alert(t.stack):window.alert(JSON.stringify(t)):window.alert(t)}var bn=Pi(hn());var cn={},qo=function(t,e,r,n,i){var s=new Worker(cn[e]||(cn[e]=URL.createObjectURL(new Blob([t],{type:"text/javascript"}))));return s.onerror=function(o){return i(o.error,null)},s.onmessage=function(o){return i(null,o.data)},s.postMessage(r,n),s},J=Uint8Array,_e=Uint16Array,ze=Uint32Array,zt=new J([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Gt=new J([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),fn=new J([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),dn=function(t,e){for(var r=new _e(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var i=new ze(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)i[s]=s-r[n]<<5|n;return[r,i]},pn=dn(zt,2),Kt=pn[0],Qo=pn[1];Kt[28]=258,Qo[258]=28;var mn=dn(Gt,0),_n=mn[0],Tu=mn[1],at=new _e(32768);for(var z=0;z<32768;++z)ye=(z&43690)>>>1|(z&21845)<<1,ye=(ye&52428)>>>2|(ye&13107)<<2,ye=(ye&61680)>>>4|(ye&3855)<<4,at[z]=((ye&65280)>>>8|(ye&255)<<8)>>>1;var ye,De=function(t,e,r){for(var n=t.length,i=0,s=new _e(e);i<n;++i)++s[t[i]-1];var o=new _e(e);for(i=0;i<e;++i)o[i]=o[i-1]+s[i-1]<<1;var a;if(r){a=new _e(1<<e);var l=15-e;for(i=0;i<n;++i)if(t[i])for(var h=i<<4|t[i],d=e-t[i],x=o[t[i]-1]++<<d,v=x|(1<<d)-1;x<=v;++x)a[at[x]>>>l]=h}else for(a=new _e(n),i=0;i<n;++i)t[i]&&(a[i]=at[o[t[i]-1]++]>>>15-t[i]);return a},Ge=new J(288);for(var z=0;z<144;++z)Ge[z]=8;for(var z=144;z<256;++z)Ge[z]=9;for(var z=256;z<280;++z)Ge[z]=7;for(var z=280;z<288;++z)Ge[z]=8;var xn=new J(32);for(var z=0;z<32;++z)xn[z]=5;var gn=De(Ge,9,1);var vn=De(xn,5,1),lt=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},le=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},ut=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},En=function(t){return(t/8|0)+(t&7&&1)},ht=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new(t instanceof _e?_e:t instanceof ze?ze:J)(r-e);return n.set(t.subarray(e,r)),n},yn=function(t,e,r){var n=t.length;if(!n||r&&!r.l&&n<5)return e||new J(0);var i=!e||r,s=!r||r.i;r||(r={}),e||(e=new J(n*3));var o=function(L){var ve=e.length;if(L>ve){var be=new J(Math.max(ve*2,L));be.set(e),e=be}},a=r.f||0,l=r.p||0,h=r.b||0,d=r.l,x=r.d,v=r.m,S=r.n,_=n*8;do{if(!d){r.f=a=le(t,l,1);var A=le(t,l+1,3);if(l+=3,A)if(A==1)d=gn,x=vn,v=9,S=5;else if(A==2){var I=le(t,l,31)+257,k=le(t,l+10,15)+4,P=I+le(t,l+5,31)+1;l+=14;for(var G=new J(P),V=new J(19),y=0;y<k;++y)V[fn[y]]=le(t,l+y*3,7);l+=k*3;for(var w=lt(V),K=(1<<w)-1,p=De(V,w,1),y=0;y<P;){var B=p[le(t,l,K)];l+=B&15;var R=B>>>4;if(R<16)G[y++]=R;else{var U=0,ee=0;for(R==16?(ee=3+le(t,l,3),l+=2,U=G[y-1]):R==17?(ee=3+le(t,l,7),l+=3):R==18&&(ee=11+le(t,l,127),l+=7);ee--;)G[y++]=U}}var f=G.subarray(0,I),c=G.subarray(I);v=lt(f),S=lt(c),d=De(f,v,1),x=De(c,S,1)}else throw"invalid block type";else{var R=En(l)+4,C=t[R-4]|t[R-3]<<8,F=R+C;if(F>n){if(s)throw"unexpected EOF";break}i&&o(h+C),e.set(t.subarray(R,F),h),r.b=h+=C,r.p=l=F*8;continue}if(l>_){if(s)throw"unexpected EOF";break}}i&&o(h+131072);for(var W=(1<<v)-1,D=(1<<S)-1,Z=l;;Z=l){var U=d[ut(t,l)&W],X=U>>>4;if(l+=U&15,l>_){if(s)throw"unexpected EOF";break}if(!U)throw"invalid length/literal";if(X<256)e[h++]=X;else if(X==256){Z=l,d=null;break}else{var q=X-254;if(X>264){var y=X-257,ae=zt[y];q=le(t,l,(1<<ae)-1)+Kt[y],l+=ae}var Se=x[ut(t,l)&D],re=Se>>>4;if(!Se)throw"invalid distance";l+=Se&15;var c=_n[re];if(re>3){var ae=Gt[re];c+=ut(t,l)&(1<<ae)-1,l+=ae}if(l>_){if(s)throw"unexpected EOF";break}i&&o(h+131072);for(var ie=h+q;h<ie;h+=4)e[h]=e[h-c],e[h+1]=e[h+1-c],e[h+2]=e[h+2-c],e[h+3]=e[h+3-c];h=ie}}r.l=d,r.p=Z,r.b=h,d&&(a=1,r.m=v,r.d=x,r.n=S)}while(!a);return h==e.length?e:ht(e,0,h)};var Zo=new J(0);var Jo=function(t,e){var r={};for(var n in t)r[n]=t[n];for(var n in e)r[n]=e[n];return r},wn=function(t,e,r){for(var n=t(),i=t.toString(),s=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/ /g,"").split(","),o=0;o<n.length;++o){var a=n[o],l=s[o];if(typeof a=="function"){e+=";"+l+"=";var h=a.toString();if(a.prototype)if(h.indexOf("[native code]")!=-1){var d=h.indexOf(" ",8)+1;e+=h.slice(d,h.indexOf("(",d))}else{e+=h;for(var x in a.prototype)e+=";"+l+".prototype."+x+"="+a.prototype[x].toString()}else e+=h}else r[l]=a}return[e,r]},ct=[],ea=function(t){var e=[];for(var r in t)(t[r]instanceof J||t[r]instanceof _e||t[r]instanceof ze)&&e.push((t[r]=new t[r].constructor(t[r])).buffer);return e},ta=function(t,e,r,n){var i;if(!ct[r]){for(var s="",o={},a=t.length-1,l=0;l<a;++l)i=wn(t[l],s,o),s=i[0],o=i[1];ct[r]=wn(t[a],s,o)}var h=Jo({},ct[r][1]);return qo(ct[r][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",r,h,ea(h),n)},ra=function(){return[J,_e,ze,zt,Gt,fn,Kt,_n,gn,vn,at,De,lt,le,ut,En,ht,yn,Yt,An,Tn]};var An=function(t){return postMessage(t,[t.buffer])},Tn=function(t){return t&&t.size&&new J(t.size)},na=function(t,e,r,n,i,s){var o=ta(r,n,i,function(a,l){o.terminate(),s(a,l)});return o.postMessage([t,e],e.consume?[t.buffer]:[]),function(){o.terminate()}};var xe=function(t,e){return t[e]|t[e+1]<<8},de=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},$t=function(t,e){return de(t,e)+de(t,e+4)*4294967296};function ia(t,e,r){if(r||(r=e,e={}),typeof r!="function")throw"no callback";return na(t,e,[ra],function(n){return An(Yt(n.data[0],Tn(n.data[1])))},1,r)}function Yt(t,e){return yn(t,e)}var Su=typeof TextEncoder!="undefined"&&new TextEncoder,Wt=typeof TextDecoder!="undefined"&&new TextDecoder,sa=0;try{Wt.decode(Zo,{stream:!0}),sa=1}catch(t){}var oa=function(t){for(var e="",r=0;;){var n=t[r++],i=(n>127)+(n>223)+(n>239);if(r+i>t.length)return[e,ht(t,r-1)];i?i==3?(n=((n&15)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,e+=String.fromCharCode(55296|n>>10,56320|n&1023)):i&1?e+=String.fromCharCode((n&31)<<6|t[r++]&63):e+=String.fromCharCode((n&15)<<12|(t[r++]&63)<<6|t[r++]&63):e+=String.fromCharCode(n)}};function aa(t,e){if(e){for(var r="",n=0;n<t.length;n+=16384)r+=String.fromCharCode.apply(null,t.subarray(n,n+16384));return r}else{if(Wt)return Wt.decode(t);var i=oa(t),s=i[0],o=i[1];if(o.length)throw"invalid utf-8 data";return s}}var la=function(t,e){return e+30+xe(t,e+26)+xe(t,e+28)},ha=function(t,e,r){var n=xe(t,e+28),i=aa(t.subarray(e+46,e+46+n),!(xe(t,e+8)&2048)),s=e+46+n,o=de(t,e+20),a=r&&o==4294967295?ua(t,s):[o,de(t,e+24),de(t,e+42)],l=a[0],h=a[1],d=a[2];return[xe(t,e+10),l,h,i,s+xe(t,e+30)+xe(t,e+32),d]},ua=function(t,e){for(;xe(t,e)!=1;e+=4+xe(t,e+2));return[$t(t,e+12),$t(t,e+4),$t(t,e+20)]};function Sn(t,e){if(typeof e!="function")throw"no callback";for(var r=[],n=function(){for(var v=0;v<r.length;++v)r[v]()},i={},s=t.length-22;de(t,s)!=101010256;--s)if(!s||t.length-s>65558){e("invalid zip file",null);return}var o=xe(t,s+8);o||e(null,{});var a=o,l=de(t,s+16),h=l==4294967295;if(h){if(s=de(t,s-12),de(t,s)!=101075792){e("invalid zip file",null);return}a=o=de(t,s+32),l=de(t,s+48)}for(var d=function(v){var S=ha(t,l,h),_=S[0],A=S[1],R=S[2],C=S[3],F=S[4],I=S[5],k=la(t,I);l=F;var P=function(V,y){V?(n(),e(V,null)):(i[C]=y,--o||e(null,i))};if(!_)P(null,ht(t,k,k+A));else if(_==8){var G=t.subarray(k,k+A);if(A<32e4)try{P(null,Yt(G,new J(R)))}catch(V){P(V,null)}else r.push(ia(G,{size:R},P))}else P("unknown compression type "+_,null)},x=0;x<a;++x)d(x);return n}var Le=class{constructor(e){let r;typeof e=="object"&&e instanceof Le?r=e.source:r=String(e),this.source=r,this._re=(0,bn.makeRe)(r)}test(e){return this._re.test(e)}},ca=/^([_\w\d]+)\:\/\//,Xt=5e3,ue={cache:{},loadings:{},defaults:[]};async function Rn(t,e,r,n=Xt){let{cache:i,loadings:s}=ue;if(t in i)return i[t];let o;if(t in s){if(o=s[t],o.active)return s[t].promise}else o=new Qt(n),s[t]=o;let a=[o.promise];return ca.test(e)?a.push(qt(e,n).then(l=>r(l)).then(l=>Fe(t,l))):a.push(fetch(e).then(l=>l.arrayBuffer()).then(l=>r(l)).then(l=>Fe(t,l))),await Promise.race(a)}async function fa(t,e=void 0){let r="raw://",i=await(await fetch(t)).arrayBuffer();await new Promise((s,o)=>{Sn(new Uint8Array(i),(a,l)=>{if(a)o(a);else{for(let[h,d]of Object.entries(l)){h=h.replaceAll("\\","/");let x=h.indexOf("/");x>=0&&(h=h.substring(x+1));let v=r+h;Fe(v,d),e&&e(d,v,h)}s()}})})}async function da(t,e=Xt){let r=[];for(let n of t)r.push(n.load(e));await Promise.allSettled(r)}function Fe(t,e){let{cache:r,loadings:n}=ue;return r[t]=e,t in n&&(n[t].resolve(e),delete n[t]),e}function pa(t,e){let{defaults:r}=ue;typeof t=="string"&&(t=new Le(t));let n=`__default://[${r.length}]`;Fe(n,e),r.push(new Mn(t,n))}function ma(t){let{cache:e,loadings:r}=ue;t in r&&(r[t].reject(new Error("Stop loading to delete asset.")),delete r[t]),t in e&&delete e[t]}function _a(t=void 0,e={preserveDefault:!1}){let{preserveDefault:r}=e;typeof t=="string"&&(t=new Le(t));let{cache:n,loadings:i,defaults:s}=ue;for(let[o,a]of Object.entries(i))(!t||t.test(o))&&(a.reject(new Error("Stop loading to clear all assets.")),delete i[o]);for(let o of Object.keys(n))(!t||t.test(o))&&delete n[o];r||(s.length=0)}async function qt(t,e=Xt){let{cache:r,loadings:n}=ue;if(t in r)return r[t];if(t in n)return n[t].promise;{let i=new Qt(e);return n[t]=i,i.promise}}function Zt(t){let{defaults:e}=ue;for(let r of e)if(r.glob.test(t))return ft(r.uri);return null}function ft(t){return ue.cache[t]}function Ln(t){return ft(t)||Zt(t)}function xa(t){return Boolean(ue.cache[t])}function ga(){return Object.keys(ue.cache)}function va(t){return t in ue.cache}function Ea(t){return t in ue.loadings}function ya(t,e){}var Mn=class{constructor(e,r){this.glob=e,this.uri=r}},Qt=class{constructor(e){this.active=!1,this._resolve=null,this._reject=null,this._reason=null,this._value=null,this._timeoutHandle=Number.isFinite(e)&&e>0?setTimeout(()=>{this.reject(`Asset loading exceeded timeout of ${e} ms.`)},e):null,this._promise=new Promise((r,n)=>{this._value?r(this._value):this._resolve=r,this._reason?n(this._reason):this._reject=n})}get promise(){return this._promise}resolve(e){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._resolve?this._resolve(e):this._value=e}reject(e){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._reject?this._reject(e):this._reason=e}},Q=Object.freeze({__proto__:null,load:Rn,loadAssetPack:fa,loadAssetRefs:da,cache:Fe,cacheDefault:pa,unload:ma,clear:_a,getLoaded:qt,getDefault:Zt,getCurrent:ft,get:Ln,has:xa,keys:ga,isAssetCached:va,isAssetLoading:Ea,on:ya}),Ae=class{constructor(e,r,n){this.uri=e,this.source=r,this.loader=n}get value(){return Ln(this.uri)}get current(){return ft(this.uri)}get loaded(){return qt(this.uri)}get default(){return Zt(this.uri)}async load(e=void 0){return await Rn(this.uri,this.source,this.loader,e),this}cache(e){return Fe(this.uri,e),this}};var Jt=class{constructor(){this._pipeline={}}async pipe(e,r){let n=new Le(e),i=n.source,s;i in this._pipeline?s=this._pipeline[i]:(s=new Cn(n),this._pipeline[i]=s),s.addHandler(r);for(let o of Q.keys())s.matches(o)&&await r(Q.getCurrent(o),o)}},Cn=class{constructor(e){this.filter=e,this.handlers=[]}matches(e){return this.filter.test(e)}async process(e,r){return Promise.all(this.handlers.map(n=>n(e,r)))}addHandler(e){this.handlers.push(e)}};var er={on(t,e,r=e){let n;if(this.__events.has(t)?n=this.__events.get(t):(n=new Map,this.__events.set(t,n)),!n.has(r))n.set(r,e);else throw new Error(`Found callback for event '${t}' with the same handle '${r}'.`);return this},off(t,e){if(this.__events.has(t)){let r=this.__events.get(t);if(r.has(e))r.delete(e);else throw new Error(`Unable to find callback for event '${t}' with handle '${e}'.`)}else throw new Error(`Unable to find event '${t}'.`);return this},once(t,e,r=e){let n=(...i)=>{this.off(t,r),e.apply(this.__context||this,i)};return this.on(t,n,r)},emit(t,...e){if(this.__events.has(t)){let r=[],n=Array.from(this.__events.get(t).values());for(let i of n){let s=i.apply(this.__context||this,e);s&&r.push(s)}return r}else return this.__events.set(t,new Map),[]}};function wa(t=void 0){let e=Object.create(er);return e.__events=new Map,e.__context=t,e}function Aa(t,e=void 0){let r=Object.assign(t,er);return r.__events=new Map,r.__context=e,r}function Ta(t,e=void 0){let r=t.prototype;return Object.assign(r,er),r.__events=new Map,r.__context=e,r}var In={create:wa,assign:Aa,mixin:Ta},Sa=5,ba=4,Ra=3,Ma=2,La=1,Ca=0,Iu={[Sa]:Ke("#7F8C8D"),[ba]:Ke("#2ECC71"),[Ra]:Ke("#4794C8"),[Ma]:Ke("#F39C12"),[La]:Ke("#C0392B"),[Ca]:[""]};function Ke(t){return[`background: ${t}`,"border-radius: 0.5em","color: white","font-weight: bold","padding: 2px 0.5em"]}var Ou=Symbol("level"),Nu=Symbol("domain");var Pe=0,Ia=class{constructor(e){this._heap=[],this._comparator=e}get size(){return this._heap.length}clear(){this._heap.length=0}push(...e){for(let r of e)this._heap.push(r),this._shiftUp()}pop(){let e=this.peek(),r=Oa(this);return r>Pe&&this._swap(Pe,r),this._heap.pop(),this._shiftDown(),e}replace(e){let r=this.peek();return this._heap[Pe]=e,this._shiftDown(),r}peek(){return this._heap[Pe]}_compare(e,r){return this._comparator(this._heap[e],this._heap[r])}_swap(e,r){let n=this._heap[e];this._heap[e]=this._heap[r],this._heap[r]=n}_shiftUp(){let e=this._heap.length-1,r;for(;e>Pe&&this._compare(e,r=Na(e));)this._swap(e,r),e=r}_shiftDown(){let e=this._heap.length,r=Pe,n,i=On(r),s=i<e,o=Nn(r),a=o<e;for(;s&&this._compare(i,r)||a&&this._compare(o,r);)n=a&&this._compare(o,i)?o:i,this._swap(r,n),r=n,i=On(r),s=i<e,o=Nn(r),a=o<e}values(){return this._heap}[Symbol.iterator](){return this._heap[Symbol.iterator]()}};function Oa(t){return t._heap.length-1}function Na(t){return(t+1>>>1)-1}function On(t){return(t<<1)+1}function Nn(t){return t+1<<1}var Bu=Math.PI/180,Du=180/Math.PI;var tr=class{constructor(e,r){this.display=e,this.inputs=r,this.assets=Q,this.deltaTime=0,this.prevTime=0,this.now=0,this.events=In.create()}on(e,r){return this.events.on(e,r),this}off(e,r){return this.events.off(e,r),this}once(e,r){return this.events.once(e,r),this}emit(e,...r){this.events.emit(e,...r)}};async function rr(t,e=void 0){if(typeof t=="string"){let a=await(await fetch(t)).arrayBuffer();if(typeof e=="undefined"){let l=t.lastIndexOf(".");if(l<0)throw new Error("Cannot load from url - unknown image type.");e="image/"+t.slice(l+1)}return rr(a,e)}else if(!(t instanceof ArrayBuffer||ArrayBuffer.isView(t)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let r=t;typeof e=="undefined"&&(e="image/png");let n=new Blob([r],{type:e}),i=URL.createObjectURL(n),s=new Image;return new Promise((o,a)=>{s.addEventListener("load",()=>{o(s)}),s.addEventListener("error",l=>{a(l)}),s.src=i})}async function nr(t){if(typeof t=="string"){let n=await(await fetch(t)).arrayBuffer();return nr(n)}else if(!(t instanceof ArrayBuffer||ArrayBuffer.isView(t)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let e=t;return Ba(new TextDecoder().decode(e))}function Ba(t){let e=[],r=[],n=[],i=[],s=[],o=[],a=/^#.*/g,l=/v\s+(\S+)\s+(\S+)\s+(\S+)/g,h=/vn\s+(\S+)\s+(\S+)\s+(\S+)/g,d=/vt\s+(\S+)\s+(\S+)/g,x=/f\s+(([^/\s]*)\/([^/\s]*)\/?([^/\s]*))\s+(([^/\s]*)\/([^/\s]*)\/?([^/\s]*))\s+(([^/\s]*)\/([^/\s]*)\/?([^/\s]*))(\s+(([^/\s]*)\/([^/\s]*)\/?([^/\s]*)))?/g,v=/f\s+([^/\s]+)\s+([^/\s]+)\s+([^/\s]+)/g,S=!1,_=null,A,R,C,F;for(t=t.replace(a,"");(_=l.exec(t))!=null;)A=Number.parseFloat(_[1]),R=Number.parseFloat(_[2]),C=Number.parseFloat(_[3]),e.push(A),e.push(R),e.push(C);for(;(_=h.exec(t))!=null;)A=Number.parseFloat(_[1]),R=Number.parseFloat(_[2]),C=Number.parseFloat(_[3]),n.push(A),n.push(R),n.push(C);for(;(_=d.exec(t))!=null;)A=Number.parseFloat(_[1]),R=Number.parseFloat(_[2]),r.push(A),r.push(R);for(;(_=x.exec(t))!=null;)A=Number.parseInt(_[2]),Number.isNaN(A)&&(A=1),R=Number.parseInt(_[6]),Number.isNaN(R)&&(R=1),C=Number.parseInt(_[10]),Number.isNaN(C)&&(C=1),i.push(A),i.push(R),i.push(C),A=Number.parseInt(_[4]),Number.isNaN(A)?(A=Number.parseInt(_[3]),R=Number.parseInt(_[7]),C=Number.parseInt(_[11]),o.push(A),o.push(R),o.push(C),s.push(1),s.push(1),s.push(1)):(R=Number.parseInt(_[8]),Number.isNaN(R)&&(R=1),C=Number.parseInt(_[12]),Number.isNaN(C)&&(C=1),o.push(A),o.push(R),o.push(C),A=Number.parseInt(_[3]),Number.isNaN(A)&&(A=1),R=Number.parseInt(_[7]),Number.isNaN(R)&&(R=1),C=Number.parseInt(_[11]),Number.isNaN(C)&&(C=1),s.push(A),s.push(R),s.push(C)),typeof _[13]!="undefined"&&(F=Number.parseInt(_[15]),Number.isNaN(F)&&(F=1),i.push(F),F=Number.parseInt(_[17]),Number.isNaN(F)?(F=Number.parseInt(_[16]),o.push(F),s.push(1)):(o.push(F),F=Number.parseInt(_[16]),s.push(F)),S=!0);for(;(_=v.exec(t))!=null;)A=Number.parseInt(_[2]),R=Number.parseInt(_[6]),C=Number.parseInt(_[10]),i.push(A),i.push(R),i.push(C),s.push(1),s.push(1),s.push(1),o.push(1),o.push(1),o.push(1),typeof _[13]!="undefined"&&(F=Number.parseInt(_[14]),i.push(F),s.push(1),o.push(1),S=!0);let I,k;k=i.length;let P=new Float32Array(k*3);for(let w=0;w<k;++w)I=i[w]-1,P[w*3+0]=e[I*3+0],P[w*3+1]=e[I*3+1],P[w*3+2]=e[I*3+2];k=s.length;let G=new Float32Array(k*2);for(let w=0;w<k;++w)I=s[w]-1,G[w*2+0]=r[I*2+0],G[w*2+1]=r[I*2+1];k=o.length;let V=new Float32Array(k*3);for(let w=0;w<k;++w)I=o[w]-1,V[w*3+0]=n[I*3+0],V[w*3+1]=n[I*3+1],V[w*3+2]=n[I*3+2];k=i.length;let y=new Uint16Array(k);for(let w=0;w<k;++w)y[w]=w;return S&&console.warn("WebGL does not support quad faces, only triangles."),{positions:P,texcoords:G,normals:V,indices:y}}async function ir(t){if(typeof t=="string"){let s=await(await fetch(t)).arrayBuffer();return ir(s)}else if(!(t instanceof ArrayBuffer||ArrayBuffer.isView(t)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let e=t,r=new TextDecoder().decode(e),n={};for(let i of r.split(`
`)){if(i=i.trim(),i<=0||i.startsWith("#")||i.startsWith("//"))continue;let s=[],o=0,a=i.indexOf(" ");for(;a>=0;)s.push(i.substring(o,a)),o=a+1,a=i.indexOf(" ",o);s.push(i.substring(o));let l=s[0],h=Number.parseInt(s[1]),d=Number.parseInt(s[2]),x=Number.parseInt(s[3]),v=Number.parseInt(s[4]),S=s.length>=6?Number.parseInt(s[5]):1,_=s.length>=7?Number.parseInt(s[6]):S,A=s.length>=8?Number.parseInt(s[7]):S>_?Math.ceil(S/_):1;n[l]={u:h,v:d,w:x,h:v,frames:S,cols:_,rows:A,name:l}}return n}async function Ye(t,e){if(typeof t=="string"){let o=await(await fetch(t)).arrayBuffer();return Ye(o)}else if(!(t instanceof ArrayBuffer||ArrayBuffer.isView(t)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let r=t,n=new ArrayBuffer(r.byteLength);return new Uint8Array(n).set(r),await e.decodeAudioData(n)}async function sr(t){if(typeof t=="string"){let n=await(await fetch(t)).arrayBuffer();return sr(n)}else if(!(t instanceof ArrayBuffer||ArrayBuffer.isView(t)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let e=t;return Da(new TextDecoder().decode(e))}var Fa=/(.+?)\s+(.*)/,Pa=/(.+)=(.+)/;function Da(t){let e=t.split(`
`),r={},n={},i={},s=[],o=[];for(let l of e){let h=Fa.exec(l);if(!h)continue;let[d,x,v]=h;switch(x){case"info":$e(r,v);break;case"common":$e(n,v);break;case"page":$e(i,v);break;case"chars":break;case"char":let S={};$e(S,v),"id"in S&&s.push(S);break;case"kerning":let _={};$e(_,v),"first"in _&&o.push(_);break;default:}}return{info:r,common:n,page:i,chars:s,kernings:o}}function $e(t,e){let r=e.split(/\s+/);for(let n of r){let i=Pa.exec(n);if(!i)continue;let[s,o,a]=i,l=JSON.parse(`[${a}]`);l.length===1?t[o]=l[0]:t[o]=l}}async function dt(t){if(typeof t=="string"){let n=await(await fetch(t)).arrayBuffer();return dt(n)}else if(!(t instanceof ArrayBuffer||ArrayBuffer.isView(t)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");let e=t;return new TextDecoder().decode(e)}var or=Symbol("audioContext"),Ce=class{static getAudioContext(){if(or in this)return this[or];{let e=new AudioContext;return Ua(e),this[or]=e,e}}constructor(e,r){this.audioContext=e,this.audioBuffer=r,this._playing=!1,this._started=!1,this._source=null,this.onAudioSourceEnded=this.onAudioSourceEnded.bind(this)}destroy(){this._source&&this._source.disconnect(),this._source=null,this._started=!1,this._playing=!1}onAudioSourceEnded(){this._playing=!1}play(e={}){let r=this.audioBuffer;if(!r)return;this._source&&this.destroy();let{pitch:n=void 0,gain:i=void 0,pan:s=void 0,loop:o=!1}=e,a=this.audioContext,l=a.createBufferSource();l.addEventListener("ended",this.onAudioSourceEnded),l.buffer=r,l.loop=o;let h=l;if(n&&(l.detune.value=n*100),i){let d=a.createGain();d.gain.value=i,h=h.connect(d)}if(s){let d=a.createStereoPanner();d.pan.value=s,h=h.connect(d)}h.connect(a.destination),l.start(),this._source=l,this._started=!0,this._playing=!0}pause(){this._source.stop(),this._playing=!1}isStarted(){return this._started}isPlaying(){return this._playing}isPaused(){return this._started&&!this._playing}};function Ua(t){let e=()=>{t.state==="suspended"&&t.resume()};document.addEventListener("click",e)}var $u=pe.fromString("cursorX","Mouse.PosX"),Wu=pe.fromString("cursorY","Mouse.PosY"),Xu=Y.fromString("activate","Mouse.Button0"),qu=Y.fromString("mark","Mouse.Button2"),Qu=Y.fromString("restart","Keyboard.KeyR");var Ju=Symbol("IslandRendererInfo");var ar=class{next(){return 0}},Bn=class extends ar{next(){return Math.random()}},Dn=class extends ar{constructor(e){super();this.seed=e,this.a=e}next(){var e=this.a+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}},O=class{static get RAND(){let e=new this;return this.next=this.next.bind(this),this.choose=this.choose.bind(this),this.range=this.range.bind(this),this.rangeInt=this.rangeInt.bind(this),this.sign=this.sign.bind(this),Object.defineProperty(this,"RAND",{value:e}),e}constructor(e=void 0){typeof e=="number"?this.generator=new Dn(e):e?this.generator=e:this.generator=new Bn,this.next=this.next.bind(this),this.choose=this.choose.bind(this),this.range=this.range.bind(this),this.rangeInt=this.rangeInt.bind(this),this.sign=this.sign.bind(this)}static next(){return this.RAND.next()}next(){return this.generator.next()}static choose(e){return this.RAND.choose(e)}choose(e){return e[Math.floor(this.generator.next()*e.length)]}static range(e,r){return this.RAND.range(e,r)}range(e,r){return(r-e)*this.generator.next()+e}static rangeInt(e,r){return this.RAND.rangeInt(e,r)}rangeInt(e,r){return Math.trunc(this.range(e,r))}static sign(){return this.RAND.sign()}sign(){return this.generator.next()<.5?-1:1}};document.title="Archaea";document.title="Architect";var Va=Y.fromString("moveLeft","Keyboard.KeyA"),ja=Y.fromString("moveRight","Keyboard.KeyD"),za=Y.fromString("moveUp","Keyboard.KeyW"),Ga=Y.fromString("moveDown","Keyboard.KeyS"),Fh=pe.fromString("cursorX","Mouse.PosX"),Ph=pe.fromString("cursorY","Mouse.PosY"),Ka=Y.fromString("shoot","Keyboard.Space");document.title="Bioform";var pt=1e-6,We=typeof Float32Array!="undefined"?Float32Array:Array,lr=Math.random;var ec=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var mt={};_t(mt,{add:()=>Za,angle:()=>El,bezier:()=>fl,ceil:()=>Ja,clone:()=>Wa,copy:()=>qa,create:()=>Fn,cross:()=>ul,dist:()=>Ml,distance:()=>Vn,div:()=>Rl,divide:()=>Hn,dot:()=>Gn,equals:()=>Tl,exactEquals:()=>Al,floor:()=>el,forEach:()=>Ol,fromValues:()=>Xa,hermite:()=>cl,inverse:()=>al,len:()=>Cl,length:()=>Pn,lerp:()=>hl,max:()=>rl,min:()=>tl,mul:()=>bl,multiply:()=>kn,negate:()=>ol,normalize:()=>ll,random:()=>dl,rotateX:()=>xl,rotateY:()=>gl,rotateZ:()=>vl,round:()=>nl,scale:()=>il,scaleAndAdd:()=>sl,set:()=>Qa,sqrDist:()=>Ll,sqrLen:()=>Il,squaredDistance:()=>jn,squaredLength:()=>zn,str:()=>wl,sub:()=>Sl,subtract:()=>Un,transformMat3:()=>ml,transformMat4:()=>pl,transformQuat:()=>_l,zero:()=>yl});function Fn(){var t=new We(3);return We!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Wa(t){var e=new We(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Pn(t){var e=t[0],r=t[1],n=t[2];return Math.hypot(e,r,n)}function Xa(t,e,r){var n=new We(3);return n[0]=t,n[1]=e,n[2]=r,n}function qa(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Qa(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t}function Za(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function Un(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function kn(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function Hn(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function Ja(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function el(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function tl(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t}function rl(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t}function nl(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function il(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function sl(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t}function Vn(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return Math.hypot(r,n,i)}function jn(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return r*r+n*n+i*i}function zn(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n}function ol(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function al(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function ll(t,e){var r=e[0],n=e[1],i=e[2],s=r*r+n*n+i*i;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function Gn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function ul(t,e,r){var n=e[0],i=e[1],s=e[2],o=r[0],a=r[1],l=r[2];return t[0]=i*l-s*a,t[1]=s*o-n*l,t[2]=n*a-i*o,t}function hl(t,e,r,n){var i=e[0],s=e[1],o=e[2];return t[0]=i+n*(r[0]-i),t[1]=s+n*(r[1]-s),t[2]=o+n*(r[2]-o),t}function cl(t,e,r,n,i,s){var o=s*s,a=o*(2*s-3)+1,l=o*(s-2)+s,h=o*(s-1),d=o*(3-2*s);return t[0]=e[0]*a+r[0]*l+n[0]*h+i[0]*d,t[1]=e[1]*a+r[1]*l+n[1]*h+i[1]*d,t[2]=e[2]*a+r[2]*l+n[2]*h+i[2]*d,t}function fl(t,e,r,n,i,s){var o=1-s,a=o*o,l=s*s,h=a*o,d=3*s*a,x=3*l*o,v=l*s;return t[0]=e[0]*h+r[0]*d+n[0]*x+i[0]*v,t[1]=e[1]*h+r[1]*d+n[1]*x+i[1]*v,t[2]=e[2]*h+r[2]*d+n[2]*x+i[2]*v,t}function dl(t,e){e=e||1;var r=lr()*2*Math.PI,n=lr()*2-1,i=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*i,t[1]=Math.sin(r)*i,t[2]=n*e,t}function pl(t,e,r){var n=e[0],i=e[1],s=e[2],o=r[3]*n+r[7]*i+r[11]*s+r[15];return o=o||1,t[0]=(r[0]*n+r[4]*i+r[8]*s+r[12])/o,t[1]=(r[1]*n+r[5]*i+r[9]*s+r[13])/o,t[2]=(r[2]*n+r[6]*i+r[10]*s+r[14])/o,t}function ml(t,e,r){var n=e[0],i=e[1],s=e[2];return t[0]=n*r[0]+i*r[3]+s*r[6],t[1]=n*r[1]+i*r[4]+s*r[7],t[2]=n*r[2]+i*r[5]+s*r[8],t}function _l(t,e,r){var n=r[0],i=r[1],s=r[2],o=r[3],a=e[0],l=e[1],h=e[2],d=i*h-s*l,x=s*a-n*h,v=n*l-i*a,S=i*v-s*x,_=s*d-n*v,A=n*x-i*d,R=o*2;return d*=R,x*=R,v*=R,S*=2,_*=2,A*=2,t[0]=a+d+S,t[1]=l+x+_,t[2]=h+v+A,t}function xl(t,e,r,n){var i=[],s=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],s[0]=i[0],s[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),s[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),t[0]=s[0]+r[0],t[1]=s[1]+r[1],t[2]=s[2]+r[2],t}function gl(t,e,r,n){var i=[],s=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],s[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),s[1]=i[1],s[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),t[0]=s[0]+r[0],t[1]=s[1]+r[1],t[2]=s[2]+r[2],t}function vl(t,e,r,n){var i=[],s=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],s[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),s[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),s[2]=i[2],t[0]=s[0]+r[0],t[1]=s[1]+r[1],t[2]=s[2]+r[2],t}function El(t,e){var r=t[0],n=t[1],i=t[2],s=e[0],o=e[1],a=e[2],l=Math.sqrt(r*r+n*n+i*i),h=Math.sqrt(s*s+o*o+a*a),d=l*h,x=d&&Gn(t,e)/d;return Math.acos(Math.min(Math.max(x,-1),1))}function yl(t){return t[0]=0,t[1]=0,t[2]=0,t}function wl(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Al(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Tl(t,e){var r=t[0],n=t[1],i=t[2],s=e[0],o=e[1],a=e[2];return Math.abs(r-s)<=pt*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-o)<=pt*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-a)<=pt*Math.max(1,Math.abs(i),Math.abs(a))}var Sl=Un,bl=kn,Rl=Hn,Ml=Vn,Ll=jn,Cl=Pn,Il=zn,Ol=function(){var t=Fn();return function(e,r,n,i,s,o){var a,l;for(r||(r=3),n||(n=0),i?l=Math.min(i*r+n,e.length):l=e.length,a=n;a<l;a+=r)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}}();var lc=mt.fromValues(0,1,0);var uc=Math.PI/3;var hc=Math.PI/180;var Kn=16,Bl=(()=>{let t=[],e=Kn,r=Math.PI*2/e,n=1,i=0,s,o;for(let a=0;a<=e;++a)s=Math.cos(a*r),o=Math.sin(a*r),t.push(0,0),t.push(n,i),t.push(s,o),n=s,i=o;return t})(),vc=Math.trunc(Bl.length/2),Dl=(()=>{let t=[],e=Kn,r=Math.PI*2/e,n=1,i=0,s,o;for(let a=0;a<=e;++a)s=Math.cos(a*r),o=Math.sin(a*r),t.push(n,i),t.push(s,o),n=s,i=o;return t})(),Ec=Math.trunc(Dl.length/2);var Fl=16,hr=16,Rc=hr/2,Pl=Fl*hr,Mc=1/Pl;var kl=.3,Zc=1-kl;var Hl=60,uf=1e3/Hl;var Yn=16,Vl=(()=>{let t=[],e=Yn,r=Math.PI*2/e,n=1,i=0,s,o;for(let a=0;a<=e;++a)s=Math.cos(a*r),o=Math.sin(a*r),t.push(0,0),t.push(n,i),t.push(s,o),n=s,i=o;return t})(),Ef=Math.trunc(Vl.length/2),jl=(()=>{let t=[],e=Yn,r=Math.PI*2/e,n=1,i=0,s,o;for(let a=0;a<=e;++a)s=Math.cos(a*r),o=Math.sin(a*r),t.push(n,i),t.push(s,o),n=s,i=o;return t})(),yf=Math.trunc(jl.length/2);document.title="Moonset";var zl=[2,4],Gl=[.3,1],Kl=30;function $n(t,e){let r={x:[],y:[],size:[],speed:[],length:0,width:t,height:e};for(let n=0;n<Kl;++n)r.x.push(O.range(0,t)),r.y.push(O.range(0,e)),r.size.push(O.range(...zl)),r.speed.push(O.range(...Gl)),r.length++;return r}function Wn(t,e,r="white"){for(let n=0;n<e.length;++n){let i=e.x[n],s=e.y[n],o=e.size[n],a=o/2;t.fillStyle=r,t.fillRect(i-a,s-a,o,o)}}function Xn(t,e=1,r=0){let{length:n,width:i,height:s}=t;for(let o=0;o<n;++o){let a=e*t.speed[o],l=r*t.speed[o];t.x[o]+=a,t.y[o]+=l,a<0?t.x[o]<0&&(t.x[o]=i,t.y[o]=O.range(0,s)):a>0&&t.x[o]>i&&(t.x[o]=0,t.y[o]=O.range(0,s)),l<0?t.y[o]<0&&(t.x[o]=O.range(0,i),t.y[o]=s):l>0&&t.y[o]>s&&(t.x[o]=O.range(0,i),t.y[o]=0)}}var fr={};_t(fr,{Backward:()=>Qn,Debug:()=>ti,Fire:()=>ei,Forward:()=>qn,RotateLeft:()=>Zn,RotateRight:()=>Jn});var qn=new Y("forward",[se.KEY_W,se.ARROW_UP]),Qn=new Y("backward",[se.KEY_S,se.ARROW_DOWN]),Zn=new Y("rotateLeft",[se.KEY_A,se.ARROW_LEFT]),Jn=new Y("rotateRight",[se.KEY_D,se.ARROW_RIGHT]),ei=new Y("fire",se.SPACE),ti=new Y("debug",se.BACKQUOTE);async function Oe(t){let e=Ce.getAudioContext(),r=await Ye(t,e);return new Ce(e,r)}var ge={SoundStart:new Ae("sound://start.wav","raw://start.wav",Oe),SoundDead:new Ae("sound://dead.wav","raw://dead.wav",Oe),SoundPop:new Ae("sound://pop.wav","raw://boop.wav",Oe),SoundShoot:new Ae("sound://shoot.wav","raw://click.wav",Oe),SoundBoom:new Ae("sound://boom.wav","raw://boom.wav",Oe),BackgroundMusic:new Ae("sound://music.wav","raw://music.wav",Oe)};var he=5,ri=2,Yl=["red","red","red","yellow","orange"];function ni(t,e,r,n){let i=t.canvas.width,s=t.canvas.height;e.x<-r&&(e.x=i),e.y<-n&&(e.y=s),e.x>i+r/2&&(e.x=-r),e.y>s+n/2&&(e.y=-n)}function ii(t,e,r){let n=t.x-e.x,i=t.y-e.y;return n*n+i*i<=r*r}function si(t,e,r,n){t.translate(e,r),t.beginPath(),t.arc(0,0,n,0,Math.PI*2),t.strokeStyle="lime",t.stroke(),t.setTransform(1,0,0,1,0,0)}function ke(t,e,r,n=10,i){for(let s=0;s<n;++s)t.particles.push(dr(t,e,r,O.range(-1,1)*ri,O.range(-1,1)*ri,i))}function dr(t,e,r,n,i,s){return typeof s=="function"&&(s=s.call(null)),{scene:t,x:e,y:r,dx:n,dy:i,rotation:Math.atan2(i,n),age:0,color:s,destroy(){this.scene.particles.splice(this.scene.particles.indexOf(this),1)}}}function oi(t){t.gamePause=!0,t.showPlayer=!1,ke(t,t.player.x,t.player.y,100,O.choose.bind(null,Yl)),ge.SoundDead.current.play(),ge.SoundBoom.current.play(),setTimeout(()=>t.gameStart=t.gameWait=!0,1e3)}var pr=[3e3,1e4],ai=4,$l=100,Te=1,te=8,Wl=1,li=["blue","blue","blue","dodgerblue","gray","darkgray","yellow"],ui=.1,Xl=()=>({x:0,y:0,dx:0,dy:0,size:0,rotation:0});function mr(t){let e=useContext(t,mr,()=>({asteroids:[],spawnTicks:pr[0]}))}function ci(t){for(let e=0;e<Wl*t.level;++e)hi(t)}function fi(t){t.asteroids.length=0}function _r(t){return t.asteroids}function di(t){return t.asteroids.length>0}function pi(t,e){t.gamePause||(t.spawnTicks-=e,t.spawnTicks<=0&&(hi(t),t.spawnTicks=O.range(pr[0],pr[1])))}function mi(t){let e=_r(t);for(let r of e)r.x+=r.dx,r.y+=r.dy,ni(t,r,r.size*2,r.size*2)}function xi(t){for(let e of t.asteroids)if(ii(e,t.player,e.size+he)){ke(t,e.x,e.y,10,O.choose.bind(null,li)),_i(t,e),oi(t);break}}function gi(t){t.spawnTicks=0}function hi(t){if(t.asteroids.length>$l)return;let e=O.choose(xr(t)),r=ql(e);t.asteroids.push(r)}function vi(t,e,r,n,i){let s=Xl();return s.x=t,s.y=e,s.dx=r,s.dy=n,s.size=i,s.rotation=Math.atan2(n,r),s}function ql(t){return vi(O.range(t[0],t[0]+t[2]),O.range(t[1],t[1]+t[3]),O.range(-Te,Te),O.range(-Te,Te),te)}function xr(t){let e=t.canvas.width,r=t.canvas.height;return[[-te,-te,te*2+e,te],[-te,0,te,r],[-te,r,te*2+e,te],[e,0,te,r]]}function Ql(t,e,r=0,n=0){if(r*=ui,n*=ui,_i(t,e),e.size>ai){let i=[];for(let s=0;s<4;++s)i.push(vi(e.x+O.range(-te,te),e.y+O.range(-te,te),O.range(-Te,Te)+r,O.range(-Te,Te)+n,ai));t.asteroids.push(...i)}}function _i(t,e){t.asteroids.splice(t.asteroids.indexOf(e),1)}function Ei(t,e){for(let r of e.asteroids)Zl(t,r),si(t,r.x,r.y,r.size)}function Zl(t,e){t.translate(e.x,e.y),t.rotate(e.rotation),t.fillStyle="slategray",t.fillRect(-e.size,-e.size,e.size*2,e.size*2),t.setTransform(1,0,0,1,0,0)}function yi(t,e){t.fillStyle="rgba(255, 255, 255, 0.2)",t.font="24px sans-serif",t.textAlign="right",t.fillText(Math.ceil(e.spawnTicks/1e3),e.canvas.width,e.canvas.height-12)}function wi(t,e,r){ke(t,e.x,e.y,10,O.choose.bind(null,li)),Ql(t,e,r.dx,r.dy)}document.title="Starfield";async function Ai(t){let{display:e,assets:r,inputs:n}=t,i=e.canvas,s=i.getContext("2d"),o={load:W,start:D,update:Z,render:Se,canvas:i},a=1,l=2,h=4,d=2e3,x=100,v=10,S=4,_=600,A=["gray","darkgray","lightgray"],R="[ wasd_ ]",C=[-2,2],F=1.5,I=.1,k=.4,P=.1,G=.02,V=.008,y=.1,w=.001,K="gold",p=[1e4,3e4],B=4,U=["white","violet","violet"],ee=30,f=.7,c=!1;await o.load(),o.start(),e.addEventListener("frame",u=>{let m=u.detail.deltaTime;o.update(m),o.render(s)});async function W(){console.log("Loading..."),n.bindBindings(Object.values(fr)),await Q.loadAssetRefs(Object.values(ge)),console.log("...loading complete!")}function D(){this.level=0,this.score=0,this.highScore=Number(localStorage.getItem("highscore")),this.flashScoreDelta=0,this.flashHighScoreDelta=0,this.flashShootDelta=0,this.player={scene:this,x:i.width/2,y:i.height/2,rotation:0,dx:0,dy:0,dr:0,get left(){return Zn.value},get right(){return Jn.value},get up(){return qn.value},get down(){return Qn.value},get fire(){return ei.value},cooldown:0,powerMode:0,shoot(){if(!(this.scene.bullets.length>x)&&!(this.cooldown>0)){if(this.powerMode>0){for(let u=-1;u<=1;++u){let m=this.rotation+u*Math.PI/4,b=be(this.scene,this.x-Math.cos(m)*he,this.y-Math.sin(m)*he,-Math.cos(m)*h+this.dx,-Math.sin(m)*h+this.dy);this.scene.bullets.push(b)}--this.powerMode}else{let u=be(this.scene,this.x-Math.cos(this.rotation)*he,this.y-Math.sin(this.rotation)*he,-Math.cos(this.rotation)*h+this.dx,-Math.sin(this.rotation)*h+this.dy);this.scene.bullets.push(u)}this.cooldown=v,ge.SoundShoot.current.play()}}},mr(this),this.bullets=[],this.particles=[],this.powerUps=[],this.powerUpSpawner={scene:this,reset(){},spawn(){let u=O.choose(xr(this.scene)),m=ve(this.scene,O.range(u[0],u[0]+u[2]),O.range(u[1],u[1]+u[3]),O.range(-a,a),O.range(-a,a));this.scene.powerUps.push(m)},update(u){}},this.starfield=$n(i.width,i.height),this.gamePause=!0,this.showPlayer=!0,this.gameStart=!0,this.gameWait=!0,this.hint=R}function Z(u){if(ti.pressed&&(c=!c),this.gameWait&&n.isAnyButtonPressed()&&(this.gameStart&&(ge.BackgroundMusic.current.play(),this.score=0,this.flashScore=!0,this.level=0,this.gameStart=!1,this.player.powerMode=0,this.powerUps.length=0,gi(this),this.powerUpSpawner.reset()),this.gameWait=!1,E(this)),this.gamePause){for(let M of this.particles)M.age+=u,M.age>_?M.destroy():(M.x+=M.dx,M.y+=M.dy,re(M,S*2,S*2));return}let m=this.player.right-this.player.left,b=this.player.down-this.player.up,H=this.player.fire;this.player.dx+=b*Math.cos(this.player.rotation)*G,this.player.dy+=b*Math.sin(this.player.rotation)*G,this.player.dx*=1-w,this.player.dy*=1-w,this.player.dr+=m*V,this.player.dr*=1-y,this.player.x+=this.player.dx,this.player.y+=this.player.dy,this.player.rotation+=this.player.dr,--this.player.cooldown,re(this.player,he*2,he*2),H&&(this.player.shoot(),this.flashShootDelta=1),b&&j(this,this.player.x,this.player.y,-b*Math.cos(this.player.rotation)*F,-b*Math.sin(this.player.rotation)*F,O.choose.bind(null,A));for(let M of this.bullets)M.age+=u,M.age>d?M.destroy():(M.x+=M.dx,M.y+=M.dy,re(M,l*2,l*2));let N=_r(this);for(let M of this.bullets)for(let ce of N)if(ie(M,ce,ce.size)){this.flashScore=1,this.score++,this.score>this.highScore&&(this.flashHighScore=this.score-this.highScore,this.highScore=this.score,localStorage.setItem("highscore",this.highScore)),ge.SoundPop.current.play(),M.destroy(),wi(this,ce,M);break}for(let M of this.particles)M.age+=u,M.age>_?M.destroy():(M.x+=M.dx,M.y+=M.dy,re(M,S*2,S*2));mi(this),xi(this);for(let M of this.powerUps)M.x+=M.dx,M.y+=M.dy,re(M,B*2,B*2);for(let M of this.powerUps)if(ie(M,this.player,B+he)){ke(this,M.x,M.y,10,O.choose.bind(null,U)),M.destroy(),this.player.powerMode+=ee;break}Xn(this.starfield),pi(this,u),this.powerUpSpawner.update(u),!this.gamePause&&!di(this)&&(this.gamePause=!0,this.showPlayer=!0,ge.SoundStart.current.play(),setTimeout(()=>this.gameWait=!0,1e3))}function X(u,m){u.translate(m.x,m.y),u.rotate(m.rotation),u.beginPath(),u.strokeStyle="violet",u.arc(0,0,B,0,Math.PI*2),u.moveTo(-B/2,0),u.lineTo(B/2,0),u.moveTo(0,-B/2),u.lineTo(0,B/2),u.stroke(),u.setTransform(1,0,0,1,0,0)}function q(u,m){u.translate(m.x,m.y),u.rotate(m.rotation),u.fillStyle=K,u.fillRect(-l,-l,l*4,l*2),u.setTransform(1,0,0,1,0,0)}function ae(u,m){u.translate(m.x,m.y),u.rotate(m.rotation),u.fillStyle=m.color;let b=S*(1-m.age/_);u.fillRect(-b,-b,b*2,b*2),u.setTransform(1,0,0,1,0,0)}function Se(u){u.fillStyle="black",u.fillRect(0,0,i.width,i.height),Wn(u,this.starfield),u.fillStyle="rgba(255, 255, 255, 0.2)",u.textAlign="center",u.textBaseline="middle",u.font="16px sans-serif",u.fillText(this.hint,i.width/2,i.height/2-32),this.flashScore>0?(u.fillStyle=`rgba(255, 255, 255, ${this.flashScore+.2})`,this.flashScore-=P):u.fillStyle="rgba(255, 255, 255, 0.2)",u.font="48px sans-serif",u.fillText("= "+String(this.score).padStart(2,"0")+" =",i.width/2,i.height/2),this.flashHighScore>0?(u.fillStyle=`rgba(255, 255, 255, ${this.flashHighScore+.2})`,this.flashHighScore-=P):u.fillStyle="rgba(255, 255, 255, 0.2)",u.font="16px sans-serif",u.fillText(String(this.highScore).padStart(2,"0"),i.width/2,i.height/2+32),yi(u,this),Ei(u,this);for(let m of this.powerUps)X(u,m),L(u,m.x,m.y,B);for(let m of this.bullets)q(u,m),L(u,m.x,m.y,l);for(let m of this.particles)ae(u,m);if(this.showPlayer){u.translate(this.player.x,this.player.y),u.rotate(this.player.rotation),u.fillStyle="white";let m=he;u.fillRect(-m,-m,m*2,m*2);let b=-1,H=0,N=0;this.flashShootDelta>0?(u.fillStyle=`rgb(${200*this.flashShootDelta+55*Math.sin(performance.now()/(v*2))}, 0, 0)`,this.flashShootDelta-=P,N=this.flashShootDelta*2,b=this.flashShootDelta):u.fillStyle="black",u.fillRect(-m-N/2+b,-(m/4)-N/2+H,m+N,m/2+N),u.setTransform(1,0,0,1,0,0)}L(u,this.player.x,this.player.y,he)}function re(u,m,b){u.x<-m&&(u.x=i.width),u.y<-b&&(u.y=i.height),u.x>i.width+m/2&&(u.x=-m),u.y>i.height+b/2&&(u.y=-b)}function ie(u,m,b){let H=u.x-m.x,N=u.y-m.y;return H*H+N*N<=b*b}function L(u,m,b,H){!c||(u.translate(m,b),u.beginPath(),u.arc(0,0,H,0,Math.PI*2),u.strokeStyle="lime",u.stroke(),u.setTransform(1,0,0,1,0,0))}function ve(u,m,b,H,N){return{scene:u,x:m,y:b,dx:H,dy:N,rotation:Math.atan2(N,H),destroy(){this.scene.powerUps.splice(this.scene.powerUps.indexOf(this),1)}}}function be(u,m,b,H,N){return{scene:u,x:m,y:b,dx:H,dy:N,rotation:Math.atan2(N,H),age:0,destroy(){this.scene.bullets.splice(this.scene.bullets.indexOf(this),1)}}}function E(u){u.bullets.length=0,fi(u),u.particles.length=0,u.player.x=i.width/2,u.player.y=i.height/2,u.player.dx=0,u.player.dy=0,u.level++,u.gamePause=!1,u.showPlayer=!0,ci(u),O.next()>f&&u.powerUpSpawner.spawn();let m=ge.BackgroundMusic.current;m.isPlaying()||m.play({loop:!0})}function j(u,m,b,H,N,M){if(O.next()>.3){let ce=dr(u,m+O.range(C[0],C[1]),b+O.range(C[0],C[1]),H,N,M);ce.age=O.range(_*I,_*k),u.particles.push(ce)}}}var Ti=16,Jl=(()=>{let t=[],e=Ti,r=Math.PI*2/e,n=1,i=0,s,o;for(let a=0;a<=e;++a)s=Math.cos(a*r),o=Math.sin(a*r),t.push(0,0),t.push(n,i),t.push(s,o),n=s,i=o;return t})(),gd=Math.trunc(Jl.length/2),eu=(()=>{let t=[],e=Ti,r=Math.PI*2/e,n=1,i=0,s,o;for(let a=0;a<=e;++a)s=Math.cos(a*r),o=Math.sin(a*r),t.push(n,i),t.push(s,o),n=s,i=o;return t})(),vd=Math.trunc(eu.length/2);var tu=`
<slot></slot>
<div class="container"></div>`,ru=`
slot, ::slotted(*) {
    display: none;
}

.outer {
    overflow: hidden;
}
.outer, .inner {
    display: inline-block;
    transform-origin: top left;
    transform: scale(0, 1);
    contain: content;
}
.inner {
    white-space: pre;
}

.container p {
    margin: 0;
}

.waveChild {
    display: inline-block;
    transform-origin: top left;
    animation-name: wavy;
    animation-duration: 300ms;
    animation-direction: alternate;
    animation-iteration-count: infinite;
    animation-timing-function: linear;
}
@keyframes wavy{
    from {
        transform: translateY(-6%);
    }
    to {
        transform: translateY(6%);
    }
}`,nu=30,iu=120,Si=10,[su,ou]=(()=>{let t=[],e=[];for(let r=1;r<=Si;++r){let n=r/Si,i=n.toFixed(5);t.push({transform:`scale(${i},1)`});let s=(1/n).toFixed(5);e.push({transform:`scale(${s},1)`})}return[t,e]})(),bi=class extends HTMLElement{static get[Symbol.for("templateNode")](){let e=document.createElement("template");return e.innerHTML=tu,Object.defineProperty(this,Symbol.for("templateNode"),{value:e}),e}static get[Symbol.for("styleNode")](){let e=document.createElement("style");return e.innerHTML=ru,Object.defineProperty(this,Symbol.for("styleNode"),{value:e}),e}static define(e=window.customElements){e.define("dialogue-area",this)}get paused(){return this._paused}set paused(e){e?this.pause():this.play()}get autoplay(){return this.hasAttribute("autoplay")}set autoplay(e){this.toggleAttribute("autoplay",e)}constructor(){super();let e=this.attachShadow({mode:"open"});e.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),e.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._containerElement=e.querySelector(".container"),this._slotElement=e.querySelector("slot"),this._typeWriteQueue=[],this._typeWriteIndex=0,this._currentWaitTime=0,this._currentWaitTimeout=null,this._currentAnimations=[],this._paused=!0,this._eventFinish=new CustomEvent("finish",{composed:!0,bubbles:!1}),this.onSlotChange=this.onSlotChange.bind(this),this.onAnimationFinish=this.onAnimationFinish.bind(this),this.onWaitTimeout=this.onWaitTimeout.bind(this),this._slotElement.addEventListener("slotchange",this.onSlotChange)}connectedCallback(){au(this,"autoplay")}disconnectedCallback(){this._containerElement.innerHTML=""}play(){this._paused=!1;for(let e of this._currentAnimations)e.play();this.step()}pause(){this._paused=!0;for(let e of this._currentAnimations)e.pause()}reset(){this._typeWriteIndex=0;for(let r of this._currentAnimations)r.cancel();this._currentAnimations.length=0,clearTimeout(this._currentWaitTimeout),this._currentWaitTimeout=null;let e=this._typeWriteQueue;for(let r of e){let n=r.children.item(0);r.style.removeProperty("transform"),n.style.removeProperty("transform")}}step(){if(this._currentAnimations.length>0||this._currentWaitTimeout||this._paused||this._typeWriteIndex>=this._typeWriteQueue.length)return;let e=nu;if(this.hasAttribute("speed")){let h=Number(this.getAttribute("speed"));h>0?e/=h:e=0}if(e<=0){this.skip();return}let r=this._typeWriteQueue[this._typeWriteIndex],n=r.children.item(0);r.style.transform="scale(1,1)",n.style.transform="scale(1,1)";let s=n.textContent.length*e,o=(n.hasAttribute("data-p-wait")?Number(n.getAttribute("data-p-wait")):0)*e*4,a=r.animate(su,s),l=n.animate(ou,s);this._currentAnimations.push(a,l),this._currentWaitTime=o,this._typeWriteIndex+=1,l.addEventListener("finish",this.onAnimationFinish)}skip(){if(this._typeWriteIndex>=this._typeWriteQueue.length)return;let e=this._currentWaitTimeout;this._currentWaitTimeout=null,clearTimeout(e);let r=this._currentAnimations;this._currentAnimations.length=0;for(let s of r)s.finish();let n=this._typeWriteQueue,i=n.length;for(let s=this._typeWriteIndex;s<i;++s){let o=n[s],a=o.children.item(0);o.style.transform="scale(1,1)",a.style.transform="scale(1,1)"}this._typeWriteIndex=n.length}onSlotChange(){this.reset();let e=this._containerElement,r=lu(this._slotElement);e.innerHTML="",e.appendChild(r);let n=e.querySelectorAll(".outer"),i=this._typeWriteQueue;i.length=0;let s=n.length;for(let o=0;o<s;++o){let a=n.item(o);i.push(a)}this._typeWriteIndex=0,this.hasAttribute("autoplay")&&this.play()}onAnimationFinish(){if(this._currentAnimations.length=0,this._typeWriteIndex>=this._typeWriteQueue.length){this.dispatchEvent(this._eventFinish);return}let e=this._currentWaitTime;e>0?(this._currentWaitTime=0,this._currentWaitTimeout=setTimeout(this.onWaitTimeout,e)):this.step()}onWaitTimeout(){this._currentWaitTimeout=null,this.step()}};bi.define();function au(t,e){if(Object.prototype.hasOwnProperty.call(t,e)){let r=t[e];delete t[e],t[e]=r}}function lu(t){let e=document.createDocumentFragment(),r=t.assignedNodes();for(let n of r){if(n=n.cloneNode(!0),n.nodeType===3){let s=n.textContent.split(/\s+/).filter(Boolean).map(a=>a+" "),o=document.createDocumentFragment();for(let a of s){let l=Mi(a),h=gr(a,l);o.append(h)}n=o}else{let i=Ri(n,/\s+/,!0);for(let{parent:s,node:o,content:a}of i){if(s.nodeName==="P-WAIT"){let h=gr("",Number(a.join("")));s.insertBefore(h,o)}else for(let h of a){let d=Mi(h),x=gr(h,d);s.insertBefore(x,o)}s.removeChild(o)}}if(n instanceof Element){let i=[];n.nodeName==="P-WAVE"&&i.push(n);let s=n.querySelectorAll("p-wave"),o=s.length;for(let a=0;a<o;++a){let l=s.item(a);i.push(l)}for(let a of i){let l=Ri(a,"",!1);for(let{parent:h,node:d,content:x}of l){let v=0;for(let S of x){let _=document.createElement("span");_.className="waveChild",_.textContent=S,_.style.animationDelay=`${v}ms`,v+=iu,h.insertBefore(_,d)}h.removeChild(d)}}}e.append(n)}return e}function Ri(t,e,r){let n=[],i=document.createTreeWalker(t,NodeFilter.SHOW_TEXT),s;for(;s=i.nextNode();){let a=s.textContent.split(e).filter(Boolean);r&&(a=a.map(h=>h+" "));let l={parent:s.parentNode,node:s,content:a};n.push(l)}return n}function Mi(t){let e=/([\.\!\?\:\-]+)$/.exec(t),r=/([\,\;]+)$/.exec(t),n=0;if(e){let[i,s]=e;n+=s.length*2}if(r){let[i,s]=r;n+=s.length}return n}function gr(t,e){let r=document.createElement("span");r.className="outer";let n=document.createElement("span");return n.className="inner",r.append(n),e>0&&n.setAttribute("data-p-wait",String(e)),t&&(n.textContent=t),r}document.title="roomie";window.addEventListener("DOMContentLoaded",uu);async function uu(){let t=document.querySelector("#display"),e=document.querySelector("#inputs").getContext("axisbutton"),r=new Jt;await Q.loadAssetPack("res.pack",(i,s,o)=>Q.cache("res/"+o,i)),await r.pipe("res/**/*.md",async(i,s)=>Q.cache("txt:"+s.substring(4),await dt(i))),await r.pipe("res/**/*.txt",async(i,s)=>Q.cache("txt:"+s.substring(4),await dt(i))),await r.pipe("res/**/*.png",async(i,s)=>Q.cache("image:"+s.substring(4),await rr(i,"image/png"))),await r.pipe("res/**/*.obj",async(i,s)=>Q.cache("obj:"+s.substring(4),await nr(i))),await r.pipe("res/**/*.atlas",async(i,s)=>Q.cache("atlas:"+s.substring(4),await ir(i))),await r.pipe("res/**/*.fnt",async(i,s)=>Q.cache("fnt:"+s.substring(4),await sr(i))),await r.pipe("res/**/*.wav",async(i,s)=>{let o=Ce.getAudioContext(),a=await Ye(i,o),l=new Ce(o,a);return Q.cache("sound:"+s.substring(4),l)});let n=new tr(t,e);t.addEventListener("frame",i=>{let{deltaTime:s,prevTime:o,now:a}=i.detail;n.deltaTime=s,n.prevTime=o,n.now=a,e.poll(a),n.emit("frame")}),await Ai(n)}})();
//# sourceMappingURL=main.js.map
