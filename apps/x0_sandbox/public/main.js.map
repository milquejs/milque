{
  "version": 3,
  "sources": ["node-modules-polyfills:path", "node-modules-polyfills-commonjs:path", "../../../common/temp/node_modules/.pnpm/picomatch@2.3.1/node_modules/picomatch/lib/constants.js", "../../../common/temp/node_modules/.pnpm/picomatch@2.3.1/node_modules/picomatch/lib/utils.js", "../../../common/temp/node_modules/.pnpm/picomatch@2.3.1/node_modules/picomatch/lib/scan.js", "../../../common/temp/node_modules/.pnpm/picomatch@2.3.1/node_modules/picomatch/lib/parse.js", "../../../common/temp/node_modules/.pnpm/picomatch@2.3.1/node_modules/picomatch/lib/picomatch.js", "../../../common/temp/node_modules/.pnpm/picomatch@2.3.1/node_modules/picomatch/index.js", "../../../libs/display/src/DisplayPort.js", "../../../libs/input/src/state/InputState.js", "../../../libs/input/src/state/AxisState.js", "../../../libs/input/src/state/ButtonState.js", "../../../libs/input/src/keycode/KeyCode.js", "../../../libs/input/src/keycode/KeyCodes.js", "../../../libs/input/src/binding/InputBinding.js", "../../../libs/input/src/keycode/KeyCodeHelper.js", "../../../libs/input/src/binding/AxisBinding.js", "../../../libs/input/src/binding/ButtonBinding.js", "../../../libs/input/src/binding/AxisButtonBinding.js", "../../../libs/input/src/device/InputDevice.js", "../../../libs/input/src/device/KeyboardDevice.js", "../../../libs/input/src/device/MouseDevice.js", "../../../libs/input/src/inputcode/InputCode.js", "../../../libs/input/src/AutoPoller.js", "../../../libs/input/src/DeviceInputAdapter.js", "../../../libs/input/src/InputBindings.js", "../../../libs/input/src/InputContext.js", "../../../libs/input/src/inputport/InputPort.js", "../../../libs/input/src/Keyboard.js", "../../../libs/input/src/Mouse.js", "../src/error.js", "../../../common/temp/node_modules/.pnpm/fflate@0.7.4/node_modules/fflate/esm/browser.js", "../../../libs/asset/src/GlobExp.js", "../../../libs/asset/src/AssetStore.js", "../../../libs/asset/src/AssetManager.js", "../../../libs/asset/src/AssetRef.js", "../../../libs/asset/src/AssetHelper.js", "../../../libs/asset/src/loaders/AtlasLoader.js", "../../../libs/asset/src/loaders/BMFontLoader.js", "../../../libs/asset/src/loaders/ImageLoader.js", "../../../libs/asset/src/loaders/OBJLoader.js", "../../../libs/asset/src/loaders/TextLoader.js", "../../../libs/asset/src/loaders/AudioBufferLoader.js", "../src/loader/AssetPipeline.js", "../../../libs/util/src/Eventable.js", "../../../libs/util/src/Logger.js", "../../../libs/util/src/Discrete.js", "../../../libs/util/src/Downloader.js", "../../../libs/util/src/Uploader.js", "../../../libs/util/src/PriorityQueue.js", "../../../libs/util/src/uuidv4.js", "../../../libs/util/src/MathHelper.js", "../../../libs/util/src/TopologicalSort.js", "../../../libs/util/src/AStar.js", "../../../libs/util/src/Shuffle.js", "../../../libs/util/src/BitHelper.js", "../src/game/Game.js", "../src/loader/OBJLoader.js", "../src/loader/AtlasLoader.js", "../src/loader/AudioBufferLoader.js", "../src/loader/BMFontLoader.js", "../src/loader/TextLoader.js", "../src/audio/Sound.js", "../src/000/MainControls.js", "../src/000/IslandRenderer.js", "../../../libs/random/src/generators/RandomBase.js", "../../../libs/random/src/generators/MathRandom.js", "../../../libs/random/src/generators/Mulberry32.js", "../../../libs/random/src/Random.js", "../../../libs/random/src/generators/SmallFastCounter32.js", "../src/000/main.js", "../src/001/main.js", "../src/002/PlayerInputs.js", "../src/002/main.js", "../../../common/temp/node_modules/.pnpm/gl-matrix@3.4.3/node_modules/gl-matrix/esm/common.js", "../../../common/temp/node_modules/.pnpm/gl-matrix@3.4.3/node_modules/gl-matrix/esm/mat3.js", "../../../common/temp/node_modules/.pnpm/gl-matrix@3.4.3/node_modules/gl-matrix/esm/mat4.js", "../../../common/temp/node_modules/.pnpm/gl-matrix@3.4.3/node_modules/gl-matrix/esm/quat.js", "../../../common/temp/node_modules/.pnpm/gl-matrix@3.4.3/node_modules/gl-matrix/esm/vec3.js", "../../../common/temp/node_modules/.pnpm/gl-matrix@3.4.3/node_modules/gl-matrix/esm/vec4.js", "../../../common/temp/node_modules/.pnpm/gl-matrix@3.4.3/node_modules/gl-matrix/esm/vec2.js", "../../../libs/scene/src/camera/CameraHelper.js", "../../../libs/scene/src/camera/Camera.js", "../../../libs/scene/src/camera/PerspectiveCamera.js", "../../../libs/scene/src/camera/OrthographicCamera.js", "../../../libs/scene/src/camera/FirstPersonCameraController.js", "../../../libs/scene/src/scenegraph/SceneGraph.js", "../../../libs/scene/src/entity/ComponentClass.js", "../../../libs/scene/src/entity/EntityManager.js", "../../../libs/scene/src/topic/Topic.js", "../../../libs/scene/src/topic/CommandTopic.js", "../../../libs/scene/src/topic/EventTopic.js", "../../../libs/scene/src/topic/PriorityEventTopic.js", "../../../libs/scene/src/loop/AnimationFrameLoop.js", "../../../libs/mogli/src/GLHelper.js", "../../../libs/mogli/src/buffer/BufferBuilder.js", "../../../libs/mogli/src/buffer/BufferInfo.js", "../../../libs/mogli/src/buffer/BufferEnums.js", "../../../libs/mogli/src/buffer/helper/BufferHelper.js", "../../../libs/mogli/src/buffer/BufferInfoBuilder.js", "../../../libs/mogli/src/program/helper/ProgramActives.js", "../../../libs/mogli/src/program/ProgramAttributeHelper.js", "../../../libs/mogli/src/program/ProgramAttributeFunctions.js", "../../../libs/mogli/src/program/ProgramAttributeInfo.js", "../../../libs/mogli/src/program/helper/ProgramHelper.js", "../../../libs/mogli/src/program/ProgramUniformFunctions.js", "../../../libs/mogli/src/program/ProgramUniformInfo.js", "../../../libs/mogli/src/program/helper/ProgramInfoHelper.js", "../../../libs/mogli/src/buffer/helper/BufferInfoHelper.js", "../../../libs/mogli/src/program/ProgramInfo.js", "../../../libs/mogli/src/program/ProgramBuilder.js", "../../../libs/mogli/src/program/ProgramInfoBuilder.js", "../../../libs/mogli/src/program/ProgramUniformEnums.js", "../../../libs/mogli/src/program/ProgramAttributeEnums.js", "../src/renderer/color.js", "../src/deprecated/fixedgl/FixedShapeGLRenderer2d.js", "../src/042/TileMap.js", "../src/044/Player.js", "../src/046/renderer/DrawContextFixedGLBase.js", "../src/046/renderer/DrawContextFixedGLShape.js", "../src/046/renderer/DrawContextFixedGLTexture.js", "../src/046/renderer/DrawContextFixedGLGradient.js", "../src/046/renderer/DrawContextFixedGLText.js", "../src/046/main.js", "../src/047/Inputs.js", "../src/audio/SoundLoader.js", "../src/047/Assets.js", "../src/047/main.js", "../src/main.js"],
  "sourcesContent": ["// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// resolves . and .. elements in a path array with directory names there\n// must be no slashes, empty elements, or device names (c:\\) in the array\n// (so also no leading and trailing slashes - it does not distinguish\n// relative and absolute paths)\nfunction normalizeArray(parts, allowAboveRoot) {\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = parts.length - 1; i >= 0; i--) {\n    var last = parts[i];\n    if (last === '.') {\n      parts.splice(i, 1);\n    } else if (last === '..') {\n      parts.splice(i, 1);\n      up++;\n    } else if (up) {\n      parts.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (allowAboveRoot) {\n    for (; up--; up) {\n      parts.unshift('..');\n    }\n  }\n\n  return parts;\n}\n\n// Split a filename into [root, dir, basename, ext], unix version\n// 'root' is just a slash, or nothing.\nvar splitPathRe =\n    /^(\\/?|)([\\s\\S]*?)((?:\\.{1,2}|[^\\/]+?|)(\\.[^.\\/]*|))(?:[\\/]*)$/;\nvar splitPath = function(filename) {\n  return splitPathRe.exec(filename).slice(1);\n};\n\n// path.resolve([from ...], to)\n// posix version\nexport function resolve() {\n  var resolvedPath = '',\n      resolvedAbsolute = false;\n\n  for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n    var path = (i >= 0) ? arguments[i] : '/';\n\n    // Skip empty and invalid entries\n    if (typeof path !== 'string') {\n      throw new TypeError('Arguments to path.resolve must be strings');\n    } else if (!path) {\n      continue;\n    }\n\n    resolvedPath = path + '/' + resolvedPath;\n    resolvedAbsolute = path.charAt(0) === '/';\n  }\n\n  // At this point the path should be resolved to a full absolute path, but\n  // handle relative paths to be safe (might happen when process.cwd() fails)\n\n  // Normalize the path\n  resolvedPath = normalizeArray(filter(resolvedPath.split('/'), function(p) {\n    return !!p;\n  }), !resolvedAbsolute).join('/');\n\n  return ((resolvedAbsolute ? '/' : '') + resolvedPath) || '.';\n};\n\n// path.normalize(path)\n// posix version\nexport function normalize(path) {\n  var isPathAbsolute = isAbsolute(path),\n      trailingSlash = substr(path, -1) === '/';\n\n  // Normalize the path\n  path = normalizeArray(filter(path.split('/'), function(p) {\n    return !!p;\n  }), !isPathAbsolute).join('/');\n\n  if (!path && !isPathAbsolute) {\n    path = '.';\n  }\n  if (path && trailingSlash) {\n    path += '/';\n  }\n\n  return (isPathAbsolute ? '/' : '') + path;\n};\n\n// posix version\nexport function isAbsolute(path) {\n  return path.charAt(0) === '/';\n}\n\n// posix version\nexport function join() {\n  var paths = Array.prototype.slice.call(arguments, 0);\n  return normalize(filter(paths, function(p, index) {\n    if (typeof p !== 'string') {\n      throw new TypeError('Arguments to path.join must be strings');\n    }\n    return p;\n  }).join('/'));\n}\n\n\n// path.relative(from, to)\n// posix version\nexport function relative(from, to) {\n  from = resolve(from).substr(1);\n  to = resolve(to).substr(1);\n\n  function trim(arr) {\n    var start = 0;\n    for (; start < arr.length; start++) {\n      if (arr[start] !== '') break;\n    }\n\n    var end = arr.length - 1;\n    for (; end >= 0; end--) {\n      if (arr[end] !== '') break;\n    }\n\n    if (start > end) return [];\n    return arr.slice(start, end - start + 1);\n  }\n\n  var fromParts = trim(from.split('/'));\n  var toParts = trim(to.split('/'));\n\n  var length = Math.min(fromParts.length, toParts.length);\n  var samePartsLength = length;\n  for (var i = 0; i < length; i++) {\n    if (fromParts[i] !== toParts[i]) {\n      samePartsLength = i;\n      break;\n    }\n  }\n\n  var outputParts = [];\n  for (var i = samePartsLength; i < fromParts.length; i++) {\n    outputParts.push('..');\n  }\n\n  outputParts = outputParts.concat(toParts.slice(samePartsLength));\n\n  return outputParts.join('/');\n}\n\nexport var sep = '/';\nexport var delimiter = ':';\n\nexport function dirname(path) {\n  var result = splitPath(path),\n      root = result[0],\n      dir = result[1];\n\n  if (!root && !dir) {\n    // No dirname whatsoever\n    return '.';\n  }\n\n  if (dir) {\n    // It has a dirname, strip trailing slash\n    dir = dir.substr(0, dir.length - 1);\n  }\n\n  return root + dir;\n}\n\nexport function basename(path, ext) {\n  var f = splitPath(path)[2];\n  // TODO: make this comparison case-insensitive on windows?\n  if (ext && f.substr(-1 * ext.length) === ext) {\n    f = f.substr(0, f.length - ext.length);\n  }\n  return f;\n}\n\n\nexport function extname(path) {\n  return splitPath(path)[3];\n}\nexport default {\n  extname: extname,\n  basename: basename,\n  dirname: dirname,\n  sep: sep,\n  delimiter: delimiter,\n  relative: relative,\n  join: join,\n  isAbsolute: isAbsolute,\n  normalize: normalize,\n  resolve: resolve\n};\nfunction filter (xs, f) {\n    if (xs.filter) return xs.filter(f);\n    var res = [];\n    for (var i = 0; i < xs.length; i++) {\n        if (f(xs[i], i, xs)) res.push(xs[i]);\n    }\n    return res;\n}\n\n// String.prototype.substr - negative index don't work in IE8\nvar substr = 'ab'.substr(-1) === 'b' ?\n    function (str, start, len) { return str.substr(start, len) } :\n    function (str, start, len) {\n        if (start < 0) start = str.length + start;\n        return str.substr(start, len);\n    }\n;\n", "\nconst polyfill = require('path')\n\nif (polyfill && polyfill.default) {\n    module.exports = polyfill.default\n    for (let k in polyfill) {\n        module.exports[k] = polyfill[k]\n    }\n} else if (polyfill)  {\n    module.exports = polyfill\n}\n\n\n", "'use strict';\n\nconst path = require('path');\nconst WIN_SLASH = '\\\\\\\\/';\nconst WIN_NO_SLASH = `[^${WIN_SLASH}]`;\n\n/**\n * Posix glob regex\n */\n\nconst DOT_LITERAL = '\\\\.';\nconst PLUS_LITERAL = '\\\\+';\nconst QMARK_LITERAL = '\\\\?';\nconst SLASH_LITERAL = '\\\\/';\nconst ONE_CHAR = '(?=.)';\nconst QMARK = '[^/]';\nconst END_ANCHOR = `(?:${SLASH_LITERAL}|$)`;\nconst START_ANCHOR = `(?:^|${SLASH_LITERAL})`;\nconst DOTS_SLASH = `${DOT_LITERAL}{1,2}${END_ANCHOR}`;\nconst NO_DOT = `(?!${DOT_LITERAL})`;\nconst NO_DOTS = `(?!${START_ANCHOR}${DOTS_SLASH})`;\nconst NO_DOT_SLASH = `(?!${DOT_LITERAL}{0,1}${END_ANCHOR})`;\nconst NO_DOTS_SLASH = `(?!${DOTS_SLASH})`;\nconst QMARK_NO_DOT = `[^.${SLASH_LITERAL}]`;\nconst STAR = `${QMARK}*?`;\n\nconst POSIX_CHARS = {\n  DOT_LITERAL,\n  PLUS_LITERAL,\n  QMARK_LITERAL,\n  SLASH_LITERAL,\n  ONE_CHAR,\n  QMARK,\n  END_ANCHOR,\n  DOTS_SLASH,\n  NO_DOT,\n  NO_DOTS,\n  NO_DOT_SLASH,\n  NO_DOTS_SLASH,\n  QMARK_NO_DOT,\n  STAR,\n  START_ANCHOR\n};\n\n/**\n * Windows glob regex\n */\n\nconst WINDOWS_CHARS = {\n  ...POSIX_CHARS,\n\n  SLASH_LITERAL: `[${WIN_SLASH}]`,\n  QMARK: WIN_NO_SLASH,\n  STAR: `${WIN_NO_SLASH}*?`,\n  DOTS_SLASH: `${DOT_LITERAL}{1,2}(?:[${WIN_SLASH}]|$)`,\n  NO_DOT: `(?!${DOT_LITERAL})`,\n  NO_DOTS: `(?!(?:^|[${WIN_SLASH}])${DOT_LITERAL}{1,2}(?:[${WIN_SLASH}]|$))`,\n  NO_DOT_SLASH: `(?!${DOT_LITERAL}{0,1}(?:[${WIN_SLASH}]|$))`,\n  NO_DOTS_SLASH: `(?!${DOT_LITERAL}{1,2}(?:[${WIN_SLASH}]|$))`,\n  QMARK_NO_DOT: `[^.${WIN_SLASH}]`,\n  START_ANCHOR: `(?:^|[${WIN_SLASH}])`,\n  END_ANCHOR: `(?:[${WIN_SLASH}]|$)`\n};\n\n/**\n * POSIX Bracket Regex\n */\n\nconst POSIX_REGEX_SOURCE = {\n  alnum: 'a-zA-Z0-9',\n  alpha: 'a-zA-Z',\n  ascii: '\\\\x00-\\\\x7F',\n  blank: ' \\\\t',\n  cntrl: '\\\\x00-\\\\x1F\\\\x7F',\n  digit: '0-9',\n  graph: '\\\\x21-\\\\x7E',\n  lower: 'a-z',\n  print: '\\\\x20-\\\\x7E ',\n  punct: '\\\\-!\"#$%&\\'()\\\\*+,./:;<=>?@[\\\\]^_`{|}~',\n  space: ' \\\\t\\\\r\\\\n\\\\v\\\\f',\n  upper: 'A-Z',\n  word: 'A-Za-z0-9_',\n  xdigit: 'A-Fa-f0-9'\n};\n\nmodule.exports = {\n  MAX_LENGTH: 1024 * 64,\n  POSIX_REGEX_SOURCE,\n\n  // regular expressions\n  REGEX_BACKSLASH: /\\\\(?![*+?^${}(|)[\\]])/g,\n  REGEX_NON_SPECIAL_CHARS: /^[^@![\\].,$*+?^{}()|\\\\/]+/,\n  REGEX_SPECIAL_CHARS: /[-*+?.^${}(|)[\\]]/,\n  REGEX_SPECIAL_CHARS_BACKREF: /(\\\\?)((\\W)(\\3*))/g,\n  REGEX_SPECIAL_CHARS_GLOBAL: /([-*+?.^${}(|)[\\]])/g,\n  REGEX_REMOVE_BACKSLASH: /(?:\\[.*?[^\\\\]\\]|\\\\(?=.))/g,\n\n  // Replace globs with equivalent patterns to reduce parsing time.\n  REPLACEMENTS: {\n    '***': '*',\n    '**/**': '**',\n    '**/**/**': '**'\n  },\n\n  // Digits\n  CHAR_0: 48, /* 0 */\n  CHAR_9: 57, /* 9 */\n\n  // Alphabet chars.\n  CHAR_UPPERCASE_A: 65, /* A */\n  CHAR_LOWERCASE_A: 97, /* a */\n  CHAR_UPPERCASE_Z: 90, /* Z */\n  CHAR_LOWERCASE_Z: 122, /* z */\n\n  CHAR_LEFT_PARENTHESES: 40, /* ( */\n  CHAR_RIGHT_PARENTHESES: 41, /* ) */\n\n  CHAR_ASTERISK: 42, /* * */\n\n  // Non-alphabetic chars.\n  CHAR_AMPERSAND: 38, /* & */\n  CHAR_AT: 64, /* @ */\n  CHAR_BACKWARD_SLASH: 92, /* \\ */\n  CHAR_CARRIAGE_RETURN: 13, /* \\r */\n  CHAR_CIRCUMFLEX_ACCENT: 94, /* ^ */\n  CHAR_COLON: 58, /* : */\n  CHAR_COMMA: 44, /* , */\n  CHAR_DOT: 46, /* . */\n  CHAR_DOUBLE_QUOTE: 34, /* \" */\n  CHAR_EQUAL: 61, /* = */\n  CHAR_EXCLAMATION_MARK: 33, /* ! */\n  CHAR_FORM_FEED: 12, /* \\f */\n  CHAR_FORWARD_SLASH: 47, /* / */\n  CHAR_GRAVE_ACCENT: 96, /* ` */\n  CHAR_HASH: 35, /* # */\n  CHAR_HYPHEN_MINUS: 45, /* - */\n  CHAR_LEFT_ANGLE_BRACKET: 60, /* < */\n  CHAR_LEFT_CURLY_BRACE: 123, /* { */\n  CHAR_LEFT_SQUARE_BRACKET: 91, /* [ */\n  CHAR_LINE_FEED: 10, /* \\n */\n  CHAR_NO_BREAK_SPACE: 160, /* \\u00A0 */\n  CHAR_PERCENT: 37, /* % */\n  CHAR_PLUS: 43, /* + */\n  CHAR_QUESTION_MARK: 63, /* ? */\n  CHAR_RIGHT_ANGLE_BRACKET: 62, /* > */\n  CHAR_RIGHT_CURLY_BRACE: 125, /* } */\n  CHAR_RIGHT_SQUARE_BRACKET: 93, /* ] */\n  CHAR_SEMICOLON: 59, /* ; */\n  CHAR_SINGLE_QUOTE: 39, /* ' */\n  CHAR_SPACE: 32, /*   */\n  CHAR_TAB: 9, /* \\t */\n  CHAR_UNDERSCORE: 95, /* _ */\n  CHAR_VERTICAL_LINE: 124, /* | */\n  CHAR_ZERO_WIDTH_NOBREAK_SPACE: 65279, /* \\uFEFF */\n\n  SEP: path.sep,\n\n  /**\n   * Create EXTGLOB_CHARS\n   */\n\n  extglobChars(chars) {\n    return {\n      '!': { type: 'negate', open: '(?:(?!(?:', close: `))${chars.STAR})` },\n      '?': { type: 'qmark', open: '(?:', close: ')?' },\n      '+': { type: 'plus', open: '(?:', close: ')+' },\n      '*': { type: 'star', open: '(?:', close: ')*' },\n      '@': { type: 'at', open: '(?:', close: ')' }\n    };\n  },\n\n  /**\n   * Create GLOB_CHARS\n   */\n\n  globChars(win32) {\n    return win32 === true ? WINDOWS_CHARS : POSIX_CHARS;\n  }\n};\n", "'use strict';\n\nconst path = require('path');\nconst win32 = process.platform === 'win32';\nconst {\n  REGEX_BACKSLASH,\n  REGEX_REMOVE_BACKSLASH,\n  REGEX_SPECIAL_CHARS,\n  REGEX_SPECIAL_CHARS_GLOBAL\n} = require('./constants');\n\nexports.isObject = val => val !== null && typeof val === 'object' && !Array.isArray(val);\nexports.hasRegexChars = str => REGEX_SPECIAL_CHARS.test(str);\nexports.isRegexChar = str => str.length === 1 && exports.hasRegexChars(str);\nexports.escapeRegex = str => str.replace(REGEX_SPECIAL_CHARS_GLOBAL, '\\\\$1');\nexports.toPosixSlashes = str => str.replace(REGEX_BACKSLASH, '/');\n\nexports.removeBackslashes = str => {\n  return str.replace(REGEX_REMOVE_BACKSLASH, match => {\n    return match === '\\\\' ? '' : match;\n  });\n};\n\nexports.supportsLookbehinds = () => {\n  const segs = process.version.slice(1).split('.').map(Number);\n  if (segs.length === 3 && segs[0] >= 9 || (segs[0] === 8 && segs[1] >= 10)) {\n    return true;\n  }\n  return false;\n};\n\nexports.isWindows = options => {\n  if (options && typeof options.windows === 'boolean') {\n    return options.windows;\n  }\n  return win32 === true || path.sep === '\\\\';\n};\n\nexports.escapeLast = (input, char, lastIdx) => {\n  const idx = input.lastIndexOf(char, lastIdx);\n  if (idx === -1) return input;\n  if (input[idx - 1] === '\\\\') return exports.escapeLast(input, char, idx - 1);\n  return `${input.slice(0, idx)}\\\\${input.slice(idx)}`;\n};\n\nexports.removePrefix = (input, state = {}) => {\n  let output = input;\n  if (output.startsWith('./')) {\n    output = output.slice(2);\n    state.prefix = './';\n  }\n  return output;\n};\n\nexports.wrapOutput = (input, state = {}, options = {}) => {\n  const prepend = options.contains ? '' : '^';\n  const append = options.contains ? '' : '$';\n\n  let output = `${prepend}(?:${input})${append}`;\n  if (state.negated === true) {\n    output = `(?:^(?!${output}).*$)`;\n  }\n  return output;\n};\n", "'use strict';\n\nconst utils = require('./utils');\nconst {\n  CHAR_ASTERISK,             /* * */\n  CHAR_AT,                   /* @ */\n  CHAR_BACKWARD_SLASH,       /* \\ */\n  CHAR_COMMA,                /* , */\n  CHAR_DOT,                  /* . */\n  CHAR_EXCLAMATION_MARK,     /* ! */\n  CHAR_FORWARD_SLASH,        /* / */\n  CHAR_LEFT_CURLY_BRACE,     /* { */\n  CHAR_LEFT_PARENTHESES,     /* ( */\n  CHAR_LEFT_SQUARE_BRACKET,  /* [ */\n  CHAR_PLUS,                 /* + */\n  CHAR_QUESTION_MARK,        /* ? */\n  CHAR_RIGHT_CURLY_BRACE,    /* } */\n  CHAR_RIGHT_PARENTHESES,    /* ) */\n  CHAR_RIGHT_SQUARE_BRACKET  /* ] */\n} = require('./constants');\n\nconst isPathSeparator = code => {\n  return code === CHAR_FORWARD_SLASH || code === CHAR_BACKWARD_SLASH;\n};\n\nconst depth = token => {\n  if (token.isPrefix !== true) {\n    token.depth = token.isGlobstar ? Infinity : 1;\n  }\n};\n\n/**\n * Quickly scans a glob pattern and returns an object with a handful of\n * useful properties, like `isGlob`, `path` (the leading non-glob, if it exists),\n * `glob` (the actual pattern), `negated` (true if the path starts with `!` but not\n * with `!(`) and `negatedExtglob` (true if the path starts with `!(`).\n *\n * ```js\n * const pm = require('picomatch');\n * console.log(pm.scan('foo/bar/*.js'));\n * { isGlob: true, input: 'foo/bar/*.js', base: 'foo/bar', glob: '*.js' }\n * ```\n * @param {String} `str`\n * @param {Object} `options`\n * @return {Object} Returns an object with tokens and regex source string.\n * @api public\n */\n\nconst scan = (input, options) => {\n  const opts = options || {};\n\n  const length = input.length - 1;\n  const scanToEnd = opts.parts === true || opts.scanToEnd === true;\n  const slashes = [];\n  const tokens = [];\n  const parts = [];\n\n  let str = input;\n  let index = -1;\n  let start = 0;\n  let lastIndex = 0;\n  let isBrace = false;\n  let isBracket = false;\n  let isGlob = false;\n  let isExtglob = false;\n  let isGlobstar = false;\n  let braceEscaped = false;\n  let backslashes = false;\n  let negated = false;\n  let negatedExtglob = false;\n  let finished = false;\n  let braces = 0;\n  let prev;\n  let code;\n  let token = { value: '', depth: 0, isGlob: false };\n\n  const eos = () => index >= length;\n  const peek = () => str.charCodeAt(index + 1);\n  const advance = () => {\n    prev = code;\n    return str.charCodeAt(++index);\n  };\n\n  while (index < length) {\n    code = advance();\n    let next;\n\n    if (code === CHAR_BACKWARD_SLASH) {\n      backslashes = token.backslashes = true;\n      code = advance();\n\n      if (code === CHAR_LEFT_CURLY_BRACE) {\n        braceEscaped = true;\n      }\n      continue;\n    }\n\n    if (braceEscaped === true || code === CHAR_LEFT_CURLY_BRACE) {\n      braces++;\n\n      while (eos() !== true && (code = advance())) {\n        if (code === CHAR_BACKWARD_SLASH) {\n          backslashes = token.backslashes = true;\n          advance();\n          continue;\n        }\n\n        if (code === CHAR_LEFT_CURLY_BRACE) {\n          braces++;\n          continue;\n        }\n\n        if (braceEscaped !== true && code === CHAR_DOT && (code = advance()) === CHAR_DOT) {\n          isBrace = token.isBrace = true;\n          isGlob = token.isGlob = true;\n          finished = true;\n\n          if (scanToEnd === true) {\n            continue;\n          }\n\n          break;\n        }\n\n        if (braceEscaped !== true && code === CHAR_COMMA) {\n          isBrace = token.isBrace = true;\n          isGlob = token.isGlob = true;\n          finished = true;\n\n          if (scanToEnd === true) {\n            continue;\n          }\n\n          break;\n        }\n\n        if (code === CHAR_RIGHT_CURLY_BRACE) {\n          braces--;\n\n          if (braces === 0) {\n            braceEscaped = false;\n            isBrace = token.isBrace = true;\n            finished = true;\n            break;\n          }\n        }\n      }\n\n      if (scanToEnd === true) {\n        continue;\n      }\n\n      break;\n    }\n\n    if (code === CHAR_FORWARD_SLASH) {\n      slashes.push(index);\n      tokens.push(token);\n      token = { value: '', depth: 0, isGlob: false };\n\n      if (finished === true) continue;\n      if (prev === CHAR_DOT && index === (start + 1)) {\n        start += 2;\n        continue;\n      }\n\n      lastIndex = index + 1;\n      continue;\n    }\n\n    if (opts.noext !== true) {\n      const isExtglobChar = code === CHAR_PLUS\n        || code === CHAR_AT\n        || code === CHAR_ASTERISK\n        || code === CHAR_QUESTION_MARK\n        || code === CHAR_EXCLAMATION_MARK;\n\n      if (isExtglobChar === true && peek() === CHAR_LEFT_PARENTHESES) {\n        isGlob = token.isGlob = true;\n        isExtglob = token.isExtglob = true;\n        finished = true;\n        if (code === CHAR_EXCLAMATION_MARK && index === start) {\n          negatedExtglob = true;\n        }\n\n        if (scanToEnd === true) {\n          while (eos() !== true && (code = advance())) {\n            if (code === CHAR_BACKWARD_SLASH) {\n              backslashes = token.backslashes = true;\n              code = advance();\n              continue;\n            }\n\n            if (code === CHAR_RIGHT_PARENTHESES) {\n              isGlob = token.isGlob = true;\n              finished = true;\n              break;\n            }\n          }\n          continue;\n        }\n        break;\n      }\n    }\n\n    if (code === CHAR_ASTERISK) {\n      if (prev === CHAR_ASTERISK) isGlobstar = token.isGlobstar = true;\n      isGlob = token.isGlob = true;\n      finished = true;\n\n      if (scanToEnd === true) {\n        continue;\n      }\n      break;\n    }\n\n    if (code === CHAR_QUESTION_MARK) {\n      isGlob = token.isGlob = true;\n      finished = true;\n\n      if (scanToEnd === true) {\n        continue;\n      }\n      break;\n    }\n\n    if (code === CHAR_LEFT_SQUARE_BRACKET) {\n      while (eos() !== true && (next = advance())) {\n        if (next === CHAR_BACKWARD_SLASH) {\n          backslashes = token.backslashes = true;\n          advance();\n          continue;\n        }\n\n        if (next === CHAR_RIGHT_SQUARE_BRACKET) {\n          isBracket = token.isBracket = true;\n          isGlob = token.isGlob = true;\n          finished = true;\n          break;\n        }\n      }\n\n      if (scanToEnd === true) {\n        continue;\n      }\n\n      break;\n    }\n\n    if (opts.nonegate !== true && code === CHAR_EXCLAMATION_MARK && index === start) {\n      negated = token.negated = true;\n      start++;\n      continue;\n    }\n\n    if (opts.noparen !== true && code === CHAR_LEFT_PARENTHESES) {\n      isGlob = token.isGlob = true;\n\n      if (scanToEnd === true) {\n        while (eos() !== true && (code = advance())) {\n          if (code === CHAR_LEFT_PARENTHESES) {\n            backslashes = token.backslashes = true;\n            code = advance();\n            continue;\n          }\n\n          if (code === CHAR_RIGHT_PARENTHESES) {\n            finished = true;\n            break;\n          }\n        }\n        continue;\n      }\n      break;\n    }\n\n    if (isGlob === true) {\n      finished = true;\n\n      if (scanToEnd === true) {\n        continue;\n      }\n\n      break;\n    }\n  }\n\n  if (opts.noext === true) {\n    isExtglob = false;\n    isGlob = false;\n  }\n\n  let base = str;\n  let prefix = '';\n  let glob = '';\n\n  if (start > 0) {\n    prefix = str.slice(0, start);\n    str = str.slice(start);\n    lastIndex -= start;\n  }\n\n  if (base && isGlob === true && lastIndex > 0) {\n    base = str.slice(0, lastIndex);\n    glob = str.slice(lastIndex);\n  } else if (isGlob === true) {\n    base = '';\n    glob = str;\n  } else {\n    base = str;\n  }\n\n  if (base && base !== '' && base !== '/' && base !== str) {\n    if (isPathSeparator(base.charCodeAt(base.length - 1))) {\n      base = base.slice(0, -1);\n    }\n  }\n\n  if (opts.unescape === true) {\n    if (glob) glob = utils.removeBackslashes(glob);\n\n    if (base && backslashes === true) {\n      base = utils.removeBackslashes(base);\n    }\n  }\n\n  const state = {\n    prefix,\n    input,\n    start,\n    base,\n    glob,\n    isBrace,\n    isBracket,\n    isGlob,\n    isExtglob,\n    isGlobstar,\n    negated,\n    negatedExtglob\n  };\n\n  if (opts.tokens === true) {\n    state.maxDepth = 0;\n    if (!isPathSeparator(code)) {\n      tokens.push(token);\n    }\n    state.tokens = tokens;\n  }\n\n  if (opts.parts === true || opts.tokens === true) {\n    let prevIndex;\n\n    for (let idx = 0; idx < slashes.length; idx++) {\n      const n = prevIndex ? prevIndex + 1 : start;\n      const i = slashes[idx];\n      const value = input.slice(n, i);\n      if (opts.tokens) {\n        if (idx === 0 && start !== 0) {\n          tokens[idx].isPrefix = true;\n          tokens[idx].value = prefix;\n        } else {\n          tokens[idx].value = value;\n        }\n        depth(tokens[idx]);\n        state.maxDepth += tokens[idx].depth;\n      }\n      if (idx !== 0 || value !== '') {\n        parts.push(value);\n      }\n      prevIndex = i;\n    }\n\n    if (prevIndex && prevIndex + 1 < input.length) {\n      const value = input.slice(prevIndex + 1);\n      parts.push(value);\n\n      if (opts.tokens) {\n        tokens[tokens.length - 1].value = value;\n        depth(tokens[tokens.length - 1]);\n        state.maxDepth += tokens[tokens.length - 1].depth;\n      }\n    }\n\n    state.slashes = slashes;\n    state.parts = parts;\n  }\n\n  return state;\n};\n\nmodule.exports = scan;\n", "'use strict';\n\nconst constants = require('./constants');\nconst utils = require('./utils');\n\n/**\n * Constants\n */\n\nconst {\n  MAX_LENGTH,\n  POSIX_REGEX_SOURCE,\n  REGEX_NON_SPECIAL_CHARS,\n  REGEX_SPECIAL_CHARS_BACKREF,\n  REPLACEMENTS\n} = constants;\n\n/**\n * Helpers\n */\n\nconst expandRange = (args, options) => {\n  if (typeof options.expandRange === 'function') {\n    return options.expandRange(...args, options);\n  }\n\n  args.sort();\n  const value = `[${args.join('-')}]`;\n\n  try {\n    /* eslint-disable-next-line no-new */\n    new RegExp(value);\n  } catch (ex) {\n    return args.map(v => utils.escapeRegex(v)).join('..');\n  }\n\n  return value;\n};\n\n/**\n * Create the message for a syntax error\n */\n\nconst syntaxError = (type, char) => {\n  return `Missing ${type}: \"${char}\" - use \"\\\\\\\\${char}\" to match literal characters`;\n};\n\n/**\n * Parse the given input string.\n * @param {String} input\n * @param {Object} options\n * @return {Object}\n */\n\nconst parse = (input, options) => {\n  if (typeof input !== 'string') {\n    throw new TypeError('Expected a string');\n  }\n\n  input = REPLACEMENTS[input] || input;\n\n  const opts = { ...options };\n  const max = typeof opts.maxLength === 'number' ? Math.min(MAX_LENGTH, opts.maxLength) : MAX_LENGTH;\n\n  let len = input.length;\n  if (len > max) {\n    throw new SyntaxError(`Input length: ${len}, exceeds maximum allowed length: ${max}`);\n  }\n\n  const bos = { type: 'bos', value: '', output: opts.prepend || '' };\n  const tokens = [bos];\n\n  const capture = opts.capture ? '' : '?:';\n  const win32 = utils.isWindows(options);\n\n  // create constants based on platform, for windows or posix\n  const PLATFORM_CHARS = constants.globChars(win32);\n  const EXTGLOB_CHARS = constants.extglobChars(PLATFORM_CHARS);\n\n  const {\n    DOT_LITERAL,\n    PLUS_LITERAL,\n    SLASH_LITERAL,\n    ONE_CHAR,\n    DOTS_SLASH,\n    NO_DOT,\n    NO_DOT_SLASH,\n    NO_DOTS_SLASH,\n    QMARK,\n    QMARK_NO_DOT,\n    STAR,\n    START_ANCHOR\n  } = PLATFORM_CHARS;\n\n  const globstar = opts => {\n    return `(${capture}(?:(?!${START_ANCHOR}${opts.dot ? DOTS_SLASH : DOT_LITERAL}).)*?)`;\n  };\n\n  const nodot = opts.dot ? '' : NO_DOT;\n  const qmarkNoDot = opts.dot ? QMARK : QMARK_NO_DOT;\n  let star = opts.bash === true ? globstar(opts) : STAR;\n\n  if (opts.capture) {\n    star = `(${star})`;\n  }\n\n  // minimatch options support\n  if (typeof opts.noext === 'boolean') {\n    opts.noextglob = opts.noext;\n  }\n\n  const state = {\n    input,\n    index: -1,\n    start: 0,\n    dot: opts.dot === true,\n    consumed: '',\n    output: '',\n    prefix: '',\n    backtrack: false,\n    negated: false,\n    brackets: 0,\n    braces: 0,\n    parens: 0,\n    quotes: 0,\n    globstar: false,\n    tokens\n  };\n\n  input = utils.removePrefix(input, state);\n  len = input.length;\n\n  const extglobs = [];\n  const braces = [];\n  const stack = [];\n  let prev = bos;\n  let value;\n\n  /**\n   * Tokenizing helpers\n   */\n\n  const eos = () => state.index === len - 1;\n  const peek = state.peek = (n = 1) => input[state.index + n];\n  const advance = state.advance = () => input[++state.index] || '';\n  const remaining = () => input.slice(state.index + 1);\n  const consume = (value = '', num = 0) => {\n    state.consumed += value;\n    state.index += num;\n  };\n\n  const append = token => {\n    state.output += token.output != null ? token.output : token.value;\n    consume(token.value);\n  };\n\n  const negate = () => {\n    let count = 1;\n\n    while (peek() === '!' && (peek(2) !== '(' || peek(3) === '?')) {\n      advance();\n      state.start++;\n      count++;\n    }\n\n    if (count % 2 === 0) {\n      return false;\n    }\n\n    state.negated = true;\n    state.start++;\n    return true;\n  };\n\n  const increment = type => {\n    state[type]++;\n    stack.push(type);\n  };\n\n  const decrement = type => {\n    state[type]--;\n    stack.pop();\n  };\n\n  /**\n   * Push tokens onto the tokens array. This helper speeds up\n   * tokenizing by 1) helping us avoid backtracking as much as possible,\n   * and 2) helping us avoid creating extra tokens when consecutive\n   * characters are plain text. This improves performance and simplifies\n   * lookbehinds.\n   */\n\n  const push = tok => {\n    if (prev.type === 'globstar') {\n      const isBrace = state.braces > 0 && (tok.type === 'comma' || tok.type === 'brace');\n      const isExtglob = tok.extglob === true || (extglobs.length && (tok.type === 'pipe' || tok.type === 'paren'));\n\n      if (tok.type !== 'slash' && tok.type !== 'paren' && !isBrace && !isExtglob) {\n        state.output = state.output.slice(0, -prev.output.length);\n        prev.type = 'star';\n        prev.value = '*';\n        prev.output = star;\n        state.output += prev.output;\n      }\n    }\n\n    if (extglobs.length && tok.type !== 'paren') {\n      extglobs[extglobs.length - 1].inner += tok.value;\n    }\n\n    if (tok.value || tok.output) append(tok);\n    if (prev && prev.type === 'text' && tok.type === 'text') {\n      prev.value += tok.value;\n      prev.output = (prev.output || '') + tok.value;\n      return;\n    }\n\n    tok.prev = prev;\n    tokens.push(tok);\n    prev = tok;\n  };\n\n  const extglobOpen = (type, value) => {\n    const token = { ...EXTGLOB_CHARS[value], conditions: 1, inner: '' };\n\n    token.prev = prev;\n    token.parens = state.parens;\n    token.output = state.output;\n    const output = (opts.capture ? '(' : '') + token.open;\n\n    increment('parens');\n    push({ type, value, output: state.output ? '' : ONE_CHAR });\n    push({ type: 'paren', extglob: true, value: advance(), output });\n    extglobs.push(token);\n  };\n\n  const extglobClose = token => {\n    let output = token.close + (opts.capture ? ')' : '');\n    let rest;\n\n    if (token.type === 'negate') {\n      let extglobStar = star;\n\n      if (token.inner && token.inner.length > 1 && token.inner.includes('/')) {\n        extglobStar = globstar(opts);\n      }\n\n      if (extglobStar !== star || eos() || /^\\)+$/.test(remaining())) {\n        output = token.close = `)$))${extglobStar}`;\n      }\n\n      if (token.inner.includes('*') && (rest = remaining()) && /^\\.[^\\\\/.]+$/.test(rest)) {\n        // Any non-magical string (`.ts`) or even nested expression (`.{ts,tsx}`) can follow after the closing parenthesis.\n        // In this case, we need to parse the string and use it in the output of the original pattern.\n        // Suitable patterns: `/!(*.d).ts`, `/!(*.d).{ts,tsx}`, `**/!(*-dbg).@(js)`.\n        //\n        // Disabling the `fastpaths` option due to a problem with parsing strings as `.ts` in the pattern like `**/!(*.d).ts`.\n        const expression = parse(rest, { ...options, fastpaths: false }).output;\n\n        output = token.close = `)${expression})${extglobStar})`;\n      }\n\n      if (token.prev.type === 'bos') {\n        state.negatedExtglob = true;\n      }\n    }\n\n    push({ type: 'paren', extglob: true, value, output });\n    decrement('parens');\n  };\n\n  /**\n   * Fast paths\n   */\n\n  if (opts.fastpaths !== false && !/(^[*!]|[/()[\\]{}\"])/.test(input)) {\n    let backslashes = false;\n\n    let output = input.replace(REGEX_SPECIAL_CHARS_BACKREF, (m, esc, chars, first, rest, index) => {\n      if (first === '\\\\') {\n        backslashes = true;\n        return m;\n      }\n\n      if (first === '?') {\n        if (esc) {\n          return esc + first + (rest ? QMARK.repeat(rest.length) : '');\n        }\n        if (index === 0) {\n          return qmarkNoDot + (rest ? QMARK.repeat(rest.length) : '');\n        }\n        return QMARK.repeat(chars.length);\n      }\n\n      if (first === '.') {\n        return DOT_LITERAL.repeat(chars.length);\n      }\n\n      if (first === '*') {\n        if (esc) {\n          return esc + first + (rest ? star : '');\n        }\n        return star;\n      }\n      return esc ? m : `\\\\${m}`;\n    });\n\n    if (backslashes === true) {\n      if (opts.unescape === true) {\n        output = output.replace(/\\\\/g, '');\n      } else {\n        output = output.replace(/\\\\+/g, m => {\n          return m.length % 2 === 0 ? '\\\\\\\\' : (m ? '\\\\' : '');\n        });\n      }\n    }\n\n    if (output === input && opts.contains === true) {\n      state.output = input;\n      return state;\n    }\n\n    state.output = utils.wrapOutput(output, state, options);\n    return state;\n  }\n\n  /**\n   * Tokenize input until we reach end-of-string\n   */\n\n  while (!eos()) {\n    value = advance();\n\n    if (value === '\\u0000') {\n      continue;\n    }\n\n    /**\n     * Escaped characters\n     */\n\n    if (value === '\\\\') {\n      const next = peek();\n\n      if (next === '/' && opts.bash !== true) {\n        continue;\n      }\n\n      if (next === '.' || next === ';') {\n        continue;\n      }\n\n      if (!next) {\n        value += '\\\\';\n        push({ type: 'text', value });\n        continue;\n      }\n\n      // collapse slashes to reduce potential for exploits\n      const match = /^\\\\+/.exec(remaining());\n      let slashes = 0;\n\n      if (match && match[0].length > 2) {\n        slashes = match[0].length;\n        state.index += slashes;\n        if (slashes % 2 !== 0) {\n          value += '\\\\';\n        }\n      }\n\n      if (opts.unescape === true) {\n        value = advance();\n      } else {\n        value += advance();\n      }\n\n      if (state.brackets === 0) {\n        push({ type: 'text', value });\n        continue;\n      }\n    }\n\n    /**\n     * If we're inside a regex character class, continue\n     * until we reach the closing bracket.\n     */\n\n    if (state.brackets > 0 && (value !== ']' || prev.value === '[' || prev.value === '[^')) {\n      if (opts.posix !== false && value === ':') {\n        const inner = prev.value.slice(1);\n        if (inner.includes('[')) {\n          prev.posix = true;\n\n          if (inner.includes(':')) {\n            const idx = prev.value.lastIndexOf('[');\n            const pre = prev.value.slice(0, idx);\n            const rest = prev.value.slice(idx + 2);\n            const posix = POSIX_REGEX_SOURCE[rest];\n            if (posix) {\n              prev.value = pre + posix;\n              state.backtrack = true;\n              advance();\n\n              if (!bos.output && tokens.indexOf(prev) === 1) {\n                bos.output = ONE_CHAR;\n              }\n              continue;\n            }\n          }\n        }\n      }\n\n      if ((value === '[' && peek() !== ':') || (value === '-' && peek() === ']')) {\n        value = `\\\\${value}`;\n      }\n\n      if (value === ']' && (prev.value === '[' || prev.value === '[^')) {\n        value = `\\\\${value}`;\n      }\n\n      if (opts.posix === true && value === '!' && prev.value === '[') {\n        value = '^';\n      }\n\n      prev.value += value;\n      append({ value });\n      continue;\n    }\n\n    /**\n     * If we're inside a quoted string, continue\n     * until we reach the closing double quote.\n     */\n\n    if (state.quotes === 1 && value !== '\"') {\n      value = utils.escapeRegex(value);\n      prev.value += value;\n      append({ value });\n      continue;\n    }\n\n    /**\n     * Double quotes\n     */\n\n    if (value === '\"') {\n      state.quotes = state.quotes === 1 ? 0 : 1;\n      if (opts.keepQuotes === true) {\n        push({ type: 'text', value });\n      }\n      continue;\n    }\n\n    /**\n     * Parentheses\n     */\n\n    if (value === '(') {\n      increment('parens');\n      push({ type: 'paren', value });\n      continue;\n    }\n\n    if (value === ')') {\n      if (state.parens === 0 && opts.strictBrackets === true) {\n        throw new SyntaxError(syntaxError('opening', '('));\n      }\n\n      const extglob = extglobs[extglobs.length - 1];\n      if (extglob && state.parens === extglob.parens + 1) {\n        extglobClose(extglobs.pop());\n        continue;\n      }\n\n      push({ type: 'paren', value, output: state.parens ? ')' : '\\\\)' });\n      decrement('parens');\n      continue;\n    }\n\n    /**\n     * Square brackets\n     */\n\n    if (value === '[') {\n      if (opts.nobracket === true || !remaining().includes(']')) {\n        if (opts.nobracket !== true && opts.strictBrackets === true) {\n          throw new SyntaxError(syntaxError('closing', ']'));\n        }\n\n        value = `\\\\${value}`;\n      } else {\n        increment('brackets');\n      }\n\n      push({ type: 'bracket', value });\n      continue;\n    }\n\n    if (value === ']') {\n      if (opts.nobracket === true || (prev && prev.type === 'bracket' && prev.value.length === 1)) {\n        push({ type: 'text', value, output: `\\\\${value}` });\n        continue;\n      }\n\n      if (state.brackets === 0) {\n        if (opts.strictBrackets === true) {\n          throw new SyntaxError(syntaxError('opening', '['));\n        }\n\n        push({ type: 'text', value, output: `\\\\${value}` });\n        continue;\n      }\n\n      decrement('brackets');\n\n      const prevValue = prev.value.slice(1);\n      if (prev.posix !== true && prevValue[0] === '^' && !prevValue.includes('/')) {\n        value = `/${value}`;\n      }\n\n      prev.value += value;\n      append({ value });\n\n      // when literal brackets are explicitly disabled\n      // assume we should match with a regex character class\n      if (opts.literalBrackets === false || utils.hasRegexChars(prevValue)) {\n        continue;\n      }\n\n      const escaped = utils.escapeRegex(prev.value);\n      state.output = state.output.slice(0, -prev.value.length);\n\n      // when literal brackets are explicitly enabled\n      // assume we should escape the brackets to match literal characters\n      if (opts.literalBrackets === true) {\n        state.output += escaped;\n        prev.value = escaped;\n        continue;\n      }\n\n      // when the user specifies nothing, try to match both\n      prev.value = `(${capture}${escaped}|${prev.value})`;\n      state.output += prev.value;\n      continue;\n    }\n\n    /**\n     * Braces\n     */\n\n    if (value === '{' && opts.nobrace !== true) {\n      increment('braces');\n\n      const open = {\n        type: 'brace',\n        value,\n        output: '(',\n        outputIndex: state.output.length,\n        tokensIndex: state.tokens.length\n      };\n\n      braces.push(open);\n      push(open);\n      continue;\n    }\n\n    if (value === '}') {\n      const brace = braces[braces.length - 1];\n\n      if (opts.nobrace === true || !brace) {\n        push({ type: 'text', value, output: value });\n        continue;\n      }\n\n      let output = ')';\n\n      if (brace.dots === true) {\n        const arr = tokens.slice();\n        const range = [];\n\n        for (let i = arr.length - 1; i >= 0; i--) {\n          tokens.pop();\n          if (arr[i].type === 'brace') {\n            break;\n          }\n          if (arr[i].type !== 'dots') {\n            range.unshift(arr[i].value);\n          }\n        }\n\n        output = expandRange(range, opts);\n        state.backtrack = true;\n      }\n\n      if (brace.comma !== true && brace.dots !== true) {\n        const out = state.output.slice(0, brace.outputIndex);\n        const toks = state.tokens.slice(brace.tokensIndex);\n        brace.value = brace.output = '\\\\{';\n        value = output = '\\\\}';\n        state.output = out;\n        for (const t of toks) {\n          state.output += (t.output || t.value);\n        }\n      }\n\n      push({ type: 'brace', value, output });\n      decrement('braces');\n      braces.pop();\n      continue;\n    }\n\n    /**\n     * Pipes\n     */\n\n    if (value === '|') {\n      if (extglobs.length > 0) {\n        extglobs[extglobs.length - 1].conditions++;\n      }\n      push({ type: 'text', value });\n      continue;\n    }\n\n    /**\n     * Commas\n     */\n\n    if (value === ',') {\n      let output = value;\n\n      const brace = braces[braces.length - 1];\n      if (brace && stack[stack.length - 1] === 'braces') {\n        brace.comma = true;\n        output = '|';\n      }\n\n      push({ type: 'comma', value, output });\n      continue;\n    }\n\n    /**\n     * Slashes\n     */\n\n    if (value === '/') {\n      // if the beginning of the glob is \"./\", advance the start\n      // to the current index, and don't add the \"./\" characters\n      // to the state. This greatly simplifies lookbehinds when\n      // checking for BOS characters like \"!\" and \".\" (not \"./\")\n      if (prev.type === 'dot' && state.index === state.start + 1) {\n        state.start = state.index + 1;\n        state.consumed = '';\n        state.output = '';\n        tokens.pop();\n        prev = bos; // reset \"prev\" to the first token\n        continue;\n      }\n\n      push({ type: 'slash', value, output: SLASH_LITERAL });\n      continue;\n    }\n\n    /**\n     * Dots\n     */\n\n    if (value === '.') {\n      if (state.braces > 0 && prev.type === 'dot') {\n        if (prev.value === '.') prev.output = DOT_LITERAL;\n        const brace = braces[braces.length - 1];\n        prev.type = 'dots';\n        prev.output += value;\n        prev.value += value;\n        brace.dots = true;\n        continue;\n      }\n\n      if ((state.braces + state.parens) === 0 && prev.type !== 'bos' && prev.type !== 'slash') {\n        push({ type: 'text', value, output: DOT_LITERAL });\n        continue;\n      }\n\n      push({ type: 'dot', value, output: DOT_LITERAL });\n      continue;\n    }\n\n    /**\n     * Question marks\n     */\n\n    if (value === '?') {\n      const isGroup = prev && prev.value === '(';\n      if (!isGroup && opts.noextglob !== true && peek() === '(' && peek(2) !== '?') {\n        extglobOpen('qmark', value);\n        continue;\n      }\n\n      if (prev && prev.type === 'paren') {\n        const next = peek();\n        let output = value;\n\n        if (next === '<' && !utils.supportsLookbehinds()) {\n          throw new Error('Node.js v10 or higher is required for regex lookbehinds');\n        }\n\n        if ((prev.value === '(' && !/[!=<:]/.test(next)) || (next === '<' && !/<([!=]|\\w+>)/.test(remaining()))) {\n          output = `\\\\${value}`;\n        }\n\n        push({ type: 'text', value, output });\n        continue;\n      }\n\n      if (opts.dot !== true && (prev.type === 'slash' || prev.type === 'bos')) {\n        push({ type: 'qmark', value, output: QMARK_NO_DOT });\n        continue;\n      }\n\n      push({ type: 'qmark', value, output: QMARK });\n      continue;\n    }\n\n    /**\n     * Exclamation\n     */\n\n    if (value === '!') {\n      if (opts.noextglob !== true && peek() === '(') {\n        if (peek(2) !== '?' || !/[!=<:]/.test(peek(3))) {\n          extglobOpen('negate', value);\n          continue;\n        }\n      }\n\n      if (opts.nonegate !== true && state.index === 0) {\n        negate();\n        continue;\n      }\n    }\n\n    /**\n     * Plus\n     */\n\n    if (value === '+') {\n      if (opts.noextglob !== true && peek() === '(' && peek(2) !== '?') {\n        extglobOpen('plus', value);\n        continue;\n      }\n\n      if ((prev && prev.value === '(') || opts.regex === false) {\n        push({ type: 'plus', value, output: PLUS_LITERAL });\n        continue;\n      }\n\n      if ((prev && (prev.type === 'bracket' || prev.type === 'paren' || prev.type === 'brace')) || state.parens > 0) {\n        push({ type: 'plus', value });\n        continue;\n      }\n\n      push({ type: 'plus', value: PLUS_LITERAL });\n      continue;\n    }\n\n    /**\n     * Plain text\n     */\n\n    if (value === '@') {\n      if (opts.noextglob !== true && peek() === '(' && peek(2) !== '?') {\n        push({ type: 'at', extglob: true, value, output: '' });\n        continue;\n      }\n\n      push({ type: 'text', value });\n      continue;\n    }\n\n    /**\n     * Plain text\n     */\n\n    if (value !== '*') {\n      if (value === '$' || value === '^') {\n        value = `\\\\${value}`;\n      }\n\n      const match = REGEX_NON_SPECIAL_CHARS.exec(remaining());\n      if (match) {\n        value += match[0];\n        state.index += match[0].length;\n      }\n\n      push({ type: 'text', value });\n      continue;\n    }\n\n    /**\n     * Stars\n     */\n\n    if (prev && (prev.type === 'globstar' || prev.star === true)) {\n      prev.type = 'star';\n      prev.star = true;\n      prev.value += value;\n      prev.output = star;\n      state.backtrack = true;\n      state.globstar = true;\n      consume(value);\n      continue;\n    }\n\n    let rest = remaining();\n    if (opts.noextglob !== true && /^\\([^?]/.test(rest)) {\n      extglobOpen('star', value);\n      continue;\n    }\n\n    if (prev.type === 'star') {\n      if (opts.noglobstar === true) {\n        consume(value);\n        continue;\n      }\n\n      const prior = prev.prev;\n      const before = prior.prev;\n      const isStart = prior.type === 'slash' || prior.type === 'bos';\n      const afterStar = before && (before.type === 'star' || before.type === 'globstar');\n\n      if (opts.bash === true && (!isStart || (rest[0] && rest[0] !== '/'))) {\n        push({ type: 'star', value, output: '' });\n        continue;\n      }\n\n      const isBrace = state.braces > 0 && (prior.type === 'comma' || prior.type === 'brace');\n      const isExtglob = extglobs.length && (prior.type === 'pipe' || prior.type === 'paren');\n      if (!isStart && prior.type !== 'paren' && !isBrace && !isExtglob) {\n        push({ type: 'star', value, output: '' });\n        continue;\n      }\n\n      // strip consecutive `/**/`\n      while (rest.slice(0, 3) === '/**') {\n        const after = input[state.index + 4];\n        if (after && after !== '/') {\n          break;\n        }\n        rest = rest.slice(3);\n        consume('/**', 3);\n      }\n\n      if (prior.type === 'bos' && eos()) {\n        prev.type = 'globstar';\n        prev.value += value;\n        prev.output = globstar(opts);\n        state.output = prev.output;\n        state.globstar = true;\n        consume(value);\n        continue;\n      }\n\n      if (prior.type === 'slash' && prior.prev.type !== 'bos' && !afterStar && eos()) {\n        state.output = state.output.slice(0, -(prior.output + prev.output).length);\n        prior.output = `(?:${prior.output}`;\n\n        prev.type = 'globstar';\n        prev.output = globstar(opts) + (opts.strictSlashes ? ')' : '|$)');\n        prev.value += value;\n        state.globstar = true;\n        state.output += prior.output + prev.output;\n        consume(value);\n        continue;\n      }\n\n      if (prior.type === 'slash' && prior.prev.type !== 'bos' && rest[0] === '/') {\n        const end = rest[1] !== void 0 ? '|$' : '';\n\n        state.output = state.output.slice(0, -(prior.output + prev.output).length);\n        prior.output = `(?:${prior.output}`;\n\n        prev.type = 'globstar';\n        prev.output = `${globstar(opts)}${SLASH_LITERAL}|${SLASH_LITERAL}${end})`;\n        prev.value += value;\n\n        state.output += prior.output + prev.output;\n        state.globstar = true;\n\n        consume(value + advance());\n\n        push({ type: 'slash', value: '/', output: '' });\n        continue;\n      }\n\n      if (prior.type === 'bos' && rest[0] === '/') {\n        prev.type = 'globstar';\n        prev.value += value;\n        prev.output = `(?:^|${SLASH_LITERAL}|${globstar(opts)}${SLASH_LITERAL})`;\n        state.output = prev.output;\n        state.globstar = true;\n        consume(value + advance());\n        push({ type: 'slash', value: '/', output: '' });\n        continue;\n      }\n\n      // remove single star from output\n      state.output = state.output.slice(0, -prev.output.length);\n\n      // reset previous token to globstar\n      prev.type = 'globstar';\n      prev.output = globstar(opts);\n      prev.value += value;\n\n      // reset output with globstar\n      state.output += prev.output;\n      state.globstar = true;\n      consume(value);\n      continue;\n    }\n\n    const token = { type: 'star', value, output: star };\n\n    if (opts.bash === true) {\n      token.output = '.*?';\n      if (prev.type === 'bos' || prev.type === 'slash') {\n        token.output = nodot + token.output;\n      }\n      push(token);\n      continue;\n    }\n\n    if (prev && (prev.type === 'bracket' || prev.type === 'paren') && opts.regex === true) {\n      token.output = value;\n      push(token);\n      continue;\n    }\n\n    if (state.index === state.start || prev.type === 'slash' || prev.type === 'dot') {\n      if (prev.type === 'dot') {\n        state.output += NO_DOT_SLASH;\n        prev.output += NO_DOT_SLASH;\n\n      } else if (opts.dot === true) {\n        state.output += NO_DOTS_SLASH;\n        prev.output += NO_DOTS_SLASH;\n\n      } else {\n        state.output += nodot;\n        prev.output += nodot;\n      }\n\n      if (peek() !== '*') {\n        state.output += ONE_CHAR;\n        prev.output += ONE_CHAR;\n      }\n    }\n\n    push(token);\n  }\n\n  while (state.brackets > 0) {\n    if (opts.strictBrackets === true) throw new SyntaxError(syntaxError('closing', ']'));\n    state.output = utils.escapeLast(state.output, '[');\n    decrement('brackets');\n  }\n\n  while (state.parens > 0) {\n    if (opts.strictBrackets === true) throw new SyntaxError(syntaxError('closing', ')'));\n    state.output = utils.escapeLast(state.output, '(');\n    decrement('parens');\n  }\n\n  while (state.braces > 0) {\n    if (opts.strictBrackets === true) throw new SyntaxError(syntaxError('closing', '}'));\n    state.output = utils.escapeLast(state.output, '{');\n    decrement('braces');\n  }\n\n  if (opts.strictSlashes !== true && (prev.type === 'star' || prev.type === 'bracket')) {\n    push({ type: 'maybe_slash', value: '', output: `${SLASH_LITERAL}?` });\n  }\n\n  // rebuild the output if we had to backtrack at any point\n  if (state.backtrack === true) {\n    state.output = '';\n\n    for (const token of state.tokens) {\n      state.output += token.output != null ? token.output : token.value;\n\n      if (token.suffix) {\n        state.output += token.suffix;\n      }\n    }\n  }\n\n  return state;\n};\n\n/**\n * Fast paths for creating regular expressions for common glob patterns.\n * This can significantly speed up processing and has very little downside\n * impact when none of the fast paths match.\n */\n\nparse.fastpaths = (input, options) => {\n  const opts = { ...options };\n  const max = typeof opts.maxLength === 'number' ? Math.min(MAX_LENGTH, opts.maxLength) : MAX_LENGTH;\n  const len = input.length;\n  if (len > max) {\n    throw new SyntaxError(`Input length: ${len}, exceeds maximum allowed length: ${max}`);\n  }\n\n  input = REPLACEMENTS[input] || input;\n  const win32 = utils.isWindows(options);\n\n  // create constants based on platform, for windows or posix\n  const {\n    DOT_LITERAL,\n    SLASH_LITERAL,\n    ONE_CHAR,\n    DOTS_SLASH,\n    NO_DOT,\n    NO_DOTS,\n    NO_DOTS_SLASH,\n    STAR,\n    START_ANCHOR\n  } = constants.globChars(win32);\n\n  const nodot = opts.dot ? NO_DOTS : NO_DOT;\n  const slashDot = opts.dot ? NO_DOTS_SLASH : NO_DOT;\n  const capture = opts.capture ? '' : '?:';\n  const state = { negated: false, prefix: '' };\n  let star = opts.bash === true ? '.*?' : STAR;\n\n  if (opts.capture) {\n    star = `(${star})`;\n  }\n\n  const globstar = opts => {\n    if (opts.noglobstar === true) return star;\n    return `(${capture}(?:(?!${START_ANCHOR}${opts.dot ? DOTS_SLASH : DOT_LITERAL}).)*?)`;\n  };\n\n  const create = str => {\n    switch (str) {\n      case '*':\n        return `${nodot}${ONE_CHAR}${star}`;\n\n      case '.*':\n        return `${DOT_LITERAL}${ONE_CHAR}${star}`;\n\n      case '*.*':\n        return `${nodot}${star}${DOT_LITERAL}${ONE_CHAR}${star}`;\n\n      case '*/*':\n        return `${nodot}${star}${SLASH_LITERAL}${ONE_CHAR}${slashDot}${star}`;\n\n      case '**':\n        return nodot + globstar(opts);\n\n      case '**/*':\n        return `(?:${nodot}${globstar(opts)}${SLASH_LITERAL})?${slashDot}${ONE_CHAR}${star}`;\n\n      case '**/*.*':\n        return `(?:${nodot}${globstar(opts)}${SLASH_LITERAL})?${slashDot}${star}${DOT_LITERAL}${ONE_CHAR}${star}`;\n\n      case '**/.*':\n        return `(?:${nodot}${globstar(opts)}${SLASH_LITERAL})?${DOT_LITERAL}${ONE_CHAR}${star}`;\n\n      default: {\n        const match = /^(.*?)\\.(\\w+)$/.exec(str);\n        if (!match) return;\n\n        const source = create(match[1]);\n        if (!source) return;\n\n        return source + DOT_LITERAL + match[2];\n      }\n    }\n  };\n\n  const output = utils.removePrefix(input, state);\n  let source = create(output);\n\n  if (source && opts.strictSlashes !== true) {\n    source += `${SLASH_LITERAL}?`;\n  }\n\n  return source;\n};\n\nmodule.exports = parse;\n", "'use strict';\n\nconst path = require('path');\nconst scan = require('./scan');\nconst parse = require('./parse');\nconst utils = require('./utils');\nconst constants = require('./constants');\nconst isObject = val => val && typeof val === 'object' && !Array.isArray(val);\n\n/**\n * Creates a matcher function from one or more glob patterns. The\n * returned function takes a string to match as its first argument,\n * and returns true if the string is a match. The returned matcher\n * function also takes a boolean as the second argument that, when true,\n * returns an object with additional information.\n *\n * ```js\n * const picomatch = require('picomatch');\n * // picomatch(glob[, options]);\n *\n * const isMatch = picomatch('*.!(*a)');\n * console.log(isMatch('a.a')); //=> false\n * console.log(isMatch('a.b')); //=> true\n * ```\n * @name picomatch\n * @param {String|Array} `globs` One or more glob patterns.\n * @param {Object=} `options`\n * @return {Function=} Returns a matcher function.\n * @api public\n */\n\nconst picomatch = (glob, options, returnState = false) => {\n  if (Array.isArray(glob)) {\n    const fns = glob.map(input => picomatch(input, options, returnState));\n    const arrayMatcher = str => {\n      for (const isMatch of fns) {\n        const state = isMatch(str);\n        if (state) return state;\n      }\n      return false;\n    };\n    return arrayMatcher;\n  }\n\n  const isState = isObject(glob) && glob.tokens && glob.input;\n\n  if (glob === '' || (typeof glob !== 'string' && !isState)) {\n    throw new TypeError('Expected pattern to be a non-empty string');\n  }\n\n  const opts = options || {};\n  const posix = utils.isWindows(options);\n  const regex = isState\n    ? picomatch.compileRe(glob, options)\n    : picomatch.makeRe(glob, options, false, true);\n\n  const state = regex.state;\n  delete regex.state;\n\n  let isIgnored = () => false;\n  if (opts.ignore) {\n    const ignoreOpts = { ...options, ignore: null, onMatch: null, onResult: null };\n    isIgnored = picomatch(opts.ignore, ignoreOpts, returnState);\n  }\n\n  const matcher = (input, returnObject = false) => {\n    const { isMatch, match, output } = picomatch.test(input, regex, options, { glob, posix });\n    const result = { glob, state, regex, posix, input, output, match, isMatch };\n\n    if (typeof opts.onResult === 'function') {\n      opts.onResult(result);\n    }\n\n    if (isMatch === false) {\n      result.isMatch = false;\n      return returnObject ? result : false;\n    }\n\n    if (isIgnored(input)) {\n      if (typeof opts.onIgnore === 'function') {\n        opts.onIgnore(result);\n      }\n      result.isMatch = false;\n      return returnObject ? result : false;\n    }\n\n    if (typeof opts.onMatch === 'function') {\n      opts.onMatch(result);\n    }\n    return returnObject ? result : true;\n  };\n\n  if (returnState) {\n    matcher.state = state;\n  }\n\n  return matcher;\n};\n\n/**\n * Test `input` with the given `regex`. This is used by the main\n * `picomatch()` function to test the input string.\n *\n * ```js\n * const picomatch = require('picomatch');\n * // picomatch.test(input, regex[, options]);\n *\n * console.log(picomatch.test('foo/bar', /^(?:([^/]*?)\\/([^/]*?))$/));\n * // { isMatch: true, match: [ 'foo/', 'foo', 'bar' ], output: 'foo/bar' }\n * ```\n * @param {String} `input` String to test.\n * @param {RegExp} `regex`\n * @return {Object} Returns an object with matching info.\n * @api public\n */\n\npicomatch.test = (input, regex, options, { glob, posix } = {}) => {\n  if (typeof input !== 'string') {\n    throw new TypeError('Expected input to be a string');\n  }\n\n  if (input === '') {\n    return { isMatch: false, output: '' };\n  }\n\n  const opts = options || {};\n  const format = opts.format || (posix ? utils.toPosixSlashes : null);\n  let match = input === glob;\n  let output = (match && format) ? format(input) : input;\n\n  if (match === false) {\n    output = format ? format(input) : input;\n    match = output === glob;\n  }\n\n  if (match === false || opts.capture === true) {\n    if (opts.matchBase === true || opts.basename === true) {\n      match = picomatch.matchBase(input, regex, options, posix);\n    } else {\n      match = regex.exec(output);\n    }\n  }\n\n  return { isMatch: Boolean(match), match, output };\n};\n\n/**\n * Match the basename of a filepath.\n *\n * ```js\n * const picomatch = require('picomatch');\n * // picomatch.matchBase(input, glob[, options]);\n * console.log(picomatch.matchBase('foo/bar.js', '*.js'); // true\n * ```\n * @param {String} `input` String to test.\n * @param {RegExp|String} `glob` Glob pattern or regex created by [.makeRe](#makeRe).\n * @return {Boolean}\n * @api public\n */\n\npicomatch.matchBase = (input, glob, options, posix = utils.isWindows(options)) => {\n  const regex = glob instanceof RegExp ? glob : picomatch.makeRe(glob, options);\n  return regex.test(path.basename(input));\n};\n\n/**\n * Returns true if **any** of the given glob `patterns` match the specified `string`.\n *\n * ```js\n * const picomatch = require('picomatch');\n * // picomatch.isMatch(string, patterns[, options]);\n *\n * console.log(picomatch.isMatch('a.a', ['b.*', '*.a'])); //=> true\n * console.log(picomatch.isMatch('a.a', 'b.*')); //=> false\n * ```\n * @param {String|Array} str The string to test.\n * @param {String|Array} patterns One or more glob patterns to use for matching.\n * @param {Object} [options] See available [options](#options).\n * @return {Boolean} Returns true if any patterns match `str`\n * @api public\n */\n\npicomatch.isMatch = (str, patterns, options) => picomatch(patterns, options)(str);\n\n/**\n * Parse a glob pattern to create the source string for a regular\n * expression.\n *\n * ```js\n * const picomatch = require('picomatch');\n * const result = picomatch.parse(pattern[, options]);\n * ```\n * @param {String} `pattern`\n * @param {Object} `options`\n * @return {Object} Returns an object with useful properties and output to be used as a regex source string.\n * @api public\n */\n\npicomatch.parse = (pattern, options) => {\n  if (Array.isArray(pattern)) return pattern.map(p => picomatch.parse(p, options));\n  return parse(pattern, { ...options, fastpaths: false });\n};\n\n/**\n * Scan a glob pattern to separate the pattern into segments.\n *\n * ```js\n * const picomatch = require('picomatch');\n * // picomatch.scan(input[, options]);\n *\n * const result = picomatch.scan('!./foo/*.js');\n * console.log(result);\n * { prefix: '!./',\n *   input: '!./foo/*.js',\n *   start: 3,\n *   base: 'foo',\n *   glob: '*.js',\n *   isBrace: false,\n *   isBracket: false,\n *   isGlob: true,\n *   isExtglob: false,\n *   isGlobstar: false,\n *   negated: true }\n * ```\n * @param {String} `input` Glob pattern to scan.\n * @param {Object} `options`\n * @return {Object} Returns an object with\n * @api public\n */\n\npicomatch.scan = (input, options) => scan(input, options);\n\n/**\n * Compile a regular expression from the `state` object returned by the\n * [parse()](#parse) method.\n *\n * @param {Object} `state`\n * @param {Object} `options`\n * @param {Boolean} `returnOutput` Intended for implementors, this argument allows you to return the raw output from the parser.\n * @param {Boolean} `returnState` Adds the state to a `state` property on the returned regex. Useful for implementors and debugging.\n * @return {RegExp}\n * @api public\n */\n\npicomatch.compileRe = (state, options, returnOutput = false, returnState = false) => {\n  if (returnOutput === true) {\n    return state.output;\n  }\n\n  const opts = options || {};\n  const prepend = opts.contains ? '' : '^';\n  const append = opts.contains ? '' : '$';\n\n  let source = `${prepend}(?:${state.output})${append}`;\n  if (state && state.negated === true) {\n    source = `^(?!${source}).*$`;\n  }\n\n  const regex = picomatch.toRegex(source, options);\n  if (returnState === true) {\n    regex.state = state;\n  }\n\n  return regex;\n};\n\n/**\n * Create a regular expression from a parsed glob pattern.\n *\n * ```js\n * const picomatch = require('picomatch');\n * const state = picomatch.parse('*.js');\n * // picomatch.compileRe(state[, options]);\n *\n * console.log(picomatch.compileRe(state));\n * //=> /^(?:(?!\\.)(?=.)[^/]*?\\.js)$/\n * ```\n * @param {String} `state` The object returned from the `.parse` method.\n * @param {Object} `options`\n * @param {Boolean} `returnOutput` Implementors may use this argument to return the compiled output, instead of a regular expression. This is not exposed on the options to prevent end-users from mutating the result.\n * @param {Boolean} `returnState` Implementors may use this argument to return the state from the parsed glob with the returned regular expression.\n * @return {RegExp} Returns a regex created from the given pattern.\n * @api public\n */\n\npicomatch.makeRe = (input, options = {}, returnOutput = false, returnState = false) => {\n  if (!input || typeof input !== 'string') {\n    throw new TypeError('Expected a non-empty string');\n  }\n\n  let parsed = { negated: false, fastpaths: true };\n\n  if (options.fastpaths !== false && (input[0] === '.' || input[0] === '*')) {\n    parsed.output = parse.fastpaths(input, options);\n  }\n\n  if (!parsed.output) {\n    parsed = parse(input, options);\n  }\n\n  return picomatch.compileRe(parsed, options, returnOutput, returnState);\n};\n\n/**\n * Create a regular expression from the given regex source string.\n *\n * ```js\n * const picomatch = require('picomatch');\n * // picomatch.toRegex(source[, options]);\n *\n * const { output } = picomatch.parse('*.js');\n * console.log(picomatch.toRegex(output));\n * //=> /^(?:(?!\\.)(?=.)[^/]*?\\.js)$/\n * ```\n * @param {String} `source` Regular expression source string.\n * @param {Object} `options`\n * @return {RegExp}\n * @api public\n */\n\npicomatch.toRegex = (source, options) => {\n  try {\n    const opts = options || {};\n    return new RegExp(source, opts.flags || (opts.nocase ? 'i' : ''));\n  } catch (err) {\n    if (options && options.debug === true) throw err;\n    return /$^/;\n  }\n};\n\n/**\n * Picomatch constants.\n * @return {Object}\n */\n\npicomatch.constants = constants;\n\n/**\n * Expose \"picomatch\"\n */\n\nmodule.exports = picomatch;\n", "'use strict';\n\nmodule.exports = require('./lib/picomatch');\n", "import INNER_HTML from './DisplayPort.template.html';\nimport INNER_STYLE from './DisplayPort.module.css';\n\n/**\n * No scaling is applied. The canvas size maintains a\n * 1:1 pixel ratio to the defined display dimensions.\n */\nexport const MODE_NOSCALE = 'noscale';\n\n/**\n * No scaling is applied, but the element fills the\n * entire viewport. The canvas size maintains a 1:1\n * pixel ratio to the defined display dimensions and\n * is centered inside the scaled element.\n */\nexport const MODE_CENTER = 'center';\n\n/**\n * Scales the canvas to fill the entire viewport and\n * maintains the same aspect ratio. This will adjust\n * canvas resolution to fit the viewport dimensions.\n * In other words, the canvas pixel size remains\n * constant, but the number of pixels in the canvas\n * will increase or decrease to compensate. This is\n * the default scaling mode.\n */\nexport const MODE_FIT = 'fit';\n\n/**\n * Scales the canvas to fill the entire viewport and\n * maintains the same aspect ratio and pixel\n * resolution. This will upscale and downscale the\n * pixel size depending on the viewport dimentions\n * in order to preserve the canvas pixel count. In\n * other words, the number of pixels in the canvas\n * remain constant but appear larger or smaller to\n * compensate.\n */\nexport const MODE_SCALE = 'scale';\n\n/**\n * Resizes the canvas to fill the entire viewport.\n * This does not maintain the aspect ratio nor pixel\n * count (adds and removes pixels to fill size). If you\n * care about aspect ratio but not pixel count, consider\n * using 'fit' mode instead.\n */\nexport const MODE_FILL = 'fill';\n\n/**\n * Scales the canvas to fill the entire viewport.\n * This does not maintain the aspect ratio but\n * does preserve pixel count (by stretching the pixel\n * size). If you care about aspect ratio and pixel\n * count, consider using 'scale' mode instead.\n */\nexport const MODE_STRETCH = 'stretch';\n\n/**\n * The default display x dimensions. This is\n * the same as the canvas element default.\n */\nconst DEFAULT_WIDTH = 300;\n/**\n * The default display y dimensions. This is\n * the same as the canvas element default.\n */\nconst DEFAULT_HEIGHT = 150;\n\n/** The default display scaling mode. */\nconst DEFAULT_MODE = MODE_FIT;\n\n/** The default resize timeout */\nconst DELAYED_RESIZE_MILLIS = 200;\n\n/**\n * @typedef {CustomEvent} FrameEvent\n * @property {number} detail.now\n * The current time in milliseconds.\n * @property {number} detail.prevTime\n * The previous frame time in milliseconds.\n * @property {number} detail.deltaTime\n * The time taken between the current and previous\n * frame in milliseconds.\n * @property {HTMLCanvasElement} detail.canvas\n * The canvas element.\n */\n\n/**\n * @typedef {MODE_CENTER\n *          |MODE_FIT\n *          |MODE_NOSCALE\n *          |MODE_SCALE\n *          |MODE_FILL\n *          |MODE_STRETCH} DisplayScaling\n */\n\n/**\n * A canvas that can scale and stretch with respect to the aspect ratio to fill\n * the viewport size.\n *\n * To start drawing, you should get the canvas context like so:\n *\n * For Canvas2D:\n * ```\n * const display = document.querySelector('display-port');\n * const ctx = display.canvas.getContext('2d');\n * ctx.drawText(0, 0, 'Hello World!');\n * ```\n *\n * For WebGL:\n * ```\n * const display = document.querySelector('display-port');\n * const gl = display.canvas.getContext('webgl');\n * gl.clear(gl.COLOR_BUFFER_BIT);\n * ```\n *\n * Usually, you would want to set the `width` and `height` attributes to define\n * the canvas size and aspect ratio in pixels. You can also change the scaling\n * behavior by setting the `mode` attribute.\n *\n * And for convenience, this element also dispatches a `frame` event every animation\n * frame (60 fps). This is basically the same as calling `requestAnimationFrame()`.\n *\n * NOTE: The viewport size is usually the parent container size. However, in the\n * rare case the element must be nested in a child container, you can define the\n * boolean attribute `full` to force the dimensions to be the actual window size.\n */\nexport class DisplayPort extends HTMLElement {\n\n  /**\n   * @param {object} [opts]\n   * @param {HTMLElement} [opts.root]\n   * @param {DisplayScaling} [opts.mode]\n   * @param {number} [opts.width]\n   * @param {number} [opts.height]\n   * @param {boolean} [opts.debug]\n   */\n  static create(opts = {}) {\n    const {\n      root = document.body,\n      mode = DEFAULT_MODE,\n      width = DEFAULT_WIDTH,\n      height = DEFAULT_HEIGHT,\n      debug = false\n    } = opts || {};\n    let result = new DisplayPort();\n    result.mode = mode;\n    result.width = width;\n    result.height = height;\n    result.debug = debug;\n    root.appendChild(result);\n    return result;\n  }\n\n  /** @private */\n  static get [Symbol.for('templateNode')]() {\n    let t = document.createElement('template');\n    t.innerHTML = INNER_HTML;\n    Object.defineProperty(this, Symbol.for('templateNode'), { value: t });\n    return t;\n  }\n\n  /** @private */\n  static get [Symbol.for('styleNode')]() {\n    let t = document.createElement('style');\n    t.innerHTML = INNER_STYLE;\n    Object.defineProperty(this, Symbol.for('styleNode'), { value: t });\n    return t;\n  }\n\n  static define(customElements = window.customElements) {\n    customElements.define('display-port', this);\n  }\n\n  /**\n   * @protected\n   * Override for web component.\n   */\n  static get observedAttributes() {\n    return [\n      'debug',\n      'disabled',\n      // 'mode',\n      'width',\n      'height',\n      'onframe',\n      // Built-in attributes\n      'id',\n      'class',\n    ];\n  }\n\n  /**\n   * The scaling mode.\n   * - `noscale`: Do not perform scaling.\n   * - `center`: Do not perform scaling but stretch the display to fill the entire\n   * viewport. The unscaled canvas is centered.\n   * - `fit`: Resize resolution to fill the entire viewport and maintains the aspect\n   * ratio. The pixel resolution is changed. This is the default behavior.\n   * - `fill`: Resize resolution to fill the entire viewport but does not maintain\n   * aspect ratio.\n   * - `stretch`: Perform scaling to fill the entire viewport but does not maintain\n   * aspect ratio.\n   * - `scale`: Perform scaling to fill the entire viewport and maintains the\n   * aspect ratio and resolution. The pixel resolution remains constant.\n   * @returns {DisplayScaling} The current scaling mode.\n   */\n  get mode() {\n    return /** @type {DisplayScaling} */ (this.getAttribute('mode'));\n  }\n\n  set mode(value) {\n    this.setAttribute('mode', value);\n  }\n\n  /**\n   * Set to true for debug information.\n   * @returns {boolean}\n   */\n  get debug() {\n    return this._debug;\n  }\n\n  set debug(value) {\n    this.toggleAttribute('debug', value);\n  }\n\n  /**\n   * If disabled, animation frames will not fire.\n   * @returns {boolean}\n   */\n  get disabled() {\n    return this._disabled;\n  }\n\n  set disabled(value) {\n    this.toggleAttribute('disabled', value);\n  }\n\n  /**\n   * The canvas width in pixels. This determines the aspect ratio and canvas buffer size.\n   * @returns {number}\n   */\n  get width() {\n    return this._width;\n  }\n\n  set width(value) {\n    this.setAttribute('width', String(value));\n  }\n\n  /**\n   * The canvas height in pixels. This determines the aspect ratio and canvas buffer size.\n   */\n  get height() {\n    return this._height;\n  }\n\n  set height(value) {\n    this.setAttribute('height', String(value));\n  }\n\n  /** Fired every animation frame. */\n  get onframe() {\n    return this._onframe;\n  }\n\n  set onframe(value) {\n    if (this._onframe) this.removeEventListener('frame', this._onframe);\n    this._onframe = value;\n    if (this._onframe) this.addEventListener('frame', value);\n  }\n\n  constructor() {\n    super();\n    const shadowRoot = this.attachShadow({ mode: 'open' });\n    shadowRoot.appendChild(\n      this.constructor[Symbol.for('templateNode')].content.cloneNode(true)\n    );\n    shadowRoot.appendChild(\n      this.constructor[Symbol.for('styleNode')].cloneNode(true)\n    );\n\n    /** @private */\n    this._canvasElement = shadowRoot.querySelector('canvas');\n    /**\n     * @private\n     * @type {HTMLDivElement}\n     */\n    this._contentElement = shadowRoot.querySelector('.content');\n    /**\n     * @private\n     * @type {HTMLSlotElement}\n     */\n    this._innerElement = shadowRoot.querySelector('#inner');\n\n    /** @private */\n    this._titleElement = shadowRoot.querySelector('#title');\n    /** @private */\n    this._fpsElement = shadowRoot.querySelector('#fps');\n    /** @private */\n    this._dimensionElement = shadowRoot.querySelector('#dimension');\n\n    /** @private */\n    this._debug = false;\n    /** @private */\n    this._disabled = false;\n    /** @private */\n    this._width = DEFAULT_WIDTH;\n    /** @private */\n    this._height = DEFAULT_HEIGHT;\n    /** @private */\n    this._onframe = undefined;\n\n    /** @private */\n    this._animationRequestHandle = 0;\n    /** @private */\n    this._prevAnimationFrameTime = 0;\n\n    /** @private */\n    this._resizeTimeoutHandle = 0;\n    /** @private */\n    this._resizeCanvasWidth = 0;\n    /** @private */\n    this._resizeCanvasHeight = 0;\n\n    /** @private */\n    this._frameEvent = new CustomEvent('frame', {\n      composed: true,\n      bubbles: false,\n      detail: {\n        now: 0,\n        prevTime: 0,\n        deltaTime: 0,\n        canvas: this._canvasElement,\n      },\n    });\n    /** @private */\n    this._resizeEvent = new CustomEvent('resize', {\n      composed: true,\n      bubbles: false,\n      detail: {\n        width: 0,\n        height: 0,\n      },\n    });\n\n    /** @private */\n    this.update = this.update.bind(this);\n    /** @private */\n    this.onDelayCanvasResize = this.onDelayCanvasResize.bind(this);\n  }\n\n  /** Get the canvas element. */\n  get canvas() {\n    return this._canvasElement;\n  }\n\n  /**\n   * @protected\n   * Override for web component.\n   */\n  connectedCallback() {\n    upgradeProperty(this, 'mode');\n    upgradeProperty(this, 'debug');\n    upgradeProperty(this, 'disabled');\n    upgradeProperty(this, 'width');\n    upgradeProperty(this, 'height');\n    upgradeProperty(this, 'onframe');\n\n    if (!this.hasAttribute('mode')) {\n      this.setAttribute('mode', DEFAULT_MODE);\n    }\n\n    // Allows this element to be focusable\n    if (!this.hasAttribute('tabindex')) {\n      this.setAttribute('tabindex', '0');\n    }\n\n    this.updateCanvasSize(true);\n    this.resume();\n  }\n\n  /**\n   * @protected\n   * Override for web component.\n   */\n  disconnectedCallback() {\n    this.pause();\n  }\n\n  /**\n   * @protected\n   * Override for web component.\n   */\n  attributeChangedCallback(attribute, prev, value) {\n    switch (attribute) {\n      case 'debug':\n        {\n          this._debug = value !== null;\n        }\n        break;\n      case 'disabled':\n        {\n          this._disabled = value !== null;\n        }\n        break;\n      case 'width':\n        {\n          this._width = Number(value);\n        }\n        break;\n      case 'height':\n        {\n          this._height = Number(value);\n        }\n        break;\n      case 'onframe':\n        {\n          this.onframe = new Function(\n            'event',\n            'with(document){with(this){' + value + '}}'\n          ).bind(this);\n        }\n        break;\n    }\n\n    switch (attribute) {\n      case 'disabled':\n        if (value) {\n          this.update(0);\n          this.pause();\n        } else {\n          this.resume();\n        }\n        break;\n      // NOTE: For debugging purposes...\n      case 'id':\n      case 'class':\n        this._titleElement.innerHTML = `display-port${\n          this.className ? '.' + this.className : ''\n        }${this.hasAttribute('id') ? '#' + this.getAttribute('id') : ''}`;\n        break;\n      case 'debug':\n        this._titleElement.classList.toggle('hidden', value);\n        this._fpsElement.classList.toggle('hidden', value);\n        this._dimensionElement.classList.toggle('hidden', value);\n        break;\n    }\n  }\n\n  /**\n   * @param {'2d'|'webgl'|'webgl2'} [contextId]\n   * @param {CanvasRenderingContext2DSettings} [options]\n   */\n  getContext(contextId = '2d', options = undefined) {\n    return this._canvasElement.getContext(contextId, options);\n  }\n\n  /** Pause animation of the display frames. */\n  pause() {\n    window.cancelAnimationFrame(this._animationRequestHandle);\n  }\n\n  /** Resume animation of the display frames. */\n  resume() {\n    this._animationRequestHandle = window.requestAnimationFrame(this.update);\n  }\n\n  /** @private */\n  update(now) {\n    this._animationRequestHandle = window.requestAnimationFrame(this.update);\n    this.updateCanvasSize(false);\n    const deltaTime = now - this._prevAnimationFrameTime;\n    this._prevAnimationFrameTime = now;\n\n    // NOTE: For debugging purposes...\n    if (this._debug) {\n      // Update FPS...\n      const frames =\n        deltaTime <= 0\n          ? '--'\n          : String(Math.round(1000 / deltaTime)).padStart(2, '0');\n      if (this._fpsElement.textContent !== frames) {\n        this._fpsElement.textContent = frames;\n      }\n\n      // Update dimensions...\n      const mode = this.mode;\n      if (mode === MODE_NOSCALE) {\n        let result = `${this._width}x${this._height}`;\n        if (this._dimensionElement.textContent !== result) {\n          this._dimensionElement.textContent = result;\n        }\n      } else {\n        let result = `${this._width}x${this._height}|${this.shadowRoot.host.clientWidth}x${this.shadowRoot.host.clientHeight}`;\n        if (this._dimensionElement.textContent !== result) {\n          this._dimensionElement.textContent = result;\n        }\n      }\n    }\n\n    let event = this._frameEvent;\n    let detail = event.detail;\n    detail.now = now;\n    detail.prevTime = this._prevAnimationFrameTime;\n    detail.deltaTime = deltaTime;\n    this.dispatchEvent(this._frameEvent);\n  }\n\n  /** @private */\n  onDelayCanvasResize() {\n    this._resizeTimeoutHandle = null;\n    this.updateCanvasSize(true);\n  }\n\n  delayCanvasResize(canvasWidth, canvasHeight) {\n    if (\n      canvasWidth !== this._resizeCanvasWidth ||\n      canvasHeight !== this._resizeCanvasHeight\n    ) {\n      // Only call onDelayCanvasResize, if new canvas size actually changed since last time.\n      this._resizeCanvasWidth = canvasWidth;\n      this._resizeCanvasHeight = canvasHeight;\n      if (this._resizeTimeoutHandle) {\n        window.clearTimeout(this._resizeTimeoutHandle);\n      }\n      this._resizeTimeoutHandle = window.setTimeout(\n        this.onDelayCanvasResize,\n        DELAYED_RESIZE_MILLIS\n      );\n    }\n  }\n\n  /** @private */\n  updateCanvasSize(force = true) {\n    const clientRect = this.shadowRoot.host.getBoundingClientRect();\n    const clientWidth = clientRect.width;\n    const clientHeight = clientRect.height;\n\n    let canvas = this._canvasElement;\n    let canvasWidth = this._width;\n    let canvasHeight = this._height;\n\n    const mode = this.mode;\n    if (mode === MODE_STRETCH || mode === MODE_FILL) {\n      canvasWidth = clientWidth;\n      canvasHeight = clientHeight;\n    } else if (mode !== MODE_NOSCALE) {\n      if (\n        clientWidth < canvasWidth ||\n        clientHeight < canvasHeight ||\n        mode === MODE_FIT ||\n        mode == MODE_SCALE\n      ) {\n        let ratioX = clientWidth / canvasWidth;\n        let ratioY = clientHeight / canvasHeight;\n\n        if (ratioX < ratioY) {\n          canvasWidth = clientWidth;\n          canvasHeight = canvasHeight * ratioX;\n        } else {\n          canvasWidth = canvasWidth * ratioY;\n          canvasHeight = clientHeight;\n        }\n      }\n    }\n\n    canvasWidth = Math.floor(canvasWidth);\n    canvasHeight = Math.floor(canvasHeight);\n\n    if (typeof force === 'undefined') {\n      force =\n        canvas.clientWidth !== canvasWidth ||\n        canvas.clientHeight !== canvasHeight;\n    }\n\n    if (!force) {\n      this.delayCanvasResize(canvasWidth, canvasHeight);\n      return;\n    }\n\n    let fontSize =\n      Math.min(canvasWidth / this._width, canvasHeight / this._height) * 0.5;\n    // NOTE: Update the inner container for the default slotted children.\n    // To anchor children outside the canvas, use the slot named 'frame'.\n    this._innerElement.style.fontSize = `font-size: ${fontSize}em`;\n    if (force) {\n      if (mode === MODE_SCALE) {\n        canvas.width = this._width;\n        canvas.height = this._height;\n      } else if (mode !== MODE_STRETCH) {\n        canvas.width = canvasWidth;\n        canvas.height = canvasHeight;\n      }\n      let contentStyle = this._contentElement.style;\n      contentStyle.width = `${canvasWidth}px`;\n      contentStyle.height = `${canvasHeight}px`;\n\n      if (mode === MODE_FIT || mode === MODE_FILL) {\n        this._width = canvasWidth;\n        this._height = canvasHeight;\n      }\n\n      let event = this._resizeEvent;\n      let detail = event.detail;\n      detail.width = canvasWidth;\n      detail.height = canvasHeight;\n      this.dispatchEvent(this._resizeEvent);\n    }\n  }\n}\nDisplayPort.define();\n\nfunction upgradeProperty(element, propertyName) {\n  if (Object.prototype.hasOwnProperty.call(element, propertyName)) {\n    let value = element[propertyName];\n    delete element[propertyName];\n    element[propertyName] = value;\n  }\n}\n", "/**\n * @typedef {number} BindingIndex\n *\n * @typedef BindingOptions\n * @property {boolean} inverted\n *\n * @typedef InputReadOnly\n * @property {number} value\n * @property {boolean} polling\n */\n\nexport class InputState {\n  get polling() {\n    let dt = performance.now() - this._lastPollingTime;\n    return dt < 1_000;\n  }\n\n  /** @abstract */\n  get value() {\n    return 0;\n  }\n  \n  get size() {\n    return this._size;\n  }\n\n  /**\n   * @abstract\n   * @param {number} size The initial binding state size.\n   */\n  constructor(size) {\n    /** @private */\n    this._size = size;\n    /** @private */\n    this._lastPollingTime = Number.MIN_SAFE_INTEGER;\n  }\n\n  /**\n   * Called to internally resize to accomodate more/less\n   * binding states.\n   *\n   * @protected\n   * @param {number} newSize\n   */\n  resize(newSize) {\n    this._size = newSize;\n  }\n\n  /**\n   * @abstract\n   * @param {BindingIndex} code\n   * @returns {number}\n   */\n  // eslint-disable-next-line no-unused-vars\n  getState(code) {\n    throw new Error('Missing implementation.');\n  }\n\n  /**\n   * @abstract\n   * @param {BindingIndex} code\n   * @param {number} value\n   * @param {number} delta\n   */\n  // eslint-disable-next-line no-unused-vars\n  onUpdate(code, value, delta) {\n    throw new Error('Missing implementation.');\n  }\n\n  /**\n   * @abstract\n   * @param {BindingIndex} code\n   * @param {number} value\n   */\n  // eslint-disable-next-line no-unused-vars\n  onStatus(code, value) {\n    throw new Error('Missing implementation.');\n  }\n\n  /**\n   * Called to poll all bound states.\n   *\n   * @param {number} now\n   */\n  onPoll(now) {\n    this._lastPollingTime = now;\n  }\n\n  /**\n   * Called to bind a state to the given binding code.\n   *\n   * @param {BindingIndex} code\n   * @param {BindingOptions} [opts]\n   */\n  // eslint-disable-next-line no-unused-vars\n  onBind(code, opts = undefined) {\n    if (code >= this._size) {\n      this.resize(code + 1);\n    }\n  }\n\n  /**\n   * Called to unbind all states.\n   */\n  onUnbind() {\n    this.resize(0);\n  }\n}\n", "import { InputState } from './InputState.js';\n\n/**\n * @typedef {import('./InputState.js').BindingIndex} BindingIndex The binding index\n * @typedef {import('./InputState.js').BindingOptions} BindingOptions The binding options\n *\n * @typedef AxisBindingState\n * @property {number} value\n * @property {number} delta\n * @property {boolean} inverted\n *\n * @typedef AxisReadOnly\n * @property {number} value\n * @property {number} delta\n * @property {boolean} polling\n */\n\nexport class AxisState extends InputState {\n  /** @returns {AxisBindingState} */\n  static createAxisBindingState() {\n    return {\n      value: 0,\n      delta: 0,\n      inverted: false,\n    };\n  }\n\n  /** @returns {number} */\n  get delta() {\n    return this._delta;\n  }\n\n  /**\n   * @override\n   * @returns {number}\n   */\n  get value() {\n    return this._value;\n  }\n\n  /**\n   * @param {number} [size]\n   */\n  constructor(size = 0) {\n    super(size);\n    let state = new Array();\n    let c = /** @type {typeof AxisState} */ (this.constructor);\n    for (let i = 0; i < size; ++i) {\n      state.push(c.createAxisBindingState());\n    }\n    /**\n     * @private\n     * @type {Array<AxisBindingState>}\n     */\n    this._state = state;\n    /** @private */\n    this._value = 0;\n    /** @private */\n    this._delta = 0;\n  }\n\n  /**\n   * @override\n   * @protected\n   */\n  resize(newSize) {\n    let oldState = this._state;\n    let oldSize = oldState.length;\n    let newState;\n    if (newSize <= oldSize) {\n      newState = oldState.slice(0, newSize);\n    } else {\n      newState = oldState;\n      // Fill with new states\n      let c = /** @type {typeof AxisState} */ (this.constructor);\n      for (let i = oldSize; i < newSize; ++i) {\n        newState.push(c.createAxisBindingState());\n      }\n    }\n    this._state = newState;\n    super.resize(newSize);\n  }\n\n  /**\n   * @override\n   * @param {BindingIndex} code\n   * @returns {number}\n   */\n  getState(code) {\n    return this._state[code].value;\n  }\n\n  /**\n   * @override\n   * @param {number} now\n   */\n  onPoll(now) {\n    let state = this._state;\n    let accumulatedValue = 0;\n    let accumulatedDelta = 0;\n    const len = state.length;\n    for (let i = 0; i < len; ++i) {\n      let value = state[i];\n      accumulatedValue += value.value * (value.inverted ? -1 : 1);\n      accumulatedDelta += value.delta;\n      state[i].delta = 0;\n    }\n    this._value = accumulatedValue;\n    this._delta = accumulatedDelta;\n    super.onPoll(now);\n  }\n\n  /**\n   * @override\n   * @param {BindingIndex} code\n   * @param {number} value\n   * @param {number} delta\n   */\n  onUpdate(code, value, delta) {\n    if (typeof value === 'undefined') {\n      this.onAxisChange(code, delta);\n    } else {\n      this.onAxisMove(code, value, delta);\n    }\n  }\n\n  /**\n   * @override\n   * @param {BindingIndex} code\n   * @param {number} value\n   */\n  onStatus(code, value) {\n    this.onAxisStatus(code, value);\n  }\n\n  /**\n   * @override\n   * @param {BindingIndex} code\n   * @param {BindingOptions} [opts]\n   */\n  onBind(code, opts = undefined) {\n    super.onBind(code, opts);\n    const { inverted = false } = opts || {};\n    let state = this._state;\n    state[code].inverted = inverted;\n  }\n\n  /**\n   * @protected\n   * @param {BindingIndex} code\n   * @param {number} x\n   * @param {number} dx\n   */\n  onAxisMove(code, x, dx) {\n    let state = this._state[code];\n    state.value = x;\n    state.delta += dx;\n  }\n\n  /**\n   * @protected\n   * @param {BindingIndex} code\n   * @param {number} dx\n   */\n  onAxisChange(code, dx) {\n    let state = this._state[code];\n    state.value += dx;\n    state.delta += dx;\n  }\n\n  /**\n   * @protected\n   * @param {BindingIndex} code\n   * @param {number} x\n   */\n  onAxisStatus(code, x) {\n    let state = this._state[code];\n    let prev = state.value;\n    state.value = x;\n    state.delta = x - prev;\n  }\n}\n", "import { InputState } from './InputState.js';\n\n/**\n * @typedef {import('./InputState.js').BindingIndex} BindingIndex\n * @typedef {import('./InputState.js').BindingOptions} BindingOptions\n *\n * @typedef ButtonReadOnly\n * @property {number} value\n * @property {boolean} pressed\n * @property {boolean} repeated\n * @property {boolean} released\n * @property {boolean} down\n * @property {boolean} polling\n */\n\nexport const CLEAR_POLL_BITS = 0b1111_0001;\nexport const CLEAR_DOWN_STATE_BITS = 0b1111_1110;\nexport const CLEAR_INVERTED_MODIFIER_BITS = 0b1110_1111;\n\nexport const DOWN_STATE_BIT = 0b0000_0001;\nexport const PRESSED_STATE_BIT = 0b0000_0010;\nexport const REPEATED_STATE_BIT = 0b0000_0100;\nexport const RELEASED_STATE_BIT = 0b0000_1000;\nexport const INVERTED_MODIFIER_BIT = 0b0001_0000;\n\nexport class ButtonState extends InputState {\n  /** @returns {boolean} */\n  get pressed() {\n    return this._pressed;\n  }\n\n  /** @returns {boolean} */\n  get repeated() {\n    return this._repeated;\n  }\n\n  /** @returns {boolean} */\n  get released() {\n    return this._released;\n  }\n\n  /** @returns {boolean} */\n  get down() {\n    return this._down;\n  }\n\n  /**\n   * @override\n   * @returns {number}\n   */\n  get value() {\n    return this._value;\n  }\n\n  /**\n   * @param {number} [size]\n   */\n  constructor(size = 0) {\n    super(size);\n    /** @private */\n    this._state = new Uint8Array(size);\n    /** @private */\n    this._value = 0;\n    /** @private */\n    this._down = false;\n    /** @private */\n    this._pressed = false;\n    /** @private */\n    this._repeated = false;\n    /** @private */\n    this._released = false;\n  }\n\n  /**\n   * @override\n   * @protected\n   */\n  resize(newSize) {\n    let oldState = this._state;\n    let oldSize = oldState.length;\n    let newState;\n    if (newSize <= oldSize) {\n      newState = oldState.slice(0, newSize);\n    } else {\n      newState = new Uint8Array(newSize);\n      newState.set(oldState);\n    }\n    this._state = newState;\n    super.resize(newSize);\n  }\n\n  /**\n   * @override\n   * @param {BindingIndex} code\n   * @returns {number}\n   */\n  getState(code) {\n    let state = this._state[code];\n    let modifier = state & INVERTED_MODIFIER_BIT ? -1 : 1;\n    let value = state & DOWN_STATE_BIT ? 1 : 0;\n    return value * modifier;\n  }\n\n  /**\n   * @override\n   * @param {number} now\n   */\n  onPoll(now) {\n    let state = this._state;\n    let result = 0;\n    let down = 0;\n    let pressed = 0;\n    let repeated = 0;\n    let released = 0;\n    const len = state.length;\n    for (let i = 0; i < len; ++i) {\n      let value = state[i];\n      let v = value & DOWN_STATE_BIT;\n      let m = value & INVERTED_MODIFIER_BIT;\n      down |= v;\n      pressed |= value & PRESSED_STATE_BIT;\n      repeated |= value & REPEATED_STATE_BIT;\n      released |= value & RELEASED_STATE_BIT;\n      result += (v ? 1 : 0) * (m ? -1 : 1);\n      state[i] &= CLEAR_POLL_BITS;\n    }\n    this._value = result;\n    this._down = down !== 0;\n    this._pressed = pressed !== 0;\n    this._repeated = repeated !== 0;\n    this._released = released !== 0;\n    super.onPoll(now);\n  }\n\n  /**\n   * @override\n   * @param {BindingIndex} code\n   * @param {number} value\n   * @param {number} delta\n   */\n  onUpdate(code, value, delta) {\n    if (delta > 0) {\n      this.onButtonPressed(code);\n    } else {\n      this.onButtonReleased(code);\n    }\n  }\n\n  /**\n   * @override\n   * @param {BindingIndex} code\n   * @param {number} value\n   */\n  onStatus(code, value) {\n    this.onButtonStatus(code, value !== 0);\n  }\n\n  /**\n   * @override\n   * @param {BindingIndex} code\n   * @param {BindingOptions} [opts]\n   */\n  onBind(code, opts = { inverted: false }) {\n    super.onBind(code, opts);\n    const { inverted = false } = opts;\n    let state = this._state;\n    if (inverted) {\n      state[code] |= INVERTED_MODIFIER_BIT;\n    } else {\n      state[code] &= CLEAR_INVERTED_MODIFIER_BITS;\n    }\n  }\n\n  /**\n   * @protected\n   * @param {BindingIndex} code\n   */\n  onButtonPressed(code) {\n    let state = this._state;\n    let bits = state[code];\n    if (!(bits & DOWN_STATE_BIT)) {\n      bits |= PRESSED_STATE_BIT;\n      bits |= DOWN_STATE_BIT;\n    }\n    bits |= REPEATED_STATE_BIT;\n    state[code] = bits;\n  }\n\n  /**\n   * @protected\n   * @param {BindingIndex} code\n   */\n  onButtonReleased(code) {\n    let state = this._state;\n    let bits = state[code];\n    if (bits & DOWN_STATE_BIT) {\n      bits |= RELEASED_STATE_BIT;\n      bits &= CLEAR_DOWN_STATE_BITS;\n    }\n    state[code] = bits;\n  }\n\n  /**\n   * @protected\n   * @param {BindingIndex} code\n   * @param {boolean} isDown\n   */\n  onButtonStatus(code, isDown) {\n    let state = this._state;\n    let bits = state[code];\n    let wasDown = Boolean(bits & DOWN_STATE_BIT);\n    if (isDown) {\n      bits |= DOWN_STATE_BIT;\n    } else {\n      bits &= CLEAR_DOWN_STATE_BITS;\n    }\n    if (wasDown && !isDown) {\n      bits |= RELEASED_STATE_BIT;\n    }\n    if (!wasDown && isDown) {\n      bits |= PRESSED_STATE_BIT;\n      bits |= REPEATED_STATE_BIT;\n    }\n    state[code] = bits;\n  }\n}\n", "export class KeyCode {\n  /**\n   * @param {string} string\n   * @returns {KeyCode}\n   */\n  static parse(string) {\n    string = string.trim();\n    let i = string.indexOf('.');\n    if (i < 0) {\n      throw new Error('Missing device separator for key code.');\n    }\n    let device = string.substring(0, i);\n    if (device.length < 0) {\n      throw new Error('Missing device for key code.');\n    }\n    let key = string.substring(i + 1);\n    if (key.length < 0) {\n      throw new Error('Missing code for key code.');\n    }\n    return new KeyCode(device, key);\n  }\n\n  /**\n   * @param {string} device\n   * @param {string} code\n   */\n  constructor(device, code) {\n    this.device = device;\n    this.code = code;\n  }\n\n  /** @override */\n  toString() {\n    return `${this.device}.${this.code}`;\n  }\n}\n", "import { KeyCode } from './KeyCode.js';\n\nexport function from(device, code) {\n  return new KeyCode(device, code);\n}\n\nexport function isKeyCode(object) {\n  return 'device' in object && 'code' in object;\n}\n\nexport const KEYBOARD = 'Keyboard';\nexport const MOUSE = 'Mouse';\n\nexport const KEY_A = new KeyCode(KEYBOARD, 'KeyA');\nexport const KEY_B = new KeyCode(KEYBOARD, 'KeyB');\nexport const KEY_C = new KeyCode(KEYBOARD, 'KeyC');\nexport const KEY_D = new KeyCode(KEYBOARD, 'KeyD');\nexport const KEY_E = new KeyCode(KEYBOARD, 'KeyE');\nexport const KEY_F = new KeyCode(KEYBOARD, 'KeyF');\nexport const KEY_G = new KeyCode(KEYBOARD, 'KeyG');\nexport const KEY_H = new KeyCode(KEYBOARD, 'KeyH');\nexport const KEY_I = new KeyCode(KEYBOARD, 'KeyI');\nexport const KEY_J = new KeyCode(KEYBOARD, 'KeyJ');\nexport const KEY_K = new KeyCode(KEYBOARD, 'KeyK');\nexport const KEY_L = new KeyCode(KEYBOARD, 'KeyL');\nexport const KEY_M = new KeyCode(KEYBOARD, 'KeyM');\nexport const KEY_N = new KeyCode(KEYBOARD, 'KeyN');\nexport const KEY_O = new KeyCode(KEYBOARD, 'KeyO');\nexport const KEY_P = new KeyCode(KEYBOARD, 'KeyP');\nexport const KEY_Q = new KeyCode(KEYBOARD, 'KeyQ');\nexport const KEY_R = new KeyCode(KEYBOARD, 'KeyR');\nexport const KEY_S = new KeyCode(KEYBOARD, 'KeyS');\nexport const KEY_T = new KeyCode(KEYBOARD, 'KeyT');\nexport const KEY_U = new KeyCode(KEYBOARD, 'KeyU');\nexport const KEY_V = new KeyCode(KEYBOARD, 'KeyV');\nexport const KEY_W = new KeyCode(KEYBOARD, 'KeyW');\nexport const KEY_X = new KeyCode(KEYBOARD, 'KeyX');\nexport const KEY_Y = new KeyCode(KEYBOARD, 'KeyY');\nexport const KEY_Z = new KeyCode(KEYBOARD, 'KeyZ');\n\nexport const DIGIT_0 = new KeyCode(KEYBOARD, 'Digit0');\nexport const DIGIT_1 = new KeyCode(KEYBOARD, 'Digit1');\nexport const DIGIT_2 = new KeyCode(KEYBOARD, 'Digit2');\nexport const DIGIT_3 = new KeyCode(KEYBOARD, 'Digit3');\nexport const DIGIT_4 = new KeyCode(KEYBOARD, 'Digit4');\nexport const DIGIT_5 = new KeyCode(KEYBOARD, 'Digit5');\nexport const DIGIT_6 = new KeyCode(KEYBOARD, 'Digit6');\nexport const DIGIT_7 = new KeyCode(KEYBOARD, 'Digit7');\nexport const DIGIT_8 = new KeyCode(KEYBOARD, 'Digit8');\nexport const DIGIT_9 = new KeyCode(KEYBOARD, 'Digit9');\n\nexport const MINUS = new KeyCode(KEYBOARD, 'Minus');\nexport const EQUAL = new KeyCode(KEYBOARD, 'Equal');\nexport const BRACKET_LEFT = new KeyCode(KEYBOARD, 'BracketLeft');\nexport const BRACKET_RIGHT = new KeyCode(KEYBOARD, 'BracketRight');\nexport const SEMICOLON = new KeyCode(KEYBOARD, 'Semicolon');\nexport const QUOTE = new KeyCode(KEYBOARD, 'Quote');\nexport const BACKQUOTE = new KeyCode(KEYBOARD, 'Backquote');\nexport const BACKSLASH = new KeyCode(KEYBOARD, 'Backslash');\nexport const COMMA = new KeyCode(KEYBOARD, 'Comma');\nexport const PERIOD = new KeyCode(KEYBOARD, 'Period');\nexport const SLASH = new KeyCode(KEYBOARD, 'Slash');\n\nexport const ESCAPE = new KeyCode(KEYBOARD, 'Escape');\nexport const SPACE = new KeyCode(KEYBOARD, 'Space');\nexport const CAPS_LOCK = new KeyCode(KEYBOARD, 'CapsLock');\nexport const BACKSPACE = new KeyCode(KEYBOARD, 'Backspace');\nexport const DELETE = new KeyCode(KEYBOARD, 'Delete');\nexport const TAB = new KeyCode(KEYBOARD, 'Tab');\nexport const ENTER = new KeyCode(KEYBOARD, 'Enter');\n\nexport const ARROW_UP = new KeyCode(KEYBOARD, 'ArrowUp');\nexport const ARROW_DOWN = new KeyCode(KEYBOARD, 'ArrowDown');\nexport const ARROW_LEFT = new KeyCode(KEYBOARD, 'ArrowLeft');\nexport const ARROW_RIGHT = new KeyCode(KEYBOARD, 'ArrowRight');\n\nexport const MOUSE_BUTTON_0 = new KeyCode(MOUSE, 'Button0');\nexport const MOUSE_BUTTON_1 = new KeyCode(MOUSE, 'Button1');\nexport const MOUSE_BUTTON_2 = new KeyCode(MOUSE, 'Button2');\nexport const MOUSE_BUTTON_3 = new KeyCode(MOUSE, 'Button3');\nexport const MOUSE_BUTTON_4 = new KeyCode(MOUSE, 'Button4');\n\nexport const MOUSE_POS_X = new KeyCode(MOUSE, 'PosX');\nexport const MOUSE_POS_Y = new KeyCode(MOUSE, 'PosY');\n\nexport const MOUSE_WHEEL_X = new KeyCode(MOUSE, 'WheelX');\nexport const MOUSE_WHEEL_Y = new KeyCode(MOUSE, 'WheelY');\nexport const MOUSE_WHEEL_Z = new KeyCode(MOUSE, 'WheelZ');\n", "export class InputBinding {\n  /** @returns {boolean} */\n  get polling() {\n    if (!this.ref) {\n      return false;\n    }\n    return this.ref.polling;\n  }\n\n  /** @returns {number} */\n  get value() {\n    if (!this.ref || this.disabled) {\n      return 0;\n    }\n    return this.ref.value;\n  }\n\n  /**\n   * @param {string} name\n   */\n  constructor(name) {\n    /** @protected */\n    this.name = name;\n\n    /** @protected */\n    this.ref = null;\n\n    /** @protected */\n    this.disabled = false;\n  }\n\n  /**\n   * @abstract\n   * @param {import('../InputContext.js').InputContext} inputContext\n   */\n  bindTo(inputContext) {\n    throw new Error('Unsupported operation.');\n  }\n\n  disable(force = true) {\n    this.disabled = force;\n    return this;\n  }\n\n  /**\n   * @param {number} code\n   * @returns {number}\n   */\n  getState(code) {\n    if (!this.ref || this.disabled) {\n      return 0;\n    }\n    return this.ref.getState(code);\n  }\n}\n", "import { KeyCode } from './KeyCode.js';\nimport * as KeyCodes from './KeyCodes.js';\n\nexport { KeyCodes };\n\n/**\n * @param {string|Array<string>} strings\n * @returns {Array<KeyCode>}\n */\nexport function stringsToKeyCodes(strings) {\n  if (!Array.isArray(strings)) {\n    strings = [strings];\n  }\n  let result = [];\n  for (let str of strings) {\n    let keyCode;\n    try {\n      keyCode = KeyCode.parse(str);\n    } catch (e) {\n      let keyName = camelToSnakeCase(str).toUpperCase();\n      if (!(keyName in KeyCodes)) {\n        throw new Error('Invalid key code string - ' + e);\n      }\n      keyCode = KeyCodes[keyName];\n    }\n    result.push(keyCode);\n  }\n  return result;\n}\n\n/**\n * @param {string} str\n * @returns {string}\n */\nfunction camelToSnakeCase(str) {\n  return str\n    .replace(/([a-z]|(?:[A-Z0-9]+))([A-Z0-9]|$)/g, function (_, a, b) {\n      return a + (b && '_' + b);\n    })\n    .toLowerCase();\n}\n", "import { from } from '../keycode/KeyCodes.js';\nimport { InputBinding } from './InputBinding.js';\nimport { stringsToKeyCodes } from '../keycode/KeyCodeHelper.js';\n\n/** @typedef {import('../keycode/KeyCode.js').KeyCode} KeyCode */\n\nexport class AxisBinding extends InputBinding {\n  /**\n   * @param {string} name\n   * @param {string} device\n   * @param {string} code\n   * @param {object} [opts]\n   * @returns {AxisBinding}\n   */\n  static fromBind(name, device, code, opts = undefined) {\n    return new AxisBinding(name, from(device, code), opts);\n  }\n\n  /**\n   * @param {string} name\n   * @param {...string} strings\n   * @returns {AxisBinding}\n   */\n  static fromString(name, ...strings) {\n    let keyCodes = stringsToKeyCodes(strings);\n    return new AxisBinding(name, keyCodes);\n  }\n\n  /** @returns {number} */\n  get delta() {\n    if (!this.ref || this.disabled) {\n      return 0;\n    }\n    return this.ref.delta;\n  }\n\n  /**\n   * @param {string} name\n   * @param {KeyCode|Array<KeyCode>} keyCodes\n   * @param {object} [opts]\n   */\n  constructor(name, keyCodes, opts = undefined) {\n    super(name);\n\n    /** @protected */\n    this.keyCodes = Array.isArray(keyCodes) ? keyCodes : [keyCodes];\n    /** @protected */\n    this.opts = opts;\n  }\n\n  /**\n   * @override\n   * @param {import('../InputContext.js').InputContext} inputContext\n   */\n  bindTo(inputContext) {\n    let name = this.name;\n    let opts = this.opts;\n    for (let keyCode of this.keyCodes) {\n      inputContext.bindAxis(name, keyCode.device, keyCode.code, opts);\n    }\n    this.ref = inputContext.getAxis(name);\n    return this;\n  }\n}\n", "import { from } from '../keycode/KeyCodes.js';\nimport { InputBinding } from './InputBinding.js';\nimport { stringsToKeyCodes } from '../keycode/KeyCodeHelper.js';\n\n/**\n * @typedef {import('../keycode/KeyCode.js').KeyCode} KeyCode\n * @typedef {import('../InputContext.js').InputContext} InputContext\n */\n\nexport class ButtonBinding extends InputBinding {\n  /**\n   * @param {string} name\n   * @param {string} device\n   * @param {string} code\n   * @param {object} [opts]\n   * @returns {ButtonBinding}\n   */\n  static fromBind(name, device, code, opts = undefined) {\n    return new ButtonBinding(name, from(device, code), opts);\n  }\n\n  /**\n   * @param {string} name\n   * @param {...string} strings\n   * @returns {ButtonBinding}\n   */\n  static fromString(name, ...strings) {\n    let keyCodes = stringsToKeyCodes(strings);\n    return new ButtonBinding(name, keyCodes);\n  }\n\n  /** @returns {boolean} */\n  get pressed() {\n    if (!this.ref || this.disabled) {\n      return false;\n    }\n    return this.ref.pressed;\n  }\n\n  /** @returns {boolean} */\n  get repeated() {\n    if (!this.ref || this.disabled) {\n      return false;\n    }\n    return this.ref.repeated;\n  }\n\n  /** @returns {boolean} */\n  get released() {\n    if (!this.ref || this.disabled) {\n      return false;\n    }\n    return this.ref.released;\n  }\n\n  /** @returns {boolean} */\n  get down() {\n    if (!this.ref || this.disabled) {\n      return false;\n    }\n    return this.ref.down;\n  }\n\n  /**\n   * @param {string} name\n   * @param {KeyCode|Array<KeyCode>} keyCodes\n   * @param {object} [opts]\n   */\n  constructor(name, keyCodes, opts = undefined) {\n    super(name);\n\n    /** @protected */\n    this.keyCodes = Array.isArray(keyCodes) ? keyCodes : [keyCodes];\n    /** @protected */\n    this.opts = opts;\n  }\n\n  /**\n   * @override\n   * @param {InputContext} inputContext\n   */\n  bindTo(inputContext) {\n    let name = this.name;\n    let opts = this.opts;\n    for (let keyCode of this.keyCodes) {\n      inputContext.bindButton(name, keyCode.device, keyCode.code, opts);\n    }\n    this.ref = inputContext.getButton(name);\n    return this;\n  }\n}\n", "import { from } from '../keycode/KeyCodes.js';\nimport { AxisBinding } from './AxisBinding.js';\n\n/** @typedef {import('../keycode/KeyCode.js').KeyCode} KeyCode */\n\nexport class AxisButtonBinding extends AxisBinding {\n  /**\n   * @param {string} name\n   * @param {string} device\n   * @param {string} negativeCode\n   * @param {string} positiveCode\n   * @returns {AxisButtonBinding}\n   */\n  static fromBind(name, device, negativeCode, positiveCode) {\n    return new AxisButtonBinding(\n      name,\n      from(device, negativeCode),\n      from(device, positiveCode)\n    );\n  }\n\n  /**\n   * @param {string} name\n   * @param {KeyCode} negativeKeyCode\n   * @param {KeyCode} positiveKeyCode\n   */\n  constructor(name, negativeKeyCode, positiveKeyCode) {\n    super(name, []);\n\n    if (negativeKeyCode.device !== positiveKeyCode.device) {\n      throw new Error('Cannot create axis-button codes for different devices.');\n    }\n\n    /** @protected */\n    this.negativeKeyCode = negativeKeyCode;\n    /** @protected */\n    this.positiveKeyCode = positiveKeyCode;\n  }\n\n  /**\n   * @param {import('../InputContext.js').InputContext} inputContext\n   */\n  bindTo(inputContext) {\n    let name = this.name;\n    let negativeKeyCode = this.negativeKeyCode;\n    let positiveKeyCode = this.positiveKeyCode;\n    inputContext.bindAxisButtons(\n      name,\n      negativeKeyCode.device,\n      negativeKeyCode.code,\n      positiveKeyCode.code\n    );\n    this.ref = inputContext.getAxis(name);\n    return this;\n  }\n}\n", "/**\n * @typedef InputDeviceEvent\n * @property {EventTarget} target\n * @property {string} device\n * @property {string} code\n * @property {string} event\n * @property {number} [value] The input value of the triggered event (usually this is 1).\n * @property {number} [movement] The change in value for the triggered event.\n * @property {boolean} [control] Whether any control keys are down (false if up).\n * @property {boolean} [shift] Whether any shift keys are down (false if up).\n * @property {boolean} [alt] Whether any alt keys are down (false if up).\n *\n * @callback InputDeviceEventListener\n * @param {InputDeviceEvent} e\n */\n\n/**\n * A class that represents a raw system device that\n * emits input events.\n */\nexport class InputDevice {\n  /** @abstract */\n  // eslint-disable-next-line no-unused-vars\n  static isAxis(keyCode) {\n    return false;\n  }\n\n  /** @abstract */\n  // eslint-disable-next-line no-unused-vars\n  static isButton(keyCode) {\n    return false;\n  }\n\n  /**\n   * @param {string} deviceName\n   * @param {EventTarget} eventTarget\n   */\n  constructor(deviceName, eventTarget) {\n    if (!eventTarget) {\n      throw new Error(`Missing event target for device ${deviceName}.`);\n    }\n\n    this.name = deviceName;\n    this.eventTarget = eventTarget;\n\n    /**\n     * @private\n     * @type {Record<string, Array<InputDeviceEventListener>>}\n     */\n    this.listeners = {\n      input: [],\n    };\n  }\n\n  /**\n   * @param {EventTarget} eventTarget\n   */\n  setEventTarget(eventTarget) {\n    if (!eventTarget) {\n      throw new Error(`Missing event target for device ${this.name}.`);\n    }\n    this.eventTarget = eventTarget;\n  }\n\n  destroy() {\n    let listeners = this.listeners;\n    for (let event in listeners) {\n      listeners[event].length = 0;\n    }\n  }\n\n  /**\n   * @param {string} event\n   * @param {InputDeviceEventListener} listener\n   */\n  addEventListener(event, listener) {\n    let listeners = this.listeners;\n    if (event in listeners) {\n      listeners[event].push(listener);\n    } else {\n      listeners[event] = [listener];\n    }\n  }\n\n  /**\n   * @param {string} event\n   * @param {InputDeviceEventListener} listener\n   */\n  removeEventListener(event, listener) {\n    let listeners = this.listeners;\n    if (event in listeners) {\n      let list = listeners[event];\n      let i = list.indexOf(listener);\n      if (i >= 0) {\n        list.splice(i, 1);\n      }\n    }\n  }\n\n  /**\n   * @param {InputDeviceEvent} e\n   * @returns {boolean} Whether the input event should be consumed.\n   */\n  dispatchInputEvent(e) {\n    let flag = 0;\n    for (let listener of this.listeners.input) {\n      flag |= listener(e);\n    }\n    return Boolean(flag);\n  }\n}\n", "import { InputDevice } from './InputDevice.js';\n\n/** @typedef {import('./InputDevice.js').InputDeviceEvent} InputDeviceEvent */\n\n/**\n * A class that listens to the keyboard events from the event target and\n * transforms the events into a valid {@link InputEvent} for the added\n * listeners.\n *\n * - This device uses the `event.code` standard to reference each key.\n * - Use this to help you determine the key code: https://keycode.info/\n */\nexport class KeyboardDevice extends InputDevice {\n  /** @override */\n  // eslint-disable-next-line no-unused-vars\n  static isAxis(keyCode) {\n    return false;\n  }\n\n  /** @override */\n  // eslint-disable-next-line no-unused-vars\n  static isButton(keyCode) {\n    return true;\n  }\n\n  /**\n   * Constructs a listening keyboard with no listeners (yet).\n   *\n   * @param {string} deviceName\n   * @param {EventTarget} eventTarget\n   * @param {object} [opts] Any additional options.\n   * @param {boolean} [opts.ignoreRepeat] Whether to\n   * accept repeated key events.\n   */\n  constructor(deviceName, eventTarget, opts = {}) {\n    super(deviceName, eventTarget);\n\n    const { ignoreRepeat = true } = opts;\n    this.ignoreRepeat = ignoreRepeat;\n\n    /**\n     * @private\n     * @type {InputDeviceEvent}\n     */\n    this._eventObject = {\n      target: eventTarget,\n      device: deviceName,\n      code: '',\n      event: '',\n      // Key values\n      value: 0,\n      control: false,\n      shift: false,\n      alt: false,\n    };\n\n    /** @private */\n    this.onKeyDown = this.onKeyDown.bind(this);\n    /** @private */\n    this.onKeyUp = this.onKeyUp.bind(this);\n\n    eventTarget.addEventListener('keydown', this.onKeyDown);\n    eventTarget.addEventListener('keyup', this.onKeyUp);\n  }\n\n  /** @override */\n  setEventTarget(eventTarget) {\n    if (this.eventTarget) this.destroy();\n    super.setEventTarget(eventTarget);\n    eventTarget.addEventListener('keydown', this.onKeyDown);\n    eventTarget.addEventListener('keyup', this.onKeyUp);\n  }\n\n  /** @override */\n  destroy() {\n    let eventTarget = this.eventTarget;\n    eventTarget.removeEventListener('keydown', this.onKeyDown);\n    eventTarget.removeEventListener('keyup', this.onKeyUp);\n    super.destroy();\n  }\n\n  /**\n   * @private\n   * @param {KeyboardEvent} e\n   */\n  onKeyDown(e) {\n    if (e.repeat && this.ignoreRepeat) {\n      e.preventDefault();\n      e.stopPropagation();\n      return false;\n    }\n\n    let event = this._eventObject;\n    // We care more about location (code) than print char (key).\n    event.code = e.code;\n    event.event = 'pressed';\n    event.value = 1;\n    event.control = e.ctrlKey;\n    event.shift = e.shiftKey;\n    event.alt = e.altKey;\n\n    let result = this.dispatchInputEvent(event);\n    if (result) {\n      e.preventDefault();\n      e.stopPropagation();\n      return false;\n    }\n  }\n\n  /**\n   * @private\n   * @param {KeyboardEvent} e\n   */\n  onKeyUp(e) {\n    /** @type {InputDeviceEvent} */\n    let event = this._eventObject;\n    // We care more about location (code) than print char (key).\n    event.code = e.code;\n    event.event = 'released';\n    event.value = 1;\n    event.control = e.ctrlKey;\n    event.shift = e.shiftKey;\n    event.alt = e.altKey;\n\n    let result = this.dispatchInputEvent(event);\n    if (result) {\n      e.preventDefault();\n      e.stopPropagation();\n      return false;\n    }\n  }\n}\n", "import { InputDevice } from './InputDevice.js';\n\n/**\n * @typedef {import('./InputDevice.js').InputDeviceEvent} InputDeviceEvent\n */\n\nconst DEFAULT_LINE_PIXELS = 10;\nconst DEFAULT_PAGE_PIXELS = 100;\n\n/**\n * A class that listens to the mouse events from the event target and\n * transforms the events into a valid {@link InputDeviceEvent} for its\n * listeners.\n *\n * - PosX\n * - PosY\n * - WheelX\n * - WheelY\n * - WheelZ\n * - Button0 (left button)\n * - Button1 (middle button)\n * - Button2 (right button)\n * - Button3 (next button)\n * - Button4 (back button)\n */\nexport class MouseDevice extends InputDevice {\n  /** @override */\n  static isAxis(keyCode) {\n    return (\n      keyCode === 'PosX' ||\n      keyCode === 'PosY' ||\n      keyCode === 'WheelX' ||\n      keyCode === 'WheelY' ||\n      keyCode === 'WheelZ'\n    );\n  }\n\n  /** @override */\n  static isButton(keyCode) {\n    return !this.isAxis(keyCode);\n  }\n\n  /**\n   * Constructs a listening mouse with no listeners (yet).\n   *\n   * @param {string} deviceName\n   * @param {EventTarget} eventTarget\n   * @param {Object} [opts] Any additional options.\n   * @param {Boolean} [opts.eventsOnFocus=true] Whether to capture events only when it has focus.\n   */\n  constructor(deviceName, eventTarget, opts = {}) {\n    super(deviceName, eventTarget);\n\n    const { eventsOnFocus = true } = opts;\n    this.eventsOnFocus = eventsOnFocus;\n    this.canvasTarget = this.getCanvasFromEventTarget(eventTarget);\n\n    /** @private */\n    this._downHasFocus = false;\n\n    /**\n     * @private\n     * @type {InputDeviceEvent}\n     */\n    this._eventObject = {\n      target: eventTarget,\n      device: deviceName,\n      code: '',\n      event: '',\n      // Button values\n      value: 0,\n      control: false,\n      shift: false,\n      alt: false,\n    };\n    /**\n     * @private\n     * @type {InputDeviceEvent}\n     */\n    this._positionObject = {\n      target: eventTarget,\n      device: deviceName,\n      code: '',\n      event: 'move',\n      // Pos values\n      value: 0,\n      movement: 0,\n    };\n    /**\n     * @private\n     * @type {InputDeviceEvent}\n     */\n    this._wheelObject = {\n      target: eventTarget,\n      device: deviceName,\n      code: '',\n      event: 'wheel',\n      // Wheel values\n      movement: 0,\n    };\n\n    /** @private */\n    this.onMouseDown = this.onMouseDown.bind(this);\n    /** @private */\n    this.onMouseUp = this.onMouseUp.bind(this);\n    /** @private */\n    this.onMouseMove = this.onMouseMove.bind(this);\n    /** @private */\n    this.onContextMenu = this.onContextMenu.bind(this);\n    /** @private */\n    this.onWheel = this.onWheel.bind(this);\n\n    eventTarget.addEventListener('mousedown', this.onMouseDown);\n    eventTarget.addEventListener('contextmenu', this.onContextMenu);\n    eventTarget.addEventListener('wheel', this.onWheel);\n    document.addEventListener('mousemove', this.onMouseMove);\n    document.addEventListener('mouseup', this.onMouseUp);\n  }\n\n  /** @override */\n  setEventTarget(eventTarget) {\n    if (this.eventTarget) this.destroy();\n    super.setEventTarget(eventTarget);\n    this.canvasTarget = this.getCanvasFromEventTarget(eventTarget);\n    eventTarget.addEventListener('mousedown', this.onMouseDown);\n    eventTarget.addEventListener('contextmenu', this.onContextMenu);\n    eventTarget.addEventListener('wheel', this.onWheel);\n    document.addEventListener('mousemove', this.onMouseMove);\n    document.addEventListener('mouseup', this.onMouseUp);\n  }\n\n  /** @override */\n  destroy() {\n    let eventTarget = this.eventTarget;\n    eventTarget.removeEventListener('mousedown', this.onMouseDown);\n    eventTarget.removeEventListener('contextmenu', this.onContextMenu);\n    eventTarget.removeEventListener('wheel', this.onWheel);\n    document.removeEventListener('mousemove', this.onMouseMove);\n    document.removeEventListener('mouseup', this.onMouseUp);\n    super.destroy();\n  }\n\n  setPointerLock(force = true) {\n    if (force) {\n      this.eventTarget.requestPointerLock();\n    } else {\n      this.eventTarget.exitPointerLock();\n    }\n  }\n\n  hasPointerLock() {\n    return document.pointerLockElement === this.eventTarget;\n  }\n\n  /**\n   * @private\n   * @param {MouseEvent} e\n   */\n  onMouseDown(e) {\n    this._downHasFocus = true;\n\n    let event = this._eventObject;\n    // We care more about location (code) than print char (key).\n    event.code = 'Button' + e.button;\n    event.event = 'pressed';\n    event.value = 1;\n    event.control = e.ctrlKey;\n    event.shift = e.shiftKey;\n    event.alt = e.altKey;\n\n    let result = this.dispatchInputEvent(event);\n    if (result) {\n      // Make sure it has focus first.\n      if (document.activeElement === this.eventTarget) {\n        e.preventDefault();\n        e.stopPropagation();\n        return false;\n      }\n    }\n  }\n\n  /**\n   * @private\n   * @param {MouseEvent} e\n   */\n  onContextMenu(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    return false;\n  }\n\n  /**\n   * @private\n   * @param {WheelEvent} e\n   */\n  onWheel(e) {\n    let dx, dy, dz;\n    switch (e.deltaMode) {\n      case WheelEvent.DOM_DELTA_LINE:\n        dx = e.deltaX * DEFAULT_LINE_PIXELS;\n        dy = e.deltaY * DEFAULT_LINE_PIXELS;\n        dz = e.deltaZ * DEFAULT_LINE_PIXELS;\n        break;\n      case WheelEvent.DOM_DELTA_PAGE:\n        dx = e.deltaX * DEFAULT_PAGE_PIXELS;\n        dy = e.deltaY * DEFAULT_PAGE_PIXELS;\n        dz = e.deltaZ * DEFAULT_PAGE_PIXELS;\n        break;\n      case WheelEvent.DOM_DELTA_PIXEL:\n      default:\n        dx = e.deltaX;\n        dy = e.deltaY;\n        dz = e.deltaZ;\n        break;\n    }\n\n    let result = 0;\n    let event = this._wheelObject;\n    event.code = 'WheelX';\n    event.movement = dx;\n    result |= this.dispatchInputEvent(event);\n    event.code = 'WheelY';\n    event.movement = dy;\n    result |= this.dispatchInputEvent(event);\n    event.code = 'WheelZ';\n    event.movement = dz;\n    result |= this.dispatchInputEvent(event);\n    if (result) {\n      e.preventDefault();\n      e.stopPropagation();\n      return false;\n    }\n  }\n\n  /**\n   * @private\n   * @param {MouseEvent} e\n   */\n  onMouseUp(e) {\n    // Make sure mouse down was pressed before this (with focus).\n    if (!this._downHasFocus) return;\n    this._downHasFocus = false;\n\n    let event = this._eventObject;\n    // We care more about location (code) than print char (key).\n    event.code = 'Button' + e.button;\n    event.event = 'released';\n    event.value = 1;\n    event.control = e.ctrlKey;\n    event.shift = e.shiftKey;\n    event.alt = e.altKey;\n\n    let result = this.dispatchInputEvent(event);\n    if (result) {\n      e.preventDefault();\n      e.stopPropagation();\n      return false;\n    }\n  }\n\n  /**\n   * @private\n   * @param {MouseEvent} e\n   */\n  onMouseMove(e) {\n    if (this.eventsOnFocus && document.activeElement !== this.eventTarget)\n      return;\n\n    const element = this.canvasTarget;\n    const { clientWidth, clientHeight } = element;\n    const rect = element.getBoundingClientRect();\n\n    let dx = e.movementX / clientWidth;\n    let dy = e.movementY / clientHeight;\n    let x = (e.clientX - rect.left) / clientWidth;\n    let y = (e.clientY - rect.top) / clientHeight;\n\n    let event = this._positionObject;\n    event.code = 'PosX';\n    event.value = x;\n    event.movement = dx;\n    this.dispatchInputEvent(event);\n    event.code = 'PosY';\n    event.value = y;\n    event.movement = dy;\n    this.dispatchInputEvent(event);\n  }\n\n  /** @private */\n  getCanvasFromEventTarget(eventTarget) {\n    if (eventTarget instanceof HTMLCanvasElement) {\n      return eventTarget;\n    } else {\n      return (\n        eventTarget.canvas ||\n        eventTarget.querySelector('canvas') ||\n        (eventTarget.shadowRoot &&\n          eventTarget.shadowRoot.querySelector('canvas')) ||\n        eventTarget\n      );\n    }\n  }\n}\n", "import INNER_HTML from './InputCode.template.html';\nimport INNER_STYLE from './InputCode.module.css';\n\nexport class InputCode extends HTMLElement {\n  /** @protected */\n  static get [Symbol.for('templateNode')]() {\n    let t = document.createElement('template');\n    t.innerHTML = INNER_HTML;\n    Object.defineProperty(this, Symbol.for('templateNode'), { value: t });\n    return t;\n  }\n\n  /** @protected */\n  static get [Symbol.for('styleNode')]() {\n    let t = document.createElement('style');\n    t.innerHTML = INNER_STYLE;\n    Object.defineProperty(this, Symbol.for('styleNode'), { value: t });\n    return t;\n  }\n\n  static define(customElements = window.customElements) {\n    customElements.define('input-code', this);\n  }\n\n  static get observedAttributes() {\n    return ['name', 'value', 'disabled'];\n  }\n\n  /** @returns {boolean} */\n  get disabled() {\n    return this._disabled;\n  }\n\n  set disabled(value) {\n    this.toggleAttribute('disabled', value);\n  }\n\n  /** @returns {string} */\n  get value() {\n    return this._value;\n  }\n\n  set value(value) {\n    this.setAttribute('value', value);\n  }\n\n  /** @returns {string} */\n  get name() {\n    return this._name;\n  }\n\n  set name(value) {\n    this.setAttribute('name', value);\n  }\n\n  constructor() {\n    super();\n    const c = this.constructor;\n    const shadowRoot = this.attachShadow({ mode: 'open' });\n    shadowRoot.appendChild(c[Symbol.for('templateNode')].content.cloneNode(true));\n    shadowRoot.appendChild(c[Symbol.for('styleNode')].cloneNode(true));\n\n    /** @private */\n    this._name = '';\n    /** @private */\n    this._value = '';\n    /** @private */\n    this._disabled = false;\n\n    /** @private */\n    this._kbdElement = shadowRoot.querySelector('kbd');\n    /** @private */\n    this._nameElement = shadowRoot.querySelector('#name');\n    /** @private */\n    this._valueElement = shadowRoot.querySelector('#value');\n  }\n\n  attributeChangedCallback(attribute, prev, value) {\n    switch (attribute) {\n      case 'name':\n        this._name = value;\n        this._nameElement.textContent = value;\n        break;\n      case 'value':\n        this._value = value;\n        if (value !== null) {\n          this._valueElement.classList.toggle('hidden', false);\n          this._valueElement.textContent = value;\n          this._kbdElement.style.paddingRight = `${this._valueElement.clientWidth + 4\n            }px`;\n        } else {\n          this._valueElement.classList.toggle('hidden', true);\n        }\n        break;\n      case 'disabled':\n        this._disabled = value !== null;\n        this._kbdElement.classList.toggle('disabled', value !== null);\n        break;\n    }\n  }\n\n  connectedCallback() {\n    if (Object.prototype.hasOwnProperty.call(this, 'name')) {\n      let value = this.name;\n      delete this.name;\n      this.name = value;\n    }\n\n    if (Object.prototype.hasOwnProperty.call(this, 'value')) {\n      let value = this.value;\n      delete this.value;\n      this.value = value;\n    }\n\n    if (Object.prototype.hasOwnProperty.call(this, 'disabled')) {\n      let value = this.disabled;\n      delete this.disabled;\n      this.disabled = value;\n    }\n  }\n}\nInputCode.define();\n", "/**\n * @callback OnPollCallback\n * @param {number} now\n *\n * @typedef Pollable\n * @property {OnPollCallback} onPoll\n */\n\n/**\n * A class to automatically call onPoll() on animation frame.\n */\nexport class AutoPoller {\n  /**\n   * @param {Pollable} pollable\n   */\n  constructor(pollable) {\n    /** @private */\n    this.onAnimationFrame = this.onAnimationFrame.bind(this);\n    /** @private */\n    this.animationFrameHandle = null;\n    /** @private */\n    this.pollable = pollable;\n  }\n\n  get running() {\n    return this.animationFrameHandle !== null;\n  }\n\n  start() {\n    let handle = this.animationFrameHandle;\n    if (handle) cancelAnimationFrame(handle);\n    this.animationFrameHandle = requestAnimationFrame(this.onAnimationFrame);\n  }\n\n  stop() {\n    let handle = this.animationFrameHandle;\n    if (handle) cancelAnimationFrame(handle);\n    this.animationFrameHandle = null;\n  }\n\n  /** @private */\n  onAnimationFrame(now) {\n    this.animationFrameHandle = requestAnimationFrame(this.onAnimationFrame);\n    this.pollable.onPoll(now);\n  }\n}\n", "/** @typedef {import('./InputBindings.js').InputBindings} InputBindings */\n\n/**\n * A class to listen and transform device events through\n * each mapped bindings into an input state.\n *\n * It requires onPoll() to be called to keep the input\n * state up to date. This is usually called from\n * requestAnimationFrame() or using the AutoPoller.\n */\nexport class DeviceInputAdapter {\n  /**\n   * @param {InputBindings} bindings\n   */\n  constructor(bindings) {\n    /** @private */\n    this.onInput = this.onInput.bind(this);\n    /** @private */\n    this.onPoll = this.onPoll.bind(this);\n\n    this.bindings = bindings;\n  }\n\n  /**\n   * @param {number} now \n   */\n  onPoll(now) {\n    for (let input of this.bindings.getInputs()) {\n      input.onPoll(now);\n    }\n  }\n  \n  onInput(e) {\n    const {\n      device,\n      code,\n      event,\n      value,\n      movement,\n      // eslint-disable-next-line no-unused-vars\n      control,\n      shift,\n      alt,\n    } = e;\n    let bindings = this.bindings.getBindings(device, code);\n    switch (event) {\n      case 'pressed':\n        for (let { input, index } of bindings) {\n          input.onUpdate(index, 1, 1);\n        }\n        break;\n      case 'released':\n        for (let { input, index } of bindings) {\n          input.onUpdate(index, 0, -1);\n        }\n        break;\n      case 'move':\n        for (let { input, index } of bindings) {\n          input.onUpdate(index, value, movement);\n        }\n        break;\n      case 'wheel':\n        for (let { input, index } of bindings) {\n          input.onUpdate(index, undefined, movement);\n        }\n        break;\n    }\n    return bindings.length > 0;\n  }\n}\n", "/**\n * @typedef {import('./state/InputState.js').InputState} InputState\n * @typedef {import('./state/InputState.js').BindingOptions} BindingOptions\n *\n * @typedef {string} DeviceName\n * @typedef {string} KeyCode\n */\n\nclass Binding {\n  /**\n   * @param {DeviceName} device The name of the device\n   * @param {KeyCode} code The key code for the device\n   * @param {InputState} input The parent input\n   * @param {number} index The binding index for the input\n   */\n  constructor(device, code, input, index) {\n    /** Name of the device */\n    this.device = device;\n    /** The key code for the device */\n    this.code = code;\n    /** The parent input */\n    this.input = input;\n    /** The binding index for the input */\n    this.index = index;\n  }\n}\n\n/**\n * A class that maps inputs to their respective key bindings.\n *\n * This does not handle input state (refer to InputState.js) nor\n * input events (refer to InputDevice.js). It is only responsible\n * for the redirection of key codes to their bound input. Usually\n * this is used together with the interfaces referenced above.\n */\nexport class InputBindings {\n  constructor() {\n    /**\n     * @private\n     * @type {Record<DeviceName, Record<KeyCode, Array<Binding>>>}\n     */\n    this.bindingMap = {};\n    /**\n     * @private\n     * @type {Map<InputState, Array<Binding>>}\n     */\n    this.inputMap = new Map();\n  }\n\n  clear() {\n    for (let input of this.inputMap.keys()) {\n      input.onUnbind();\n    }\n    this.inputMap.clear();\n    this.bindingMap = {};\n  }\n\n  /**\n   * @param {InputState} input\n   * @param {DeviceName} device\n   * @param {KeyCode} code\n   * @param {BindingOptions} [opts]\n   */\n  bind(input, device, code, opts = { inverted: false }) {\n    let binding;\n\n    let inputMap = this.inputMap;\n    if (inputMap.has(input)) {\n      let bindings = inputMap.get(input);\n      let index = input.size;\n      input.onBind(index, opts);\n      binding = new Binding(device, code, input, index);\n      bindings.push(binding);\n    } else {\n      let bindings = [];\n      inputMap.set(input, bindings);\n      let index = 0;\n      input.onBind(index, opts);\n      binding = new Binding(device, code, input, index);\n      bindings.push(binding);\n    }\n\n    let bindingMap = this.bindingMap;\n    if (device in bindingMap) {\n      if (code in bindingMap[device]) {\n        bindingMap[device][code].push(binding);\n      } else {\n        bindingMap[device][code] = [binding];\n      }\n    } else {\n      bindingMap[device] = { [code]: [binding] };\n    }\n  }\n\n  /**\n   * @param {InputState} input\n   */\n  unbind(input) {\n    let inputMap = this.inputMap;\n    if (inputMap.has(input)) {\n      let bindingMap = this.bindingMap;\n      let bindings = inputMap.get(input);\n      for (let binding of bindings) {\n        let { device, code } = binding;\n        let boundList = bindingMap[device][code];\n        let i = boundList.indexOf(binding);\n        boundList.splice(i, 1);\n      }\n      bindings.length = 0;\n      input.onUnbind();\n      inputMap.delete(input);\n    }\n  }\n\n  /**\n   * @param {InputState} input\n   * @returns {boolean}\n   */\n  isBound(input) {\n    return this.inputMap.has(input);\n  }\n\n  /** @returns {Iterable<InputState>} */\n  getInputs() {\n    return this.inputMap.keys();\n  }\n\n  /** @returns {Iterable<Binding>} */\n  getBindingsByInput(input) {\n    return this.inputMap.get(input);\n  }\n\n  /**\n   * @param {DeviceName} device\n   * @param {KeyCode} code\n   * @returns {Array<Binding>}\n   */\n  getBindings(device, code) {\n    let deviceCodeBindings = this.bindingMap;\n    if (device in deviceCodeBindings) {\n      let codeBindings = deviceCodeBindings[device];\n      if (code in codeBindings) {\n        return codeBindings[code];\n      }\n    }\n    return [];\n  }\n}\n", "import { AutoPoller } from './AutoPoller.js';\nimport { AxisState } from './state/AxisState.js';\nimport { ButtonState } from './state/ButtonState.js';\nimport { KeyboardDevice } from './device/KeyboardDevice.js';\nimport { MouseDevice } from './device/MouseDevice.js';\nimport { DeviceInputAdapter } from './DeviceInputAdapter.js';\nimport { InputBindings } from './InputBindings.js';\n\n/**\n * @typedef {import('./device/InputDevice.js').InputDevice} InputDevice\n * @typedef {import('./device/InputDevice.js').InputDeviceEvent} InputDeviceEvent\n * @typedef {import('./state/InputState.js').InputState} InputState\n * @typedef {import('./InputBindings.js').DeviceName} DeviceName\n * @typedef {import('./InputBindings.js').KeyCode} KeyCode\n * @typedef {import('./InputBindings.js').BindingOptions} BindingOptions\n *\n * @typedef {import('./binding/InputBinding.js').InputBinding} InputBinding\n */\n\n/**\n * @typedef {string} InputName\n * \n * @typedef {'bind'|'unbind'|'focus'|'blur'} InputContextEventType\n * @typedef {(e: InputContextEvent) => boolean} InputContextEventListener\n * \n * @typedef InputContextEvent\n * @property {InputContextEventType} type\n */\n\nexport class InputContext {\n  /**\n   * @param {EventTarget} eventTarget\n   * @param {object} [opts]\n   */\n  constructor(eventTarget, opts = undefined) {\n    /**\n     * @type {Record<string, AxisState|ButtonState>}\n     */\n    this.inputs = {};\n    /**\n     * @type {Array<InputDevice>}\n     */\n    this.devices = [\n      new MouseDevice('Mouse', eventTarget),\n      new KeyboardDevice('Keyboard', eventTarget),\n    ];\n    this.bindings = new InputBindings();\n    this.adapter = new DeviceInputAdapter(this.bindings);\n    this.autopoller = new AutoPoller(this.adapter);\n\n    /** @protected */\n    this.eventTarget = eventTarget;\n    /** @protected */\n    this.anyButton = new ButtonState(1);\n    /** @protected */\n    this.anyButtonDevice = '';\n    /** @protected */\n    this.anyButtonCode = '';\n    /** @protected */\n    this.anyAxis = new AxisState(1);\n    /** @protected */\n    this.anyAxisDevice = '';\n    /** @protected */\n    this.anyAxisCode = '';\n\n    /**\n     * @private\n     * @type {Record<InputContextEventType, Array<InputContextEventListener>>}\n     */\n    this.listeners = {\n      bind: [],\n      unbind: [],\n      focus: [],\n      blur: [],\n    };\n\n    // Prepare listeners\n    /** @private */\n    this.onInput = this.onInput.bind(this);\n    /** @private */\n    this.onEventTargetBlur = this.onEventTargetBlur.bind(this);\n    /** @private */\n    this.onEventTargetFocus = this.onEventTargetFocus.bind(this);\n\n    // Attach listeners\n    eventTarget.addEventListener('focus', this.onEventTargetFocus);\n    eventTarget.addEventListener('blur', this.onEventTargetBlur);\n    for (let device of this.devices) {\n      device.addEventListener('input', this.onInput);\n    }\n  }\n\n  get autopoll() {\n    return this.autopoller.running;\n  }\n\n  set autopoll(value) {\n    this.toggleAutoPoll(value);\n  }\n\n  destroy() {\n    let listeners = this.listeners;\n    for (let event in listeners) {\n      listeners[event].length = 0;\n    }\n    if (this.autopoller.running) {\n      this.autopoller.stop();\n    }\n    for (let device of this.devices) {\n      device.removeEventListener('input', this.onInput);\n      device.destroy();\n    }\n    let eventTarget = this.eventTarget;\n    eventTarget.removeEventListener('focus', this.onEventTargetFocus);\n    eventTarget.removeEventListener('blur', this.onEventTargetBlur);\n  }\n\n  setEventTarget(eventTarget) {\n    let oldEventTarget = this.eventTarget;\n    oldEventTarget.removeEventListener('focus', this.onEventTargetFocus);\n    oldEventTarget.removeEventListener('blur', this.onEventTargetBlur);\n\n    this.eventTarget = eventTarget;\n    for (let device of this.devices) {\n      device.setEventTarget(eventTarget);\n    }\n    eventTarget.addEventListener('focus', this.onEventTargetFocus);\n    eventTarget.addEventListener('blur', this.onEventTargetBlur);\n  }\n\n  toggleAutoPoll(force = undefined) {\n    let current = this.autopoller.running;\n    let next = typeof force === 'undefined' ? !current : Boolean(force);\n    if (next === current) return;\n    if (next) {\n      this.autopoller.start();\n    } else {\n      this.autopoller.stop();\n    }\n  }\n\n  /**\n   * @param {InputContextEventType} event\n   * @param {InputContextEventListener} listener\n   */\n  addEventListener(event, listener) {\n    let listeners = this.listeners;\n    if (event in listeners) {\n      listeners[event].push(listener);\n    } else {\n      listeners[event] = [listener];\n    }\n  }\n\n  /**\n   * @param {InputContextEventType} event\n   * @param {InputContextEventListener} listener\n   */\n  removeEventListener(event, listener) {\n    let listeners = this.listeners;\n    if (event in listeners) {\n      let list = listeners[event];\n      let i = list.indexOf(listener);\n      if (i >= 0) {\n        list.splice(i, 1);\n      }\n    }\n  }\n\n  /**\n   * @param {InputContextEvent} e\n   * @returns {boolean} Whether the event should be consumed.\n   */\n  dispatchEvent(e) {\n    const { type } = e;\n    let flag = 0;\n    for (let listener of this.listeners[type]) {\n      flag |= listener(e) ? 1 : 0;\n    }\n    return Boolean(flag);\n  }\n\n  /**\n   * @param {number} now\n   */\n  poll(now = performance.now()) {\n    if (this.autopoller.running) {\n      throw new Error('Should not manually poll() while autopolling.');\n    }\n    this.onPoll(now);\n  }\n\n  /**\n   * @private\n   * @param {InputDeviceEvent} e\n   */\n  onInput(e) {\n    let result = this.adapter.onInput(e);\n    switch (e.event) {\n      case 'pressed':\n        this.anyButtonDevice = e.device;\n        this.anyButtonCode = e.code;\n        this.anyButton.onUpdate(0, 1, 1);\n        break;\n      case 'released':\n        this.anyButtonDevice = e.device;\n        this.anyButtonCode = e.code;\n        this.anyButton.onUpdate(0, 0, -1);\n        break;\n      case 'move':\n      case 'wheel':\n        this.anyAxisDevice = e.device;\n        this.anyAxisCode = e.code;\n        this.anyAxis.onUpdate(0, e.value, e.movement);\n        break;\n    }\n    return result;\n  }\n\n  /**\n   * @private\n   * @param {number} now\n   */\n  onPoll(now) {\n    this.adapter.onPoll(now);\n    this.anyButton.onPoll(now);\n    this.anyAxis.onPoll(now);\n  }\n\n  /** @private */\n  onBind() {\n    this.dispatchEvent({\n      type: 'bind',\n    });\n  }\n\n  /** @private */\n  onUnbind() {\n    this.dispatchEvent({\n      type: 'unbind',\n    });\n  }\n\n  /** @private */\n  onEventTargetFocus() {\n    this.dispatchEvent({\n      type: 'focus',\n    });\n  }\n\n  /** @private */\n  onEventTargetBlur() {\n    // Clear all input states.\n    for (let input of this.bindings.getInputs()) {\n      input.onStatus(0, 0);\n    }\n    this.anyButton.onStatus(0, 0);\n    this.anyAxis.onStatus(0, 0);\n    this.dispatchEvent({\n      type: 'blur',\n    });\n  }\n\n  /**\n   * @param {Array<InputBinding>|Record<string, InputBinding>} bindings\n   */\n  bindBindings(bindings) {\n    if (!Array.isArray(bindings)) {\n      bindings = Object.values(bindings);\n    }\n    for (let binding of bindings) {\n      binding.bindTo(this);\n    }\n  }\n\n  /**\n   * @param {InputBinding} binding\n   */\n  bindBinding(binding) {\n    binding.bindTo(this);\n  }\n\n  /**\n   * @param {InputName} name\n   * @param {DeviceName} device\n   * @param {KeyCode} code\n   * @param {BindingOptions} [opts]\n   */\n  bindButton(name, device, code, opts = undefined) {\n    let input;\n    if (this.hasButton(name)) {\n      input = this.getButton(name);\n    } else {\n      input = new ButtonState(1);\n      this.inputs[name] = input;\n    }\n    this.bindings.bind(input, device, code, opts);\n    this.onBind();\n  }\n\n  /**\n   * @param {string} name\n   * @param {DeviceName} device\n   * @param {KeyCode} code\n   * @param {BindingOptions} [opts]\n   */\n  bindAxis(name, device, code, opts = undefined) {\n    let input;\n    if (this.hasAxis(name)) {\n      input = this.getAxis(name);\n    } else {\n      input = new AxisState(1);\n      this.inputs[name] = input;\n    }\n    this.bindings.bind(input, device, code, opts);\n    this.onBind();\n  }\n\n  /**\n   * @param {string} name\n   * @param {DeviceName} device\n   * @param {KeyCode} negativeCode\n   * @param {KeyCode} positiveCode\n   */\n  bindAxisButtons(name, device, negativeCode, positiveCode) {\n    let input;\n    if (this.hasAxis(name)) {\n      input = this.getAxis(name);\n    } else {\n      input = new AxisState(2);\n      this.inputs[name] = input;\n    }\n    this.bindings.bind(input, device, positiveCode);\n    this.bindings.bind(input, device, negativeCode, { inverted: true });\n    this.onBind();\n  }\n\n  /**\n   * @param {string} name\n   */\n  unbindButton(name) {\n    if (this.hasButton(name)) {\n      let input = this.getButton(name);\n      delete this.inputs[name];\n      this.bindings.unbind(input);\n      this.onUnbind();\n    }\n  }\n\n  /**\n   * @param {string} name\n   */\n  unbindAxis(name) {\n    if (this.hasAxis(name)) {\n      let input = this.getAxis(name);\n      delete this.inputs[name];\n      this.bindings.unbind(input);\n      this.onUnbind();\n    }\n  }\n\n  /**\n   * Get the input for the given name. Assumes the input already exists for the name.\n   * @param {InputName} name\n   * @returns {InputState}\n   */\n  getInput(name) {\n    return this.inputs[name];\n  }\n\n  /**\n   * Get the button for the given name. Assumes a button already exists for the name.\n   * @param {InputName} name\n   * @returns {ButtonState}\n   */\n  getButton(name) {\n    return /** @type {ButtonState} */ (this.inputs[name]);\n  }\n\n  /**\n   * Get the axis for the given name. Assumes an axis already exists for the name.\n   * @param {InputName} name\n   * @returns {AxisState}\n   */\n  getAxis(name) {\n    return /** @type {AxisState} */ (this.inputs[name]);\n  }\n\n  /**\n   * Whether a button exists for the name and that it is of type {@link Button}.\n   * @returns {boolean}\n   */\n  hasButton(name) {\n    return name in this.inputs && this.inputs[name] instanceof ButtonState;\n  }\n\n  /**\n   * Whether an axis exists for the name and that it is of type {@link Axis}.\n   * @returns {boolean}\n   */\n  hasAxis(name) {\n    return name in this.inputs && this.inputs[name] instanceof AxisState;\n  }\n\n  /**\n   * Get whether a button for the given name is down. Assumes a button already exists for the name.\n   * @param {InputName} name\n   * @returns {boolean}\n   */\n  isButtonDown(name) {\n    return /** @type {ButtonState} */ (this.inputs[name]).down;\n  }\n\n  /**\n   * Get whether a button for the given name is pressed. Assumes a button already exists for the name.\n   * @param {InputName} name\n   * @returns {boolean}\n   */\n  isButtonPressed(name) {\n    return /** @type {ButtonState} */ (this.inputs[name]).pressed;\n  }\n\n  /**\n   * Get whether a button for the given name is released. Assumes a button already exists for the name.\n   * @param {InputName} name\n   * @returns {boolean}\n   */\n  isButtonReleased(name) {\n    return /** @type {ButtonState} */ (this.inputs[name]).released;\n  }\n\n  /**\n   * @param {InputName} name\n   * @returns {number}\n   */\n  getInputValue(name) {\n    return this.inputs[name].value;\n  }\n\n  /**\n   * @param {InputName} name\n   * @returns {number}\n   */\n  getButtonValue(name) {\n    return this.inputs[name].value;\n  }\n\n  /**\n   * @param {InputName} name\n   * @returns {number}\n   */\n  getAxisValue(name) {\n    return this.inputs[name].value;\n  }\n\n  /**\n   * @param {InputName} name\n   * @returns {number}\n   */\n  getAxisDelta(name) {\n    return /** @type {AxisState} */ (this.inputs[name]).delta;\n  }\n\n  /** @returns {boolean} */\n  isAnyButtonDown(include = undefined) {\n    if (typeof include === 'undefined') {\n      return this.anyButton.down;\n    } else {\n      let buttons = this.inputs;\n      for (let name of include) {\n        let button = /** @type {ButtonState} */ (buttons[name]);\n        if (button.down) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  /** @returns {boolean} */\n  isAnyButtonPressed(include = undefined) {\n    if (typeof include === 'undefined') {\n      return this.anyButton.pressed;\n    } else {\n      let buttons = this.inputs;\n      for (let name of include) {\n        let button = /** @type {ButtonState} */ (buttons[name]);\n        if (button.pressed) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  /** @returns {boolean} */\n  isAnyButtonReleased(include = undefined) {\n    if (typeof include === 'undefined') {\n      return this.anyButton.released;\n    } else {\n      let buttons = this.inputs;\n      for (let name of include) {\n        let button = /** @type {ButtonState} */ (buttons[name]);\n        if (button.released) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  /** @returns {number} */\n  getAnyAxisValue(include = undefined) {\n    if (typeof include === 'undefined') {\n      return this.anyAxis.value;\n    } else {\n      let axes = this.inputs;\n      for (let name of include) {\n        let axis = axes[name];\n        if (axis.value) {\n          return axis.value;\n        }\n      }\n    }\n    return 0;\n  }\n\n  /** @returns {number} */\n  getAnyAxisDelta(include = undefined) {\n    if (typeof include === 'undefined') {\n      return this.anyAxis.delta;\n    } else {\n      let axes = this.inputs;\n      for (let name of include) {\n        let axis = /** @type {AxisState} */ (axes[name]);\n        if (axis.delta) {\n          return axis.delta;\n        }\n      }\n    }\n    return 0;\n  }\n\n  getLastButtonDevice() {\n    return this.anyButtonDevice;\n  }\n\n  getLastButtonCode() {\n    return this.anyButtonCode;\n  }\n\n  getLastAxisDevice() {\n    return this.anyAxisDevice;\n  }\n\n  getLastAxisCode() {\n    return this.anyAxisCode;\n  }\n\n  getMouse() {\n    return /** @type {MouseDevice}*/ (this.devices[0]);\n  }\n\n  getKeyboard() {\n    return /** @type {KeyboardDevice}*/ (this.devices[1]);\n  }\n}\n", "import INNER_HTML from './InputPort.template.html';\nimport INNER_STYLE from './InputPort.module.css';\n\nimport { InputCode } from '../inputcode/InputCode.js';\nimport { InputContext } from '../InputContext';\n\n/**\n * @typedef {import('../device/InputDevice.js').InputDevice} InputDevice\n * @typedef {import('../device/InputDevice.js').InputDeviceEvent} InputDeviceEvent\n * @typedef {import('../InputBindings.js').DeviceName} DeviceName\n * @typedef {import('../InputBindings.js').KeyCode} KeyCode\n * @typedef {import('../InputBindings.js').BindingOptions} BindingOptions\n * @typedef {import('../InputContext').InputName} InputName\n */\n\nexport class InputPort extends HTMLElement {\n\n  /**\n   * @param {object} [opts]\n   * @param {HTMLElement} [opts.root]\n   * @param {string} [opts.for]\n   * @param {boolean} [opts.autopoll]\n   */\n  static create(opts = {}) {\n    const {\n      root = document.body,\n      for: forId = undefined,\n      autopoll = false,\n    } = opts || {};\n    let result = new InputPort();\n    result.for = forId;\n    result.autopoll = autopoll;\n    root.appendChild(result);\n    return result;\n  }\n\n  /** @protected */\n  static get [Symbol.for('templateNode')]() {\n    let t = document.createElement('template');\n    t.innerHTML = INNER_HTML;\n    Object.defineProperty(this, Symbol.for('templateNode'), { value: t });\n    return t;\n  }\n\n  /** @protected */\n  static get [Symbol.for('styleNode')]() {\n    let t = document.createElement('style');\n    t.innerHTML = INNER_STYLE;\n    Object.defineProperty(this, Symbol.for('styleNode'), { value: t });\n    return t;\n  }\n\n  static define(customElements = window.customElements) {\n    customElements.define('input-port', this);\n  }\n\n  static get observedAttributes() {\n    return ['autopoll', 'for'];\n  }\n\n  /** @returns {boolean} */\n  get autopoll() {\n    return this._autopoll;\n  }\n\n  set autopoll(value) {\n    this.toggleAttribute('autopoll', value);\n  }\n\n  /** @returns {string} */\n  get for() {\n    return this._for;\n  }\n\n  set for(value) {\n    this.setAttribute('for', value);\n  }\n\n  constructor() {\n    super();\n    const shadowRoot = this.attachShadow({ mode: 'open' });\n    shadowRoot.appendChild(\n      this.constructor[Symbol.for('templateNode')].content.cloneNode(true)\n    );\n    shadowRoot.appendChild(\n      this.constructor[Symbol.for('styleNode')].cloneNode(true)\n    );\n\n    /** @private */\n    this._titleElement = shadowRoot.querySelector('#title');\n    /** @private */\n    this._pollElement = shadowRoot.querySelector('#poll');\n    /** @private */\n    this._focusElement = shadowRoot.querySelector('#focus');\n    /** @private */\n    this._bodyElement = shadowRoot.querySelector('tbody');\n    /** @private */\n    this._outputElements = {};\n\n    /** @private */\n    this.onAnimationFrame = this.onAnimationFrame.bind(this);\n    /** @private */\n    this.animationFrameHandle = null;\n\n    const eventTarget = this;\n    /** @private */\n    this._for = '';\n    /**\n     * @private\n     * @type {HTMLElement}\n     */\n    this._eventTarget = eventTarget;\n    /** @private */\n    this._autopoll = false;\n\n    /** @private */\n    this._context = null;\n\n    /** @private */\n    this.onInputContextBind = this.onInputContextBind.bind(this);\n    /** @private */\n    this.onInputContextUnbind = this.onInputContextUnbind.bind(this);\n    /** @private */\n    this.onInputContextFocus = this.onInputContextFocus.bind(this);\n    /** @private */\n    this.onInputContextBlur = this.onInputContextBlur.bind(this);\n  }\n\n  connectedCallback() {\n    if (Object.prototype.hasOwnProperty.call(this, 'for')) {\n      let value = this.for;\n      delete this.for;\n      this.for = value;\n    }\n\n    if (Object.prototype.hasOwnProperty.call(this, 'autopoll')) {\n      let value = this.autopoll;\n      delete this.autopoll;\n      this.autopoll = value;\n    }\n\n    // Make sure the table and values are up to date\n    this.updateTable();\n    this.updateTableValues();\n    this.animationFrameHandle = window.requestAnimationFrame(this.onAnimationFrame);\n  }\n\n  disconnectedCallback() {\n    let ctx = this._context;\n    if (ctx) {\n      ctx.removeEventListener('bind', this.onInputContextBind);\n      ctx.removeEventListener('unbind', this.onInputContextUnbind);\n      ctx.removeEventListener('blur', this.onInputContextBlur);\n      ctx.removeEventListener('focus', this.onInputContextFocus);\n      ctx.destroy();\n      this._context = null;\n    }\n  }\n  \n  attributeChangedCallback(attribute, prev, value) {\n    switch (attribute) {\n      case 'for': {\n        this._for = value;\n        let target;\n        let name;\n        if (value) {\n          target = document.getElementById(value);\n          name = `${target.tagName.toLowerCase()}#${value}`;\n        } else {\n          target = this;\n          name = 'input-port';\n        }\n        this._eventTarget = target;\n        if (this._context) {\n          this._context.setEventTarget(this._eventTarget);\n        }\n        // For debug info\n        this._titleElement.innerHTML = `for ${name}`;\n      }\n        break;\n      case 'autopoll':\n        this._autopoll = value !== null;\n        if (this._context) {\n          this._context.toggleAutoPoll(this._autopoll);\n        }\n        break;\n    }\n  }\n\n  /** @private */\n  onAnimationFrame() {\n    this.animationFrameHandle = window.requestAnimationFrame(this.onAnimationFrame);\n    this.updateTableValues();\n    this.updatePollStatus();\n  }\n\n  /** @private */\n  onInputContextBind() {\n    this.updateTable();\n    return true;\n  }\n\n  /** @private */\n  onInputContextUnbind() {\n    this.updateTable();\n    return true;\n  }\n\n  /** @private */\n  onInputContextFocus() {\n    this._focusElement.innerHTML = '\u2713';\n    return true;\n  }\n\n  /** @private */\n  onInputContextBlur() {\n    this._focusElement.innerHTML = '';\n    return true;\n  }\n\n  /**\n   * @param {'axisbutton'} [contextId]\n   * @param {object} [options]\n   * @returns {InputContext}\n   */\n  getContext(contextId = 'axisbutton', options = undefined) {\n    switch (contextId) {\n      case 'axisbutton':\n        if (!this._context) {\n          let ctx = new InputContext(this._eventTarget, options);\n          ctx.addEventListener('bind', this.onInputContextBind);\n          ctx.addEventListener('unbind', this.onInputContextUnbind);\n          ctx.addEventListener('blur', this.onInputContextBlur);\n          ctx.addEventListener('focus', this.onInputContextFocus);\n          if (this._autopoll) {\n            ctx.toggleAutoPoll(true);\n          }\n          this._context = ctx;\n        }\n        return this._context;\n      default:\n        throw new Error(`Input context id '${contextId}' is not supported.`);\n    }\n  }\n\n  /** @private */\n  updateTable() {\n    if (!this.isConnected) {\n      // Don't update the DOM if not connected to any :(\n      return;\n    } else if (!this._context) {\n      // Clear all values if no context is available\n      this._outputElements = {};\n      this._bodyElement.innerHTML = '';\n      return;\n    } else {\n      let context = this._context;\n      let inputs = context.inputs;\n      let bindings = context.bindings;\n      let primaryElements = {};\n      let entries = [];\n      for (let name of Object.keys(inputs)) {\n        let input = inputs[name];\n        let primary = true;\n        for (let binding of bindings.getBindingsByInput(input)) {\n          let element = createInputTableEntry(\n            `${input.constructor.name}.${name}`,\n            `${binding.device}.${binding.code}`,\n            0,\n            primary\n          );\n          entries.push(element);\n          if (primary) {\n            primaryElements[name] = element.querySelector('output');\n            primary = false;\n          }\n        }\n      }\n      this._outputElements = primaryElements;\n      this._bodyElement.innerHTML = '';\n      for (let entry of entries) {\n        this._bodyElement.appendChild(entry);\n      }\n    }\n  }\n\n  /** @private */\n  updateTableValues() {\n    if (!this.isConnected) {\n      // Don't update the DOM if not connected to any :(\n      return;\n    } else if (!this._context) {\n      // Clear all values if no context is available\n      for (let name of Object.keys(this._outputElements)) {\n        let element = this._outputElements[name];\n        element.innerText = '---';\n      }\n      return;\n    } else {\n      let context = this._context;\n      let inputs = context.inputs;\n      for (let name of Object.keys(this._outputElements)) {\n        let element = this._outputElements[name];\n        let value = inputs[name].value;\n        element.innerText = Number(value).toFixed(2);\n      }\n    }\n  }\n\n  /** @private */\n  updatePollStatus() {\n    if (!this.isConnected) {\n      // Don't update the DOM if not connected to any :(\n      return;\n    } else if (!this._context) {\n      // Clear all values if no context is available\n      this._pollElement.innerHTML = '-';\n      return;\n    } else {\n      let context = this._context;\n      let inputs = context.inputs;\n      for (let input of Object.values(inputs)) {\n        if (!input.polling) {\n          this._pollElement.innerHTML = '';\n          return;\n        }\n      }\n      this._pollElement.innerHTML = '\u2713';\n    }\n  }\n}\nInputPort.define();\n\nfunction createInputTableEntry(name, key, value, primary = true) {\n  let row = document.createElement('tr');\n  if (primary) {\n    row.classList.add('primary');\n  }\n  // Name\n  {\n    let data = document.createElement('td');\n    data.textContent = name;\n    data.classList.add('name');\n    row.appendChild(data);\n  }\n  // Value\n  {\n    let data = document.createElement('td');\n    let output = document.createElement('output');\n    if (primary) {\n      output.innerText = Number(value).toFixed(2);\n    } else {\n      output.innerText = '---';\n    }\n    output.classList.add('value');\n    data.appendChild(output);\n    row.appendChild(data);\n  }\n  // Key\n  {\n    let data = document.createElement('td');\n    data.classList.add('key');\n    let kbd = new InputCode();\n    kbd.innerText = key;\n    data.appendChild(kbd);\n    row.appendChild(data);\n  }\n  return row;\n}\n", "import { ButtonState } from './state/ButtonState.js';\nimport { KeyboardDevice } from './device/KeyboardDevice.js';\nimport { InputBindings } from './InputBindings.js';\nimport { AutoPoller } from './AutoPoller.js';\nimport { DeviceInputAdapter } from './DeviceInputAdapter.js';\nimport { KEYBOARD } from './keycode/KeyCodes.js';\n\n/**\n * @typedef {import('./state/ButtonState.js').ButtonReadOnly} ButtonReadOnly\n */\n\nconst KEYBOARD_SOURCE = Symbol('keyboardSource');\nexport class Keyboard {\n  constructor(eventTarget, opts) {\n    /** @type {ButtonReadOnly} */\n    this.KeyA = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.KeyB = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.KeyC = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.KeyD = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.KeyE = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.KeyF = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.KeyG = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.KeyH = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.KeyI = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.KeyJ = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.KeyK = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.KeyL = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.KeyM = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.KeyN = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.KeyO = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.KeyP = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.KeyQ = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.KeyR = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.KeyS = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.KeyT = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.KeyU = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.KeyV = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.KeyW = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.KeyX = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.KeyY = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.KeyZ = new ButtonState();\n\n    /** @type {ButtonReadOnly} */\n    this.Digit0 = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.Digit1 = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.Digit2 = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.Digit3 = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.Digit4 = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.Digit5 = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.Digit6 = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.Digit7 = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.Digit8 = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.Digit9 = new ButtonState();\n\n    /** @type {ButtonReadOnly} */\n    this.Minus = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.Equal = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.BracketLeft = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.BracketRight = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.Semicolon = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.Quote = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.Backquote = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.Backslash = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.Comma = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.Period = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.Slash = new ButtonState();\n\n    /** @type {ButtonReadOnly} */\n    this.Escape = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.Space = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.CapsLock = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.Backspace = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.Delete = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.Tab = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.Enter = new ButtonState();\n\n    /** @type {ButtonReadOnly} */\n    this.ArrowUp = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.ArrowDown = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.ArrowLeft = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.ArrowRight = new ButtonState();\n\n    const deviceName = KEYBOARD;\n    const device = new KeyboardDevice(deviceName, eventTarget, opts);\n    const bindings = new InputBindings();\n    for (let key in this) {\n      if (Object.prototype.hasOwnProperty.call(this, key)) {\n        let input = /** @type {ButtonState} */ (this[key]);\n        bindings.bind(input, deviceName, key);\n      }\n    }\n    const adapter = new DeviceInputAdapter(bindings);\n    // @ts-ignore\n    device.addEventListener('input', adapter.onInput);\n    // @ts-ignore\n    const autopoller = new AutoPoller(adapter);\n    autopoller.start();\n    this[KEYBOARD_SOURCE] = {\n      device,\n      bindings,\n      adapter,\n      autopoller,\n    };\n  }\n\n  destroy() {\n    const source = this[KEYBOARD_SOURCE];\n    source.autopoller.stop();\n    // @ts-ignore\n    source.device.removeEventListener('input', source.adapter.onInput);\n    source.device.destroy();\n    source.bindings.clear();\n  }\n}\n", "import { AxisState } from './state/AxisState.js';\nimport { ButtonState } from './state/ButtonState.js';\nimport { MouseDevice } from './device/MouseDevice.js';\nimport { InputBindings } from './InputBindings.js';\nimport { DeviceInputAdapter } from './DeviceInputAdapter.js';\nimport { AutoPoller } from './AutoPoller.js';\nimport { MOUSE } from './keycode/KeyCodes.js';\n\n/**\n * @typedef {import('./state/AxisState.js').AxisReadOnly} AxisReadOnly\n * @typedef {import('./state/ButtonState.js').ButtonReadOnly} ButtonReadOnly\n */\n\nconst MOUSE_SOURCE = Symbol('mouseSource');\nexport class Mouse {\n  constructor(eventTarget, opts) {\n    /** @type {AxisReadOnly} */\n    this.PosX = new AxisState();\n    /** @type {AxisReadOnly} */\n    this.PosY = new AxisState();\n\n    /** @type {AxisReadOnly} */\n    this.WheelX = new AxisState();\n    /** @type {AxisReadOnly} */\n    this.WheelY = new AxisState();\n    /** @type {AxisReadOnly} */\n    this.WheelZ = new AxisState();\n\n    /** @type {ButtonReadOnly} */\n    this.Button0 = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.Button1 = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.Button2 = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.Button3 = new ButtonState();\n    /** @type {ButtonReadOnly} */\n    this.Button4 = new ButtonState();\n\n    const deviceName = MOUSE;\n    const device = new MouseDevice(deviceName, eventTarget, opts);\n    const bindings = new InputBindings();\n    for (let key in this) {\n      if (Object.prototype.hasOwnProperty.call(this, key)) {\n        let input = /** @type {AxisState|ButtonState} */ (this[key]);\n        bindings.bind(input, deviceName, key);\n      }\n    }\n    const adapter = new DeviceInputAdapter(bindings);\n    device.addEventListener('input', adapter.onInput);\n    const autopoller = new AutoPoller(adapter);\n    autopoller.start();\n    this[MOUSE_SOURCE] = {\n      device,\n      bindings,\n      adapter,\n      autopoller,\n    };\n  }\n\n  destroy() {\n    const source = this[MOUSE_SOURCE];\n    source.autopoller.stop();\n    source.device.removeEventListener('input', source.adapter.onInput);\n    source.device.destroy();\n    source.bindings.clear();\n  }\n}\n", "window.addEventListener('error', error, true);\nwindow.addEventListener('unhandledrejection', error, true);\n\nexport function error(e) {\n  if (typeof e === 'object') {\n    if (e instanceof PromiseRejectionEvent) {\n      error(e.reason);\n    } else if (e instanceof ErrorEvent) {\n      error(e.error);\n    } else if (e instanceof Error) {\n      window.alert(e.stack);\n    } else {\n      window.alert(JSON.stringify(e));\n    }\n  } else {\n    window.alert(e);\n  }\n}\n", "// DEFLATE is a complex format; to read this code, you should probably check the RFC first:\n// https://tools.ietf.org/html/rfc1951\n// You may also wish to take a look at the guide I made about this program:\n// https://gist.github.com/101arrowz/253f31eb5abc3d9275ab943003ffecad\n// Some of the following code is similar to that of UZIP.js:\n// https://github.com/photopea/UZIP.js\n// However, the vast majority of the codebase has diverged from UZIP.js to increase performance and reduce bundle size.\n// Sometimes 0 will appear where -1 would be more appropriate. This is because using a uint\n// is better for memory in most engines (I *think*).\nvar ch2 = {};\nvar wk = (function (c, id, msg, transfer, cb) {\n    var w = new Worker(ch2[id] || (ch2[id] = URL.createObjectURL(new Blob([\n        c + ';addEventListener(\"error\",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'\n    ], { type: 'text/javascript' }))));\n    w.onmessage = function (e) {\n        var d = e.data, ed = d.$e$;\n        if (ed) {\n            var err = new Error(ed[0]);\n            err['code'] = ed[1];\n            err.stack = ed[2];\n            cb(err, null);\n        }\n        else\n            cb(null, d);\n    };\n    w.postMessage(msg, transfer);\n    return w;\n});\n\n// aliases for shorter compressed code (most minifers don't do this)\nvar u8 = Uint8Array, u16 = Uint16Array, u32 = Uint32Array;\n// fixed length extra bits\nvar fleb = new u8([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, /* unused */ 0, 0, /* impossible */ 0]);\n// fixed distance extra bits\n// see fleb note\nvar fdeb = new u8([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, /* unused */ 0, 0]);\n// code length index map\nvar clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\n// get base, reverse index map from extra bits\nvar freb = function (eb, start) {\n    var b = new u16(31);\n    for (var i = 0; i < 31; ++i) {\n        b[i] = start += 1 << eb[i - 1];\n    }\n    // numbers here are at max 18 bits\n    var r = new u32(b[30]);\n    for (var i = 1; i < 30; ++i) {\n        for (var j = b[i]; j < b[i + 1]; ++j) {\n            r[j] = ((j - b[i]) << 5) | i;\n        }\n    }\n    return [b, r];\n};\nvar _a = freb(fleb, 2), fl = _a[0], revfl = _a[1];\n// we can ignore the fact that the other numbers are wrong; they never happen anyway\nfl[28] = 258, revfl[258] = 28;\nvar _b = freb(fdeb, 0), fd = _b[0], revfd = _b[1];\n// map of value to reverse (assuming 16 bits)\nvar rev = new u16(32768);\nfor (var i = 0; i < 32768; ++i) {\n    // reverse table algorithm from SO\n    var x = ((i & 0xAAAA) >>> 1) | ((i & 0x5555) << 1);\n    x = ((x & 0xCCCC) >>> 2) | ((x & 0x3333) << 2);\n    x = ((x & 0xF0F0) >>> 4) | ((x & 0x0F0F) << 4);\n    rev[i] = (((x & 0xFF00) >>> 8) | ((x & 0x00FF) << 8)) >>> 1;\n}\n// create huffman tree from u8 \"map\": index -> code length for code index\n// mb (max bits) must be at most 15\n// TODO: optimize/split up?\nvar hMap = (function (cd, mb, r) {\n    var s = cd.length;\n    // index\n    var i = 0;\n    // u16 \"map\": index -> # of codes with bit length = index\n    var l = new u16(mb);\n    // length of cd must be 288 (total # of codes)\n    for (; i < s; ++i) {\n        if (cd[i])\n            ++l[cd[i] - 1];\n    }\n    // u16 \"map\": index -> minimum code for bit length = index\n    var le = new u16(mb);\n    for (i = 0; i < mb; ++i) {\n        le[i] = (le[i - 1] + l[i - 1]) << 1;\n    }\n    var co;\n    if (r) {\n        // u16 \"map\": index -> number of actual bits, symbol for code\n        co = new u16(1 << mb);\n        // bits to remove for reverser\n        var rvb = 15 - mb;\n        for (i = 0; i < s; ++i) {\n            // ignore 0 lengths\n            if (cd[i]) {\n                // num encoding both symbol and bits read\n                var sv = (i << 4) | cd[i];\n                // free bits\n                var r_1 = mb - cd[i];\n                // start value\n                var v = le[cd[i] - 1]++ << r_1;\n                // m is end value\n                for (var m = v | ((1 << r_1) - 1); v <= m; ++v) {\n                    // every 16 bit value starting with the code yields the same result\n                    co[rev[v] >>> rvb] = sv;\n                }\n            }\n        }\n    }\n    else {\n        co = new u16(s);\n        for (i = 0; i < s; ++i) {\n            if (cd[i]) {\n                co[i] = rev[le[cd[i] - 1]++] >>> (15 - cd[i]);\n            }\n        }\n    }\n    return co;\n});\n// fixed length tree\nvar flt = new u8(288);\nfor (var i = 0; i < 144; ++i)\n    flt[i] = 8;\nfor (var i = 144; i < 256; ++i)\n    flt[i] = 9;\nfor (var i = 256; i < 280; ++i)\n    flt[i] = 7;\nfor (var i = 280; i < 288; ++i)\n    flt[i] = 8;\n// fixed distance tree\nvar fdt = new u8(32);\nfor (var i = 0; i < 32; ++i)\n    fdt[i] = 5;\n// fixed length map\nvar flm = /*#__PURE__*/ hMap(flt, 9, 0), flrm = /*#__PURE__*/ hMap(flt, 9, 1);\n// fixed distance map\nvar fdm = /*#__PURE__*/ hMap(fdt, 5, 0), fdrm = /*#__PURE__*/ hMap(fdt, 5, 1);\n// find max of array\nvar max = function (a) {\n    var m = a[0];\n    for (var i = 1; i < a.length; ++i) {\n        if (a[i] > m)\n            m = a[i];\n    }\n    return m;\n};\n// read d, starting at bit p and mask with m\nvar bits = function (d, p, m) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8)) >> (p & 7)) & m;\n};\n// read d, starting at bit p continuing for at least 16 bits\nvar bits16 = function (d, p) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8) | (d[o + 2] << 16)) >> (p & 7));\n};\n// get end of byte\nvar shft = function (p) { return ((p + 7) / 8) | 0; };\n// typed array slice - allows garbage collector to free original reference,\n// while being more compatible than .slice\nvar slc = function (v, s, e) {\n    if (s == null || s < 0)\n        s = 0;\n    if (e == null || e > v.length)\n        e = v.length;\n    // can't use .constructor in case user-supplied\n    var n = new (v.BYTES_PER_ELEMENT == 2 ? u16 : v.BYTES_PER_ELEMENT == 4 ? u32 : u8)(e - s);\n    n.set(v.subarray(s, e));\n    return n;\n};\n/**\n * Codes for errors generated within this library\n */\nexport var FlateErrorCode = {\n    UnexpectedEOF: 0,\n    InvalidBlockType: 1,\n    InvalidLengthLiteral: 2,\n    InvalidDistance: 3,\n    StreamFinished: 4,\n    NoStreamHandler: 5,\n    InvalidHeader: 6,\n    NoCallback: 7,\n    InvalidUTF8: 8,\n    ExtraFieldTooLong: 9,\n    InvalidDate: 10,\n    FilenameTooLong: 11,\n    StreamFinishing: 12,\n    InvalidZipData: 13,\n    UnknownCompressionMethod: 14\n};\n// error codes\nvar ec = [\n    'unexpected EOF',\n    'invalid block type',\n    'invalid length/literal',\n    'invalid distance',\n    'stream finished',\n    'no stream handler',\n    ,\n    'no callback',\n    'invalid UTF-8 data',\n    'extra field too long',\n    'date not in range 1980-2099',\n    'filename too long',\n    'stream finishing',\n    'invalid zip data'\n    // determined by unknown compression method\n];\n;\nvar err = function (ind, msg, nt) {\n    var e = new Error(msg || ec[ind]);\n    e.code = ind;\n    if (Error.captureStackTrace)\n        Error.captureStackTrace(e, err);\n    if (!nt)\n        throw e;\n    return e;\n};\n// expands raw DEFLATE data\nvar inflt = function (dat, buf, st) {\n    // source length\n    var sl = dat.length;\n    if (!sl || (st && st.f && !st.l))\n        return buf || new u8(0);\n    // have to estimate size\n    var noBuf = !buf || st;\n    // no state\n    var noSt = !st || st.i;\n    if (!st)\n        st = {};\n    // Assumes roughly 33% compression ratio average\n    if (!buf)\n        buf = new u8(sl * 3);\n    // ensure buffer can fit at least l elements\n    var cbuf = function (l) {\n        var bl = buf.length;\n        // need to increase size to fit\n        if (l > bl) {\n            // Double or set to necessary, whichever is greater\n            var nbuf = new u8(Math.max(bl * 2, l));\n            nbuf.set(buf);\n            buf = nbuf;\n        }\n    };\n    //  last chunk         bitpos           bytes\n    var final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n    // total bits\n    var tbts = sl * 8;\n    do {\n        if (!lm) {\n            // BFINAL - this is only 1 when last chunk is next\n            final = bits(dat, pos, 1);\n            // type: 0 = no compression, 1 = fixed huffman, 2 = dynamic huffman\n            var type = bits(dat, pos + 1, 3);\n            pos += 3;\n            if (!type) {\n                // go to end of byte boundary\n                var s = shft(pos) + 4, l = dat[s - 4] | (dat[s - 3] << 8), t = s + l;\n                if (t > sl) {\n                    if (noSt)\n                        err(0);\n                    break;\n                }\n                // ensure size\n                if (noBuf)\n                    cbuf(bt + l);\n                // Copy over uncompressed data\n                buf.set(dat.subarray(s, t), bt);\n                // Get new bitpos, update byte count\n                st.b = bt += l, st.p = pos = t * 8, st.f = final;\n                continue;\n            }\n            else if (type == 1)\n                lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n            else if (type == 2) {\n                //  literal                            lengths\n                var hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n                var tl = hLit + bits(dat, pos + 5, 31) + 1;\n                pos += 14;\n                // length+distance tree\n                var ldt = new u8(tl);\n                // code length tree\n                var clt = new u8(19);\n                for (var i = 0; i < hcLen; ++i) {\n                    // use index map to get real code\n                    clt[clim[i]] = bits(dat, pos + i * 3, 7);\n                }\n                pos += hcLen * 3;\n                // code lengths bits\n                var clb = max(clt), clbmsk = (1 << clb) - 1;\n                // code lengths map\n                var clm = hMap(clt, clb, 1);\n                for (var i = 0; i < tl;) {\n                    var r = clm[bits(dat, pos, clbmsk)];\n                    // bits read\n                    pos += r & 15;\n                    // symbol\n                    var s = r >>> 4;\n                    // code length to copy\n                    if (s < 16) {\n                        ldt[i++] = s;\n                    }\n                    else {\n                        //  copy   count\n                        var c = 0, n = 0;\n                        if (s == 16)\n                            n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];\n                        else if (s == 17)\n                            n = 3 + bits(dat, pos, 7), pos += 3;\n                        else if (s == 18)\n                            n = 11 + bits(dat, pos, 127), pos += 7;\n                        while (n--)\n                            ldt[i++] = c;\n                    }\n                }\n                //    length tree                 distance tree\n                var lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n                // max length bits\n                lbt = max(lt);\n                // max dist bits\n                dbt = max(dt);\n                lm = hMap(lt, lbt, 1);\n                dm = hMap(dt, dbt, 1);\n            }\n            else\n                err(1);\n            if (pos > tbts) {\n                if (noSt)\n                    err(0);\n                break;\n            }\n        }\n        // Make sure the buffer can hold this + the largest possible addition\n        // Maximum chunk size (practically, theoretically infinite) is 2^17;\n        if (noBuf)\n            cbuf(bt + 131072);\n        var lms = (1 << lbt) - 1, dms = (1 << dbt) - 1;\n        var lpos = pos;\n        for (;; lpos = pos) {\n            // bits read, code\n            var c = lm[bits16(dat, pos) & lms], sym = c >>> 4;\n            pos += c & 15;\n            if (pos > tbts) {\n                if (noSt)\n                    err(0);\n                break;\n            }\n            if (!c)\n                err(2);\n            if (sym < 256)\n                buf[bt++] = sym;\n            else if (sym == 256) {\n                lpos = pos, lm = null;\n                break;\n            }\n            else {\n                var add = sym - 254;\n                // no extra bits needed if less\n                if (sym > 264) {\n                    // index\n                    var i = sym - 257, b = fleb[i];\n                    add = bits(dat, pos, (1 << b) - 1) + fl[i];\n                    pos += b;\n                }\n                // dist\n                var d = dm[bits16(dat, pos) & dms], dsym = d >>> 4;\n                if (!d)\n                    err(3);\n                pos += d & 15;\n                var dt = fd[dsym];\n                if (dsym > 3) {\n                    var b = fdeb[dsym];\n                    dt += bits16(dat, pos) & ((1 << b) - 1), pos += b;\n                }\n                if (pos > tbts) {\n                    if (noSt)\n                        err(0);\n                    break;\n                }\n                if (noBuf)\n                    cbuf(bt + 131072);\n                var end = bt + add;\n                for (; bt < end; bt += 4) {\n                    buf[bt] = buf[bt - dt];\n                    buf[bt + 1] = buf[bt + 1 - dt];\n                    buf[bt + 2] = buf[bt + 2 - dt];\n                    buf[bt + 3] = buf[bt + 3 - dt];\n                }\n                bt = end;\n            }\n        }\n        st.l = lm, st.p = lpos, st.b = bt, st.f = final;\n        if (lm)\n            final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n    } while (!final);\n    return bt == buf.length ? buf : slc(buf, 0, bt);\n};\n// starting at p, write the minimum number of bits that can hold v to d\nvar wbits = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n};\n// starting at p, write the minimum number of bits (>8) that can hold v to d\nvar wbits16 = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n    d[o + 2] |= v >>> 16;\n};\n// creates code lengths from a frequency table\nvar hTree = function (d, mb) {\n    // Need extra info to make a tree\n    var t = [];\n    for (var i = 0; i < d.length; ++i) {\n        if (d[i])\n            t.push({ s: i, f: d[i] });\n    }\n    var s = t.length;\n    var t2 = t.slice();\n    if (!s)\n        return [et, 0];\n    if (s == 1) {\n        var v = new u8(t[0].s + 1);\n        v[t[0].s] = 1;\n        return [v, 1];\n    }\n    t.sort(function (a, b) { return a.f - b.f; });\n    // after i2 reaches last ind, will be stopped\n    // freq must be greater than largest possible number of symbols\n    t.push({ s: -1, f: 25001 });\n    var l = t[0], r = t[1], i0 = 0, i1 = 1, i2 = 2;\n    t[0] = { s: -1, f: l.f + r.f, l: l, r: r };\n    // efficient algorithm from UZIP.js\n    // i0 is lookbehind, i2 is lookahead - after processing two low-freq\n    // symbols that combined have high freq, will start processing i2 (high-freq,\n    // non-composite) symbols instead\n    // see https://reddit.com/r/photopea/comments/ikekht/uzipjs_questions/\n    while (i1 != s - 1) {\n        l = t[t[i0].f < t[i2].f ? i0++ : i2++];\n        r = t[i0 != i1 && t[i0].f < t[i2].f ? i0++ : i2++];\n        t[i1++] = { s: -1, f: l.f + r.f, l: l, r: r };\n    }\n    var maxSym = t2[0].s;\n    for (var i = 1; i < s; ++i) {\n        if (t2[i].s > maxSym)\n            maxSym = t2[i].s;\n    }\n    // code lengths\n    var tr = new u16(maxSym + 1);\n    // max bits in tree\n    var mbt = ln(t[i1 - 1], tr, 0);\n    if (mbt > mb) {\n        // more algorithms from UZIP.js\n        // TODO: find out how this code works (debt)\n        //  ind    debt\n        var i = 0, dt = 0;\n        //    left            cost\n        var lft = mbt - mb, cst = 1 << lft;\n        t2.sort(function (a, b) { return tr[b.s] - tr[a.s] || a.f - b.f; });\n        for (; i < s; ++i) {\n            var i2_1 = t2[i].s;\n            if (tr[i2_1] > mb) {\n                dt += cst - (1 << (mbt - tr[i2_1]));\n                tr[i2_1] = mb;\n            }\n            else\n                break;\n        }\n        dt >>>= lft;\n        while (dt > 0) {\n            var i2_2 = t2[i].s;\n            if (tr[i2_2] < mb)\n                dt -= 1 << (mb - tr[i2_2]++ - 1);\n            else\n                ++i;\n        }\n        for (; i >= 0 && dt; --i) {\n            var i2_3 = t2[i].s;\n            if (tr[i2_3] == mb) {\n                --tr[i2_3];\n                ++dt;\n            }\n        }\n        mbt = mb;\n    }\n    return [new u8(tr), mbt];\n};\n// get the max length and assign length codes\nvar ln = function (n, l, d) {\n    return n.s == -1\n        ? Math.max(ln(n.l, l, d + 1), ln(n.r, l, d + 1))\n        : (l[n.s] = d);\n};\n// length codes generation\nvar lc = function (c) {\n    var s = c.length;\n    // Note that the semicolon was intentional\n    while (s && !c[--s])\n        ;\n    var cl = new u16(++s);\n    //  ind      num         streak\n    var cli = 0, cln = c[0], cls = 1;\n    var w = function (v) { cl[cli++] = v; };\n    for (var i = 1; i <= s; ++i) {\n        if (c[i] == cln && i != s)\n            ++cls;\n        else {\n            if (!cln && cls > 2) {\n                for (; cls > 138; cls -= 138)\n                    w(32754);\n                if (cls > 2) {\n                    w(cls > 10 ? ((cls - 11) << 5) | 28690 : ((cls - 3) << 5) | 12305);\n                    cls = 0;\n                }\n            }\n            else if (cls > 3) {\n                w(cln), --cls;\n                for (; cls > 6; cls -= 6)\n                    w(8304);\n                if (cls > 2)\n                    w(((cls - 3) << 5) | 8208), cls = 0;\n            }\n            while (cls--)\n                w(cln);\n            cls = 1;\n            cln = c[i];\n        }\n    }\n    return [cl.subarray(0, cli), s];\n};\n// calculate the length of output from tree, code lengths\nvar clen = function (cf, cl) {\n    var l = 0;\n    for (var i = 0; i < cl.length; ++i)\n        l += cf[i] * cl[i];\n    return l;\n};\n// writes a fixed block\n// returns the new bit pos\nvar wfblk = function (out, pos, dat) {\n    // no need to write 00 as type: TypedArray defaults to 0\n    var s = dat.length;\n    var o = shft(pos + 2);\n    out[o] = s & 255;\n    out[o + 1] = s >>> 8;\n    out[o + 2] = out[o] ^ 255;\n    out[o + 3] = out[o + 1] ^ 255;\n    for (var i = 0; i < s; ++i)\n        out[o + i + 4] = dat[i];\n    return (o + 4 + s) * 8;\n};\n// writes a block\nvar wblk = function (dat, out, final, syms, lf, df, eb, li, bs, bl, p) {\n    wbits(out, p++, final);\n    ++lf[256];\n    var _a = hTree(lf, 15), dlt = _a[0], mlb = _a[1];\n    var _b = hTree(df, 15), ddt = _b[0], mdb = _b[1];\n    var _c = lc(dlt), lclt = _c[0], nlc = _c[1];\n    var _d = lc(ddt), lcdt = _d[0], ndc = _d[1];\n    var lcfreq = new u16(19);\n    for (var i = 0; i < lclt.length; ++i)\n        lcfreq[lclt[i] & 31]++;\n    for (var i = 0; i < lcdt.length; ++i)\n        lcfreq[lcdt[i] & 31]++;\n    var _e = hTree(lcfreq, 7), lct = _e[0], mlcb = _e[1];\n    var nlcc = 19;\n    for (; nlcc > 4 && !lct[clim[nlcc - 1]]; --nlcc)\n        ;\n    var flen = (bl + 5) << 3;\n    var ftlen = clen(lf, flt) + clen(df, fdt) + eb;\n    var dtlen = clen(lf, dlt) + clen(df, ddt) + eb + 14 + 3 * nlcc + clen(lcfreq, lct) + (2 * lcfreq[16] + 3 * lcfreq[17] + 7 * lcfreq[18]);\n    if (flen <= ftlen && flen <= dtlen)\n        return wfblk(out, p, dat.subarray(bs, bs + bl));\n    var lm, ll, dm, dl;\n    wbits(out, p, 1 + (dtlen < ftlen)), p += 2;\n    if (dtlen < ftlen) {\n        lm = hMap(dlt, mlb, 0), ll = dlt, dm = hMap(ddt, mdb, 0), dl = ddt;\n        var llm = hMap(lct, mlcb, 0);\n        wbits(out, p, nlc - 257);\n        wbits(out, p + 5, ndc - 1);\n        wbits(out, p + 10, nlcc - 4);\n        p += 14;\n        for (var i = 0; i < nlcc; ++i)\n            wbits(out, p + 3 * i, lct[clim[i]]);\n        p += 3 * nlcc;\n        var lcts = [lclt, lcdt];\n        for (var it = 0; it < 2; ++it) {\n            var clct = lcts[it];\n            for (var i = 0; i < clct.length; ++i) {\n                var len = clct[i] & 31;\n                wbits(out, p, llm[len]), p += lct[len];\n                if (len > 15)\n                    wbits(out, p, (clct[i] >>> 5) & 127), p += clct[i] >>> 12;\n            }\n        }\n    }\n    else {\n        lm = flm, ll = flt, dm = fdm, dl = fdt;\n    }\n    for (var i = 0; i < li; ++i) {\n        if (syms[i] > 255) {\n            var len = (syms[i] >>> 18) & 31;\n            wbits16(out, p, lm[len + 257]), p += ll[len + 257];\n            if (len > 7)\n                wbits(out, p, (syms[i] >>> 23) & 31), p += fleb[len];\n            var dst = syms[i] & 31;\n            wbits16(out, p, dm[dst]), p += dl[dst];\n            if (dst > 3)\n                wbits16(out, p, (syms[i] >>> 5) & 8191), p += fdeb[dst];\n        }\n        else {\n            wbits16(out, p, lm[syms[i]]), p += ll[syms[i]];\n        }\n    }\n    wbits16(out, p, lm[256]);\n    return p + ll[256];\n};\n// deflate options (nice << 13) | chain\nvar deo = /*#__PURE__*/ new u32([65540, 131080, 131088, 131104, 262176, 1048704, 1048832, 2114560, 2117632]);\n// empty\nvar et = /*#__PURE__*/ new u8(0);\n// compresses data into a raw DEFLATE buffer\nvar dflt = function (dat, lvl, plvl, pre, post, lst) {\n    var s = dat.length;\n    var o = new u8(pre + s + 5 * (1 + Math.ceil(s / 7000)) + post);\n    // writing to this writes to the output buffer\n    var w = o.subarray(pre, o.length - post);\n    var pos = 0;\n    if (!lvl || s < 8) {\n        for (var i = 0; i <= s; i += 65535) {\n            // end\n            var e = i + 65535;\n            if (e >= s) {\n                // write final block\n                w[pos >> 3] = lst;\n            }\n            pos = wfblk(w, pos + 1, dat.subarray(i, e));\n        }\n    }\n    else {\n        var opt = deo[lvl - 1];\n        var n = opt >>> 13, c = opt & 8191;\n        var msk_1 = (1 << plvl) - 1;\n        //    prev 2-byte val map    curr 2-byte val map\n        var prev = new u16(32768), head = new u16(msk_1 + 1);\n        var bs1_1 = Math.ceil(plvl / 3), bs2_1 = 2 * bs1_1;\n        var hsh = function (i) { return (dat[i] ^ (dat[i + 1] << bs1_1) ^ (dat[i + 2] << bs2_1)) & msk_1; };\n        // 24576 is an arbitrary number of maximum symbols per block\n        // 424 buffer for last block\n        var syms = new u32(25000);\n        // length/literal freq   distance freq\n        var lf = new u16(288), df = new u16(32);\n        //  l/lcnt  exbits  index  l/lind  waitdx  bitpos\n        var lc_1 = 0, eb = 0, i = 0, li = 0, wi = 0, bs = 0;\n        for (; i < s; ++i) {\n            // hash value\n            // deopt when i > s - 3 - at end, deopt acceptable\n            var hv = hsh(i);\n            // index mod 32768    previous index mod\n            var imod = i & 32767, pimod = head[hv];\n            prev[imod] = pimod;\n            head[hv] = imod;\n            // We always should modify head and prev, but only add symbols if\n            // this data is not yet processed (\"wait\" for wait index)\n            if (wi <= i) {\n                // bytes remaining\n                var rem = s - i;\n                if ((lc_1 > 7000 || li > 24576) && rem > 423) {\n                    pos = wblk(dat, w, 0, syms, lf, df, eb, li, bs, i - bs, pos);\n                    li = lc_1 = eb = 0, bs = i;\n                    for (var j = 0; j < 286; ++j)\n                        lf[j] = 0;\n                    for (var j = 0; j < 30; ++j)\n                        df[j] = 0;\n                }\n                //  len    dist   chain\n                var l = 2, d = 0, ch_1 = c, dif = (imod - pimod) & 32767;\n                if (rem > 2 && hv == hsh(i - dif)) {\n                    var maxn = Math.min(n, rem) - 1;\n                    var maxd = Math.min(32767, i);\n                    // max possible length\n                    // not capped at dif because decompressors implement \"rolling\" index population\n                    var ml = Math.min(258, rem);\n                    while (dif <= maxd && --ch_1 && imod != pimod) {\n                        if (dat[i + l] == dat[i + l - dif]) {\n                            var nl = 0;\n                            for (; nl < ml && dat[i + nl] == dat[i + nl - dif]; ++nl)\n                                ;\n                            if (nl > l) {\n                                l = nl, d = dif;\n                                // break out early when we reach \"nice\" (we are satisfied enough)\n                                if (nl > maxn)\n                                    break;\n                                // now, find the rarest 2-byte sequence within this\n                                // length of literals and search for that instead.\n                                // Much faster than just using the start\n                                var mmd = Math.min(dif, nl - 2);\n                                var md = 0;\n                                for (var j = 0; j < mmd; ++j) {\n                                    var ti = (i - dif + j + 32768) & 32767;\n                                    var pti = prev[ti];\n                                    var cd = (ti - pti + 32768) & 32767;\n                                    if (cd > md)\n                                        md = cd, pimod = ti;\n                                }\n                            }\n                        }\n                        // check the previous match\n                        imod = pimod, pimod = prev[imod];\n                        dif += (imod - pimod + 32768) & 32767;\n                    }\n                }\n                // d will be nonzero only when a match was found\n                if (d) {\n                    // store both dist and len data in one Uint32\n                    // Make sure this is recognized as a len/dist with 28th bit (2^28)\n                    syms[li++] = 268435456 | (revfl[l] << 18) | revfd[d];\n                    var lin = revfl[l] & 31, din = revfd[d] & 31;\n                    eb += fleb[lin] + fdeb[din];\n                    ++lf[257 + lin];\n                    ++df[din];\n                    wi = i + l;\n                    ++lc_1;\n                }\n                else {\n                    syms[li++] = dat[i];\n                    ++lf[dat[i]];\n                }\n            }\n        }\n        pos = wblk(dat, w, lst, syms, lf, df, eb, li, bs, i - bs, pos);\n        // this is the easiest way to avoid needing to maintain state\n        if (!lst && pos & 7)\n            pos = wfblk(w, pos + 1, et);\n    }\n    return slc(o, 0, pre + shft(pos) + post);\n};\n// CRC32 table\nvar crct = /*#__PURE__*/ (function () {\n    var t = new Int32Array(256);\n    for (var i = 0; i < 256; ++i) {\n        var c = i, k = 9;\n        while (--k)\n            c = ((c & 1) && -306674912) ^ (c >>> 1);\n        t[i] = c;\n    }\n    return t;\n})();\n// CRC32\nvar crc = function () {\n    var c = -1;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var cr = c;\n            for (var i = 0; i < d.length; ++i)\n                cr = crct[(cr & 255) ^ d[i]] ^ (cr >>> 8);\n            c = cr;\n        },\n        d: function () { return ~c; }\n    };\n};\n// Alder32\nvar adler = function () {\n    var a = 1, b = 0;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var n = a, m = b;\n            var l = d.length | 0;\n            for (var i = 0; i != l;) {\n                var e = Math.min(i + 2655, l);\n                for (; i < e; ++i)\n                    m += n += d[i];\n                n = (n & 65535) + 15 * (n >> 16), m = (m & 65535) + 15 * (m >> 16);\n            }\n            a = n, b = m;\n        },\n        d: function () {\n            a %= 65521, b %= 65521;\n            return (a & 255) << 24 | (a >>> 8) << 16 | (b & 255) << 8 | (b >>> 8);\n        }\n    };\n};\n;\n// deflate with opts\nvar dopt = function (dat, opt, pre, post, st) {\n    return dflt(dat, opt.level == null ? 6 : opt.level, opt.mem == null ? Math.ceil(Math.max(8, Math.min(13, Math.log(dat.length))) * 1.5) : (12 + opt.mem), pre, post, !st);\n};\n// Walmart object spread\nvar mrg = function (a, b) {\n    var o = {};\n    for (var k in a)\n        o[k] = a[k];\n    for (var k in b)\n        o[k] = b[k];\n    return o;\n};\n// worker clone\n// This is possibly the craziest part of the entire codebase, despite how simple it may seem.\n// The only parameter to this function is a closure that returns an array of variables outside of the function scope.\n// We're going to try to figure out the variable names used in the closure as strings because that is crucial for workerization.\n// We will return an object mapping of true variable name to value (basically, the current scope as a JS object).\n// The reason we can't just use the original variable names is minifiers mangling the toplevel scope.\n// This took me three weeks to figure out how to do.\nvar wcln = function (fn, fnStr, td) {\n    var dt = fn();\n    var st = fn.toString();\n    var ks = st.slice(st.indexOf('[') + 1, st.lastIndexOf(']')).replace(/\\s+/g, '').split(',');\n    for (var i = 0; i < dt.length; ++i) {\n        var v = dt[i], k = ks[i];\n        if (typeof v == 'function') {\n            fnStr += ';' + k + '=';\n            var st_1 = v.toString();\n            if (v.prototype) {\n                // for global objects\n                if (st_1.indexOf('[native code]') != -1) {\n                    var spInd = st_1.indexOf(' ', 8) + 1;\n                    fnStr += st_1.slice(spInd, st_1.indexOf('(', spInd));\n                }\n                else {\n                    fnStr += st_1;\n                    for (var t in v.prototype)\n                        fnStr += ';' + k + '.prototype.' + t + '=' + v.prototype[t].toString();\n                }\n            }\n            else\n                fnStr += st_1;\n        }\n        else\n            td[k] = v;\n    }\n    return [fnStr, td];\n};\nvar ch = [];\n// clone bufs\nvar cbfs = function (v) {\n    var tl = [];\n    for (var k in v) {\n        if (v[k].buffer) {\n            tl.push((v[k] = new v[k].constructor(v[k])).buffer);\n        }\n    }\n    return tl;\n};\n// use a worker to execute code\nvar wrkr = function (fns, init, id, cb) {\n    var _a;\n    if (!ch[id]) {\n        var fnStr = '', td_1 = {}, m = fns.length - 1;\n        for (var i = 0; i < m; ++i)\n            _a = wcln(fns[i], fnStr, td_1), fnStr = _a[0], td_1 = _a[1];\n        ch[id] = wcln(fns[m], fnStr, td_1);\n    }\n    var td = mrg({}, ch[id][1]);\n    return wk(ch[id][0] + ';onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage=' + init.toString() + '}', id, td, cbfs(td), cb);\n};\n// base async inflate fn\nvar bInflt = function () { return [u8, u16, u32, fleb, fdeb, clim, fl, fd, flrm, fdrm, rev, ec, hMap, max, bits, bits16, shft, slc, err, inflt, inflateSync, pbf, gu8]; };\nvar bDflt = function () { return [u8, u16, u32, fleb, fdeb, clim, revfl, revfd, flm, flt, fdm, fdt, rev, deo, et, hMap, wbits, wbits16, hTree, ln, lc, clen, wfblk, wblk, shft, slc, dflt, dopt, deflateSync, pbf]; };\n// gzip extra\nvar gze = function () { return [gzh, gzhl, wbytes, crc, crct]; };\n// gunzip extra\nvar guze = function () { return [gzs, gzl]; };\n// zlib extra\nvar zle = function () { return [zlh, wbytes, adler]; };\n// unzlib extra\nvar zule = function () { return [zlv]; };\n// post buf\nvar pbf = function (msg) { return postMessage(msg, [msg.buffer]); };\n// get u8\nvar gu8 = function (o) { return o && o.size && new u8(o.size); };\n// async helper\nvar cbify = function (dat, opts, fns, init, id, cb) {\n    var w = wrkr(fns, init, id, function (err, dat) {\n        w.terminate();\n        cb(err, dat);\n    });\n    w.postMessage([dat, opts], opts.consume ? [dat.buffer] : []);\n    return function () { w.terminate(); };\n};\n// auto stream\nvar astrm = function (strm) {\n    strm.ondata = function (dat, final) { return postMessage([dat, final], [dat.buffer]); };\n    return function (ev) { return strm.push(ev.data[0], ev.data[1]); };\n};\n// async stream attach\nvar astrmify = function (fns, strm, opts, init, id) {\n    var t;\n    var w = wrkr(fns, init, id, function (err, dat) {\n        if (err)\n            w.terminate(), strm.ondata.call(strm, err);\n        else {\n            if (dat[1])\n                w.terminate();\n            strm.ondata.call(strm, err, dat[0], dat[1]);\n        }\n    });\n    w.postMessage(opts);\n    strm.push = function (d, f) {\n        if (!strm.ondata)\n            err(5);\n        if (t)\n            strm.ondata(err(4, 0, 1), null, !!f);\n        w.postMessage([d, t = f], [d.buffer]);\n    };\n    strm.terminate = function () { w.terminate(); };\n};\n// read 2 bytes\nvar b2 = function (d, b) { return d[b] | (d[b + 1] << 8); };\n// read 4 bytes\nvar b4 = function (d, b) { return (d[b] | (d[b + 1] << 8) | (d[b + 2] << 16) | (d[b + 3] << 24)) >>> 0; };\nvar b8 = function (d, b) { return b4(d, b) + (b4(d, b + 4) * 4294967296); };\n// write bytes\nvar wbytes = function (d, b, v) {\n    for (; v; ++b)\n        d[b] = v, v >>>= 8;\n};\n// gzip header\nvar gzh = function (c, o) {\n    var fn = o.filename;\n    c[0] = 31, c[1] = 139, c[2] = 8, c[8] = o.level < 2 ? 4 : o.level == 9 ? 2 : 0, c[9] = 3; // assume Unix\n    if (o.mtime != 0)\n        wbytes(c, 4, Math.floor(new Date(o.mtime || Date.now()) / 1000));\n    if (fn) {\n        c[3] = 8;\n        for (var i = 0; i <= fn.length; ++i)\n            c[i + 10] = fn.charCodeAt(i);\n    }\n};\n// gzip footer: -8 to -4 = CRC, -4 to -0 is length\n// gzip start\nvar gzs = function (d) {\n    if (d[0] != 31 || d[1] != 139 || d[2] != 8)\n        err(6, 'invalid gzip data');\n    var flg = d[3];\n    var st = 10;\n    if (flg & 4)\n        st += d[10] | (d[11] << 8) + 2;\n    for (var zs = (flg >> 3 & 1) + (flg >> 4 & 1); zs > 0; zs -= !d[st++])\n        ;\n    return st + (flg & 2);\n};\n// gzip length\nvar gzl = function (d) {\n    var l = d.length;\n    return ((d[l - 4] | d[l - 3] << 8 | d[l - 2] << 16) | (d[l - 1] << 24)) >>> 0;\n};\n// gzip header length\nvar gzhl = function (o) { return 10 + ((o.filename && (o.filename.length + 1)) || 0); };\n// zlib header\nvar zlh = function (c, o) {\n    var lv = o.level, fl = lv == 0 ? 0 : lv < 6 ? 1 : lv == 9 ? 3 : 2;\n    c[0] = 120, c[1] = (fl << 6) | (fl ? (32 - 2 * fl) : 1);\n};\n// zlib valid\nvar zlv = function (d) {\n    if ((d[0] & 15) != 8 || (d[0] >>> 4) > 7 || ((d[0] << 8 | d[1]) % 31))\n        err(6, 'invalid zlib data');\n    if (d[1] & 32)\n        err(6, 'invalid zlib data: preset dictionaries not supported');\n};\nfunction AsyncCmpStrm(opts, cb) {\n    if (!cb && typeof opts == 'function')\n        cb = opts, opts = {};\n    this.ondata = cb;\n    return opts;\n}\n// zlib footer: -4 to -0 is Adler32\n/**\n * Streaming DEFLATE compression\n */\nvar Deflate = /*#__PURE__*/ (function () {\n    function Deflate(opts, cb) {\n        if (!cb && typeof opts == 'function')\n            cb = opts, opts = {};\n        this.ondata = cb;\n        this.o = opts || {};\n    }\n    Deflate.prototype.p = function (c, f) {\n        this.ondata(dopt(c, this.o, 0, 0, !f), f);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Deflate.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        this.d = final;\n        this.p(chunk, final || false);\n    };\n    return Deflate;\n}());\nexport { Deflate };\n/**\n * Asynchronous streaming DEFLATE compression\n */\nvar AsyncDeflate = /*#__PURE__*/ (function () {\n    function AsyncDeflate(opts, cb) {\n        astrmify([\n            bDflt,\n            function () { return [astrm, Deflate]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Deflate(ev.data);\n            onmessage = astrm(strm);\n        }, 6);\n    }\n    return AsyncDeflate;\n}());\nexport { AsyncDeflate };\nexport function deflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n    ], function (ev) { return pbf(deflateSync(ev.data[0], ev.data[1])); }, 0, cb);\n}\n/**\n * Compresses data with DEFLATE without any wrapper\n * @param data The data to compress\n * @param opts The compression options\n * @returns The deflated version of the data\n */\nexport function deflateSync(data, opts) {\n    return dopt(data, opts || {}, 0, 0);\n}\n/**\n * Streaming DEFLATE decompression\n */\nvar Inflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an inflation stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Inflate(cb) {\n        this.s = {};\n        this.p = new u8(0);\n        this.ondata = cb;\n    }\n    Inflate.prototype.e = function (c) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        var l = this.p.length;\n        var n = new u8(l + c.length);\n        n.set(this.p), n.set(c, l), this.p = n;\n    };\n    Inflate.prototype.c = function (final) {\n        this.d = this.s.i = final || false;\n        var bts = this.s.b;\n        var dt = inflt(this.p, this.o, this.s);\n        this.ondata(slc(dt, bts, this.s.b), this.d);\n        this.o = slc(dt, this.s.b - 32768), this.s.b = this.o.length;\n        this.p = slc(this.p, (this.s.p / 8) | 0), this.s.p &= 7;\n    };\n    /**\n     * Pushes a chunk to be inflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the final chunk\n     */\n    Inflate.prototype.push = function (chunk, final) {\n        this.e(chunk), this.c(final);\n    };\n    return Inflate;\n}());\nexport { Inflate };\n/**\n * Asynchronous streaming DEFLATE decompression\n */\nvar AsyncInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous inflation stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncInflate(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            function () { return [astrm, Inflate]; }\n        ], this, 0, function () {\n            var strm = new Inflate();\n            onmessage = astrm(strm);\n        }, 7);\n    }\n    return AsyncInflate;\n}());\nexport { AsyncInflate };\nexport function inflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt\n    ], function (ev) { return pbf(inflateSync(ev.data[0], gu8(ev.data[1]))); }, 1, cb);\n}\n/**\n * Expands DEFLATE data with no wrapper\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function inflateSync(data, out) {\n    return inflt(data, out);\n}\n// before you yell at me for not just using extends, my reason is that TS inheritance is hard to workerize.\n/**\n * Streaming GZIP compression\n */\nvar Gzip = /*#__PURE__*/ (function () {\n    function Gzip(opts, cb) {\n        this.c = crc();\n        this.l = 0;\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be GZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gzip.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Gzip.prototype.p = function (c, f) {\n        this.c.p(c);\n        this.l += c.length;\n        var raw = dopt(c, this.o, this.v && gzhl(this.o), f && 8, !f);\n        if (this.v)\n            gzh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 8, this.c.d()), wbytes(raw, raw.length - 4, this.l);\n        this.ondata(raw, f);\n    };\n    return Gzip;\n}());\nexport { Gzip };\n/**\n * Asynchronous streaming GZIP compression\n */\nvar AsyncGzip = /*#__PURE__*/ (function () {\n    function AsyncGzip(opts, cb) {\n        astrmify([\n            bDflt,\n            gze,\n            function () { return [astrm, Deflate, Gzip]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Gzip(ev.data);\n            onmessage = astrm(strm);\n        }, 8);\n    }\n    return AsyncGzip;\n}());\nexport { AsyncGzip };\nexport function gzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n        gze,\n        function () { return [gzipSync]; }\n    ], function (ev) { return pbf(gzipSync(ev.data[0], ev.data[1])); }, 2, cb);\n}\n/**\n * Compresses data with GZIP\n * @param data The data to compress\n * @param opts The compression options\n * @returns The gzipped version of the data\n */\nexport function gzipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var c = crc(), l = data.length;\n    c.p(data);\n    var d = dopt(data, opts, gzhl(opts), 8), s = d.length;\n    return gzh(d, opts), wbytes(d, s - 8, c.d()), wbytes(d, s - 4, l), d;\n}\n/**\n * Streaming GZIP decompression\n */\nvar Gunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a GUNZIP stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Gunzip(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be GUNZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gunzip.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            var s = this.p.length > 3 ? gzs(this.p) : 4;\n            if (s >= this.p.length && !final)\n                return;\n            this.p = this.p.subarray(s), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 8)\n                err(6, 'invalid gzip data');\n            this.p = this.p.subarray(0, -8);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Gunzip;\n}());\nexport { Gunzip };\n/**\n * Asynchronous streaming GZIP decompression\n */\nvar AsyncGunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous GUNZIP stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncGunzip(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            guze,\n            function () { return [astrm, Inflate, Gunzip]; }\n        ], this, 0, function () {\n            var strm = new Gunzip();\n            onmessage = astrm(strm);\n        }, 9);\n    }\n    return AsyncGunzip;\n}());\nexport { AsyncGunzip };\nexport function gunzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt,\n        guze,\n        function () { return [gunzipSync]; }\n    ], function (ev) { return pbf(gunzipSync(ev.data[0])); }, 3, cb);\n}\n/**\n * Expands GZIP data\n * @param data The data to decompress\n * @param out Where to write the data. GZIP already encodes the output size, so providing this doesn't save memory.\n * @returns The decompressed version of the data\n */\nexport function gunzipSync(data, out) {\n    return inflt(data.subarray(gzs(data), -8), out || new u8(gzl(data)));\n}\n/**\n * Streaming Zlib compression\n */\nvar Zlib = /*#__PURE__*/ (function () {\n    function Zlib(opts, cb) {\n        this.c = adler();\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be zlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Zlib.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Zlib.prototype.p = function (c, f) {\n        this.c.p(c);\n        var raw = dopt(c, this.o, this.v && 2, f && 4, !f);\n        if (this.v)\n            zlh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 4, this.c.d());\n        this.ondata(raw, f);\n    };\n    return Zlib;\n}());\nexport { Zlib };\n/**\n * Asynchronous streaming Zlib compression\n */\nvar AsyncZlib = /*#__PURE__*/ (function () {\n    function AsyncZlib(opts, cb) {\n        astrmify([\n            bDflt,\n            zle,\n            function () { return [astrm, Deflate, Zlib]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Zlib(ev.data);\n            onmessage = astrm(strm);\n        }, 10);\n    }\n    return AsyncZlib;\n}());\nexport { AsyncZlib };\nexport function zlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n        zle,\n        function () { return [zlibSync]; }\n    ], function (ev) { return pbf(zlibSync(ev.data[0], ev.data[1])); }, 4, cb);\n}\n/**\n * Compress data with Zlib\n * @param data The data to compress\n * @param opts The compression options\n * @returns The zlib-compressed version of the data\n */\nexport function zlibSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var a = adler();\n    a.p(data);\n    var d = dopt(data, opts, 2, 4);\n    return zlh(d, opts), wbytes(d, d.length - 4, a.d()), d;\n}\n/**\n * Streaming Zlib decompression\n */\nvar Unzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates a Zlib decompression stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Unzlib(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be unzlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzlib.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            if (this.p.length < 2 && !final)\n                return;\n            this.p = this.p.subarray(2), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 4)\n                err(6, 'invalid zlib data');\n            this.p = this.p.subarray(0, -4);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Unzlib;\n}());\nexport { Unzlib };\n/**\n * Asynchronous streaming Zlib decompression\n */\nvar AsyncUnzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous Zlib decompression stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncUnzlib(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            zule,\n            function () { return [astrm, Inflate, Unzlib]; }\n        ], this, 0, function () {\n            var strm = new Unzlib();\n            onmessage = astrm(strm);\n        }, 11);\n    }\n    return AsyncUnzlib;\n}());\nexport { AsyncUnzlib };\nexport function unzlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt,\n        zule,\n        function () { return [unzlibSync]; }\n    ], function (ev) { return pbf(unzlibSync(ev.data[0], gu8(ev.data[1]))); }, 5, cb);\n}\n/**\n * Expands Zlib data\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function unzlibSync(data, out) {\n    return inflt((zlv(data), data.subarray(2, -4)), out);\n}\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzip as compress, AsyncGzip as AsyncCompress };\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzipSync as compressSync, Gzip as Compress };\n/**\n * Streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar Decompress = /*#__PURE__*/ (function () {\n    /**\n     * Creates a decompression stream\n     * @param cb The callback to call whenever data is decompressed\n     */\n    function Decompress(cb) {\n        this.G = Gunzip;\n        this.I = Inflate;\n        this.Z = Unzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Decompress.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (!this.s) {\n            if (this.p && this.p.length) {\n                var n = new u8(this.p.length + chunk.length);\n                n.set(this.p), n.set(chunk, this.p.length);\n            }\n            else\n                this.p = chunk;\n            if (this.p.length > 2) {\n                var _this_1 = this;\n                var cb = function () { _this_1.ondata.apply(_this_1, arguments); };\n                this.s = (this.p[0] == 31 && this.p[1] == 139 && this.p[2] == 8)\n                    ? new this.G(cb)\n                    : ((this.p[0] & 15) != 8 || (this.p[0] >> 4) > 7 || ((this.p[0] << 8 | this.p[1]) % 31))\n                        ? new this.I(cb)\n                        : new this.Z(cb);\n                this.s.push(this.p, final);\n                this.p = null;\n            }\n        }\n        else\n            this.s.push(chunk, final);\n    };\n    return Decompress;\n}());\nexport { Decompress };\n/**\n * Asynchronous streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar AsyncDecompress = /*#__PURE__*/ (function () {\n    /**\n   * Creates an asynchronous decompression stream\n   * @param cb The callback to call whenever data is decompressed\n   */\n    function AsyncDecompress(cb) {\n        this.G = AsyncGunzip;\n        this.I = AsyncInflate;\n        this.Z = AsyncUnzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncDecompress.prototype.push = function (chunk, final) {\n        Decompress.prototype.push.call(this, chunk, final);\n    };\n    return AsyncDecompress;\n}());\nexport { AsyncDecompress };\nexport function decompress(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzip(data, opts, cb)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflate(data, opts, cb)\n            : unzlib(data, opts, cb);\n}\n/**\n * Expands compressed GZIP, Zlib, or raw DEFLATE data, automatically detecting the format\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function decompressSync(data, out) {\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzipSync(data, out)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflateSync(data, out)\n            : unzlibSync(data, out);\n}\n// flatten a directory structure\nvar fltn = function (d, p, t, o) {\n    for (var k in d) {\n        var val = d[k], n = p + k, op = o;\n        if (Array.isArray(val))\n            op = mrg(o, val[1]), val = val[0];\n        if (val instanceof u8)\n            t[n] = [val, op];\n        else {\n            t[n += '/'] = [new u8(0), op];\n            fltn(val, n, t, o);\n        }\n    }\n};\n// text encoder\nvar te = typeof TextEncoder != 'undefined' && /*#__PURE__*/ new TextEncoder();\n// text decoder\nvar td = typeof TextDecoder != 'undefined' && /*#__PURE__*/ new TextDecoder();\n// text decoder stream\nvar tds = 0;\ntry {\n    td.decode(et, { stream: true });\n    tds = 1;\n}\ncatch (e) { }\n// decode UTF8\nvar dutf8 = function (d) {\n    for (var r = '', i = 0;;) {\n        var c = d[i++];\n        var eb = (c > 127) + (c > 223) + (c > 239);\n        if (i + eb > d.length)\n            return [r, slc(d, i - 1)];\n        if (!eb)\n            r += String.fromCharCode(c);\n        else if (eb == 3) {\n            c = ((c & 15) << 18 | (d[i++] & 63) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63)) - 65536,\n                r += String.fromCharCode(55296 | (c >> 10), 56320 | (c & 1023));\n        }\n        else if (eb & 1)\n            r += String.fromCharCode((c & 31) << 6 | (d[i++] & 63));\n        else\n            r += String.fromCharCode((c & 15) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63));\n    }\n};\n/**\n * Streaming UTF-8 decoding\n */\nvar DecodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is decoded\n     */\n    function DecodeUTF8(cb) {\n        this.ondata = cb;\n        if (tds)\n            this.t = new TextDecoder();\n        else\n            this.p = et;\n    }\n    /**\n     * Pushes a chunk to be decoded from UTF-8 binary\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    DecodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        final = !!final;\n        if (this.t) {\n            this.ondata(this.t.decode(chunk, { stream: true }), final);\n            if (final) {\n                if (this.t.decode().length)\n                    err(8);\n                this.t = null;\n            }\n            return;\n        }\n        if (!this.p)\n            err(4);\n        var dat = new u8(this.p.length + chunk.length);\n        dat.set(this.p);\n        dat.set(chunk, this.p.length);\n        var _a = dutf8(dat), ch = _a[0], np = _a[1];\n        if (final) {\n            if (np.length)\n                err(8);\n            this.p = null;\n        }\n        else\n            this.p = np;\n        this.ondata(ch, final);\n    };\n    return DecodeUTF8;\n}());\nexport { DecodeUTF8 };\n/**\n * Streaming UTF-8 encoding\n */\nvar EncodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is encoded\n     */\n    function EncodeUTF8(cb) {\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be encoded to UTF-8\n     * @param chunk The string data to push\n     * @param final Whether this is the last chunk\n     */\n    EncodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        this.ondata(strToU8(chunk), this.d = final || false);\n    };\n    return EncodeUTF8;\n}());\nexport { EncodeUTF8 };\n/**\n * Converts a string into a Uint8Array for use with compression/decompression methods\n * @param str The string to encode\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless decoding a binary string.\n * @returns The string encoded in UTF-8/Latin-1 binary\n */\nexport function strToU8(str, latin1) {\n    if (latin1) {\n        var ar_1 = new u8(str.length);\n        for (var i = 0; i < str.length; ++i)\n            ar_1[i] = str.charCodeAt(i);\n        return ar_1;\n    }\n    if (te)\n        return te.encode(str);\n    var l = str.length;\n    var ar = new u8(str.length + (str.length >> 1));\n    var ai = 0;\n    var w = function (v) { ar[ai++] = v; };\n    for (var i = 0; i < l; ++i) {\n        if (ai + 5 > ar.length) {\n            var n = new u8(ai + 8 + ((l - i) << 1));\n            n.set(ar);\n            ar = n;\n        }\n        var c = str.charCodeAt(i);\n        if (c < 128 || latin1)\n            w(c);\n        else if (c < 2048)\n            w(192 | (c >> 6)), w(128 | (c & 63));\n        else if (c > 55295 && c < 57344)\n            c = 65536 + (c & 1023 << 10) | (str.charCodeAt(++i) & 1023),\n                w(240 | (c >> 18)), w(128 | ((c >> 12) & 63)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n        else\n            w(224 | (c >> 12)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n    }\n    return slc(ar, 0, ai);\n}\n/**\n * Converts a Uint8Array to a string\n * @param dat The data to decode to string\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless encoding to binary string.\n * @returns The original UTF-8/Latin-1 string\n */\nexport function strFromU8(dat, latin1) {\n    if (latin1) {\n        var r = '';\n        for (var i = 0; i < dat.length; i += 16384)\n            r += String.fromCharCode.apply(null, dat.subarray(i, i + 16384));\n        return r;\n    }\n    else if (td)\n        return td.decode(dat);\n    else {\n        var _a = dutf8(dat), out = _a[0], ext = _a[1];\n        if (ext.length)\n            err(8);\n        return out;\n    }\n}\n;\n// deflate bit flag\nvar dbf = function (l) { return l == 1 ? 3 : l < 6 ? 2 : l == 9 ? 1 : 0; };\n// skip local zip header\nvar slzh = function (d, b) { return b + 30 + b2(d, b + 26) + b2(d, b + 28); };\n// read zip header\nvar zh = function (d, b, z) {\n    var fnl = b2(d, b + 28), fn = strFromU8(d.subarray(b + 46, b + 46 + fnl), !(b2(d, b + 8) & 2048)), es = b + 46 + fnl, bs = b4(d, b + 20);\n    var _a = z && bs == 4294967295 ? z64e(d, es) : [bs, b4(d, b + 24), b4(d, b + 42)], sc = _a[0], su = _a[1], off = _a[2];\n    return [b2(d, b + 10), sc, su, fn, es + b2(d, b + 30) + b2(d, b + 32), off];\n};\n// read zip64 extra field\nvar z64e = function (d, b) {\n    for (; b2(d, b) != 1; b += 4 + b2(d, b + 2))\n        ;\n    return [b8(d, b + 12), b8(d, b + 4), b8(d, b + 20)];\n};\n// extra field length\nvar exfl = function (ex) {\n    var le = 0;\n    if (ex) {\n        for (var k in ex) {\n            var l = ex[k].length;\n            if (l > 65535)\n                err(9);\n            le += l + 4;\n        }\n    }\n    return le;\n};\n// write zip header\nvar wzh = function (d, b, f, fn, u, c, ce, co) {\n    var fl = fn.length, ex = f.extra, col = co && co.length;\n    var exl = exfl(ex);\n    wbytes(d, b, ce != null ? 0x2014B50 : 0x4034B50), b += 4;\n    if (ce != null)\n        d[b++] = 20, d[b++] = f.os;\n    d[b] = 20, b += 2; // spec compliance? what's that?\n    d[b++] = (f.flag << 1) | (c < 0 && 8), d[b++] = u && 8;\n    d[b++] = f.compression & 255, d[b++] = f.compression >> 8;\n    var dt = new Date(f.mtime == null ? Date.now() : f.mtime), y = dt.getFullYear() - 1980;\n    if (y < 0 || y > 119)\n        err(10);\n    wbytes(d, b, (y << 25) | ((dt.getMonth() + 1) << 21) | (dt.getDate() << 16) | (dt.getHours() << 11) | (dt.getMinutes() << 5) | (dt.getSeconds() >>> 1)), b += 4;\n    if (c != -1) {\n        wbytes(d, b, f.crc);\n        wbytes(d, b + 4, c < 0 ? -c - 2 : c);\n        wbytes(d, b + 8, f.size);\n    }\n    wbytes(d, b + 12, fl);\n    wbytes(d, b + 14, exl), b += 16;\n    if (ce != null) {\n        wbytes(d, b, col);\n        wbytes(d, b + 6, f.attrs);\n        wbytes(d, b + 10, ce), b += 14;\n    }\n    d.set(fn, b);\n    b += fl;\n    if (exl) {\n        for (var k in ex) {\n            var exf = ex[k], l = exf.length;\n            wbytes(d, b, +k);\n            wbytes(d, b + 2, l);\n            d.set(exf, b + 4), b += 4 + l;\n        }\n    }\n    if (col)\n        d.set(co, b), b += col;\n    return b;\n};\n// write zip footer (end of central directory)\nvar wzf = function (o, b, c, d, e) {\n    wbytes(o, b, 0x6054B50); // skip disk\n    wbytes(o, b + 8, c);\n    wbytes(o, b + 10, c);\n    wbytes(o, b + 12, d);\n    wbytes(o, b + 16, e);\n};\n/**\n * A pass-through stream to keep data uncompressed in a ZIP archive.\n */\nvar ZipPassThrough = /*#__PURE__*/ (function () {\n    /**\n     * Creates a pass-through stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     */\n    function ZipPassThrough(filename) {\n        this.filename = filename;\n        this.c = crc();\n        this.size = 0;\n        this.compression = 0;\n    }\n    /**\n     * Processes a chunk and pushes to the output stream. You can override this\n     * method in a subclass for custom behavior, but by default this passes\n     * the data through. You must call this.ondata(err, chunk, final) at some\n     * point in this method.\n     * @param chunk The chunk to process\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.process = function (chunk, final) {\n        this.ondata(null, chunk, final);\n    };\n    /**\n     * Pushes a chunk to be added. If you are subclassing this with a custom\n     * compression algorithm, note that you must push data from the source\n     * file only, pre-compression.\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        this.c.p(chunk);\n        this.size += chunk.length;\n        if (final)\n            this.crc = this.c.d();\n        this.process(chunk, final || false);\n    };\n    return ZipPassThrough;\n}());\nexport { ZipPassThrough };\n// I don't extend because TypeScript extension adds 1kB of runtime bloat\n/**\n * Streaming DEFLATE compression for ZIP archives. Prefer using AsyncZipDeflate\n * for better performance\n */\nvar ZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function ZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new Deflate(opts, function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n    }\n    ZipDeflate.prototype.process = function (chunk, final) {\n        try {\n            this.d.push(chunk, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return ZipDeflate;\n}());\nexport { ZipDeflate };\n/**\n * Asynchronous streaming DEFLATE compression for ZIP archives\n */\nvar AsyncZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function AsyncZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new AsyncDeflate(opts, function (err, dat, final) {\n            _this_1.ondata(err, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n        this.terminate = this.d.terminate;\n    }\n    AsyncZipDeflate.prototype.process = function (chunk, final) {\n        this.d.push(chunk, final);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return AsyncZipDeflate;\n}());\nexport { AsyncZipDeflate };\n// TODO: Better tree shaking\n/**\n * A zippable archive to which files can incrementally be added\n */\nvar Zip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an empty ZIP archive to which files can be added\n     * @param cb The callback to call whenever data for the generated ZIP archive\n     *           is available\n     */\n    function Zip(cb) {\n        this.ondata = cb;\n        this.u = [];\n        this.d = 1;\n    }\n    /**\n     * Adds a file to the ZIP archive\n     * @param file The file stream to add\n     */\n    Zip.prototype.add = function (file) {\n        var _this_1 = this;\n        if (!this.ondata)\n            err(5);\n        // finishing or finished\n        if (this.d & 2)\n            this.ondata(err(4 + (this.d & 1) * 8, 0, 1), null, false);\n        else {\n            var f = strToU8(file.filename), fl_1 = f.length;\n            var com = file.comment, o = com && strToU8(com);\n            var u = fl_1 != file.filename.length || (o && (com.length != o.length));\n            var hl_1 = fl_1 + exfl(file.extra) + 30;\n            if (fl_1 > 65535)\n                this.ondata(err(11, 0, 1), null, false);\n            var header = new u8(hl_1);\n            wzh(header, 0, file, f, u, -1);\n            var chks_1 = [header];\n            var pAll_1 = function () {\n                for (var _i = 0, chks_2 = chks_1; _i < chks_2.length; _i++) {\n                    var chk = chks_2[_i];\n                    _this_1.ondata(null, chk, false);\n                }\n                chks_1 = [];\n            };\n            var tr_1 = this.d;\n            this.d = 0;\n            var ind_1 = this.u.length;\n            var uf_1 = mrg(file, {\n                f: f,\n                u: u,\n                o: o,\n                t: function () {\n                    if (file.terminate)\n                        file.terminate();\n                },\n                r: function () {\n                    pAll_1();\n                    if (tr_1) {\n                        var nxt = _this_1.u[ind_1 + 1];\n                        if (nxt)\n                            nxt.r();\n                        else\n                            _this_1.d = 1;\n                    }\n                    tr_1 = 1;\n                }\n            });\n            var cl_1 = 0;\n            file.ondata = function (err, dat, final) {\n                if (err) {\n                    _this_1.ondata(err, dat, final);\n                    _this_1.terminate();\n                }\n                else {\n                    cl_1 += dat.length;\n                    chks_1.push(dat);\n                    if (final) {\n                        var dd = new u8(16);\n                        wbytes(dd, 0, 0x8074B50);\n                        wbytes(dd, 4, file.crc);\n                        wbytes(dd, 8, cl_1);\n                        wbytes(dd, 12, file.size);\n                        chks_1.push(dd);\n                        uf_1.c = cl_1, uf_1.b = hl_1 + cl_1 + 16, uf_1.crc = file.crc, uf_1.size = file.size;\n                        if (tr_1)\n                            uf_1.r();\n                        tr_1 = 1;\n                    }\n                    else if (tr_1)\n                        pAll_1();\n                }\n            };\n            this.u.push(uf_1);\n        }\n    };\n    /**\n     * Ends the process of adding files and prepares to emit the final chunks.\n     * This *must* be called after adding all desired files for the resulting\n     * ZIP file to work properly.\n     */\n    Zip.prototype.end = function () {\n        var _this_1 = this;\n        if (this.d & 2) {\n            this.ondata(err(4 + (this.d & 1) * 8, 0, 1), null, true);\n            return;\n        }\n        if (this.d)\n            this.e();\n        else\n            this.u.push({\n                r: function () {\n                    if (!(_this_1.d & 1))\n                        return;\n                    _this_1.u.splice(-1, 1);\n                    _this_1.e();\n                },\n                t: function () { }\n            });\n        this.d = 3;\n    };\n    Zip.prototype.e = function () {\n        var bt = 0, l = 0, tl = 0;\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            tl += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0);\n        }\n        var out = new u8(tl + 22);\n        for (var _b = 0, _c = this.u; _b < _c.length; _b++) {\n            var f = _c[_b];\n            wzh(out, bt, f, f.f, f.u, -f.c - 2, l, f.o);\n            bt += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0), l += f.b;\n        }\n        wzf(out, bt, this.u.length, tl, l);\n        this.ondata(null, out, true);\n        this.d = 2;\n    };\n    /**\n     * A method to terminate any internal workers used by the stream. Subsequent\n     * calls to add() will fail.\n     */\n    Zip.prototype.terminate = function () {\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            f.t();\n        }\n        this.d = 2;\n    };\n    return Zip;\n}());\nexport { Zip };\nexport function zip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    var r = {};\n    fltn(data, '', r, opts);\n    var k = Object.keys(r);\n    var lft = k.length, o = 0, tot = 0;\n    var slft = lft, files = new Array(lft);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var cbd = function (a, b) {\n        mt(function () { cb(a, b); });\n    };\n    mt(function () { cbd = cb; });\n    var cbf = function () {\n        var out = new u8(tot + 22), oe = o, cdl = tot - o;\n        tot = 0;\n        for (var i = 0; i < slft; ++i) {\n            var f = files[i];\n            try {\n                var l = f.c.length;\n                wzh(out, tot, f, f.f, f.u, l);\n                var badd = 30 + f.f.length + exfl(f.extra);\n                var loc = tot + badd;\n                out.set(f.c, loc);\n                wzh(out, o, f, f.f, f.u, l, tot, f.m), o += 16 + badd + (f.m ? f.m.length : 0), tot = loc + l;\n            }\n            catch (e) {\n                return cbd(e, null);\n            }\n        }\n        wzf(out, o, files.length, cdl, oe);\n        cbd(null, out);\n    };\n    if (!lft)\n        cbf();\n    var _loop_1 = function (i) {\n        var fn = k[i];\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var c = crc(), size = file.length;\n        c.p(file);\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        var compression = p.level == 0 ? 0 : 8;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cbd(e, null);\n            }\n            else {\n                var l = d.length;\n                files[i] = mrg(p, {\n                    size: size,\n                    crc: c.d(),\n                    c: d,\n                    f: f,\n                    m: m,\n                    u: s != fn.length || (m && (com.length != ms)),\n                    compression: compression\n                });\n                o += 30 + s + exl + l;\n                tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n                if (!--lft)\n                    cbf();\n            }\n        };\n        if (s > 65535)\n            cbl(err(11, 0, 1), null);\n        if (!compression)\n            cbl(null, file);\n        else if (size < 160000) {\n            try {\n                cbl(null, deflateSync(file, p));\n            }\n            catch (e) {\n                cbl(e, null);\n            }\n        }\n        else\n            term.push(deflate(file, p, cbl));\n    };\n    // Cannot use lft because it can decrease\n    for (var i = 0; i < slft; ++i) {\n        _loop_1(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously creates a ZIP file. Prefer using `zip` for better performance\n * with more than one file.\n * @param data The directory structure for the ZIP archive\n * @param opts The main options, merged with per-file options\n * @returns The generated ZIP archive\n */\nexport function zipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var r = {};\n    var files = [];\n    fltn(data, '', r, opts);\n    var o = 0;\n    var tot = 0;\n    for (var fn in r) {\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var compression = p.level == 0 ? 0 : 8;\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        if (s > 65535)\n            err(11);\n        var d = compression ? deflateSync(file, p) : file, l = d.length;\n        var c = crc();\n        c.p(file);\n        files.push(mrg(p, {\n            size: file.length,\n            crc: c.d(),\n            c: d,\n            f: f,\n            m: m,\n            u: s != fn.length || (m && (com.length != ms)),\n            o: o,\n            compression: compression\n        }));\n        o += 30 + s + exl + l;\n        tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n    }\n    var out = new u8(tot + 22), oe = o, cdl = tot - o;\n    for (var i = 0; i < files.length; ++i) {\n        var f = files[i];\n        wzh(out, f.o, f, f.f, f.u, f.c.length);\n        var badd = 30 + f.f.length + exfl(f.extra);\n        out.set(f.c, f.o + badd);\n        wzh(out, o, f, f.f, f.u, f.c.length, f.o, f.m), o += 16 + badd + (f.m ? f.m.length : 0);\n    }\n    wzf(out, o, files.length, cdl, oe);\n    return out;\n}\n/**\n * Streaming pass-through decompression for ZIP archives\n */\nvar UnzipPassThrough = /*#__PURE__*/ (function () {\n    function UnzipPassThrough() {\n    }\n    UnzipPassThrough.prototype.push = function (data, final) {\n        this.ondata(null, data, final);\n    };\n    UnzipPassThrough.compression = 0;\n    return UnzipPassThrough;\n}());\nexport { UnzipPassThrough };\n/**\n * Streaming DEFLATE decompression for ZIP archives. Prefer AsyncZipInflate for\n * better performance.\n */\nvar UnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function UnzipInflate() {\n        var _this_1 = this;\n        this.i = new Inflate(function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n    }\n    UnzipInflate.prototype.push = function (data, final) {\n        try {\n            this.i.push(data, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    UnzipInflate.compression = 8;\n    return UnzipInflate;\n}());\nexport { UnzipInflate };\n/**\n * Asynchronous streaming DEFLATE decompression for ZIP archives\n */\nvar AsyncUnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function AsyncUnzipInflate(_, sz) {\n        var _this_1 = this;\n        if (sz < 320000) {\n            this.i = new Inflate(function (dat, final) {\n                _this_1.ondata(null, dat, final);\n            });\n        }\n        else {\n            this.i = new AsyncInflate(function (err, dat, final) {\n                _this_1.ondata(err, dat, final);\n            });\n            this.terminate = this.i.terminate;\n        }\n    }\n    AsyncUnzipInflate.prototype.push = function (data, final) {\n        if (this.i.terminate)\n            data = slc(data, 0);\n        this.i.push(data, final);\n    };\n    AsyncUnzipInflate.compression = 8;\n    return AsyncUnzipInflate;\n}());\nexport { AsyncUnzipInflate };\n/**\n * A ZIP archive decompression stream that emits files as they are discovered\n */\nvar Unzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a ZIP decompression stream\n     * @param cb The callback to call whenever a file in the ZIP archive is found\n     */\n    function Unzip(cb) {\n        this.onfile = cb;\n        this.k = [];\n        this.o = {\n            0: UnzipPassThrough\n        };\n        this.p = et;\n    }\n    /**\n     * Pushes a chunk to be unzipped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzip.prototype.push = function (chunk, final) {\n        var _this_1 = this;\n        if (!this.onfile)\n            err(5);\n        if (!this.p)\n            err(4);\n        if (this.c > 0) {\n            var len = Math.min(this.c, chunk.length);\n            var toAdd = chunk.subarray(0, len);\n            this.c -= len;\n            if (this.d)\n                this.d.push(toAdd, !this.c);\n            else\n                this.k[0].push(toAdd);\n            chunk = chunk.subarray(len);\n            if (chunk.length)\n                return this.push(chunk, final);\n        }\n        else {\n            var f = 0, i = 0, is = void 0, buf = void 0;\n            if (!this.p.length)\n                buf = chunk;\n            else if (!chunk.length)\n                buf = this.p;\n            else {\n                buf = new u8(this.p.length + chunk.length);\n                buf.set(this.p), buf.set(chunk, this.p.length);\n            }\n            var l = buf.length, oc = this.c, add = oc && this.d;\n            var _loop_2 = function () {\n                var _a;\n                var sig = b4(buf, i);\n                if (sig == 0x4034B50) {\n                    f = 1, is = i;\n                    this_1.d = null;\n                    this_1.c = 0;\n                    var bf = b2(buf, i + 6), cmp_1 = b2(buf, i + 8), u = bf & 2048, dd = bf & 8, fnl = b2(buf, i + 26), es = b2(buf, i + 28);\n                    if (l > i + 30 + fnl + es) {\n                        var chks_3 = [];\n                        this_1.k.unshift(chks_3);\n                        f = 2;\n                        var sc_1 = b4(buf, i + 18), su_1 = b4(buf, i + 22);\n                        var fn_1 = strFromU8(buf.subarray(i + 30, i += 30 + fnl), !u);\n                        if (sc_1 == 4294967295) {\n                            _a = dd ? [-2] : z64e(buf, i), sc_1 = _a[0], su_1 = _a[1];\n                        }\n                        else if (dd)\n                            sc_1 = -1;\n                        i += es;\n                        this_1.c = sc_1;\n                        var d_1;\n                        var file_1 = {\n                            name: fn_1,\n                            compression: cmp_1,\n                            start: function () {\n                                if (!file_1.ondata)\n                                    err(5);\n                                if (!sc_1)\n                                    file_1.ondata(null, et, true);\n                                else {\n                                    var ctr = _this_1.o[cmp_1];\n                                    if (!ctr)\n                                        file_1.ondata(err(14, 'unknown compression type ' + cmp_1, 1), null, false);\n                                    d_1 = sc_1 < 0 ? new ctr(fn_1) : new ctr(fn_1, sc_1, su_1);\n                                    d_1.ondata = function (err, dat, final) { file_1.ondata(err, dat, final); };\n                                    for (var _i = 0, chks_4 = chks_3; _i < chks_4.length; _i++) {\n                                        var dat = chks_4[_i];\n                                        d_1.push(dat, false);\n                                    }\n                                    if (_this_1.k[0] == chks_3 && _this_1.c)\n                                        _this_1.d = d_1;\n                                    else\n                                        d_1.push(et, true);\n                                }\n                            },\n                            terminate: function () {\n                                if (d_1 && d_1.terminate)\n                                    d_1.terminate();\n                            }\n                        };\n                        if (sc_1 >= 0)\n                            file_1.size = sc_1, file_1.originalSize = su_1;\n                        this_1.onfile(file_1);\n                    }\n                    return \"break\";\n                }\n                else if (oc) {\n                    if (sig == 0x8074B50) {\n                        is = i += 12 + (oc == -2 && 8), f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                    else if (sig == 0x2014B50) {\n                        is = i -= 4, f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                }\n            };\n            var this_1 = this;\n            for (; i < l - 4; ++i) {\n                var state_1 = _loop_2();\n                if (state_1 === \"break\")\n                    break;\n            }\n            this.p = et;\n            if (oc < 0) {\n                var dat = f ? buf.subarray(0, is - 12 - (oc == -2 && 8) - (b4(buf, is - 16) == 0x8074B50 && 4)) : buf.subarray(0, i);\n                if (add)\n                    add.push(dat, !!f);\n                else\n                    this.k[+(f == 2)].push(dat);\n            }\n            if (f & 2)\n                return this.push(buf.subarray(i), final);\n            this.p = buf.subarray(i);\n        }\n        if (final) {\n            if (this.c)\n                err(13);\n            this.p = null;\n        }\n    };\n    /**\n     * Registers a decoder with the stream, allowing for files compressed with\n     * the compression type provided to be expanded correctly\n     * @param decoder The decoder constructor\n     */\n    Unzip.prototype.register = function (decoder) {\n        this.o[decoder.compression] = decoder;\n    };\n    return Unzip;\n}());\nexport { Unzip };\nvar mt = typeof queueMicrotask == 'function' ? queueMicrotask : typeof setTimeout == 'function' ? setTimeout : function (fn) { fn(); };\nexport function unzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var files = {};\n    var cbd = function (a, b) {\n        mt(function () { cb(a, b); });\n    };\n    mt(function () { cbd = cb; });\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558) {\n            cbd(err(13, 0, 1), null);\n            return tAll;\n        }\n    }\n    ;\n    var lft = b2(data, e + 8);\n    if (lft) {\n        var c = lft;\n        var o = b4(data, e + 16);\n        var z = o == 4294967295 || c == 65535;\n        if (z) {\n            var ze = b4(data, e - 12);\n            z = b4(data, ze) == 0x6064B50;\n            if (z) {\n                c = lft = b4(data, ze + 32);\n                o = b4(data, ze + 48);\n            }\n        }\n        var fltr = opts && opts.filter;\n        var _loop_3 = function (i) {\n            var _a = zh(data, o, z), c_1 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n            o = no;\n            var cbl = function (e, d) {\n                if (e) {\n                    tAll();\n                    cbd(e, null);\n                }\n                else {\n                    if (d)\n                        files[fn] = d;\n                    if (!--lft)\n                        cbd(null, files);\n                }\n            };\n            if (!fltr || fltr({\n                name: fn,\n                size: sc,\n                originalSize: su,\n                compression: c_1\n            })) {\n                if (!c_1)\n                    cbl(null, slc(data, b, b + sc));\n                else if (c_1 == 8) {\n                    var infl = data.subarray(b, b + sc);\n                    if (sc < 320000) {\n                        try {\n                            cbl(null, inflateSync(infl, new u8(su)));\n                        }\n                        catch (e) {\n                            cbl(e, null);\n                        }\n                    }\n                    else\n                        term.push(inflate(infl, { size: su }, cbl));\n                }\n                else\n                    cbl(err(14, 'unknown compression type ' + c_1, 1), null);\n            }\n            else\n                cbl(null, null);\n        };\n        for (var i = 0; i < c; ++i) {\n            _loop_3(i);\n        }\n    }\n    else\n        cbd(null, {});\n    return tAll;\n}\n/**\n * Synchronously decompresses a ZIP archive. Prefer using `unzip` for better\n * performance with more than one file.\n * @param data The raw compressed ZIP file\n * @param opts The ZIP extraction options\n * @returns The decompressed files\n */\nexport function unzipSync(data, opts) {\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558)\n            err(13);\n    }\n    ;\n    var c = b2(data, e + 8);\n    if (!c)\n        return {};\n    var o = b4(data, e + 16);\n    var z = o == 4294967295 || c == 65535;\n    if (z) {\n        var ze = b4(data, e - 12);\n        z = b4(data, ze) == 0x6064B50;\n        if (z) {\n            c = b4(data, ze + 32);\n            o = b4(data, ze + 48);\n        }\n    }\n    var fltr = opts && opts.filter;\n    for (var i = 0; i < c; ++i) {\n        var _a = zh(data, o, z), c_2 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        if (!fltr || fltr({\n            name: fn,\n            size: sc,\n            originalSize: su,\n            compression: c_2\n        })) {\n            if (!c_2)\n                files[fn] = slc(data, b, b + sc);\n            else if (c_2 == 8)\n                files[fn] = inflateSync(data.subarray(b, b + sc), new u8(su));\n            else\n                err(14, 'unknown compression type ' + c_2);\n        }\n    }\n    return files;\n}\n", "import { makeRe } from 'picomatch';\n\nexport class GlobExp {\n    /**\n     * @param {string|GlobExp} pattern \n     */\n    constructor(pattern) {\n        let source;\n        if (typeof pattern === 'object' && pattern instanceof GlobExp) {\n            source = pattern.source;\n        } else {\n            source = String(pattern);\n        }\n        this.source = source;\n\n        /** @private */\n        this._re = makeRe(source);\n    }\n\n    /**\n     * @param {string} string \n     * @returns {boolean}\n     */\n    test(string) {\n        return this._re.test(string);\n    }\n}\n", "import { GlobExp } from './GlobExp.js';\n\n/**\n * @typedef AssetStore\n * @property {Record<string, object>} store\n * @property {Record<string, Loading>} loadings\n * @property {Array<Fallback>} defaults\n */\n\n/**\n * @template T\n * @template {object} S\n * @callback AssetLoader\n * @param {string|ArrayBuffer} src\n * @param {S} [opts]\n * @returns {Promise<T>}\n */\n\nconst FILE_URI_PREFIX_PATTERN = /^([_\\w\\d]+)\\:\\/\\//;\n\n/**\n * Load asset using a loader with the given src.\n * - If loading to transform a cached asset, the cached uri must start with `res://` (or equivalent).\n * - If loading to transform cached raw buffers from an asset pack, use `raw://`.\n * - Otherwise, it will call `fetch()` on src.\n * \n * @template T, S\n * @param {AssetStore} assets\n * @param {string} uri \n * @param {string} src\n * @param {AssetLoader<T, S>} loader\n * @param {S} opts\n * @param {number} timeout\n * @returns {Promise<T>}\n */\n export async function loadInStore(assets, uri, src, loader, opts, timeout) {\n    const { loadings } = assets;\n    \n    let loading;\n    if (uri in loadings) {\n        loading = loadings[uri];\n    } else {\n        loading = new Loading(timeout);\n        loadings[uri] = loading;\n    }\n\n    const attempt = Loading.nextAttempt(loading);\n\n    /** @type {Array<Promise<T>>} */\n    let promises = [loading.promise];\n    if (FILE_URI_PREFIX_PATTERN.test(src)) {\n        // Loading from cached file\n        promises.push(getLoadedInStore(assets, src, timeout)\n            .then(cached => loader(cached, opts))\n            .then(value => Loading.isCurrentAttempt(loading, attempt)\n                ? cacheInStore(assets, uri, value)\n                : undefined));\n    } else {\n        // Fetching from network\n        promises.push(fetch(src)\n            .then(response => response.arrayBuffer())\n            .then(arr => loader(arr))\n            .then(value => Loading.isCurrentAttempt(loading, attempt)\n                ? cacheInStore(assets, uri, value)\n                : undefined));\n    }\n    return await Promise.race(promises);\n}\n\n/**\n * @template T\n * @param {AssetStore} assets\n * @param {string} uri\n * @param {T} value\n * @returns {T}\n */\nexport function cacheInStore(assets, uri, value) {\n    const { store, loadings } = assets;\n    store[uri] = value;\n    // Send asset to awaiting loaders...\n    if (uri in loadings) {\n        loadings[uri].resolve(value);\n        delete loadings[uri];\n    }\n    return value;\n}\n\n/**\n * @template T\n * @param {AssetStore} assets\n * @param {string|GlobExp} glob\n * @param {T} value\n * @returns {T}\n */\nexport function cacheDefaultInStore(assets, glob, value) {\n    const { defaults } = assets;\n    if (typeof glob === 'string') {\n        glob = new GlobExp(glob);\n    }\n    const uri = `__default://[${defaults.length}]`;\n    cacheInStore(assets, uri, value);\n    defaults.push(new Fallback(glob, uri));\n    return value;\n}\n\n/**\n * @param {AssetStore} assets\n * @param {string} uri\n */\nexport function unloadInStore(assets, uri) {\n    const { store, loadings } = assets;\n    if (uri in loadings) {\n        loadings[uri].reject(new Error('Stop loading to delete asset.'));\n        delete loadings[uri];\n    }\n    if (uri in store) {\n        delete store[uri];\n    }\n}\n\n/**\n * @param {AssetStore} assets\n * @param {string|GlobExp} glob\n */\nexport function clearInStore(assets, glob) {\n    if (typeof glob === 'string') {\n        glob = new GlobExp(glob);\n    }\n    const { store, loadings } = assets;\n    // Clear loadings\n    for (let [uri, loading] of Object.entries(loadings)) {\n        if (glob.test(uri)) {\n            loading.reject(new Error(`Stop loading to clear assets matching ${glob}`));\n            delete loadings[uri];\n        }\n    }\n    // Clear cache\n    for (let uri of Object.keys(store)) {\n        if (glob.test(uri)) {\n            delete store[uri];\n        }\n    }\n}\n\n/**\n * @param {AssetStore} assets \n */\nexport function resetStore(assets) {\n    const { store, loadings, defaults } = assets;\n    // Clear loadings\n    for (let [uri, loading] of Object.entries(loadings)) {\n        loading.reject(new Error(`Stop loading to clear all assets.`));\n        delete loadings[uri];\n    }\n    // Clear cache\n    for (let uri of Object.keys(store)) {\n        delete store[uri];\n    }\n    // Clear defaults\n    defaults.length = 0;\n}\n\n/**\n * @param {AssetStore} assets\n * @param {string} uri\n * @returns {Promise<object>}\n */\nexport function getLoadingInStore(assets, uri) {\n    const { loadings } = assets;\n    if (uri in loadings) {\n        return loadings[uri].promise;\n    } else {\n        return null;\n    }\n}\n\n/**\n * @param {AssetStore} assets \n * @param {string} uri \n */\nexport function cancelLoadingInStore(assets, uri) {\n    const { loadings } = assets;\n    for (let [uri, loading] of Object.entries(loadings)) {\n        loading.reject(new Error(`Stop loading to clear all assets.`));\n        delete loadings[uri];\n    }\n}\n\n/**\n * @param {AssetStore} assets\n * @param {string} uri\n * @param {number} timeout\n * @returns {Promise<object>}\n */\nexport async function getLoadedInStore(assets, uri, timeout) {\n    const { store, loadings } = assets;\n    if (uri in store) {\n        return store[uri];\n    } else if (uri in loadings) {\n        return loadings[uri].promise;\n    } else {\n        let loading = new Loading(timeout);\n        loadings[uri] = loading;\n        return loading.promise;\n    }\n}\n\n/**\n * @param {AssetStore} assets\n * @param {string} uri \n * @returns {object}\n */\nexport function getDefaultInStore(assets, uri) {\n    const { defaults } = assets;\n    for (let def of defaults) {\n        if (def.glob.test(uri)) {\n            return getCurrentInStore(assets, def.uri);\n        }\n    }\n    return null;\n}\n\n/**\n * @param {AssetStore} assets\n * @param {string} uri\n * @returns {object}\n */\nexport function getCurrentInStore(assets, uri) {\n    return assets.store[uri];\n}\n\n/**\n * @param {AssetStore} assets\n * @param {string} uri \n * @returns {boolean}\n */\nexport function hasInStore(assets, uri) {\n    return Boolean(assets.store[uri]);\n}\n\n/**\n * @param {AssetStore} assets\n * @returns {Array<string>}\n */\nexport function keysInStore(assets) {\n    return Object.keys(assets.store);\n}\n\n/**\n * @param {AssetStore} assets\n * @param {string} uri \n * @returns {boolean}\n */\nexport function isAssetCachedInStore(assets, uri) {\n    return uri in assets.store;\n}\n\n/**\n * @param {AssetStore} assets\n * @param {string} uri \n * @returns {boolean}\n */\nexport function isAssetLoadingInStore(assets, uri) {\n    return uri in assets.loadings;\n}\n\nclass Fallback {\n    /**\n     * @param {GlobExp} glob \n     * @param {string} uri \n     */\n    constructor(glob, uri) {\n        this.glob = glob;\n        this.uri = uri;\n    }\n}\n\nclass Loading {\n\n    /**\n     * @param {Loading} loading\n     */\n    static nextAttempt(loading) {\n        return ++loading._promiseHandle;\n    }\n\n    /**\n     * @param {Loading} loading \n     * @param {number} attempt\n     */\n    static isCurrentAttempt(loading, attempt) {\n        return loading._promiseHandle === attempt;\n    }\n\n    constructor(timeout) {\n        /** @private */\n        this._promiseHandle = 0;\n        /** @private */\n        this._resolve = null;\n        /** @private */\n        this._reject = null;\n        /** @private */\n        this._reason = null;\n        /** @private */\n        this._value = null;\n        /** @private */\n        this._timeoutHandle =\n            Number.isFinite(timeout) && timeout > 0\n                ? setTimeout(() => {\n                    this.reject(`Asset loading exceeded timeout of ${timeout} ms.`);\n                }, timeout)\n                : null;\n        /** @private */\n        this._promise = new Promise((resolve, reject) => {\n            if (this._value) {\n                resolve(this._value);\n            } else {\n                this._resolve = resolve;\n            }\n            if (this._reason) {\n                reject(this._reason);\n            } else {\n                this._reject = reject;\n            }\n        });\n    }\n\n    get promise() {\n        return this._promise;\n    }\n\n    resolve(value) {\n        if (this._timeoutHandle) {\n            clearTimeout(this._timeoutHandle);\n            this._timeoutHandle = null;\n        }\n        if (this._resolve) {\n            this._resolve(value);\n        } else {\n            this._value = value;\n        }\n    }\n\n    reject(reason) {\n        if (this._timeoutHandle) {\n            clearTimeout(this._timeoutHandle);\n            this._timeoutHandle = null;\n        }\n        if (this._reject) {\n            this._reject(reason);\n        } else {\n            this._reason = reason;\n        }\n    }\n}\n", "import { cacheDefaultInStore, cacheInStore, clearInStore, getCurrentInStore, getDefaultInStore, getLoadedInStore, getLoadingInStore, hasInStore, isAssetCachedInStore, isAssetLoadingInStore, keysInStore, loadInStore, resetStore, unloadInStore } from './AssetStore.js';\nimport { GlobExp } from './GlobExp.js';\n\nexport class AssetManager {\n\n    /**\n     * @param {AssetManager} [parent] \n     */\n    constructor(parent = null) {\n        this.parent = parent;\n        /** @private */\n        this.store = {};\n        /** @private */\n        this.loadings = {};\n        /** @private */\n        this.defaults = [];\n    }\n\n    /**\n     * @param {string} uri \n     * @returns {object}\n     */\n    get(uri) {\n        const assets = /** @type {import('./AssetStore').AssetStore} */ (/** @type {unknown} */ (this));\n        if (isAssetCachedInStore(assets, uri)) {\n            return getCurrentInStore(assets, uri);\n        }\n        let def = getDefaultInStore(assets, uri);\n        if (def) {\n            return def;\n        }\n        return null;\n    }\n\n    /**\n     * @template T, S\n     * @param {string} uri \n     * @param {string} filepath\n     * @param {import('./AssetStore').AssetLoader<T, S>} loader \n     * @param {S} opts \n     * @param {number} timeout \n     * @returns {Promise<T>}\n     */\n    async resolve(uri, filepath, loader, opts, timeout) {\n        return this.get(uri) || await this.load(uri, filepath, loader, opts, timeout);\n    }\n\n    /**\n     * @template T\n     * @param {string|GlobExp} uriGlob \n     * @param {T} value \n     * @returns {T}\n     */\n    fallback(uriGlob, value) {\n        const assets = /** @type {import('./AssetStore').AssetStore} */ (/** @type {unknown} */ (this));\n        return cacheDefaultInStore(assets, uriGlob, value);\n    }\n\n    /**\n     * @template T\n     * @param {string} uri \n     * @param {T} value \n     * @returns {T}\n     */\n    cache(uri, value) {\n        const assets = /** @type {import('./AssetStore').AssetStore} */ (/** @type {unknown} */ (this));\n        return cacheInStore(assets, uri, value);\n    }\n\n    /**\n     * @template T, S\n     * @param {string} uri \n     * @param {string} filepath\n     * @param {import('./AssetStore').AssetLoader<T, S>} loader \n     * @param {S} opts \n     * @param {number} timeout\n     * @returns {Promise<T>}\n     */\n    async load(uri, filepath, loader, opts, timeout) {\n        const assets = /** @type {import('./AssetStore').AssetStore} */ (/** @type {unknown} */ (this));\n        if (isAssetCachedInStore(assets, uri)) {\n            return getCurrentInStore(assets, uri);\n        } else if (isAssetLoadingInStore(assets, uri)) {\n            return await getLoadedInStore(assets, uri, timeout);\n        }\n        return await loadInStore(assets, uri, filepath, loader, opts, timeout);\n    }\n\n    /**\n     * @template T, S\n     * @param {string} uri \n     * @param {string} filepath\n     * @param {import('./AssetStore').AssetLoader<T, S>} loader \n     * @param {S} opts \n     * @param {number} timeout\n     * @returns {Promise<T>}\n     */\n    async reload(uri, filepath, loader, opts, timeout) {\n        const assets = /** @type {import('./AssetStore').AssetStore} */ (/** @type {unknown} */ (this));\n        return await loadInStore(assets, uri, filepath, loader, opts, timeout);\n    }\n\n    /**\n     * @param {string} uri \n     */\n    unload(uri) {\n        const assets = /** @type {import('./AssetStore').AssetStore} */ (/** @type {unknown} */ (this));\n        unloadInStore(assets, uri);\n    }\n\n    /**\n     * @param {string|GlobExp} uriGlob \n     */\n    clear(uriGlob) {\n        const assets = /** @type {import('./AssetStore').AssetStore} */ (/** @type {unknown} */ (this));\n        clearInStore(assets, uriGlob);\n    }\n\n    /**\n     * @param {string} uri\n     */\n    current(uri) {\n        const assets = /** @type {import('./AssetStore').AssetStore} */ (/** @type {unknown} */ (this));\n        return getCurrentInStore(assets, uri);\n    }\n\n    /**\n     * @param {string} uri \n     */\n    exists(uri) {\n        const assets = /** @type {import('./AssetStore').AssetStore} */ (/** @type {unknown} */ (this));\n        return hasInStore(assets, uri);\n    }\n\n    /**\n     * @param {string} uri \n     */\n    loading(uri) {\n        const assets = /** @type {import('./AssetStore').AssetStore} */ (/** @type {unknown} */ (this));\n        if (isAssetLoadingInStore(assets, uri)) {\n            return getLoadingInStore(assets, uri);\n        } else {\n            return null;\n        }\n    }\n\n    keys() {\n        const assets = /** @type {import('./AssetStore').AssetStore} */ (/** @type {unknown} */ (this));\n        return keysInStore(assets);\n    }\n\n    reset() {\n        const assets = /** @type {import('./AssetStore').AssetStore} */ (/** @type {unknown} */ (this));\n        resetStore(assets);\n    }\n}\n", "import { AssetManager } from './AssetManager';\n\nconst DEFAULT_TIMEOUT = 5000;\n\n/** @template T, S */\nexport class AssetRef {\n\n    /**\n     * @param {string} uri \n     * @param {import('./AssetStore').AssetLoader<T, S>} loader \n     * @param {S} [opts] \n     * @param {string} [filepath]\n     * @param {T|AssetRef<T>} [initial]\n     */\n    constructor(uri, loader, opts = undefined, filepath = uri, initial = null) {\n        this.uri = uri;\n        this.loader = loader;\n        this.opts = opts;\n\n        /** @private */\n        this.initial = initial;\n        /** @private */\n        this.filepath = filepath;\n\n        /** @type {AssetManager} */\n        this.source = null;\n        /** @type {T} */\n        this.current = null;\n    }\n\n    /**\n     * @param {AssetManager} assetManager \n     * @param {T} value \n     */\n    cache(assetManager, value) {\n        assetManager.cache(this.uri, value);\n        this.source = assetManager;\n        this.current = value;\n        return this;\n    }\n\n    /**\n     * @param {AssetManager} assetManager \n     * @returns {T}\n     */\n    get(assetManager) {\n        let result;\n        if (!assetManager.exists(this.uri)) {\n            if (this.initial && this.initial instanceof AssetRef) {\n                result = this.initial.get(assetManager);\n            } else {\n                result = this.initial;\n            }\n        } else {\n            result = assetManager.current(this.uri);\n        }\n        this.source = assetManager;\n        this.current = result;\n        return result;\n    }\n\n    /**\n     * @param {AssetManager} assetManager \n     * @param {number} [timeout]\n     */\n    async load(assetManager, timeout = DEFAULT_TIMEOUT) {\n        let result;\n        if (!assetManager.exists(this.uri)) {\n            result = await assetManager.load(this.uri, this.filepath, this.loader, this.opts, timeout);\n            if (!result) {\n                if (this.initial && this.initial instanceof AssetRef) {\n                    let initial = this.initial;\n                    result = await assetManager.load(initial.uri, initial.filepath, initial.loader, initial.opts, timeout);\n                } else {\n                    result = this.initial;\n                }\n            }\n        } else {\n            result = assetManager.current(this.uri);\n        }\n        this.source = assetManager;\n        this.current = result;\n        return result;\n    }\n\n    /**\n     * @param {AssetManager} assetManager \n     * @param {number} [timeout] \n     */\n    async reload(assetManager, timeout = DEFAULT_TIMEOUT) {\n        let result = await assetManager.reload(this.uri, this.filepath, this.loader, this.opts, timeout);\n        this.source = assetManager;\n        this.current = result;\n        return result;\n    }\n}\n", "import { unzip } from 'fflate';\n\nimport { cacheInStore } from './AssetStore.js';\nimport { AssetManager } from './AssetManager.js';\nimport { AssetRef } from './AssetRef.js';\n\n/**\n * Fetch asset pack from url and cache raw file content under `raw://`.\n * \n * @param {string} url\n * @param {(src: Uint8Array, path: string) => void} callback\n */\nexport async function loadAssetPack(url, callback) {\n    let response = await fetch(url);\n    let arrayBuffer = await response.arrayBuffer();\n    await new Promise((resolve, reject) => {\n        unzip(new Uint8Array(arrayBuffer), (err, data) => {\n            if (err) {\n                reject(err);\n            } else {\n                for (let [path, buf] of Object.entries(data)) {\n                    // Standardize WIN paths\n                    path = path.replaceAll('\\\\', '/');\n                    callback(buf, path);\n                }\n                resolve();\n            }\n        });\n    });\n}\n\n/**\n * Fetch asset pack from url and cache raw file content under `raw://`.\n * \n * @param {AssetManager} assets\n * @param {string} url\n * @param {(src: Uint8Array, uri: string, path: string) => void} [callback]\n */\nexport async function cacheAssetPackAsRaw(assets, url, callback = undefined) {\n    const assetStore = /** @type {import('./AssetStore').AssetStore} */ (/** @type {unknown} */ (assets));\n    let rootPath = 'raw://';\n    let response = await fetch(url);\n    let arrayBuffer = await response.arrayBuffer();\n    await new Promise((resolve, reject) => {\n        unzip(new Uint8Array(arrayBuffer), (err, data) => {\n            if (err) {\n                reject(err);\n            } else {\n                for (let [path, buf] of Object.entries(data)) {\n                    // Standardize WIN paths\n                    path = path.replaceAll('\\\\', '/');\n                    // Remove the zip directory name\n                    let i = path.indexOf('/');\n                    if (i >= 0) {\n                        path = path.substring(i + 1);\n                    }\n                    // Put the raw file in cache\n                    let uri = rootPath + path;\n                    cacheInStore(assetStore, uri, buf);\n                    if (callback) {\n                        callback(buf, uri, path);\n                    }\n                }\n                resolve();\n            }\n        });\n    });\n}\n\n/**\n * This is the same as calling `await AssetRef.load()` for each ref.\n * \n * @param {AssetManager} assets\n * @param {Array<AssetRef<?, ?>>} refs \n * @param {number} [timeout] \n */\nexport async function preloadAssetRefs(assets, refs, timeout = 5000) {\n    let promises = [];\n    for (let ref of refs) {\n        promises.push(ref.load(assets, timeout));\n    }\n    await Promise.allSettled(promises);\n}\n", "/**\n * @typedef {Record<string, AtlasSpriteData>} Atlas\n * \n * @typedef AtlasSpriteData\n * @property {number} u\n * @property {number} v\n * @property {number} w\n * @property {number} h\n * @property {number} frames\n * @property {number} cols\n * @property {number} rows\n * @property {string} name\n */\n\n/**\n * @param {string|ArrayBuffer} src\n * @param {{ onprogress: (value: number, loaded: number, total: number) => void }} opts\n * @returns {Promise<Atlas>}\n */\nexport async function AtlasLoader(src, opts = { onprogress: undefined }) {\n  if (typeof src === 'string') {\n    const response = await fetch(src);\n    const arrayBuffer = await response.arrayBuffer();\n    return AtlasLoader(arrayBuffer, opts);\n  } else if (!(src instanceof ArrayBuffer || ArrayBuffer.isView(src))) {\n    throw new Error('Cannot load from source - must be an array buffer or fetchable url.');\n  }\n  /** @type {ArrayBuffer} */\n  const arrayBuffer = src;\n  const string = new TextDecoder().decode(arrayBuffer);\n  /** @type {Atlas} */\n  let result = {};\n  let lines = string.split('\\n');\n  let progressTotal = lines.length;\n  let progressLoaded = 0;\n  if (opts.onprogress) {\n    opts.onprogress(0, 0, progressTotal);\n  }\n  for (let line of lines) {\n    ++progressLoaded;\n    line = line.trim();\n    if (line.length <= 0) continue;\n    if (line.startsWith('#')) continue;\n    if (line.startsWith('//')) continue;\n\n    let args = [];\n    let i = 0;\n    let j = line.indexOf(' ');\n    while (j >= 0) {\n      args.push(line.substring(i, j));\n      i = j + 1;\n      j = line.indexOf(' ', i);\n    }\n    args.push(line.substring(i));\n\n    let name = args[0];\n    let u = Number.parseInt(args[1]);\n    let v = Number.parseInt(args[2]);\n    let w = Number.parseInt(args[3]);\n    let h = Number.parseInt(args[4]);\n    let frames =\n      args.length >= 6\n        ? Number.parseInt(args[5]) // User-defined\n        : 1; // Default 1 frame\n    let cols =\n      args.length >= 7\n        ? Number.parseInt(args[6]) // User-defined\n        : frames; // Default same as frame count\n    let rows =\n      args.length >= 8\n        ? Number.parseInt(args[7]) // User-defined\n        : frames > cols // If more frames than cols...\n        ? Math.ceil(frames / cols) // ...then expect more rows\n        : 1; // Otherwise, default single row\n\n    result[name] = {\n      u,\n      v,\n      w,\n      h,\n      frames,\n      cols,\n      rows,\n      name,\n    };\n\n    if (opts.onprogress) {\n      opts.onprogress(progressLoaded / progressTotal, progressLoaded, progressTotal);\n    }\n  }\n  if (opts.onprogress) {\n    opts.onprogress(1, progressLoaded, progressLoaded);\n  }\n  return result;\n}\n", "/**\n * @typedef BMFontChar\n * @property {number} id The character id.\n * @property {number} x The left position of the character image in the texture.\n * @property {number} y The top position of the character image in the texture.\n * @property {number} width The width of the character image in the texture.\n * @property {number} height The height of the character image in the texture.\n * @property {number} xoffset How much the current position should be offset when\n *                            copying the image from the texture to the screen.\n * @property {number} yoffset How much the current position should be offset when\n *                            copying the image from the texture to the screen.\n * @property {number} xadvance How much the current position should be advanced\n *                             after drawing the character.\n * @property {number} page The texture page where the character image is found.\n * @property {number} chnl The texture channel where the character image is\n *                         found (1 = blue, 2 = green, 4 = red, 8 = alpha,\n *                         15 = all channels).\n *\n * @typedef BMFontKerning\n * @property {number} first The first character id.\n * @property {number} second The second character id.\n * @property {number} amount How much the x position should be adjusted when\n *                           drawing the second character immediately following\n *                           the first.\n *\n * @typedef BMFontData\n * @property {object} info              This tag holds information on how the\n *                                      font was generated.\n * @property {string} info.face         This is the name of the true type font.\n * @property {number} info.size         The size of the true type font.\n * @property {number} info.bold         The font is bold.\n * @property {number} info.italic\t    The font is italic.\n * @property {string} info.charset\t    The name of the OEM charset used (when\n *                                      not unicode).\n * @property {number} info.unicode\t    Set to 1 if it is the unicode charset.\n * @property {number} info.stretchH\t    The font height stretch in percentage.\n *                                      100% means no stretch.\n * @property {number} info.smooth\t    Set to 1 if smoothing was turned on.\n * @property {number} info.aa\t        The supersampling level used. 1 means no\n *                                      supersampling was used.\n * @property {number} info.padding\t    The padding for each character\n *                                      (up, right, down, left).\n * @property {number} info.spacing\t    The spacing for each character\n *                                      (horizontal, vertical).\n * @property {number} info.outline\t    The outline thickness for the characters.\n * @property {object} common            This tag holds information common to all\n *                                      characters.\n * @property {number} common.lineHeight This is the distance in pixels between\n *                                      each line of text.\n * @property {number} common.base\t    The number of pixels from the absolute\n *                                      top of the line to the base of the characters.\n * @property {number} common.scaleW\t    The width of the texture, normally used\n *                                      to scale the x pos of the character image.\n * @property {number} common.scaleH\t    The height of the texture, normally used\n *                                      to scale the y pos of the character image.\n * @property {number} common.pages\t    The number of texture pages included in\n *                                      the font.\n * @property {number} common.packed\t    Set to 1 if the monochrome characters\n *                                      have been packed into each of the texture\n *                                      channels. In this case alphaChnl describes\n *                                      what is stored in each channel.\n * @property {number} common.alphaChnl\tSet to 0 if the channel holds the glyph data,\n *                                      1 if it holds the outline,\n *                                      2 if it holds the glyph and the outline,\n *                                      3 if its set to zero, and 4 if its set to one.\n * @property {number} common.redChnl\tSet to 0 if the channel holds the glyph data,\n *                                      1 if it holds the outline,\n *                                      2 if it holds the glyph and the outline,\n *                                      3 if its set to zero, and 4 if its set to one.\n * @property {number} common.greenChnl\tSet to 0 if the channel holds the glyph data,\n *                                      1 if it holds the outline,\n *                                      2 if it holds the glyph and the outline,\n *                                      3 if its set to zero, and 4 if its set to one.\n * @property {number} common.blueChnl\tSet to 0 if the channel holds the glyph data,\n *                                      1 if it holds the outline,\n *                                      2 if it holds the glyph and the outline,\n *                                      3 if its set to zero, and 4 if its set to one.\n * @property {object} page              This tag gives the name of a texture\n *                                      file. There is one for each page in the font.\n * @property {number} page.id\t        The page id.\n * @property {number} page.file\t        The texture file name.\n * @property {Array<BMFontChar>} chars  This tag describes characters in the font.\n *                                      There is one for each included character\n *                                      in the font.\n * @property {Array<BMFontKerning>} kernings The kerning information is used to adjust\n *                                           the distance between certain characters,\n *                                           e.g. some characters should be placed\n *                                           closer to each other than others.\n */\n\n/**\n * @param {string|ArrayBuffer} src\n * @returns {Promise<BMFontData>}\n */\nexport async function BMFontLoader(src) {\n  if (typeof src === 'string') {\n    const response = await fetch(src);\n    const arrayBuffer = await response.arrayBuffer();\n    return BMFontLoader(arrayBuffer);\n  } else if (!(src instanceof ArrayBuffer || ArrayBuffer.isView(src))) {\n    throw new Error(\n      'Cannot load from source - must be ' + 'an array buffer or fetchable url'\n    );\n  }\n  /** @type {ArrayBuffer} */\n  const arrayBuffer = src;\n  return parse(new TextDecoder().decode(arrayBuffer));\n}\n\nconst TAG_PATTERN = /(.+?)\\s+(.*)/;\nconst LINE_PATTERN = /(.+)=(.+)/;\n\n/**\n * @param {string} string\n * @returns {BMFontData}\n */\nfunction parse(string) {\n  let lines = string.split('\\n');\n  let info = {};\n  let common = {};\n  let page = {};\n  let chars = [];\n  let kernings = [];\n  for (let line of lines) {\n    let array = TAG_PATTERN.exec(line);\n    if (!array) {\n      continue;\n    }\n    let [_, tag, props] = array;\n    switch (tag) {\n      case 'info':\n        parseBMLine(info, props);\n        break;\n      case 'common':\n        parseBMLine(common, props);\n        break;\n      case 'page':\n        parseBMLine(page, props);\n        break;\n      case 'chars':\n        // This only has count info. Ignore it.\n        break;\n      case 'char':\n        let char = {};\n        parseBMLine(char, props);\n        if ('id' in char) {\n          chars.push(char);\n        }\n        break;\n      case 'kerning':\n        let kerning = {};\n        parseBMLine(kerning, props);\n        if ('first' in kerning) {\n          kernings.push(kerning);\n        }\n        break;\n      default:\n      // Unknown tag.\n    }\n  }\n  let data = /** @type {BMFontData} */ ({\n    info,\n    common,\n    page,\n    chars,\n    kernings,\n  });\n  return data;\n}\n\nfunction parseBMLine(out, line) {\n  let props = line.split(/\\s+/);\n  for (let prop of props) {\n    let array = LINE_PATTERN.exec(prop);\n    if (!array) {\n      continue;\n    }\n    let [_, key, value] = array;\n    let result = JSON.parse(`[${value}]`);\n    if (result.length === 1) {\n      out[key] = result[0];\n    } else {\n      out[key] = result;\n    }\n  }\n}\n", "/**\n * @param {string|ArrayBuffer} src\n * @param {object} [opts]\n * @param {string} [opts.imageType]\n * @returns {Promise<HTMLImageElement>}\n */\nexport async function ImageLoader(src, opts = undefined) {\n  let { imageType = undefined } = opts || {};\n  if (typeof src === 'string') {\n    const response = await fetch(src);\n    const arrayBuffer = await response.arrayBuffer();\n    if (typeof imageType === 'undefined') {\n      let i = src.lastIndexOf('.');\n      if (i < 0) {\n        throw new Error('Cannot load from url - unknown image type.');\n      } else {\n        imageType = 'image/' + src.slice(i + 1);\n      }\n    }\n    return ImageLoader(arrayBuffer, { ...opts, imageType });\n  } else if (!(src instanceof ArrayBuffer || ArrayBuffer.isView(src))) {\n    throw new Error(\n      'Cannot load from source - must be ' + 'an array buffer or fetchable url'\n    );\n  }\n  /** @type {ArrayBuffer} */\n  const arrayBuffer = src;\n  if (typeof imageType === 'undefined') {\n    imageType = 'image/png';\n  }\n  let blob = new Blob([arrayBuffer], { type: imageType });\n  let imageUrl = URL.createObjectURL(blob);\n  let image = new Image();\n  return new Promise((resolve, reject) => {\n    image.addEventListener('load', () => {\n      resolve(image);\n    });\n    image.addEventListener('error', (e) => {\n      reject(e);\n    });\n    image.src = imageUrl;\n  });\n}\n", "/**\n * @typedef MeshData\n * @property {Float32Array} positions\n * @property {Float32Array} texcoords\n * @property {Float32Array} normals\n * @property {Uint16Array} indices\n */\n\n/**\n * @param {string|ArrayBuffer} src\n * @returns {Promise<MeshData>}\n */\nexport async function OBJLoader(src) {\n  if (typeof src === 'string') {\n    const response = await fetch(src);\n    const arrayBuffer = await response.arrayBuffer();\n    return OBJLoader(arrayBuffer);\n  } else if (!(src instanceof ArrayBuffer || ArrayBuffer.isView(src))) {\n    throw new Error(\n      'Cannot load from source - must be ' + 'an array buffer or fetchable url'\n    );\n  }\n  /** @type {ArrayBuffer} */\n  const arrayBuffer = src;\n  return parse(new TextDecoder().decode(arrayBuffer));\n}\n\n/**\n * @param {string} string\n * @returns {MeshData}\n */\nfunction parse(string) {\n  const vertexList = [];\n  const texcoordList = [];\n  const normalList = [];\n\n  const vertexIndices = [];\n  const texcoordIndices = [];\n  const normalIndices = [];\n\n  // # comments\n  const commentPattern = /^#.*/g;\n  // v float float float\n  const vertexPattern = /v\\s+(\\S+)\\s+(\\S+)\\s+(\\S+)/g;\n  // vn float float float\n  const normalPattern = /vn\\s+(\\S+)\\s+(\\S+)\\s+(\\S+)/g;\n  // vt float float float\n  const texcoordPattern = /vt\\s+(\\S+)\\s+(\\S+)/g;\n  // f vertex/uv/normal vertex/uv/normal vertex/uv/normal ...\n  const facePattern =\n    /f\\s+(([^/\\s]*)\\/([^/\\s]*)\\/?([^/\\s]*))\\s+(([^/\\s]*)\\/([^/\\s]*)\\/?([^/\\s]*))\\s+(([^/\\s]*)\\/([^/\\s]*)\\/?([^/\\s]*))(\\s+(([^/\\s]*)\\/([^/\\s]*)\\/?([^/\\s]*)))?/g;\n  // f float float float\n  const faceVertexPattern = /f\\s+([^/\\s]+)\\s+([^/\\s]+)\\s+([^/\\s]+)/g;\n\n  let quad = false;\n  let result = null;\n  let x, y, z, w;\n\n  // Remove all comments\n  string = string.replace(commentPattern, '');\n\n  // [\"v 1.0 2.0 3.0\", \"1.0\", \"2.0\", \"3.0\"]\n  while ((result = vertexPattern.exec(string)) != null) {\n    x = Number.parseFloat(result[1]);\n    y = Number.parseFloat(result[2]);\n    z = Number.parseFloat(result[3]);\n    vertexList.push(x);\n    vertexList.push(y);\n    vertexList.push(z);\n  }\n\n  // [\"vn 1.0 2.0 3.0\", \"1.0\", \"2.0\", \"3.0\"]\n  while ((result = normalPattern.exec(string)) != null) {\n    x = Number.parseFloat(result[1]);\n    y = Number.parseFloat(result[2]);\n    z = Number.parseFloat(result[3]);\n    normalList.push(x);\n    normalList.push(y);\n    normalList.push(z);\n  }\n\n  // [\"vt 1.0 2.0\", \"1.0\", \"2.0\"]\n  while ((result = texcoordPattern.exec(string)) != null) {\n    x = Number.parseFloat(result[1]);\n    y = Number.parseFloat(result[2]);\n    texcoordList.push(x);\n    texcoordList.push(y);\n  }\n\n  // [\"f 1/1/1 2/2/2 3/3/3\", \"1/1/1\", \"1\", \"1\", \"1\", \"2/2/2\", \"2\", \"2\", \"2\", \"3/3/3\", \"3\", \"3\", \"3\", \"4/4/4\", \"4\", \"4\", \"4\"]\n  while ((result = facePattern.exec(string)) != null) {\n    // Vertex indices\n    x = Number.parseInt(result[2]);\n    if (Number.isNaN(x)) x = 1;\n    y = Number.parseInt(result[6]);\n    if (Number.isNaN(y)) y = 1;\n    z = Number.parseInt(result[10]);\n    if (Number.isNaN(z)) z = 1;\n    vertexIndices.push(x);\n    vertexIndices.push(y);\n    vertexIndices.push(z);\n\n    // Normal indices\n    x = Number.parseInt(result[4]);\n    if (Number.isNaN(x)) {\n      // No UVs.\n      x = Number.parseInt(result[3]);\n      y = Number.parseInt(result[7]);\n      z = Number.parseInt(result[11]);\n      normalIndices.push(x);\n      normalIndices.push(y);\n      normalIndices.push(z);\n\n      texcoordIndices.push(1);\n      texcoordIndices.push(1);\n      texcoordIndices.push(1);\n    } else {\n      // Maybe UVs.\n      y = Number.parseInt(result[8]);\n      if (Number.isNaN(y)) y = 1;\n      z = Number.parseInt(result[12]);\n      if (Number.isNaN(z)) z = 1;\n      normalIndices.push(x);\n      normalIndices.push(y);\n      normalIndices.push(z);\n\n      // UV indices\n      x = Number.parseInt(result[3]);\n      if (Number.isNaN(x)) x = 1;\n      y = Number.parseInt(result[7]);\n      if (Number.isNaN(y)) y = 1;\n      z = Number.parseInt(result[11]);\n      if (Number.isNaN(z)) z = 1;\n      texcoordIndices.push(x);\n      texcoordIndices.push(y);\n      texcoordIndices.push(z);\n    }\n\n    // Quad face\n    if (typeof result[13] !== 'undefined') {\n      // Vertex indices\n      w = Number.parseInt(result[15]);\n      if (Number.isNaN(w)) w = 1;\n      vertexIndices.push(w);\n\n      // Normal indices\n      w = Number.parseInt(result[17]);\n      if (Number.isNaN(w)) {\n        // No UVs.\n        w = Number.parseInt(result[16]);\n        normalIndices.push(w);\n        texcoordIndices.push(1);\n      } else {\n        // Maybe UVs.\n        normalIndices.push(w);\n\n        w = Number.parseInt(result[16]);\n        texcoordIndices.push(w);\n      }\n\n      quad = true;\n    }\n  }\n\n  // [\"f 1 2 3 4\", \"1\", \"2\", \"3\", \"4\"]\n  while ((result = faceVertexPattern.exec(string)) != null) {\n    // Vertex indices\n    x = Number.parseInt(result[2]);\n    y = Number.parseInt(result[6]);\n    z = Number.parseInt(result[10]);\n    vertexIndices.push(x);\n    vertexIndices.push(y);\n    vertexIndices.push(z);\n\n    // UV indices\n    texcoordIndices.push(1);\n    texcoordIndices.push(1);\n    texcoordIndices.push(1);\n\n    // Normal indices\n    normalIndices.push(1);\n    normalIndices.push(1);\n    normalIndices.push(1);\n\n    // Quad face\n    if (typeof result[13] !== 'undefined') {\n      // Vertex indices\n      w = Number.parseInt(result[14]);\n      vertexIndices.push(w);\n\n      // UV indices\n      texcoordIndices.push(1);\n      // Normal indices\n      normalIndices.push(1);\n\n      quad = true;\n    }\n  }\n\n  let index, size;\n\n  size = vertexIndices.length;\n  const positions = new Float32Array(size * 3);\n  for (let i = 0; i < size; ++i) {\n    index = vertexIndices[i] - 1;\n    positions[i * 3 + 0] = vertexList[index * 3 + 0];\n    positions[i * 3 + 1] = vertexList[index * 3 + 1];\n    positions[i * 3 + 2] = vertexList[index * 3 + 2];\n  }\n\n  size = texcoordIndices.length;\n  const texcoords = new Float32Array(size * 2);\n  for (let i = 0; i < size; ++i) {\n    index = texcoordIndices[i] - 1;\n    texcoords[i * 2 + 0] = texcoordList[index * 2 + 0];\n    texcoords[i * 2 + 1] = texcoordList[index * 2 + 1];\n  }\n\n  size = normalIndices.length;\n  const normals = new Float32Array(size * 3);\n  for (let i = 0; i < size; ++i) {\n    index = normalIndices[i] - 1;\n    normals[i * 3 + 0] = normalList[index * 3 + 0];\n    normals[i * 3 + 1] = normalList[index * 3 + 1];\n    normals[i * 3 + 2] = normalList[index * 3 + 2];\n  }\n\n  // Must be either unsigned short or unsigned byte.\n  size = vertexIndices.length;\n  const indices = new Uint16Array(size);\n  for (let i = 0; i < size; ++i) {\n    indices[i] = i;\n  }\n\n  if (quad) {\n    console.warn('WebGL does not support quad faces, only triangles.');\n  }\n\n  return {\n    positions,\n    texcoords,\n    normals,\n    indices,\n  };\n}\n", "/**\n * @param {string|ArrayBuffer} src\n * @returns {Promise<string>}\n */\nexport async function TextLoader(src) {\n  if (typeof src === 'string') {\n    const response = await fetch(src);\n    const arrayBuffer = await response.arrayBuffer();\n    return TextLoader(arrayBuffer);\n  } else if (!(src instanceof ArrayBuffer || ArrayBuffer.isView(src))) {\n    throw new Error(\n      'Cannot load from source - must be ' + 'an array buffer or fetchable url'\n    );\n  }\n  /** @type {ArrayBuffer} */\n  const arrayBuffer = src;\n  return new TextDecoder().decode(arrayBuffer);\n}\n", "/**\n * @param {ArrayBuffer|Uint8Array|string} src\n * @param {object} opts\n * @param {AudioContext} opts.audioContext\n * @returns {Promise<AudioBuffer>}\n */\nexport async function AudioBufferLoader(src, opts) {\n  const { audioContext } = opts || {};\n  if (typeof src === 'string') {\n    const response = await fetch(src);\n    const arrayBuffer = await response.arrayBuffer();\n    return AudioBufferLoader(arrayBuffer, { audioContext });\n  } else if (!(src instanceof ArrayBuffer || ArrayBuffer.isView(src))) {\n    throw new Error(\n      'Cannot load from source - must be ' + 'an array buffer or fetchable url'\n    );\n  }\n  /** @type {ArrayBuffer} */\n  const arrayBuffer = src;\n  let audioArrayBuffer = new ArrayBuffer(arrayBuffer.byteLength);\n  new Uint8Array(audioArrayBuffer).set(arrayBuffer);\n  let audioBuffer = await audioContext.decodeAudioData(audioArrayBuffer);\n  return audioBuffer;\n}\n", "import { AssetManager, GlobExp } from '@milque/asset';\n\nexport class AssetPipeline {\n  constructor(assets) {\n    /**\n     * @private\n     * @type {Record<string, PipelineStage>}\n     */\n    this._pipeline = {};\n\n    this.assets = assets;\n  }\n\n  /**\n   * @param {string|GlobExp} filter\n   * @param {(assetData, uri) => Promise<any>} handler\n   */\n  async pipe(filter, handler) {\n    let matcher = new GlobExp(filter);\n    let filterKey = matcher.source;\n\n    /** @type {PipelineStage} */\n    let stage;\n    if (filterKey in this._pipeline) {\n      stage = this._pipeline[filterKey];\n    } else {\n      stage = new PipelineStage(matcher);\n      this._pipeline[filterKey] = stage;\n    }\n    stage.addHandler(handler);\n\n    // Process old assets with new handler...\n    for(let uri of this.assets.keys()) {\n      if (stage.matches(uri)) {\n        await handler(this.assets.current(uri), uri);\n      }\n    }\n  }\n}\n\nclass PipelineStage {\n  /**\n   * @param {GlobExp} filter \n   */\n  constructor(filter) {\n    this.filter = filter;\n    this.handlers = [];\n  }\n\n  matches(string) {\n    return this.filter.test(string);\n  }\n\n  async process(uri, asset) {\n    return Promise.all(this.handlers.map((value) => value(uri, asset)));\n  }\n\n  addHandler(handler) {\n    this.handlers.push(handler);\n  }\n}\n", "/**\n * @typedef Eventable\n * @property {function} on\n * @property {function} off\n * @property {function} once\n * @property {function} emit\n */\n\n/**\n * @version 1.3.0\n * @description\n * # Changelog\n * ## 1.3.0\n * - Return results for emit()\n * ## 1.2.0\n * - Added named exports\n * - Added custom this context\n * - Added some needed explanations for the functions\n * ## 1.1.0\n * - Started versioning\n */\nconst EventableInstance = {\n  /**\n   * Registers an event handler to continually listen for the event.\n   *\n   * @param {string} event The name of the event to listen for.\n   * @param {function} callback The callback function to handle the event.\n   * @param {*} [handle = callback] The handle to refer to this registered callback.\n   * Used by off() to remove handlers. If none specified, it will use the callback\n   * itself as the handle. This must be unique.\n   * @return {Eventable} Self for method-chaining.\n   */\n  on(event, callback, handle = callback) {\n    let callbacks;\n    if (!this.__events.has(event)) {\n      callbacks = new Map();\n      this.__events.set(event, callbacks);\n    } else {\n      callbacks = this.__events.get(event);\n    }\n\n    if (!callbacks.has(handle)) {\n      callbacks.set(handle, callback);\n    } else {\n      throw new Error(\n        `Found callback for event '${event}' with the same handle '${handle}'.`\n      );\n    }\n    return this;\n  },\n\n  /**\n   * Unregisters an event handler to stop listening for the event.\n   *\n   * @param {string} event The name of the event listened for.\n   * @param {*} handle The registered handle to refer to the registered\n   * callback. If no handle was provided when calling on(), the callback\n   * is used as the handle instead.\n   * @return {Eventable} Self for method-chaining.\n   */\n  off(event, handle) {\n    if (this.__events.has(event)) {\n      const callbacks = this.__events.get(event);\n      if (callbacks.has(handle)) {\n        callbacks.delete(handle);\n      } else {\n        throw new Error(\n          `Unable to find callback for event '${event}' with handle '${handle}'.`\n        );\n      }\n    } else {\n      throw new Error(`Unable to find event '${event}'.`);\n    }\n    return this;\n  },\n\n  /**\n   * Registers a one-off event handler to start listening for the next,\n   * and only the next, event.\n   *\n   * @param {string} event The name of the event to listen for.\n   * @param {function} callback The callback function to handle the event.\n   * @param {*} [handle = callback] The handle to refer to this registered callback.\n   * Used by off() to remove handlers. If none specified, it will use the callback\n   * itself as the handle. This must be unique.\n   * @return {Eventable} Self for method-chaining.\n   */\n  once(event, callback, handle = callback) {\n    const func = (...args) => {\n      this.off(event, handle);\n      callback.apply(this.__context || this, args);\n    };\n    return this.on(event, func, handle);\n  },\n\n  /**\n   * Emits the event with the arguments passed on to the registered handlers.\n   * The context of the handlers, if none were initially bound, could be\n   * defined upon calling the Eventable's creation function. Otherwise, the\n   * handler is called with `this` context of the Eventable instance.\n   *\n   * @param {string} event The name of the event to emit.\n   * @param  {...any} args Any arguments to pass to registered handlers.\n   * @return {Array<any>} Array of any returned values of the callbacks.\n   */\n  emit(event, ...args) {\n    if (this.__events.has(event)) {\n      let results = [];\n      const callbacks = Array.from(this.__events.get(event).values());\n      for (const callback of callbacks) {\n        let result = callback.apply(this.__context || this, args);\n        if (result) results.push(result);\n      }\n      return results;\n    } else {\n      this.__events.set(event, new Map());\n      return [];\n    }\n  },\n};\n\n/**\n * Creates an eventable object.\n *\n * @param {Object} [context] The context used for the event handlers.\n * @return {Eventable} The created eventable object.\n */\nfunction create(context = undefined) {\n  const result = Object.create(EventableInstance);\n  result.__events = new Map();\n  result.__context = context;\n  return result;\n}\n\n/**\n * Assigns the passed-in object with eventable properties.\n *\n * @param {Object} dst The object to assign with eventable properties.\n * @param {Object} [context] The context used for the event handlers.\n * @return {Eventable} The resultant eventable object.\n */\nfunction assign(dst, context = undefined) {\n  const result = Object.assign(dst, EventableInstance);\n  result.__events = new Map();\n  result.__context = context;\n  return result;\n}\n\n/**\n * Mixins eventable properties into the passed-in class.\n *\n * @param {Class} targetClass The class to mixin eventable properties.\n * @param {Object} [context] The context used for the event handlers.\n * @return {Class<Eventable>} The resultant eventable-mixed-in class.\n */\nfunction mixin(targetClass, context = undefined) {\n  const targetPrototype = targetClass.prototype;\n  Object.assign(targetPrototype, EventableInstance);\n  targetPrototype.__events = new Map();\n  targetPrototype.__context = context;\n  return targetPrototype;\n}\n\nexport const Eventable = {\n  create,\n  assign,\n  mixin,\n};\n", "/* eslint-disable no-console */\n\n// Log levels\nconst TRACE = 5;\nconst DEBUG = 4;\nconst INFO = 3;\nconst WARN = 2;\nconst ERROR = 1;\nconst OFF = 0;\n\nconst LOG_LEVEL_STYLES = {\n  [TRACE]: styledLogLevel('#7F8C8D'), // Gray\n  [DEBUG]: styledLogLevel('#2ECC71'), // Green\n  [INFO]: styledLogLevel('#4794C8'), // Blue\n  [WARN]: styledLogLevel('#F39C12'), // Yellow\n  [ERROR]: styledLogLevel('#C0392B'), // Red\n  [OFF]: [''],\n};\n\nfunction compareLogLevel(a, b) {\n  return a - b;\n}\n\nfunction styledLogLevel(color) {\n  return [\n    `background: ${color}`,\n    'border-radius: 0.5em',\n    'color: white',\n    'font-weight: bold',\n    'padding: 2px 0.5em',\n  ];\n}\n\n// Useful functions\nfunction noop() {\n  /** Do nothing. */\n}\n\nfunction getStyledMessage(message, styles) {\n  return [`%c${message}`, styles.join(';')];\n}\n\nfunction getConsoleFunction(level) {\n  switch (level) {\n    case TRACE:\n      return console.trace;\n    case DEBUG:\n      return console.log;\n    case INFO:\n      return console.log;\n    case WARN:\n      return console.warn;\n    case ERROR:\n      return console.error;\n    case OFF:\n      return noop;\n    default:\n      return console.log;\n  }\n}\n\nfunction prependMessageTags(out, name, domain, level) {\n  if (name) {\n    out.unshift(`[${name}]`);\n  }\n\n  if (domain) {\n    let tag = getStyledMessage(domain, LOG_LEVEL_STYLES[level]);\n    out.unshift(tag[0], tag[1]);\n  }\n\n  return out;\n}\n\nconst LEVEL = Symbol('level');\nconst DOMAIN = Symbol('domain');\nconst LOGGERS = {\n  /** To be populated by logger instances. */\n};\nlet DEFAULT_LEVEL = WARN;\nlet DEFAULT_DOMAIN = 'app';\nexport class Logger {\n  static get TRACE() {\n    return TRACE;\n  }\n  static get DEBUG() {\n    return DEBUG;\n  }\n  static get INFO() {\n    return INFO;\n  }\n  static get WARN() {\n    return WARN;\n  }\n  static get ERROR() {\n    return ERROR;\n  }\n  static get OFF() {\n    return OFF;\n  }\n\n  /**\n   * Creates or gets the logger for the given unique name.\n   * @param {String} name\n   * @returns {Logger} The logger with the name.\n   */\n  static getLogger(name) {\n    if (name in LOGGERS) {\n      return LOGGERS[name];\n    } else {\n      return (LOGGERS[name] = new Logger(name));\n    }\n  }\n\n  static useDefaultLevel(level) {\n    DEFAULT_LEVEL = level;\n    return this;\n  }\n\n  static useDefaultDomain(domain) {\n    DEFAULT_DOMAIN = domain;\n    return this;\n  }\n\n  constructor(name) {\n    this.name = name;\n    this[LEVEL] = DEFAULT_LEVEL;\n    this[DOMAIN] = DEFAULT_DOMAIN;\n  }\n\n  setLevel(level) {\n    this[LEVEL] = level;\n    return this;\n  }\n\n  getLevel() {\n    return this[LEVEL];\n  }\n\n  setDomain(domain) {\n    this[DOMAIN] = domain;\n    return this;\n  }\n\n  getDomain() {\n    return this[DOMAIN];\n  }\n\n  log(level, ...messages) {\n    if (compareLogLevel(this[LEVEL], level) < 0) return this;\n    prependMessageTags(messages, this.name, this[DOMAIN], level);\n    getConsoleFunction(level)(...messages);\n  }\n\n  trace(...messages) {\n    if (compareLogLevel(this[LEVEL], TRACE) < 0) return this;\n    prependMessageTags(messages, this.name, this[DOMAIN], TRACE);\n    getConsoleFunction(TRACE)(...messages);\n  }\n\n  debug(...messages) {\n    if (compareLogLevel(this[LEVEL], DEBUG) < 0) return this;\n    prependMessageTags(messages, this.name, this[DOMAIN], DEBUG);\n    getConsoleFunction(DEBUG)(...messages);\n  }\n\n  info(...messages) {\n    if (compareLogLevel(this[LEVEL], INFO) < 0) return this;\n    prependMessageTags(messages, this.name, this[DOMAIN], INFO);\n    getConsoleFunction(INFO)(...messages);\n  }\n\n  warn(...messages) {\n    if (compareLogLevel(this[LEVEL], WARN) < 0) return this;\n    prependMessageTags(messages, this.name, this[DOMAIN], WARN);\n    getConsoleFunction(WARN)(...messages);\n  }\n\n  error(...messages) {\n    if (compareLogLevel(this[LEVEL], ERROR) < 0) return this;\n    prependMessageTags(messages, this.name, this[DOMAIN], ERROR);\n    getConsoleFunction(ERROR)(...messages);\n  }\n}\n", "// Bresenham's Line Algorithm\nexport function bresenhamLine(fromX, fromY, toX, toY, callback) {\n  let fx = Math.floor(fromX);\n  let fy = Math.floor(fromY);\n  let tx = Math.floor(toX);\n  let ty = Math.floor(toY);\n\n  let dx = Math.abs(toX - fromX);\n  let sx = fromX < toX ? 1 : -1;\n  let dy = -Math.abs(toY - fromY);\n  let sy = fromY < toY ? 1 : -1;\n  let er = dx + dy;\n\n  let x = fx;\n  let y = fy;\n  let flag = callback(x, y);\n  if (typeof flag !== 'undefined') return flag;\n\n  let maxLength = dx * dx + dy * dy;\n  let length = 0;\n  while (length < maxLength && (x !== tx || y !== ty)) {\n    // Make sure it doesn't go overboard.\n    ++length;\n\n    let er2 = er * 2;\n\n    if (er2 >= dy) {\n      er += dy;\n      x += sx;\n    }\n\n    if (er2 <= dx) {\n      er += dx;\n      y += sy;\n    }\n\n    flag = callback(x, y);\n    if (typeof flag !== 'undefined') return flag;\n  }\n}\n", "export const FILE_TYPE_PNG = 'png';\nexport const FILE_TYPE_SVG = 'svg';\n\nexport function downloadText(filename, textData) {\n  downloadURL(filename, getTextDataURI(textData));\n}\n\nexport function downloadImageFromSVG(filename, filetype, svg, width, height) {\n  const blob = createBlobFromSVG(svg);\n  switch (filetype) {\n    case FILE_TYPE_PNG:\n      {\n        const url = URL.createObjectURL(blob);\n\n        const canvas = document.createElement('canvas');\n        const ctx = canvas.getContext('2d');\n        const pixelRatio = window.devicePixelRatio || 1;\n        canvas.width = width * pixelRatio;\n        canvas.height = height * pixelRatio;\n        canvas.style.width = width + 'px';\n        canvas.style.height = height + 'px';\n        ctx.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);\n\n        const image = new Image();\n        image.onload = () => {\n          ctx.drawImage(image, 0, 0);\n          URL.revokeObjectURL(url);\n\n          const imageURI = canvas\n            .toDataURL('image/' + filetype)\n            .replace('image/' + filetype, 'image/octet-stream');\n          downloadURL(filename, imageURI);\n        };\n        image.src = url;\n      }\n      break;\n    case FILE_TYPE_SVG:\n      {\n        const reader = new FileReader();\n        reader.onload = () => {\n          downloadURL(filename, reader.result);\n        };\n        reader.readAsDataURL(blob);\n      }\n      break;\n    default:\n      throw new Error(\"Unknown file type '\" + filetype + \"'\");\n  }\n}\n\nexport function downloadURL(filename, url) {\n  const element = document.createElement('a');\n  const headerIndex = url.indexOf(';');\n  url =\n    url.substring(0, headerIndex + 1) +\n    'headers=Content-Disposition%3A%20attachment%3B%20filename=' +\n    filename +\n    ';' +\n    url.substring(headerIndex + 1);\n  element.setAttribute('href', url);\n  element.setAttribute('download', filename);\n\n  element.style.display = 'none';\n  document.body.appendChild(element);\n\n  element.click();\n  document.body.removeChild(element);\n}\n\nfunction createBlobFromSVG(svg) {\n  const styledSVG = computeSVGStyles(svg);\n  const serializer = new XMLSerializer();\n  const svgString = serializer.serializeToString(styledSVG);\n  const blob = new Blob([svgString], { type: 'image/svg+xml' });\n  return blob;\n}\n\n// SOURCE: https://stackoverflow.com/questions/3975499/convert-svg-to-image-jpeg-png-etc-in-the-browser/44769098#44769098\nconst SVG_CONTAINERS = ['svg', 'g'];\nfunction computeSVGStyles(svg, dst = svg.cloneNode(true)) {\n  let sourceChildren = svg.childNodes;\n  let children = dst.childNodes;\n\n  for (var index = 0; index < children.length; index++) {\n    let child = children[index];\n    let tagName = child.tagName;\n    if (SVG_CONTAINERS.indexOf(tagName) != -1) {\n      computeSVGStyles(sourceChildren[index], child);\n    } else if (sourceChildren[index] instanceof Element) {\n      const computedStyle = window.getComputedStyle(sourceChildren[index]);\n\n      let styleAttributes = [];\n      for (let styleName of Object.keys(computedStyle)) {\n        styleAttributes.push(\n          `${styleName}:${computedStyle.getPropertyValue(styleName)};`\n        );\n      }\n\n      child.setAttribute('style', styleAttributes.join(''));\n    }\n  }\n\n  return dst;\n}\n\nfunction getTextDataURI(data) {\n  return 'data:text/plain; charset=utf-8,' + encodeURIComponent(data);\n}\n", "export async function uploadFile(accept = [], multiple = false) {\n  return new Promise((resolve, reject) => {\n    const element = document.createElement('input');\n    element.addEventListener('change', (e) => {\n      if (multiple) {\n        resolve(e.target.files);\n      } else {\n        resolve(e.target.files[0]);\n      }\n    });\n    element.type = 'file';\n    element.accept = accept.join(',');\n    element.style.display = 'none';\n    element.toggleAttribute('multiple', multiple);\n    document.body.appendChild(element);\n    element.click();\n    document.body.removeChild(element);\n  });\n}\n", "const TOP_INDEX = 0;\n\n// NOTE: Uses a binary heap to sort.\n/**\n * @template T\n */\nexport class PriorityQueue {\n  /**\n   * @param {(a: T, b: T) => number} comparator \n   */\n  constructor(comparator) {\n    /** @private */\n    this._heap = [];\n    /** @private */\n    this._comparator = comparator;\n  }\n\n  get size() {\n    return this._heap.length;\n  }\n\n  clear() {\n    this._heap.length = 0;\n  }\n\n  /**\n   * @param {...T} values\n   */\n  push(...values) {\n    for (let value of values) {\n      this._heap.push(value);\n      this._shiftUp();\n    }\n  }\n\n  /**\n   * @returns {T}\n   */\n  pop() {\n    const result = this.peek();\n    let bottom = bottomIndex(this);\n    if (bottom > TOP_INDEX) {\n      this._swap(TOP_INDEX, bottom);\n    }\n    this._heap.pop();\n    this._shiftDown();\n    return result;\n  }\n\n  /**\n   * Replaces the top value with the new value.\n   * @param {T} value\n   * @returns {T}\n   */\n  replace(value) {\n    const result = this.peek();\n    this._heap[TOP_INDEX] = value;\n    this._shiftDown();\n    return result;\n  }\n\n  /**\n   * @returns {T}\n   */\n  peek() {\n    return this._heap[TOP_INDEX];\n  }\n\n  /**\n   * @param {number} index\n   * @returns {T}\n   */\n  at(index) {\n    return this._heap[index];\n  }\n\n  /**\n   * @param {T} value \n   * @param {number} [fromIndex]\n   */\n  indexOf(value, fromIndex = undefined) {\n    return this._heap.indexOf(value, fromIndex);\n  }\n\n  /**\n   * @param {number} start \n   * @param {number} [deleteCount]\n   * @returns {Array<T>}\n   */\n  splice(start, deleteCount = undefined) {\n    return this._heap.splice(start, deleteCount);\n  }\n\n  /** @private */\n  _compare(i, j) {\n    return this._comparator(this._heap[i], this._heap[j]);\n  }\n\n  /** @private */\n  _swap(i, j) {\n    let result = this._heap[i];\n    this._heap[i] = this._heap[j];\n    this._heap[j] = result;\n  }\n\n  /** @private */\n  _shiftUp() {\n    let node = this._heap.length - 1;\n    let nodeParent;\n    while (\n      node > TOP_INDEX &&\n      this._compare(node, (nodeParent = parentIndex(node)))\n    ) {\n      this._swap(node, nodeParent);\n      node = nodeParent;\n    }\n  }\n\n  /** @private */\n  _shiftDown() {\n    const length = this._heap.length;\n    let node = TOP_INDEX;\n    let nodeMax;\n\n    let nodeLeft = leftIndex(node);\n    let flagLeft = nodeLeft < length;\n    let nodeRight = rightIndex(node);\n    let flagRight = nodeRight < length;\n\n    while (\n      (flagLeft && this._compare(nodeLeft, node)) ||\n      (flagRight && this._compare(nodeRight, node))\n    ) {\n      nodeMax =\n        flagRight && this._compare(nodeRight, nodeLeft) ? nodeRight : nodeLeft;\n      this._swap(node, nodeMax);\n      node = nodeMax;\n\n      nodeLeft = leftIndex(node);\n      flagLeft = nodeLeft < length;\n      nodeRight = rightIndex(node);\n      flagRight = nodeRight < length;\n    }\n  }\n\n  /** @returns {Array<T>} */\n  values() {\n    return this._heap;\n  }\n\n  /** @returns {Iterator<T>} */\n  [Symbol.iterator]() {\n    return this._heap[Symbol.iterator]();\n  }\n}\n\nfunction bottomIndex(queue) {\n  return queue._heap.length - 1;\n}\n\nfunction parentIndex(i) {\n  return ((i + 1) >>> 1) - 1;\n}\n\nfunction leftIndex(i) {\n  return (i << 1) + 1;\n}\n\nfunction rightIndex(i) {\n  return (i + 1) << 1;\n}\n", "/**\n * Generates a uuid v4.\n *\n * @param {number} a The placeholder (serves for recursion within function).\n * @returns {string} The universally unique id.\n */\nexport function uuid(a = undefined) {\n  // https://gist.github.com/jed/982883\n  return a\n    ? (a ^ ((Math.random() * 16) >> (a / 4))).toString(16)\n    : ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, uuid);\n}\n", "export function lerp(a, b, t) {\n  return a + (b - a) * t;\n}\n\nexport function clamp(value, min, max) {\n  return Math.min(max, Math.max(min, value));\n}\n\nexport function cycle(value, min, max) {\n  let range = max - min;\n  let result = (value - min) % range;\n  if (result < 0) result += range;\n  return result + min;\n}\n\nexport function withinRadius(fromX, fromY, toX, toY, radius) {\n  const dx = fromX - toX;\n  const dy = fromY - toY;\n  return dx * dx + dy * dy <= radius * radius;\n}\n\nexport function distance2(fromX, fromY, toX, toY) {\n  let dx = toX - fromX;\n  let dy = toY - fromY;\n  return Math.sqrt(dx * dx + dy * dy);\n}\n\nexport function direction2(fromX, fromY, toX, toY) {\n  let dx = toX - fromX;\n  let dy = toY - fromY;\n  return Math.atan2(dy, dx);\n}\n\nexport function lookAt2(radians, target, dt) {\n  let step = cycle(target - radians, -Math.PI, Math.PI);\n  return clamp(radians + step, radians - dt, radians + dt);\n}\n\nconst TO_RAD_FACTOR = Math.PI / 180;\nconst TO_DEG_FACTOR = 180 / Math.PI;\nexport function toRadians(degrees) {\n  return degrees * TO_RAD_FACTOR;\n}\n\nexport function toDegrees(radians) {\n  return radians * TO_DEG_FACTOR;\n}\n", "/**\n * @callback DependencyCallback\n * @param {Object} node The target node to get the dependencies for.\n * @returns {Array<Object>} A list of all dependencies for the given node.\n */\n\n/**\n * Sort an array topologically.\n *\n * @param {Array<Object>} nodes List of all nodes (as long as it includes the root node).\n * @param {DependencyCallback} dependencyCallback A callback to get the dependencies of a node.\n * @returns {Array<Object>} A sorted array of node objects where the dependent nodes are always listed before the dependees.\n */\nexport function topoSort(nodes, dependencyCallback) {\n  let dependencyEntries = [];\n  for (let node of nodes) {\n    let outs = dependencyCallback(node);\n    if (Array.isArray(outs)) {\n      dependencyEntries.push([node, ...outs]);\n    } else if (outs) {\n      throw new Error('Dependency callback must return an array.');\n    }\n  }\n  return computeDependencyList(\n    getNodesFromDependencyEntries(dependencyEntries),\n    getEdgesFromDependencyEntries(dependencyEntries)\n  );\n}\n\nfunction getNodesFromDependencyEntries(dependencyEntries) {\n  let result = new Set();\n  for (let dependencyEntry of dependencyEntries) {\n    for (let value of dependencyEntry) {\n      result.add(value);\n    }\n  }\n  return Array.from(result);\n}\n\nfunction getEdgesFromDependencyEntries(dependencyEntries) {\n  let result = [];\n  for (let dependencyEntry of dependencyEntries) {\n    let source = dependencyEntry[0];\n    for (let i = 1; i < dependencyEntry.length; ++i) {\n      let dependency = dependencyEntry[i];\n      result.push([source, dependency]);\n    }\n  }\n  return result;\n}\n\nfunction computeDependencyList(nodes, edges, dst = []) {\n  // Compute edge outs (more efficient lookup)\n  let edgeOuts = new Map();\n  for (let edge of edges) {\n    if (edge.length > 1) {\n      let source = edge[0];\n      let dest = edge[1];\n      if (!edgeOuts.has(source)) edgeOuts.set(source, new Set());\n      if (!edgeOuts.has(dest)) edgeOuts.set(dest, new Set());\n      edgeOuts.get(source).add(dest);\n    }\n  }\n\n  let context = {\n    edgeMap: edgeOuts,\n    index: nodes.length,\n    visited: new Set(),\n    dst,\n  };\n\n  for (let node of nodes) {\n    visit(context, node, new Set());\n  }\n\n  return dst;\n}\n\nfunction visit(context, node, prev) {\n  if (prev.has(node)) {\n    throw new Error(`Found cyclic dependency for '${node.name || node}'.`);\n  }\n\n  if (context.visited.has(node)) return;\n  context.visited.add(node);\n\n  if (context.edgeMap.has(node)) {\n    let outs = context.edgeMap.get(node);\n    if (outs.size > 0) {\n      prev.add(node);\n      for (let out of outs) {\n        visit(context, out, prev);\n      }\n      prev.delete(node);\n    }\n  }\n\n  context.dst.push(node);\n}\n", "/**\n * @template T\n * @typedef NodeCache<T>\n * @property {Record<T, number>} fscore\n * @property {Record<T, number>} gscore\n * @property {Record<T, number>} hscore\n * @property {Record<T, T>} parents\n */\n\n/**\n * @template T\n * @param {T} startId The unique representation of the starting position. Must be deterministic.\n * @param {T} goalId The unique representation of the stopping position. Must be deterministic.\n * @param {(node: T) => Array<T>} neighborsCallback Get all reachable neighbors from the given node.\n * @param {(from: T, to: T) => number} heuristicCallback Get the heuristics score between the two nodes.\n * @returns {Array<T>} If the goal is not reachable from the start, it will return an empty array.\n */\nexport function astarSearch(\n  startId,\n  goalId,\n  neighborsCallback,\n  heuristicCallback\n) {\n  /** @type {NodeCache<T>} */\n  let cache = createCache();\n  cacheNode(cache, startId);\n  let opened = new Set();\n  let closed = new Set();\n  opened.add(startId);\n  while (opened.size > 0) {\n    let minNodeId;\n    for (let openNodeId of opened) {\n      if (minNodeId) {\n        if (cache.fscore[openNodeId] < cache.fscore[minNodeId]) {\n          minNodeId = openNodeId;\n        }\n      } else {\n        minNodeId = openNodeId;\n      }\n    }\n\n    let currentNodeId = minNodeId;\n    if (currentNodeId === goalId) {\n      // Completed!\n      let result = [];\n      while (cache.parents[currentNodeId]) {\n        result.push(currentNodeId);\n        currentNodeId = cache.parents[currentNodeId];\n      }\n      result.push(currentNodeId);\n      return result.reverse();\n    } else {\n      // Not there yet...\n      closed.add(currentNodeId);\n      opened.delete(currentNodeId);\n      for (let neighborNodeId of neighborsCallback(currentNodeId)) {\n        if (closed.has(neighborNodeId)) continue;\n        let g = cache.gscore[currentNodeId] + 1;\n        let flag = false;\n        if (!opened.has(neighborNodeId)) {\n          flag = true;\n          cacheNode(cache, neighborNodeId);\n          cache.hscore[neighborNodeId] = heuristicCallback(\n            neighborNodeId,\n            goalId\n          );\n          opened.add(neighborNodeId);\n        } else if (g < cache.gscore[neighborNodeId]) {\n          flag = true;\n        }\n        // Use the new g score if better\n        if (flag) {\n          cache.parents[neighborNodeId] = currentNodeId;\n          cache.gscore[neighborNodeId] = g;\n          cache.fscore[neighborNodeId] = g + cache.hscore[neighborNodeId];\n        }\n      }\n    }\n  }\n  return [];\n}\n\n/**\n * @template T\n * @returns {NodeCache<T>}\n */\nfunction createCache() {\n  return {\n    fscore: {},\n    gscore: {},\n    hscore: {},\n    parents: {},\n  };\n}\n\n/**\n * @template T\n * @param {NodeCache<T>} cache\n * @param {T} id\n * @param {number} f\n * @param {number} g\n * @param {number} h\n * @param {T} parent\n * @returns {T}\n */\nfunction cacheNode(\n  cache,\n  id,\n  f = Number.POSITIVE_INFINITY,\n  g = Number.POSITIVE_INFINITY,\n  h = Number.NaN,\n  parent = null\n) {\n  cache.fscore[id] = f;\n  cache.gscore[id] = g;\n  cache.hscore[id] = h;\n  cache.parents[id] = parent;\n  return id;\n}\n", "export function fisherYatesShuffle(array) {\n  for (let i = array.length - 1; i > 0; --i) {\n    let j = Math.floor(Math.random() * (i + 1));\n    let temp = array[i];\n    array[i] = array[j];\n    array[j] = temp;\n  }\n  return array;\n}\n", "export function bitCount(n) {\n  n = n - ((n >> 1) & 0x55555555);\n  n = (n & 0x33333333) + ((n >> 2) & 0x33333333);\n  return (((n + (n >> 4)) & 0xf0f0f0f) * 0x1010101) >> 24;\n}\n", "import { AssetManager } from '@milque/asset';\nimport { Eventable } from '@milque/util';\n\n/**\n * @typedef {import('@milque/display').DisplayPort} DisplayPort\n * @typedef {import('@milque/input').InputContext} InputContext\n */\n\nexport class Game {\n  /**\n   * @param {DisplayPort} display\n   * @param {InputContext} inputs\n   */\n  constructor(display, inputs) {\n    this.display = display;\n    this.inputs = inputs;\n    this.assets = new AssetManager();\n\n    this.deltaTime = 0;\n    this.prevTime = 0;\n    this.now = 0;\n\n    /** @private */\n    this.events = Eventable.create();\n  }\n\n  on(event, callback) {\n    this.events.on(event, callback);\n    return this;\n  }\n\n  off(event, callback) {\n    this.events.off(event, callback);\n    return this;\n  }\n\n  once(event, callback) {\n    this.events.once(event, callback);\n    return this;\n  }\n\n  emit(event, ...args) {\n    this.events.emit(event, ...args);\n  }\n}\n", "/**\n * @typedef MeshData\n * @property {Float32Array} positions\n * @property {Float32Array} texcoords\n * @property {Float32Array} normals\n * @property {Uint16Array} indices\n */\n\n/**\n * @param {string} src\n * @returns {MeshData}\n */\nexport async function loadOBJ(src) {\n  if (typeof src === 'string') {\n    const response = await fetch(src);\n    const arrayBuffer = await response.arrayBuffer();\n    return loadOBJ(arrayBuffer);\n  } else if (!(src instanceof ArrayBuffer || ArrayBuffer.isView(src))) {\n    throw new Error(\n      'Cannot load from source - must be ' + 'an array buffer or fetchable url'\n    );\n  }\n  /** @type {ArrayBuffer} */\n  const arrayBuffer = src;\n  return parse(new TextDecoder().decode(arrayBuffer));\n}\n\n/**\n * @param {string} string\n * @returns {MeshData}\n */\nfunction parse(string) {\n  const vertexList = [];\n  const texcoordList = [];\n  const normalList = [];\n\n  const vertexIndices = [];\n  const texcoordIndices = [];\n  const normalIndices = [];\n\n  // # comments\n  const commentPattern = /^#.*/g;\n  // v float float float\n  const vertexPattern = /v\\s+(\\S+)\\s+(\\S+)\\s+(\\S+)/g;\n  // vn float float float\n  const normalPattern = /vn\\s+(\\S+)\\s+(\\S+)\\s+(\\S+)/g;\n  // vt float float float\n  const texcoordPattern = /vt\\s+(\\S+)\\s+(\\S+)/g;\n  // f vertex/uv/normal vertex/uv/normal vertex/uv/normal ...\n  const facePattern =\n    /f\\s+(([^/\\s]*)\\/([^/\\s]*)\\/?([^/\\s]*))\\s+(([^/\\s]*)\\/([^/\\s]*)\\/?([^/\\s]*))\\s+(([^/\\s]*)\\/([^/\\s]*)\\/?([^/\\s]*))(\\s+(([^/\\s]*)\\/([^/\\s]*)\\/?([^/\\s]*)))?/g;\n  // f float float float\n  const faceVertexPattern = /f\\s+([^/\\s]+)\\s+([^/\\s]+)\\s+([^/\\s]+)/g;\n\n  let quad = false;\n  let result = null;\n  let x, y, z, w;\n\n  // Remove all comments\n  string = string.replace(commentPattern, '');\n\n  // [\"v 1.0 2.0 3.0\", \"1.0\", \"2.0\", \"3.0\"]\n  while ((result = vertexPattern.exec(string)) != null) {\n    x = Number.parseFloat(result[1]);\n    y = Number.parseFloat(result[2]);\n    z = Number.parseFloat(result[3]);\n    vertexList.push(x);\n    vertexList.push(y);\n    vertexList.push(z);\n  }\n\n  // [\"vn 1.0 2.0 3.0\", \"1.0\", \"2.0\", \"3.0\"]\n  while ((result = normalPattern.exec(string)) != null) {\n    x = Number.parseFloat(result[1]);\n    y = Number.parseFloat(result[2]);\n    z = Number.parseFloat(result[3]);\n    normalList.push(x);\n    normalList.push(y);\n    normalList.push(z);\n  }\n\n  // [\"vt 1.0 2.0\", \"1.0\", \"2.0\"]\n  while ((result = texcoordPattern.exec(string)) != null) {\n    x = Number.parseFloat(result[1]);\n    y = Number.parseFloat(result[2]);\n    texcoordList.push(x);\n    texcoordList.push(y);\n  }\n\n  // [\"f 1/1/1 2/2/2 3/3/3\", \"1/1/1\", \"1\", \"1\", \"1\", \"2/2/2\", \"2\", \"2\", \"2\", \"3/3/3\", \"3\", \"3\", \"3\", \"4/4/4\", \"4\", \"4\", \"4\"]\n  while ((result = facePattern.exec(string)) != null) {\n    // Vertex indices\n    x = Number.parseInt(result[2]);\n    if (Number.isNaN(x)) x = 1;\n    y = Number.parseInt(result[6]);\n    if (Number.isNaN(y)) y = 1;\n    z = Number.parseInt(result[10]);\n    if (Number.isNaN(z)) z = 1;\n    vertexIndices.push(x);\n    vertexIndices.push(y);\n    vertexIndices.push(z);\n\n    // Normal indices\n    x = Number.parseInt(result[4]);\n    if (Number.isNaN(x)) {\n      // No UVs.\n      x = Number.parseInt(result[3]);\n      y = Number.parseInt(result[7]);\n      z = Number.parseInt(result[11]);\n      normalIndices.push(x);\n      normalIndices.push(y);\n      normalIndices.push(z);\n\n      texcoordIndices.push(1);\n      texcoordIndices.push(1);\n      texcoordIndices.push(1);\n    } else {\n      // Maybe UVs.\n      y = Number.parseInt(result[8]);\n      if (Number.isNaN(y)) y = 1;\n      z = Number.parseInt(result[12]);\n      if (Number.isNaN(z)) z = 1;\n      normalIndices.push(x);\n      normalIndices.push(y);\n      normalIndices.push(z);\n\n      // UV indices\n      x = Number.parseInt(result[3]);\n      if (Number.isNaN(x)) x = 1;\n      y = Number.parseInt(result[7]);\n      if (Number.isNaN(y)) y = 1;\n      z = Number.parseInt(result[11]);\n      if (Number.isNaN(z)) z = 1;\n      texcoordIndices.push(x);\n      texcoordIndices.push(y);\n      texcoordIndices.push(z);\n    }\n\n    // Quad face\n    if (typeof result[13] !== 'undefined') {\n      // Vertex indices\n      w = Number.parseInt(result[15]);\n      if (Number.isNaN(w)) w = 1;\n      vertexIndices.push(w);\n\n      // Normal indices\n      w = Number.parseInt(result[17]);\n      if (Number.isNaN(w)) {\n        // No UVs.\n        w = Number.parseInt(result[16]);\n        normalIndices.push(w);\n        texcoordIndices.push(1);\n      } else {\n        // Maybe UVs.\n        normalIndices.push(w);\n\n        w = Number.parseInt(result[16]);\n        texcoordIndices.push(w);\n      }\n\n      quad = true;\n    }\n  }\n\n  // [\"f 1 2 3 4\", \"1\", \"2\", \"3\", \"4\"]\n  while ((result = faceVertexPattern.exec(string)) != null) {\n    // Vertex indices\n    x = Number.parseInt(result[2]);\n    y = Number.parseInt(result[6]);\n    z = Number.parseInt(result[10]);\n    vertexIndices.push(x);\n    vertexIndices.push(y);\n    vertexIndices.push(z);\n\n    // UV indices\n    texcoordIndices.push(1);\n    texcoordIndices.push(1);\n    texcoordIndices.push(1);\n\n    // Normal indices\n    normalIndices.push(1);\n    normalIndices.push(1);\n    normalIndices.push(1);\n\n    // Quad face\n    if (typeof result[13] !== 'undefined') {\n      // Vertex indices\n      w = Number.parseInt(result[14]);\n      vertexIndices.push(w);\n\n      // UV indices\n      texcoordIndices.push(1);\n      // Normal indices\n      normalIndices.push(1);\n\n      quad = true;\n    }\n  }\n\n  let index, size;\n\n  size = vertexIndices.length;\n  const positions = new Float32Array(size * 3);\n  for (let i = 0; i < size; ++i) {\n    index = vertexIndices[i] - 1;\n    positions[i * 3 + 0] = vertexList[index * 3 + 0];\n    positions[i * 3 + 1] = vertexList[index * 3 + 1];\n    positions[i * 3 + 2] = vertexList[index * 3 + 2];\n  }\n\n  size = texcoordIndices.length;\n  const texcoords = new Float32Array(size * 2);\n  for (let i = 0; i < size; ++i) {\n    index = texcoordIndices[i] - 1;\n    texcoords[i * 2 + 0] = texcoordList[index * 2 + 0];\n    texcoords[i * 2 + 1] = texcoordList[index * 2 + 1];\n  }\n\n  size = normalIndices.length;\n  const normals = new Float32Array(size * 3);\n  for (let i = 0; i < size; ++i) {\n    index = normalIndices[i] - 1;\n    normals[i * 3 + 0] = normalList[index * 3 + 0];\n    normals[i * 3 + 1] = normalList[index * 3 + 1];\n    normals[i * 3 + 2] = normalList[index * 3 + 2];\n  }\n\n  // Must be either unsigned short or unsigned byte.\n  size = vertexIndices.length;\n  const indices = new Uint16Array(size);\n  for (let i = 0; i < size; ++i) {\n    indices[i] = i;\n  }\n\n  if (quad) {\n    console.warn('WebGL does not support quad faces, only triangles.');\n  }\n\n  return {\n    positions,\n    texcoords,\n    normals,\n    indices,\n  };\n}\n", "export async function loadAtlas(src) {\n  if (typeof src === 'string') {\n    const response = await fetch(src);\n    const arrayBuffer = await response.arrayBuffer();\n    return loadAtlas(arrayBuffer);\n  } else if (!(src instanceof ArrayBuffer || ArrayBuffer.isView(src))) {\n    throw new Error(\n      'Cannot load from source - must be ' + 'an array buffer or fetchable url'\n    );\n  }\n  /** @type {ArrayBuffer} */\n  const arrayBuffer = src;\n  const string = new TextDecoder().decode(arrayBuffer);\n  let result = {};\n  for (let line of string.split('\\n')) {\n    line = line.trim();\n    if (line <= 0) continue;\n    if (line.startsWith('#')) continue;\n    if (line.startsWith('//')) continue;\n\n    let args = [];\n    let i = 0;\n    let j = line.indexOf(' ');\n    while (j >= 0) {\n      args.push(line.substring(i, j));\n      i = j + 1;\n      j = line.indexOf(' ', i);\n    }\n    args.push(line.substring(i));\n\n    let name = args[0];\n    let u = Number.parseInt(args[1]);\n    let v = Number.parseInt(args[2]);\n    let w = Number.parseInt(args[3]);\n    let h = Number.parseInt(args[4]);\n    let frames =\n      args.length >= 6\n        ? Number.parseInt(args[5]) // User-defined\n        : 1; // Default 1 frame\n    let cols =\n      args.length >= 7\n        ? Number.parseInt(args[6]) // User-defined\n        : frames; // Default same as frame count\n    let rows =\n      args.length >= 8\n        ? Number.parseInt(args[7]) // User-defined\n        : frames > cols // If more frames than cols...\n        ? Math.ceil(frames / cols) // ...then expect more rows\n        : 1; // Otherwise, default single row\n\n    result[name] = {\n      u,\n      v,\n      w,\n      h,\n      frames,\n      cols,\n      rows,\n      name,\n    };\n  }\n  return result;\n}\n", "/**\n * @param {ArrayBuffer|Uint8Array|string} src\n * @param {AudioContext} audioContext\n * @returns {AudioBuffer}\n */\nexport async function loadAudioBuffer(src, audioContext) {\n  if (typeof src === 'string') {\n    const response = await fetch(src);\n    const arrayBuffer = await response.arrayBuffer();\n    return loadAudioBuffer(arrayBuffer);\n  } else if (!(src instanceof ArrayBuffer || ArrayBuffer.isView(src))) {\n    throw new Error(\n      'Cannot load from source - must be ' + 'an array buffer or fetchable url'\n    );\n  }\n  /** @type {ArrayBuffer} */\n  const arrayBuffer = src;\n  let audioArrayBuffer = new ArrayBuffer(arrayBuffer.byteLength);\n  new Uint8Array(audioArrayBuffer).set(arrayBuffer);\n  let audioBuffer = await audioContext.decodeAudioData(audioArrayBuffer);\n  return audioBuffer;\n}\n", "/**\n * @typedef BMFontChar\n * @property {number} id The character id.\n * @property {number} x The left position of the character image in the texture.\n * @property {number} y The top position of the character image in the texture.\n * @property {number} width The width of the character image in the texture.\n * @property {number} height The height of the character image in the texture.\n * @property {number} xoffset How much the current position should be offset when\n *                            copying the image from the texture to the screen.\n * @property {number} yoffset How much the current position should be offset when\n *                            copying the image from the texture to the screen.\n * @property {number} xadvance How much the current position should be advanced\n *                             after drawing the character.\n * @property {number} page The texture page where the character image is found.\n * @property {number} chnl The texture channel where the character image is\n *                         found (1 = blue, 2 = green, 4 = red, 8 = alpha,\n *                         15 = all channels).\n *\n * @typedef BMFontKerning\n * @property {number} first The first character id.\n * @property {number} second The second character id.\n * @property {number} amount How much the x position should be adjusted when\n *                           drawing the second character immediately following\n *                           the first.\n *\n * @typedef BMFontData\n * @property {object} info              This tag holds information on how the\n *                                      font was generated.\n * @property {string} info.face         This is the name of the true type font.\n * @property {number} info.size         The size of the true type font.\n * @property {number} info.bold         The font is bold.\n * @property {number} info.italic\t    The font is italic.\n * @property {string} info.charset\t    The name of the OEM charset used (when\n *                                      not unicode).\n * @property {number} info.unicode\t    Set to 1 if it is the unicode charset.\n * @property {number} info.stretchH\t    The font height stretch in percentage.\n *                                      100% means no stretch.\n * @property {number} info.smooth\t    Set to 1 if smoothing was turned on.\n * @property {number} info.aa\t        The supersampling level used. 1 means no\n *                                      supersampling was used.\n * @property {number} info.padding\t    The padding for each character\n *                                      (up, right, down, left).\n * @property {number} info.spacing\t    The spacing for each character\n *                                      (horizontal, vertical).\n * @property {number} info.outline\t    The outline thickness for the characters.\n * @property {object} common            This tag holds information common to all\n *                                      characters.\n * @property {number} common.lineHeight This is the distance in pixels between\n *                                      each line of text.\n * @property {number} common.base\t    The number of pixels from the absolute\n *                                      top of the line to the base of the characters.\n * @property {number} common.scaleW\t    The width of the texture, normally used\n *                                      to scale the x pos of the character image.\n * @property {number} common.scaleH\t    The height of the texture, normally used\n *                                      to scale the y pos of the character image.\n * @property {number} common.pages\t    The number of texture pages included in\n *                                      the font.\n * @property {number} common.packed\t    Set to 1 if the monochrome characters\n *                                      have been packed into each of the texture\n *                                      channels. In this case alphaChnl describes\n *                                      what is stored in each channel.\n * @property {number} common.alphaChnl\tSet to 0 if the channel holds the glyph data,\n *                                      1 if it holds the outline,\n *                                      2 if it holds the glyph and the outline,\n *                                      3 if its set to zero, and 4 if its set to one.\n * @property {number} common.redChnl\tSet to 0 if the channel holds the glyph data,\n *                                      1 if it holds the outline,\n *                                      2 if it holds the glyph and the outline,\n *                                      3 if its set to zero, and 4 if its set to one.\n * @property {number} common.greenChnl\tSet to 0 if the channel holds the glyph data,\n *                                      1 if it holds the outline,\n *                                      2 if it holds the glyph and the outline,\n *                                      3 if its set to zero, and 4 if its set to one.\n * @property {number} common.blueChnl\tSet to 0 if the channel holds the glyph data,\n *                                      1 if it holds the outline,\n *                                      2 if it holds the glyph and the outline,\n *                                      3 if its set to zero, and 4 if its set to one.\n * @property {object} page              This tag gives the name of a texture\n *                                      file. There is one for each page in the font.\n * @property {number} page.id\t        The page id.\n * @property {number} page.file\t        The texture file name.\n * @property {Array<BMFontChar>} chars  This tag describes characters in the font.\n *                                      There is one for each included character\n *                                      in the font.\n * @property {Array<BMFontKerning>} kernings The kerning information is used to adjust\n *                                           the distance between certain characters,\n *                                           e.g. some characters should be placed\n *                                           closer to each other than others.\n */\n\n/**\n * @param {string} src\n * @returns {BMFontData}\n */\nexport async function loadBMFont(src) {\n  if (typeof src === 'string') {\n    const response = await fetch(src);\n    const arrayBuffer = await response.arrayBuffer();\n    return loadBMFont(arrayBuffer);\n  } else if (!(src instanceof ArrayBuffer || ArrayBuffer.isView(src))) {\n    throw new Error(\n      'Cannot load from source - must be ' + 'an array buffer or fetchable url'\n    );\n  }\n  /** @type {ArrayBuffer} */\n  const arrayBuffer = src;\n  return parse(new TextDecoder().decode(arrayBuffer));\n}\n\nconst TAG_PATTERN = /(.+?)\\s+(.*)/;\nconst LINE_PATTERN = /(.+)=(.+)/;\n\n/**\n * @param {string} string\n * @returns {BMFontData}\n */\nfunction parse(string) {\n  let lines = string.split('\\n');\n  let info = {};\n  let common = {};\n  let page = {};\n  let chars = [];\n  let kernings = [];\n  for (let line of lines) {\n    let array = TAG_PATTERN.exec(line);\n    if (!array) {\n      continue;\n    }\n    let [_, tag, props] = array;\n    switch (tag) {\n      case 'info':\n        parseBMLine(info, props);\n        break;\n      case 'common':\n        parseBMLine(common, props);\n        break;\n      case 'page':\n        parseBMLine(page, props);\n        break;\n      case 'chars':\n        // This only has count info. Ignore it.\n        break;\n      case 'char':\n        let char = {};\n        parseBMLine(char, props);\n        if ('id' in char) {\n          chars.push(char);\n        }\n        break;\n      case 'kerning':\n        let kerning = {};\n        parseBMLine(kerning, props);\n        if ('first' in kerning) {\n          kernings.push(kerning);\n        }\n        break;\n      default:\n      // Unknown tag.\n    }\n  }\n  let data = {\n    info,\n    common,\n    page,\n    chars,\n    kernings,\n  };\n  return data;\n}\n\nfunction parseBMLine(out, line) {\n  let props = line.split(/\\s+/);\n  for (let prop of props) {\n    let array = LINE_PATTERN.exec(prop);\n    if (!array) {\n      continue;\n    }\n    let [_, key, value] = array;\n    let result = JSON.parse(`[${value}]`);\n    if (result.length === 1) {\n      out[key] = result[0];\n    } else {\n      out[key] = result;\n    }\n  }\n}\n", "/**\n * @param {string} src\n * @returns {string}\n */\nexport async function loadText(src) {\n  if (typeof src === 'string') {\n    const response = await fetch(src);\n    const arrayBuffer = await response.arrayBuffer();\n    return loadText(arrayBuffer);\n  } else if (!(src instanceof ArrayBuffer || ArrayBuffer.isView(src))) {\n    throw new Error(\n      'Cannot load from source - must be ' + 'an array buffer or fetchable url'\n    );\n  }\n  /** @type {ArrayBuffer} */\n  const arrayBuffer = src;\n  return new TextDecoder().decode(arrayBuffer);\n}\n", "const AUDIO_CONTEXT_SYMBOL = Symbol('audioContext');\n\nexport class Sound {\n  /** @returns {AudioContext} */\n  static getAudioContext() {\n    if (AUDIO_CONTEXT_SYMBOL in this) {\n      return this[AUDIO_CONTEXT_SYMBOL];\n    } else {\n      let result = new AudioContext();\n      autoUnlock(result);\n      this[AUDIO_CONTEXT_SYMBOL] = result;\n      return result;\n    }\n  }\n\n  /**\n   * @param {AudioContext} audioContext\n   * @param {AudioBuffer} audioBuffer\n   */\n  constructor(audioContext, audioBuffer) {\n    this.audioContext = audioContext;\n    this.audioBuffer = audioBuffer;\n\n    /** @private */\n    this._playing = false;\n    /** @private */\n    this._started = false;\n    /**\n     * @private\n     * @type {AudioBufferSourceNode}\n     */\n    this._source = null;\n\n    /** @private */\n    this.onAudioSourceEnded = this.onAudioSourceEnded.bind(this);\n  }\n\n  destroy() {\n    if (this._source) {\n      this._source.disconnect();\n    }\n    this._source = null;\n    this._started = false;\n    this._playing = false;\n  }\n\n  /** @private */\n  onAudioSourceEnded() {\n    this._playing = false;\n  }\n\n  /**\n   * @param {object} [opts]\n   * @param {number} [opts.pitch]\n   * @param {number} [opts.gain]\n   * @param {number} [opts.pan]\n   * @param {boolean} [opts.loop]\n   */\n  play(opts = {}) {\n    let audioBuffer = this.audioBuffer;\n    if (!audioBuffer) return;\n    // HACK: This just restarts when played again.\n    if (this._source) this.destroy();\n\n    const {\n      pitch = undefined,\n      gain = undefined,\n      pan = undefined,\n      loop = false,\n    } = opts;\n\n    /** @type {AudioContext} */\n    let audioContext = this.audioContext;\n    let source = audioContext.createBufferSource();\n    source.addEventListener('ended', this.onAudioSourceEnded);\n    source.buffer = audioBuffer;\n    source.loop = loop;\n\n    let prevNode = source;\n    // https://www.oreilly.com/library/view/web-audio-api/9781449332679/ch04.html\n    // Add pitch\n    if (pitch) {\n      source.detune.value = pitch * 100;\n    }\n    // Add gain\n    if (gain) {\n      const gainNode = audioContext.createGain();\n      gainNode.gain.value = gain;\n      prevNode = prevNode.connect(gainNode);\n    }\n    // Add stereo pan\n    if (pan) {\n      const pannerNode = audioContext.createStereoPanner();\n      pannerNode.pan.value = pan;\n      prevNode = prevNode.connect(pannerNode);\n    }\n    prevNode.connect(audioContext.destination);\n    source.start();\n\n    this._source = source;\n    this._started = true;\n    this._playing = true;\n  }\n\n  pause() {\n    this._source.stop();\n    this._playing = false;\n  }\n\n  isStarted() {\n    return this._started;\n  }\n\n  isPlaying() {\n    return this._playing;\n  }\n\n  isPaused() {\n    return this._started && !this._playing;\n  }\n}\n\nfunction autoUnlock(ctx) {\n  const callback = () => {\n    if (ctx.state === 'suspended') {\n      ctx.resume();\n    }\n  };\n  document.addEventListener('click', callback);\n}\n", "import { AxisBinding, ButtonBinding } from '@milque/input';\n\nexport const CursorX = AxisBinding.fromString('cursorX', 'Mouse.PosX');\nexport const CursorY = AxisBinding.fromString('cursorY', 'Mouse.PosY');\nexport const Activate = ButtonBinding.fromString('activate', 'Mouse.Button0');\nexport const Mark = ButtonBinding.fromString('mark', 'Mouse.Button2');\nexport const Restart = ButtonBinding.fromString('restart', 'Keyboard.KeyR');\n", "const DEFAULT_INFO = {\n  tileSize: 16,\n};\nconst INFO_KEY = Symbol('IslandRendererInfo');\nexport class IslandRenderer {\n  static get Info() {\n    return INFO_KEY;\n  }\n\n  static draw(ctx, targets, defaultInfo = undefined) {\n    const defaults = defaultInfo\n      ? { ...DEFAULT_INFO, ...defaultInfo }\n      : DEFAULT_INFO;\n\n    let i = 0;\n    for (let target of targets) {\n      const info = target[INFO_KEY];\n\n      const island = target;\n      const width = resolveInfo('width', info, target, defaults);\n      const height = resolveInfo('height', info, target, defaults);\n      const tileSize = resolveInfo('tileSize', info, target, defaults);\n\n      for (let y = 0; y < height; ++y) {\n        for (let x = 0; x < width; ++x) {\n          let i = x + y * width;\n          let ground = island.ground[i];\n          let solid = island.solid[i];\n          if (ground) {\n            ctx.fillStyle = 'saddlebrown';\n            ctx.fillRect(x * tileSize, y * tileSize, tileSize, tileSize);\n          }\n          if (solid) {\n            ctx.fillStyle = 'green';\n            ctx.fillRect(x * tileSize, y * tileSize, tileSize, tileSize);\n          }\n        }\n      }\n      ++i;\n    }\n  }\n}\n\nfunction resolveInfo(param, info, target, defaults) {\n  if (info) {\n    if (param in info) {\n      return info[param];\n    } else if (param in target) {\n      return target[param];\n    } else {\n      return defaults[param];\n    }\n  } else if (target) {\n    if (param in target) {\n      return target[param];\n    } else {\n      return defaults[param];\n    }\n  } else {\n    return defaults[param];\n  }\n}\n", "/**\n * @typedef RandomGeneratorLike\n * @property {NumberFunction} next\n *\n * @callback NumberFunction Generates a pseudo-random number\n * from 0 inclusive to 1 exclusive.\n * @returns {number} A pseudo-randomly generated number.\n */\n\n/**\n * Represents a pseudo-random number generator. This is only used for\n * type information.\n *\n * All random number generator instances are expected to implement\n * {@link RandomGeneratorLike}. If using classes, you can extend\n * {@link RandomBase} to enforce this, but this should not necessary\n * nor assumed.\n */\nexport class RandomBase {\n  /**\n   * Generates a pseudo-random number from 0 inclusive to 1 exclusive.\n   *\n   * @abstract\n   * @returns {number} A pseudo-randomly generated number.\n   */\n  next() {\n    return 0;\n  }\n}\n", "import { RandomBase } from './RandomBase.js';\n\nexport class MathRandom extends RandomBase {\n  /** @override */\n  next() {\n    return Math.random();\n  }\n}\n", "import { RandomBase } from './RandomBase.js';\n\n/**\n * A simple and fast 32-bit PRNG.\n *\n * @see {@link https://github.com/bryc/code/blob/master/jshash/PRNGs.md}\n */\nexport class Mulberry32 extends RandomBase {\n  /**\n   * @param {number} seed An unsigned 32-bit integer.\n   */\n  constructor(seed) {\n    super();\n\n    this.seed = seed;\n\n    /** @private */\n    this.a = seed;\n  }\n\n  /** @override */\n  next() {\n    var t = (this.a += 0x6d2b79f5);\n    t = Math.imul(t ^ (t >>> 15), t | 1);\n    t ^= t + Math.imul(t ^ (t >>> 7), t | 61);\n    return ((t ^ (t >>> 14)) >>> 0) / 4294967296;\n  }\n}\n", "import { MathRandom } from './generators/MathRandom.js';\nimport { Mulberry32 } from './generators/Mulberry32.js';\n\n/**\n * @typedef {import('./generators/RandomBase.js').RandomGeneratorLike} RandomGeneratorLike\n * @typedef {import('./generators/RandomBase.js').RandomBase} RandomBase\n */\n\nexport class Random {\n  /**\n   * The lazily-initiated, static instance of this random class.\n   */\n  static get RAND() {\n    let instance = new this();\n\n    this.next = this.next.bind(this);\n    this.choose = this.choose.bind(this);\n    this.range = this.range.bind(this);\n    this.rangeInt = this.rangeInt.bind(this);\n    this.sign = this.sign.bind(this);\n\n    Object.defineProperty(this, 'RAND', { value: instance });\n    return instance;\n  }\n\n  /**\n   * @param {RandomGeneratorLike|RandomBase|number} [randomGenerator]\n   * If number type, the param will be used as a seed for a Mulberry32 PRNG.\n   * Otherwise, it is the pseudo-random number generator object that provides\n   * the generated numbers through `next()`. By default, if undefined, this\n   * will use the browser-specific `Math.random()` implementation.\n   */\n  constructor(randomGenerator = undefined) {\n    if (typeof randomGenerator === 'number') {\n      this.generator = new Mulberry32(randomGenerator);\n    } else if (randomGenerator) {\n      this.generator = randomGenerator;\n    } else {\n      this.generator = new MathRandom();\n    }\n\n    this.next = this.next.bind(this);\n    this.choose = this.choose.bind(this);\n    this.range = this.range.bind(this);\n    this.rangeInt = this.rangeInt.bind(this);\n    this.sign = this.sign.bind(this);\n  }\n\n  static next() {\n    return this.RAND.next();\n  }\n  next() {\n    return this.generator.next();\n  }\n\n  /**\n   * @template T\n   * @param {Array<T>} list\n   * @returns {T}\n   */\n  static choose(list) {\n    return this.RAND.choose(list);\n  }\n  /**\n   * @template T\n   * @param {Array<T>} list\n   * @returns {T}\n   */\n  choose(list) {\n    return list[Math.floor(this.generator.next() * list.length)];\n  }\n\n  /**\n   * @param {number} min Min range (inclusive)\n   * @param {number} max Max range (exclusive)\n   * @returns {number}\n   */\n  static range(min, max) {\n    return this.RAND.range(min, max);\n  }\n  /**\n   * @param {number} min Min range (inclusive)\n   * @param {number} max Max range (exclusive)\n   * @returns {number}\n   */\n  range(min, max) {\n    return (max - min) * this.generator.next() + min;\n  }\n\n  /**\n   * @param {number} min Min integer range (inclusive)\n   * @param {number} max Max integer range (exclusive)\n   * @returns {number}\n   */\n  static rangeInt(min, max) {\n    return this.RAND.rangeInt(min, max);\n  }\n  /**\n   * @param {number} min Min integer range (inclusive)\n   * @param {number} max Max integer range (exclusive)\n   * @returns {number}\n   */\n  rangeInt(min, max) {\n    return Math.trunc(this.range(min, max));\n  }\n\n  /**\n   * @returns {-1|1}\n   */\n  static sign() {\n    return this.RAND.sign();\n  }\n  /**\n   * @returns {-1|1}\n   */\n  sign() {\n    return this.generator.next() < 0.5 ? -1 : 1;\n  }\n}\n", "import { RandomBase } from './RandomBase.js';\n\n/**\n * A very fast 32-bit PRNG.\n *\n * @see https://github.com/bryc/code/blob/master/jshash/PRNGs.md\n */\nexport class SmallFastCounter32 extends RandomBase {\n  /**\n   * @param {number} a An unsigned 32-bit integer.\n   * @param {number} b An unsigned 32-bit integer.\n   * @param {number} c An unsigned 32-bit integer.\n   * @param {number} d An unsigned 32-bit integer.\n   */\n  constructor(a, b, c, d) {\n    super();\n\n    /** @private */\n    this.a = a;\n    /** @private */\n    this.b = b;\n    /** @private */\n    this.c = c;\n    /** @private */\n    this.d = d;\n  }\n\n  /** @override */\n  next() {\n    let { a, b, c, d } = this;\n    a |= 0;\n    b |= 0;\n    c |= 0;\n    d |= 0;\n    let t = (((a + b) | 0) + d) | 0;\n    d = (d + 1) | 0;\n    a = b ^ (b >>> 9);\n    b = (c + (c << 3)) | 0;\n    c = (c << 21) | (c >>> 11);\n    c = (c + t) | 0;\n    this.a = a;\n    this.b = b;\n    this.c = c;\n    this.d = d;\n    return (t >>> 0) / 4294967296;\n  }\n}\n", "import * as MainControls from './MainControls.js';\n\nimport { IslandRenderer } from './IslandRenderer.js';\nimport { generateBoxyIsland } from './Island.js';\n\ndocument.title = 'Archaea';\n\n/**\n *\n * @param {import('../game/Game.js').Game} game\n */\nexport async function main(game) {\n  const display = game.display;\n  const ctx = display.canvas.getContext('2d');\n  ctx.imageSmoothingEnabled = false;\n\n  const inputs = game.inputs;\n  inputs.bindBindings(Object.values(MainControls));\n\n  const width = 32;\n  const height = 32;\n  const length = width * height;\n  const island = {\n    tileSize: 4,\n    width,\n    height,\n    length,\n    ground: new Array(length),\n    solid: new Array(length),\n  };\n\n  generateBoxyIsland(island, width, height, {});\n\n  display.addEventListener('frame', (e) => {\n    ctx.clearRect(0, 0, display.width, display.height);\n\n    // The water around the island.\n    ctx.fillStyle = 'dodgerblue';\n    ctx.fillRect(0, 0, display.width, display.height);\n\n    // The island.\n    IslandRenderer.draw(ctx, [island]);\n  });\n}\n", "import { Keyboard } from '@milque/input';\nimport { Loop } from './Loop.js';\nimport { StartRoom } from './content/StartRoom.js';\n\ndocument.title = 'Architect';\n\n/**\n * @param {import('../game/Game.js').Game} game\n */\nexport async function main(game) {\n  const display = game.display;\n  const canvas = display.canvas;\n  const ctx = display.getContext();\n  const loop = new Loop()\n    .on('early', earlyUpdate)\n    .on('fixed', fixedUpdate)\n    .on('step', update)\n    .on('late', lateUpdate);\n  const keyboard = new Keyboard(display);\n\n  const assets = game.assets;\n\n  let worldState = {\n    loop,\n    currentRoom: null,\n    nextRoom: new StartRoom(),\n    inputState: {\n      left: 0,\n      right: 0,\n      up: 0,\n      down: 0,\n    },\n    assets,\n  };\n\n  main();\n\n  function main() {\n    loop.start();\n  }\n\n  function earlyUpdate() {\n    if (worldState.nextRoom) {\n      let nextRoom = worldState.nextRoom;\n      worldState.nextRoom = null;\n\n      if (worldState.currentRoom) {\n        worldState.currentRoom.onDestroy(worldState);\n        worldState.currentRoom = null;\n      }\n\n      nextRoom.onCreate(worldState);\n      worldState.currentRoom = nextRoom;\n    }\n\n    if (worldState.currentRoom) {\n      for (let instance of worldState.currentRoom.getInstances()) {\n        instance.onEarlyUpdate(worldState);\n      }\n    }\n  }\n\n  function update(dt) {\n    if (worldState.currentRoom) {\n      for (let instance of worldState.currentRoom.getInstances()) {\n        instance.onUpdate(worldState, dt);\n      }\n    }\n\n    inputUpdate();\n  }\n\n  function fixedUpdate() {\n    if (worldState.currentRoom) {\n      for (let instance of worldState.currentRoom.getInstances()) {\n        instance.onFixedUpdate(worldState);\n      }\n    }\n  }\n\n  function inputUpdate() {\n    let inputState = worldState.inputState;\n    if (keyboard.KeyW.pressed) {\n      inputState.up = 1;\n    } else if (keyboard.KeyW.released) {\n      inputState.up = 0;\n    }\n    if (keyboard.KeyS.pressed) {\n      inputState.down = 1;\n    } else if (keyboard.KeyS.released) {\n      inputState.down = 0;\n    }\n    if (keyboard.KeyA.pressed) {\n      inputState.left = 1;\n    } else if (keyboard.KeyA.released) {\n      inputState.left = 0;\n    }\n    if (keyboard.KeyD.pressed) {\n      inputState.right = 1;\n    } else if (keyboard.KeyD.released) {\n      inputState.right = 0;\n    }\n  }\n\n  function lateUpdate() {\n    render();\n\n    if (worldState.currentRoom) {\n      for (let instance of worldState.currentRoom.getInstances()) {\n        instance.onLateUpdate(worldState);\n      }\n    }\n  }\n\n  function render() {\n    ctx.fillStyle = 'black';\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n    if (worldState.currentRoom) {\n      ctx.save();\n      for (let instance of worldState.currentRoom.getInstances()) {\n        instance.onPreDraw(worldState, ctx);\n      }\n      ctx.restore();\n\n      ctx.save();\n      for (let instance of worldState.currentRoom.getInstances()) {\n        instance.onDraw(worldState, ctx);\n      }\n      ctx.restore();\n\n      ctx.save();\n      for (let instance of worldState.currentRoom.getInstances()) {\n        instance.onPostDraw(worldState, ctx);\n      }\n      ctx.restore();\n    }\n  }\n}\n", "import { AxisBinding, ButtonBinding } from '@milque/input';\n\nexport const MoveLeft = ButtonBinding.fromString('moveLeft', 'Keyboard.KeyA');\nexport const MoveRight = ButtonBinding.fromString('moveRight', 'Keyboard.KeyD');\nexport const MoveUp = ButtonBinding.fromString('moveUp', 'Keyboard.KeyW');\nexport const MoveDown = ButtonBinding.fromString('moveDown', 'Keyboard.KeyS');\nexport const CursorX = AxisBinding.fromString('cursorX', 'Mouse.PosX');\nexport const CursorY = AxisBinding.fromString('cursorY', 'Mouse.PosY');\nexport const Shoot = ButtonBinding.fromString('shoot', 'Keyboard.Space');\n", "import * as PlayerInputs from './PlayerInputs.js';\nimport { Player } from './Player.js';\n\nimport { Bullet } from './Bullet.js';\nimport { Room } from './Room.js';\n\ndocument.title = 'Bioform';\n\n/**\n * @param {import('../game/Game.js').Game} game\n */\nexport async function main(game) {\n  const display = game.display;\n  const ctx = display.canvas.getContext('2d');\n  ctx.imageSmoothingEnabled = false;\n  ctx.assets = game.assets;\n\n  const inputs = game.inputs;\n  inputs.bindBindings(Object.values(PlayerInputs));\n\n  const room = new Room(display.width, display.height, [\n    { x: 0, y: 0, object: Player },\n    { x: 0, y: 0, object: Bullet },\n  ]);\n  room.start();\n\n  display.addEventListener('frame', (e) => {\n    const dt = (e.detail.deltaTime / 1000) * 60;\n\n    room.update(dt);\n\n    ctx.clearRect(0, 0, display.width, display.height);\n\n    room.render(ctx);\n  });\n}\n", "/**\n * Common utilities\n * @module glMatrix\n */\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\nexport var RANDOM = Math.random;\n/**\n * Sets the type of array used when creating new vectors and matrices\n *\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\n */\n\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\n/**\n * Convert Degree To Radian\n *\n * @param {Number} a Angle in Degrees\n */\n\nexport function toRadian(a) {\n  return a * degree;\n}\n/**\n * Tests whether or not the arguments have approximately the same value, within an absolute\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\n * than or equal to 1.0, and a relative tolerance is used for larger values)\n *\n * @param {Number} a The first number to test.\n * @param {Number} b The second number to test.\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\nif (!Math.hypot) Math.hypot = function () {\n  var y = 0,\n      i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n};", "import * as glMatrix from \"./common.js\";\n/**\n * 3x3 Matrix\n * @module mat3\n */\n\n/**\n * Creates a new identity mat3\n *\n * @returns {mat3} a new 3x3 matrix\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(9);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[5] = 0;\n    out[6] = 0;\n    out[7] = 0;\n  }\n\n  out[0] = 1;\n  out[4] = 1;\n  out[8] = 1;\n  return out;\n}\n/**\n * Copies the upper-left 3x3 values into the given mat3.\n *\n * @param {mat3} out the receiving 3x3 matrix\n * @param {ReadonlyMat4} a   the source 4x4 matrix\n * @returns {mat3} out\n */\n\nexport function fromMat4(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[4];\n  out[4] = a[5];\n  out[5] = a[6];\n  out[6] = a[8];\n  out[7] = a[9];\n  out[8] = a[10];\n  return out;\n}\n/**\n * Creates a new mat3 initialized with values from an existing matrix\n *\n * @param {ReadonlyMat3} a matrix to clone\n * @returns {mat3} a new 3x3 matrix\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\n * Copy the values from one mat3 to another\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the source matrix\n * @returns {mat3} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\n * Create a new mat3 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\n * @returns {mat3} A new mat3\n */\n\nexport function fromValues(m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n/**\n * Set the components of a mat3 to the given values\n *\n * @param {mat3} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\n * @returns {mat3} out\n */\n\nexport function set(out, m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n/**\n * Set a mat3 to the identity matrix\n *\n * @param {mat3} out the receiving matrix\n * @returns {mat3} out\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\n * Transpose the values of a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the source matrix\n * @returns {mat3} out\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a12 = a[5];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a01;\n    out[5] = a[7];\n    out[6] = a02;\n    out[7] = a12;\n  } else {\n    out[0] = a[0];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a[1];\n    out[4] = a[4];\n    out[5] = a[7];\n    out[6] = a[2];\n    out[7] = a[5];\n    out[8] = a[8];\n  }\n\n  return out;\n}\n/**\n * Inverts a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the source matrix\n * @returns {mat3} out\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  var b01 = a22 * a11 - a12 * a21;\n  var b11 = -a22 * a10 + a12 * a20;\n  var b21 = a21 * a10 - a11 * a20; // Calculate the determinant\n\n  var det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = b01 * det;\n  out[1] = (-a22 * a01 + a02 * a21) * det;\n  out[2] = (a12 * a01 - a02 * a11) * det;\n  out[3] = b11 * det;\n  out[4] = (a22 * a00 - a02 * a20) * det;\n  out[5] = (-a12 * a00 + a02 * a10) * det;\n  out[6] = b21 * det;\n  out[7] = (-a21 * a00 + a01 * a20) * det;\n  out[8] = (a11 * a00 - a01 * a10) * det;\n  return out;\n}\n/**\n * Calculates the adjugate of a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the source matrix\n * @returns {mat3} out\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  out[0] = a11 * a22 - a12 * a21;\n  out[1] = a02 * a21 - a01 * a22;\n  out[2] = a01 * a12 - a02 * a11;\n  out[3] = a12 * a20 - a10 * a22;\n  out[4] = a00 * a22 - a02 * a20;\n  out[5] = a02 * a10 - a00 * a12;\n  out[6] = a10 * a21 - a11 * a20;\n  out[7] = a01 * a20 - a00 * a21;\n  out[8] = a00 * a11 - a01 * a10;\n  return out;\n}\n/**\n * Calculates the determinant of a mat3\n *\n * @param {ReadonlyMat3} a the source matrix\n * @returns {Number} determinant of a\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  return a00 * (a22 * a11 - a12 * a21) + a01 * (-a22 * a10 + a12 * a20) + a02 * (a21 * a10 - a11 * a20);\n}\n/**\n * Multiplies two mat3's\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the first operand\n * @param {ReadonlyMat3} b the second operand\n * @returns {mat3} out\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  var b00 = b[0],\n      b01 = b[1],\n      b02 = b[2];\n  var b10 = b[3],\n      b11 = b[4],\n      b12 = b[5];\n  var b20 = b[6],\n      b21 = b[7],\n      b22 = b[8];\n  out[0] = b00 * a00 + b01 * a10 + b02 * a20;\n  out[1] = b00 * a01 + b01 * a11 + b02 * a21;\n  out[2] = b00 * a02 + b01 * a12 + b02 * a22;\n  out[3] = b10 * a00 + b11 * a10 + b12 * a20;\n  out[4] = b10 * a01 + b11 * a11 + b12 * a21;\n  out[5] = b10 * a02 + b11 * a12 + b12 * a22;\n  out[6] = b20 * a00 + b21 * a10 + b22 * a20;\n  out[7] = b20 * a01 + b21 * a11 + b22 * a21;\n  out[8] = b20 * a02 + b21 * a12 + b22 * a22;\n  return out;\n}\n/**\n * Translate a mat3 by the given vector\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the matrix to translate\n * @param {ReadonlyVec2} v vector to translate by\n * @returns {mat3} out\n */\n\nexport function translate(out, a, v) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a10 = a[3],\n      a11 = a[4],\n      a12 = a[5],\n      a20 = a[6],\n      a21 = a[7],\n      a22 = a[8],\n      x = v[0],\n      y = v[1];\n  out[0] = a00;\n  out[1] = a01;\n  out[2] = a02;\n  out[3] = a10;\n  out[4] = a11;\n  out[5] = a12;\n  out[6] = x * a00 + y * a10 + a20;\n  out[7] = x * a01 + y * a11 + a21;\n  out[8] = x * a02 + y * a12 + a22;\n  return out;\n}\n/**\n * Rotates a mat3 by the given angle\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat3} out\n */\n\nexport function rotate(out, a, rad) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a10 = a[3],\n      a11 = a[4],\n      a12 = a[5],\n      a20 = a[6],\n      a21 = a[7],\n      a22 = a[8],\n      s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c * a00 + s * a10;\n  out[1] = c * a01 + s * a11;\n  out[2] = c * a02 + s * a12;\n  out[3] = c * a10 - s * a00;\n  out[4] = c * a11 - s * a01;\n  out[5] = c * a12 - s * a02;\n  out[6] = a20;\n  out[7] = a21;\n  out[8] = a22;\n  return out;\n}\n/**\n * Scales the mat3 by the dimensions in the given vec2\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the matrix to rotate\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\n * @returns {mat3} out\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1];\n  out[0] = x * a[0];\n  out[1] = x * a[1];\n  out[2] = x * a[2];\n  out[3] = y * a[3];\n  out[4] = y * a[4];\n  out[5] = y * a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat3.identity(dest);\n *     mat3.translate(dest, dest, vec);\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {ReadonlyVec2} v Translation vector\n * @returns {mat3} out\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = v[0];\n  out[7] = v[1];\n  out[8] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a given angle\n * This is equivalent to (but much faster than):\n *\n *     mat3.identity(dest);\n *     mat3.rotate(dest, dest, rad);\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat3} out\n */\n\nexport function fromRotation(out, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = -s;\n  out[4] = c;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat3.identity(dest);\n *     mat3.scale(dest, dest, vec);\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {ReadonlyVec2} v Scaling vector\n * @returns {mat3} out\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = v[1];\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\n * Copies the values from a mat2d into a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat2d} a the matrix to copy\n * @returns {mat3} out\n **/\n\nexport function fromMat2d(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = 0;\n  out[3] = a[2];\n  out[4] = a[3];\n  out[5] = 0;\n  out[6] = a[4];\n  out[7] = a[5];\n  out[8] = 1;\n  return out;\n}\n/**\n * Calculates a 3x3 matrix from the given quaternion\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {ReadonlyQuat} q Quaternion to create matrix from\n *\n * @returns {mat3} out\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[3] = yx - wz;\n  out[6] = zx + wy;\n  out[1] = yx + wz;\n  out[4] = 1 - xx - zz;\n  out[7] = zy - wx;\n  out[2] = zx - wy;\n  out[5] = zy + wx;\n  out[8] = 1 - xx - yy;\n  return out;\n}\n/**\n * Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {ReadonlyMat4} a Mat4 to derive the normal matrix from\n *\n * @returns {mat3} out\n */\n\nexport function normalFromMat4(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[3] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[4] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[5] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[6] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[7] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[8] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  return out;\n}\n/**\n * Generates a 2D projection matrix with the given bounds\n *\n * @param {mat3} out mat3 frustum matrix will be written into\n * @param {number} width Width of your gl context\n * @param {number} height Height of gl context\n * @returns {mat3} out\n */\n\nexport function projection(out, width, height) {\n  out[0] = 2 / width;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -2 / height;\n  out[5] = 0;\n  out[6] = -1;\n  out[7] = 1;\n  out[8] = 1;\n  return out;\n}\n/**\n * Returns a string representation of a mat3\n *\n * @param {ReadonlyMat3} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\n\nexport function str(a) {\n  return \"mat3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \")\";\n}\n/**\n * Returns Frobenius norm of a mat3\n *\n * @param {ReadonlyMat3} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8]);\n}\n/**\n * Adds two mat3's\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the first operand\n * @param {ReadonlyMat3} b the second operand\n * @returns {mat3} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  return out;\n}\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the first operand\n * @param {ReadonlyMat3} b the second operand\n * @returns {mat3} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  return out;\n}\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat3} out\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  return out;\n}\n/**\n * Adds two mat3's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat3} out the receiving vector\n * @param {ReadonlyMat3} a the first operand\n * @param {ReadonlyMat3} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat3} out\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  return out;\n}\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat3} a The first matrix.\n * @param {ReadonlyMat3} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8];\n}\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat3} a The first matrix.\n * @param {ReadonlyMat3} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7],\n      a8 = a[8];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7],\n      b8 = b[8];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8));\n}\n/**\n * Alias for {@link mat3.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link mat3.subtract}\n * @function\n */\n\nexport var sub = subtract;", "import * as glMatrix from \"./common.js\";\n/**\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\n * @module mat4\n */\n\n/**\n * Creates a new identity mat4\n *\n * @returns {mat4} a new 4x4 matrix\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a new mat4 initialized with values from an existing matrix\n *\n * @param {ReadonlyMat4} a matrix to clone\n * @returns {mat4} a new 4x4 matrix\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Copy the values from one mat4 to another\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Create a new mat4 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} A new mat4\n */\n\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\n * Set the components of a mat4 to the given values\n *\n * @param {mat4} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} out\n */\n\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\n * Set a mat4 to the identity matrix\n *\n * @param {mat4} out the receiving matrix\n * @returns {mat4} out\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Transpose the values of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a03 = a[3];\n    var a12 = a[6],\n        a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\n * Inverts a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n/**\n * Calculates the adjugate of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  out[0] = a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22);\n  out[1] = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\n  out[2] = a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12);\n  out[3] = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\n  out[4] = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\n  out[5] = a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22);\n  out[6] = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\n  out[7] = a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12);\n  out[8] = a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21);\n  out[9] = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\n  out[10] = a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11);\n  out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\n  out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\n  out[13] = a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21);\n  out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\n  out[15] = a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11);\n  return out;\n}\n/**\n * Calculates the determinant of a mat4\n *\n * @param {ReadonlyMat4} a the source matrix\n * @returns {Number} determinant of a\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n}\n/**\n * Multiplies two mat4s\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15]; // Cache only the current line of the second matrix\n\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n/**\n * Translate a mat4 by the given vector\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to translate\n * @param {ReadonlyVec3} v vector to translate by\n * @returns {mat4} out\n */\n\nexport function translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\n/**\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {ReadonlyVec3} v the vec3 to scale the matrix by\n * @returns {mat4} out\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Rotates a mat4 by the given angle around the given axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\n\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11]; // Construct the elements of the rotation matrix\n\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c; // Perform rotation-specific matrix multiplication\n\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the X axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the Y axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the Z axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.scale(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Scaling vector\n * @returns {mat4} out\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a given angle around a given axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotate(dest, dest, rad, axis);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\n\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c; // Perform rotation-specific matrix multiplication\n\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the X axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateX(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the Y axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateY(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the Z axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateZ(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation and vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a new mat4 from a dual quat.\n *\n * @param {mat4} out Matrix\n * @param {ReadonlyQuat2} a Dual Quaternion\n * @returns {mat4} mat4 receiving operation result\n */\n\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw; //Only scale if it makes sense\n\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n/**\n * Returns the translation vector component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslation,\n *  the returned vector will be the same as the translation vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive translation component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\n\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n/**\n * Returns the scaling factor component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslationScale\n *  with a normalized Quaternion paramter, the returned vector will be\n *  the same as the scaling vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive scaling factor component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\n\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.hypot(m11, m12, m13);\n  out[1] = Math.hypot(m21, m22, m23);\n  out[2] = Math.hypot(m31, m32, m33);\n  return out;\n}\n/**\n * Returns a quaternion representing the rotational component\n *  of a transformation matrix. If a matrix is built with\n *  fromRotationTranslation, the returned quaternion will be the\n *  same as the quaternion originally supplied.\n * @param {quat} out Quaternion to receive the rotation component\n * @param {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {quat} out\n */\n\nexport function getRotation(out, mat) {\n  var scaling = new glMatrix.ARRAY_TYPE(3);\n  getScaling(scaling, mat);\n  var is1 = 1 / scaling[0];\n  var is2 = 1 / scaling[1];\n  var is3 = 1 / scaling[2];\n  var sm11 = mat[0] * is1;\n  var sm12 = mat[1] * is2;\n  var sm13 = mat[2] * is3;\n  var sm21 = mat[4] * is1;\n  var sm22 = mat[5] * is2;\n  var sm23 = mat[6] * is3;\n  var sm31 = mat[8] * is1;\n  var sm32 = mat[9] * is2;\n  var sm33 = mat[10] * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (sm23 - sm32) / S;\n    out[1] = (sm31 - sm13) / S;\n    out[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out[3] = (sm23 - sm32) / S;\n    out[0] = 0.25 * S;\n    out[1] = (sm12 + sm21) / S;\n    out[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out[3] = (sm31 - sm13) / S;\n    out[0] = (sm12 + sm21) / S;\n    out[1] = 0.25 * S;\n    out[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out[3] = (sm12 - sm21) / S;\n    out[0] = (sm31 + sm13) / S;\n    out[1] = (sm23 + sm32) / S;\n    out[2] = 0.25 * S;\n  }\n\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *     mat4.scale(dest, scale)\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     mat4.translate(dest, origin);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *     mat4.scale(dest, scale)\n *     mat4.translate(dest, negativeOrigin);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @param {ReadonlyVec3} o The origin vector around which to scale and rotate\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n/**\n * Calculates a 4x4 matrix from the given quaternion\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyQuat} q Quaternion to create matrix from\n *\n * @returns {mat4} out\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a frustum matrix with the given bounds\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Number} left Left bound of the frustum\n * @param {Number} right Right bound of the frustum\n * @param {Number} bottom Bottom bound of the frustum\n * @param {Number} top Top bound of the frustum\n * @param {Number} near Near bound of the frustum\n * @param {Number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n/**\n * Generates a perspective projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\n\nexport function perspectiveNO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n\n  return out;\n}\n/**\n * Alias for {@link mat4.perspectiveNO}\n * @function\n */\n\nexport var perspective = perspectiveNO;\n/**\n * Generates a perspective projection matrix suitable for WebGPU with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\n\nexport function perspectiveZO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = far * nf;\n    out[14] = far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -near;\n  }\n\n  return out;\n}\n/**\n * Generates a perspective projection matrix with the given field of view.\n * This is primarily useful for generating projection matrices to be used\n * with the still experiemental WebVR API.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function orthoNO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n/**\n * Alias for {@link mat4.orthoNO}\n * @function\n */\n\nexport var ortho = orthoNO;\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function orthoZO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = near * nf;\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\n\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.hypot(z0, z1, z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.hypot(x0, x1, x2);\n\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.hypot(y0, y1, y2);\n\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a matrix that makes something look at something else.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\n\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n      eyey = eye[1],\n      eyez = eye[2],\n      upx = up[0],\n      upy = up[1],\n      upz = up[2];\n  var z0 = eyex - target[0],\n      z1 = eyey - target[1],\n      z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n\n  var x0 = upy * z2 - upz * z1,\n      x1 = upz * z0 - upx * z2,\n      x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n/**\n * Returns a string representation of a mat4\n *\n * @param {ReadonlyMat4} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\n\nexport function str(a) {\n  return \"mat4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \", \" + a[9] + \", \" + a[10] + \", \" + a[11] + \", \" + a[12] + \", \" + a[13] + \", \" + a[14] + \", \" + a[15] + \")\";\n}\n/**\n * Returns Frobenius norm of a mat4\n *\n * @param {ReadonlyMat4} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15]);\n}\n/**\n * Adds two mat4's\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat4} out\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n/**\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat4} out the receiving vector\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat4} out\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var a8 = a[8],\n      a9 = a[9],\n      a10 = a[10],\n      a11 = a[11];\n  var a12 = a[12],\n      a13 = a[13],\n      a14 = a[14],\n      a15 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  var b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  var b8 = b[8],\n      b9 = b[9],\n      b10 = b[10],\n      b11 = b[11];\n  var b12 = b[12],\n      b13 = b[13],\n      b14 = b[14],\n      b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n/**\n * Alias for {@link mat4.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link mat4.subtract}\n * @function\n */\n\nexport var sub = subtract;", "import * as glMatrix from \"./common.js\";\nimport * as mat3 from \"./mat3.js\";\nimport * as vec3 from \"./vec3.js\";\nimport * as vec4 from \"./vec4.js\";\n/**\n * Quaternion\n * @module quat\n */\n\n/**\n * Creates a new identity quat\n *\n * @returns {quat} a new quaternion\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  out[3] = 1;\n  return out;\n}\n/**\n * Set a quat to the identity quaternion\n *\n * @param {quat} out the receiving quaternion\n * @returns {quat} out\n */\n\nexport function identity(out) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  return out;\n}\n/**\n * Sets a quat from the given angle and rotation axis,\n * then returns it.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyVec3} axis the axis around which to rotate\n * @param {Number} rad the angle in radians\n * @returns {quat} out\n **/\n\nexport function setAxisAngle(out, axis, rad) {\n  rad = rad * 0.5;\n  var s = Math.sin(rad);\n  out[0] = s * axis[0];\n  out[1] = s * axis[1];\n  out[2] = s * axis[2];\n  out[3] = Math.cos(rad);\n  return out;\n}\n/**\n * Gets the rotation axis and angle for a given\n *  quaternion. If a quaternion is created with\n *  setAxisAngle, this method will return the same\n *  values as providied in the original parameter list\n *  OR functionally equivalent values.\n * Example: The quaternion formed by axis [0, 0, 1] and\n *  angle -90 is the same as the quaternion formed by\n *  [0, 0, 1] and 270. This method favors the latter.\n * @param  {vec3} out_axis  Vector receiving the axis of rotation\n * @param  {ReadonlyQuat} q     Quaternion to be decomposed\n * @return {Number}     Angle, in radians, of the rotation\n */\n\nexport function getAxisAngle(out_axis, q) {\n  var rad = Math.acos(q[3]) * 2.0;\n  var s = Math.sin(rad / 2.0);\n\n  if (s > glMatrix.EPSILON) {\n    out_axis[0] = q[0] / s;\n    out_axis[1] = q[1] / s;\n    out_axis[2] = q[2] / s;\n  } else {\n    // If s is zero, return any axis (no rotation - axis does not matter)\n    out_axis[0] = 1;\n    out_axis[1] = 0;\n    out_axis[2] = 0;\n  }\n\n  return rad;\n}\n/**\n * Gets the angular distance between two unit quaternions\n *\n * @param  {ReadonlyQuat} a     Origin unit quaternion\n * @param  {ReadonlyQuat} b     Destination unit quaternion\n * @return {Number}     Angle, in radians, between the two quaternions\n */\n\nexport function getAngle(a, b) {\n  var dotproduct = dot(a, b);\n  return Math.acos(2 * dotproduct * dotproduct - 1);\n}\n/**\n * Multiplies two quat's\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @returns {quat} out\n */\n\nexport function multiply(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  out[0] = ax * bw + aw * bx + ay * bz - az * by;\n  out[1] = ay * bw + aw * by + az * bx - ax * bz;\n  out[2] = az * bw + aw * bz + ax * by - ay * bx;\n  out[3] = aw * bw - ax * bx - ay * by - az * bz;\n  return out;\n}\n/**\n * Rotates a quaternion by the given angle about the X axis\n *\n * @param {quat} out quat receiving operation result\n * @param {ReadonlyQuat} a quat to rotate\n * @param {number} rad angle (in radians) to rotate\n * @returns {quat} out\n */\n\nexport function rotateX(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw + aw * bx;\n  out[1] = ay * bw + az * bx;\n  out[2] = az * bw - ay * bx;\n  out[3] = aw * bw - ax * bx;\n  return out;\n}\n/**\n * Rotates a quaternion by the given angle about the Y axis\n *\n * @param {quat} out quat receiving operation result\n * @param {ReadonlyQuat} a quat to rotate\n * @param {number} rad angle (in radians) to rotate\n * @returns {quat} out\n */\n\nexport function rotateY(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var by = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw - az * by;\n  out[1] = ay * bw + aw * by;\n  out[2] = az * bw + ax * by;\n  out[3] = aw * bw - ay * by;\n  return out;\n}\n/**\n * Rotates a quaternion by the given angle about the Z axis\n *\n * @param {quat} out quat receiving operation result\n * @param {ReadonlyQuat} a quat to rotate\n * @param {number} rad angle (in radians) to rotate\n * @returns {quat} out\n */\n\nexport function rotateZ(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bz = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw + ay * bz;\n  out[1] = ay * bw - ax * bz;\n  out[2] = az * bw + aw * bz;\n  out[3] = aw * bw - az * bz;\n  return out;\n}\n/**\n * Calculates the W component of a quat from the X, Y, and Z components.\n * Assumes that quaternion is 1 unit in length.\n * Any existing W component will be ignored.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate W component of\n * @returns {quat} out\n */\n\nexport function calculateW(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = Math.sqrt(Math.abs(1.0 - x * x - y * y - z * z));\n  return out;\n}\n/**\n * Calculate the exponential of a unit quaternion.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate the exponential of\n * @returns {quat} out\n */\n\nexport function exp(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  var r = Math.sqrt(x * x + y * y + z * z);\n  var et = Math.exp(w);\n  var s = r > 0 ? et * Math.sin(r) / r : 0;\n  out[0] = x * s;\n  out[1] = y * s;\n  out[2] = z * s;\n  out[3] = et * Math.cos(r);\n  return out;\n}\n/**\n * Calculate the natural logarithm of a unit quaternion.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate the exponential of\n * @returns {quat} out\n */\n\nexport function ln(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  var r = Math.sqrt(x * x + y * y + z * z);\n  var t = r > 0 ? Math.atan2(r, w) / r : 0;\n  out[0] = x * t;\n  out[1] = y * t;\n  out[2] = z * t;\n  out[3] = 0.5 * Math.log(x * x + y * y + z * z + w * w);\n  return out;\n}\n/**\n * Calculate the scalar power of a unit quaternion.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate the exponential of\n * @param {Number} b amount to scale the quaternion by\n * @returns {quat} out\n */\n\nexport function pow(out, a, b) {\n  ln(out, a);\n  scale(out, out, b);\n  exp(out, out);\n  return out;\n}\n/**\n * Performs a spherical linear interpolation between two quat\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {quat} out\n */\n\nexport function slerp(out, a, b, t) {\n  // benchmarks:\n  //    http://jsperf.com/quaternion-slerp-implementations\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  var omega, cosom, sinom, scale0, scale1; // calc cosine\n\n  cosom = ax * bx + ay * by + az * bz + aw * bw; // adjust signs (if necessary)\n\n  if (cosom < 0.0) {\n    cosom = -cosom;\n    bx = -bx;\n    by = -by;\n    bz = -bz;\n    bw = -bw;\n  } // calculate coefficients\n\n\n  if (1.0 - cosom > glMatrix.EPSILON) {\n    // standard case (slerp)\n    omega = Math.acos(cosom);\n    sinom = Math.sin(omega);\n    scale0 = Math.sin((1.0 - t) * omega) / sinom;\n    scale1 = Math.sin(t * omega) / sinom;\n  } else {\n    // \"from\" and \"to\" quaternions are very close\n    //  ... so we can do a linear interpolation\n    scale0 = 1.0 - t;\n    scale1 = t;\n  } // calculate final values\n\n\n  out[0] = scale0 * ax + scale1 * bx;\n  out[1] = scale0 * ay + scale1 * by;\n  out[2] = scale0 * az + scale1 * bz;\n  out[3] = scale0 * aw + scale1 * bw;\n  return out;\n}\n/**\n * Generates a random unit quaternion\n *\n * @param {quat} out the receiving quaternion\n * @returns {quat} out\n */\n\nexport function random(out) {\n  // Implementation of http://planning.cs.uiuc.edu/node198.html\n  // TODO: Calling random 3 times is probably not the fastest solution\n  var u1 = glMatrix.RANDOM();\n  var u2 = glMatrix.RANDOM();\n  var u3 = glMatrix.RANDOM();\n  var sqrt1MinusU1 = Math.sqrt(1 - u1);\n  var sqrtU1 = Math.sqrt(u1);\n  out[0] = sqrt1MinusU1 * Math.sin(2.0 * Math.PI * u2);\n  out[1] = sqrt1MinusU1 * Math.cos(2.0 * Math.PI * u2);\n  out[2] = sqrtU1 * Math.sin(2.0 * Math.PI * u3);\n  out[3] = sqrtU1 * Math.cos(2.0 * Math.PI * u3);\n  return out;\n}\n/**\n * Calculates the inverse of a quat\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate inverse of\n * @returns {quat} out\n */\n\nexport function invert(out, a) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var dot = a0 * a0 + a1 * a1 + a2 * a2 + a3 * a3;\n  var invDot = dot ? 1.0 / dot : 0; // TODO: Would be faster to return [0,0,0,0] immediately if dot == 0\n\n  out[0] = -a0 * invDot;\n  out[1] = -a1 * invDot;\n  out[2] = -a2 * invDot;\n  out[3] = a3 * invDot;\n  return out;\n}\n/**\n * Calculates the conjugate of a quat\n * If the quaternion is normalized, this function is faster than quat.inverse and produces the same result.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate conjugate of\n * @returns {quat} out\n */\n\nexport function conjugate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\n * Creates a quaternion from the given 3x3 rotation matrix.\n *\n * NOTE: The resultant quaternion is not normalized, so you should be sure\n * to renormalize the quaternion yourself where necessary.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyMat3} m rotation matrix\n * @returns {quat} out\n * @function\n */\n\nexport function fromMat3(out, m) {\n  // Algorithm in Ken Shoemake's article in 1987 SIGGRAPH course notes\n  // article \"Quaternion Calculus and Fast Animation\".\n  var fTrace = m[0] + m[4] + m[8];\n  var fRoot;\n\n  if (fTrace > 0.0) {\n    // |w| > 1/2, may as well choose w > 1/2\n    fRoot = Math.sqrt(fTrace + 1.0); // 2w\n\n    out[3] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot; // 1/(4w)\n\n    out[0] = (m[5] - m[7]) * fRoot;\n    out[1] = (m[6] - m[2]) * fRoot;\n    out[2] = (m[1] - m[3]) * fRoot;\n  } else {\n    // |w| <= 1/2\n    var i = 0;\n    if (m[4] > m[0]) i = 1;\n    if (m[8] > m[i * 3 + i]) i = 2;\n    var j = (i + 1) % 3;\n    var k = (i + 2) % 3;\n    fRoot = Math.sqrt(m[i * 3 + i] - m[j * 3 + j] - m[k * 3 + k] + 1.0);\n    out[i] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot;\n    out[3] = (m[j * 3 + k] - m[k * 3 + j]) * fRoot;\n    out[j] = (m[j * 3 + i] + m[i * 3 + j]) * fRoot;\n    out[k] = (m[k * 3 + i] + m[i * 3 + k]) * fRoot;\n  }\n\n  return out;\n}\n/**\n * Creates a quaternion from the given euler angle x, y, z.\n *\n * @param {quat} out the receiving quaternion\n * @param {x} Angle to rotate around X axis in degrees.\n * @param {y} Angle to rotate around Y axis in degrees.\n * @param {z} Angle to rotate around Z axis in degrees.\n * @returns {quat} out\n * @function\n */\n\nexport function fromEuler(out, x, y, z) {\n  var halfToRad = 0.5 * Math.PI / 180.0;\n  x *= halfToRad;\n  y *= halfToRad;\n  z *= halfToRad;\n  var sx = Math.sin(x);\n  var cx = Math.cos(x);\n  var sy = Math.sin(y);\n  var cy = Math.cos(y);\n  var sz = Math.sin(z);\n  var cz = Math.cos(z);\n  out[0] = sx * cy * cz - cx * sy * sz;\n  out[1] = cx * sy * cz + sx * cy * sz;\n  out[2] = cx * cy * sz - sx * sy * cz;\n  out[3] = cx * cy * cz + sx * sy * sz;\n  return out;\n}\n/**\n * Returns a string representation of a quatenion\n *\n * @param {ReadonlyQuat} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\n\nexport function str(a) {\n  return \"quat(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\n * Creates a new quat initialized with values from an existing quaternion\n *\n * @param {ReadonlyQuat} a quaternion to clone\n * @returns {quat} a new quaternion\n * @function\n */\n\nexport var clone = vec4.clone;\n/**\n * Creates a new quat initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {quat} a new quaternion\n * @function\n */\n\nexport var fromValues = vec4.fromValues;\n/**\n * Copy the values from one quat to another\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the source quaternion\n * @returns {quat} out\n * @function\n */\n\nexport var copy = vec4.copy;\n/**\n * Set the components of a quat to the given values\n *\n * @param {quat} out the receiving quaternion\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {quat} out\n * @function\n */\n\nexport var set = vec4.set;\n/**\n * Adds two quat's\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @returns {quat} out\n * @function\n */\n\nexport var add = vec4.add;\n/**\n * Alias for {@link quat.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Scales a quat by a scalar number\n *\n * @param {quat} out the receiving vector\n * @param {ReadonlyQuat} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {quat} out\n * @function\n */\n\nexport var scale = vec4.scale;\n/**\n * Calculates the dot product of two quat's\n *\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @returns {Number} dot product of a and b\n * @function\n */\n\nexport var dot = vec4.dot;\n/**\n * Performs a linear interpolation between two quat's\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {quat} out\n * @function\n */\n\nexport var lerp = vec4.lerp;\n/**\n * Calculates the length of a quat\n *\n * @param {ReadonlyQuat} a vector to calculate length of\n * @returns {Number} length of a\n */\n\nexport var length = vec4.length;\n/**\n * Alias for {@link quat.length}\n * @function\n */\n\nexport var len = length;\n/**\n * Calculates the squared length of a quat\n *\n * @param {ReadonlyQuat} a vector to calculate squared length of\n * @returns {Number} squared length of a\n * @function\n */\n\nexport var squaredLength = vec4.squaredLength;\n/**\n * Alias for {@link quat.squaredLength}\n * @function\n */\n\nexport var sqrLen = squaredLength;\n/**\n * Normalize a quat\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quaternion to normalize\n * @returns {quat} out\n * @function\n */\n\nexport var normalize = vec4.normalize;\n/**\n * Returns whether or not the quaternions have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyQuat} a The first quaternion.\n * @param {ReadonlyQuat} b The second quaternion.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport var exactEquals = vec4.exactEquals;\n/**\n * Returns whether or not the quaternions have approximately the same elements in the same position.\n *\n * @param {ReadonlyQuat} a The first vector.\n * @param {ReadonlyQuat} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport var equals = vec4.equals;\n/**\n * Sets a quaternion to represent the shortest rotation from one\n * vector to another.\n *\n * Both vectors are assumed to be unit length.\n *\n * @param {quat} out the receiving quaternion.\n * @param {ReadonlyVec3} a the initial vector\n * @param {ReadonlyVec3} b the destination vector\n * @returns {quat} out\n */\n\nexport var rotationTo = function () {\n  var tmpvec3 = vec3.create();\n  var xUnitVec3 = vec3.fromValues(1, 0, 0);\n  var yUnitVec3 = vec3.fromValues(0, 1, 0);\n  return function (out, a, b) {\n    var dot = vec3.dot(a, b);\n\n    if (dot < -0.999999) {\n      vec3.cross(tmpvec3, xUnitVec3, a);\n      if (vec3.len(tmpvec3) < 0.000001) vec3.cross(tmpvec3, yUnitVec3, a);\n      vec3.normalize(tmpvec3, tmpvec3);\n      setAxisAngle(out, tmpvec3, Math.PI);\n      return out;\n    } else if (dot > 0.999999) {\n      out[0] = 0;\n      out[1] = 0;\n      out[2] = 0;\n      out[3] = 1;\n      return out;\n    } else {\n      vec3.cross(tmpvec3, a, b);\n      out[0] = tmpvec3[0];\n      out[1] = tmpvec3[1];\n      out[2] = tmpvec3[2];\n      out[3] = 1 + dot;\n      return normalize(out, out);\n    }\n  };\n}();\n/**\n * Performs a spherical linear interpolation with two control points\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @param {ReadonlyQuat} c the third operand\n * @param {ReadonlyQuat} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {quat} out\n */\n\nexport var sqlerp = function () {\n  var temp1 = create();\n  var temp2 = create();\n  return function (out, a, b, c, d, t) {\n    slerp(temp1, a, d, t);\n    slerp(temp2, b, c, t);\n    slerp(out, temp1, temp2, 2 * t * (1 - t));\n    return out;\n  };\n}();\n/**\n * Sets the specified quaternion with values corresponding to the given\n * axes. Each axis is a vec3 and is expected to be unit length and\n * perpendicular to all other specified axes.\n *\n * @param {ReadonlyVec3} view  the vector representing the viewing direction\n * @param {ReadonlyVec3} right the vector representing the local \"right\" direction\n * @param {ReadonlyVec3} up    the vector representing the local \"up\" direction\n * @returns {quat} out\n */\n\nexport var setAxes = function () {\n  var matr = mat3.create();\n  return function (out, view, right, up) {\n    matr[0] = right[0];\n    matr[3] = right[1];\n    matr[6] = right[2];\n    matr[1] = up[0];\n    matr[4] = up[1];\n    matr[7] = up[2];\n    matr[2] = -view[0];\n    matr[5] = -view[1];\n    matr[8] = -view[2];\n    return normalize(out, fromMat3(out, matr));\n  };\n}();", "import * as glMatrix from \"./common.js\";\n/**\n * 3 Dimensional Vector\n * @module vec3\n */\n\n/**\n * Creates a new, empty vec3\n *\n * @returns {vec3} a new 3D vector\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(3);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  return out;\n}\n/**\n * Creates a new vec3 initialized with values from an existing vector\n *\n * @param {ReadonlyVec3} a vector to clone\n * @returns {vec3} a new 3D vector\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\n * Calculates the length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate length of\n * @returns {Number} length of a\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.hypot(x, y, z);\n}\n/**\n * Creates a new vec3 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} a new 3D vector\n */\n\nexport function fromValues(x, y, z) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\n * Copy the values from one vec3 to another\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the source vector\n * @returns {vec3} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\n * Set the components of a vec3 to the given values\n *\n * @param {vec3} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} out\n */\n\nexport function set(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\n * Adds two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n/**\n * Multiplies two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n/**\n * Divides two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n/**\n * Math.ceil the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to ceil\n * @returns {vec3} out\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n/**\n * Math.floor the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to floor\n * @returns {vec3} out\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n/**\n * Returns the minimum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n/**\n * Returns the maximum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n/**\n * Math.round the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to round\n * @returns {vec3} out\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  return out;\n}\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n/**\n * Adds two vec3's after scaling the second operand by a scalar value\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec3} out\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n/**\n * Calculates the euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} distance between a and b\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.hypot(x, y, z);\n}\n/**\n * Calculates the squared euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} squared distance between a and b\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n/**\n * Calculates the squared length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return x * x + y * y + z * z;\n}\n/**\n * Negates the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to negate\n * @returns {vec3} out\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n/**\n * Returns the inverse of the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to invert\n * @returns {vec3} out\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n/**\n * Normalize a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to normalize\n * @returns {vec3} out\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n/**\n * Calculates the dot product of two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} dot product of a and b\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n/**\n * Computes the cross product of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n/**\n * Performs a linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n/**\n * Performs a hermite interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function hermite(out, a, b, c, d, t) {\n  var factorTimes2 = t * t;\n  var factor1 = factorTimes2 * (2 * t - 3) + 1;\n  var factor2 = factorTimes2 * (t - 2) + t;\n  var factor3 = factorTimes2 * (t - 1);\n  var factor4 = factorTimes2 * (3 - 2 * t);\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\n * Performs a bezier interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function bezier(out, a, b, c, d, t) {\n  var inverseFactor = 1 - t;\n  var inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  var factorTimes2 = t * t;\n  var factor1 = inverseFactorTimesTwo * inverseFactor;\n  var factor2 = 3 * t * inverseFactorTimesTwo;\n  var factor3 = 3 * factorTimes2 * inverseFactor;\n  var factor4 = factorTimes2 * t;\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec3} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec3} out\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  var z = glMatrix.RANDOM() * 2.0 - 1.0;\n  var zScale = Math.sqrt(1.0 - z * z) * scale;\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n/**\n * Transforms the vec3 with a mat4.\n * 4th vector component is implicitly '1'\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec3} out\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n/**\n * Transforms the vec3 with a mat3.\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat3} m the 3x3 matrix to transform with\n * @returns {vec3} out\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n/**\n * Transforms the vec3 with a quat\n * Can also be used for dual quaternions. (Multiply it with the real part)\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyQuat} q quaternion to transform with\n * @returns {vec3} out\n */\n\nexport function transformQuat(out, a, q) {\n  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3];\n  var x = a[0],\n      y = a[1],\n      z = a[2]; // var qvec = [qx, qy, qz];\n  // var uv = vec3.cross([], qvec, a);\n\n  var uvx = qy * z - qz * y,\n      uvy = qz * x - qx * z,\n      uvz = qx * y - qy * x; // var uuv = vec3.cross([], qvec, uv);\n\n  var uuvx = qy * uvz - qz * uvy,\n      uuvy = qz * uvx - qx * uvz,\n      uuvz = qx * uvy - qy * uvx; // vec3.scale(uv, uv, 2 * w);\n\n  var w2 = qw * 2;\n  uvx *= w2;\n  uvy *= w2;\n  uvz *= w2; // vec3.scale(uuv, uuv, 2);\n\n  uuvx *= 2;\n  uuvy *= 2;\n  uuvz *= 2; // return vec3.add(out, a, vec3.add(out, uv, uuv));\n\n  out[0] = x + uvx + uuvx;\n  out[1] = y + uvy + uuvy;\n  out[2] = z + uvz + uuvz;\n  return out;\n}\n/**\n * Rotate a 3D vector around the x-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateX(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\n  r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Rotate a 3D vector around the y-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateY(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Rotate a 3D vector around the z-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateZ(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\n  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\n  r[2] = p[2]; //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Get the angle between two 3D vectors\n * @param {ReadonlyVec3} a The first operand\n * @param {ReadonlyVec3} b The second operand\n * @returns {Number} The angle in radians\n */\n\nexport function angle(a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      bx = b[0],\n      by = b[1],\n      bz = b[2],\n      mag1 = Math.sqrt(ax * ax + ay * ay + az * az),\n      mag2 = Math.sqrt(bx * bx + by * by + bz * bz),\n      mag = mag1 * mag2,\n      cosine = mag && dot(a, b) / mag;\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\n * Set the components of a vec3 to zero\n *\n * @param {vec3} out the receiving vector\n * @returns {vec3} out\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec3} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\n\nexport function str(a) {\n  return \"vec3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \")\";\n}\n/**\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));\n}\n/**\n * Alias for {@link vec3.subtract}\n * @function\n */\n\nexport var sub = subtract;\n/**\n * Alias for {@link vec3.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link vec3.divide}\n * @function\n */\n\nexport var div = divide;\n/**\n * Alias for {@link vec3.distance}\n * @function\n */\n\nexport var dist = distance;\n/**\n * Alias for {@link vec3.squaredDistance}\n * @function\n */\n\nexport var sqrDist = squaredDistance;\n/**\n * Alias for {@link vec3.length}\n * @function\n */\n\nexport var len = length;\n/**\n * Alias for {@link vec3.squaredLength}\n * @function\n */\n\nexport var sqrLen = squaredLength;\n/**\n * Perform some operation over an array of vec3s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 3;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n\n    return a;\n  };\n}();", "import * as glMatrix from \"./common.js\";\n/**\n * 4 Dimensional Vector\n * @module vec4\n */\n\n/**\n * Creates a new, empty vec4\n *\n * @returns {vec4} a new 4D vector\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n  }\n\n  return out;\n}\n/**\n * Creates a new vec4 initialized with values from an existing vector\n *\n * @param {ReadonlyVec4} a vector to clone\n * @returns {vec4} a new 4D vector\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\n * Creates a new vec4 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {vec4} a new 4D vector\n */\n\nexport function fromValues(x, y, z, w) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\n * Copy the values from one vec4 to another\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the source vector\n * @returns {vec4} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\n * Set the components of a vec4 to the given values\n *\n * @param {vec4} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {vec4} out\n */\n\nexport function set(out, x, y, z, w) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\n * Adds two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  return out;\n}\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  return out;\n}\n/**\n * Multiplies two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  out[3] = a[3] * b[3];\n  return out;\n}\n/**\n * Divides two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  out[3] = a[3] / b[3];\n  return out;\n}\n/**\n * Math.ceil the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to ceil\n * @returns {vec4} out\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  out[3] = Math.ceil(a[3]);\n  return out;\n}\n/**\n * Math.floor the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to floor\n * @returns {vec4} out\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  out[3] = Math.floor(a[3]);\n  return out;\n}\n/**\n * Returns the minimum of two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  out[3] = Math.min(a[3], b[3]);\n  return out;\n}\n/**\n * Returns the maximum of two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  out[3] = Math.max(a[3], b[3]);\n  return out;\n}\n/**\n * Math.round the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to round\n * @returns {vec4} out\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  out[3] = Math.round(a[3]);\n  return out;\n}\n/**\n * Scales a vec4 by a scalar number\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec4} out\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  return out;\n}\n/**\n * Adds two vec4's after scaling the second operand by a scalar value\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec4} out\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  return out;\n}\n/**\n * Calculates the euclidian distance between two vec4's\n *\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {Number} distance between a and b\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\n * Calculates the squared euclidian distance between two vec4's\n *\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {Number} squared distance between a and b\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\n * Calculates the length of a vec4\n *\n * @param {ReadonlyVec4} a vector to calculate length of\n * @returns {Number} length of a\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\n * Calculates the squared length of a vec4\n *\n * @param {ReadonlyVec4} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\n * Negates the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to negate\n * @returns {vec4} out\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = -a[3];\n  return out;\n}\n/**\n * Returns the inverse of the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to invert\n * @returns {vec4} out\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  out[3] = 1.0 / a[3];\n  return out;\n}\n/**\n * Normalize a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to normalize\n * @returns {vec4} out\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  var len = x * x + y * y + z * z + w * w;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = x * len;\n  out[1] = y * len;\n  out[2] = z * len;\n  out[3] = w * len;\n  return out;\n}\n/**\n * Calculates the dot product of two vec4's\n *\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {Number} dot product of a and b\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n}\n/**\n * Returns the cross-product of three vectors in a 4-dimensional space\n *\n * @param {ReadonlyVec4} result the receiving vector\n * @param {ReadonlyVec4} U the first vector\n * @param {ReadonlyVec4} V the second vector\n * @param {ReadonlyVec4} W the third vector\n * @returns {vec4} result\n */\n\nexport function cross(out, u, v, w) {\n  var A = v[0] * w[1] - v[1] * w[0],\n      B = v[0] * w[2] - v[2] * w[0],\n      C = v[0] * w[3] - v[3] * w[0],\n      D = v[1] * w[2] - v[2] * w[1],\n      E = v[1] * w[3] - v[3] * w[1],\n      F = v[2] * w[3] - v[3] * w[2];\n  var G = u[0];\n  var H = u[1];\n  var I = u[2];\n  var J = u[3];\n  out[0] = H * F - I * E + J * D;\n  out[1] = -(G * F) + I * C - J * B;\n  out[2] = G * E - H * C + J * A;\n  out[3] = -(G * D) + H * B - I * A;\n  return out;\n}\n/**\n * Performs a linear interpolation between two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec4} out\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  var aw = a[3];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  out[3] = aw + t * (b[3] - aw);\n  return out;\n}\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec4} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec4} out\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0; // Marsaglia, George. Choosing a Point from the Surface of a\n  // Sphere. Ann. Math. Statist. 43 (1972), no. 2, 645--646.\n  // http://projecteuclid.org/euclid.aoms/1177692644;\n\n  var v1, v2, v3, v4;\n  var s1, s2;\n\n  do {\n    v1 = glMatrix.RANDOM() * 2 - 1;\n    v2 = glMatrix.RANDOM() * 2 - 1;\n    s1 = v1 * v1 + v2 * v2;\n  } while (s1 >= 1);\n\n  do {\n    v3 = glMatrix.RANDOM() * 2 - 1;\n    v4 = glMatrix.RANDOM() * 2 - 1;\n    s2 = v3 * v3 + v4 * v4;\n  } while (s2 >= 1);\n\n  var d = Math.sqrt((1 - s1) / s2);\n  out[0] = scale * v1;\n  out[1] = scale * v2;\n  out[2] = scale * v3 * d;\n  out[3] = scale * v4 * d;\n  return out;\n}\n/**\n * Transforms the vec4 with a mat4.\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec4} out\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\n  out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\n  out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\n  out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\n  return out;\n}\n/**\n * Transforms the vec4 with a quat\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the vector to transform\n * @param {ReadonlyQuat} q quaternion to transform with\n * @returns {vec4} out\n */\n\nexport function transformQuat(out, a, q) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3]; // calculate quat * vec\n\n  var ix = qw * x + qy * z - qz * y;\n  var iy = qw * y + qz * x - qx * z;\n  var iz = qw * z + qx * y - qy * x;\n  var iw = -qx * x - qy * y - qz * z; // calculate result * inverse quat\n\n  out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n  out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n  out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n  out[3] = a[3];\n  return out;\n}\n/**\n * Set the components of a vec4 to zero\n *\n * @param {vec4} out the receiving vector\n * @returns {vec4} out\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  return out;\n}\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec4} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\n\nexport function str(a) {\n  return \"vec4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec4} a The first vector.\n * @param {ReadonlyVec4} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n}\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec4} a The first vector.\n * @param {ReadonlyVec4} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));\n}\n/**\n * Alias for {@link vec4.subtract}\n * @function\n */\n\nexport var sub = subtract;\n/**\n * Alias for {@link vec4.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link vec4.divide}\n * @function\n */\n\nexport var div = divide;\n/**\n * Alias for {@link vec4.distance}\n * @function\n */\n\nexport var dist = distance;\n/**\n * Alias for {@link vec4.squaredDistance}\n * @function\n */\n\nexport var sqrDist = squaredDistance;\n/**\n * Alias for {@link vec4.length}\n * @function\n */\n\nexport var len = length;\n/**\n * Alias for {@link vec4.squaredLength}\n * @function\n */\n\nexport var sqrLen = squaredLength;\n/**\n * Perform some operation over an array of vec4s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec4. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec4s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 4;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      vec[3] = a[i + 3];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n      a[i + 3] = vec[3];\n    }\n\n    return a;\n  };\n}();", "import * as glMatrix from \"./common.js\";\n/**\n * 2 Dimensional Vector\n * @module vec2\n */\n\n/**\n * Creates a new, empty vec2\n *\n * @returns {vec2} a new 2D vector\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(2);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n  }\n\n  return out;\n}\n/**\n * Creates a new vec2 initialized with values from an existing vector\n *\n * @param {ReadonlyVec2} a vector to clone\n * @returns {vec2} a new 2D vector\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\n * Creates a new vec2 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @returns {vec2} a new 2D vector\n */\n\nexport function fromValues(x, y) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\n * Copy the values from one vec2 to another\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the source vector\n * @returns {vec2} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\n * Set the components of a vec2 to the given values\n *\n * @param {vec2} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @returns {vec2} out\n */\n\nexport function set(out, x, y) {\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\n * Adds two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  return out;\n}\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  return out;\n}\n/**\n * Multiplies two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  return out;\n}\n/**\n * Divides two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  return out;\n}\n/**\n * Math.ceil the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to ceil\n * @returns {vec2} out\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  return out;\n}\n/**\n * Math.floor the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to floor\n * @returns {vec2} out\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  return out;\n}\n/**\n * Returns the minimum of two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  return out;\n}\n/**\n * Returns the maximum of two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  return out;\n}\n/**\n * Math.round the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to round\n * @returns {vec2} out\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  return out;\n}\n/**\n * Scales a vec2 by a scalar number\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec2} out\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  return out;\n}\n/**\n * Adds two vec2's after scaling the second operand by a scalar value\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec2} out\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  return out;\n}\n/**\n * Calculates the euclidian distance between two vec2's\n *\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {Number} distance between a and b\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return Math.hypot(x, y);\n}\n/**\n * Calculates the squared euclidian distance between two vec2's\n *\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {Number} squared distance between a and b\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return x * x + y * y;\n}\n/**\n * Calculates the length of a vec2\n *\n * @param {ReadonlyVec2} a vector to calculate length of\n * @returns {Number} length of a\n */\n\nexport function length(a) {\n  var x = a[0],\n      y = a[1];\n  return Math.hypot(x, y);\n}\n/**\n * Calculates the squared length of a vec2\n *\n * @param {ReadonlyVec2} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\n\nexport function squaredLength(a) {\n  var x = a[0],\n      y = a[1];\n  return x * x + y * y;\n}\n/**\n * Negates the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to negate\n * @returns {vec2} out\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  return out;\n}\n/**\n * Returns the inverse of the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to invert\n * @returns {vec2} out\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  return out;\n}\n/**\n * Normalize a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to normalize\n * @returns {vec2} out\n */\n\nexport function normalize(out, a) {\n  var x = a[0],\n      y = a[1];\n  var len = x * x + y * y;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  return out;\n}\n/**\n * Calculates the dot product of two vec2's\n *\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {Number} dot product of a and b\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1];\n}\n/**\n * Computes the cross product of two vec2's\n * Note that the cross product must by definition produce a 3D vector\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec3} out\n */\n\nexport function cross(out, a, b) {\n  var z = a[0] * b[1] - a[1] * b[0];\n  out[0] = out[1] = 0;\n  out[2] = z;\n  return out;\n}\n/**\n * Performs a linear interpolation between two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec2} out\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0],\n      ay = a[1];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  return out;\n}\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec2} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec2} out\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  out[0] = Math.cos(r) * scale;\n  out[1] = Math.sin(r) * scale;\n  return out;\n}\n/**\n * Transforms the vec2 with a mat2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat2} m matrix to transform with\n * @returns {vec2} out\n */\n\nexport function transformMat2(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  return out;\n}\n/**\n * Transforms the vec2 with a mat2d\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat2d} m matrix to transform with\n * @returns {vec2} out\n */\n\nexport function transformMat2d(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y + m[4];\n  out[1] = m[1] * x + m[3] * y + m[5];\n  return out;\n}\n/**\n * Transforms the vec2 with a mat3\n * 3rd vector component is implicitly '1'\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat3} m matrix to transform with\n * @returns {vec2} out\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[3] * y + m[6];\n  out[1] = m[1] * x + m[4] * y + m[7];\n  return out;\n}\n/**\n * Transforms the vec2 with a mat4\n * 3rd vector component is implicitly '0'\n * 4th vector component is implicitly '1'\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec2} out\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0];\n  var y = a[1];\n  out[0] = m[0] * x + m[4] * y + m[12];\n  out[1] = m[1] * x + m[5] * y + m[13];\n  return out;\n}\n/**\n * Rotate a 2D vector\n * @param {vec2} out The receiving vec2\n * @param {ReadonlyVec2} a The vec2 point to rotate\n * @param {ReadonlyVec2} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec2} out\n */\n\nexport function rotate(out, a, b, rad) {\n  //Translate point to the origin\n  var p0 = a[0] - b[0],\n      p1 = a[1] - b[1],\n      sinC = Math.sin(rad),\n      cosC = Math.cos(rad); //perform rotation and translate to correct position\n\n  out[0] = p0 * cosC - p1 * sinC + b[0];\n  out[1] = p0 * sinC + p1 * cosC + b[1];\n  return out;\n}\n/**\n * Get the angle between two 2D vectors\n * @param {ReadonlyVec2} a The first operand\n * @param {ReadonlyVec2} b The second operand\n * @returns {Number} The angle in radians\n */\n\nexport function angle(a, b) {\n  var x1 = a[0],\n      y1 = a[1],\n      x2 = b[0],\n      y2 = b[1],\n      // mag is the product of the magnitudes of a and b\n  mag = Math.sqrt(x1 * x1 + y1 * y1) * Math.sqrt(x2 * x2 + y2 * y2),\n      // mag &&.. short circuits if mag == 0\n  cosine = mag && (x1 * x2 + y1 * y2) / mag; // Math.min(Math.max(cosine, -1), 1) clamps the cosine between -1 and 1\n\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\n * Set the components of a vec2 to zero\n *\n * @param {vec2} out the receiving vector\n * @returns {vec2} out\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  return out;\n}\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec2} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\n\nexport function str(a) {\n  return \"vec2(\" + a[0] + \", \" + a[1] + \")\";\n}\n/**\n * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec2} a The first vector.\n * @param {ReadonlyVec2} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1];\n}\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec2} a The first vector.\n * @param {ReadonlyVec2} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1];\n  var b0 = b[0],\n      b1 = b[1];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1));\n}\n/**\n * Alias for {@link vec2.length}\n * @function\n */\n\nexport var len = length;\n/**\n * Alias for {@link vec2.subtract}\n * @function\n */\n\nexport var sub = subtract;\n/**\n * Alias for {@link vec2.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link vec2.divide}\n * @function\n */\n\nexport var div = divide;\n/**\n * Alias for {@link vec2.distance}\n * @function\n */\n\nexport var dist = distance;\n/**\n * Alias for {@link vec2.squaredDistance}\n * @function\n */\n\nexport var sqrDist = squaredDistance;\n/**\n * Alias for {@link vec2.squaredLength}\n * @function\n */\n\nexport var sqrLen = squaredLength;\n/**\n * Perform some operation over an array of vec2s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 2;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n    }\n\n    return a;\n  };\n}();", "import { mat4, quat, vec3, vec4 } from 'gl-matrix';\n\nconst UP = vec3.fromValues(0, 1, 0);\n\nexport function panTo(viewMatrix, x, y, z = 0, dt = 1) {\n  let position = vec3.create();\n  mat4.getTranslation(position, viewMatrix);\n  let translation = vec3.fromValues(\n    (x - position[0]) * dt,\n    (y - position[1]) * dt,\n    (z - position[2]) * dt\n  );\n  mat4.translate(viewMatrix, viewMatrix, translation);\n}\n\nexport function lookAt(viewMatrix, x, y, z = 0, dt = 1) {\n  let position = vec3.create();\n  let rotation = quat.create();\n  mat4.getTranslation(position, viewMatrix);\n  mat4.getRotation(rotation, viewMatrix);\n  let target = vec3.fromValues(x, y, z);\n\n  mat4.lookAt(viewMatrix, position, target, UP);\n\n  let targetRotation = quat.create();\n  mat4.getRotation(targetRotation, viewMatrix);\n  quat.slerp(rotation, rotation, targetRotation, dt);\n\n  mat4.fromRotationTranslation(viewMatrix, rotation, position);\n}\n\n/**\n * Gets a directional ray in the world space from the given normalized\n * screen coordinates and camera matrices.\n *\n * NOTE: In addition to some scaling, the y component from a pointer's\n * position usually has to be flipped to match the normalized screen\n * coordinate space, which assumes a range of [-1, 1] for both x and y,\n * where (0, 0) is the center and (-1, -1) is the bottom-left of the\n * screen.\n *\n * ### Typical Device Screen Coordinate Space:\n * ```\n * (0,0)------------(w,0)\n *    |               |\n *    |   (w/2,h/2)   |\n *    |               |\n * (0,w)------------(w,h)\n * ```\n *\n * ### Normalized Screen Coordinate Space:\n * ```\n * (-1,+1)---------(+1,+1)\n *    |               |\n *    |     (0,0)     |\n *    |               |\n * (-1,-1)---------(+1,-1)\n * ```\n *\n * ### Example Conversion from Device to Normalized:\n * ```\n * let normalizedScreenX = (canvasClientX / canvasWidth) * 2 - 1;\n * let normalizedScreenY = 1 - (canvasClientY / canvasHeight) * 2;\n * ```\n *\n * @param {vec3} out The output vector.\n * @param {number} normalizedScreenCoordX The X screen coordinate normalized to [-1, 1], where -1 is the left side of the screen.\n * @param {number} normalizedScreenCoordY The Y screen coordinate normalized to [-1, 1], where -1 is the bottom side of the screen.\n * @param {mat4} projectionMatrix The projection matrix of the world camera.\n * @param {mat4} viewMatrix The view matrix of the world camera.\n * @param {boolean} [normalized=false] Whether to normalize the result. Usually true for non-orthogonal projections.\n * @returns {vec3} The ray direction in the world space. By default, this is not normalized.\n */\nexport function screenToWorldRay(\n  out,\n  normalizedScreenCoordX,\n  normalizedScreenCoordY,\n  projectionMatrix,\n  viewMatrix,\n  normalized = false\n) {\n  // https://antongerdelan.net/opengl/raycasting.html\n  // To homogeneous clip coords\n  let v = vec4.fromValues(\n    normalizedScreenCoordX,\n    normalizedScreenCoordY,\n    -1,\n    1\n  );\n  // To camera coords\n  let m = mat4.create();\n  mat4.invert(m, projectionMatrix);\n  vec4.transformMat4(v, v, m);\n  v[2] = -1;\n  v[3] = 0;\n  // To world coords\n  mat4.invert(m, viewMatrix);\n  vec4.transformMat4(v, v, m);\n  out[0] = v[0];\n  out[1] = v[1];\n  out[2] = v[2];\n  // Normalized as directional ray\n  if (normalized) {\n    vec3.normalize(out, out);\n  }\n  return out;\n}\n", "export class Camera {\n  constructor(projectionMatrix, viewMatrix) {\n    this.projectionMatrix = projectionMatrix;\n    this.viewMatrix = viewMatrix;\n  }\n\n  /**\n   * @abstract\n   * @param {number} [viewportWidth]\n   * @param {number} [viewportHeight]\n   * @returns {Camera}\n   */\n  // eslint-disable-next-line no-unused-vars\n  resize(viewportWidth = undefined, viewportHeight = undefined) {\n    return this;\n  }\n}\n", "import { mat4 } from 'gl-matrix';\nimport { Camera } from './Camera.js';\n\nconst DEFAULT_FOVY = Math.PI / 3;\n\nexport class PerspectiveCamera extends Camera {\n  constructor(fieldOfView = DEFAULT_FOVY, near = 0.1, far = 1000) {\n    super(mat4.create(), mat4.create());\n\n    this.fieldOfView = Number(fieldOfView);\n    this.clippingPlane = {\n      near: Number(near),\n      far: Number(far),\n    };\n  }\n\n  /** @override */\n  resize(viewportWidth = undefined, viewportHeight = undefined) {\n    const aspectRatio =\n      typeof viewportWidth === 'undefined' ? 1 : viewportWidth / viewportHeight;\n    const { near, far } = this.clippingPlane;\n    mat4.perspective(\n      this.projectionMatrix,\n      this.fieldOfView,\n      aspectRatio,\n      near,\n      far\n    );\n    return this;\n  }\n}\n", "import { mat4 } from 'gl-matrix';\nimport { Camera } from './Camera.js';\n\nexport class OrthographicCamera extends Camera {\n  /**\n   * @param {number} [left]\n   * @param {number} [top]\n   * @param {number} [right]\n   * @param {number} [bottom]\n   * @param {number} [near]\n   * @param {number} [far]\n   */\n  constructor(\n    left = undefined,\n    top = undefined,\n    right = undefined,\n    bottom = undefined,\n    near = -1000,\n    far = 1000\n  ) {\n    super(mat4.create(), mat4.create());\n\n    this.orthoBounds = {\n      left: typeof left === 'undefined' ? undefined : Number(left),\n      top: typeof top === 'undefined' ? undefined : Number(top),\n      right: typeof right === 'undefined' ? undefined : Number(right),\n      bottom: typeof bottom === 'undefined' ? undefined : Number(bottom),\n    };\n    this.clippingPlane = {\n      near: Number(near),\n      far: Number(far),\n    };\n  }\n\n  /**\n   * If both the bounds and viewport dimensions are defined, the orthographic\n   * projection will be set the defined bounds adjusted with respect to\n   * the aspect ratio. This is usually the desired behavior.\n   *\n   * If the bounds are `undefined`, the orthographic projection will\n   * be set to the viewport dimensions. This is useful for pixel-perfect\n   * projections.\n   *\n   * If viewport dimensions are `undefined`, the orthographic projection\n   * will only use the defined bounds. This is useful if you are already\n   * performing your own calculations for the bounds or desire a static\n   * projection.\n   *\n   * @override\n   * @param {number} [viewportWidth]\n   * @param {number} [viewportHeight]\n   */\n  resize(viewportWidth = undefined, viewportHeight = undefined) {\n    const { near, far } = this.clippingPlane;\n    const { left, top, right, bottom } = this.orthoBounds;\n\n    let projectionMatrix = this.projectionMatrix;\n    let hasViewport = typeof viewportWidth !== 'undefined';\n    let hasBounds = typeof left !== 'undefined';\n\n    if (hasViewport) {\n      if (hasBounds) {\n        // Use the defined bounds with respect to the viewport aspect ratio\n        const aspectRatio = viewportWidth / viewportHeight;\n        mat4.ortho(\n          projectionMatrix,\n          left * aspectRatio,\n          right * aspectRatio,\n          bottom,\n          top,\n          near,\n          far\n        );\n      } else {\n        // Use the viewport dimensions as bounds\n        mat4.ortho(\n          projectionMatrix,\n          0,\n          viewportWidth,\n          viewportHeight,\n          0,\n          near,\n          far\n        );\n      }\n    } else {\n      if (hasBounds) {\n        // Use the defined bounds as-is\n        mat4.ortho(projectionMatrix, left, right, bottom, top, near, far);\n      } else {\n        // Use default bounds (since nothing else exists)\n        mat4.ortho(projectionMatrix, -1, 1, 1, -1, -1, 1);\n      }\n    }\n    return this;\n  }\n}\n", "import { vec3, mat4 } from 'gl-matrix';\n\nconst TO_RAD_FACTOR = Math.PI / 180;\n\n/**\n * A camera controller that behaves like a traditional first person camera.\n * Pitch is restricted to prevent gimbal lock and roll is ignored.\n *\n * NOTE: Don't forget to lock your pointer, i.e. `canvas.requestPointerLock()`.\n */\nexport class FirstPersonCameraController {\n  constructor(opts = { locky: false }) {\n    this.locky = opts.locky;\n\n    this.position = vec3.create();\n    this.forward = vec3.fromValues(0, 0, -1);\n    this.right = vec3.fromValues(1, 0, 0);\n    this.up = vec3.fromValues(0, 1, 0);\n\n    this.forwardAmount = 0;\n    this.rightAmount = 0;\n    this.upAmount = 0;\n\n    this.pitch = 0;\n    this.yaw = -90;\n  }\n\n  look(dx, dy, dt = 1) {\n    // NOTE: Increase sensitivity to relatively match movement.\n    dt *= 1000;\n    this.pitch = Math.min(89.9, Math.max(-89.9, this.pitch + dy * dt));\n    this.yaw = (this.yaw + dx * dt) % 360;\n    return this;\n  }\n\n  move(forward, right = 0, up = 0, dt = 1) {\n    this.forwardAmount += forward * dt;\n    this.rightAmount += right * dt;\n    this.upAmount += up * dt;\n    return this;\n  }\n\n  apply(viewMatrix) {\n    let {\n      position,\n      forward,\n      right,\n      up,\n      forwardAmount,\n      rightAmount,\n      upAmount,\n      pitch,\n      yaw,\n    } = this;\n\n    // Calculate forward and right vectors\n    let rady = yaw * TO_RAD_FACTOR;\n    let radp = pitch * TO_RAD_FACTOR;\n    let cosy = Math.cos(rady);\n    let cosp = Math.cos(radp);\n    let siny = Math.sin(rady);\n    let sinp = Math.sin(radp);\n    let dx = cosy * cosp;\n    let dy = sinp;\n    let dz = siny * cosp;\n\n    // Set forward for move vector\n    vec3.normalize(forward, vec3.set(forward, dx, this.locky ? 0 : dy, dz));\n    vec3.normalize(right, vec3.cross(right, forward, up));\n\n    let move = vec3.create();\n    // Move forward\n    vec3.scale(move, forward, forwardAmount);\n    vec3.add(position, position, move);\n    // Move right\n    vec3.scale(move, right, rightAmount);\n    vec3.add(position, position, move);\n    // Move up\n    vec3.scale(move, up, upAmount);\n    vec3.add(position, position, move);\n    // Reset movement\n    this.forwardAmount = 0;\n    this.rightAmount = 0;\n    this.upAmount = 0;\n\n    // Reset forward for look vector\n    if (this.locky) vec3.set(forward, dx, dy, dz);\n\n    let target = vec3.add(move, position, forward);\n    mat4.lookAt(viewMatrix, position, target, up);\n    return viewMatrix;\n  }\n}\n", "const MAX_DEPTH_LEVEL = 100;\n\n/**\n * @typedef {Number} SceneNode\n *\n * @typedef SceneNodeInfo\n * @property {SceneNode} parent The parent node. If the node does not have a parent,\n * it will be 0.\n * @property {Array<SceneNode>} children The list of child nodes.\n *\n * @callback WalkCallback Called for each node, before traversing its children.\n * @param {SceneNode} sceneNode The current scene node.\n * @param {SceneGraph} sceneGraph The current scene graph.\n * @returns {WalkBackCallback|Boolean} If false, the walk will skip\n * the current node's children and all of its descendents. If a function,\n * it will be called after traversing down all of its children.\n *\n * @callback WalkBackCallback Called if returned by {@link WalkCallback}, after\n * traversing the current node's children.\n * @param {SceneNode} sceneNode The current scene node.\n * @param {SceneGraph} sceneGraph The current scene graph.\n *\n * @callback WalkChildrenCallback Called for each level of children, before\n * traversing them. This is usually used to determine visit order.\n * @param {Array<SceneNode>} childNodes A list of child nodes to be visited.\n * @param {SceneNode} parentNode The current parent node of these children.\n * @param {SceneGraph} sceneGraph The current scene graph.\n * @returns {Array<SceneNode>} The list of children to traverse for this parent.\n */\n\n/**\n * A tree-like graph of nodes with n-children.\n */\nexport class SceneGraph {\n  /**\n   * Constructs an empty scene graph.\n   */\n  constructor() {\n    this.nodes = {};\n    this.roots = [];\n\n    this._nextAvailableSceneNodeId = 1;\n  }\n\n  /**\n   * Creates a scene node in the scene graph.\n   *\n   * @param {SceneNode} [parentNode] The parent node for the created scene\n   * node.\n   * @returns {SceneNode} The created scene node.\n   */\n  createSceneNode(parentNode = undefined) {\n    let sceneNode = this._nextAvailableSceneNodeId++;\n    let info = createSceneNodeInfo();\n    this.nodes[sceneNode] = info;\n    attach(parentNode, sceneNode, this);\n    return sceneNode;\n  }\n\n  /**\n   * Creates multiple scene nodes in the scene graph.\n   *\n   * @param {Number} count The number of scene nodes to create.\n   * @param {SceneNode} [parentNode] The parent node for the created scene\n   * nodes.\n   * @returns {Array<SceneNode>} A list of created scene nodes.\n   */\n  createSceneNodes(count, parentNode = undefined) {\n    let result = [];\n    for (let i = 0; i < count; ++i) {\n      result.push(this.createSceneNode(parentNode));\n    }\n    return result;\n  }\n\n  /**\n   * Deletes a scene node from the scene graph, along with all\n   * of its descendents.\n   *\n   * @param {SceneNode} sceneNode The scene node to remove.\n   */\n  deleteSceneNode(sceneNode) {\n    if (sceneNode in this.nodes) {\n      let info = this.nodes[sceneNode];\n      detach(info.parent, sceneNode, this);\n      walkImpl(this, sceneNode, 0, walkDeleteCallback);\n    } else {\n      throw new Error('Cannot delete non-existant scene node for scene graph.');\n    }\n  }\n\n  /**\n   * Deletes all given scene nodes from the scene graph, along with all\n   * of their descendents.\n   *\n   * @param {Array<SceneNode>} sceneNodes A list of scene nodes to remove.\n   */\n  deleteSceneNodes(sceneNodes) {\n    for (let sceneNode of sceneNodes) {\n      this.deleteSceneNode(sceneNode);\n    }\n  }\n\n  /**\n   * Get the scene node's info.\n   *\n   * @param {SceneNode} sceneNode The scene node to get info for.\n   * @returns {SceneNodeInfo} The info for the given scene node.\n   */\n  getSceneNodeInfo(sceneNode) {\n    return this.nodes[sceneNode];\n  }\n\n  /**\n   * Changes the parent of the scene node with the new parent node in\n   * the graph.\n   *\n   * @param {SceneNode} sceneNode The target scene node to change.\n   * @param {SceneNode} parentNode The scene node to set as the parent.\n   */\n  parentSceneNode(sceneNode, parentNode) {\n    let info = this.nodes[sceneNode];\n    detach(info.parent, sceneNode, this);\n    attach(parentNode, sceneNode, this);\n  }\n\n  /**\n   * Replaces the scene node with the new replacement node in the graph,\n   * inheriting its parent and children.\n   *\n   * @param {SceneNode} sceneNode The target scene node to replace.\n   * @param {SceneNode} replacementNode The scene node to replace with. If falsey,\n   * it will remove the target scene node and the target's parent will adopt\n   * its grandchildren. If the target did not have parents, the grandchildren will\n   * become root nodes in the graph.\n   */\n  replaceSceneNode(sceneNode, replacementNode) {\n    let info = this.nodes[sceneNode];\n    let parentNode = info.parent;\n    let grandChildren = info.children.slice();\n\n    // Remove the target node from graph\n    detach(parentNode, sceneNode, this);\n\n    // Begin grafting the grandchildren by removing them...\n    info.children.length = 0;\n\n    if (replacementNode) {\n      // Reattach all grandchildren to new replacement node.\n      let replacementInfo = this.nodes[replacementNode];\n      let replacementParent = replacementInfo.parent;\n\n      // Remove replacement node from previous parent\n      detach(replacementParent, replacementNode, this);\n\n      // ...and graft them back.\n      replacementInfo.children.push(...grandChildren);\n\n      // And reattach target parent to new child.\n      attach(parentNode, replacementNode, this);\n    } else {\n      // Reattach all grandchildren to target parent...\n      if (parentNode) {\n        //...as regular children.\n        let parentInfo = this.nodes[parentNode];\n        parentInfo.children.push(...grandChildren);\n      } else {\n        //...as root children.\n        this.roots.push(...grandChildren);\n      }\n    }\n\n    // ...and repair their parent relations.\n    for (let childNode of grandChildren) {\n      this.nodes[childNode].parent = parentNode;\n    }\n  }\n\n  /**\n   * Walks through every child node in the graph.\n   *\n   * @param {WalkCallback} callback The function called for each node\n   * in the graph, in ordered traversal from parent to child.\n   * @param {Object} [opts={}] Any additional options.\n   * @param {SceneNode|Array<SceneNode>} [opts.from] The parent node to\n   * start walking from, inclusive. By default, it will start from the root\n   * nodes.\n   * @param {WalkChildrenCallback} [opts.childfilter] The function called before\n   * walking through the children. This is usually used to determine the\n   * visiting order.\n   */\n  walk(callback, opts = {}) {\n    const { from = undefined, childFilter = undefined } = opts;\n\n    let fromNodes;\n    if (!from) fromNodes = this.roots;\n    else if (!Array.isArray(from)) fromNodes = [from];\n    else fromNodes = from;\n\n    if (childFilter) fromNodes = childFilter(fromNodes, 0, this);\n    for (let fromNode of fromNodes) {\n      walkImpl(this, fromNode, 0, callback, childFilter);\n    }\n  }\n}\n\n/**\n * @param {SceneNode} key The scene node handle.\n * @returns {SceneNodeInfo} The scene node metadata.\n */\nfunction createSceneNodeInfo() {\n  return {\n    parent: 0,\n    children: [],\n  };\n}\n\n/**\n * Attaches a child node to a parent in the scene graph. If parentNode is\n * null, then it will attach as a root node.\n *\n * @param {SceneNode} parentNode The parent node to attach to. Can be null.\n * @param {SceneNode} childNode The child node to attach from.\n * @param {SceneGraph} sceneGraph The scene graph to attach in.\n */\nfunction attach(parentNode, childNode, sceneGraph) {\n  if (parentNode) {\n    // Has new parent; attach to parent. It is now in the graph.\n    sceneGraph.nodes[parentNode].children.push(childNode);\n    sceneGraph.nodes[childNode].parent = parentNode;\n  } else {\n    // No parent; move to root. It is now in the graph.\n    sceneGraph.roots.push(childNode);\n    sceneGraph.nodes[childNode].parent = 0;\n  }\n}\n\n/**\n * Detaches a child node from its parent in the scene graph. If parentNode is\n * null, then it will detach as a root node.\n *\n * @param {SceneNode} parentNode The parent node to attach to. Can be null.\n * @param {SceneNode} childNode The child node to attach from.\n * @param {SceneGraph} sceneGraph The scene graph to attach in.\n */\nfunction detach(parentNode, childNode, sceneGraph) {\n  if (parentNode) {\n    // Has parent; detach from parent. It is now a free node.\n    let children = sceneGraph.nodes[parentNode].children;\n    let childIndex = children.indexOf(childNode);\n    children.splice(childIndex, 1);\n    sceneGraph.nodes[childNode].parentNode = 0;\n  } else {\n    // No parent; remove from root. It is now a free node.\n    let roots = sceneGraph.roots;\n    let rootIndex = roots.indexOf(childNode);\n    roots.splice(rootIndex, 1);\n    sceneGraph.nodes[childNode].parentNode = 0;\n  }\n}\n\n/**\n * Walk down from the parent and through all its descendents.\n *\n * @param {SceneGraph} sceneGraph The scene graph containing the nodes to be visited.\n * @param {SceneNode} parentNode The parent node to start walking from.\n * @param {Number} level The current call depth level. This is used to limit the call stack.\n * @param {WalkCallback} nodeCallback The function called on each visited node.\n * @param {WalkChildrenCallback} [filterCallback] The function called before\n * walking through the children. This is usually used to determine the visiting order.\n */\nfunction walkImpl(\n  sceneGraph,\n  parentNode,\n  level,\n  nodeCallback,\n  filterCallback = undefined\n) {\n  if (level >= MAX_DEPTH_LEVEL) return;\n\n  let result = nodeCallback(parentNode, sceneGraph);\n  if (result === false) return;\n\n  let parentInfo = sceneGraph.nodes[parentNode];\n  let nextNodes = filterCallback\n    ? filterCallback(parentInfo.children, parentNode, sceneGraph)\n    : parentInfo.children;\n\n  for (let childNode of nextNodes) {\n    walkImpl(sceneGraph, childNode, level + 1, nodeCallback, filterCallback);\n  }\n\n  if (typeof result === 'function') {\n    result(parentNode, sceneGraph);\n  }\n}\n\nfunction walkDeleteCallback(sceneNode, sceneGraph) {\n  delete sceneGraph.nodes[sceneNode];\n}\n", "/**\n * @template T\n */\nexport class ComponentClass {\n    /**\n     * @param {string} name \n     * @param {() => T} newCallback\n     * @param {(component: T) => void} [deleteCallback] \n     */\n    constructor(name, newCallback = () => null, deleteCallback = () => { }) {\n        this.name = name;\n        this.new = newCallback;\n        this.delete = deleteCallback;\n    }\n}\n", "import { ComponentClass } from './ComponentClass';\n\n/**\n * @typedef {Record<number, object>} ComponentInstanceMap\n * @typedef {Record<string, ComponentInstanceMap>} ComponentClassMap\n * @typedef {number} EntityId\n * @typedef {string} ComponentName\n */\n\n/**\n * @template {ComponentClass<any>[]} T\n * @typedef {{[K in keyof T]: T[K] extends ComponentClass<infer V> ? V : never}} ComponentInstancesOf<T>\n */\n\n/**\n * @param {EntityManager} entityManager \n * @param {ComponentName} componentName\n * @returns {ComponentInstanceMap} A map of entity ids to component instance data.\n */\nfunction resolveComponentInstanceMap(entityManager, componentName) {\n    // @ts-ignore\n    let components = entityManager.components;\n    if (!(componentName in components)) {\n        /** @type {ComponentInstanceMap} */\n        let map = {};\n        components[componentName] = map;\n        return map;\n    } else {\n        return components[componentName];\n    }\n}\n\n/**\n * @param {EntityManager} entityManager \n * @param {ComponentName} componentName\n * @returns {ComponentInstanceMap} A map of entity ids to component instance data.\n */\nfunction resetComponentInstanceMap(entityManager, componentName) {\n    // @ts-ignore\n    let components = entityManager.components;\n    /** @type {ComponentInstanceMap} */\n    let map = {};\n    components[componentName] = map;\n    return map;\n}\n\n/**\n * @template T\n * @param {EntityManager} entityManager \n * @param {EntityId} entityId \n * @param {ComponentClass<T>} componentClass\n * @param {T} instance\n * @returns {T}\n */\nfunction attachComponent(entityManager, entityId, componentClass, instance) {\n    let componentName = componentClass.name;\n    let instanceMap = resolveComponentInstanceMap(entityManager, componentName);\n    instanceMap[entityId] = instance;\n    return instance;\n}\n\n/**\n * @template T\n * @param {EntityManager} entityManager \n * @param {EntityId} entityId \n * @param {ComponentClass<T>} componentClass\n */\nfunction detachComponent(entityManager, entityId, componentClass) {\n    let componentName = componentClass.name;\n    let instanceMap = resolveComponentInstanceMap(entityManager, componentName);\n    let instance = instanceMap[entityId];\n    delete instanceMap[entityId];\n    componentClass.delete(instance);\n}\n\n/**\n * @template T\n * @param {EntityManager} entityManager\n * @param {ComponentClass<T>} componentClass\n */\nfunction clearComponents(entityManager, componentClass) {\n    let componentName = componentClass.name;\n    let instanceMap = resolveComponentInstanceMap(entityManager, componentName);\n    let instances = Object.values(instanceMap);\n    resetComponentInstanceMap(entityManager, componentName);\n    for(let instance of instances) {\n        componentClass.delete(instance);\n    }\n}\n\nconst NEXT_AVAILABLE_ENTITY_ID = Symbol('nextAvailableEntityId');\n\n/**\n * @param {EntityManager} entityManager \n * @returns {EntityId}\n */\nfunction nextAvailableEntityId(entityManager) {\n    return ++entityManager[NEXT_AVAILABLE_ENTITY_ID];\n}\n\nexport class EntityManager {\n    constructor() {\n        /**\n         * @protected\n         * @type {ComponentClassMap}\n         */\n        this.components = {};\n        /** @type {EntityId} */\n        this[NEXT_AVAILABLE_ENTITY_ID] = 1;\n        /**\n         * @protected\n         * @type {Array<[string, ...any]>}\n         */\n        this.queue = [];\n    }\n\n    flush() {\n        while (this.queue.length > 0) {\n            let [type, ...args] = this.queue.shift();\n            switch (type) {\n                case 'attach': {\n                    let [entityId, componentClass, instance] = args;\n                    attachComponent(this, entityId, componentClass, instance);\n                } break;\n                case 'detach': {\n                    let [entityId, componentClass] = args;\n                    detachComponent(this, entityId, componentClass);\n                } break;\n                case 'clear': {\n                    let [componentClass] = args;\n                    clearComponents(this, componentClass);\n                } break;\n            }\n        }\n    }\n\n    /**\n     * @template {ComponentClass<any>[]}T\n     * @param {T} componentClasses \n     * @returns {[EntityId, ...ComponentInstancesOf<T>]}\n     */\n    createAndAttach(...componentClasses) {\n        let entityId = nextAvailableEntityId(this);\n        let result = /** @type {[EntityId, ...ComponentInstancesOf<T>]} */ (/** @type {unknown} */ ([entityId]));\n        for (let componentClass of componentClasses) {\n            let instance = this.attach(entityId, componentClass);\n            result.push(instance);\n        }\n        return result;\n    }\n\n    /**\n     * @returns {EntityId}\n     */\n    create() {\n        return nextAvailableEntityId(this);\n    }\n\n    /**\n     * @param {EntityId} entityId \n     */\n    destroy(entityId) {\n        for (let instanceMap of Object.values(this.components)) {\n            if (entityId in instanceMap) {\n                delete instanceMap[entityId];\n            }\n        }\n    }\n\n    /**\n     * @param {EntityId} entityId \n     */\n    exists(entityId) {\n        for (let instanceMap of Object.values(this.components)) {\n            if (entityId in instanceMap) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    /**\n     * @template T\n     * @param {EntityId} entityId \n     * @param {ComponentClass<T>} componentClass\n     * @returns {T}\n     */\n    attach(entityId, componentClass) {\n        let instance = componentClass.new();\n        this.queue.push(['attach', entityId, componentClass, instance]);\n        return instance;\n    }\n\n    /**\n     * @template T\n     * @param {EntityId} entityId \n     * @param {ComponentClass<T>} componentClass \n     * @returns {T}\n     */\n    attachImmediately(entityId, componentClass) {\n        let instance = componentClass.new();\n        return attachComponent(this, entityId, componentClass, instance);\n    }\n\n    /**\n     * @template T\n     * @param {EntityId} entityId \n     * @param {ComponentClass<T>} componentClass\n     */\n    detach(entityId, componentClass) {\n        this.queue.push(['detach', entityId, componentClass]);\n    }\n\n    /**\n     * @template T\n     * @param {EntityId} entityId \n     * @param {ComponentClass<T>} componentClass \n     */\n    detachImmediately(entityId, componentClass) {\n        detachComponent(this, entityId, componentClass);\n    }\n\n    /**\n     * @template T\n     * @param {ComponentClass<T>} componentClass \n     */\n    clear(componentClass) {\n        this.queue.push(['clear', componentClass]);\n    }\n\n    /**\n     * @param {ComponentClass<any>} componentClass \n     */\n    clearImmediately(componentClass) {\n        clearComponents(this, componentClass);\n    }\n\n    /**\n     * @template T\n     * @param {EntityId} entityId \n     * @param {ComponentClass<T>} componentClass \n     * @returns {T}\n     */\n    get(entityId, componentClass) {\n        let componentName = componentClass.name;\n        let instanceMap = resolveComponentInstanceMap(this, componentName);\n        if (instanceMap) {\n            return null;\n        } else {\n            return instanceMap[entityId] || null;\n        }\n    }\n\n    /**\n     * @param {ComponentClass<?>} componentClass \n     * @returns {number}\n     */\n    count(componentClass) {\n        let componentName = componentClass.name;\n        let instanceMap = resolveComponentInstanceMap(this, componentName);\n        if (instanceMap) {\n            return 0;\n        } else {\n            return Object.keys(instanceMap).length;\n        }\n    }\n\n    reset() {\n        this.components = {};\n        this[NEXT_AVAILABLE_ENTITY_ID] = 1;\n        this.queue.length = 0;\n    }\n}\n\n/**\n * @template {ComponentClass<any>[]} T\n */\nexport class EntityTemplate {\n    /**\n     * @param {T} componentClasses \n     */\n    constructor(...componentClasses) {\n        /** @private */\n        this.componentClasses = componentClasses;\n    }\n\n    /**\n     * @param {EntityManager} entityManager\n     * @returns {[EntityId, ...ComponentInstancesOf<T>]}\n     */\n    create(entityManager) {\n        let entityId = nextAvailableEntityId(entityManager);\n        let result = /** @type {[EntityId, ...ComponentInstancesOf<T>]} */ (/** @type {unknown} */ ([entityId]));\n        for (let componentClass of this.componentClasses) {\n            let instance = entityManager.attach(entityId, componentClass);\n            result.push(instance);\n        }\n        return result;\n    }\n\n    /**\n     * @param {EntityManager} entityManager \n     * @param {EntityId} entityId \n     */\n    destroy(entityManager, entityId) {\n        for (let componentClass of this.componentClasses) {\n            entityManager.detach(entityId, componentClass);\n        }\n    }\n}\n\n/**\n * @template {ComponentClass<any>[]} T\n */\nexport class EntityQuery {\n    /**\n     * @param {T} selectors \n     */\n    constructor(...selectors) {\n        /** @private */\n        this.selectors = selectors;\n    }\n    \n    /**\n     * @param {EntityManager} entityManager \n     * @returns {number}\n     */\n    count(entityManager) {\n        let count = 0;\n        let iter = this.findAll(entityManager);\n        while(!iter.next().done) {\n            ++count;\n        }\n        return count;\n    }\n\n    /**\n     * @param {EntityManager} entityManager \n     * @returns {[EntityId, ...ComponentInstancesOf<T>]}\n     */\n    find(entityManager) {\n        let entities = this.findAll(entityManager);\n        let result = entities.next();\n        if (result.done) {\n            // @ts-ignore\n            return [];\n        } else {\n            return result.value;\n        }\n    }\n\n    /**\n     * @param {EntityManager} entityManager \n     * @returns {Generator<[EntityId, ...ComponentInstancesOf<T>]>}\n     */\n    *findAll(entityManager) {\n        if (this.selectors.length <= 0) {\n            return;\n        }\n        let componentClass = this.selectors[0];\n        let componentName = componentClass.name;\n        let instanceMap = resolveComponentInstanceMap(entityManager, componentName);\n        let result = /** @type {[EntityId, ...ComponentInstancesOf<T>]} */ (new Array(this.selectors.length + 1));\n        for (let key of Object.keys(instanceMap)) {\n            let entityId = Number(key);\n            let flag = true;\n            result[0] = entityId;\n            let index = 1;\n            for (let otherClass of this.selectors) {\n                let otherName = otherClass.name;\n                let otherMap = resolveComponentInstanceMap(entityManager, otherName);\n                if (!(entityId in otherMap)) {\n                    flag = false;\n                    break;\n                }\n                let other = otherMap[entityId];\n                result[index++] = other;\n            }\n            if (flag) {\n                yield result;\n            }\n        }\n    }\n}\n", "/**\n * @template T\n */\nexport class Topic {\n\n    /**\n     * @abstract\n     * @param {T} [attachment] \n     */\n    dispatch(attachment = null) {}\n\n    /**\n     * @abstract\n     * @param {T} [attachment] \n     */\n    dispatchImmediately(attachment = null) {}\n\n    /**\n     * @abstract\n     * @param {number} max \n     */\n    flush(max = 1000) {}\n}\n", "import { Topic } from './Topic.js';\n\n/**\n * @template T\n */\nexport class CommandTopic extends Topic {\n    \n    constructor() {\n        super();\n\n        /**\n         * @private\n         * @type {Array<T>}\n         */\n        this.messages = [];\n        \n        /**\n         * @private\n         * @type {Array<T>}\n         */\n        this.queued = [];\n    }\n\n    /**\n     * @override\n     * @param {T} message \n     */\n    dispatch(message) {\n        this.queued.push(message);\n    }\n\n    /**\n     * @override\n     * @param {T} message \n     */\n    dispatchImmediately(message) {\n        this.messages.push(message);\n    }\n\n    /** @override */\n    flush(max = 1000) {\n        let result = this.queued.splice(0, Math.min(max, this.queued.length));\n        this.messages.push(...result);\n    }\n\n    /**\n     * @param {number} [max]\n     * @return {Iterable<T>}\n     */\n    *poll(max = 1000) {\n        let iterations = 0;\n        while(iterations < max && this.messages.length > 0) {\n            let message = this.messages.shift();\n            yield message;\n            ++iterations;\n        }\n    }\n}\n", "import { Topic } from './Topic.js';\n\n/**\n * @template T\n * @typedef {(t: T) => void|boolean} EventTopicCallback\n */\n\n/** @template T */\nexport class EventTopic extends Topic {\n\n    constructor() {\n        super();\n\n        /**\n         * @private\n         * @type {Array<EventTopicCallback<T>>}\n         */\n        this.listeners = [];\n\n        /**\n         * @private\n         * @type {Array<T>}\n         */\n        this.queued = [];\n    }\n\n    /**\n     * @param {EventTopicCallback<T>} callback \n     */\n    on(callback) {\n        this.listeners.push(callback);\n        return this;\n    }\n\n    /**\n     * @param {EventTopicCallback<T>} callback \n     */\n    off(callback) {\n        let i = this.listeners.indexOf(callback);\n        if (i >= 0) {\n            this.listeners.splice(i, 1);\n        }\n        return this;\n    }\n\n    /**\n     * @param {EventTopicCallback<T>} callback \n     */\n    once(callback) {\n        let wrapper = (attachment) => {\n            this.off(wrapper);\n            return callback(attachment);\n        };\n        this.on(wrapper);\n        return this;\n    }\n\n    /**\n     * @override\n     * @param {T} [attachment]\n     */\n    dispatch(attachment = null) {\n        this.queued.push(attachment);\n    }\n\n    /**\n     * @override\n     * @param {T} [attachment] \n     */\n    dispatchImmediately(attachment = null) {\n        for(let listener of this.listeners) {\n            let result = listener(attachment);\n            // Consume the event if return true.\n            if (result === true) {\n                break;\n            }\n        }\n    }\n\n    /** @override */\n    flush(max = 1000) {\n        let i = 0;\n        while(this.queued.length > 0 && i++ < max) {\n            let attachment = this.queued.shift();\n            this.dispatchImmediately(attachment);\n        }\n    }\n\n    count() {\n        return this.listeners.length;\n    }\n}\n", "import { Topic } from './Topic.js';\n\n/**\n * @template T\n * @typedef {(t: T) => void|boolean} PriorityTopicCallback<T>\n */\n\n/**\n * @template T\n * @typedef PriorityTopicOptions\n * @property {number} priority\n * @property {PriorityTopicCallback<T>} callback\n */\n\n/**\n * @param {PriorityTopicOptions<?>} a \n * @param {PriorityTopicOptions<?>} b \n */\nfunction comparator(a, b) {\n    return a.priority - b.priority;\n}\n\n/**\n * @template T\n */\nexport class PriorityEventTopic extends Topic {\n\n    constructor() {\n        super();\n\n        /**\n         * @private\n         * @type {Array<PriorityTopicOptions<T>>}\n         */\n        this.listeners = [];\n\n        /**\n         * @private\n         * @type {Array<T>}\n         */\n        this.queued = [];\n    }\n\n    /**\n     * @param {number} priority \n     * @param {PriorityTopicCallback<T>} callback \n     */\n    on(priority, callback) {\n        this.listeners.push({ priority, callback });\n        this.listeners.sort(comparator);\n        return this;\n    }\n\n    /**\n     * @param {PriorityTopicCallback<T>} callback \n     */\n    off(callback) {\n        for(let i = 0; i < this.listeners.length; ++i) {\n            if (this.listeners.at(i).callback === callback) {\n                this.listeners.splice(i, 1);\n                break;\n            }\n        }\n        return this;\n    }\n\n    /**\n     * @param {number} priority \n     * @param {PriorityTopicCallback<T>} callback \n     */\n    once(priority, callback) {\n        let wrapper = (attachment) => {\n            this.off(wrapper);\n            return callback(attachment);\n        };\n        return this.on(priority, wrapper);\n    }\n\n    count() {\n        return this.listeners.length;\n    }\n\n    /**\n     * @override\n     * @param {T} [attachment]\n     */\n    dispatch(attachment = null) {\n        this.queued.push(attachment);\n        return this;\n    }\n\n    /**\n     * @override\n     * @param {T} [attachment] \n     */\n    dispatchImmediately(attachment = null) {\n        for(let listener of this.listeners) {\n            let result = listener.callback(attachment);\n            // Consume the event if return true.\n            if (result === true) {\n                break;\n            }\n        }\n        return this;\n    }\n\n    /** @override */\n    flush(max = 1000) {\n        let i = 0;\n        while(this.queued.length > 0 && i++ < max) {\n            let attachment = this.queued.shift();\n            this.dispatchImmediately(attachment);\n        }\n        return this;\n    }\n}\n", "/** @typedef {(frameDetail: AnimationFrameLoop) => void} AnimationFrameLoopCallback */\n\nexport class AnimationFrameLoop {\n    \n    /**\n     * @param {AnimationFrameLoopCallback} callback \n     * @param {object} [opts]\n     * @param {Window} [opts.animationFrameHandler]\n     */\n    constructor(callback, opts = undefined) {\n        const { animationFrameHandler = window } = opts || {};\n\n        /** @type {ReturnType<requestAnimationFrame>} */\n        this.handle = 0;\n        this.detail = {\n            prevTime: -1,\n            currentTime: -1,\n            deltaTime: 0,\n        };\n\n        /** @protected */\n        this.animationFrameHandler = animationFrameHandler;\n\n        /** @protected */\n        this.callback = callback;\n\n        this.next = this.next.bind(this);\n        this.start = this.start.bind(this);\n        this.cancel = this.cancel.bind(this);\n    }\n    \n    next(now = performance.now()) {\n        this.handle = this.animationFrameHandler.requestAnimationFrame(this.next);\n        let d = this.detail;\n        d.prevTime = d.currentTime;\n        d.currentTime = now;\n        d.deltaTime = d.currentTime - d.prevTime;\n        this.callback(this);\n    }\n\n    start() {\n        this.handle = this.animationFrameHandler.requestAnimationFrame(this.next);\n        return this;\n    }\n\n    cancel() {\n        this.animationFrameHandler.cancelAnimationFrame(this.handle);\n        return this;\n    }\n}\n", "/**\n * Checks whether the context supports WebGL2 features.\n *\n * @param {WebGLRenderingContextBase} gl The webgl context.\n * @returns {boolean} Whether WebGL2 is supported.\n */\nexport function isWebGL2Supported(gl) {\n  return (\n    typeof WebGL2RenderingContext !== 'undefined' &&\n    gl instanceof WebGL2RenderingContext\n  );\n}\n", "import { isWebGL2Supported } from '../GLHelper.js';\n\nexport class BufferDataContext {\n  /**\n   * @param {WebGLRenderingContextBase} gl The gl context.\n   * @param {GLenum} target The buffer bind target. Usually, this is\n   * `gl.ARRAY_BUFFER` or `gl.ELEMENT_ARRAY_BUFFER`.\n   */\n  constructor(gl, target) {\n    this.gl = gl;\n    this.target = target;\n  }\n\n  /**\n   * @param {BufferSource|number} srcDataOrSize The buffer data source or the buffer size in bytes.\n   * @param {GLenum} [usage] The buffer data usage. By default, this is `gl.STATIC_DRAW`.\n   * @returns {BufferDataContext}\n   */\n  data(srcDataOrSize, usage = undefined) {\n    const gl = this.gl;\n    const target = this.target;\n    if (typeof srcDataOrSize === 'number') {\n      /** @type {WebGLRenderingContext|WebGL2RenderingContext} */\n      (gl).bufferData(target, srcDataOrSize, usage || gl.STATIC_DRAW);\n    } else {\n      if (!ArrayBuffer.isView(srcDataOrSize))\n        throw new Error('Source data must be a typed array.');\n      /** @type {WebGLRenderingContext|WebGL2RenderingContext} */\n      (gl).bufferData(target, srcDataOrSize, usage || gl.STATIC_DRAW);\n    }\n    return this;\n  }\n\n  /**\n   * @param {BufferSource} srcData The buffer data source.\n   * @param {number} [dstOffset] The destination byte offset to put the data.\n   * @param {number} [srcOffset] The source array index offset to copy the data from.\n   * @param {number} [srcLength] The source array count to copy the data until.\n   * @returns {BufferDataContext}\n   */\n  subData(\n    srcData,\n    dstOffset = 0,\n    srcOffset = undefined,\n    srcLength = undefined\n  ) {\n    const gl = this.gl;\n    const target = this.target;\n    if (!ArrayBuffer.isView(srcData)) {\n      throw new Error('Source data must be a typed array.');\n    } else if (typeof srcOffset !== 'undefined') {\n      if (isWebGL2Supported(gl)) {\n        /** @type {WebGL2RenderingContext} */\n        (gl).bufferSubData(target, dstOffset, srcData, srcOffset, srcLength);\n      } else {\n        // HACK: `subarray()` is in ALL TypedArrays, but not in BufferSource\n        const srcSubData = srcLength\n          // @ts-ignore\n          ? srcData.subarray(srcOffset, srcOffset + srcLength)\n          // @ts-ignore\n          : srcData.subarray(srcOffset);\n        /** @type {WebGLRenderingContext|WebGL2RenderingContext} */\n        (gl).bufferSubData(target, dstOffset, srcSubData);\n      }\n    } else {\n      /** @type {WebGLRenderingContext|WebGL2RenderingContext} */\n      (gl).bufferSubData(target, dstOffset, srcData);\n    }\n    return this;\n  }\n}\n\nexport class BufferBuilder {\n  /**\n   * @param {WebGLRenderingContext} gl The webgl context.\n   * @param {GLenum} target The buffer bind target. Usually, this is\n   * `gl.ARRAY_BUFFER` or `gl.ELEMENT_ARRAY_BUFFER`.\n   * @param {WebGLBuffer} [buffer] The buffer handle. If undefined, a\n   * new buffer will be created.\n   */\n  constructor(gl, target, buffer = undefined) {\n    /** @private */\n    this.dataContext = new BufferDataContext(gl, target);\n    this.handle = buffer || gl.createBuffer();\n    gl.bindBuffer(target, this.handle);\n  }\n\n  get gl() {\n    return this.dataContext.gl;\n  }\n\n  get target() {\n    return this.dataContext.target;\n  }\n\n  /**\n   * @param {BufferSource|number} srcDataOrSize The buffer data source or the buffer size in bytes.\n   * @param {GLenum} [usage] The buffer data usage. By default, this is `gl.STATIC_DRAW`.\n   * @returns {BufferBuilder}\n   */\n  data(srcDataOrSize, usage = undefined) {\n    this.dataContext.data(srcDataOrSize, usage);\n    return this;\n  }\n\n  /**\n   * @param {BufferSource} srcData The buffer data source.\n   * @param {number} [dstOffset] The destination byte offset to put the data.\n   * @param {number} [srcOffset] The source array index offset to copy the data from.\n   * @param {number} [srcLength] The source array count to copy the data until.\n   * @returns {BufferBuilder}\n   */\n  subData(\n    srcData,\n    dstOffset = 0,\n    srcOffset = undefined,\n    srcLength = undefined\n  ) {\n    this.dataContext.subData(srcData, dstOffset, srcOffset, srcLength);\n    return this;\n  }\n\n  /** @returns {WebGLBuffer} */\n  build() {\n    return this.handle;\n  }\n}\n", "import { BufferDataContext } from './BufferBuilder.js';\n\nexport class BufferInfo {\n  /**\n   * @param {WebGLRenderingContextBase} gl The gl context.\n   * @param {GLenum} target The buffer bind target. Usually, this is\n   * `gl.ARRAY_BUFFER` or `gl.ELEMENT_ARRAY_BUFFER`.\n   * @param {GLenum} bufferType The buffer data type. Usually, this is\n   * `gl.FLOAT` for array buffers or `gl.UNSIGNED_SHORT` for element\n   * array buffers. It must be either `gl.BYTE`, `gl.UNSIGNED_BYTE`,\n   * `gl.SHORT`, `gl.UNSIGNED_SHORT`, `gl.FLOAT`, or `gl.HALF_FLOAT`\n   * for WebGL2.\n   * @param {WebGLBuffer} buffer The buffer handle.\n   */\n  constructor(gl, target, bufferType, buffer) {\n    this.gl = gl;\n    this.target = target;\n    this.handle = buffer;\n    this.type = bufferType;\n\n    /** @private */\n    this.bindContext = new BufferDataContext(gl, this.target);\n  }\n\n  bind(gl) {\n    gl.bindBuffer(this.target, this.handle);\n    this.bindContext.gl = gl;\n    return this.bindContext;\n  }\n}\n", "// https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Constants\nexport const BufferEnums = {\n  // WebGL1\n  BYTE: 0x1400,\n  UNSIGNED_BYTE: 0x1401,\n  SHORT: 0x1402,\n  UNSIGNED_SHORT: 0x1403,\n  INT: 0x1404,\n  UNSIGNED_INT: 0x1405,\n  FLOAT: 0x1406,\n  // WebGL2\n  HALF_FLOAT: 0x140b,\n};\n", "import { BufferEnums } from '../BufferEnums.js';\n\n/**\n * Creates a buffer source given the type and data.\n *\n * @param {WebGLRenderingContextBase} gl The gl context.\n * @param {GLenum} type The data type of the elements in the buffer. Usually,\n * this is `gl.FLOAT` for array buffers or `gl.UNSIGNED_SHORT` for element\n * array buffers. It must be either `gl.BYTE`, `gl.UNSIGNED_BYTE`, `gl.SHORT`,\n * `gl.UNSIGNED_SHORT`, `gl.FLOAT`, or `gl.HALF_FLOAT` for WebGL2.\n * @param {Array<number>} data The buffer source data array.\n * @returns {BufferSource} The typed array buffer containing the given data.\n */\nexport function createBufferSource(gl, type, data) {\n  const TypedArray = getTypedArrayForBufferType(gl, type);\n  return new TypedArray(data);\n}\n\n/**\n * Create a buffer with the given source.\n *\n * @param {WebGLRenderingContext|WebGL2RenderingContext} gl The gl context.\n * @param {GLenum} target The buffer bind target. Usually, this is `gl.ARRAY_BUFFER` or\n * `gl.ELEMENT_ARRAY_BUFFER`.\n * @param {BufferSource} bufferSource The buffer source array.\n * @param {GLenum} [usage] The buffer usage hint. By default, this is `gl.STATIC_DRAW`.\n * @returns {WebGLBuffer} The created and bound data buffer.\n */\nexport function createBuffer(gl, target, bufferSource, usage = gl.STATIC_DRAW) {\n  if (!ArrayBuffer.isView(bufferSource))\n    throw new Error('Source data must be a typed array.');\n  let handle = gl.createBuffer();\n  gl.bindBuffer(target, handle);\n  gl.bufferData(target, bufferSource, usage);\n  return handle;\n}\n\n/**\n * @param {WebGLRenderingContextBase} gl \n * @param {GLenum} bufferType\n */\nexport function getTypedArrayForBufferType(gl, bufferType) {\n  // NOTE: For WebGL2, gl.HALF_FLOAT (float16) does not have an associated TypedArray.\n  switch (bufferType) {\n    case gl.BYTE:\n      return Int8Array;\n    case gl.UNSIGNED_BYTE:\n      return Uint8Array;\n    case gl.SHORT:\n      return Int16Array;\n    case gl.UNSIGNED_SHORT:\n      return Uint16Array;\n    case gl.INT:\n      return Int32Array;\n    case gl.UNSIGNED_INT:\n      return Uint32Array;\n    case gl.FLOAT:\n      return Float32Array;\n    default:\n      throw new Error(`Cannot find valid typed array for buffer type '${bufferType}'.`);\n  }\n}\n\n/**\n * @param {WebGLRenderingContextBase} gl \n * @param {BufferSource} bufferSource \n * @returns {GLenum}\n */\nexport function getBufferTypeForBufferSource(gl, bufferSource) {\n  if (bufferSource instanceof Int8Array) {\n    return gl.BYTE;\n  } else if (bufferSource instanceof Uint8Array) {\n    return gl.UNSIGNED_BYTE;\n  } else if (bufferSource instanceof Int16Array) {\n    return gl.SHORT;\n  } else if (bufferSource instanceof Uint16Array) {\n    return gl.UNSIGNED_SHORT;\n  } else if (bufferSource instanceof Int32Array) {\n    return gl.INT;\n  } else if (bufferSource instanceof Uint32Array) {\n    return gl.UNSIGNED_INT;\n  } else if (bufferSource instanceof Float32Array) {\n    return gl.FLOAT;\n  } else {\n    throw new Error('Cannot find valid data type for buffer source.');\n  }\n}\n\nconst BUFFER_TYPE_BYTE_COUNT = {\n  [BufferEnums.BYTE]: 1,\n  [BufferEnums.UNSIGNED_BYTE]: 1,\n  [BufferEnums.SHORT]: 2,\n  [BufferEnums.UNSIGNED_SHORT]: 2,\n  [BufferEnums.INT]: 4,\n  [BufferEnums.UNSIGNED_INT]: 4,\n  [BufferEnums.FLOAT]: 4,\n  [BufferEnums.HALF_FLOAT]: 2,\n};\nexport function getByteCountForBufferType(gl, bufferType) {\n  return BUFFER_TYPE_BYTE_COUNT[bufferType];\n}\n\n/**\n * @param {WebGLRenderingContextBase} gl \n * @param {Int8ArrayConstructor\n * |Uint8ArrayConstructor\n * |Int16ArrayConstructor\n * |Uint16ArrayConstructor\n * |Int32ArrayConstructor\n * |Uint32ArrayConstructor\n * |Float32ArrayConstructor} typedArray \n * @returns {GLenum}\n */\nexport function getBufferTypeForTypedArray(gl, typedArray) {\n  // NOTE: For WebGL2, gl.HALF_FLOAT (float16) does not have an associated TypedArray.\n  switch (typedArray) {\n    case Int8Array:\n      return gl.BYTE;\n    case Uint8Array:\n      return gl.UNSIGNED_BYTE;\n    case Int16Array:\n      return gl.SHORT;\n    case Uint16Array:\n      return gl.UNSIGNED_SHORT;\n    case Int32Array:\n      return gl.INT;\n    case Uint32Array:\n      return gl.UNSIGNED_INT;\n    case Float32Array:\n      return gl.FLOAT;\n    default:\n      throw new Error('Cannot find valid buffer type for typed array.');\n  }\n}\n\n/**\n * @param {WebGLRenderingContextBase} gl \n * @param {GLenum} target \n * @param {WebGLBuffer} buffer \n * @returns {GLenum}\n */\nexport function getBufferUsage(gl, target, buffer) {\n  gl.bindBuffer(target, buffer);\n  return gl.getBufferParameter(target, gl.BUFFER_USAGE);\n}\n\n/**\n * @param {WebGLRenderingContextBase} gl \n * @param {GLenum} target \n * @param {WebGLBuffer} buffer \n * @returns {GLenum}\n */\nexport function getBufferByteCount(gl, target, buffer) {\n  gl.bindBuffer(target, buffer);\n  return gl.getBufferParameter(target, gl.BUFFER_SIZE);\n}\n\n/**\n * @param {WebGLRenderingContextBase} gl \n * @param {GLenum} target \n * @param {WebGLBuffer} buffer \n * @returns {GLenum}\n */\nexport function getBufferLength(gl, target, buffer, type) {\n  return Math.trunc(getBufferByteCount(gl, target, buffer) / getByteCountForBufferType(gl, type));\n}\n", "import { BufferInfo } from './BufferInfo.js';\nimport { BufferBuilder } from './BufferBuilder.js';\nimport { getBufferTypeForBufferSource, getBufferTypeForTypedArray } from './helper/BufferHelper.js';\n\nexport class BufferInfoBuilder {\n  /**\n   * @param {WebGLRenderingContext|WebGL2RenderingContext} gl The gl context.\n   * @param {GLenum} target The buffer bind target. Usually, this is\n   * `gl.ARRAY_BUFFER` or `gl.ELEMENT_ARRAY_BUFFER`.\n   * @param {WebGLBuffer} [buffer] The buffer handle. If undefined, a\n   * new buffer will be created.\n   */\n  constructor(gl, target, buffer = undefined) {\n    /** @private */\n    this.bufferBuilder = new BufferBuilder(gl, target, buffer);\n    /** @private */\n    this.bufferType = gl.FLOAT;\n  }\n\n  get gl() {\n    return this.bufferBuilder.gl;\n  }\n\n  get handle() {\n    return this.bufferBuilder.handle;\n  }\n\n  get target() {\n    return this.bufferBuilder.target;\n  }\n\n  /**\n   * @param {BufferSource|number} srcDataOrSize The buffer data source or the buffer size in bytes.\n   * @param {GLenum} [usage] The buffer data usage. By default, this is `gl.STATIC_DRAW`.\n   * @returns {BufferInfoBuilder}\n   */\n  data(srcDataOrSize, usage = undefined) {\n    this.bufferBuilder.data(srcDataOrSize, usage);\n    if (typeof srcDataOrSize !== 'number') {\n      this.bufferType = getBufferTypeForBufferSource(this.gl, srcDataOrSize);\n    }\n    return this;\n  }\n\n  /**\n   * @param {BufferSource} srcData The buffer data source.\n   * @param {number} [dstOffset] The destination byte offset to put the data.\n   * @param {number} [srcOffset] The source array index offset to copy the data from.\n   * @param {number} [srcLength] The source array count to copy the data until.\n   * @returns {BufferInfoBuilder}\n   */\n  subData(\n    srcData,\n    dstOffset = undefined,\n    srcOffset = undefined,\n    srcLength = undefined\n  ) {\n    this.bufferBuilder.subData(srcData, dstOffset, srcOffset, srcLength);\n    this.bufferType = getBufferTypeForBufferSource(this.gl, srcData);\n    return this;\n  }\n\n  /**\n   * @returns {BufferInfo}\n   */\n  build() {\n    const handle = this.bufferBuilder.build();\n    const gl = this.gl;\n    const target = this.target;\n    const type = this.bufferType;\n    return new BufferInfo(gl, target, type, handle);\n  }\n}\n", "/**\n * Get list of parameter infos for all active uniforms in the shader program.\n *\n * @param {WebGLRenderingContextBase} gl The webgl context.\n * @param {WebGLProgram} program The program to get the active uniforms from.\n * @returns {Array<WebGLActiveInfo>} An array of active uniforms.\n */\nexport function getActiveUniforms(gl, program) {\n  let result = [];\n  const uniformCount = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);\n  for (let i = 0; i < uniformCount; ++i) {\n    let uniformInfo = gl.getActiveUniform(program, i);\n    if (!uniformInfo) break;\n    result.push(uniformInfo);\n  }\n  return result;\n}\n\n/**\n * Get list of parameter infos for all active attributes in the shader program.\n *\n * @param {WebGLRenderingContextBase} gl The webgl context.\n * @param {WebGLProgram} program The program to get the active attributes from.\n * @returns {Array<WebGLActiveInfo>} An array of active attributes.\n */\nexport function getActiveAttribs(gl, program) {\n  let result = [];\n  const attributeCount = gl.getProgramParameter(program, gl.ACTIVE_ATTRIBUTES);\n  for (let i = 0; i < attributeCount; ++i) {\n    let attributeInfo = gl.getActiveAttrib(program, i);\n    if (!attributeInfo) continue;\n    result.push(attributeInfo);\n  }\n  return result;\n}\n", "/**\n * Get the number of expected elements in the attribute vertex type.\n *\n * @param {WebGLRenderingContextBase} gl The gl context.\n * @param {GLenum} attribType The attribute gl type.\n * @returns {number} The number of expected elements in the attribute vertex type.\n */\nexport function getAttribVertexSize(gl, attribType) {\n  // https://www.khronos.org/registry/OpenGL-Refpages/es2.0/xhtml/glGetActiveAttrib.xml\n  switch (attribType) {\n    case gl.FLOAT:\n    case gl.INT:\n    case gl.UNSIGNED_INT:\n    case gl.BOOL:\n      return 1;\n    case gl.FLOAT_VEC2:\n    case gl.INT_VEC2:\n    case gl.BOOL_VEC2:\n      return 2;\n    case gl.FLOAT_VEC3:\n    case gl.INT_VEC3:\n    case gl.BOOL_VEC3:\n      return 3;\n    case gl.FLOAT_VEC4:\n    case gl.INT_VEC4:\n    case gl.BOOL_VEC4:\n      return 4;\n    case gl.FLOAT_MAT2:\n      return 4;\n    case gl.FLOAT_MAT3:\n      return 9;\n    case gl.FLOAT_MAT4:\n      return 16;\n    default:\n      throw new Error('Invalid vertex attribute type.');\n  }\n}\n", "import { isWebGL2Supported } from '../GLHelper.js';\nimport { getAttribVertexSize } from './ProgramAttributeHelper.js';\n\n/**\n * @callback AttributeFunction\n * @param {number} index\n * @param {WebGLBuffer} buffer\n * @param {number} vertexSize\n * @param {GLenum} bufferType\n * @param {boolean} normalize\n * @param {number} stride\n * @param {number} offset\n * @param {number} divisor\n */\n\n/**\n * Gets the attribute modifier function by attribute type. For vectors\n * of size 1, it accepts a single number value. For vectors of greater\n * size, it takes an array of numbers.\n *\n * @param {WebGLRenderingContextBase} gl The webgl context.\n * @param {GLenum} attributeType The attribute data type.\n * @returns {AttributeFunction} The attribute modifier function.\n */\nexport function getAttributeFunction(gl, attributeType) {\n    // https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Constants\n    switch (attributeType) {\n        // WebGL1\n        case gl.FLOAT:\n        case gl.FLOAT_VEC2:\n        case gl.FLOAT_VEC3:\n        case gl.FLOAT_VEC4:\n            return attributeFloatBuffer;\n    }\n\n    if (isWebGL2Supported(gl)) {\n        const gl2 = /** @type {WebGL2RenderingContext} */ (gl);\n        switch (attributeType) {\n            case gl.INT:\n            case gl.INT_VEC2:\n            case gl.INT_VEC3:\n            case gl.INT_VEC4:\n            case gl.BOOL:\n            case gl.BOOL_VEC2:\n            case gl.BOOL_VEC3:\n            case gl.BOOL_VEC4:\n                return attributeIntBuffer;\n            case gl.FLOAT_MAT2:\n                return attributeFloatMat2Buffer;\n            case gl.FLOAT_MAT3:\n                return attributeFloatMat3Buffer;\n            case gl.FLOAT_MAT4:\n                return attributeFloatMat4Buffer;\n            // WebGL2\n            case gl2.UNSIGNED_INT:\n            case gl2.UNSIGNED_INT_VEC2:\n            case gl2.UNSIGNED_INT_VEC3:\n            case gl2.UNSIGNED_INT_VEC4:\n                return attributeUintBuffer;\n        }\n    }\n\n    throw new Error('Cannot find attribute function for gl enum.');\n}\n\n/**\n * @param {number} index\n * @param {WebGLBuffer} buffer\n * @param {number} vertexSize\n * @param {GLenum} bufferType\n * @param {boolean} normalize\n * @param {number} stride\n * @param {number} offset\n * @param {number} divisor\n * @this {WebGLRenderingContextBase}\n */\nfunction attributeFloatBuffer(index, buffer, vertexSize, bufferType, normalize = false, stride = 0, offset = 0, divisor = undefined) {\n    this.bindBuffer(this.ARRAY_BUFFER, buffer);\n    this.enableVertexAttribArray(index);\n    this.vertexAttribPointer(index, vertexSize, bufferType, normalize, stride, offset);\n    if (divisor !== undefined) {\n        if (!isWebGL2Supported(this)) {\n            throw new Error('Cannot use attribute divisor in WebGL 1.');\n        }\n        const gl2 = /** @type {WebGL2RenderingContext} */ (this);\n        gl2.vertexAttribDivisor(index, divisor);\n    }\n}\n\n/**\n * @param {number} index\n * @param {WebGLBuffer} buffer\n * @param {number} vertexSize\n * @param {GLenum} bufferType\n * @param {boolean} normalize\n * @param {number} stride\n * @param {number} offset\n * @param {number} divisor\n * @this {WebGLRenderingContextBase}\n */\n function attributeIntBuffer(index, buffer, vertexSize, bufferType, normalize = false, stride = 0, offset = 0, divisor = undefined) {\n    if (!isWebGL2Supported(this)) {\n        throw new Error('Cannot use attribute divisor in WebGL 1.');\n    }\n    const gl2 = /** @type {WebGL2RenderingContext} */ (this);\n    gl2.bindBuffer(gl2.ARRAY_BUFFER, buffer);\n    gl2.enableVertexAttribArray(index);\n    gl2.vertexAttribIPointer(index, vertexSize, bufferType, stride, offset);\n    if (divisor !== undefined) {\n        gl2.vertexAttribDivisor(index, divisor);\n    }\n}\n\n/**\n * @param {number} index\n * @param {WebGLBuffer} buffer\n * @param {number} vertexSize\n * @param {GLenum} bufferType\n * @param {boolean} normalize\n * @param {number} stride\n * @param {number} offset\n * @param {number} divisor\n * @this {WebGLRenderingContextBase}\n */\nfunction attributeUintBuffer(index, buffer, vertexSize, bufferType, normalize = false, stride = 0, offset = 0, divisor = undefined) {\n    if (!isWebGL2Supported(this)) {\n        throw new Error('Cannot use attribute divisor in WebGL 1.');\n    }\n    const gl2 = /** @type {WebGL2RenderingContext} */ (this);\n    gl2.bindBuffer(gl2.ARRAY_BUFFER, buffer);\n    gl2.enableVertexAttribArray(index);\n    gl2.vertexAttribIPointer(index, vertexSize, bufferType, stride, offset);\n    if (divisor !== undefined) {\n        gl2.vertexAttribDivisor(index, divisor);\n    }\n}\n\n/**\n * @param {number} index\n * @param {WebGLBuffer} buffer\n * @param {number} vertexSize\n * @param {GLenum} bufferType\n * @param {boolean} normalize\n * @param {number} stride\n * @param {number} offset\n * @param {number} divisor\n * @this {WebGLRenderingContextBase}\n */\nfunction attributeFloatMat2Buffer(index, buffer, vertexSize, bufferType, normalize = false, stride = 0, offset = 0, divisor = undefined) {\n    // NOTE: Size along 1 dimension\n    let matrixSize = getAttribVertexSize(this, this.FLOAT_MAT2);\n    // NOTE: Assumes a square matrix.\n    let matrixLength = matrixSize * matrixSize;\n    attributeFloatMatrixBufferImpl(matrixLength, matrixSize, index, buffer, vertexSize, bufferType, normalize, stride, offset, divisor);\n}\n\n/**\n * @param {number} index\n * @param {WebGLBuffer} buffer\n * @param {number} vertexSize\n * @param {GLenum} bufferType\n * @param {boolean} normalize\n * @param {number} stride\n * @param {number} offset\n * @param {number} divisor\n * @this {WebGLRenderingContextBase}\n */\nfunction attributeFloatMat3Buffer(index, buffer, vertexSize, bufferType, normalize = false, stride = 0, offset = 0, divisor = undefined) {\n    // NOTE: Size along 1 dimension\n    let matrixSize = getAttribVertexSize(this, this.FLOAT_MAT3);\n    // NOTE: Assumes a square matrix.\n    let matrixLength = matrixSize * matrixSize;\n    attributeFloatMatrixBufferImpl(matrixLength, matrixSize, index, buffer, vertexSize, bufferType, normalize, stride, offset, divisor);\n}\n\n/**\n * @param {number} index\n * @param {WebGLBuffer} buffer\n * @param {number} vertexSize\n * @param {GLenum} bufferType\n * @param {boolean} normalize\n * @param {number} stride\n * @param {number} offset\n * @param {number} divisor\n * @this {WebGLRenderingContextBase}\n */\nfunction attributeFloatMat4Buffer(index, buffer, vertexSize, bufferType, normalize = false, stride = 0, offset = 0, divisor = undefined) {\n    // NOTE: Size along 1 dimension\n    let matrixSize = getAttribVertexSize(this, this.FLOAT_MAT4);\n    // NOTE: Assumes a square matrix.\n    let matrixLength = matrixSize * matrixSize;\n    attributeFloatMatrixBufferImpl(matrixLength, matrixSize, index, buffer, vertexSize, bufferType, normalize, stride, offset, divisor);\n}\n\n/**\n * @param {number} matrixLength\n * @param {number} matrixSize\n * @param {number} index\n * @param {WebGLBuffer} buffer\n * @param {number} vertexSize\n * @param {GLenum} bufferType\n * @param {boolean} normalize\n * @param {number} stride\n * @param {number} offset\n * @param {number} divisor\n * @this {WebGLRenderingContextBase}\n */\nfunction attributeFloatMatrixBufferImpl(matrixLength, matrixSize, index, buffer, vertexSize, bufferType, normalize, stride, offset, divisor) {\n    if (!isWebGL2Supported(this)) {\n        throw new Error('Cannot use attribute divisor in WebGL 1.');\n    }\n    const gl2 = /** @type {WebGL2RenderingContext} */ (this);\n    gl2.bindBuffer(gl2.ARRAY_BUFFER, buffer);\n    // Number of matrices in the buffer.\n    let matrixCount = vertexSize / matrixSize;\n    // The stride to each matrix\n    let matrixStride = matrixLength * vertexSize;\n    // The offset within each matrix data\n    let offsetPerMatrix = stride / matrixSize;\n    for(let i = 0; i < matrixSize; ++i) {\n        let ii = index + i;\n        gl2.enableVertexAttribArray(ii);\n        gl2.vertexAttribPointer(ii, matrixCount, bufferType, normalize, matrixStride, offset + offsetPerMatrix * i);\n        if (divisor !== undefined) {\n            gl2.vertexAttribDivisor(ii, divisor);\n        }\n    }\n}\n", "import { getActiveAttribs } from './helper/ProgramActives.js';\nimport { getAttributeFunction } from './ProgramAttributeFunctions.js';\nimport { getAttribVertexSize } from './ProgramAttributeHelper.js';\n\n/**\n * @typedef {import('./ProgramAttributeFunctions.js').AttributeFunction} AttributeFunction\n */\n\n/**\n * @typedef ActiveAttributeInfo\n * @property {GLenum} type\n * @property {number} length\n * @property {number} location\n * @property {number} size\n * @property {AttributeFunction} applier\n * @property {number|Float32List|Int32List|Uint32List} value\n */\n\n/**\n * Get map of all active attributes to their info in the shader program.\n *\n * @param {WebGLRenderingContextBase} gl The webgl context.\n * @param {WebGLProgram} program The program to get active attributes from.\n * @returns {Record<string, ActiveAttributeInfo>} An object mapping of attribute names to info.\n */\nexport function getActiveAttribsInfo(gl, program) {\n  /** @type {Record<string, ActiveAttributeInfo>} */\n  let result = {};\n  const activeAttributes = getActiveAttribs(gl, program);\n  for (let activeInfo of activeAttributes) {\n    const attributeName = activeInfo.name;\n    const attributeLength = activeInfo.size;\n    const attributeType = activeInfo.type;\n    const attributeLocation = gl.getAttribLocation(program, attributeName);\n    const attributeApplier = getAttributeFunction(gl, attributeType);\n    const attributeSize = getAttribVertexSize(gl, attributeType);\n    result[attributeName] = {\n      type: attributeType,\n      length: attributeLength,\n      location: attributeLocation,\n      size: attributeSize,\n      applier: attributeApplier,\n      set value([buffer, vertexSize, bufferType, normalize, stride, offset, divisor]) {\n        this.applier(this.location, buffer, vertexSize, bufferType, normalize, stride, offset, divisor);\n      }\n    };\n  }\n  return result;\n}\n", "/**\n * Create and compile shader from source text.\n *\n * @param {WebGLRenderingContextBase} gl The webgl context.\n * @param {GLenum} shaderType The type of the shader. This is usually `gl.VERTEX_SHADER`\n * or `gl.FRAGMENT_SHADER`.\n * @param {string} shaderSource The shader source text.\n * @returns {WebGLShader} The compiled shader.\n */\nexport function createShader(gl, shaderType, shaderSource) {\n    let shader = gl.createShader(shaderType);\n    gl.shaderSource(shader, shaderSource);\n    gl.compileShader(shader);\n\n    let status = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\n    if (!status) {\n        let log = gl.getShaderInfoLog(shader) +\n            `\\nFailed to compile shader:\\n${shaderSource}`;\n        gl.deleteShader(shader);\n        throw new Error(log);\n    }\n    return shader;\n}\n\n/**\n * Link the given shader program from list of compiled shaders.\n *\n * @param {WebGLRenderingContextBase} gl The webgl context.\n * @param {WebGLProgram} program The shader program handle.\n * @param {Array<WebGLShader>} shaders The list of compiled shaders\n * to link in the program.\n * @returns {Promise<WebGLProgram>} The linked shader program.\n */\nexport async function createShaderProgram(gl, program, shaders) {\n    // Attach to the program.\n    for (let shader of shaders) {\n        gl.attachShader(program, shader);\n    }\n\n    // Link'em!\n    gl.linkProgram(program);\n\n    // Might be async...\n    const ext = gl.getExtension('KHR_parallel_shader_compile');\n    if (ext) {\n        const statusInterval = 1000 / 60;\n        let result;\n        do {\n            await new Promise((resolve, _) => setTimeout(resolve, statusInterval));\n            result = gl.getProgramParameter(program, ext.COMPLETION_STATUS_KHR);\n        } while (!result);\n    }\n\n    // Don't forget to clean up the shaders! It's no longer needed.\n    for (let shader of shaders) {\n        gl.detachShader(program, shader);\n        gl.deleteShader(shader);\n    }\n\n    let status = gl.getProgramParameter(program, gl.LINK_STATUS);\n    if (!status) {\n        let log = gl.getProgramInfoLog(program);\n        gl.deleteProgram(program);\n        throw new Error(log);\n    }\n    return program;\n}\n\n/**\n * Draw the currently bound render context.\n *\n * @param {WebGLRenderingContextBase} gl\n * @param {number} mode\n * @param {number} offset\n * @param {number} count\n * @param {WebGLBuffer} [elementBuffer]\n */\nexport function draw(gl, mode, offset, count, elementBuffer = undefined) {\n    if (elementBuffer) {\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, elementBuffer);\n        gl.drawElements(mode, count, gl.UNSIGNED_SHORT, offset);\n    } else {\n        gl.drawArrays(mode, offset, count);\n    }\n}\n\n/**\n * @param {WebGLRenderingContext|WebGL2RenderingContext} gl\n * @param {WebGLProgram} program\n */\nexport function getProgramStatus(gl, program) {\n    return {\n        /** @type {GLboolean} */\n        linkStatus: gl.getProgramParameter(program, gl.LINK_STATUS),\n        /** @type {GLboolean} */\n        deleteStatus: gl.getProgramParameter(program, gl.DELETE_STATUS),\n        /** @type {GLboolean} */\n        validateStatus: gl.getProgramParameter(program, gl.VALIDATE_STATUS),\n        /** @type {string} */\n        infoLog: gl.getProgramInfoLog(program),\n    };\n}\n", "import { isWebGL2Supported } from '../GLHelper.js';\n\n/**\n * @callback UniformArrayFunction\n * @param {WebGLUniformLocation} location The uniform location.\n * @param {Float32List|Int32List|Uint32List} value The vector array.\n * @this {WebGLRenderingContext|WebGL2RenderingContext}\n *\n * @callback UniformComponentFunction\n * @param {WebGLUniformLocation} location The uniform location.\n * @param {...number} values The components of the vector.\n * @this {WebGLRenderingContext|WebGL2RenderingContext}\n *\n * @typedef {UniformArrayFunction|UniformComponentFunction} UniformFunction\n */\n\n/**\n * Gets the uniform modifier function by uniform type. For uniform vectors\n * of size 1, it accepts a single number value. For vectors of greater\n * size, it takes an array of numbers.\n *\n * @param {WebGLRenderingContextBase} gl The webgl context.\n * @param {GLenum} uniformType The uniform data type.\n * @returns {UniformFunction} The uniform modifier function.\n */\nexport function getUniformFunction(gl, uniformType) {\n  // https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Constants\n  const gl1 = /** @type {WebGLRenderingContext} */ (gl);\n  switch (uniformType) {\n    // WebGL1\n    case gl1.FLOAT:\n      return gl1.uniform1f;\n    case gl1.FLOAT_VEC2:\n      return gl1.uniform2fv;\n    case gl1.FLOAT_VEC3:\n      return gl1.uniform3fv;\n    case gl1.FLOAT_VEC4:\n      return gl1.uniform4fv;\n    case gl1.INT:\n      return gl1.uniform1i;\n    case gl1.INT_VEC2:\n      return gl1.uniform2iv;\n    case gl1.INT_VEC3:\n      return gl1.uniform3iv;\n    case gl1.INT_VEC4:\n      return gl1.uniform4iv;\n    case gl1.BOOL:\n      return gl1.uniform1i;\n    case gl1.BOOL_VEC2:\n      return gl1.uniform2iv;\n    case gl1.BOOL_VEC3:\n      return gl1.uniform3iv;\n    case gl1.BOOL_VEC4:\n      return gl1.uniform4iv;\n    case gl1.FLOAT_MAT2:\n      return uniformMatrix2fv;\n    case gl1.FLOAT_MAT3:\n      return uniformMatrix3fv;\n    case gl1.FLOAT_MAT4:\n      return uniformMatrix4fv;\n    // WeblGL1 Samplers\n    case gl1.SAMPLER_2D:\n    case gl1.SAMPLER_CUBE:\n      return gl1.uniform1i;\n  }\n\n  if (isWebGL2Supported(gl)) {\n    const gl2 = /** @type {WebGL2RenderingContext} */ (gl);\n    switch (uniformType) {\n      // WebGL2\n      case gl2.UNSIGNED_INT:\n        return gl2.uniform1ui;\n      case gl2.UNSIGNED_INT_VEC2:\n        return gl2.uniform2uiv;\n      case gl2.UNSIGNED_INT_VEC3:\n        return gl2.uniform3uiv;\n      case gl2.UNSIGNED_INT_VEC4:\n        return gl2.uniform4uiv;\n      case gl2.FLOAT_MAT2x3:\n        return uniformMatrix2x3fv;\n      case gl2.FLOAT_MAT2x4:\n        return uniformMatrix2x4fv;\n      case gl2.FLOAT_MAT3x2:\n        return uniformMatrix3x2fv;\n      case gl2.FLOAT_MAT3x4:\n        return uniformMatrix3x4fv;\n      case gl2.FLOAT_MAT4x2:\n        return uniformMatrix4x2fv;\n      case gl2.FLOAT_MAT4x3:\n        return uniformMatrix4x3fv;\n      // WeblGL2 Samplers\n      case gl2.SAMPLER_3D:\n      case gl2.SAMPLER_2D_SHADOW:\n      case gl2.SAMPLER_2D_ARRAY:\n      case gl2.SAMPLER_2D_ARRAY_SHADOW:\n      case gl2.SAMPLER_CUBE_SHADOW:\n      case gl2.INT_SAMPLER_2D:\n      case gl2.INT_SAMPLER_3D:\n      case gl2.INT_SAMPLER_CUBE:\n      case gl2.INT_SAMPLER_2D_ARRAY:\n      case gl2.UNSIGNED_INT_SAMPLER_2D:\n      case gl2.UNSIGNED_INT_SAMPLER_3D:\n      case gl2.UNSIGNED_INT_SAMPLER_CUBE:\n      case gl2.UNSIGNED_INT_SAMPLER_2D_ARRAY:\n        return gl2.uniform1i;\n    }\n  }\n\n  throw new Error('Cannot find uniform function for gl enum.');\n}\n\n/**\n * Get the per component uniform modifier function by uniform type.\n *\n * @param {WebGLRenderingContext|WebGL2RenderingContext} gl The webgl context.\n * @param {GLenum} uniformType The uniform data type.\n * @returns {UniformComponentFunction} The per component uniform modifier function.\n */\nexport function getUniformComponentFunction(gl, uniformType) {\n  // https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Constants\n  const gl1 = /** @type {WebGLRenderingContext} */ (gl);\n  switch (uniformType) {\n    // WebGL1\n    case gl1.FLOAT:\n      return gl1.uniform1f;\n    case gl1.FLOAT_VEC2:\n      return gl1.uniform2f;\n    case gl1.FLOAT_VEC3:\n      return gl1.uniform3f;\n    case gl1.FLOAT_VEC4:\n      return gl1.uniform4f;\n    case gl1.INT:\n      return gl1.uniform1i;\n    case gl1.INT_VEC2:\n      return gl1.uniform2i;\n    case gl1.INT_VEC3:\n      return gl1.uniform3i;\n    case gl1.INT_VEC4:\n      return gl1.uniform4i;\n    case gl1.BOOL:\n      return gl1.uniform1i;\n    case gl1.BOOL_VEC2:\n      return gl1.uniform2i;\n    case gl1.BOOL_VEC3:\n      return gl1.uniform3i;\n    case gl1.BOOL_VEC4:\n      return gl1.uniform4i;\n    case gl1.FLOAT_MAT2:\n      return uniformMatrix2f;\n    case gl1.FLOAT_MAT3:\n      return uniformMatrix3f;\n    case gl1.FLOAT_MAT4:\n      return uniformMatrix4f;\n    // WeblGL1 Samplers\n    case gl1.SAMPLER_2D:\n    case gl1.SAMPLER_CUBE:\n      return gl1.uniform1i;\n  }\n\n  if (isWebGL2Supported(gl)) {\n    const gl2 = /** @type {WebGL2RenderingContext} */ (gl);\n    switch (uniformType) {\n      // WebGL2\n      case gl2.UNSIGNED_INT:\n        return gl2.uniform1ui;\n      case gl2.UNSIGNED_INT_VEC2:\n        return gl2.uniform2ui;\n      case gl2.UNSIGNED_INT_VEC3:\n        return gl2.uniform3ui;\n      case gl2.UNSIGNED_INT_VEC4:\n        return gl2.uniform4ui;\n      case gl2.FLOAT_MAT2x3:\n        return uniformMatrix2x3f;\n      case gl2.FLOAT_MAT2x4:\n        return uniformMatrix2x4f;\n      case gl2.FLOAT_MAT3x2:\n        return uniformMatrix3x2f;\n      case gl2.FLOAT_MAT3x4:\n        return uniformMatrix3x4f;\n      case gl2.FLOAT_MAT4x2:\n        return uniformMatrix4x2f;\n      case gl2.FLOAT_MAT4x3:\n        return uniformMatrix4x3f;\n      // WeblGL2 Samplers\n      case gl2.SAMPLER_3D:\n      case gl2.SAMPLER_2D_SHADOW:\n      case gl2.SAMPLER_2D_ARRAY:\n      case gl2.SAMPLER_2D_ARRAY_SHADOW:\n      case gl2.SAMPLER_CUBE_SHADOW:\n      case gl2.INT_SAMPLER_2D:\n      case gl2.INT_SAMPLER_3D:\n      case gl2.INT_SAMPLER_CUBE:\n      case gl2.INT_SAMPLER_2D_ARRAY:\n      case gl2.UNSIGNED_INT_SAMPLER_2D:\n      case gl2.UNSIGNED_INT_SAMPLER_3D:\n      case gl2.UNSIGNED_INT_SAMPLER_CUBE:\n      case gl2.UNSIGNED_INT_SAMPLER_2D_ARRAY:\n        return gl2.uniform1i;\n    }\n  }\n\n  throw new Error('Cannot find per component uniform function for gl enum.');\n}\n\n/**\n * Get the array uniform modifier function by uniform type.\n *\n * @param {WebGLRenderingContext|WebGL2RenderingContext} gl The webgl context.\n * @param {GLenum} uniformType The uniform data type.\n * @returns {UniformArrayFunction} The array uniform modifier function.\n */\nexport function getUniformArrayFunction(gl, uniformType) {\n  // https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Constants\n  const gl1 = /** @type {WebGLRenderingContext} */ (gl);\n  switch (uniformType) {\n    // WebGL1\n    case gl1.FLOAT:\n      return gl1.uniform1fv;\n    case gl1.FLOAT_VEC2:\n      return gl1.uniform2fv;\n    case gl1.FLOAT_VEC3:\n      return gl1.uniform3fv;\n    case gl1.FLOAT_VEC4:\n      return gl1.uniform4fv;\n    case gl1.INT:\n      return gl1.uniform1iv;\n    case gl1.INT_VEC2:\n      return gl1.uniform2iv;\n    case gl1.INT_VEC3:\n      return gl1.uniform3iv;\n    case gl1.INT_VEC4:\n      return gl1.uniform4iv;\n    case gl1.BOOL:\n      return gl1.uniform1iv;\n    case gl1.BOOL_VEC2:\n      return gl1.uniform2iv;\n    case gl1.BOOL_VEC3:\n      return gl1.uniform3iv;\n    case gl1.BOOL_VEC4:\n      return gl1.uniform4iv;\n    case gl1.FLOAT_MAT2:\n      return uniformMatrix2fv;\n    case gl1.FLOAT_MAT3:\n      return uniformMatrix3fv;\n    case gl1.FLOAT_MAT4:\n      return uniformMatrix4fv;\n    case gl1.SAMPLER_2D:\n    case gl1.SAMPLER_CUBE:\n      return gl1.uniform1iv;\n  }\n\n  if (isWebGL2Supported(gl)) {\n    const gl2 = /** @type {WebGL2RenderingContext} */ (gl);\n    switch (uniformType) {\n      // WebGL2\n      case gl2.UNSIGNED_INT:\n        return gl2.uniform1uiv;\n      case gl2.UNSIGNED_INT_VEC2:\n        return gl2.uniform2uiv;\n      case gl2.UNSIGNED_INT_VEC3:\n        return gl2.uniform3uiv;\n      case gl2.UNSIGNED_INT_VEC4:\n        return gl2.uniform4uiv;\n      case gl2.FLOAT_MAT2x3:\n        return uniformMatrix2x3fv;\n      case gl2.FLOAT_MAT2x4:\n        return uniformMatrix2x4fv;\n      case gl2.FLOAT_MAT3x2:\n        return uniformMatrix3x2fv;\n      case gl2.FLOAT_MAT3x4:\n        return uniformMatrix3x4fv;\n      case gl2.FLOAT_MAT4x2:\n        return uniformMatrix4x2fv;\n      case gl2.FLOAT_MAT4x3:\n        return uniformMatrix4x3fv;\n      // WebGL2 Samplers\n      case gl2.SAMPLER_3D:\n      case gl2.SAMPLER_2D_SHADOW:\n      case gl2.SAMPLER_2D_ARRAY:\n      case gl2.SAMPLER_2D_ARRAY_SHADOW:\n      case gl2.SAMPLER_CUBE_SHADOW:\n      case gl2.INT_SAMPLER_2D:\n      case gl2.INT_SAMPLER_3D:\n      case gl2.INT_SAMPLER_CUBE:\n      case gl2.INT_SAMPLER_2D_ARRAY:\n      case gl2.UNSIGNED_INT_SAMPLER_2D:\n      case gl2.UNSIGNED_INT_SAMPLER_3D:\n      case gl2.UNSIGNED_INT_SAMPLER_CUBE:\n      case gl2.UNSIGNED_INT_SAMPLER_2D_ARRAY:\n        return gl2.uniform1iv;\n    }\n  }\n\n  throw new Error('Cannot find array uniform function for gl enum.');\n}\n\nfunction uniformMatrix2fv(location, value) {\n  this.uniformMatrix2fv(location, false, value);\n}\n\nfunction uniformMatrix2f(location, m00, m01, m10, m11) {\n  this.uniformMatrix2fv(location, false, [m00, m01, m10, m11]);\n}\n\nfunction uniformMatrix3fv(location, value) {\n  this.uniformMatrix3fv(location, false, value);\n}\n\nfunction uniformMatrix3f(\n  location,\n  m00,\n  m01,\n  m02,\n  m10,\n  m11,\n  m12,\n  m20,\n  m21,\n  m22\n) {\n  this.uniformMatrix3fv(location, false, [\n    m00,\n    m01,\n    m02,\n    m10,\n    m11,\n    m12,\n    m20,\n    m21,\n    m22,\n  ]);\n}\n\nfunction uniformMatrix4fv(location, value) {\n  this.uniformMatrix4fv(location, false, value);\n}\n\nfunction uniformMatrix4f(\n  location,\n  m00,\n  m01,\n  m02,\n  m03,\n  m10,\n  m11,\n  m12,\n  m13,\n  m20,\n  m21,\n  m22,\n  m23,\n  m30,\n  m31,\n  m32,\n  m33\n) {\n  this.uniformMatrix4fv(location, false, [\n    m00,\n    m01,\n    m02,\n    m03,\n    m10,\n    m11,\n    m12,\n    m13,\n    m20,\n    m21,\n    m22,\n    m23,\n    m30,\n    m31,\n    m32,\n    m33,\n  ]);\n}\n\nfunction uniformMatrix2x3fv(location, value) {\n  this.uniformMatrix2x3fv(location, false, value);\n}\n\nfunction uniformMatrix2x3f(location, m00, m01, m02, m10, m11, m12) {\n  this.uniformMatrix2x3fv(location, false, [m00, m01, m02, m10, m11, m12]);\n}\n\nfunction uniformMatrix2x4fv(location, value) {\n  this.uniformMatrix2x4fv(location, false, value);\n}\n\nfunction uniformMatrix2x4f(location, m00, m01, m02, m03, m10, m11, m12, m13) {\n  this.uniformMatrix2x4fv(location, false, [\n    m00,\n    m01,\n    m02,\n    m03,\n    m10,\n    m11,\n    m12,\n    m13,\n  ]);\n}\n\nfunction uniformMatrix3x2fv(location, value) {\n  this.uniformMatrix3x2fv(location, false, value);\n}\n\nfunction uniformMatrix3x2f(location, m00, m01, m10, m11, m20, m21) {\n  this.uniformMatrix3x2fv(location, false, [m00, m01, m10, m11, m20, m21]);\n}\n\nfunction uniformMatrix3x4fv(location, value) {\n  this.uniformMatrix3x4fv(location, false, value);\n}\n\nfunction uniformMatrix3x4f(\n  location,\n  m00,\n  m01,\n  m02,\n  m03,\n  m10,\n  m11,\n  m12,\n  m13,\n  m20,\n  m21,\n  m22,\n  m23\n) {\n  this.uniformMatrix3x4fv(location, false, [\n    m00,\n    m01,\n    m02,\n    m03,\n    m10,\n    m11,\n    m12,\n    m13,\n    m20,\n    m21,\n    m22,\n    m23,\n  ]);\n}\n\nfunction uniformMatrix4x2fv(location, value) {\n  this.uniformMatrix4x2fv(location, false, value);\n}\n\nfunction uniformMatrix4x2f(location, m00, m01, m10, m11, m20, m21, m30, m31) {\n  this.uniformMatrix4x2fv(location, false, [\n    m00,\n    m01,\n    m10,\n    m11,\n    m20,\n    m21,\n    m30,\n    m31,\n  ]);\n}\n\nfunction uniformMatrix4x3fv(location, value) {\n  this.uniformMatrix4x3fv(location, false, value);\n}\n\nfunction uniformMatrix4x3f(\n  location,\n  m00,\n  m01,\n  m02,\n  m10,\n  m11,\n  m12,\n  m20,\n  m21,\n  m22,\n  m30,\n  m31,\n  m32\n) {\n  this.uniformMatrix4x3fv(location, false, [\n    m00,\n    m01,\n    m02,\n    m10,\n    m11,\n    m12,\n    m20,\n    m21,\n    m22,\n    m30,\n    m31,\n    m32,\n  ]);\n}\n", "import { getUniformFunction } from './ProgramUniformFunctions.js';\nimport { getActiveUniforms } from './helper/ProgramActives.js';\n\n/**\n * @typedef {import('./ProgramUniformFunctions').UniformFunction} UniformFunction\n */\n\n/**\n * @typedef ActiveUniformInfo\n * @property {number} type\n * @property {number} length\n * @property {WebGLUniformLocation} location\n * @property {UniformFunction} applier\n * @property {number|Float32List|Int32List|Uint32List} value\n */\n\n/**\n * Get map of all active uniforms to their info in the shader program.\n *\n * @param {WebGLRenderingContextBase} gl The webgl context.\n * @param {WebGLProgram} program The program to get active uniforms from.\n * @returns {Record<string, ActiveUniformInfo>} An object mapping of uniform names to info.\n */\nexport function getActiveUniformsInfo(gl, program) {\n  /** @type {Record<string, ActiveUniformInfo>} */\n  let result = {};\n  const activeUniforms = getActiveUniforms(gl, program);\n  for (let activeInfo of activeUniforms) {\n    const uniformName = activeInfo.name;\n    const uniformSize = activeInfo.size;\n    const uniformType = activeInfo.type;\n    const uniformLocation = gl.getUniformLocation(program, uniformName);\n    const uniformApplier = getUniformFunction(gl, uniformType);\n    result[uniformName] = {\n      type: uniformType,\n      length: uniformSize,\n      location: uniformLocation,\n      applier: uniformApplier,\n      set value(value) {\n        this.applier.call(gl, this.location, value);\n      }\n    };\n  }\n  return result;\n}\n", "import { isWebGL2Supported } from '../../GLHelper.js';\nimport { getActiveAttribsInfo } from '../ProgramAttributeInfo.js';\nimport { createShader, createShaderProgram } from './ProgramHelper.js';\nimport { getActiveUniformsInfo } from '../ProgramUniformInfo.js';\n\n/**\n * @typedef {import('../../buffer/helper/BufferInfoHelper').BufferInfo} BufferInfo\n * @typedef {import('../../buffer/helper/BufferInfoHelper').VertexArrayObjectInfo} VertexArrayObjectInfo\n */\n\n/**\n * @typedef ProgramInfo\n * @property {WebGLProgram} handle\n * @property {Record<string, import('../ProgramUniformInfo.js').ActiveUniformInfo>} uniforms\n * @property {Record<string, import('../ProgramAttributeInfo.js').ActiveAttributeInfo>} attributes\n */\n\n/**\n * Assumes all shaders already compiled and linked successfully.\n * \n * @param {WebGLRenderingContextBase} gl \n * @param {WebGLProgram} program\n * @returns {ProgramInfo}\n */\nexport function createProgramInfo(gl, program) {\n    return {\n        handle: program,\n        attributes: getActiveAttribsInfo(gl, program),\n        uniforms: getActiveUniformsInfo(gl, program),\n    };\n}\n\n/**\n * @param {WebGLRenderingContextBase} gl \n * @param {WebGLProgram} program\n * @param {Array<string>} shaderSources\n * @param {Array<GLenum>} [shaderTypes]\n * @returns {Promise<WebGLProgram>}\n */\nexport async function linkProgramShaders(gl, program, shaderSources, shaderTypes = [gl.VERTEX_SHADER, gl.FRAGMENT_SHADER]) {\n    let index = 0;\n    let shaders = [];\n    for(let shaderSource of shaderSources) {\n        if (index >= shaderTypes.length) {\n            throw new Error('Missing shader type for shader source.');\n        }\n        let shaderType = shaderTypes[index++];\n        let shader = createShader(gl, shaderType, shaderSource);\n        shaders.push(shader);\n    }\n    await createShaderProgram(gl, program, shaders);\n    return program;\n}\n\n/**\n * @param {WebGLRenderingContextBase} gl \n * @param {ReturnType<createProgramInfo>} programInfo \n * @param {BufferInfo|VertexArrayObjectInfo} bufferOrVertexArrayObjectInfo \n */\nexport function bindProgramAttributes(gl, programInfo, bufferOrVertexArrayObjectInfo) {\n    if ('handle' in bufferOrVertexArrayObjectInfo && bufferOrVertexArrayObjectInfo.handle instanceof WebGLVertexArrayObject) {\n        if (!isWebGL2Supported(gl)) {\n            throw new Error('Vertex array objects are only supported in WebGL 2.');\n        }\n        const gl2 = /** @type {WebGL2RenderingContext} */ (gl);\n        let vaoInfo = /** @type {VertexArrayObjectInfo} */ (bufferOrVertexArrayObjectInfo);\n        gl2.bindVertexArray(vaoInfo.handle);\n    } else {\n        let bufferInfo = /** @type {BufferInfo} */ (bufferOrVertexArrayObjectInfo);\n        let attributeInfos = programInfo.attributes;\n        for(let name in attributeInfos) {\n            if (!(name in bufferInfo.attributes)) {\n                throw new Error(`Missing buffer for attribute '${name}'.`);\n            }\n            let attrib = bufferInfo.attributes[name];\n            let { location, applier } = attributeInfos[attrib.name];\n            applier.call(gl, location, attrib.buffer, attrib.size, attrib.type, attrib.normalize, attrib.stride, attrib.offset, attrib.divisor);\n        }\n        if (bufferInfo.element) {\n            gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, bufferInfo.element.buffer);\n        }\n    }\n}\n\n/**\n * @param {WebGLRenderingContextBase} gl \n * @param {ReturnType<createProgramInfo>} programInfo \n * @param {Record<string, number|Float32List|Int32List|Uint32List>} uniforms\n */\nexport function bindProgramUniforms(gl, programInfo, uniforms) {\n    let uniformInfos = programInfo.uniforms;\n    for(let name in uniforms) {\n        let value = uniforms[name];\n        let { location, applier } = uniformInfos[name];\n        applier.call(gl, location, value);\n    }\n}\n", "import { isWebGL2Supported } from '../../GLHelper.js';\nimport { bindProgramAttributes } from '../../program/helper/ProgramInfoHelper.js';\nimport { getBufferTypeForBufferSource, getByteCountForBufferType, getTypedArrayForBufferType } from './BufferHelper.js';\n\n/**\n * @typedef {WebGLBuffer|BufferSource|Array<number>} AttribBufferLike\n * \n * @typedef ArrayAttribOption\n * @property {AttribBufferLike} buffer\n * @property {string} [name]\n * @property {number} [size]\n * @property {GLenum} [type]\n * @property {boolean} [normalize]\n * @property {number} [stride]\n * @property {number} [offset]\n * @property {number} [divisor]\n * @property {GLenum} [usage]\n * @property {number} [length]\n * \n * @typedef ElementAttribOption\n * @property {AttribBufferLike} buffer\n * @property {GLenum} [type]\n * @property {GLenum} [usage]\n * @property {number} [length]\n * \n * @typedef {ReturnType<createArrayAttrib>} ArrayAttrib\n * @typedef {ReturnType<createElementAttrib>} ElementAttrib\n * \n * @typedef BufferInfo\n * @property {Record<string, ArrayAttrib>} attributes\n * @property {number} vertexCount\n * @property {ElementAttrib} element\n * \n * @typedef VertexArrayObjectInfo\n * @property {WebGLVertexArrayObject} handle\n * @property {number} vertexCount\n * @property {ElementAttrib} element\n */\n\n/**\n * @param {WebGLRenderingContextBase} gl \n * @param {Record<string, ArrayAttribOption>} arrays \n * @param {ElementAttribOption} [elementArray]\n * @returns {BufferInfo}\n */\nexport function createBufferInfo(gl, arrays, elementArray = undefined) {\n    let attributes = createVertexAttributesInfo(/** @type {WebGLRenderingContext|WebGL2RenderingContext} */ (gl), arrays);\n    let element = createElementAttributeInfo(/** @type {WebGLRenderingContext|WebGL2RenderingContext} */ (gl), elementArray);\n    let vertexCount;\n    if (element) {\n        vertexCount = element.length;\n    } else {\n        let names = Object.keys(attributes);\n        if (names.length > 0) {\n            let a = attributes[names[0]];\n            vertexCount = Math.trunc(a.length / a.size);\n        } else {\n            vertexCount = 0;\n        }\n    }\n    return {\n        attributes,\n        element,\n        vertexCount,\n    };\n}\n\n/**\n * @param {WebGLRenderingContextBase} gl \n * @param {BufferInfo} bufferInfo \n * @param {Array<import('../../program/helper/ProgramInfoHelper.js').ProgramInfo>} programInfos\n * @returns {VertexArrayObjectInfo}\n */\nexport function createVertexArrayInfo(gl, bufferInfo, programInfos) {\n    if (!isWebGL2Supported(gl)) {\n        throw new Error('Vertex array objects is only supported on WebGL2.');\n    }\n    const gl2 = /** @type {WebGL2RenderingContext} */ (gl);\n    let vao = gl2.createVertexArray();\n    gl2.bindVertexArray(vao);\n    for(let programInfo of programInfos) {\n        bindProgramAttributes(gl2, programInfo, bufferInfo);\n    }\n    gl2.bindVertexArray(null);\n    return {\n        handle: vao,\n        element: bufferInfo.element,\n        vertexCount: bufferInfo.vertexCount,\n    };\n}\n\n/**\n * @param {WebGLRenderingContextBase} gl \n * @param {BufferInfo|VertexArrayObjectInfo} bufferOrVertexArrayObjectInfo \n */\nexport function drawBufferInfo(gl, bufferOrVertexArrayObjectInfo, mode = gl.TRIANGLES, offset = 0, vertexCount = bufferOrVertexArrayObjectInfo.vertexCount, instanceCount = undefined) {\n    let element = bufferOrVertexArrayObjectInfo.element;\n    if (element) {\n        let elementType = element.type;\n        if (instanceCount !== undefined) {\n            if (!isWebGL2Supported(gl)) {\n                throw new Error('Instanced element drawing is only supported on WebGL2.');\n            }\n            const gl2 = /** @type {WebGL2RenderingContext} */ (gl);\n            gl2.drawElementsInstanced(mode, vertexCount, elementType, offset, instanceCount);\n        } else {\n            gl.drawElements(mode, vertexCount, elementType, offset);\n        }\n    } else {\n        if (instanceCount !== undefined) {\n            if (!isWebGL2Supported(gl)) {\n                throw new Error('Instanced array drawing is only supported on WebGL2.');\n            }\n            const gl2 = /** @type {WebGL2RenderingContext} */ (gl);\n            gl2.drawArraysInstanced(mode, offset, vertexCount, instanceCount);\n        } else {\n            gl.drawArrays(mode, offset, vertexCount);\n        }\n    }\n}\n\n/**\n * @param {WebGLRenderingContext|WebGL2RenderingContext} gl \n * @param {ElementAttribOption} elementArray \n * @returns {ElementAttrib}\n */\nfunction createElementAttributeInfo(gl, elementArray = undefined) {\n    if (!elementArray) {\n        return null;\n    }\n    if (typeof elementArray !== 'object') {\n        throw new Error('Element attribute options must be an object.');\n    }\n    let {\n        type = gl.UNSIGNED_SHORT,\n        buffer,\n        usage = gl.STATIC_DRAW,\n        length,\n    } = /** @type {ElementAttribOption} */ (elementArray);\n\n    // Resolve buffer.\n    if (buffer instanceof WebGLBuffer) {\n        // Do nothing :)\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, buffer);\n    } else if (ArrayBuffer.isView(buffer)) {\n        /** @type {BufferSource} */\n        let srcData = buffer;\n        buffer = gl.createBuffer();\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, buffer);\n        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, srcData, usage);\n        if (type === undefined) {\n            type = getBufferTypeForBufferSource(gl, srcData);\n        }\n        if (length === undefined) {\n            // @ts-ignore\n            length = srcData.length;\n        }\n    } else if (Array.isArray(buffer)) {\n        /** @type {Array<number>} */\n        let array = buffer;\n        buffer = gl.createBuffer();\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, buffer);\n        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(array), usage);\n        if (length === undefined) {\n            length = array.length;\n        }\n    } else if (typeof buffer === 'number') {\n        let size = buffer;\n        buffer = gl.createBuffer();\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, buffer);\n        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, size, usage);\n        if (length === undefined) {\n            length = size;\n        }\n    } else {\n        throw new Error('Invalid buffer for element attribute options.');\n    }\n\n    // Resolve type.\n    if (type === undefined) {\n        type = gl.UNSIGNED_SHORT;\n    }\n\n    // Resolve length.\n    if (length === undefined) {\n        let bytes = gl.getBufferParameter(gl.ELEMENT_ARRAY_BUFFER, gl.BUFFER_SIZE);\n        length = Math.trunc(bytes / getByteCountForBufferType(gl, type));\n    }\n\n    return createElementAttrib(buffer, type, length);\n}\n\n/**\n * @param {WebGLRenderingContext|WebGL2RenderingContext} gl \n * @param {Record<string, ArrayAttribOption>} arrays\n * @returns {Record<string, ArrayAttrib>}\n */\nfunction createVertexAttributesInfo(gl, arrays) {\n    /** @type {Record<string, ArrayAttrib>} */\n    let result = {};\n    for(let key of Object.keys(arrays)) {\n        let array = arrays[key];\n        if (!array) {\n            continue;\n        }\n        if (typeof array !== 'object') {\n            throw new Error('Array attribute options must be an object.');\n        }\n        let {\n            name = key,\n            buffer,\n            size = 3,\n            type,\n            normalize = false,\n            stride = 0,\n            offset = 0,\n            divisor = undefined,\n            usage = gl.STATIC_DRAW,\n            length,\n        } = /** @type {ArrayAttribOption} */ (array);\n\n        // Resolve buffer.\n        if (buffer instanceof WebGLBuffer) {\n            // Do nothing :)\n            gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n        } else if (ArrayBuffer.isView(buffer)) {\n            /** @type {BufferSource} */\n            let srcData = buffer;\n            buffer = gl.createBuffer();\n            gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n            gl.bufferData(gl.ARRAY_BUFFER, srcData, usage);\n            if (type === undefined) {\n                type = getBufferTypeForBufferSource(gl, srcData);\n            }\n            if (length === undefined) {\n                // @ts-ignore\n                length = srcData.length;\n            }\n        } else if (Array.isArray(buffer)) {\n            /** @type {Array<number>} */\n            let array = buffer;\n            if (type === undefined) {\n                type = gl.FLOAT;\n            }\n            if (length === undefined) {\n                length = array.length;\n            }\n            buffer = gl.createBuffer();\n            gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n            let TypedArray = getTypedArrayForBufferType(gl, type);\n            gl.bufferData(gl.ARRAY_BUFFER, new TypedArray(array), usage);\n        } else if (typeof buffer === 'number') {\n            let size = buffer;\n            buffer = gl.createBuffer();\n            gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n            gl.bufferData(gl.ARRAY_BUFFER, size, usage);\n            if (length === undefined) {\n                length = size;\n            }\n        } else {\n            throw new Error(`Invalid buffer '${buffer}' for array attribute options.`);\n        }\n\n        // Resolve type.\n        if (type === undefined) {\n            type = gl.FLOAT;\n        }\n\n        // Resolve length.\n        if (length === undefined) {\n            let bytes = gl.getBufferParameter(gl.ARRAY_BUFFER, gl.BUFFER_SIZE);\n            length = Math.trunc(bytes / getByteCountForBufferType(gl, type));\n        }\n\n        // Resolve size.\n        if (size === undefined) {\n            size = tryVertexSize(name, length);\n        }\n        \n        result[name] = createArrayAttrib(name, buffer, length, size, type, normalize, stride, offset, divisor);\n    }\n    return result;\n}\n\n/**\n * @param {string} attribName \n * @param {number} arrayLength \n */\nfunction tryVertexSize(attribName, arrayLength) {\n    let result;\n    if (attribName.includes('texcoord')) {\n        result = 2;\n    } else if (attribName.includes('color')) {\n        result = 4;\n    } else {\n        result = 3;\n    }\n    if (arrayLength % result !== 0) {\n        throw new Error(`Could not determine vertex size - guessed ${result} but array length ${arrayLength} is not evenly divisible.`);\n    }\n    return result;\n}\n\n/**\n * @param {WebGLBuffer} buffer \n * @param {GLenum} type \n * @param {number} length\n */\nfunction createElementAttrib(buffer, type, length) {\n    return {\n        buffer,\n        type,\n        length,\n    };\n}\n\n/**\n * @param {string} name \n * @param {WebGLBuffer} buffer \n * @param {number} length\n * @param {number} size \n * @param {GLenum} type \n * @param {boolean} normalize\n * @param {number} stride\n * @param {number} offset\n * @param {number} divisor\n */\nfunction createArrayAttrib(name, buffer, length, size, type, normalize, stride, offset, divisor) {\n    return {\n        name,\n        buffer,\n        length,\n        size,\n        type,\n        normalize,\n        stride,\n        offset,\n        divisor,\n    };\n}\n", "import { getActiveUniformsInfo } from './ProgramUniformInfo.js';\nimport { getActiveAttribsInfo } from './ProgramAttributeInfo.js';\nimport { draw } from './helper/ProgramHelper.js';\n\nexport class ProgramInfo {\n  /**\n   * @param {WebGLRenderingContextBase} gl\n   * @param {WebGLProgram} program\n   */\n  constructor(gl, program) {\n    this.handle = program;\n\n    this.activeUniforms = getActiveUniformsInfo(gl, program);\n    this.activeAttributes = getActiveAttribsInfo(gl, program);\n\n    this.drawContext = new ProgramInfoDrawContext(gl, this);\n  }\n\n  /**\n   * Bind the program and prepare to draw. This returns the bound context\n   * that can modify the draw state.\n   *\n   * @param {WebGLRenderingContextBase} gl\n   * @returns {ProgramInfoDrawContext} The bound context to draw with.\n   */\n  bind(gl) {\n    gl.useProgram(this.handle);\n\n    this.drawContext.gl = gl;\n    return this.drawContext;\n  }\n}\n\nexport class ProgramInfoDrawContext {\n  constructor(gl, programInfo) {\n    this.gl = gl;\n    /** @private */\n    this.parent = programInfo;\n  }\n\n  uniform(uniformName, value) {\n    const activeUniforms = this.parent.activeUniforms;\n    if (uniformName in activeUniforms) {\n      let uniform = activeUniforms[uniformName];\n      let location = uniform.location;\n      uniform.applier.call(this.gl, location, value);\n    }\n    return this;\n  }\n\n  /**\n   * @param {string} attributeName Name of the attribute.\n   * @param {GLenum} bufferType The buffer data type. This is usually `gl.FLOAT`\n   * but can also be one of `gl.BYTE`, `gl.UNSIGNED_BYTE`, `gl.SHORT`, `gl.UNSIGNED_SHORT`\n   * or `gl.HALF_FLOAT` for WebGL2.\n   * @param {WebGLBuffer} buffer The buffer handle.\n   * @param {boolean} [normalize=false] Whether to normalize the vectors in the buffer.\n   * @param {number} [stride=0] The stride for each vector in the buffer.\n   * @param {number} [offset=0] The initial offset in the buffer.\n   */\n  attribute(\n    attributeName,\n    bufferType,\n    buffer,\n    normalize = false,\n    stride = 0,\n    offset = 0\n  ) {\n    const gl = this.gl;\n    const activeAttributes = this.parent.activeAttributes;\n    if (attributeName in activeAttributes) {\n      let attribute = activeAttributes[attributeName];\n      let location = attribute.location;\n      let size = attribute.size;\n      if (buffer) {\n        gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n        gl.vertexAttribPointer(\n          location,\n          size,\n          bufferType,\n          normalize,\n          stride,\n          offset\n        );\n        gl.enableVertexAttribArray(location);\n      } else {\n        gl.disableVertexAttribArray(location);\n      }\n    }\n    return this;\n  }\n\n  /**\n   * Draws using this program.\n   *\n   * @param {WebGLRenderingContext} gl\n   * @param {number} mode\n   * @param {number} offset\n   * @param {number} count\n   * @param {WebGLBuffer} elementBuffer\n   */\n  draw(gl, mode, offset, count, elementBuffer = null) {\n    draw(gl, mode, offset, count, elementBuffer);\n    return this.parent;\n  }\n}\n", "import { createShader, createShaderProgram } from './helper/ProgramHelper.js';\n\nexport class ProgramBuilder {\n  /**\n   * @param {WebGLRenderingContextBase} gl\n   * @param {WebGLProgram} [program]\n   */\n  constructor(gl, program = undefined) {\n    this.handle = program || gl.createProgram();\n    this.shaders = [];\n    /** @type {WebGLRenderingContextBase} */\n    this.gl = gl;\n  }\n\n  /**\n   * @param {GLenum} shaderType\n   * @param {string} shaderSource\n   * @returns {ProgramBuilder}\n   */\n  shader(shaderType, shaderSource) {\n    const gl = this.gl;\n    let shader = createShader(gl, shaderType, shaderSource);\n    this.shaders.push(shader);\n    return this;\n  }\n\n  /**\n   * @returns {WebGLProgram}\n   */\n  link() {\n    const gl = this.gl;\n    createShaderProgram(gl, this.handle, this.shaders);\n    this.shaders.length = 0;\n    return this.handle;\n  }\n}\n", "import { ProgramInfo } from './ProgramInfo.js';\nimport { ProgramBuilder } from './ProgramBuilder.js';\n\nexport class ProgramInfoBuilder {\n  /**\n   * @param {WebGLRenderingContextBase} gl\n   * @param {WebGLProgram} [program]\n   */\n  constructor(gl, program = undefined) {\n    /** @private */\n    this.programBuilder = new ProgramBuilder(gl, program);\n  }\n\n  get gl() {\n    return this.programBuilder.gl;\n  }\n\n  get handle() {\n    return this.programBuilder.handle;\n  }\n\n  get shaders() {\n    return this.programBuilder.shaders;\n  }\n\n  /**\n   * @param {GLenum} shaderType\n   * @param {string} shaderSource\n   * @returns {ProgramInfoBuilder}\n   */\n  shader(shaderType, shaderSource) {\n    this.programBuilder.shader(shaderType, shaderSource);\n    return this;\n  }\n\n  /**\n   * @returns {ProgramInfo}\n   */\n  link() {\n    const handle = this.programBuilder.link();\n    return new ProgramInfo(this.gl, handle);\n  }\n}\n", "// https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Constants\nexport const ProgramUniformEnums = {\n  // WebGL1\n  FLOAT: 0x1406,\n  FLOAT_VEC2: 0x8b50,\n  FLOAT_VEC3: 0x8b51,\n  FLOAT_VEC4: 0x8b52,\n  INT: 0x1404,\n  INT_VEC2: 0x8b53,\n  INT_VEC3: 0x8b54,\n  INT_VEC4: 0x8b55,\n  BOOL: 0x8b56,\n  BOOL_VEC2: 0x8b57,\n  BOOL_VEC3: 0x8b58,\n  BOOL_VEC4: 0x8b59,\n  FLOAT_MAT2: 0x8b5a,\n  FLOAT_MAT3: 0x8b5b,\n  FLOAT_MAT4: 0x8b5c,\n  SAMPLER_2D: 0x8b5e,\n  SAMPLER_CUBE: 0x8b60,\n  // WebGL2\n  UNSIGNED_INT: 0x1405,\n  UNSIGNED_INT_VEC2: 0x8dc6,\n  UNSIGNED_INT_VEC3: 0x8dc7,\n  UNSIGNED_INT_VEC4: 0x8dc8,\n  FLOAT_MAT2x3: 0x8b65,\n  FLOAT_MAT2x4: 0x8b66,\n  FLOAT_MAT3x2: 0x8b67,\n  FLOAT_MAT3x4: 0x8b68,\n  FLOAT_MAT4x2: 0x8b69,\n  FLOAT_MAT4x3: 0x8b6a,\n  SAMPLER_3D: 0x8b5f,\n  SAMPLER_2D_SHADOW: 0x8b62,\n  SAMPLER_2D_ARRAY: 0x8dc1,\n  SAMPLER_2D_ARRAY_SHADOW: 0x8dc4,\n  SAMPLER_CUBE_SHADOW: 0x8dc5,\n  INT_SAMPLER_2D: 0x8dca,\n  INT_SAMPLER_3D: 0x8dcb,\n  INT_SAMPLER_CUBE: 0x8dcc,\n  INT_SAMPLER_2D_ARRAY: 0x8dcf,\n  UNSIGNED_INT_SAMPLER_2D: 0x8dd2,\n  UNSIGNED_INT_SAMPLER_3D: 0x8dd3,\n  UNSIGNED_INT_SAMPLER_CUBE: 0x8dd4,\n  UNSIGNED_INT_SAMPLER_2D_ARRAY: 0x8dd7,\n};\n", "// https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/vertexAttribPointer\nexport const ProgramAttributeEnums = {\n  // WebGL1\n  BYTE: 0x1400,\n  UNSIGNED_BYTE: 0x1401,\n  SHORT: 0x1402,\n  UNSIGNED_SHORT: 0x1403,\n  FLOAT: 0x1406,\n  // WebGL2\n  HALF_FLOAT: 0x140b,\n};\n", "export const hex = {\n  red(hexValue) {\n    return (hexValue >> 16) & 0xff;\n  },\n  redf(hexValue) {\n    return ((hexValue >> 16) & 0xff) / 255.0;\n  },\n  green(hexValue) {\n    return (hexValue >> 8) & 0xff;\n  },\n  greenf(hexValue) {\n    return ((hexValue >> 8) & 0xff) / 255.0;\n  },\n  blue(hexValue) {\n    return hexValue & 0xff;\n  },\n  bluef(hexValue) {\n    return (hexValue & 0xff) / 255.0;\n  },\n  alpha(hexValue) {\n    return (hexValue >> 24) & 0xff;\n  },\n  alphaf(hexValue) {\n    return ((hexValue >> 24) & 0xff) / 255.0;\n  },\n  hexf(redf, greenf, bluef, alphaf = 1) {\n    let r = Math.floor(Math.max(Math.min(redf, 1), 0) * 255);\n    let g = Math.floor(Math.max(Math.min(greenf, 1), 0) * 255);\n    let b = Math.floor(Math.max(Math.min(bluef, 1), 0) * 255);\n    let a = Math.floor(Math.max(Math.min(alphaf, 1), 0) * 255);\n    return (\n      ((a & 0xff) << 24) | ((r & 0xff) << 16) | ((g & 0xff) << 8) | (b & 0xff)\n    );\n  },\n  mix(from = 0x000000, to = 0xffffff, delta = 0.5) {\n    if (to < from) {\n      let temp = from;\n      from = to;\n      to = temp;\n    }\n    let rm = this.redf(from);\n    let gm = this.greenf(from);\n    let bm = this.bluef(from);\n    let am = this.alphaf(from);\n    let rf = (this.redf(to) - rm) * delta + rm;\n    let gf = (this.greenf(to) - gm) * delta + gm;\n    let bf = (this.bluef(to) - bm) * delta + bm;\n    let af = (this.alphaf(to) - am) * delta + am;\n    if (af < 0.01) {\n      af = undefined;\n    }\n    return this.hexf(rf, gf, bf, af);\n  },\n};\n", "import { mat4, quat, vec3 } from 'gl-matrix';\nimport { OrthographicCamera } from '@milque/scene';\nimport {\n  BufferHelper,\n  BufferInfoBuilder,\n  ProgramInfoBuilder,\n} from '@milque/mogli';\n\nimport { hex } from '../../renderer/color.js';\nimport { FixedGLRenderer2d } from './FixedGLRenderer2d.js';\n\nconst WEBGL_VERTEX_SHADER_SOURCE = `\nattribute vec2 a_position;\n\nuniform mat4 u_projection_view;\nuniform mat4 u_model;\n\nvoid main()\n{\n    gl_Position = u_projection_view * u_model * vec4(a_position.xy, 0.0, 1.0);\n}`;\n\nconst WEBGL_FRAGMENT_SHADER_SOURCE = `\nprecision mediump float;\n\nuniform vec3 u_color;\n\nvoid main()\n{\n    gl_FragColor = vec4(u_color.rgb, 1.0);\n}`;\n\nconst CIRCLE_ITERATIONS = 16;\nconst CIRCLE_VERTICES = (() => {\n  let result = [];\n  let iterations = CIRCLE_ITERATIONS;\n  let rads = (Math.PI * 2) / iterations;\n  let prevX = 1,\n    prevY = 0;\n  let nextX, nextY;\n  for (let i = 0; i <= iterations; ++i) {\n    nextX = Math.cos(i * rads);\n    nextY = Math.sin(i * rads);\n    result.push(0, 0);\n    result.push(prevX, prevY);\n    result.push(nextX, nextY);\n    prevX = nextX;\n    prevY = nextY;\n  }\n  return result;\n})();\nconst CIRCLE_VERTEX_COUNT = Math.trunc(CIRCLE_VERTICES.length / 2);\nconst LINE_CIRCLE_VERTICES = (() => {\n  let result = [];\n  let iterations = CIRCLE_ITERATIONS;\n  let rads = (Math.PI * 2) / iterations;\n  let prevX = 1,\n    prevY = 0;\n  let nextX, nextY;\n  for (let i = 0; i <= iterations; ++i) {\n    nextX = Math.cos(i * rads);\n    nextY = Math.sin(i * rads);\n    result.push(prevX, prevY);\n    result.push(nextX, nextY);\n    prevX = nextX;\n    prevY = nextY;\n  }\n  return result;\n})();\nconst LINE_CIRCLE_VERTEX_COUNT = Math.trunc(LINE_CIRCLE_VERTICES.length / 2);\nconst QUAD_VERTICES = [\n  // Top-Left\n  0, 0, 1, 0, 0, 1,\n  // Bottom-Right\n  1, 1, 1, 0, 0, 1,\n];\nconst LINE_VERTICES = [0, 0, 1, 1];\n\nexport class FixedShapeGLRenderer2d extends FixedGLRenderer2d {\n  constructor(canvas) {\n    super(canvas);\n    const gl = this.gl;\n    gl.enable(gl.DEPTH_TEST);\n    /**\n     * @protected\n     * @type {ProgramInfo}\n     */\n    this.program = new ProgramInfoBuilder(gl)\n      .shader(gl.VERTEX_SHADER, WEBGL_VERTEX_SHADER_SOURCE)\n      .shader(gl.FRAGMENT_SHADER, WEBGL_FRAGMENT_SHADER_SOURCE)\n      .link();\n    /**\n     * @protected\n     * @type {BufferInfo}\n     */\n    this.meshQuad = new BufferInfoBuilder(gl, gl.ARRAY_BUFFER)\n      .data(BufferHelper.createBufferSource(gl, gl.FLOAT, QUAD_VERTICES))\n      .build();\n    /**\n     * @protected\n     * @type {BufferInfo}\n     */\n    this.meshLine = new BufferInfoBuilder(gl, gl.ARRAY_BUFFER)\n      .data(BufferHelper.createBufferSource(gl, gl.FLOAT, LINE_VERTICES))\n      .build();\n    /**\n     * @protected\n     * @type {BufferInfo}\n     */\n    this.meshCircle = new BufferInfoBuilder(gl, gl.ARRAY_BUFFER)\n      .data(BufferHelper.createBufferSource(gl, gl.FLOAT, CIRCLE_VERTICES))\n      .build();\n    /**\n     * @protected\n     * @type {BufferInfo}\n     */\n    this.meshLineCircle = new BufferInfoBuilder(gl, gl.ARRAY_BUFFER)\n      .data(BufferHelper.createBufferSource(gl, gl.FLOAT, LINE_CIRCLE_VERTICES))\n      .build();\n    /** @protected */\n    this.camera = new OrthographicCamera();\n    /** @protected */\n    this.projectionViewMatrix = mat4.create();\n    /** @protected */\n    this.modelMatrix = mat4.create();\n    /** @protected */\n    this.shapeColor = vec3.create();\n    /** @protected */\n    this.shapeDepth = 0;\n  }\n\n  prepare() {\n    this.resetTransform();\n    this.resize();\n    this.clear();\n    this.color(0xffffff);\n    this.zLevel(0);\n  }\n\n  resize() {\n    const gl = this.gl;\n    const viewportWidth = gl.canvas.width;\n    const viewportHeight = gl.canvas.height;\n\n    gl.viewport(0, 0, viewportWidth, viewportHeight);\n\n    let camera = this.camera;\n    camera.resize(viewportWidth, viewportHeight);\n\n    let projViewMatrix = this.projectionViewMatrix;\n    mat4.mul(projViewMatrix, camera.projectionMatrix, camera.viewMatrix);\n\n    // Set the projection view matrix\n    let program = this.program;\n    program.bind(gl).uniform('u_projection_view', projViewMatrix);\n  }\n\n  clear(color = 0x000000) {\n    const gl = this.gl;\n    gl.clearColor(\n      hex.redf(color),\n      hex.greenf(color),\n      hex.bluef(color),\n      hex.alphaf(color)\n    );\n    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n    this.resetTransform();\n  }\n\n  color(color = 0xffffff) {\n    const gl = this.gl;\n    let program = this.program;\n    let colorVector = this.shapeColor;\n    vec3.set(colorVector, hex.redf(color), hex.greenf(color), hex.bluef(color));\n    // Set the shape color vector\n    program.bind(gl).uniform('u_color', colorVector);\n    return this;\n  }\n\n  zLevel(level = 0) {\n    this.shapeDepth = level;\n    return this;\n  }\n\n  line(x1 = 0, y1 = 0, x2 = x1 + 16, y2 = y1) {\n    const gl = this.gl;\n    let z = this.shapeDepth;\n    let dx = x2 - x1;\n    let dy = y2 - y1;\n    let program = this.program;\n    let modelMatrix = this.modelMatrix;\n    mat4.fromTranslation(modelMatrix, vec3.fromValues(x1, y1, z));\n    mat4.scale(modelMatrix, modelMatrix, vec3.fromValues(dx, dy, 1));\n    let transformationMatrix = this.peekTransform();\n    if (transformationMatrix) {\n      mat4.mul(modelMatrix, transformationMatrix, modelMatrix);\n    }\n    program\n      .bind(gl)\n      .attribute('a_position', gl.FLOAT, this.meshLine.handle)\n      .uniform('u_model', modelMatrix)\n      .draw(gl, gl.LINES, 0, 2);\n    return this;\n  }\n\n  ray(x = 0, y = 0, angle = 0, length = 16) {\n    let radians = (Math.PI * angle) / 180;\n    return this.line(\n      x,\n      y,\n      x + Math.cos(radians) * length,\n      y + Math.sin(radians) * length\n    );\n  }\n\n  lineBox(x = 0, y = 0, rx = 8, ry = 8, angle = 0) {\n    const gl = this.gl;\n    drawBox(\n      gl,\n      this.program,\n      this.meshQuad,\n      this.peekTransform(),\n      this.modelMatrix,\n      gl.LINE_LOOP,\n      x,\n      y,\n      this.shapeDepth,\n      rx,\n      ry,\n      angle\n    );\n    return this;\n  }\n\n  lineRect(x = 0, y = 0, w = 16, h = 16, angle = 0) {\n    return this.lineBox(x, y, w / 2, h / 2, angle);\n  }\n\n  box(x = 0, y = 0, rx = 8, ry = rx, angle = 0) {\n    const gl = this.gl;\n    drawBox(\n      gl,\n      this.program,\n      this.meshQuad,\n      this.peekTransform(),\n      this.modelMatrix,\n      gl.TRIANGLES,\n      x,\n      y,\n      this.shapeDepth,\n      rx,\n      ry,\n      angle\n    );\n    return this;\n  }\n\n  rect(x = 0, y = 0, w = 16, h = w, angle = 0) {\n    let rx = w / 2;\n    let ry = h / 2;\n    return this.box(x - rx, y - ry, rx, ry, angle);\n  }\n\n  circle(x = 0, y = 0, r = 8) {\n    const gl = this.gl;\n    drawCircle(\n      gl,\n      this.program,\n      this.meshCircle,\n      CIRCLE_VERTEX_COUNT,\n      this.peekTransform(),\n      this.modelMatrix,\n      gl.TRIANGLES,\n      x,\n      y,\n      this.shapeDepth,\n      r\n    );\n  }\n\n  lineCircle(x = 0, y = 0, r = 0) {\n    const gl = this.gl;\n    drawCircle(\n      gl,\n      this.program,\n      this.meshLineCircle,\n      LINE_CIRCLE_VERTEX_COUNT,\n      this.peekTransform(),\n      this.modelMatrix,\n      gl.LINE_LOOP,\n      x,\n      y,\n      this.shapeDepth,\n      r\n    );\n  }\n}\n\nfunction drawBox(\n  gl,\n  program,\n  mesh,\n  transformationMatrix,\n  modelMatrix,\n  drawMode,\n  x,\n  y,\n  z,\n  rx,\n  ry,\n  angle\n) {\n  mat4.fromRotationTranslationScaleOrigin(\n    modelMatrix,\n    quat.fromEuler(quat.create(), 0, 0, angle),\n    vec3.fromValues(x, y, z),\n    vec3.fromValues(rx * 2, ry * 2, 1),\n    vec3.fromValues(0.5, 0.5, 0)\n  );\n  if (transformationMatrix) {\n    mat4.mul(modelMatrix, transformationMatrix, modelMatrix);\n  }\n  program\n    .bind(gl)\n    .attribute('a_position', gl.FLOAT, mesh.handle)\n    .uniform('u_model', modelMatrix)\n    .draw(gl, drawMode, 0, 6);\n}\n\nfunction drawCircle(\n  gl,\n  program,\n  mesh,\n  vertexCount,\n  transformationMatrix,\n  modelMatrix,\n  drawMode,\n  x,\n  y,\n  z,\n  r\n) {\n  mat4.fromRotationTranslationScale(\n    modelMatrix,\n    quat.fromEuler(quat.create(), 0, 0, 0),\n    vec3.fromValues(x, y, z),\n    vec3.fromValues(r, r, 1)\n  );\n  if (transformationMatrix) {\n    mat4.mul(modelMatrix, transformationMatrix, modelMatrix);\n  }\n  program\n    .bind(gl)\n    .attribute('a_position', gl.FLOAT, mesh.handle)\n    .uniform('u_model', modelMatrix)\n    .draw(gl, drawMode, 0, vertexCount);\n}\n", "import { vec2 } from 'gl-matrix';\n\nexport const CHUNK_SIZE = 16;\nexport const TILE_SIZE = 16;\nexport const HALF_TILE_SIZE = TILE_SIZE / 2;\nexport const CHUNK_TILE_SIZE = CHUNK_SIZE * TILE_SIZE;\nexport const POS_TO_CHUNK_COORD = 1 / CHUNK_TILE_SIZE;\nexport const CHUNK_COORD_TO_POS = CHUNK_TILE_SIZE;\n\nexport class TileMap {\n  constructor() {\n    this.chunks = new Map();\n    this.emptyChunk = new Chunk(0, 0);\n  }\n\n  getTile(posX, posY, posZ = 0) {\n    let chunkCoordX = Math.floor(posX * POS_TO_CHUNK_COORD);\n    let chunkCoordY = Math.floor(posY * POS_TO_CHUNK_COORD);\n    if (!this.isChunkLoaded(chunkCoordX, chunkCoordY)) return 0;\n    let chunk = this.getChunkByCoord(chunkCoordX, chunkCoordY);\n\n    let tileCoordX = Math.round(posX / TILE_SIZE) % CHUNK_SIZE;\n    let tileCoordY = Math.round(posY / TILE_SIZE) % CHUNK_SIZE;\n    let tile = chunk.getTileByCoord(tileCoordX, tileCoordY);\n    return tile;\n  }\n\n  async loadChunk(chunkCoordX, chunkCoordY) {\n    const chunkKey = this.getChunkKey(chunkCoordX, chunkCoordY);\n    if (this.chunks.has(chunkKey)) {\n      return this.chunks.get(chunkKey);\n    } else {\n      let chunk = new Chunk(chunkCoordX, chunkCoordY);\n      this.chunks.set(chunkKey, chunk);\n      return chunk;\n    }\n  }\n\n  isChunkLoaded(chunkCoordX, chunkCoordY) {\n    const chunkKey = this.getChunkKey(chunkCoordX, chunkCoordY);\n    return this.chunks.has(chunkKey);\n  }\n\n  getChunk(chunkCoordX, chunkCoordY) {\n    const chunkKey = this.getChunkKey(chunkCoordX, chunkCoordY);\n    return this.chunks.get(chunkKey) || this.emptyChunk;\n  }\n\n  getChunkCoord(out, posX, posY) {\n    let chunkCoordX = Math.floor(posX * POS_TO_CHUNK_COORD);\n    let chunkCoordY = Math.floor(posY * POS_TO_CHUNK_COORD);\n    out[0] = chunkCoordX;\n    out[1] = chunkCoordY;\n    return out;\n  }\n\n  getChunkKey(chunkCoordX, chunkCoordY) {\n    return `${chunkCoordX},${chunkCoordY}`;\n  }\n}\n\nexport class Chunk {\n  constructor(chunkCoordX, chunkCoordY) {\n    this.chunkCoordX = chunkCoordX;\n    this.chunkCoordY = chunkCoordY;\n\n    const size = CHUNK_SIZE * CHUNK_SIZE;\n    this.size = size;\n    this.data = {\n      tiles: new Uint8Array(size),\n    };\n  }\n\n  getTileByIndex(tileIndex) {\n    return this.data.tiles[tileIndex];\n  }\n\n  getTileByCoord(tileCoordX, tileCoordY) {\n    let tileIndex = tileCoordX + tileCoordY * CHUNK_SIZE;\n    return this.getTileByIndex(tileIndex);\n  }\n}\n\n/**\n * @param {FixedSpriteGLRenderer2d} renderer\n * @param {Chunk} chunk\n */\nexport function renderChunk(renderer, chunk, tileRenderer, opts = {}) {\n  const { isTargetChunk } = opts;\n\n  let vec = vec2.create();\n  const { chunkCoordX, chunkCoordY } = chunk;\n  const chunkCart = isoToCart(vec, chunkCoordX, chunkCoordY);\n  renderer.pushTranslation(chunkCart[0] * TILE_SIZE, chunkCart[1] * TILE_SIZE);\n  for (let i = 0; i < CHUNK_SIZE; ++i) {\n    let x = i + chunkCoordX * CHUNK_SIZE;\n    for (let j = 0; j < CHUNK_SIZE; ++j) {\n      if (isTargetChunk) {\n        renderer.color(0xaaaaaa);\n      } else if (i === 0 || j === 0) {\n        renderer.color(0x565656);\n      } else {\n        renderer.color(0x111111);\n      }\n      let y = j + chunkCoordY * CHUNK_SIZE;\n      renderer.zLevel((-x + y) / 1000);\n      isoToCart(vec, i, j);\n      tileRenderer(renderer, vec[0], vec[1]);\n    }\n  }\n  renderer.popTransform();\n}\n\nexport function isoToCart(out, isoX, isoY) {\n  out[0] = isoX * TILE_SIZE + isoY * TILE_SIZE;\n  out[1] = isoY * HALF_TILE_SIZE - isoX * HALF_TILE_SIZE;\n  return out;\n}\n\nexport function cartToIso(out, cartX, cartY) {\n  out[0] = Math.trunc((cartX / TILE_SIZE - cartY / HALF_TILE_SIZE) / 2);\n  out[1] = Math.trunc((cartX / TILE_SIZE + cartY / HALF_TILE_SIZE) / 2);\n  return out;\n}\n\nexport function getTileCoord(posX, posY, posZ = 0) {\n  const tileSize = 16;\n  const halfTileSize = tileSize / 2;\n\n  posX += tileSize;\n  posY += halfTileSize;\n  return [\n    Math.trunc((posX / tileSize - posY / halfTileSize) / 2),\n    Math.trunc((posX / tileSize + posY / halfTileSize) / 2),\n  ];\n}\n", "import { EntityBase } from './EntityBase.js';\nimport { clamp, lookAt2, toDegrees, toRadians } from '@milque/util';\n\n/**\n * @typedef {import('@milque/input').InputContext} InputContext\n */\n\nconst MAX_JUMP_TICKS = 6;\nconst MIN_JUMP_TICKS = 3;\nconst MAX_JUMP_ANGLE_COYOTE_TICKS = 1;\nconst JUMP_SCALE = 0.5;\n\nconst MAX_PLAYER_MOTION = 2;\nconst PLAYER_JUMP_SPEED = 2;\nconst PLAYER_FRICTION = 0.3;\nconst INV_PLAYER_FRICTION = 1 - PLAYER_FRICTION;\n\nconst PLAYER_TURN_DELTA = 0.3;\nconst PLAYER_BREATHING_INTERVAL = 500;\n\nexport class Player extends EntityBase {\n  constructor() {\n    super();\n\n    this.x = 0;\n    this.y = 0;\n\n    this.motionX = 0;\n    this.motionY = 0;\n\n    this.angle = 0;\n    this.lookAngle = 0;\n\n    this.jump = false;\n    this.jumping = false;\n    this.jumpTicks = 0;\n    this.jumpAngle = 0;\n\n    this.fall = false;\n    this.falling = false;\n  }\n\n  /**\n   * @override\n   * @param {InputContext} inputs\n   * @param {number} dt\n   */\n  onInputUpdate(inputs, dt) {\n    let player = this;\n    let dx =\n      inputs.getInputValue('MoveRight') - inputs.getInputValue('MoveLeft');\n    let dy = inputs.getInputValue('MoveDown') - inputs.getInputValue('MoveUp');\n    let jump = inputs.isButtonPressed('Jump');\n    let fall = inputs.isButtonReleased('Jump');\n    if (dx || dy) {\n      let rads = Math.atan2(dy, dx);\n      player.angle = toDegrees(rads);\n    }\n    if (jump) {\n      player.jump = true;\n    }\n    if (fall) {\n      player.fall = true;\n    }\n  }\n\n  /** @override */\n  onUpdate() {\n    let player = this;\n    if (player.landing) {\n      player.landing = false;\n    }\n\n    if (player.jumping) {\n      // Give some leeway to switch jump angle\n      if (player.jumpTicks < MAX_JUMP_ANGLE_COYOTE_TICKS) {\n        player.jumpAngle = player.angle;\n      }\n      let jumpRads = toRadians(player.jumpAngle);\n      player.motionX = Math.cos(jumpRads) * PLAYER_JUMP_SPEED;\n      player.motionY = Math.sin(jumpRads) * PLAYER_JUMP_SPEED;\n      player.jumpTicks += 1;\n      if (\n        player.jumpTicks >= MIN_JUMP_TICKS &&\n        (player.fall || player.jumpTicks > MAX_JUMP_TICKS)\n      ) {\n        player.falling = true;\n        player.jumping = false;\n      }\n    } else if (player.falling) {\n      let jumpRads = toRadians(player.jumpAngle);\n      player.motionX = Math.cos(jumpRads) * PLAYER_JUMP_SPEED;\n      player.motionY = Math.sin(jumpRads) * PLAYER_JUMP_SPEED;\n      player.jumpTicks -= 1;\n      if (player.jumpTicks <= 0) {\n        player.falling = false;\n        player.fall = false;\n        // Make sure that we ONLY capture jump after starting a landing\n        player.jumping = false;\n        player.jump = false;\n        player.jumpTicks = 0;\n      }\n    } else {\n      if (player.jump) {\n        player.jumping = true;\n        player.jumpTicks = 0;\n        player.jumpAngle = player.angle;\n        // Make sure that we ONLY capture fall after starting a jump\n        player.falling = false;\n        player.fall = false;\n      } else {\n        player.motionX *= INV_PLAYER_FRICTION;\n        player.motionY *= INV_PLAYER_FRICTION;\n\n        let signX = Math.sign(player.motionX);\n        let signY = Math.sign(player.motionY);\n        if (player.motionX * signX > MAX_PLAYER_MOTION) {\n          player.motionX = signX * MAX_PLAYER_MOTION;\n        }\n        if (player.motionY * signY > MAX_PLAYER_MOTION) {\n          player.motionY = signY * MAX_PLAYER_MOTION;\n        }\n      }\n    }\n\n    player.x += player.motionX;\n    player.y += player.motionY;\n  }\n\n  /** @override */\n  onRender(ctx) {\n    const r = ctx.renderer;\n\n    let player = this;\n    let lookRads = toRadians(player.lookAngle);\n    let targetRads = toRadians(player.angle);\n    player.lookAngle = toDegrees(\n      lookAt2(lookRads, targetRads, PLAYER_TURN_DELTA)\n    );\n    let jumpProgress = player.jumpTicks / MAX_JUMP_TICKS;\n    let jumpHeight =\n      (Math.sin((jumpProgress * Math.PI) / 2) - 0.2) * JUMP_SCALE;\n    let livingProgress =\n      clamp(Math.cos(performance.now() / PLAYER_BREATHING_INTERVAL), 0, 1) *\n      0.1;\n    let playerScale = 1 + livingProgress;\n    if (jumpProgress) {\n      playerScale += jumpHeight;\n    }\n    r.draw(\n      'slime',\n      0,\n      player.x,\n      player.y,\n      player.lookAngle + 90,\n      playerScale,\n      playerScale\n    );\n  }\n}\n", "import { OrthographicCamera } from '@milque/scene';\nimport { mat4, quat, vec3 } from 'gl-matrix';\nimport { hex } from 'src/renderer/color.js';\n\nexport class DrawContextFixedGLBase {\n  /**\n   * @param {WebGLRenderingContext} gl\n   * @param {HTMLCanvasElement} [canvas]\n   * @param {import('@milque/scene').Camera} [camera]\n   */\n  constructor(gl, canvas = gl.canvas, camera = new OrthographicCamera()) {\n    /** @protected */\n    this.gl = gl;\n    /** @protected */\n    this.canvas = canvas;\n    /** @protected */\n    this.camera = camera;\n    /** @protected */\n    this.projectionViewMatrix = mat4.create();\n    /** @protected */\n    this.modelMatrix = mat4.create();\n    /** @protected */\n    this.colorVector = vec3.create();\n    /** @protected */\n    this.depthFloat = 0;\n    /** @protected */\n    this.opacityFloat = 1;\n\n    /** @protected */\n    this.transformStack = [];\n    /** @protected */\n    this.transformMatrix = mat4.create();\n    /** @protected */\n    this.translationVector = vec3.create();\n    /** @protected */\n    this.rotationQuat = quat.create();\n    /** @protected */\n    this.scaleVector = vec3.fromValues(1, 1, 1);\n\n    // Initialize webgl state machine\n    gl.enable(gl.DEPTH_TEST);\n    gl.depthFunc(gl.LEQUAL);\n    gl.enable(gl.BLEND);\n    gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n  }\n\n  reset() {\n    this.resize();\n    this.clear(0, 0, 0, 1);\n    this.setColorVector(1, 1, 1);\n    this.setDepthFloat(0);\n    this.setOpacityFloat(1);\n    this.resetTransform();\n    this.transformStack.length = 0;\n  }\n\n  /**\n   * To be called every frame to clear screen buffer and\n   * resize camera matrices to fit.\n   */\n  resize() {\n    const gl = this.gl;\n    const viewportWidth = gl.canvas.width;\n    const viewportHeight = gl.canvas.height;\n    gl.viewport(0, 0, viewportWidth, viewportHeight);\n\n    let camera = this.camera;\n    camera.resize(viewportWidth, viewportHeight);\n\n    let projViewMatrix = this.projectionViewMatrix;\n    mat4.mul(projViewMatrix, camera.projectionMatrix, camera.viewMatrix);\n  }\n\n  /**\n   * @param {number} redf\n   * @param {number} greenf\n   * @param {number} bluef\n   * @param {number} [alphaf=1]\n   */\n  clear(redf, greenf, bluef, alphaf = 1) {\n    const gl = this.gl;\n    gl.clearColor(redf, greenf, bluef, alphaf);\n    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n  }\n\n  /**\n   * @param {number} redf\n   * @param {number} greenf\n   * @param {number} bluef\n   */\n  setColorVector(redf, greenf, bluef) {\n    vec3.set(this.colorVector, redf, greenf, bluef);\n    return this;\n  }\n\n  /**\n   * @param {number} colorHex\n   */\n  setColor(colorHex) {\n    return this.setColorVector(\n      hex.redf(colorHex),\n      hex.greenf(colorHex),\n      hex.bluef(colorHex)\n    );\n  }\n\n  /** @param {number} z */\n  setDepthFloat(z) {\n    this.depthFloat = z;\n    return this;\n  }\n\n  /** @param {number} opacity */\n  setOpacityFloat(opacity) {\n    this.opacityFloat = opacity;\n    return this;\n  }\n\n  setTranslation(x, y, z = 0) {\n    vec3.set(this.translationVector, x, y, z);\n    return this;\n  }\n\n  setRotation(angle) {\n    quat.fromEuler(this.rotationQuat, 0, 0, angle);\n    return this;\n  }\n\n  setScale(x, y) {\n    vec3.set(this.scaleVector, x, y, 1);\n    return this;\n  }\n\n  resetTransform() {\n    vec3.zero(this.translationVector);\n    quat.identity(this.rotationQuat);\n    vec3.set(this.scaleVector, 1, 1, 1);\n  }\n\n  pushTransform() {\n    let matrix = mat4.fromRotationTranslationScale(\n      mat4.create(),\n      this.rotationQuat,\n      this.translationVector,\n      this.scaleVector\n    );\n    this.transformStack.push(matrix);\n    this.resetTransform();\n  }\n\n  popTransform() {\n    let matrix = this.transformStack.pop();\n    mat4.getRotation(this.rotationQuat, matrix);\n    mat4.getTranslation(this.translationVector, matrix);\n    mat4.getScaling(this.scaleVector, matrix);\n  }\n\n  applyTransform(out) {\n    for (let i = this.transformStack.length - 1; i >= 0; --i) {\n      mat4.mul(out, this.transformStack[i], out);\n    }\n    mat4.mul(\n      out,\n      mat4.fromRotationTranslationScale(\n        this.transformMatrix,\n        this.rotationQuat,\n        this.translationVector,\n        this.scaleVector\n      ),\n      out\n    );\n    return out;\n  }\n}\n", "import {\n  BufferHelper,\n  BufferInfoBuilder,\n  ProgramInfoBuilder,\n} from '@milque/mogli';\nimport { mat4, quat, vec3 } from 'gl-matrix';\nimport { DrawContextFixedGLBase } from './DrawContextFixedGLBase.js';\n\nconst VERTEX_SHADER_SOURCE = `\nattribute vec2 a_position;\n\nuniform mat4 u_projection_view;\nuniform mat4 u_model;\n\nvoid main() {\n    gl_Position = u_projection_view * u_model * vec4(a_position.xy, 0.0, 1.0);\n}`;\n\nconst FRAGMENT_SHADER_SOURCE = `\nprecision mediump float;\n\nuniform vec3 u_color;\nuniform float u_opacity_inv;\n\nvoid main() {\n    gl_FragColor = vec4(u_color.rgb, 1.0 - u_opacity_inv);\n}`;\n\nexport const CIRCLE_ITERATIONS = 16;\nexport const CIRCLE_VERTICES = (() => {\n  let result = [];\n  let iterations = CIRCLE_ITERATIONS;\n  let rads = (Math.PI * 2) / iterations;\n  let prevX = 1,\n    prevY = 0;\n  let nextX, nextY;\n  for (let i = 0; i <= iterations; ++i) {\n    nextX = Math.cos(i * rads);\n    nextY = Math.sin(i * rads);\n    result.push(0, 0);\n    result.push(prevX, prevY);\n    result.push(nextX, nextY);\n    prevX = nextX;\n    prevY = nextY;\n  }\n  return result;\n})();\nexport const CIRCLE_VERTEX_COUNT = Math.trunc(CIRCLE_VERTICES.length / 2);\nexport const LINE_CIRCLE_VERTICES = (() => {\n  let result = [];\n  let iterations = CIRCLE_ITERATIONS;\n  let rads = (Math.PI * 2) / iterations;\n  let prevX = 1,\n    prevY = 0;\n  let nextX, nextY;\n  for (let i = 0; i <= iterations; ++i) {\n    nextX = Math.cos(i * rads);\n    nextY = Math.sin(i * rads);\n    result.push(prevX, prevY);\n    result.push(nextX, nextY);\n    prevX = nextX;\n    prevY = nextY;\n  }\n  return result;\n})();\nexport const LINE_CIRCLE_VERTEX_COUNT = Math.trunc(\n  LINE_CIRCLE_VERTICES.length / 2\n);\nexport const QUAD_VERTICES = [\n  // Top-Left\n  0, 0, 1, 0, 0, 1,\n  // Bottom-Right\n  1, 1, 1, 0, 0, 1,\n];\nexport const LINE_VERTICES = [0, 0, 1, 1];\n\nexport class DrawContextFixedGLShape extends DrawContextFixedGLBase {\n  /**\n   * @param {WebGLRenderingContext} gl\n   * @param {HTMLCanvasElement} [canvas]\n   * @param {import('@milque/scene').Camera} [camera]\n   */\n  constructor(gl, canvas = undefined, camera = undefined) {\n    super(gl, canvas, camera);\n    /** @protected */\n    this.shapeProgram = new ProgramInfoBuilder(gl)\n      .shader(gl.VERTEX_SHADER, VERTEX_SHADER_SOURCE)\n      .shader(gl.FRAGMENT_SHADER, FRAGMENT_SHADER_SOURCE)\n      .link();\n    /** @protected */\n    this.meshQuad = new BufferInfoBuilder(gl, gl.ARRAY_BUFFER)\n      .data(BufferHelper.createBufferSource(gl, gl.FLOAT, QUAD_VERTICES))\n      .build();\n    /** @protected */\n    this.meshLine = new BufferInfoBuilder(gl, gl.ARRAY_BUFFER)\n      .data(BufferHelper.createBufferSource(gl, gl.FLOAT, LINE_VERTICES))\n      .build();\n    /** @protected */\n    this.meshCircle = new BufferInfoBuilder(gl, gl.ARRAY_BUFFER)\n      .data(BufferHelper.createBufferSource(gl, gl.FLOAT, CIRCLE_VERTICES))\n      .build();\n    /** @protected */\n    this.meshLineCircle = new BufferInfoBuilder(gl, gl.ARRAY_BUFFER)\n      .data(BufferHelper.createBufferSource(gl, gl.FLOAT, LINE_CIRCLE_VERTICES))\n      .build();\n  }\n\n  /** @override */\n  resize() {\n    super.resize();\n    this.shapeProgram\n      .bind(this.gl)\n      .uniform('u_projection_view', this.projectionViewMatrix);\n  }\n\n  /** @override */\n  setColorVector(redf, greenf, bluef) {\n    super.setColorVector(redf, greenf, bluef);\n    this.shapeProgram.bind(this.gl).uniform('u_color', this.colorVector);\n    return this;\n  }\n\n  /** @override */\n  setOpacityFloat(opacity) {\n    super.setOpacityFloat(opacity);\n    this.shapeProgram\n      .bind(this.gl)\n      .uniform('u_opacity_inv', 1 - this.opacityFloat);\n    return this;\n  }\n\n  drawLine(fromX = 0, fromY = 0, toX = fromX + 16, toY = fromY) {\n    const gl = this.gl;\n    let z = this.depthFloat;\n    let dx = toX - fromX;\n    let dy = toY - fromY;\n    let modelMatrix = this.modelMatrix;\n    mat4.fromRotationTranslationScale(\n      modelMatrix,\n      quat.create(),\n      vec3.fromValues(fromX, fromY, z),\n      vec3.fromValues(dx, dy, 1)\n    );\n    this.applyTransform(modelMatrix);\n    this.shapeProgram\n      .bind(gl)\n      .attribute('a_position', gl.FLOAT, this.meshLine.handle)\n      .uniform('u_model', modelMatrix)\n      .draw(gl, gl.LINES, 0, 2);\n    return this;\n  }\n\n  drawRay(x = 0, y = 0, angle = 0, length = 16) {\n    let radians = (Math.PI * angle) / 180;\n    return this.drawLine(\n      x,\n      y,\n      x + Math.cos(radians) * length,\n      y + Math.sin(radians) * length\n    );\n  }\n\n  drawBox(x = 0, y = 0, rx = 8, ry = rx) {\n    return this.drawBoxImpl(this.gl.TRIANGLES, x, y, this.depthFloat, rx, ry);\n  }\n\n  drawLineBox(x = 0, y = 0, rx = 8, ry = rx) {\n    return this.drawBoxImpl(this.gl.LINE_LOOP, x, y, this.depthFloat, rx, ry);\n  }\n\n  drawRect(left = 0, top = 0, right = 16, bottom = 16) {\n    let halfw = (right - left) / 2;\n    let halfh = (bottom - top) / 2;\n    return this.drawBox(left + halfw, top + halfh, halfw, halfh);\n  }\n\n  drawLineRect(left = 0, top = 0, right = 16, bottom = 16) {\n    let halfw = (right - left) / 2;\n    let halfh = (bottom - top) / 2;\n    return this.drawLineBox(left + halfw, top + halfh, halfw, halfh);\n  }\n\n  drawCircle(x = 0, y = 0, r = 8) {\n    return this.drawCircleImpl(\n      this.meshCircle,\n      CIRCLE_VERTEX_COUNT,\n      this.gl.TRIANGLES,\n      x,\n      y,\n      this.depthFloat,\n      r\n    );\n  }\n\n  drawLineCircle(x = 0, y = 0, r = 8) {\n    return this.drawCircleImpl(\n      this.meshLineCircle,\n      LINE_CIRCLE_VERTEX_COUNT,\n      this.gl.LINE_LOOP,\n      x,\n      y,\n      this.depthFloat,\n      r\n    );\n  }\n\n  /** @private */\n  drawBoxImpl(drawMode, x, y, z, rx, ry) {\n    const gl = this.gl;\n    let modelMatrix = this.modelMatrix;\n    mat4.fromRotationTranslationScaleOrigin(\n      modelMatrix,\n      quat.create(),\n      vec3.fromValues(x, y, z),\n      vec3.fromValues(rx * 2, ry * 2, 1),\n      vec3.fromValues(0.5, 0.5, 0)\n    );\n    this.applyTransform(modelMatrix);\n    this.shapeProgram\n      .bind(gl)\n      .attribute('a_position', gl.FLOAT, this.meshQuad.handle)\n      .uniform('u_model', modelMatrix)\n      .draw(gl, drawMode, 0, 6);\n    return this;\n  }\n\n  /** @private */\n  drawCircleImpl(mesh, vertexCount, drawMode, x, y, z, r) {\n    const gl = this.gl;\n    let modelMatrix = this.modelMatrix;\n    mat4.fromRotationTranslationScale(\n      modelMatrix,\n      quat.create(),\n      vec3.fromValues(x, y, z),\n      vec3.fromValues(r, r, 1)\n    );\n    this.applyTransform(modelMatrix);\n    this.shapeProgram\n      .bind(gl)\n      .attribute('a_position', gl.FLOAT, mesh.handle)\n      .uniform('u_model', modelMatrix)\n      .draw(gl, drawMode, 0, vertexCount);\n    return this;\n  }\n}\n", "import {\n  BufferHelper,\n  BufferInfoBuilder,\n  ProgramInfoBuilder,\n} from '@milque/mogli';\nimport { mat4, quat, vec2, vec3, vec4 } from 'gl-matrix';\nimport {\n  DrawContextFixedGLShape,\n  QUAD_VERTICES,\n} from './DrawContextFixedGLShape';\n\n/** @typedef {import('@milque/mogli').BufferInfo} BufferInfo */\n\nconst VERTEX_SHADER_SOURCE = `\nattribute vec2 a_position;\nattribute vec2 a_texcoord;\n\nvarying vec2 v_texcoord;\n\nuniform mat4 u_projection_view;\nuniform mat4 u_model;\n\nvoid main() {\n    vec4 position = u_projection_view * u_model\n        * vec4(a_position.xy, 0.0, 1.0);\n    v_texcoord = a_texcoord;\n    gl_Position = position;\n}`;\n\nconst FRAGMENT_SHADER_SOURCE = `\nprecision mediump float;\n\nvarying vec2 v_texcoord;\n\nuniform sampler2D u_texture;\nuniform vec2 u_texture_size;\nuniform vec4 u_sprite;\nuniform vec3 u_color;\nuniform float u_opacity_inv;\n\nvoid main() {\n    float spriteWidth = u_sprite.z - u_sprite.x;\n    float spriteHeight = u_sprite.w - u_sprite.y;\n    vec2 texcoord = vec2(\n        (u_sprite.x / u_texture_size.x) + v_texcoord.x * (spriteWidth / u_texture_size.x),\n        (u_sprite.y / u_texture_size.y) + v_texcoord.y * (spriteHeight / u_texture_size.y));\n    vec4 texcolor = texture2D(u_texture, texcoord);\n    if (texcolor.a <= 0.0) discard;\n    gl_FragColor = vec4(\n        texcolor.r * u_color.r,\n        texcolor.g * u_color.g,\n        texcolor.b * u_color.b,\n        texcolor.a * (1.0 - u_opacity_inv));\n}`;\n\nexport class DrawContextFixedGLTexture extends DrawContextFixedGLShape {\n  /**\n   * @param {WebGLRenderingContext} gl\n   * @param {HTMLCanvasElement} [canvas]\n   * @param {import('@milque/scene').Camera} [camera]\n   */\n  constructor(gl, canvas = undefined, camera = undefined) {\n    super(gl, canvas, camera);\n    /** @protected */\n    this.texturedProgram = new ProgramInfoBuilder(gl)\n      .shader(gl.VERTEX_SHADER, VERTEX_SHADER_SOURCE)\n      .shader(gl.FRAGMENT_SHADER, FRAGMENT_SHADER_SOURCE)\n      .link();\n    /** @protected */\n    this.meshQuadTextured = {\n      /** @type {BufferInfo} */\n      position: new BufferInfoBuilder(gl, gl.ARRAY_BUFFER)\n        .data(BufferHelper.createBufferSource(gl, gl.FLOAT, QUAD_VERTICES))\n        .build(),\n      /** @type {BufferInfo} */\n      texcoord: new BufferInfoBuilder(gl, gl.ARRAY_BUFFER)\n        .data(BufferHelper.createBufferSource(gl, gl.FLOAT, QUAD_VERTICES))\n        .build(),\n    };\n\n    /** @protected */\n    this.spriteVector = vec4.fromValues(0, 0, 1, 1);\n    /** @protected */\n    this.textureSize = vec2.fromValues(1, 1);\n    /** @protected */\n    this.textureHandle = null;\n    /** @protected */\n    this.textureList = new Array(gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS));\n  }\n\n  /** @override */\n  resize() {\n    super.resize();\n    this.texturedProgram\n      .bind(this.gl)\n      .uniform('u_projection_view', this.projectionViewMatrix);\n  }\n\n  /** @override */\n  setColorVector(redf, greenf, bluef) {\n    super.setColorVector(redf, greenf, bluef);\n    this.texturedProgram.bind(this.gl).uniform('u_color', this.colorVector);\n    return this;\n  }\n\n  /** @override */\n  setOpacityFloat(opacity) {\n    super.setOpacityFloat(opacity);\n    this.texturedProgram\n      .bind(this.gl)\n      .uniform('u_opacity_inv', 1 - this.opacityFloat);\n    return this;\n  }\n\n  /**\n   * Registers a texture for the given texture unit slot.\n   *\n   * @param {number} textureUnit The unique texture unit\n   * slot to use for this image.\n   * @param {Image} image The texture image source.\n   */\n  setTextureImage(textureUnit, image) {\n    let textureList = this.textureList;\n    let maxTextureCount = textureList.length;\n    if (textureUnit < 0 || textureUnit >= maxTextureCount) {\n      throw new Error(\n        `Invalid texture unit - must be within range [0, ${\n          maxTextureCount - 1\n        }]`\n      );\n    }\n    const gl = this.gl;\n    const prevTexture = textureList[textureUnit];\n    if (prevTexture) {\n      destroyTexture(gl, prevTexture.handle);\n    }\n    let texture = createTexture(gl, image);\n    textureList[textureUnit] = texture;\n    gl.activeTexture(gl.TEXTURE0 + textureUnit);\n    gl.bindTexture(gl.TEXTURE_2D, texture.handle);\n    return this;\n  }\n\n  drawTexturedBox(\n    textureUnit = 0,\n    x = 0,\n    y = 0,\n    rx = undefined,\n    ry = undefined,\n    u = 0,\n    v = 0,\n    s = undefined,\n    t = undefined\n  ) {\n    let { width: textureWidth, height: textureHeight } =\n      this.textureList[textureUnit];\n    vec2.set(this.textureSize, textureWidth, textureHeight);\n    if (typeof s === 'undefined') {\n      s = textureWidth;\n    }\n    if (typeof t === 'undefined') {\n      t = textureHeight;\n    }\n    vec4.set(this.spriteVector, u, v, s, t);\n\n    let spriteWidth = s - u;\n    let spriteHeight = t - v;\n    let flag = false;\n    if (typeof rx === 'undefined') {\n      rx = spriteWidth / 2;\n    } else {\n      flag = true;\n    }\n    if (typeof ry === 'undefined') {\n      if (flag) {\n        ry = rx;\n      } else {\n        ry = spriteHeight / 2;\n      }\n    }\n    let width = rx * 2;\n    let height = ry * 2;\n    let scaleX = width / spriteWidth;\n    let scaleY = height / spriteHeight;\n    return this.drawTexturedQuadImpl(\n      textureUnit,\n      x,\n      y,\n      this.depthFloat,\n      scaleX,\n      scaleY\n    );\n  }\n\n  drawTexturedRect(\n    textureUnit = 0,\n    left = 0,\n    top = 0,\n    right = undefined,\n    bottom = undefined,\n    u = 0,\n    v = 0,\n    s = undefined,\n    t = undefined\n  ) {\n    let { width, height } = this.textureList[textureUnit];\n    if (typeof s === 'undefined') {\n      s = width;\n    }\n    if (typeof t === 'undefined') {\n      t = height;\n    }\n    vec2.set(this.textureSize, width, height);\n    vec4.set(this.spriteVector, u, v, s, t);\n\n    if (typeof right === 'undefined') {\n      right = left + width;\n    }\n    if (typeof bottom === 'undefined') {\n      bottom = top + height;\n    }\n    let w = right - left;\n    let h = bottom - top;\n    let spriteWidth = s - u;\n    let spriteHeight = t - v;\n    let scaleX = w / spriteWidth;\n    let scaleY = h / spriteHeight;\n    let x = left + (spriteWidth / 2) * scaleX;\n    let y = top + (spriteHeight / 2) * scaleY;\n    return this.drawTexturedQuadImpl(\n      textureUnit,\n      x,\n      y,\n      this.depthFloat,\n      scaleX,\n      scaleY\n    );\n  }\n\n  /** @private */\n  drawTexturedQuadImpl(textureUnit, x, y, z, scaleX, scaleY) {\n    const gl = this.gl;\n    let spriteVector = this.spriteVector;\n    let spriteWidth = spriteVector[2] - spriteVector[0];\n    let spriteHeight = spriteVector[3] - spriteVector[1];\n    let modelMatrix = this.modelMatrix;\n    mat4.fromRotationTranslationScaleOrigin(\n      modelMatrix,\n      quat.fromEuler(quat.create(), 0, 0, 0),\n      vec3.fromValues(x - spriteWidth / 2, y - spriteHeight / 2, z),\n      vec3.fromValues(scaleX, scaleY, 1),\n      vec3.fromValues(spriteWidth / 2, spriteHeight / 2, 0)\n    );\n    // Scale with respect to top-left (instead of origin)\n    mat4.scale(\n      modelMatrix,\n      modelMatrix,\n      vec3.fromValues(spriteWidth, spriteHeight, 1)\n    );\n    this.applyTransform(modelMatrix);\n    let mesh = this.meshQuadTextured;\n    let textureSize = this.textureSize;\n    this.texturedProgram\n      .bind(gl)\n      .attribute('a_position', gl.FLOAT, mesh.position.handle)\n      .attribute('a_texcoord', gl.FLOAT, mesh.texcoord.handle)\n      .uniform('u_model', modelMatrix)\n      .uniform('u_texture', textureUnit)\n      .uniform('u_sprite', spriteVector)\n      .uniform('u_texture_size', textureSize)\n      .draw(gl, gl.TRIANGLES, 0, 6);\n    return this;\n  }\n}\n\n/**\n * @param {WebGLRenderingContext} gl\n * @param {Image} image\n * @returns {{ handle: WebGLTexture, width: number, height: number }}\n */\nfunction createTexture(gl, image) {\n  if (!(image instanceof Image)) {\n    throw new Error(`Not a valid image ${image}.`);\n  }\n\n  const level = 0;\n  const internalFormat = gl.RGBA;\n  const srcFormat = gl.RGBA;\n  const srcType = gl.UNSIGNED_BYTE;\n\n  let handle = gl.createTexture();\n  gl.bindTexture(gl.TEXTURE_2D, handle);\n  gl.texImage2D(\n    gl.TEXTURE_2D,\n    level,\n    internalFormat,\n    srcFormat,\n    srcType,\n    image\n  );\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n\n  return {\n    handle,\n    width: image.width,\n    height: image.height,\n  };\n}\n\n/**\n * @param {WebGLRenderingContext} gl\n * @param {WebGLTexture} textureHandle\n */\nfunction destroyTexture(gl, textureHandle) {\n  gl.deleteTexture(textureHandle);\n}\n", "import { ProgramInfoBuilder } from '@milque/mogli';\nimport { mat4, quat, vec3, vec4 } from 'gl-matrix';\nimport { hex } from 'src/renderer/color.js';\nimport { DrawContextFixedGLTexture } from './DrawContextFixedGLTexture.js';\n\nconst VERTEX_SHADER_SOURCE = `\nattribute vec2 a_position;\n\nvarying vec2 v_position;\n\nuniform mat4 u_projection_view;\nuniform mat4 u_model;\n\nvoid main() {\n    gl_Position = u_projection_view * u_model * vec4(a_position.xy, 0.0, 1.0);\n    v_position = a_position;\n}`;\n\nconst FRAGMENT_SHADER_SOURCE = `\nprecision mediump float;\n\nvarying vec2 v_position;\n\nuniform vec3 u_color;\nuniform float u_opacity_inv;\n\nuniform vec3 u_color_from;\nuniform vec3 u_color_to;\n\nuniform vec4 u_gradient_rect;\n\nvoid main() {\n    // float fx = (gl_FragCoord.x - u_gradient_rect.x) / u_gradient_rect.z;\n    float fy = (gl_FragCoord.y - u_gradient_rect.y) / u_gradient_rect.w;\n    gl_FragColor = vec4(mix(u_color_to, u_color_from, fy), 1.0 - u_opacity_inv);\n}`;\n\nexport class DrawContextFixedGLGradient extends DrawContextFixedGLTexture {\n  /**\n   * @param {WebGLRenderingContext} gl\n   * @param {HTMLCanvasElement} [canvas]\n   * @param {import('@milque/scene').Camera} [camera]\n   */\n  constructor(gl, canvas = undefined, camera = undefined) {\n    super(gl, canvas, camera);\n    /** @protected */\n    this.gradientProgram = new ProgramInfoBuilder(gl)\n      .shader(gl.VERTEX_SHADER, VERTEX_SHADER_SOURCE)\n      .shader(gl.FRAGMENT_SHADER, FRAGMENT_SHADER_SOURCE)\n      .link();\n    /** @protected */\n    this.gradientColor = vec3.create();\n    /** @protected */\n    this.gradientVector = vec4.create();\n  }\n\n  /** @override */\n  resize() {\n    super.resize();\n    this.gradientProgram\n      .bind(this.gl)\n      .uniform('u_projection_view', this.projectionViewMatrix);\n  }\n\n  /** @override */\n  setColorVector(redf, greenf, bluef) {\n    super.setColorVector(redf, greenf, bluef);\n    this.gradientProgram.bind(this.gl).uniform('u_color', this.colorVector);\n    return this;\n  }\n\n  /** @override */\n  setOpacityFloat(opacity) {\n    super.setOpacityFloat(opacity);\n    this.gradientProgram\n      .bind(this.gl)\n      .uniform('u_opacity_inv', 1 - this.opacityFloat);\n    return this;\n  }\n\n  drawGradientRect(\n    fromColor = 0xffffff,\n    toColor = 0x000000,\n    left = 0,\n    top = 0,\n    right = this.canvas.width,\n    bottom = this.canvas.height\n  ) {\n    let rx = (right - left) / 2;\n    let ry = (bottom - top) / 2;\n    let x = left + rx;\n    let y = top + ry;\n    let z = this.depthFloat;\n\n    const gl = this.gl;\n    let modelMatrix = this.modelMatrix;\n    mat4.fromRotationTranslationScaleOrigin(\n      modelMatrix,\n      quat.fromEuler(quat.create(), 0, 0, 0),\n      vec3.fromValues(x, y, z),\n      vec3.fromValues(rx * 2, ry * 2, 1),\n      vec3.fromValues(0.5, 0.5, 0)\n    );\n    this.applyTransform(modelMatrix);\n    this.gradientProgram\n      .bind(gl)\n      .attribute('a_position', gl.FLOAT, this.meshQuad.handle)\n      .uniform('u_model', modelMatrix)\n      .uniform(\n        'u_color_from',\n        vec3.set(\n          this.gradientColor,\n          hex.redf(fromColor),\n          hex.greenf(fromColor),\n          hex.bluef(fromColor)\n        )\n      )\n      .uniform(\n        'u_color_to',\n        vec3.set(\n          this.gradientColor,\n          hex.redf(toColor),\n          hex.greenf(toColor),\n          hex.bluef(toColor)\n        )\n      )\n      .uniform(\n        'u_gradient_rect',\n        vec4.set(\n          this.gradientVector,\n          left,\n          this.canvas.height - bottom,\n          rx * 2,\n          ry * 2\n        )\n      )\n      .draw(gl, gl.TRIANGLES, 0, 6);\n    return this;\n  }\n}\n", "import { DrawContextFixedGLGradient } from './DrawContextFixedGLGradient.js';\n\nexport class DrawContextFixedGLText extends DrawContextFixedGLGradient {\n  /**\n   * @param {WebGLRenderingContext} gl\n   * @param {HTMLCanvasElement} [canvas]\n   * @param {import('@milque/scene').Camera} [camera]\n   */\n  constructor(gl, canvas = undefined, camera = undefined) {\n    super(gl, canvas, camera);\n\n    /** @protected */\n    this.bmFontMap = {};\n  }\n\n  setBMFontTexture(textureUnit, textureImage, bmFontData) {\n    let chars = {};\n    for (let c of bmFontData.chars) {\n      let u = c.x;\n      let v = c.y;\n      let s = u + c.width;\n      let t = v + c.height;\n      chars[c.id] = {\n        u,\n        v,\n        s,\n        t,\n      };\n    }\n    this.bmFontMap[textureUnit] = chars;\n    this.setTextureImage(textureUnit, textureImage);\n  }\n\n  drawText(textureUnit, text, x, y) {\n    let rootX = x;\n    let spacingX = 13;\n    let spacingY = 18;\n    for (let i = 0; i < text.length; ++i) {\n      let c = text.charAt(i);\n      if (c === '\\n') {\n        y += spacingY;\n        x = rootX;\n        continue;\n      } else if (c === ' ') {\n        x += spacingX;\n        continue;\n      } else {\n        x += spacingX;\n        let charCode = text.charCodeAt(i);\n        let { u, v, s, t } = this.bmFontMap[textureUnit][charCode];\n        let w = s - u;\n        let h = t - v;\n        this.drawTexturedBox(textureUnit, x, y, w / 2, h / 2, u, v, s, t);\n      }\n    }\n  }\n}\n", "import { Random } from '@milque/random';\nimport { clamp } from '@milque/util';\nimport { hex } from 'src/renderer/color.js';\nimport { DrawContextFixedGLText } from './renderer/DrawContextFixedGLText.js';\n\ndocument.title = 'Moonset';\n\n/**\n * @param {import('../game/Game.js').Game} game\n */\nexport async function main(game) {\n  const { display, assets } = game;\n  const canvas = display.canvas;\n  const ctx = new DrawContextFixedGLText(canvas.getContext('webgl'));\n  ctx.reset();\n\n  const image = assets.get('image:water_tile.png');\n  const fontData = assets.get('fnt:m5x7.fnt');\n  const fontImage = assets.get('image:m5x7.png');\n  const star = assets.get('image:star.png');\n  const blurStroke = assets.get('image:blur_stroke.png');\n  const circle = assets.get('image:circle.png');\n  const mountains = assets.get('image:mountains.png');\n  const cloud = assets.get('image:cloud.png');\n\n  const STAR_COLORS = [0xfafafa];\n  const GRADIENT_TOP = 0x8278b4;\n  const GRADIENT_BOTTOM = 0xb4bee6;\n  const STREAK_COLORS = [0xb4a0e6, 0xcdbff2];\n\n  let stars = [];\n  let streaks = [];\n  let bigStreaks = [];\n  let shades = [];\n  for (let i = 0; i < 40; ++i) {\n    stars.push({\n      x: Random.rangeInt(0, canvas.width),\n      y: Random.rangeInt(0, canvas.height),\n      scale: Random.range(0.1, 0.4),\n      opacity: Random.range(0.3, 1),\n      color: Random.choose(STAR_COLORS),\n      wiggleSpeed: Random.range(0.8, 1.2),\n      wiggleOffset: Random.range(0, 2),\n    });\n  }\n\n  for (let i = 0; i < 12; ++i) {\n    let x = Random.range(-canvas.width / 2, canvas.width);\n    let y = Random.range(0, canvas.height);\n    let color;\n    if (y < canvas.width * 0.6) {\n      color = STREAK_COLORS[0];\n    } else {\n      color = STREAK_COLORS[1];\n    }\n    let scale = Random.range(1, 2);\n    streaks.push({\n      x,\n      y,\n      color,\n      progress: Random.range(0, canvas.height),\n      speed: Random.range(0.1, 1.5),\n      opacity: Random.range(0.1, 0.3),\n      radius: Random.range(0.5, 1) * scale,\n      length: Random.range(1, 2) * scale,\n    });\n  }\n\n  for (let i = 0; i < 4; ++i) {\n    let x = Random.range(-canvas.width / 2, canvas.width);\n    let y = Random.rangeInt(0, canvas.height);\n    let color = STREAK_COLORS[1];\n    bigStreaks.push({\n      x,\n      y,\n      color,\n      progress: 0,\n      speed: Random.range(0.1, 0.5),\n      opacity: Random.range(0.1, 0.5),\n      radius: Random.range(0.5, 1) * 3,\n      length: Random.range(1, 2) * 3,\n    });\n  }\n\n  for (let i = 0; i < 6; ++i) {\n    let x = Random.range(0, canvas.width);\n    let y = Random.range(0, canvas.height);\n    let color = hex.mix(\n      GRADIENT_BOTTOM,\n      GRADIENT_TOP,\n      clamp(y / canvas.height - 0.06, 0, 1)\n    );\n    let height = Random.range(50, 80);\n    shades.push({\n      x,\n      y,\n      opacity: 1,\n      color,\n      height,\n    });\n  }\n\n  let clouds = [];\n  for (let i = 0; i < 8; ++i) {\n    let x = Random.range(0, canvas.width);\n    let y = Random.range(0, canvas.height * 0.6);\n    let w = Random.range(2, 4);\n    let h = Random.range(0.2, 1);\n    let highlight = 0xffffff;\n    let lowlight = 0xe0eeff;\n    clouds.push({\n      x,\n      y,\n      w,\n      h,\n      highlight,\n      lowlight,\n      progress: 0,\n      speed: Random.range(0.5, 3),\n    });\n  }\n\n  display.addEventListener('frame', (e) => {\n    let { deltaTime, now } = e.detail;\n\n    const worldSpeed = 30;\n    deltaTime *= worldSpeed;\n    now *= worldSpeed;\n\n    // Update\n    for (let s of streaks) {\n      s.progress += (deltaTime / 50) * s.speed;\n      if (s.progress > s.y * 2 + s.length) {\n        let x = Random.range(-canvas.width / 2, canvas.width);\n        s.x = x;\n        s.y = canvas.height;\n        s.progress = 0;\n        s.speed = Random.range(0.1, 2);\n        s.opacity = Random.range(0.1, 0.3);\n        s.radius = Random.range(0.5, 1);\n        s.length = Random.range(1, 2);\n      }\n    }\n    for (let s of bigStreaks) {\n      s.progress += (deltaTime / 50) * s.speed;\n      if (s.progress > s.y * 2 + s.length) {\n        let x = Random.range(-canvas.width / 2, canvas.width);\n        s.x = x;\n        s.y = canvas.height;\n        s.progress = 0;\n        s.speed = Random.range(0.1, 0.5);\n        s.opacity = Random.range(0.1, 0.5);\n        s.radius = Random.range(0.5, 1) * 3;\n        s.length = Random.range(1, 2) * 3;\n      }\n    }\n    for (let c of clouds) {\n      c.progress += (deltaTime / 100) * c.speed;\n      if (c.progress > canvas.width - c.x + 300) {\n        c.w = Random.range(2, 4);\n        c.h = Random.range(0.2, 1);\n        c.x = -canvas.width;\n        c.y = Random.range(0, canvas.height * 0.6);\n        c.progress = 0;\n        c.speed = Random.range(0.5, 3);\n      }\n    }\n\n    // Draw\n    ctx.resize();\n    ctx.reset();\n\n    ctx.drawGradientRect(\n      GRADIENT_TOP,\n      GRADIENT_BOTTOM,\n      0,\n      0,\n      canvas.width,\n      canvas.height\n    );\n\n    // Shades\n    for (let s of shades) {\n      ctx.setColor(s.color);\n      ctx.setScale(canvas.width / 16, s.height / 16);\n      ctx.setTranslation(s.x, s.y);\n      ctx.drawCircle();\n      ctx.resetTransform();\n    }\n\n    // Streaks\n    ctx.setTextureImage(2, blurStroke);\n    ctx.setRotation(-45);\n    for (let s of streaks) {\n      let maxOpacity = s.progress / 100;\n      ctx.setColor(s.color);\n      ctx.setOpacityFloat(Math.min(maxOpacity, s.opacity));\n      ctx.setScale(s.length, s.radius);\n      ctx.setTranslation(s.x, s.y);\n      ctx.drawTexturedBox(2, s.progress);\n    }\n    for (let s of bigStreaks) {\n      let maxOpacity = s.progress / 100;\n      ctx.setColor(s.color);\n      ctx.setOpacityFloat(Math.min(maxOpacity, s.opacity));\n      ctx.setScale(s.length, s.radius);\n      ctx.setTranslation(s.x, s.y);\n      ctx.drawTexturedBox(2, s.progress);\n    }\n    ctx.setOpacityFloat(1);\n    ctx.resetTransform();\n\n    // Stars\n    let starOffsetX = (now / 400) % canvas.width;\n    let starOffsetY = (now / 400) % canvas.height;\n    for (let s of stars) {\n      ctx.setColor(s.color);\n      ctx.setOpacityFloat(s.opacity);\n      ctx.setTextureImage(0, star);\n      let f = Math.sin((now / 500) * s.wiggleSpeed + s.wiggleOffset) + 1;\n      let x = (s.x + starOffsetX) % canvas.width;\n      let y = (s.y + starOffsetY) % canvas.height;\n      ctx.drawTexturedBox(\n        0,\n        x,\n        canvas.height - y,\n        16 * s.scale,\n        16 * s.scale + f * s.scale * 8\n      );\n    }\n    ctx.setOpacityFloat(1);\n\n    // Moon\n    ctx.setColor(STAR_COLORS[0]);\n    ctx.setTextureImage(3, circle);\n    ctx.drawTexturedBox(3, canvas.width * 0.66, 60);\n\n    // Cloud\n    ctx.setTextureImage(4, cloud);\n    let cloudOffsetY = -cloud.height / 2;\n    for (let c of clouds) {\n      let x = c.x + c.progress;\n      ctx.setColor(c.highlight);\n      ctx.setScale(c.w * 1.2, c.h * 1.2);\n      ctx.setTranslation(x, c.y);\n      let ratio = x / canvas.width;\n      ctx.drawTexturedBox(4, 10 * (-ratio * 2 + 1), cloudOffsetY);\n\n      ctx.setColor(c.lowlight);\n      ctx.setScale(c.w, c.h);\n      ctx.setTranslation(x, c.y);\n      ctx.drawTexturedBox(4, 0, cloudOffsetY);\n    }\n    ctx.resetTransform();\n\n    // Ground\n    ctx.setColor(0x726351);\n    ctx.drawRect(0, canvas.height - 100, canvas.width, canvas.height);\n\n    // Mountains\n    ctx.setColor(0xeed0ff);\n    ctx.setTextureImage(4, mountains);\n    ctx.drawTexturedBox(4, canvas.width / 2, canvas.height - 100);\n\n    /*\n    ctx.setColor(0xFFFFFF);\n    ctx.setTextureImage(2, blurStroke);\n    ctx.drawTexturedBox(2, 200, 100, 16, 16);\n\n    ctx.setColor(0x0000aa);\n    drawLineShapes(ctx);\n\n    ctx.setColor(0x00aa66);\n    drawFillShapes(ctx);\n\n    ctx.setTranslation(100, 100, 0);\n    ctx.setScale(2, 2);\n    ctx.setRotation(45);\n    ctx.setColor(0xffffff);\n    drawLineShapes(ctx);\n    drawFillShapes(ctx);\n    ctx.setTextureImage(0, image);\n    ctx.drawTexturedBox(0, 72, 32);\n    ctx.setColor(0xff0000);\n    ctx.setBMFontTexture(1, fontImage, fontData);\n    ctx.drawText(1, 'Do we need more donuts?', 100, 32);\n    ctx.resetTransform();\n\n    ctx.setColor(0xffffff);\n    ctx.setTextureImage(0, image);\n    ctx.drawTexturedBox(0, 72, 32);\n\n    ctx.setColor(0xff0000);\n    ctx.setBMFontTexture(1, fontImage, fontData);\n    ctx.drawText(1, 'Do we need more donuts?', 100, 32);\n\n    ctx.setColor(0xffffff);\n    */\n  });\n}\n\nfunction drawStreak(ctx, x, y, angle, radius, length) {\n  ctx.pushTransform();\n  ctx.setTranslation(x, y);\n  ctx.setRotation(angle);\n  ctx.setScale(1, length);\n  ctx.drawCircle(0, 0, radius);\n  ctx.popTransform();\n}\n\nfunction drawCapsule(ctx, x, y, radius, length) {\n  ctx.drawCircle(x - length, y, radius);\n  ctx.drawBox(x, y, length, radius);\n  ctx.drawCircle(x + length, y, radius);\n}\n\nfunction drawLineShapes(ctx) {\n  ctx.drawLine(16, 16);\n  ctx.drawLineBox(24, 32);\n  ctx.drawLineRect(16, 48, 40, 64);\n  ctx.drawLineCircle(24, 80);\n}\n\nfunction drawFillShapes(ctx) {\n  ctx.drawRay(40, 16);\n  ctx.drawBox(48, 32);\n  ctx.drawRect(48, 48, 56, 64);\n  ctx.drawCircle(48, 80);\n}\n", "import { KeyCodes, ButtonBinding } from '@milque/input';\n\nexport const Forward = new ButtonBinding('forward', [\n  KeyCodes.KEY_W,\n  KeyCodes.ARROW_UP,\n]);\nexport const Backward = new ButtonBinding('backward', [\n  KeyCodes.KEY_S,\n  KeyCodes.ARROW_DOWN,\n]);\nexport const RotateLeft = new ButtonBinding('rotateLeft', [\n  KeyCodes.KEY_A,\n  KeyCodes.ARROW_LEFT,\n]);\nexport const RotateRight = new ButtonBinding('rotateRight', [\n  KeyCodes.KEY_D,\n  KeyCodes.ARROW_RIGHT,\n]);\n\nexport const Fire = new ButtonBinding('fire', KeyCodes.SPACE);\nexport const Debug = new ButtonBinding('debug', KeyCodes.BACKQUOTE);\n", "import { Sound } from './Sound.js';\nimport { loadAudioBuffer } from '../loader/AudioBufferLoader.js';\n\nexport async function loadSound(src) {\n  let audioContext = Sound.getAudioContext();\n  let audioBuffer = await loadAudioBuffer(src, audioContext);\n  let sound = new Sound(audioContext, audioBuffer);\n  return sound;\n}\n", "import { AssetRef } from '@milque/asset';\nimport { loadSound } from '../../src/audio/SoundLoader.js';\n\nexport const SoundStart = new AssetRef(\n  'sound://start.wav',\n  undefined,\n  loadSound,\n  'res/start.wav'\n);\nexport const SoundDead = new AssetRef(\n  'sound://dead.wav',\n  undefined,\n  loadSound,\n  'res/dead.wav'\n);\nexport const SoundPop = new AssetRef(\n  'sound://pop.wav',\n  undefined,\n  loadSound,\n  'res/boop.wav'\n);\nexport const SoundShoot = new AssetRef(\n  'sound://shoot.wav',\n  undefined,\n  loadSound,\n  'res/click.wav'\n);\nexport const SoundBoom = new AssetRef(\n  'sound://boom.wav',\n  undefined,\n  loadSound,\n  'res/boom.wav'\n);\nexport const BackgroundMusic = new AssetRef(\n  'sound://music.wav',\n  undefined,\n  loadSound,\n  'res/music.wav'\n);\n\nexport async function loadAssetRefs(refs, assets) {\n  await Promise.all(refs.map(ref => ref.load(assets)));\n}\n", "import '@milque/display';\nimport { Random } from '@milque/random';\n\nimport * as Starfield from './Starfield.js';\nimport * as Inputs from './Inputs.js';\nimport * as Assets from './Assets.js';\n\ndocument.title = 'Starfield';\n\n/**\n * @param {import('../game/Game.js').Game} game\n */\nexport async function main(game) {\n  const { display, assets, inputs } = game;\n  const canvas = display.canvas;\n  const ctx = canvas.getContext('2d');\n  const mainScene = { load, start, update, render };\n\n  const PLAYER_RADIUS = 5;\n  const SMALL_ASTEROID_RADIUS = 4;\n  const ASTEROID_RADIUS = 8;\n  const ASTEROID_SPAWN_RANGES = [\n    [\n      -ASTEROID_RADIUS,\n      -ASTEROID_RADIUS,\n      ASTEROID_RADIUS * 2 + canvas.width,\n      ASTEROID_RADIUS,\n    ],\n    [-ASTEROID_RADIUS, 0, ASTEROID_RADIUS, canvas.height],\n    [\n      -ASTEROID_RADIUS,\n      canvas.height,\n      ASTEROID_RADIUS * 2 + canvas.width,\n      ASTEROID_RADIUS,\n    ],\n    [canvas.width, 0, ASTEROID_RADIUS, canvas.height],\n  ];\n  const ASTEROID_SPAWN_RATE = [3000, 10000];\n  const ASTEROID_SPAWN_INIT_COUNT = 1;\n  const MAX_ASTEROID_COUNT = 100;\n  const ASTEROID_SPEED = 1;\n  const BULLET_RADIUS = 2;\n  const BULLET_SPEED = 4;\n  const MAX_BULLET_AGE = 2000;\n  const MAX_BULLET_COUNT = 100;\n  const PLAYER_SHOOT_COOLDOWN = 10;\n  const PARTICLE_RADIUS = 4;\n  const PARTICLE_SPEED = 2;\n  const MAX_PARTICLE_AGE = 600;\n  const ASTEROID_BREAK_DAMP_FACTOR = 0.1;\n  const PLAYER_EXPLODE_PARTICLE_COLORS = [\n    'red',\n    'red',\n    'red',\n    'yellow',\n    'orange',\n  ];\n  const ASTEROID_EXPLODE_PARTICLE_COLORS = [\n    'blue',\n    'blue',\n    'blue',\n    'dodgerblue',\n    'gray',\n    'darkgray',\n    'yellow',\n  ];\n  const PLAYER_MOVE_PARTICLE_COLORS = ['gray', 'darkgray', 'lightgray'];\n  const INSTRUCTION_HINT_TEXT = '[ wasd_ ]';\n  const PLAYER_MOVE_PARTICLE_OFFSET_RANGE = [-2, 2];\n  const PLAYER_MOVE_PARTICLE_DAMP_FACTOR = 1.5;\n  const MIN_PLAYER_MOVE_PARTICLE_LIFE_RATIO = 0.1;\n  const MAX_PLAYER_MOVE_PARTICLE_LIFE_RATIO = 0.4;\n  const FLASH_TIME_STEP = 0.1;\n\n  const PLAYER_MOVE_SPEED = 0.02;\n  const PLAYER_ROT_SPEED = 0.008;\n  const PLAYER_ROT_FRICTION = 0.1;\n  const PLAYER_MOVE_FRICTION = 0.001;\n\n  const BULLET_COLOR = 'gold';\n\n  const POWER_UP_SPAWN_RATE = [10000, 30000];\n  const POWER_UP_RADIUS = 4;\n  const POWER_UP_EXPLODE_PARTICLE_COLORS = ['white', 'violet', 'violet'];\n  const POWER_UP_AMOUNT = 30;\n  const POWER_UP_SPAWN_CHANCE = 0.7;\n\n  let SHOW_COLLISION = false;\n\n  await mainScene.load();\n  mainScene.start();\n  display.addEventListener('frame', (e) => {\n    let { deltaTime } = e.detail;\n    mainScene.update(deltaTime);\n    mainScene.render(ctx);\n  });\n\n  async function load() {\n    console.log('Loading...');\n    inputs.bindBindings(Object.values(Inputs));\n    Assets.loadAssetRefs(Object.values(Assets), assets);\n    console.log('...loading complete!');\n  }\n\n  function start() {\n    this.level = 0;\n    this.score = 0;\n    this.highScore = Number(localStorage.getItem('highscore'));\n    this.flashScoreDelta = 0;\n    this.flashHighScoreDelta = 0;\n    this.flashShootDelta = 0;\n\n    this.player = {\n      scene: this,\n      x: canvas.width / 2,\n      y: canvas.height / 2,\n      rotation: 0,\n      dx: 0,\n      dy: 0,\n      dr: 0,\n      get left() {\n        return Inputs.RotateLeft.value;\n      },\n      get right() {\n        return Inputs.RotateRight.value;\n      },\n      get up() {\n        return Inputs.Forward.value;\n      },\n      get down() {\n        return Inputs.Backward.value;\n      },\n      get fire() {\n        return Inputs.Fire.value;\n      },\n      cooldown: 0,\n      powerMode: 0,\n      shoot() {\n        if (this.scene.bullets.length > MAX_BULLET_COUNT) return;\n        if (this.cooldown > 0) return;\n        if (this.powerMode > 0) {\n          for (let i = -1; i <= 1; ++i) {\n            let rotation = this.rotation + (i * Math.PI) / 4;\n            let bullet = createBullet(\n              this.scene,\n              this.x - Math.cos(rotation) * PLAYER_RADIUS,\n              this.y - Math.sin(rotation) * PLAYER_RADIUS,\n              -Math.cos(rotation) * BULLET_SPEED + this.dx,\n              -Math.sin(rotation) * BULLET_SPEED + this.dy\n            );\n            this.scene.bullets.push(bullet);\n          }\n          --this.powerMode;\n        } else {\n          let bullet = createBullet(\n            this.scene,\n            this.x - Math.cos(this.rotation) * PLAYER_RADIUS,\n            this.y - Math.sin(this.rotation) * PLAYER_RADIUS,\n            -Math.cos(this.rotation) * BULLET_SPEED + this.dx,\n            -Math.sin(this.rotation) * BULLET_SPEED + this.dy\n          );\n          this.scene.bullets.push(bullet);\n        }\n        this.cooldown = PLAYER_SHOOT_COOLDOWN;\n        Assets.SoundShoot.current.play();\n      },\n    };\n\n    this.asteroids = [];\n    this.asteroidSpawner = {\n      scene: this,\n      spawnTicks: ASTEROID_SPAWN_RATE[1],\n      reset() {\n        this.spawnTicks = ASTEROID_SPAWN_RATE[1];\n      },\n      spawn() {\n        if (this.scene.asteroids.length > MAX_ASTEROID_COUNT) return;\n        let spawnRange = Random.choose(ASTEROID_SPAWN_RANGES);\n        let asteroid = createAsteroid(\n          this.scene,\n          // X range\n          Random.range(spawnRange[0], spawnRange[0] + spawnRange[2]),\n          // Y range\n          Random.range(spawnRange[1], spawnRange[1] + spawnRange[3]),\n          Random.range(-ASTEROID_SPEED, ASTEROID_SPEED),\n          Random.range(-ASTEROID_SPEED, ASTEROID_SPEED),\n          ASTEROID_RADIUS\n        );\n        this.scene.asteroids.push(asteroid);\n      },\n      update(dt) {\n        if (!this.scene.gamePause) {\n          this.spawnTicks -= dt;\n          if (this.spawnTicks <= 0) {\n            this.spawn();\n            this.spawnTicks = Random.range(...ASTEROID_SPAWN_RATE);\n          }\n        }\n      },\n    };\n\n    this.bullets = [];\n    this.particles = [];\n\n    this.powerUps = [];\n    this.powerUpSpawner = {\n      scene: this,\n      reset() {\n        // Do nothing.\n      },\n      spawn() {\n        let spawnRange = Random.choose(ASTEROID_SPAWN_RANGES);\n        let powerUp = createPowerUp(\n          this.scene,\n          // X range\n          Random.range(spawnRange[0], spawnRange[0] + spawnRange[2]),\n          // Y range\n          Random.range(spawnRange[1], spawnRange[1] + spawnRange[3]),\n          Random.range(-ASTEROID_SPEED, ASTEROID_SPEED),\n          Random.range(-ASTEROID_SPEED, ASTEROID_SPEED)\n        );\n        this.scene.powerUps.push(powerUp);\n      },\n      update(dt) {\n        // Do nothing.\n      },\n    };\n\n    this.starfield = Starfield.createStarfield(canvas.width, canvas.height);\n\n    this.gamePause = true;\n    this.showPlayer = true;\n    this.gameStart = true;\n    this.gameWait = true;\n    this.hint = INSTRUCTION_HINT_TEXT;\n  }\n\n  /**\n   * @this {any}\n   * @param {number} dt The delta time spent on the previous frame.\n   */\n  function update(dt) {\n    if (Inputs.Debug.pressed) {\n      SHOW_COLLISION = !SHOW_COLLISION;\n    }\n    if (this.gameWait && inputs.isAnyButtonPressed()) {\n      if (this.gameStart) {\n        Assets.BackgroundMusic.current.play();\n        this.score = 0;\n        this.flashScore = true;\n        this.level = 0;\n        this.gameStart = false;\n        this.player.powerMode = 0;\n        this.powerUps.length = 0;\n        this.asteroidSpawner.reset();\n        this.powerUpSpawner.reset();\n      }\n      this.gameWait = false;\n      nextLevel(this);\n    }\n    if (this.gamePause) {\n      // Update particle motion\n      for (let particle of this.particles) {\n        particle.age += dt;\n        if (particle.age > MAX_PARTICLE_AGE) {\n          particle.destroy();\n        } else {\n          particle.x += particle.dx;\n          particle.y += particle.dy;\n\n          // Wrap around\n          wrapAround(particle, PARTICLE_RADIUS * 2, PARTICLE_RADIUS * 2);\n        }\n      }\n\n      return;\n    }\n\n    // Determine control\n    const rotControl = this.player.right - this.player.left;\n    const moveControl = this.player.down - this.player.up;\n    const fireControl = this.player.fire;\n\n    // Calculate velocity\n    this.player.dx +=\n      moveControl * Math.cos(this.player.rotation) * PLAYER_MOVE_SPEED;\n    this.player.dy +=\n      moveControl * Math.sin(this.player.rotation) * PLAYER_MOVE_SPEED;\n    this.player.dx *= 1 - PLAYER_MOVE_FRICTION;\n    this.player.dy *= 1 - PLAYER_MOVE_FRICTION;\n\n    // Calculate angular velocity\n    this.player.dr += rotControl * PLAYER_ROT_SPEED;\n    this.player.dr *= 1 - PLAYER_ROT_FRICTION;\n\n    // Calculate position\n    this.player.x += this.player.dx;\n    this.player.y += this.player.dy;\n    this.player.rotation += this.player.dr;\n\n    --this.player.cooldown;\n\n    // Wrap around\n    wrapAround(this.player, PLAYER_RADIUS * 2, PLAYER_RADIUS * 2);\n\n    // Whether to fire a bullet\n    if (fireControl) {\n      this.player.shoot();\n      this.flashShootDelta = 1;\n    }\n\n    // Whether to spawn thruster particles\n    if (moveControl) {\n      thrust(\n        this,\n        this.player.x,\n        this.player.y,\n        -moveControl *\n          Math.cos(this.player.rotation) *\n          PLAYER_MOVE_PARTICLE_DAMP_FACTOR,\n        -moveControl *\n          Math.sin(this.player.rotation) *\n          PLAYER_MOVE_PARTICLE_DAMP_FACTOR,\n        Random.choose.bind(null, PLAYER_MOVE_PARTICLE_COLORS)\n      );\n    }\n\n    // Update bullet motion\n    for (let bullet of this.bullets) {\n      bullet.age += dt;\n      if (bullet.age > MAX_BULLET_AGE) {\n        bullet.destroy();\n      } else {\n        bullet.x += bullet.dx;\n        bullet.y += bullet.dy;\n\n        // Wrap around\n        wrapAround(bullet, BULLET_RADIUS * 2, BULLET_RADIUS * 2);\n      }\n    }\n\n    // Update bullet collision\n    for (let bullet of this.bullets) {\n      for (let asteroid of this.asteroids) {\n        if (withinRadius(bullet, asteroid, asteroid.size)) {\n          this.flashScore = 1;\n          this.score++;\n          if (this.score > this.highScore) {\n            this.flashHighScore = this.score - this.highScore;\n            this.highScore = this.score;\n            localStorage.setItem('highscore', this.highScore);\n          }\n          explode(\n            this,\n            asteroid.x,\n            asteroid.y,\n            10,\n            Random.choose.bind(null, ASTEROID_EXPLODE_PARTICLE_COLORS)\n          );\n          Assets.SoundPop.current.play();\n          bullet.destroy();\n          asteroid.breakUp(\n            bullet.dx * ASTEROID_BREAK_DAMP_FACTOR,\n            bullet.dy * ASTEROID_BREAK_DAMP_FACTOR\n          );\n          break;\n        }\n      }\n    }\n\n    // Update particle motion\n    for (let particle of this.particles) {\n      particle.age += dt;\n      if (particle.age > MAX_PARTICLE_AGE) {\n        particle.destroy();\n      } else {\n        particle.x += particle.dx;\n        particle.y += particle.dy;\n\n        // Wrap around\n        wrapAround(particle, PARTICLE_RADIUS * 2, PARTICLE_RADIUS * 2);\n      }\n    }\n\n    // Update asteroid motion\n    for (let asteroid of this.asteroids) {\n      asteroid.x += asteroid.dx;\n      asteroid.y += asteroid.dy;\n\n      // Wrap around\n      wrapAround(asteroid, asteroid.size * 2, asteroid.size * 2);\n    }\n\n    // Update asteroid collision\n    for (let asteroid of this.asteroids) {\n      if (withinRadius(asteroid, this.player, asteroid.size + PLAYER_RADIUS)) {\n        explode(\n          this,\n          asteroid.x,\n          asteroid.y,\n          10,\n          Random.choose.bind(null, ASTEROID_EXPLODE_PARTICLE_COLORS)\n        );\n        asteroid.destroy();\n        killPlayer(this);\n        break;\n      }\n    }\n\n    // Update power-up motion\n    for (let powerUp of this.powerUps) {\n      powerUp.x += powerUp.dx;\n      powerUp.y += powerUp.dy;\n\n      // Wrap around\n      wrapAround(powerUp, POWER_UP_RADIUS * 2, POWER_UP_RADIUS * 2);\n    }\n\n    // Update power-up collision\n    for (let powerUp of this.powerUps) {\n      if (withinRadius(powerUp, this.player, POWER_UP_RADIUS + PLAYER_RADIUS)) {\n        explode(\n          this,\n          powerUp.x,\n          powerUp.y,\n          10,\n          Random.choose.bind(null, POWER_UP_EXPLODE_PARTICLE_COLORS)\n        );\n        powerUp.destroy();\n        this.player.powerMode += POWER_UP_AMOUNT;\n        break;\n      }\n    }\n\n    // Update starfield\n    Starfield.updateStarfield(this.starfield);\n\n    // Update spawner\n    this.asteroidSpawner.update(dt);\n    this.powerUpSpawner.update(dt);\n\n    if (!this.gamePause && this.asteroids.length <= 0) {\n      this.gamePause = true;\n      this.showPlayer = true;\n      Assets.SoundStart.current.play();\n      setTimeout(() => (this.gameWait = true), 1000);\n    }\n  }\n\n  function drawAsteroid(ctx, asteroid) {\n    ctx.translate(asteroid.x, asteroid.y);\n    ctx.rotate(asteroid.rotation);\n    ctx.fillStyle = 'slategray';\n    ctx.fillRect(\n      -asteroid.size,\n      -asteroid.size,\n      asteroid.size * 2,\n      asteroid.size * 2\n    );\n    ctx.setTransform(1, 0, 0, 1, 0, 0);\n  }\n\n  function drawPowerUp(ctx, powerUp) {\n    ctx.translate(powerUp.x, powerUp.y);\n    ctx.rotate(powerUp.rotation);\n    ctx.beginPath();\n    ctx.strokeStyle = 'violet';\n    ctx.arc(0, 0, POWER_UP_RADIUS, 0, Math.PI * 2);\n    ctx.moveTo(-POWER_UP_RADIUS / 2, 0);\n    ctx.lineTo(POWER_UP_RADIUS / 2, 0);\n    ctx.moveTo(0, -POWER_UP_RADIUS / 2);\n    ctx.lineTo(0, POWER_UP_RADIUS / 2);\n    ctx.stroke();\n    ctx.setTransform(1, 0, 0, 1, 0, 0);\n  }\n\n  function drawBullet(ctx, bullet) {\n    ctx.translate(bullet.x, bullet.y);\n    ctx.rotate(bullet.rotation);\n    ctx.fillStyle = BULLET_COLOR;\n    ctx.fillRect(\n      -BULLET_RADIUS,\n      -BULLET_RADIUS,\n      BULLET_RADIUS * 4,\n      BULLET_RADIUS * 2\n    );\n    ctx.setTransform(1, 0, 0, 1, 0, 0);\n  }\n\n  function drawParticle(ctx, particle) {\n    ctx.translate(particle.x, particle.y);\n    ctx.rotate(particle.rotation);\n    ctx.fillStyle = particle.color;\n    let size = PARTICLE_RADIUS * (1 - particle.age / MAX_PARTICLE_AGE);\n    ctx.fillRect(-size, -size, size * 2, size * 2);\n    ctx.setTransform(1, 0, 0, 1, 0, 0);\n  }\n\n  function render(ctx) {\n    // Draw background\n    ctx.fillStyle = 'black';\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n    // Draw starfield\n    Starfield.renderStarfield(ctx, this.starfield);\n\n    // Draw hint\n    ctx.fillStyle = 'rgba(255, 255, 255, 0.2)';\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n    ctx.font = '16px sans-serif';\n    ctx.fillText(this.hint, canvas.width / 2, canvas.height / 2 - 32);\n\n    // Draw score\n    if (this.flashScore > 0) {\n      ctx.fillStyle = `rgba(255, 255, 255, ${this.flashScore + 0.2})`;\n      this.flashScore -= FLASH_TIME_STEP;\n    } else {\n      ctx.fillStyle = 'rgba(255, 255, 255, 0.2)';\n    }\n    ctx.font = '48px sans-serif';\n    ctx.fillText(\n      '= ' + String(this.score).padStart(2, '0') + ' =',\n      canvas.width / 2,\n      canvas.height / 2\n    );\n    if (this.flashHighScore > 0) {\n      ctx.fillStyle = `rgba(255, 255, 255, ${this.flashHighScore + 0.2})`;\n      this.flashHighScore -= FLASH_TIME_STEP;\n    } else {\n      ctx.fillStyle = 'rgba(255, 255, 255, 0.2)';\n    }\n    ctx.font = '16px sans-serif';\n    ctx.fillText(\n      String(this.highScore).padStart(2, '0'),\n      canvas.width / 2,\n      canvas.height / 2 + 32\n    );\n\n    // Draw timer\n    ctx.fillStyle = 'rgba(255, 255, 255, 0.2)';\n    ctx.font = '24px sans-serif';\n    ctx.textAlign = 'right';\n    ctx.fillText(\n      Math.ceil(this.asteroidSpawner.spawnTicks / 1000),\n      canvas.width,\n      canvas.height - 12\n    );\n\n    // Draw asteroid\n    for (let asteroid of this.asteroids) {\n      drawAsteroid(ctx, asteroid);\n      drawCollisionCircle(ctx, asteroid.x, asteroid.y, asteroid.size);\n    }\n\n    // Draw power-up\n    for (let powerUp of this.powerUps) {\n      drawPowerUp(ctx, powerUp);\n      drawCollisionCircle(ctx, powerUp.x, powerUp.y, POWER_UP_RADIUS);\n    }\n\n    // Draw bullet\n    for (let bullet of this.bullets) {\n      drawBullet(ctx, bullet);\n      drawCollisionCircle(ctx, bullet.x, bullet.y, BULLET_RADIUS);\n    }\n\n    // Draw particle\n    for (let particle of this.particles) {\n      drawParticle(ctx, particle);\n    }\n\n    // Draw player\n    if (this.showPlayer) {\n      ctx.translate(this.player.x, this.player.y);\n      ctx.rotate(this.player.rotation);\n      ctx.fillStyle = 'white';\n      let size = PLAYER_RADIUS;\n      ctx.fillRect(-size, -size, size * 2, size * 2);\n      let xOffset = -1;\n      let yOffset = 0;\n      let sizeOffset = 0;\n      if (this.flashShootDelta > 0) {\n        ctx.fillStyle = `rgb(${\n          200 * this.flashShootDelta +\n          55 * Math.sin(performance.now() / (PLAYER_SHOOT_COOLDOWN * 2))\n        }, 0, 0)`;\n        this.flashShootDelta -= FLASH_TIME_STEP;\n        sizeOffset = this.flashShootDelta * 2;\n        xOffset = this.flashShootDelta;\n      } else {\n        ctx.fillStyle = 'black';\n      }\n      ctx.fillRect(\n        -size - sizeOffset / 2 + xOffset,\n        -(size / 4) - sizeOffset / 2 + yOffset,\n        size + sizeOffset,\n        size / 2 + sizeOffset\n      );\n      ctx.setTransform(1, 0, 0, 1, 0, 0);\n    }\n\n    drawCollisionCircle(ctx, this.player.x, this.player.y, PLAYER_RADIUS);\n  }\n\n  function wrapAround(position, width, height) {\n    if (position.x < -width) position.x = canvas.width;\n    if (position.y < -height) position.y = canvas.height;\n    if (position.x > canvas.width + width / 2) position.x = -width;\n    if (position.y > canvas.height + height / 2) position.y = -height;\n  }\n\n  function withinRadius(from, to, radius) {\n    const dx = from.x - to.x;\n    const dy = from.y - to.y;\n    return dx * dx + dy * dy <= radius * radius;\n  }\n\n  function drawCollisionCircle(ctx, x, y, radius) {\n    if (!SHOW_COLLISION) return;\n    ctx.translate(x, y);\n    ctx.beginPath();\n    ctx.arc(0, 0, radius, 0, Math.PI * 2);\n    ctx.strokeStyle = 'lime';\n    ctx.stroke();\n    ctx.setTransform(1, 0, 0, 1, 0, 0);\n  }\n\n  function createPowerUp(scene, x, y, dx, dy) {\n    return {\n      scene,\n      x,\n      y,\n      dx,\n      dy,\n      rotation: Math.atan2(dy, dx),\n      destroy() {\n        this.scene.powerUps.splice(this.scene.powerUps.indexOf(this), 1);\n      },\n    };\n  }\n\n  function createAsteroid(scene, x, y, dx, dy, size) {\n    return {\n      scene,\n      x,\n      y,\n      dx,\n      dy,\n      size,\n      rotation: Math.atan2(dy, dx),\n      breakUp(dx = 0, dy = 0) {\n        this.destroy();\n        if (this.size > SMALL_ASTEROID_RADIUS) {\n          let children = [];\n          children.push(\n            createAsteroid(\n              this.scene,\n              this.x + Random.range(-ASTEROID_RADIUS, ASTEROID_RADIUS),\n              this.y + Random.range(-ASTEROID_RADIUS, ASTEROID_RADIUS),\n              Random.range(-ASTEROID_SPEED, ASTEROID_SPEED) + dx,\n              Random.range(-ASTEROID_SPEED, ASTEROID_SPEED) + dy,\n              SMALL_ASTEROID_RADIUS\n            )\n          );\n          children.push(\n            createAsteroid(\n              this.scene,\n              this.x + Random.range(-ASTEROID_RADIUS, ASTEROID_RADIUS),\n              this.y + Random.range(-ASTEROID_RADIUS, ASTEROID_RADIUS),\n              Random.range(-ASTEROID_SPEED, ASTEROID_SPEED) + dx,\n              Random.range(-ASTEROID_SPEED, ASTEROID_SPEED) + dy,\n              SMALL_ASTEROID_RADIUS\n            )\n          );\n          children.push(\n            createAsteroid(\n              this.scene,\n              this.x + Random.range(-ASTEROID_RADIUS, ASTEROID_RADIUS),\n              this.y + Random.range(-ASTEROID_RADIUS, ASTEROID_RADIUS),\n              Random.range(-ASTEROID_SPEED, ASTEROID_SPEED) + dx,\n              Random.range(-ASTEROID_SPEED, ASTEROID_SPEED) + dy,\n              SMALL_ASTEROID_RADIUS\n            )\n          );\n          children.push(\n            createAsteroid(\n              this.scene,\n              this.x + Random.range(-ASTEROID_RADIUS, ASTEROID_RADIUS),\n              this.y + Random.range(-ASTEROID_RADIUS, ASTEROID_RADIUS),\n              Random.range(-ASTEROID_SPEED, ASTEROID_SPEED) + dx,\n              Random.range(-ASTEROID_SPEED, ASTEROID_SPEED) + dy,\n              SMALL_ASTEROID_RADIUS\n            )\n          );\n          this.scene.asteroids.push(...children);\n        }\n      },\n      destroy() {\n        this.scene.asteroids.splice(this.scene.asteroids.indexOf(this), 1);\n      },\n    };\n  }\n\n  function createBullet(scene, x, y, dx, dy) {\n    return {\n      scene,\n      x,\n      y,\n      dx,\n      dy,\n      rotation: Math.atan2(dy, dx),\n      age: 0,\n      destroy() {\n        this.scene.bullets.splice(this.scene.bullets.indexOf(this), 1);\n      },\n    };\n  }\n\n  function createParticle(scene, x, y, dx, dy, color) {\n    if (typeof color === 'function') color = color.call(null);\n    return {\n      scene,\n      x,\n      y,\n      dx,\n      dy,\n      rotation: Math.atan2(dy, dx),\n      age: 0,\n      color,\n      destroy() {\n        this.scene.particles.splice(this.scene.particles.indexOf(this), 1);\n      },\n    };\n  }\n\n  function nextLevel(scene) {\n    scene.bullets.length = 0;\n    scene.asteroids.length = 0;\n    scene.particles.length = 0;\n    scene.player.x = canvas.width / 2;\n    scene.player.y = canvas.height / 2;\n    scene.player.dx = 0;\n    scene.player.dy = 0;\n    scene.level++;\n    scene.gamePause = false;\n    scene.showPlayer = true;\n\n    for (let i = 0; i < ASTEROID_SPAWN_INIT_COUNT * scene.level; ++i) {\n      scene.asteroidSpawner.spawn();\n    }\n\n    if (Random.next() > POWER_UP_SPAWN_CHANCE) {\n      scene.powerUpSpawner.spawn();\n    }\n\n    let music = Assets.BackgroundMusic.current;\n    if (!music.isPlaying()) {\n      music.play({ loop: true });\n    }\n  }\n\n  function killPlayer(scene) {\n    scene.gamePause = true;\n    scene.showPlayer = false;\n    explode(\n      scene,\n      scene.player.x,\n      scene.player.y,\n      100,\n      Random.choose.bind(null, PLAYER_EXPLODE_PARTICLE_COLORS)\n    );\n    Assets.SoundDead.current.play();\n    Assets.SoundBoom.current.play();\n    setTimeout(() => (scene.gameStart = scene.gameWait = true), 1000);\n  }\n\n  function thrust(scene, x, y, dx, dy, color) {\n    if (Random.next() > 0.3) {\n      let particle = createParticle(\n        scene,\n        x + Random.range(...PLAYER_MOVE_PARTICLE_OFFSET_RANGE),\n        y + Random.range(...PLAYER_MOVE_PARTICLE_OFFSET_RANGE),\n        dx,\n        dy,\n        color\n      );\n      particle.age = Random.range(\n        MAX_PARTICLE_AGE * MIN_PLAYER_MOVE_PARTICLE_LIFE_RATIO,\n        MAX_PARTICLE_AGE * MAX_PLAYER_MOVE_PARTICLE_LIFE_RATIO\n      );\n      scene.particles.push(particle);\n    }\n  }\n\n  function explode(scene, x, y, amount = 10, color) {\n    for (let i = 0; i < amount; ++i) {\n      scene.particles.push(\n        createParticle(\n          scene,\n          x,\n          y,\n          Random.range(-1, 1) * PARTICLE_SPEED,\n          Random.range(-1, 1) * PARTICLE_SPEED,\n          color\n        )\n      );\n    }\n  }\n}\n", "import '@milque/display';\nimport '@milque/input';\nimport './error.js';\n\nimport { AssetManager, cacheAssetPackAsRaw, ImageLoader } from '@milque/asset';\nimport { AssetPipeline } from './loader/AssetPipeline.js';\n\nimport { Game } from './game/Game.js';\nimport { loadOBJ } from './loader/OBJLoader.js';\nimport { loadAtlas } from './loader/AtlasLoader.js';\nimport { loadAudioBuffer } from './loader/AudioBufferLoader.js';\nimport { loadBMFont } from './loader/BMFontLoader.js';\nimport { loadText } from './loader/TextLoader.js';\nimport { Sound } from './audio/Sound.js';\n\n// eslint-disable-next-line no-unused-vars\nimport { main as Archaea } from './000/main.js';\n// eslint-disable-next-line no-unused-vars\nimport { main as Architect } from './001/main.js';\n// eslint-disable-next-line no-unused-vars\nimport { main as Bioform } from './002/main.js';\n// eslint-disable-next-line no-unused-vars\nimport { main as IsoGame } from './042/main.js';\n// eslint-disable-next-line no-unused-vars\nimport { main as GerryMan } from './043/main.js';\n// eslint-disable-next-line no-unused-vars\nimport { main as BreadBox } from './044/main.js';\n// eslint-disable-next-line no-unused-vars\nimport { main as Moonset } from './046/main.js';\n// eslint-disable-next-line no-unused-vars\nimport { main as Starfield } from './047/main.js';\n\n/**\n * @typedef {import('@milque/display').DisplayPort} DisplayPort\n * @typedef {import('@milque/input').InputContext} InputContext\n */\n\nwindow.addEventListener('DOMContentLoaded', main);\nasync function main() {\n  /** @type {DisplayPort} */\n  const display = document.querySelector('#display');\n  /** @type {InputContext} */\n  const inputs = /** @type {import('@milque/input').InputPort} */ (document.querySelector('#inputs')).getContext('axisbutton');\n  const assets = new AssetManager();\n  const pipeline = new AssetPipeline(assets);\n  await cacheAssetPackAsRaw(assets, 'res.pack', (src, uri, path) => assets.cache('res/' + path, src));\n  await pipeline.pipe('res/**/*.md', async (assetData, uri) =>\n    this.asset.cache('txt:' + uri.substring(4), await loadText(assetData))\n  );\n  await pipeline.pipe('res/**/*.txt', async (assetData, uri) =>\n    this.asset.cache('txt:' + uri.substring(4), await loadText(assetData))\n  );\n  await pipeline.pipe('res/**/*.png', async (assetData, uri) =>\n    this.asset.cache(\n      'image:' + uri.substring(4),\n      await ImageLoader(assetData, { imageType: 'image/png' }),\n    )\n  );\n  await pipeline.pipe('res/**/*.obj', async (assetData, uri) =>\n    this.asset.cache('obj:' + uri.substring(4), await loadOBJ(assetData))\n  );\n  await pipeline.pipe('res/**/*.atlas', async (assetData, uri) =>\n    this.asset.cache('atlas:' + uri.substring(4), await loadAtlas(assetData))\n  );\n  await pipeline.pipe('res/**/*.fnt', async (assetData, uri) =>\n    this.asset.cache('fnt:' + uri.substring(4), await loadBMFont(assetData))\n  );\n  await pipeline.pipe('res/**/*.wav', async (assetData, uri) => {\n    let audioContext = Sound.getAudioContext();\n    let audioBuffer = await loadAudioBuffer(assetData, audioContext);\n    let sound = new Sound(audioContext, audioBuffer);\n    return this.assets.cache('sound:' + uri.substring(4), sound);\n  });\n\n  const game = new Game(display, inputs);\n  display.addEventListener('frame', (/** @type {CustomEvent} */ e) => {\n    const { deltaTime, prevTime, now } = e.detail;\n    game.deltaTime = deltaTime;\n    game.prevTime = prevTime;\n    game.now = now;\n    inputs.poll(now);\n    game.emit('frame');\n  });\n\n  // await Archaea(game);\n  // await Architect(game);\n  // await Bioform(game);\n  // await IsoGame(game);\n  // await BreadBox(game);\n  // await GerryMan(game);\n  // await Miners(game);\n  await Moonset(game);\n  // await Starfield(game);\n}\n"],
  "mappings": "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",
  "names": []
}
