!function(){"use strict";class t extends HTMLElement{static get[Symbol.for("cuttleTemplate")](){let t=document.createElement("template");return t.innerHTML='<fieldset>\n    <legend>Console</legend>\n    <output></output>\n    <button id="scrollTop" class="scrollButton hidden">Scroll to Top</button>\n    <button id="scrollBottom" class="scrollButton hidden">Scroll to Bottom</button>\n    <div class="inputContainer">\n        <span>&gt;&nbsp;</span><input>\n    </div>\n</fieldset>\n',Object.defineProperty(this,Symbol.for("cuttleTemplate"),{value:t}),t}static get[Symbol.for("cuttleStyle")](){let t=document.createElement("style");return t.innerHTML=":host{display:block;height:12rem}fieldset{display:flex;flex-direction:column;position:relative;padding:.5em;font-family:monospace;background-color:#eee;height:inherit}fieldset,output{overflow-x:hidden}output{flex:1;display:block;overflow-y:auto;height:100%}p,pre{margin:0}input{flex:1;font-family:monospace;border:none;outline-color:currentColor;background-color:transparent;color:currentColor}.inputContainer{display:flex;margin-top:.5em}#scrollTop{top:2em}#scrollBottom{bottom:3.5em}.scrollButton{font-family:monospace;font-size:.5em;position:absolute;padding:.5em;left:0;right:0;margin-left:auto;margin-right:auto;border-radius:1em;border:none;outline-color:currentColor;background-color:#ccc;color:currentColor;opacity:1;transition:opacity .3s ease}.hidden{opacity:0}",Object.defineProperty(this,Symbol.for("cuttleStyle"),{value:t}),t}static get customEvents(){return["input","command","autocomplete"]}get onautocomplete(){return this._onautocomplete}set onautocomplete(t){this._onautocomplete&&this.removeEventListener("autocomplete",this._onautocomplete),this._onautocomplete=t,this._onautocomplete&&this.addEventListener("autocomplete",t)}get oncommand(){return this._oncommand}set oncommand(t){this._oncommand&&this.removeEventListener("command",this._oncommand),this._oncommand=t,this._oncommand&&this.addEventListener("command",t)}get oninput(){return this._oninput}set oninput(t){this._oninput&&this.removeEventListener("input",this._oninput),this._oninput=t,this._oninput&&this.addEventListener("input",t)}constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("cuttleTemplate")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("cuttleStyle")].cloneNode(!0)),this._inputElement=this.shadowRoot.querySelector("input"),this._outputElement=this.shadowRoot.querySelector("output"),this._scrollTopElement=this.shadowRoot.querySelector("#scrollTop"),this._scrollBottomElement=this.shadowRoot.querySelector("#scrollBottom"),this._autoscroll=!0,this._prevscroll=0,this.onInputChange=this.onInputChange.bind(this),this.onInputKeyDown=this.onInputKeyDown.bind(this),this.onOutputScroll=this.onOutputScroll.bind(this),this.onScrollTopClick=this.onScrollTopClick.bind(this),this.onScrollBottomClick=this.onScrollBottomClick.bind(this),this._inputElement.addEventListener("input",this.onInputChange),this._inputElement.addEventListener("keydown",this.onInputKeyDown),this._outputElement.addEventListener("scroll",this.onOutputScroll),this._scrollTopElement.addEventListener("click",this.onScrollTopClick),this._scrollBottomElement.addEventListener("click",this.onScrollBottomClick)}newline(t=""){const e=document.createElement("p"),o=document.createElement("pre");o.innerHTML=t.trim()||"&nbsp;",e.appendChild(o),this._outputElement.appendChild(e),this._autoscroll&&this._outputElement.scrollTo(0,this._outputElement.scrollHeight)}clear(){this._outputElement.innerHTML=""}onInputChange(t){const e=t.target,o=e.value,n=t.data;this.dispatchEvent(new CustomEvent("input",{composed:!0,bubbles:!1,detail:{target:e,value:o,data:n}}))}onInputKeyDown(t){if("Enter"===t.key){const e=t.target,o=e.value;return t.target.value="",this.dispatchEvent(new CustomEvent("command",{composed:!0,bubbles:!1,detail:{target:e,value:o}})),t.preventDefault(),t.stopPropagation(),!1}if("Tab"===t.key){const e=t.target,o=e.value;return this.dispatchEvent(new CustomEvent("autocomplete",{composed:!0,bubbles:!1,detail:{target:e,value:o}})),t.preventDefault(),t.stopPropagation(),!1}}onOutputScroll(t){const e=t.target,o=e.scrollTop,n=e.scrollHeight-e.clientHeight,l=o/n;let i=l-this._prevscroll>0,s=l>=1;this._prevscroll=l,this._autoscroll=s;let c=o<300||o>n-300;this._scrollTopElement.classList.toggle("hidden",s||c||i),this._scrollBottomElement.classList.toggle("hidden",s||c||!i)}onScrollTopClick(){this._outputElement.scrollTo({top:0,behavior:"smooth"})}onScrollBottomClick(){this._outputElement.scrollTo(0,this._outputElement.scrollHeight)}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"oninput")){let t=this.oninput;delete this.oninput,this.oninput=t}if(Object.prototype.hasOwnProperty.call(this,"oncommand")){let t=this.oncommand;delete this.oncommand,this.oncommand=t}if(Object.prototype.hasOwnProperty.call(this,"onautocomplete")){let t=this.onautocomplete;delete this.onautocomplete,this.onautocomplete=t}}static get observedAttributes(){return["oninput","oncommand","onautocomplete"]}attributeChangedCallback(t,e,o){switch(t){case"oninput":this.oninput=new Function("event","with(document){with(this){"+o+"}}").bind(this);break;case"oncommand":this.oncommand=new Function("event","with(document){with(this){"+o+"}}").bind(this);break;case"onautocomplete":this.onautocomplete=new Function("event","with(document){with(this){"+o+"}}").bind(this)}}}function e(t,e){document.querySelector("console-view").addEventListener("command",(o=>{const n=o.detail.value;if(n){const l=n.trim().split(" ");if(l.length>0&&t===l[0])return e(l.slice(1)),o.preventDefault(),o.stopPropagation(),!1}}))}function o(t){document.querySelector("console-view").newline(t)}window.customElements.define("console-view",t),window.addEventListener("DOMContentLoaded",(async function(){o("You wake up in a dungeon."),o("There is a door to the north."),o("There is nothing else."),o(),o("What do you do?"),o("- north"),o("- west"),o("- south"),o("- east"),o(),o("- use"),o("- drop"),e("clear",(()=>{document.querySelector("console-view").clear()})),e("north",(()=>o("hello"))),e("west",(()=>o("hello"))),e("south",(()=>o("hello"))),e("east",(()=>o("hello"))),e("help",(()=>o("hello")))}))}();
