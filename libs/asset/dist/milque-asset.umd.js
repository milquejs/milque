!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).milque=e.milque||{},e.milque.asset={}))}(this,(function(e){"use strict";function t(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var r=function e(){if(this instanceof e){var r=[null];return r.push.apply(r,arguments),new(Function.bind.apply(t,r))}return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})})),r}var r={},n={get exports(){return r},set exports(e){r=e}};function o(e,t){for(var r=0,n=e.length-1;n>=0;n--){var o=e[n];"."===o?e.splice(n,1):".."===o?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}var s=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,a=function(e){return s.exec(e).slice(1)};function u(){for(var e="",t=!1,r=arguments.length-1;r>=-1&&!t;r--){var n=r>=0?arguments[r]:"/";if("string"!=typeof n)throw new TypeError("Arguments to path.resolve must be strings");n&&(e=n+"/"+e,t="/"===n.charAt(0))}return(t?"/":"")+(e=o(d(e.split("/"),(function(e){return!!e})),!t).join("/"))||"."}function i(e){var t=l(e),r="/"===A(e,-1);return(e=o(d(e.split("/"),(function(e){return!!e})),!t).join("/"))||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e}function l(e){return"/"===e.charAt(0)}function c(){return i(d(Array.prototype.slice.call(arguments,0),(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))}function p(e,t){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=u(e).substr(1),t=u(t).substr(1);for(var n=r(e.split("/")),o=r(t.split("/")),s=Math.min(n.length,o.length),a=s,i=0;i<s;i++)if(n[i]!==o[i]){a=i;break}var l=[];for(i=a;i<n.length;i++)l.push("..");return(l=l.concat(o.slice(a))).join("/")}function f(e){var t=a(e),r=t[0],n=t[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."}function h(e,t){var r=a(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r}function g(e){return a(e)[3]}var b={extname:g,basename:h,dirname:f,sep:"/",delimiter:":",relative:p,join:c,isAbsolute:l,normalize:i,resolve:u};function d(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}var A="b"==="ab".substr(-1)?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)},y=t(Object.freeze({__proto__:null,basename:h,default:b,delimiter:":",dirname:f,extname:g,isAbsolute:l,join:c,normalize:i,relative:p,resolve:u,sep:"/"})),v={};const _=y,m="\\\\/",R=`[^${m}]`,E="\\.",x="\\/",w="[^/]",C=`(?:${x}|$)`,S=`(?:^|${x})`,$=`${E}{1,2}${C}`,N={DOT_LITERAL:E,PLUS_LITERAL:"\\+",QMARK_LITERAL:"\\?",SLASH_LITERAL:x,ONE_CHAR:"(?=.)",QMARK:w,END_ANCHOR:C,DOTS_SLASH:$,NO_DOT:`(?!${E})`,NO_DOTS:`(?!${S}${$})`,NO_DOT_SLASH:`(?!${E}{0,1}${C})`,NO_DOTS_SLASH:`(?!${$})`,QMARK_NO_DOT:`[^.${x}]`,STAR:`${w}*?`,START_ANCHOR:S},H={...N,SLASH_LITERAL:`[${m}]`,QMARK:R,STAR:`${R}*?`,DOTS_SLASH:`${E}{1,2}(?:[${m}]|$)`,NO_DOT:`(?!${E})`,NO_DOTS:`(?!(?:^|[${m}])${E}{1,2}(?:[${m}]|$))`,NO_DOT_SLASH:`(?!${E}{0,1}(?:[${m}]|$))`,NO_DOTS_SLASH:`(?!${E}{1,2}(?:[${m}]|$))`,QMARK_NO_DOT:`[^.${m}]`,START_ANCHOR:`(?:^|[${m}])`,END_ANCHOR:`(?:[${m}]|$)`};var T={MAX_LENGTH:65536,POSIX_REGEX_SOURCE:{alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"},REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:_.sep,extglobChars:e=>({"!":{type:"negate",open:"(?:(?!(?:",close:`))${e.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}),globChars:e=>!0===e?H:N};!function(e){const t=y,r="win32"===process.platform,{REGEX_BACKSLASH:n,REGEX_REMOVE_BACKSLASH:o,REGEX_SPECIAL_CHARS:s,REGEX_SPECIAL_CHARS_GLOBAL:a}=T;e.isObject=e=>null!==e&&"object"==typeof e&&!Array.isArray(e),e.hasRegexChars=e=>s.test(e),e.isRegexChar=t=>1===t.length&&e.hasRegexChars(t),e.escapeRegex=e=>e.replace(a,"\\$1"),e.toPosixSlashes=e=>e.replace(n,"/"),e.removeBackslashes=e=>e.replace(o,(e=>"\\"===e?"":e)),e.supportsLookbehinds=()=>{const e=process.version.slice(1).split(".").map(Number);return 3===e.length&&e[0]>=9||8===e[0]&&e[1]>=10},e.isWindows=e=>e&&"boolean"==typeof e.windows?e.windows:!0===r||"\\"===t.sep,e.escapeLast=(t,r,n)=>{const o=t.lastIndexOf(r,n);return-1===o?t:"\\"===t[o-1]?e.escapeLast(t,r,o-1):`${t.slice(0,o)}\\${t.slice(o)}`},e.removePrefix=(e,t={})=>{let r=e;return r.startsWith("./")&&(r=r.slice(2),t.prefix="./"),r},e.wrapOutput=(e,t={},r={})=>{let n=`${r.contains?"":"^"}(?:${e})${r.contains?"":"$"}`;return!0===t.negated&&(n=`(?:^(?!${n}).*$)`),n}}(v);const k=v,{CHAR_ASTERISK:L,CHAR_AT:O,CHAR_BACKWARD_SLASH:I,CHAR_COMMA:B,CHAR_DOT:M,CHAR_EXCLAMATION_MARK:P,CHAR_FORWARD_SLASH:D,CHAR_LEFT_CURLY_BRACE:G,CHAR_LEFT_PARENTHESES:j,CHAR_LEFT_SQUARE_BRACKET:U,CHAR_PLUS:F,CHAR_QUESTION_MARK:K,CHAR_RIGHT_CURLY_BRACE:X,CHAR_RIGHT_PARENTHESES:W,CHAR_RIGHT_SQUARE_BRACKET:Q}=T,q=e=>e===D||e===I,z=e=>{!0!==e.isPrefix&&(e.depth=e.isGlobstar?1/0:1)};var V=(e,t)=>{const r=t||{},n=e.length-1,o=!0===r.parts||!0===r.scanToEnd,s=[],a=[],u=[];let i,l,c=e,p=-1,f=0,h=0,g=!1,b=!1,d=!1,A=!1,y=!1,v=!1,_=!1,m=!1,R=!1,E=!1,x=0,w={value:"",depth:0,isGlob:!1};const C=()=>p>=n,S=()=>(i=l,c.charCodeAt(++p));for(;p<n;){let e;if(l=S(),l!==I){if(!0===v||l===G){for(x++;!0!==C()&&(l=S());)if(l!==I)if(l!==G){if(!0!==v&&l===M&&(l=S())===M){if(g=w.isBrace=!0,d=w.isGlob=!0,E=!0,!0===o)continue;break}if(!0!==v&&l===B){if(g=w.isBrace=!0,d=w.isGlob=!0,E=!0,!0===o)continue;break}if(l===X&&(x--,0===x)){v=!1,g=w.isBrace=!0,E=!0;break}}else x++;else _=w.backslashes=!0,S();if(!0===o)continue;break}if(l!==D){if(!0!==r.noext){if(!0===(l===F||l===O||l===L||l===K||l===P)&&c.charCodeAt(p+1)===j){if(d=w.isGlob=!0,A=w.isExtglob=!0,E=!0,l===P&&p===f&&(R=!0),!0===o){for(;!0!==C()&&(l=S());)if(l!==I){if(l===W){d=w.isGlob=!0,E=!0;break}}else _=w.backslashes=!0,l=S();continue}break}}if(l===L){if(i===L&&(y=w.isGlobstar=!0),d=w.isGlob=!0,E=!0,!0===o)continue;break}if(l===K){if(d=w.isGlob=!0,E=!0,!0===o)continue;break}if(l===U){for(;!0!==C()&&(e=S());)if(e!==I){if(e===Q){b=w.isBracket=!0,d=w.isGlob=!0,E=!0;break}}else _=w.backslashes=!0,S();if(!0===o)continue;break}if(!0===r.nonegate||l!==P||p!==f){if(!0!==r.noparen&&l===j){if(d=w.isGlob=!0,!0===o){for(;!0!==C()&&(l=S());)if(l!==j){if(l===W){E=!0;break}}else _=w.backslashes=!0,l=S();continue}break}if(!0===d){if(E=!0,!0===o)continue;break}}else m=w.negated=!0,f++}else{if(s.push(p),a.push(w),w={value:"",depth:0,isGlob:!1},!0===E)continue;if(i===M&&p===f+1){f+=2;continue}h=p+1}}else _=w.backslashes=!0,l=S(),l===G&&(v=!0)}!0===r.noext&&(A=!1,d=!1);let $=c,N="",H="";f>0&&(N=c.slice(0,f),c=c.slice(f),h-=f),$&&!0===d&&h>0?($=c.slice(0,h),H=c.slice(h)):!0===d?($="",H=c):$=c,$&&""!==$&&"/"!==$&&$!==c&&q($.charCodeAt($.length-1))&&($=$.slice(0,-1)),!0===r.unescape&&(H&&(H=k.removeBackslashes(H)),$&&!0===_&&($=k.removeBackslashes($)));const T={prefix:N,input:e,start:f,base:$,glob:H,isBrace:g,isBracket:b,isGlob:d,isExtglob:A,isGlobstar:y,negated:m,negatedExtglob:R};if(!0===r.tokens&&(T.maxDepth=0,q(l)||a.push(w),T.tokens=a),!0===r.parts||!0===r.tokens){let t;for(let n=0;n<s.length;n++){const o=t?t+1:f,i=s[n],l=e.slice(o,i);r.tokens&&(0===n&&0!==f?(a[n].isPrefix=!0,a[n].value=N):a[n].value=l,z(a[n]),T.maxDepth+=a[n].depth),0===n&&""===l||u.push(l),t=i}if(t&&t+1<e.length){const n=e.slice(t+1);u.push(n),r.tokens&&(a[a.length-1].value=n,z(a[a.length-1]),T.maxDepth+=a[a.length-1].depth)}T.slashes=s,T.parts=u}return T};const Y=T,Z=v,{MAX_LENGTH:J,POSIX_REGEX_SOURCE:ee,REGEX_NON_SPECIAL_CHARS:te,REGEX_SPECIAL_CHARS_BACKREF:re,REPLACEMENTS:ne}=Y,oe=(e,t)=>{if("function"==typeof t.expandRange)return t.expandRange(...e,t);e.sort();const r=`[${e.join("-")}]`;try{new RegExp(r)}catch(t){return e.map((e=>Z.escapeRegex(e))).join("..")}return r},se=(e,t)=>`Missing ${e}: "${t}" - use "\\\\${t}" to match literal characters`,ae=(e,t)=>{if("string"!=typeof e)throw new TypeError("Expected a string");e=ne[e]||e;const r={...t},n="number"==typeof r.maxLength?Math.min(J,r.maxLength):J;let o=e.length;if(o>n)throw new SyntaxError(`Input length: ${o}, exceeds maximum allowed length: ${n}`);const s={type:"bos",value:"",output:r.prepend||""},a=[s],u=r.capture?"":"?:",i=Z.isWindows(t),l=Y.globChars(i),c=Y.extglobChars(l),{DOT_LITERAL:p,PLUS_LITERAL:f,SLASH_LITERAL:h,ONE_CHAR:g,DOTS_SLASH:b,NO_DOT:d,NO_DOT_SLASH:A,NO_DOTS_SLASH:y,QMARK:v,QMARK_NO_DOT:_,STAR:m,START_ANCHOR:R}=l,E=e=>`(${u}(?:(?!${R}${e.dot?b:p}).)*?)`,x=r.dot?"":d,w=r.dot?v:_;let C=!0===r.bash?E(r):m;r.capture&&(C=`(${C})`),"boolean"==typeof r.noext&&(r.noextglob=r.noext);const S={input:e,index:-1,start:0,dot:!0===r.dot,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:a};e=Z.removePrefix(e,S),o=e.length;const $=[],N=[],H=[];let T,k=s;const L=()=>S.index===o-1,O=S.peek=(t=1)=>e[S.index+t],I=S.advance=()=>e[++S.index]||"",B=()=>e.slice(S.index+1),M=(e="",t=0)=>{S.consumed+=e,S.index+=t},P=e=>{S.output+=null!=e.output?e.output:e.value,M(e.value)},D=()=>{let e=1;for(;"!"===O()&&("("!==O(2)||"?"===O(3));)I(),S.start++,e++;return e%2!=0&&(S.negated=!0,S.start++,!0)},G=e=>{S[e]++,H.push(e)},j=e=>{S[e]--,H.pop()},U=e=>{if("globstar"===k.type){const t=S.braces>0&&("comma"===e.type||"brace"===e.type),r=!0===e.extglob||$.length&&("pipe"===e.type||"paren"===e.type);"slash"===e.type||"paren"===e.type||t||r||(S.output=S.output.slice(0,-k.output.length),k.type="star",k.value="*",k.output=C,S.output+=k.output)}if($.length&&"paren"!==e.type&&($[$.length-1].inner+=e.value),(e.value||e.output)&&P(e),k&&"text"===k.type&&"text"===e.type)return k.value+=e.value,void(k.output=(k.output||"")+e.value);e.prev=k,a.push(e),k=e},F=(e,t)=>{const n={...c[t],conditions:1,inner:""};n.prev=k,n.parens=S.parens,n.output=S.output;const o=(r.capture?"(":"")+n.open;G("parens"),U({type:e,value:t,output:S.output?"":g}),U({type:"paren",extglob:!0,value:I(),output:o}),$.push(n)},K=e=>{let n,o=e.close+(r.capture?")":"");if("negate"===e.type){let s=C;if(e.inner&&e.inner.length>1&&e.inner.includes("/")&&(s=E(r)),(s!==C||L()||/^\)+$/.test(B()))&&(o=e.close=`)$))${s}`),e.inner.includes("*")&&(n=B())&&/^\.[^\\/.]+$/.test(n)){const r=ae(n,{...t,fastpaths:!1}).output;o=e.close=`)${r})${s})`}"bos"===e.prev.type&&(S.negatedExtglob=!0)}U({type:"paren",extglob:!0,value:T,output:o}),j("parens")};if(!1!==r.fastpaths&&!/(^[*!]|[/()[\]{}"])/.test(e)){let n=!1,o=e.replace(re,((e,t,r,o,s,a)=>"\\"===o?(n=!0,e):"?"===o?t?t+o+(s?v.repeat(s.length):""):0===a?w+(s?v.repeat(s.length):""):v.repeat(r.length):"."===o?p.repeat(r.length):"*"===o?t?t+o+(s?C:""):C:t?e:`\\${e}`));return!0===n&&(o=!0===r.unescape?o.replace(/\\/g,""):o.replace(/\\+/g,(e=>e.length%2==0?"\\\\":e?"\\":""))),o===e&&!0===r.contains?(S.output=e,S):(S.output=Z.wrapOutput(o,S,t),S)}for(;!L();){if(T=I(),"\0"===T)continue;if("\\"===T){const e=O();if("/"===e&&!0!==r.bash)continue;if("."===e||";"===e)continue;if(!e){T+="\\",U({type:"text",value:T});continue}const t=/^\\+/.exec(B());let n=0;if(t&&t[0].length>2&&(n=t[0].length,S.index+=n,n%2!=0&&(T+="\\")),!0===r.unescape?T=I():T+=I(),0===S.brackets){U({type:"text",value:T});continue}}if(S.brackets>0&&("]"!==T||"["===k.value||"[^"===k.value)){if(!1!==r.posix&&":"===T){const e=k.value.slice(1);if(e.includes("[")&&(k.posix=!0,e.includes(":"))){const e=k.value.lastIndexOf("["),t=k.value.slice(0,e),r=k.value.slice(e+2),n=ee[r];if(n){k.value=t+n,S.backtrack=!0,I(),s.output||1!==a.indexOf(k)||(s.output=g);continue}}}("["===T&&":"!==O()||"-"===T&&"]"===O())&&(T=`\\${T}`),"]"!==T||"["!==k.value&&"[^"!==k.value||(T=`\\${T}`),!0===r.posix&&"!"===T&&"["===k.value&&(T="^"),k.value+=T,P({value:T});continue}if(1===S.quotes&&'"'!==T){T=Z.escapeRegex(T),k.value+=T,P({value:T});continue}if('"'===T){S.quotes=1===S.quotes?0:1,!0===r.keepQuotes&&U({type:"text",value:T});continue}if("("===T){G("parens"),U({type:"paren",value:T});continue}if(")"===T){if(0===S.parens&&!0===r.strictBrackets)throw new SyntaxError(se("opening","("));const e=$[$.length-1];if(e&&S.parens===e.parens+1){K($.pop());continue}U({type:"paren",value:T,output:S.parens?")":"\\)"}),j("parens");continue}if("["===T){if(!0!==r.nobracket&&B().includes("]"))G("brackets");else{if(!0!==r.nobracket&&!0===r.strictBrackets)throw new SyntaxError(se("closing","]"));T=`\\${T}`}U({type:"bracket",value:T});continue}if("]"===T){if(!0===r.nobracket||k&&"bracket"===k.type&&1===k.value.length){U({type:"text",value:T,output:`\\${T}`});continue}if(0===S.brackets){if(!0===r.strictBrackets)throw new SyntaxError(se("opening","["));U({type:"text",value:T,output:`\\${T}`});continue}j("brackets");const e=k.value.slice(1);if(!0===k.posix||"^"!==e[0]||e.includes("/")||(T=`/${T}`),k.value+=T,P({value:T}),!1===r.literalBrackets||Z.hasRegexChars(e))continue;const t=Z.escapeRegex(k.value);if(S.output=S.output.slice(0,-k.value.length),!0===r.literalBrackets){S.output+=t,k.value=t;continue}k.value=`(${u}${t}|${k.value})`,S.output+=k.value;continue}if("{"===T&&!0!==r.nobrace){G("braces");const e={type:"brace",value:T,output:"(",outputIndex:S.output.length,tokensIndex:S.tokens.length};N.push(e),U(e);continue}if("}"===T){const e=N[N.length-1];if(!0===r.nobrace||!e){U({type:"text",value:T,output:T});continue}let t=")";if(!0===e.dots){const e=a.slice(),n=[];for(let t=e.length-1;t>=0&&(a.pop(),"brace"!==e[t].type);t--)"dots"!==e[t].type&&n.unshift(e[t].value);t=oe(n,r),S.backtrack=!0}if(!0!==e.comma&&!0!==e.dots){const r=S.output.slice(0,e.outputIndex),n=S.tokens.slice(e.tokensIndex);e.value=e.output="\\{",T=t="\\}",S.output=r;for(const e of n)S.output+=e.output||e.value}U({type:"brace",value:T,output:t}),j("braces"),N.pop();continue}if("|"===T){$.length>0&&$[$.length-1].conditions++,U({type:"text",value:T});continue}if(","===T){let e=T;const t=N[N.length-1];t&&"braces"===H[H.length-1]&&(t.comma=!0,e="|"),U({type:"comma",value:T,output:e});continue}if("/"===T){if("dot"===k.type&&S.index===S.start+1){S.start=S.index+1,S.consumed="",S.output="",a.pop(),k=s;continue}U({type:"slash",value:T,output:h});continue}if("."===T){if(S.braces>0&&"dot"===k.type){"."===k.value&&(k.output=p);const e=N[N.length-1];k.type="dots",k.output+=T,k.value+=T,e.dots=!0;continue}if(S.braces+S.parens===0&&"bos"!==k.type&&"slash"!==k.type){U({type:"text",value:T,output:p});continue}U({type:"dot",value:T,output:p});continue}if("?"===T){if(!(k&&"("===k.value)&&!0!==r.noextglob&&"("===O()&&"?"!==O(2)){F("qmark",T);continue}if(k&&"paren"===k.type){const e=O();let t=T;if("<"===e&&!Z.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");("("===k.value&&!/[!=<:]/.test(e)||"<"===e&&!/<([!=]|\w+>)/.test(B()))&&(t=`\\${T}`),U({type:"text",value:T,output:t});continue}if(!0!==r.dot&&("slash"===k.type||"bos"===k.type)){U({type:"qmark",value:T,output:_});continue}U({type:"qmark",value:T,output:v});continue}if("!"===T){if(!0!==r.noextglob&&"("===O()&&("?"!==O(2)||!/[!=<:]/.test(O(3)))){F("negate",T);continue}if(!0!==r.nonegate&&0===S.index){D();continue}}if("+"===T){if(!0!==r.noextglob&&"("===O()&&"?"!==O(2)){F("plus",T);continue}if(k&&"("===k.value||!1===r.regex){U({type:"plus",value:T,output:f});continue}if(k&&("bracket"===k.type||"paren"===k.type||"brace"===k.type)||S.parens>0){U({type:"plus",value:T});continue}U({type:"plus",value:f});continue}if("@"===T){if(!0!==r.noextglob&&"("===O()&&"?"!==O(2)){U({type:"at",extglob:!0,value:T,output:""});continue}U({type:"text",value:T});continue}if("*"!==T){"$"!==T&&"^"!==T||(T=`\\${T}`);const e=te.exec(B());e&&(T+=e[0],S.index+=e[0].length),U({type:"text",value:T});continue}if(k&&("globstar"===k.type||!0===k.star)){k.type="star",k.star=!0,k.value+=T,k.output=C,S.backtrack=!0,S.globstar=!0,M(T);continue}let t=B();if(!0!==r.noextglob&&/^\([^?]/.test(t)){F("star",T);continue}if("star"===k.type){if(!0===r.noglobstar){M(T);continue}const n=k.prev,o=n.prev,s="slash"===n.type||"bos"===n.type,a=o&&("star"===o.type||"globstar"===o.type);if(!0===r.bash&&(!s||t[0]&&"/"!==t[0])){U({type:"star",value:T,output:""});continue}const u=S.braces>0&&("comma"===n.type||"brace"===n.type),i=$.length&&("pipe"===n.type||"paren"===n.type);if(!s&&"paren"!==n.type&&!u&&!i){U({type:"star",value:T,output:""});continue}for(;"/**"===t.slice(0,3);){const r=e[S.index+4];if(r&&"/"!==r)break;t=t.slice(3),M("/**",3)}if("bos"===n.type&&L()){k.type="globstar",k.value+=T,k.output=E(r),S.output=k.output,S.globstar=!0,M(T);continue}if("slash"===n.type&&"bos"!==n.prev.type&&!a&&L()){S.output=S.output.slice(0,-(n.output+k.output).length),n.output=`(?:${n.output}`,k.type="globstar",k.output=E(r)+(r.strictSlashes?")":"|$)"),k.value+=T,S.globstar=!0,S.output+=n.output+k.output,M(T);continue}if("slash"===n.type&&"bos"!==n.prev.type&&"/"===t[0]){const e=void 0!==t[1]?"|$":"";S.output=S.output.slice(0,-(n.output+k.output).length),n.output=`(?:${n.output}`,k.type="globstar",k.output=`${E(r)}${h}|${h}${e})`,k.value+=T,S.output+=n.output+k.output,S.globstar=!0,M(T+I()),U({type:"slash",value:"/",output:""});continue}if("bos"===n.type&&"/"===t[0]){k.type="globstar",k.value+=T,k.output=`(?:^|${h}|${E(r)}${h})`,S.output=k.output,S.globstar=!0,M(T+I()),U({type:"slash",value:"/",output:""});continue}S.output=S.output.slice(0,-k.output.length),k.type="globstar",k.output=E(r),k.value+=T,S.output+=k.output,S.globstar=!0,M(T);continue}const n={type:"star",value:T,output:C};!0!==r.bash?!k||"bracket"!==k.type&&"paren"!==k.type||!0!==r.regex?(S.index!==S.start&&"slash"!==k.type&&"dot"!==k.type||("dot"===k.type?(S.output+=A,k.output+=A):!0===r.dot?(S.output+=y,k.output+=y):(S.output+=x,k.output+=x),"*"!==O()&&(S.output+=g,k.output+=g)),U(n)):(n.output=T,U(n)):(n.output=".*?","bos"!==k.type&&"slash"!==k.type||(n.output=x+n.output),U(n))}for(;S.brackets>0;){if(!0===r.strictBrackets)throw new SyntaxError(se("closing","]"));S.output=Z.escapeLast(S.output,"["),j("brackets")}for(;S.parens>0;){if(!0===r.strictBrackets)throw new SyntaxError(se("closing",")"));S.output=Z.escapeLast(S.output,"("),j("parens")}for(;S.braces>0;){if(!0===r.strictBrackets)throw new SyntaxError(se("closing","}"));S.output=Z.escapeLast(S.output,"{"),j("braces")}if(!0===r.strictSlashes||"star"!==k.type&&"bracket"!==k.type||U({type:"maybe_slash",value:"",output:`${h}?`}),!0===S.backtrack){S.output="";for(const e of S.tokens)S.output+=null!=e.output?e.output:e.value,e.suffix&&(S.output+=e.suffix)}return S};ae.fastpaths=(e,t)=>{const r={...t},n="number"==typeof r.maxLength?Math.min(J,r.maxLength):J,o=e.length;if(o>n)throw new SyntaxError(`Input length: ${o}, exceeds maximum allowed length: ${n}`);e=ne[e]||e;const s=Z.isWindows(t),{DOT_LITERAL:a,SLASH_LITERAL:u,ONE_CHAR:i,DOTS_SLASH:l,NO_DOT:c,NO_DOTS:p,NO_DOTS_SLASH:f,STAR:h,START_ANCHOR:g}=Y.globChars(s),b=r.dot?p:c,d=r.dot?f:c,A=r.capture?"":"?:";let y=!0===r.bash?".*?":h;r.capture&&(y=`(${y})`);const v=e=>!0===e.noglobstar?y:`(${A}(?:(?!${g}${e.dot?l:a}).)*?)`,_=e=>{switch(e){case"*":return`${b}${i}${y}`;case".*":return`${a}${i}${y}`;case"*.*":return`${b}${y}${a}${i}${y}`;case"*/*":return`${b}${y}${u}${i}${d}${y}`;case"**":return b+v(r);case"**/*":return`(?:${b}${v(r)}${u})?${d}${i}${y}`;case"**/*.*":return`(?:${b}${v(r)}${u})?${d}${y}${a}${i}${y}`;case"**/.*":return`(?:${b}${v(r)}${u})?${a}${i}${y}`;default:{const t=/^(.*?)\.(\w+)$/.exec(e);if(!t)return;const r=_(t[1]);if(!r)return;return r+a+t[2]}}},m=Z.removePrefix(e,{negated:!1,prefix:""});let R=_(m);return R&&!0!==r.strictSlashes&&(R+=`${u}?`),R};const ue=y,ie=V,le=ae,ce=v,pe=T,fe=(e,t,r=!1)=>{if(Array.isArray(e)){const n=e.map((e=>fe(e,t,r))),o=e=>{for(const t of n){const r=t(e);if(r)return r}return!1};return o}const n=(o=e)&&"object"==typeof o&&!Array.isArray(o)&&e.tokens&&e.input;var o;if(""===e||"string"!=typeof e&&!n)throw new TypeError("Expected pattern to be a non-empty string");const s=t||{},a=ce.isWindows(t),u=n?fe.compileRe(e,t):fe.makeRe(e,t,!1,!0),i=u.state;delete u.state;let l=()=>!1;if(s.ignore){const e={...t,ignore:null,onMatch:null,onResult:null};l=fe(s.ignore,e,r)}const c=(r,n=!1)=>{const{isMatch:o,match:c,output:p}=fe.test(r,u,t,{glob:e,posix:a}),f={glob:e,state:i,regex:u,posix:a,input:r,output:p,match:c,isMatch:o};return"function"==typeof s.onResult&&s.onResult(f),!1===o?(f.isMatch=!1,!!n&&f):l(r)?("function"==typeof s.onIgnore&&s.onIgnore(f),f.isMatch=!1,!!n&&f):("function"==typeof s.onMatch&&s.onMatch(f),!n||f)};return r&&(c.state=i),c};fe.test=(e,t,r,{glob:n,posix:o}={})=>{if("string"!=typeof e)throw new TypeError("Expected input to be a string");if(""===e)return{isMatch:!1,output:""};const s=r||{},a=s.format||(o?ce.toPosixSlashes:null);let u=e===n,i=u&&a?a(e):e;return!1===u&&(i=a?a(e):e,u=i===n),!1!==u&&!0!==s.capture||(u=!0===s.matchBase||!0===s.basename?fe.matchBase(e,t,r,o):t.exec(i)),{isMatch:Boolean(u),match:u,output:i}},fe.matchBase=(e,t,r,n=ce.isWindows(r))=>(t instanceof RegExp?t:fe.makeRe(t,r)).test(ue.basename(e)),fe.isMatch=(e,t,r)=>fe(t,r)(e),fe.parse=(e,t)=>Array.isArray(e)?e.map((e=>fe.parse(e,t))):le(e,{...t,fastpaths:!1}),fe.scan=(e,t)=>ie(e,t),fe.compileRe=(e,t,r=!1,n=!1)=>{if(!0===r)return e.output;const o=t||{},s=o.contains?"":"^",a=o.contains?"":"$";let u=`${s}(?:${e.output})${a}`;e&&!0===e.negated&&(u=`^(?!${u}).*$`);const i=fe.toRegex(u,t);return!0===n&&(i.state=e),i},fe.makeRe=(e,t={},r=!1,n=!1)=>{if(!e||"string"!=typeof e)throw new TypeError("Expected a non-empty string");let o={negated:!1,fastpaths:!0};return!1===t.fastpaths||"."!==e[0]&&"*"!==e[0]||(o.output=le.fastpaths(e,t)),o.output||(o=le(e,t)),fe.compileRe(o,t,r,n)},fe.toRegex=(e,t)=>{try{const r=t||{};return new RegExp(e,r.flags||(r.nocase?"i":""))}catch(e){if(t&&!0===t.debug)throw e;return/$^/}},fe.constants=pe;var he=fe;!function(e){e.exports=he}(n);class ge{constructor(e){let t;t="object"==typeof e&&e instanceof ge?e.source:String(e),this.source=t,this._re=r.makeRe(t)}test(e){return this._re.test(e)}}var be={},de=Uint8Array,Ae=Uint16Array,ye=Uint32Array,ve=new de([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),_e=new de([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),me=new de([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Re=function(e,t){for(var r=new Ae(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];var o=new ye(r[30]);for(n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)o[s]=s-r[n]<<5|n;return[r,o]},Ee=Re(ve,2),xe=Ee[0],we=Ee[1];xe[28]=258,we[258]=28;for(var Ce=Re(_e,0)[0],Se=new Ae(32768),$e=0;$e<32768;++$e){var Ne=(43690&$e)>>>1|(21845&$e)<<1;Ne=(61680&(Ne=(52428&Ne)>>>2|(13107&Ne)<<2))>>>4|(3855&Ne)<<4,Se[$e]=((65280&Ne)>>>8|(255&Ne)<<8)>>>1}var He=function(e,t,r){for(var n=e.length,o=0,s=new Ae(t);o<n;++o)e[o]&&++s[e[o]-1];var a,u=new Ae(t);for(o=0;o<t;++o)u[o]=u[o-1]+s[o-1]<<1;if(r){a=new Ae(1<<t);var i=15-t;for(o=0;o<n;++o)if(e[o])for(var l=o<<4|e[o],c=t-e[o],p=u[e[o]-1]++<<c,f=p|(1<<c)-1;p<=f;++p)a[Se[p]>>>i]=l}else for(a=new Ae(n),o=0;o<n;++o)e[o]&&(a[o]=Se[u[e[o]-1]++]>>>15-e[o]);return a},Te=new de(288);for($e=0;$e<144;++$e)Te[$e]=8;for($e=144;$e<256;++$e)Te[$e]=9;for($e=256;$e<280;++$e)Te[$e]=7;for($e=280;$e<288;++$e)Te[$e]=8;var ke=new de(32);for($e=0;$e<32;++$e)ke[$e]=5;var Le=He(Te,9,1),Oe=He(ke,5,1),Ie=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},Be=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(7&t)&r},Me=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(7&t)},Pe=function(e){return(e+7)/8|0},De=function(e,t,r){(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length);var n=new(2==e.BYTES_PER_ELEMENT?Ae:4==e.BYTES_PER_ELEMENT?ye:de)(r-t);return n.set(e.subarray(t,r)),n},Ge=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],je=function(e,t,r){var n=new Error(t||Ge[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,je),!r)throw n;return n},Ue=function(e,t,r){var n=e.length;if(!n||r&&r.f&&!r.l)return t||new de(0);var o=!t||r,s=!r||r.i;r||(r={}),t||(t=new de(3*n));var a=function(e){var r=t.length;if(e>r){var n=new de(Math.max(2*r,e));n.set(t),t=n}},u=r.f||0,i=r.p||0,l=r.b||0,c=r.l,p=r.d,f=r.m,h=r.n,g=8*n;do{if(!c){u=Be(e,i,1);var b=Be(e,i+1,3);if(i+=3,!b){var d=e[(S=Pe(i)+4)-4]|e[S-3]<<8,A=S+d;if(A>n){s&&je(0);break}o&&a(l+d),t.set(e.subarray(S,A),l),r.b=l+=d,r.p=i=8*A,r.f=u;continue}if(1==b)c=Le,p=Oe,f=9,h=5;else if(2==b){var y=Be(e,i,31)+257,v=Be(e,i+10,15)+4,_=y+Be(e,i+5,31)+1;i+=14;for(var m=new de(_),R=new de(19),E=0;E<v;++E)R[me[E]]=Be(e,i+3*E,7);i+=3*v;var x=Ie(R),w=(1<<x)-1,C=He(R,x,1);for(E=0;E<_;){var S,$=C[Be(e,i,w)];if(i+=15&$,(S=$>>>4)<16)m[E++]=S;else{var N=0,H=0;for(16==S?(H=3+Be(e,i,3),i+=2,N=m[E-1]):17==S?(H=3+Be(e,i,7),i+=3):18==S&&(H=11+Be(e,i,127),i+=7);H--;)m[E++]=N}}var T=m.subarray(0,y),k=m.subarray(y);f=Ie(T),h=Ie(k),c=He(T,f,1),p=He(k,h,1)}else je(1);if(i>g){s&&je(0);break}}o&&a(l+131072);for(var L=(1<<f)-1,O=(1<<h)-1,I=i;;I=i){var B=(N=c[Me(e,i)&L])>>>4;if((i+=15&N)>g){s&&je(0);break}if(N||je(2),B<256)t[l++]=B;else{if(256==B){I=i,c=null;break}var M=B-254;if(B>264){var P=ve[E=B-257];M=Be(e,i,(1<<P)-1)+xe[E],i+=P}var D=p[Me(e,i)&O],G=D>>>4;D||je(3),i+=15&D;k=Ce[G];if(G>3){P=_e[G];k+=Me(e,i)&(1<<P)-1,i+=P}if(i>g){s&&je(0);break}o&&a(l+131072);for(var j=l+M;l<j;l+=4)t[l]=t[l-k],t[l+1]=t[l+1-k],t[l+2]=t[l+2-k],t[l+3]=t[l+3-k];l=j}}r.l=c,r.p=I,r.b=l,r.f=u,c&&(u=1,r.m=f,r.d=p,r.n=h)}while(!u);return l==t.length?t:De(t,0,l)},Fe=new de(0),Ke=function(e,t,r){for(var n=e(),o=e.toString(),s=o.slice(o.indexOf("[")+1,o.lastIndexOf("]")).replace(/\s+/g,"").split(","),a=0;a<n.length;++a){var u=n[a],i=s[a];if("function"==typeof u){t+=";"+i+"=";var l=u.toString();if(u.prototype)if(-1!=l.indexOf("[native code]")){var c=l.indexOf(" ",8)+1;t+=l.slice(c,l.indexOf("(",c))}else for(var p in t+=l,u.prototype)t+=";"+i+".prototype."+p+"="+u.prototype[p].toString();else t+=l}else r[i]=u}return[t,r]},Xe=[],We=function(e,t,r,n){var o;if(!Xe[r]){for(var s="",a={},u=e.length-1,i=0;i<u;++i)s=(o=Ke(e[i],s,a))[0],a=o[1];Xe[r]=Ke(e[u],s,a)}var l=function(e,t){var r={};for(var n in e)r[n]=e[n];for(var n in t)r[n]=t[n];return r}({},Xe[r][1]);return function(e,t,r,n,o){var s=new Worker(be[t]||(be[t]=URL.createObjectURL(new Blob([e+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return s.onmessage=function(e){var t=e.data,r=t.$e$;if(r){var n=new Error(r[0]);n.code=r[1],n.stack=r[2],o(n,null)}else o(null,t)},s.postMessage(r,n),s}(Xe[r][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",r,l,function(e){var t=[];for(var r in e)e[r].buffer&&t.push((e[r]=new e[r].constructor(e[r])).buffer);return t}(l),n)},Qe=function(){return[de,Ae,ye,ve,_e,me,xe,Ce,Le,Oe,Se,Ge,He,Ie,Be,Me,Pe,De,je,Ue,et,qe,ze]},qe=function(e){return postMessage(e,[e.buffer])},ze=function(e){return e&&e.size&&new de(e.size)},Ve=function(e,t,r,n,o,s){var a=We(r,n,o,(function(e,t){a.terminate(),s(e,t)}));return a.postMessage([e,t],t.consume?[e.buffer]:[]),function(){a.terminate()}},Ye=function(e,t){return e[t]|e[t+1]<<8},Ze=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0},Je=function(e,t){return Ze(e,t)+4294967296*Ze(e,t+4)};function et(e,t){return Ue(e,t)}var tt="undefined"!=typeof TextDecoder&&new TextDecoder;try{tt.decode(Fe,{stream:!0}),1}catch(e){}var rt=function(e){for(var t="",r=0;;){var n=e[r++],o=(n>127)+(n>223)+(n>239);if(r+o>e.length)return[t,De(e,r-1)];o?3==o?(n=((15&n)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536,t+=String.fromCharCode(55296|n>>10,56320|1023&n)):t+=1&o?String.fromCharCode((31&n)<<6|63&e[r++]):String.fromCharCode((15&n)<<12|(63&e[r++])<<6|63&e[r++]):t+=String.fromCharCode(n)}};var nt=function(e,t){return t+30+Ye(e,t+26)+Ye(e,t+28)},ot=function(e,t,r){var n=Ye(e,t+28),o=function(e,t){if(t){for(var r="",n=0;n<e.length;n+=16384)r+=String.fromCharCode.apply(null,e.subarray(n,n+16384));return r}if(tt)return tt.decode(e);var o=rt(e),s=o[0];return o[1].length&&je(8),s}(e.subarray(t+46,t+46+n),!(2048&Ye(e,t+8))),s=t+46+n,a=Ze(e,t+20),u=r&&4294967295==a?st(e,s):[a,Ze(e,t+24),Ze(e,t+42)],i=u[0],l=u[1],c=u[2];return[Ye(e,t+10),i,l,o,s+Ye(e,t+30)+Ye(e,t+32),c]},st=function(e,t){for(;1!=Ye(e,t);t+=4+Ye(e,t+2));return[Je(e,t+12),Je(e,t+4),Je(e,t+20)]},at="function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout?setTimeout:function(e){e()};function ut(e,t,r){r||(r=t,t={}),"function"!=typeof r&&je(7);var n=[],o=function(){for(var e=0;e<n.length;++e)n[e]()},s={},a=function(e,t){at((function(){r(e,t)}))};at((function(){a=r}));for(var u=e.length-22;101010256!=Ze(e,u);--u)if(!u||e.length-u>65558)return a(je(13,0,1),null),o;var i=Ye(e,u+8);if(i){var l=i,c=Ze(e,u+16),p=4294967295==c||65535==l;if(p){var f=Ze(e,u-12);(p=101075792==Ze(e,f))&&(l=i=Ze(e,f+32),c=Ze(e,f+48))}for(var h=t&&t.filter,g=function(t){var r=ot(e,c,p),u=r[0],l=r[1],f=r[2],g=r[3],b=r[4],d=r[5],A=nt(e,d);c=b;var y=function(e,t){e?(o(),a(e,null)):(t&&(s[g]=t),--i||a(null,s))};if(!h||h({name:g,size:l,originalSize:f,compression:u}))if(u)if(8==u){var v=e.subarray(A,A+l);if(l<32e4)try{y(null,et(v,new de(f)))}catch(e){y(e,null)}else n.push(function(e,t,r){return r||(r=t,t={}),"function"!=typeof r&&je(7),Ve(e,t,[Qe],(function(e){return qe(et(e.data[0],ze(e.data[1])))}),1,r)}(v,{size:f},y))}else y(je(14,"unknown compression type "+u,1),null);else y(null,De(e,A,A+l));else y(null,null)},b=0;b<l;++b)g()}else a(null,{});return o}const it=/^([_\w\d]+)\:\/\//;async function lt(e,t,r,n,o,s){const{loadings:a}=e;let u;t in a?u=a[t]:(u=new dt(s),a[t]=u);const i=dt.nextAttempt(u);let l=[u.promise];return it.test(r)?l.push(pt(e,r,s).then((e=>n(e,o))).then((r=>dt.isCurrentAttempt(u,i)?ct(e,t,r):void 0))):l.push(fetch(r).then((e=>e.arrayBuffer())).then((e=>n(e))).then((r=>dt.isCurrentAttempt(u,i)?ct(e,t,r):void 0))),await Promise.race(l)}function ct(e,t,r){const{store:n,loadings:o}=e;return n[t]=r,t in o&&(o[t].resolve(r),delete o[t]),r}async function pt(e,t,r){const{store:n,loadings:o}=e;if(t in n)return n[t];if(t in o)return o[t].promise;{let e=new dt(r);return o[t]=e,e.promise}}function ft(e,t){return e.store[t]}function ht(e,t){return t in e.store}function gt(e,t){return t in e.loadings}class bt{constructor(e,t){this.glob=e,this.uri=t}}class dt{static nextAttempt(e){return++e._promiseHandle}static isCurrentAttempt(e,t){return e._promiseHandle===t}constructor(e){this._promiseHandle=0,this._resolve=null,this._reject=null,this._reason=null,this._value=null,this._timeoutHandle=Number.isFinite(e)&&e>0?setTimeout((()=>{this.reject(`Asset loading exceeded timeout of ${e} ms.`)}),e):null,this._promise=new Promise(((e,t)=>{this._value?e(this._value):this._resolve=e,this._reason?t(this._reason):this._reject=t}))}get promise(){return this._promise}resolve(e){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._resolve?this._resolve(e):this._value=e}reject(e){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._reject?this._reject(e):this._reason=e}}class At{constructor(e,t,r,n=e,o=null){this.uri=e,this.loader=t,this.opts=r,this.initial=o,this.filepath=n,this.source=null,this.current=null}cache(e,t){return e.cache(this.uri,t),this.source=e,this.current=t,this}get(e){let t;return t=e.exists(this.uri)?e.current(this.uri):this.initial&&this.initial instanceof At?this.initial.get(e):this.initial,this.source=e,this.current=t,t}async load(e,t=5e3){let r;if(e.exists(this.uri))r=e.current(this.uri);else if(r=await e.load(this.uri,this.filepath,this.loader,this.opts,t),!r)if(this.initial&&this.initial instanceof At){let n=this.initial;r=await e.load(n.uri,n.filepath,n.loader,n.opts,t)}else r=this.initial;return this.source=e,this.current=r,r}async reload(e,t=5e3){let r=await e.reload(this.uri,this.filepath,this.loader,this.opts,t);return this.source=e,this.current=r,r}}const yt=/(.+?)\s+(.*)/,vt=/(.+)=(.+)/;function _t(e,t){let r=t.split(/\s+/);for(let t of r){let r=vt.exec(t);if(!r)continue;let[n,o,s]=r,a=JSON.parse(`[${s}]`);1===a.length?e[o]=a[0]:e[o]=a}}e.AssetManager=class{constructor(e=null){this.parent=e,this.store={},this.loadings={},this.defaults=[]}get(e){const t=this;if(ht(t,e))return ft(t,e);let r=function(e,t){const{defaults:r}=e;for(let n of r)if(n.glob.test(t))return ft(e,n.uri);return null}(t,e);return r||null}async resolve(e,t,r,n,o){return this.get(e)||await this.load(e,t,r,n,o)}fallback(e,t){return function(e,t,r){const{defaults:n}=e;"string"==typeof t&&(t=new ge(t));const o=`__default://[${n.length}]`;return ct(e,o,r),n.push(new bt(t,o)),r}(this,e,t)}cache(e,t){return ct(this,e,t)}async load(e,t,r,n,o){const s=this;return ht(s,e)?ft(s,e):gt(s,e)?await pt(s,e,o):await lt(s,e,t,r,n,o)}async reload(e,t,r,n,o){return await lt(this,e,t,r,n,o)}unload(e){!function(e,t){const{store:r,loadings:n}=e;t in n&&(n[t].reject(new Error("Stop loading to delete asset.")),delete n[t]),t in r&&delete r[t]}(this,e)}clear(e){!function(e,t){"string"==typeof t&&(t=new ge(t));const{store:r,loadings:n}=e;for(let[e,r]of Object.entries(n))t.test(e)&&(r.reject(new Error(`Stop loading to clear assets matching ${t}`)),delete n[e]);for(let e of Object.keys(r))t.test(e)&&delete r[e]}(this,e)}current(e){return ft(this,e)}exists(e){return function(e,t){return Boolean(e.store[t])}(this,e)}loading(e){const t=this;return gt(t,e)?function(e,t){const{loadings:r}=e;return t in r?r[t].promise:null}(t,e):null}keys(){return function(e){return Object.keys(e.store)}(this)}reset(){!function(e){const{store:t,loadings:r,defaults:n}=e;for(let[e,t]of Object.entries(r))t.reject(new Error("Stop loading to clear all assets.")),delete r[e];for(let e of Object.keys(t))delete t[e];n.length=0}(this)}},e.AssetRef=At,e.AtlasLoader=async function e(t,r={onprogress:void 0}){if("string"==typeof t){const n=await fetch(t);return e(await n.arrayBuffer(),r)}if(!(t instanceof ArrayBuffer||ArrayBuffer.isView(t)))throw new Error("Cannot load from source - must be an array buffer or fetchable url.");const n=t;let o={},s=(new TextDecoder).decode(n).split("\n"),a=s.length,u=0;r.onprogress&&r.onprogress(0,0,a);for(let e of s){if(++u,e=e.trim(),e.length<=0)continue;if(e.startsWith("#"))continue;if(e.startsWith("//"))continue;let t=[],n=0,s=e.indexOf(" ");for(;s>=0;)t.push(e.substring(n,s)),n=s+1,s=e.indexOf(" ",n);t.push(e.substring(n));let i=t[0],l=Number.parseInt(t[1]),c=Number.parseInt(t[2]),p=Number.parseInt(t[3]),f=Number.parseInt(t[4]),h=t.length>=6?Number.parseInt(t[5]):1,g=t.length>=7?Number.parseInt(t[6]):h,b=t.length>=8?Number.parseInt(t[7]):h>g?Math.ceil(h/g):1;o[i]={u:l,v:c,w:p,h:f,frames:h,cols:g,rows:b,name:i},r.onprogress&&r.onprogress(u/a,u,a)}return r.onprogress&&r.onprogress(1,u,u),o},e.AudioBufferLoader=async function e(t,r){const{audioContext:n}=r||{};if("string"==typeof t){const r=await fetch(t);return e(await r.arrayBuffer(),{audioContext:n})}if(!(t instanceof ArrayBuffer||ArrayBuffer.isView(t)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");const o=t;let s=new ArrayBuffer(o.byteLength);return new Uint8Array(s).set(o),await n.decodeAudioData(s)},e.BMFontLoader=async function e(t){if("string"==typeof t){const r=await fetch(t);return e(await r.arrayBuffer())}if(!(t instanceof ArrayBuffer||ArrayBuffer.isView(t)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");const r=t;return function(e){let t=e.split("\n"),r={},n={},o={},s=[],a=[];for(let e of t){let t=yt.exec(e);if(!t)continue;let[u,i,l]=t;switch(i){case"info":_t(r,l);break;case"common":_t(n,l);break;case"page":_t(o,l);break;case"chars":break;case"char":let e={};_t(e,l),"id"in e&&s.push(e);break;case"kerning":let t={};_t(t,l),"first"in t&&a.push(t)}}return{info:r,common:n,page:o,chars:s,kernings:a}}((new TextDecoder).decode(r))},e.GlobExp=ge,e.ImageLoader=async function e(t,r){let{imageType:n}=r||{};if("string"==typeof t){const o=await fetch(t),s=await o.arrayBuffer();if(void 0===n){let e=t.lastIndexOf(".");if(e<0)throw new Error("Cannot load from url - unknown image type.");n="image/"+t.slice(e+1)}return e(s,{...r,imageType:n})}if(!(t instanceof ArrayBuffer||ArrayBuffer.isView(t)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");void 0===n&&(n="image/png");let o=new Blob([t],{type:n}),s=URL.createObjectURL(o),a=new Image;return new Promise(((e,t)=>{a.addEventListener("load",(()=>{e(a)})),a.addEventListener("error",(e=>{t(e)})),a.src=s}))},e.OBJLoader=async function e(t){if("string"==typeof t){const r=await fetch(t);return e(await r.arrayBuffer())}if(!(t instanceof ArrayBuffer||ArrayBuffer.isView(t)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");const r=t;return function(e){const t=[],r=[],n=[],o=[],s=[],a=[],u=/^#.*/g,i=/v\s+(\S+)\s+(\S+)\s+(\S+)/g,l=/vn\s+(\S+)\s+(\S+)\s+(\S+)/g,c=/vt\s+(\S+)\s+(\S+)/g,p=/f\s+(([^/\s]*)\/([^/\s]*)\/?([^/\s]*))\s+(([^/\s]*)\/([^/\s]*)\/?([^/\s]*))\s+(([^/\s]*)\/([^/\s]*)\/?([^/\s]*))(\s+(([^/\s]*)\/([^/\s]*)\/?([^/\s]*)))?/g,f=/f\s+([^/\s]+)\s+([^/\s]+)\s+([^/\s]+)/g;let h,g,b,d,A,y,v=!1,_=null;e=e.replace(u,"");for(;null!=(_=i.exec(e));)h=Number.parseFloat(_[1]),g=Number.parseFloat(_[2]),b=Number.parseFloat(_[3]),t.push(h),t.push(g),t.push(b);for(;null!=(_=l.exec(e));)h=Number.parseFloat(_[1]),g=Number.parseFloat(_[2]),b=Number.parseFloat(_[3]),n.push(h),n.push(g),n.push(b);for(;null!=(_=c.exec(e));)h=Number.parseFloat(_[1]),g=Number.parseFloat(_[2]),r.push(h),r.push(g);for(;null!=(_=p.exec(e));)h=Number.parseInt(_[2]),Number.isNaN(h)&&(h=1),g=Number.parseInt(_[6]),Number.isNaN(g)&&(g=1),b=Number.parseInt(_[10]),Number.isNaN(b)&&(b=1),o.push(h),o.push(g),o.push(b),h=Number.parseInt(_[4]),Number.isNaN(h)?(h=Number.parseInt(_[3]),g=Number.parseInt(_[7]),b=Number.parseInt(_[11]),a.push(h),a.push(g),a.push(b),s.push(1),s.push(1),s.push(1)):(g=Number.parseInt(_[8]),Number.isNaN(g)&&(g=1),b=Number.parseInt(_[12]),Number.isNaN(b)&&(b=1),a.push(h),a.push(g),a.push(b),h=Number.parseInt(_[3]),Number.isNaN(h)&&(h=1),g=Number.parseInt(_[7]),Number.isNaN(g)&&(g=1),b=Number.parseInt(_[11]),Number.isNaN(b)&&(b=1),s.push(h),s.push(g),s.push(b)),void 0!==_[13]&&(d=Number.parseInt(_[15]),Number.isNaN(d)&&(d=1),o.push(d),d=Number.parseInt(_[17]),Number.isNaN(d)?(d=Number.parseInt(_[16]),a.push(d),s.push(1)):(a.push(d),d=Number.parseInt(_[16]),s.push(d)),v=!0);for(;null!=(_=f.exec(e));)h=Number.parseInt(_[2]),g=Number.parseInt(_[6]),b=Number.parseInt(_[10]),o.push(h),o.push(g),o.push(b),s.push(1),s.push(1),s.push(1),a.push(1),a.push(1),a.push(1),void 0!==_[13]&&(d=Number.parseInt(_[14]),o.push(d),s.push(1),a.push(1),v=!0);y=o.length;const m=new Float32Array(3*y);for(let e=0;e<y;++e)A=o[e]-1,m[3*e+0]=t[3*A+0],m[3*e+1]=t[3*A+1],m[3*e+2]=t[3*A+2];y=s.length;const R=new Float32Array(2*y);for(let e=0;e<y;++e)A=s[e]-1,R[2*e+0]=r[2*A+0],R[2*e+1]=r[2*A+1];y=a.length;const E=new Float32Array(3*y);for(let e=0;e<y;++e)A=a[e]-1,E[3*e+0]=n[3*A+0],E[3*e+1]=n[3*A+1],E[3*e+2]=n[3*A+2];y=o.length;const x=new Uint16Array(y);for(let e=0;e<y;++e)x[e]=e;v&&console.warn("WebGL does not support quad faces, only triangles.");return{positions:m,texcoords:R,normals:E,indices:x}}((new TextDecoder).decode(r))},e.TextLoader=async function e(t){if("string"==typeof t){const r=await fetch(t);return e(await r.arrayBuffer())}if(!(t instanceof ArrayBuffer||ArrayBuffer.isView(t)))throw new Error("Cannot load from source - must be an array buffer or fetchable url");const r=t;return(new TextDecoder).decode(r)},e.cacheAssetPackAsRaw=async function(e,t,r){const n=e;let o=await fetch(t),s=await o.arrayBuffer();await new Promise(((e,t)=>{ut(new Uint8Array(s),((o,s)=>{if(o)t(o);else{for(let[e,t]of Object.entries(s)){e=e.replaceAll("\\","/");let o=e.indexOf("/");o>=0&&(e=e.substring(o+1));let s="raw://"+e;ct(n,s,t),r&&r(t,s,e)}e()}}))}))},e.loadAssetPack=async function(e,t){let r=await fetch(e),n=await r.arrayBuffer();await new Promise(((e,r)=>{ut(new Uint8Array(n),((n,o)=>{if(n)r(n);else{for(let[e,r]of Object.entries(o))e=e.replaceAll("\\","/"),t(r,e);e()}}))}))},e.preloadAssetRefs=async function(e,t,r=5e3){let n=[];for(let o of t)n.push(o.load(e,r));await Promise.allSettled(n)}}));
//# sourceMappingURL=milque-asset.umd.js.map
