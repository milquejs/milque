!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Milque={})}(this,(function(t){"use strict";var e,n,o,s,a,r,u,i,c,l,p,f={};function h(){if(n)return e;n=1;const t="\\\\/",o=`[^${t}]`,s="\\.",a="\\/",r="[^/]",u=`(?:${a}|$)`,i=`(?:^|${a})`,c=`${s}{1,2}${u}`,l={DOT_LITERAL:s,PLUS_LITERAL:"\\+",QMARK_LITERAL:"\\?",SLASH_LITERAL:a,ONE_CHAR:"(?=.)",QMARK:r,END_ANCHOR:u,DOTS_SLASH:c,NO_DOT:`(?!${s})`,NO_DOTS:`(?!${i}${c})`,NO_DOT_SLASH:`(?!${s}{0,1}${u})`,NO_DOTS_SLASH:`(?!${c})`,QMARK_NO_DOT:`[^.${a}]`,STAR:`${r}*?`,START_ANCHOR:i,SEP:"/"},p={...l,SLASH_LITERAL:`[${t}]`,QMARK:o,STAR:`${o}*?`,DOTS_SLASH:`${s}{1,2}(?:[${t}]|$)`,NO_DOT:`(?!${s})`,NO_DOTS:`(?!(?:^|[${t}])${s}{1,2}(?:[${t}]|$))`,NO_DOT_SLASH:`(?!${s}{0,1}(?:[${t}]|$))`,NO_DOTS_SLASH:`(?!${s}{1,2}(?:[${t}]|$))`,QMARK_NO_DOT:`[^.${t}]`,START_ANCHOR:`(?:^|[${t}])`,END_ANCHOR:`(?:[${t}]|$)`,SEP:"\\"};return e={MAX_LENGTH:65536,POSIX_REGEX_SOURCE:{alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"},REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,extglobChars:t=>({"!":{type:"negate",open:"(?:(?!(?:",close:`))${t.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}),globChars:t=>!0===t?p:l}}function A(){return o||(o=1,function(t){const{REGEX_BACKSLASH:e,REGEX_REMOVE_BACKSLASH:n,REGEX_SPECIAL_CHARS:o,REGEX_SPECIAL_CHARS_GLOBAL:s}=h();t.isObject=t=>null!==t&&"object"==typeof t&&!Array.isArray(t),t.hasRegexChars=t=>o.test(t),t.isRegexChar=e=>1===e.length&&t.hasRegexChars(e),t.escapeRegex=t=>t.replace(s,"\\$1"),t.toPosixSlashes=t=>t.replace(e,"/"),t.isWindows=()=>{if("undefined"!=typeof navigator&&navigator.platform){const t=navigator.platform.toLowerCase();return"win32"===t||"windows"===t}return!("undefined"==typeof process||!process.platform)&&"win32"===process.platform},t.removeBackslashes=t=>t.replace(n,(t=>"\\"===t?"":t)),t.escapeLast=(e,n,o)=>{const s=e.lastIndexOf(n,o);return-1===s?e:"\\"===e[s-1]?t.escapeLast(e,n,s-1):`${e.slice(0,s)}\\${e.slice(s)}`},t.removePrefix=(t,e={})=>{let n=t;return n.startsWith("./")&&(n=n.slice(2),e.prefix="./"),n},t.wrapOutput=(t,e={},n={})=>{let o=`${n.contains?"":"^"}(?:${t})${n.contains?"":"$"}`;return!0===e.negated&&(o=`(?:^(?!${o}).*$)`),o},t.basename=(t,{windows:e}={})=>{const n=t.split(e?/[\\/]/:"/"),o=n[n.length-1];return""===o?n[n.length-2]:o}}(f)),f}function _(){if(a)return s;a=1;const t=A(),{CHAR_ASTERISK:e,CHAR_AT:n,CHAR_BACKWARD_SLASH:o,CHAR_COMMA:r,CHAR_DOT:u,CHAR_EXCLAMATION_MARK:i,CHAR_FORWARD_SLASH:c,CHAR_LEFT_CURLY_BRACE:l,CHAR_LEFT_PARENTHESES:p,CHAR_LEFT_SQUARE_BRACKET:f,CHAR_PLUS:_,CHAR_QUESTION_MARK:d,CHAR_RIGHT_CURLY_BRACE:R,CHAR_RIGHT_PARENTHESES:g,CHAR_RIGHT_SQUARE_BRACKET:E}=h(),y=t=>t===c||t===o,b=t=>{!0!==t.isPrefix&&(t.depth=t.isGlobstar?1/0:1)};return s=(s,a)=>{const h=a||{},A=s.length-1,C=!0===h.parts||!0===h.scanToEnd,$=[],S=[],x=[];let v,H,T=s,L=-1,m=0,O=0,w=!1,k=!1,N=!1,I=!1,B=!1,G=!1,M=!1,D=!1,P=!1,U=!1,K=0,F={value:"",depth:0,isGlob:!1};const j=()=>L>=A,X=()=>(v=H,T.charCodeAt(++L));for(;L<A;){let t;if(H=X(),H!==o){if(!0===G||H===l){for(K++;!0!==j()&&(H=X());)if(H!==o)if(H!==l){if(!0!==G&&H===u&&(H=X())===u){if(w=F.isBrace=!0,N=F.isGlob=!0,U=!0,!0===C)continue;break}if(!0!==G&&H===r){if(w=F.isBrace=!0,N=F.isGlob=!0,U=!0,!0===C)continue;break}if(H===R&&(K--,0===K)){G=!1,w=F.isBrace=!0,U=!0;break}}else K++;else M=F.backslashes=!0,X();if(!0===C)continue;break}if(H!==c){if(!0!==h.noext){if(!0===(H===_||H===n||H===e||H===d||H===i)&&T.charCodeAt(L+1)===p){if(N=F.isGlob=!0,I=F.isExtglob=!0,U=!0,H===i&&L===m&&(P=!0),!0===C){for(;!0!==j()&&(H=X());)if(H!==o){if(H===g){N=F.isGlob=!0,U=!0;break}}else M=F.backslashes=!0,H=X();continue}break}}if(H===e){if(v===e&&(B=F.isGlobstar=!0),N=F.isGlob=!0,U=!0,!0===C)continue;break}if(H===d){if(N=F.isGlob=!0,U=!0,!0===C)continue;break}if(H===f){for(;!0!==j()&&(t=X());)if(t!==o){if(t===E){k=F.isBracket=!0,N=F.isGlob=!0,U=!0;break}}else M=F.backslashes=!0,X();if(!0===C)continue;break}if(!0===h.nonegate||H!==i||L!==m){if(!0!==h.noparen&&H===p){if(N=F.isGlob=!0,!0===C){for(;!0!==j()&&(H=X());)if(H!==p){if(H===g){U=!0;break}}else M=F.backslashes=!0,H=X();continue}break}if(!0===N){if(U=!0,!0===C)continue;break}}else D=F.negated=!0,m++}else{if($.push(L),S.push(F),F={value:"",depth:0,isGlob:!1},!0===U)continue;if(v===u&&L===m+1){m+=2;continue}O=L+1}}else M=F.backslashes=!0,H=X(),H===l&&(G=!0)}!0===h.noext&&(I=!1,N=!1);let Q=T,W="",q="";m>0&&(W=T.slice(0,m),T=T.slice(m),O-=m),Q&&!0===N&&O>0?(Q=T.slice(0,O),q=T.slice(O)):!0===N?(Q="",q=T):Q=T,Q&&""!==Q&&"/"!==Q&&Q!==T&&y(Q.charCodeAt(Q.length-1))&&(Q=Q.slice(0,-1)),!0===h.unescape&&(q&&(q=t.removeBackslashes(q)),Q&&!0===M&&(Q=t.removeBackslashes(Q)));const Z={prefix:W,input:s,start:m,base:Q,glob:q,isBrace:w,isBracket:k,isGlob:N,isExtglob:I,isGlobstar:B,negated:D,negatedExtglob:P};if(!0===h.tokens&&(Z.maxDepth=0,y(H)||S.push(F),Z.tokens=S),!0===h.parts||!0===h.tokens){let t;for(let e=0;e<$.length;e++){const n=t?t+1:m,o=$[e],a=s.slice(n,o);h.tokens&&(0===e&&0!==m?(S[e].isPrefix=!0,S[e].value=W):S[e].value=a,b(S[e]),Z.maxDepth+=S[e].depth),0===e&&""===a||x.push(a),t=o}if(t&&t+1<s.length){const e=s.slice(t+1);x.push(e),h.tokens&&(S[S.length-1].value=e,b(S[S.length-1]),Z.maxDepth+=S[S.length-1].depth)}Z.slashes=$,Z.parts=x}return Z}}function d(){if(u)return r;u=1;const t=h(),e=A(),{MAX_LENGTH:n,POSIX_REGEX_SOURCE:o,REGEX_NON_SPECIAL_CHARS:s,REGEX_SPECIAL_CHARS_BACKREF:a,REPLACEMENTS:i}=t,c=(t,n)=>{if("function"==typeof n.expandRange)return n.expandRange(...t,n);t.sort();const o=`[${t.join("-")}]`;try{new RegExp(o)}catch(n){return t.map((t=>e.escapeRegex(t))).join("..")}return o},l=(t,e)=>`Missing ${t}: "${e}" - use "\\\\${e}" to match literal characters`,p=(r,u)=>{if("string"!=typeof r)throw new TypeError("Expected a string");r=i[r]||r;const f={...u},h="number"==typeof f.maxLength?Math.min(n,f.maxLength):n;let A=r.length;if(A>h)throw new SyntaxError(`Input length: ${A}, exceeds maximum allowed length: ${h}`);const _={type:"bos",value:"",output:f.prepend||""},d=[_],R=f.capture?"":"?:",g=t.globChars(f.windows),E=t.extglobChars(g),{DOT_LITERAL:y,PLUS_LITERAL:b,SLASH_LITERAL:C,ONE_CHAR:$,DOTS_SLASH:S,NO_DOT:x,NO_DOT_SLASH:v,NO_DOTS_SLASH:H,QMARK:T,QMARK_NO_DOT:L,STAR:m,START_ANCHOR:O}=g,w=t=>`(${R}(?:(?!${O}${t.dot?S:y}).)*?)`,k=f.dot?"":x,N=f.dot?T:L;let I=!0===f.bash?w(f):m;f.capture&&(I=`(${I})`),"boolean"==typeof f.noext&&(f.noextglob=f.noext);const B={input:r,index:-1,start:0,dot:!0===f.dot,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:d};r=e.removePrefix(r,B),A=r.length;const G=[],M=[],D=[];let P,U=_;const K=()=>B.index===A-1,F=B.peek=(t=1)=>r[B.index+t],j=B.advance=()=>r[++B.index]||"",X=()=>r.slice(B.index+1),Q=(t="",e=0)=>{B.consumed+=t,B.index+=e},W=t=>{B.output+=null!=t.output?t.output:t.value,Q(t.value)},q=()=>{let t=1;for(;"!"===F()&&("("!==F(2)||"?"===F(3));)j(),B.start++,t++;return t%2!=0&&(B.negated=!0,B.start++,!0)},Z=t=>{B[t]++,D.push(t)},z=t=>{B[t]--,D.pop()},V=t=>{if("globstar"===U.type){const e=B.braces>0&&("comma"===t.type||"brace"===t.type),n=!0===t.extglob||G.length&&("pipe"===t.type||"paren"===t.type);"slash"===t.type||"paren"===t.type||e||n||(B.output=B.output.slice(0,-U.output.length),U.type="star",U.value="*",U.output=I,B.output+=U.output)}if(G.length&&"paren"!==t.type&&(G[G.length-1].inner+=t.value),(t.value||t.output)&&W(t),U&&"text"===U.type&&"text"===t.type)return U.output=(U.output||U.value)+t.value,void(U.value+=t.value);t.prev=U,d.push(t),U=t},Y=(t,e)=>{const n={...E[e],conditions:1,inner:""};n.prev=U,n.parens=B.parens,n.output=B.output;const o=(f.capture?"(":"")+n.open;Z("parens"),V({type:t,value:e,output:B.output?"":$}),V({type:"paren",extglob:!0,value:j(),output:o}),G.push(n)},J=t=>{let e,n=t.close+(f.capture?")":"");if("negate"===t.type){let o=I;if(t.inner&&t.inner.length>1&&t.inner.includes("/")&&(o=w(f)),(o!==I||K()||/^\)+$/.test(X()))&&(n=t.close=`)$))${o}`),t.inner.includes("*")&&(e=X())&&/^\.[^\\/.]+$/.test(e)){const s=p(e,{...u,fastpaths:!1}).output;n=t.close=`)${s})${o})`}"bos"===t.prev.type&&(B.negatedExtglob=!0)}V({type:"paren",extglob:!0,value:P,output:n}),z("parens")};if(!1!==f.fastpaths&&!/(^[*!]|[/()[\]{}"])/.test(r)){let t=!1,n=r.replace(a,((e,n,o,s,a,r)=>"\\"===s?(t=!0,e):"?"===s?n?n+s+(a?T.repeat(a.length):""):0===r?N+(a?T.repeat(a.length):""):T.repeat(o.length):"."===s?y.repeat(o.length):"*"===s?n?n+s+(a?I:""):I:n?e:`\\${e}`));return!0===t&&(n=!0===f.unescape?n.replace(/\\/g,""):n.replace(/\\+/g,(t=>t.length%2==0?"\\\\":t?"\\":""))),n===r&&!0===f.contains?(B.output=r,B):(B.output=e.wrapOutput(n,B,u),B)}for(;!K();){if(P=j(),"\0"===P)continue;if("\\"===P){const t=F();if("/"===t&&!0!==f.bash)continue;if("."===t||";"===t)continue;if(!t){P+="\\",V({type:"text",value:P});continue}const e=/^\\+/.exec(X());let n=0;if(e&&e[0].length>2&&(n=e[0].length,B.index+=n,n%2!=0&&(P+="\\")),!0===f.unescape?P=j():P+=j(),0===B.brackets){V({type:"text",value:P});continue}}if(B.brackets>0&&("]"!==P||"["===U.value||"[^"===U.value)){if(!1!==f.posix&&":"===P){const t=U.value.slice(1);if(t.includes("[")&&(U.posix=!0,t.includes(":"))){const t=U.value.lastIndexOf("["),e=U.value.slice(0,t),n=U.value.slice(t+2),s=o[n];if(s){U.value=e+s,B.backtrack=!0,j(),_.output||1!==d.indexOf(U)||(_.output=$);continue}}}("["===P&&":"!==F()||"-"===P&&"]"===F())&&(P=`\\${P}`),"]"!==P||"["!==U.value&&"[^"!==U.value||(P=`\\${P}`),!0===f.posix&&"!"===P&&"["===U.value&&(P="^"),U.value+=P,W({value:P});continue}if(1===B.quotes&&'"'!==P){P=e.escapeRegex(P),U.value+=P,W({value:P});continue}if('"'===P){B.quotes=1===B.quotes?0:1,!0===f.keepQuotes&&V({type:"text",value:P});continue}if("("===P){Z("parens"),V({type:"paren",value:P});continue}if(")"===P){if(0===B.parens&&!0===f.strictBrackets)throw new SyntaxError(l("opening","("));const t=G[G.length-1];if(t&&B.parens===t.parens+1){J(G.pop());continue}V({type:"paren",value:P,output:B.parens?")":"\\)"}),z("parens");continue}if("["===P){if(!0!==f.nobracket&&X().includes("]"))Z("brackets");else{if(!0!==f.nobracket&&!0===f.strictBrackets)throw new SyntaxError(l("closing","]"));P=`\\${P}`}V({type:"bracket",value:P});continue}if("]"===P){if(!0===f.nobracket||U&&"bracket"===U.type&&1===U.value.length){V({type:"text",value:P,output:`\\${P}`});continue}if(0===B.brackets){if(!0===f.strictBrackets)throw new SyntaxError(l("opening","["));V({type:"text",value:P,output:`\\${P}`});continue}z("brackets");const t=U.value.slice(1);if(!0===U.posix||"^"!==t[0]||t.includes("/")||(P=`/${P}`),U.value+=P,W({value:P}),!1===f.literalBrackets||e.hasRegexChars(t))continue;const n=e.escapeRegex(U.value);if(B.output=B.output.slice(0,-U.value.length),!0===f.literalBrackets){B.output+=n,U.value=n;continue}U.value=`(${R}${n}|${U.value})`,B.output+=U.value;continue}if("{"===P&&!0!==f.nobrace){Z("braces");const t={type:"brace",value:P,output:"(",outputIndex:B.output.length,tokensIndex:B.tokens.length};M.push(t),V(t);continue}if("}"===P){const t=M[M.length-1];if(!0===f.nobrace||!t){V({type:"text",value:P,output:P});continue}let e=")";if(!0===t.dots){const t=d.slice(),n=[];for(let e=t.length-1;e>=0&&(d.pop(),"brace"!==t[e].type);e--)"dots"!==t[e].type&&n.unshift(t[e].value);e=c(n,f),B.backtrack=!0}if(!0!==t.comma&&!0!==t.dots){const n=B.output.slice(0,t.outputIndex),o=B.tokens.slice(t.tokensIndex);t.value=t.output="\\{",P=e="\\}",B.output=n;for(const t of o)B.output+=t.output||t.value}V({type:"brace",value:P,output:e}),z("braces"),M.pop();continue}if("|"===P){G.length>0&&G[G.length-1].conditions++,V({type:"text",value:P});continue}if(","===P){let t=P;const e=M[M.length-1];e&&"braces"===D[D.length-1]&&(e.comma=!0,t="|"),V({type:"comma",value:P,output:t});continue}if("/"===P){if("dot"===U.type&&B.index===B.start+1){B.start=B.index+1,B.consumed="",B.output="",d.pop(),U=_;continue}V({type:"slash",value:P,output:C});continue}if("."===P){if(B.braces>0&&"dot"===U.type){"."===U.value&&(U.output=y);const t=M[M.length-1];U.type="dots",U.output+=P,U.value+=P,t.dots=!0;continue}if(B.braces+B.parens===0&&"bos"!==U.type&&"slash"!==U.type){V({type:"text",value:P,output:y});continue}V({type:"dot",value:P,output:y});continue}if("?"===P){if(!(U&&"("===U.value)&&!0!==f.noextglob&&"("===F()&&"?"!==F(2)){Y("qmark",P);continue}if(U&&"paren"===U.type){const t=F();let e=P;("("===U.value&&!/[!=<:]/.test(t)||"<"===t&&!/<([!=]|\w+>)/.test(X()))&&(e=`\\${P}`),V({type:"text",value:P,output:e});continue}if(!0!==f.dot&&("slash"===U.type||"bos"===U.type)){V({type:"qmark",value:P,output:L});continue}V({type:"qmark",value:P,output:T});continue}if("!"===P){if(!0!==f.noextglob&&"("===F()&&("?"!==F(2)||!/[!=<:]/.test(F(3)))){Y("negate",P);continue}if(!0!==f.nonegate&&0===B.index){q();continue}}if("+"===P){if(!0!==f.noextglob&&"("===F()&&"?"!==F(2)){Y("plus",P);continue}if(U&&"("===U.value||!1===f.regex){V({type:"plus",value:P,output:b});continue}if(U&&("bracket"===U.type||"paren"===U.type||"brace"===U.type)||B.parens>0){V({type:"plus",value:P});continue}V({type:"plus",value:b});continue}if("@"===P){if(!0!==f.noextglob&&"("===F()&&"?"!==F(2)){V({type:"at",extglob:!0,value:P,output:""});continue}V({type:"text",value:P});continue}if("*"!==P){"$"!==P&&"^"!==P||(P=`\\${P}`);const t=s.exec(X());t&&(P+=t[0],B.index+=t[0].length),V({type:"text",value:P});continue}if(U&&("globstar"===U.type||!0===U.star)){U.type="star",U.star=!0,U.value+=P,U.output=I,B.backtrack=!0,B.globstar=!0,Q(P);continue}let t=X();if(!0!==f.noextglob&&/^\([^?]/.test(t)){Y("star",P);continue}if("star"===U.type){if(!0===f.noglobstar){Q(P);continue}const e=U.prev,n=e.prev,o="slash"===e.type||"bos"===e.type,s=n&&("star"===n.type||"globstar"===n.type);if(!0===f.bash&&(!o||t[0]&&"/"!==t[0])){V({type:"star",value:P,output:""});continue}const a=B.braces>0&&("comma"===e.type||"brace"===e.type),u=G.length&&("pipe"===e.type||"paren"===e.type);if(!o&&"paren"!==e.type&&!a&&!u){V({type:"star",value:P,output:""});continue}for(;"/**"===t.slice(0,3);){const e=r[B.index+4];if(e&&"/"!==e)break;t=t.slice(3),Q("/**",3)}if("bos"===e.type&&K()){U.type="globstar",U.value+=P,U.output=w(f),B.output=U.output,B.globstar=!0,Q(P);continue}if("slash"===e.type&&"bos"!==e.prev.type&&!s&&K()){B.output=B.output.slice(0,-(e.output+U.output).length),e.output=`(?:${e.output}`,U.type="globstar",U.output=w(f)+(f.strictSlashes?")":"|$)"),U.value+=P,B.globstar=!0,B.output+=e.output+U.output,Q(P);continue}if("slash"===e.type&&"bos"!==e.prev.type&&"/"===t[0]){const n=void 0!==t[1]?"|$":"";B.output=B.output.slice(0,-(e.output+U.output).length),e.output=`(?:${e.output}`,U.type="globstar",U.output=`${w(f)}${C}|${C}${n})`,U.value+=P,B.output+=e.output+U.output,B.globstar=!0,Q(P+j()),V({type:"slash",value:"/",output:""});continue}if("bos"===e.type&&"/"===t[0]){U.type="globstar",U.value+=P,U.output=`(?:^|${C}|${w(f)}${C})`,B.output=U.output,B.globstar=!0,Q(P+j()),V({type:"slash",value:"/",output:""});continue}B.output=B.output.slice(0,-U.output.length),U.type="globstar",U.output=w(f),U.value+=P,B.output+=U.output,B.globstar=!0,Q(P);continue}const n={type:"star",value:P,output:I};!0!==f.bash?!U||"bracket"!==U.type&&"paren"!==U.type||!0!==f.regex?(B.index!==B.start&&"slash"!==U.type&&"dot"!==U.type||("dot"===U.type?(B.output+=v,U.output+=v):!0===f.dot?(B.output+=H,U.output+=H):(B.output+=k,U.output+=k),"*"!==F()&&(B.output+=$,U.output+=$)),V(n)):(n.output=P,V(n)):(n.output=".*?","bos"!==U.type&&"slash"!==U.type||(n.output=k+n.output),V(n))}for(;B.brackets>0;){if(!0===f.strictBrackets)throw new SyntaxError(l("closing","]"));B.output=e.escapeLast(B.output,"["),z("brackets")}for(;B.parens>0;){if(!0===f.strictBrackets)throw new SyntaxError(l("closing",")"));B.output=e.escapeLast(B.output,"("),z("parens")}for(;B.braces>0;){if(!0===f.strictBrackets)throw new SyntaxError(l("closing","}"));B.output=e.escapeLast(B.output,"{"),z("braces")}if(!0===f.strictSlashes||"star"!==U.type&&"bracket"!==U.type||V({type:"maybe_slash",value:"",output:`${C}?`}),!0===B.backtrack){B.output="";for(const t of B.tokens)B.output+=null!=t.output?t.output:t.value,t.suffix&&(B.output+=t.suffix)}return B};return p.fastpaths=(o,s)=>{const a={...s},r="number"==typeof a.maxLength?Math.min(n,a.maxLength):n,u=o.length;if(u>r)throw new SyntaxError(`Input length: ${u}, exceeds maximum allowed length: ${r}`);o=i[o]||o;const{DOT_LITERAL:c,SLASH_LITERAL:l,ONE_CHAR:p,DOTS_SLASH:f,NO_DOT:h,NO_DOTS:A,NO_DOTS_SLASH:_,STAR:d,START_ANCHOR:R}=t.globChars(a.windows),g=a.dot?A:h,E=a.dot?_:h,y=a.capture?"":"?:";let b=!0===a.bash?".*?":d;a.capture&&(b=`(${b})`);const C=t=>!0===t.noglobstar?b:`(${y}(?:(?!${R}${t.dot?f:c}).)*?)`,$=t=>{switch(t){case"*":return`${g}${p}${b}`;case".*":return`${c}${p}${b}`;case"*.*":return`${g}${b}${c}${p}${b}`;case"*/*":return`${g}${b}${l}${p}${E}${b}`;case"**":return g+C(a);case"**/*":return`(?:${g}${C(a)}${l})?${E}${p}${b}`;case"**/*.*":return`(?:${g}${C(a)}${l})?${E}${b}${c}${p}${b}`;case"**/.*":return`(?:${g}${C(a)}${l})?${c}${p}${b}`;default:{const e=/^(.*?)\.(\w+)$/.exec(t);if(!e)return;const n=$(e[1]);if(!n)return;return n+c+e[2]}}},S=e.removePrefix(o,{negated:!1,prefix:""});let x=$(S);return x&&!0!==a.strictSlashes&&(x+=`${l}?`),x},r=p}function R(){if(c)return i;c=1;const t=_(),e=d(),n=A(),o=h(),s=(t,e,n=!1)=>{if(Array.isArray(t)){const o=t.map((t=>s(t,e,n))),a=t=>{for(const e of o){const n=e(t);if(n)return n}return!1};return a}const o=(a=t)&&"object"==typeof a&&!Array.isArray(a)&&t.tokens&&t.input;var a;if(""===t||"string"!=typeof t&&!o)throw new TypeError("Expected pattern to be a non-empty string");const r=e||{},u=r.windows,i=o?s.compileRe(t,e):s.makeRe(t,e,!1,!0),c=i.state;delete i.state;let l=()=>!1;if(r.ignore){const t={...e,ignore:null,onMatch:null,onResult:null};l=s(r.ignore,t,n)}const p=(n,o=!1)=>{const{isMatch:a,match:p,output:f}=s.test(n,i,e,{glob:t,posix:u}),h={glob:t,state:c,regex:i,posix:u,input:n,output:f,match:p,isMatch:a};return"function"==typeof r.onResult&&r.onResult(h),!1===a?(h.isMatch=!1,!!o&&h):l(n)?("function"==typeof r.onIgnore&&r.onIgnore(h),h.isMatch=!1,!!o&&h):("function"==typeof r.onMatch&&r.onMatch(h),!o||h)};return n&&(p.state=c),p};return s.test=(t,e,o,{glob:a,posix:r}={})=>{if("string"!=typeof t)throw new TypeError("Expected input to be a string");if(""===t)return{isMatch:!1,output:""};const u=o||{},i=u.format||(r?n.toPosixSlashes:null);let c=t===a,l=c&&i?i(t):t;return!1===c&&(l=i?i(t):t,c=l===a),!1!==c&&!0!==u.capture||(c=!0===u.matchBase||!0===u.basename?s.matchBase(t,e,o,r):e.exec(l)),{isMatch:Boolean(c),match:c,output:l}},s.matchBase=(t,e,o)=>(e instanceof RegExp?e:s.makeRe(e,o)).test(n.basename(t)),s.isMatch=(t,e,n)=>s(e,n)(t),s.parse=(t,n)=>Array.isArray(t)?t.map((t=>s.parse(t,n))):e(t,{...n,fastpaths:!1}),s.scan=(e,n)=>t(e,n),s.compileRe=(t,e,n=!1,o=!1)=>{if(!0===n)return t.output;const a=e||{},r=a.contains?"":"^",u=a.contains?"":"$";let i=`${r}(?:${t.output})${u}`;t&&!0===t.negated&&(i=`^(?!${i}).*$`);const c=s.toRegex(i,e);return!0===o&&(c.state=t),c},s.makeRe=(t,n={},o=!1,a=!1)=>{if(!t||"string"!=typeof t)throw new TypeError("Expected a non-empty string");let r={negated:!1,fastpaths:!0};return!1===n.fastpaths||"."!==t[0]&&"*"!==t[0]||(r.output=e.fastpaths(t,n)),r.output||(r=e(t,n)),s.compileRe(r,n,o,a)},s.toRegex=(t,e)=>{try{const n=e||{};return new RegExp(t,n.flags||(n.nocase?"i":""))}catch(t){if(e&&!0===e.debug)throw t;return/$^/}},s.constants=o,i=s}function g(){if(p)return l;p=1;const t=R(),e=A();function n(n,o,s=!1){return!o||null!==o.windows&&void 0!==o.windows||(o={...o,windows:e.isWindows()}),t(n,o,s)}return Object.assign(n,t),l=n}var E=g();class y{constructor(t){let e;e=String("object"==typeof t&&t instanceof y?t.source:t),this.source=e,this.re=E.makeRe(e)}test(t){return this.re.test(t)}}async function b(t,e,n,o,s,a){const{loadings:r}=t;let u;e in r?u=r[e]:(u=new I(a),r[e]=u);const i=I.nextAttempt(u);let c=[u.promise];c.push(o(n,s,t).then((n=>I.isCurrentAttempt(u,i)?($(t,e,n),n):void 0)));let l=await Promise.race(c);if(!l)throw new Error("Failed to load asset - already loaded!");return l}async function C(t,e,n){await Promise.all(e.map((e=>b(t,e.uri,e.uri,e.loader,e.opts,n))))}function $(t,e,n){const{cached:o,loadings:s}=t;o[e]=n,e in s&&(s[e].resolve(n),delete s[e])}function S(t,e,n){const{defaults:o}=t;"string"==typeof e&&(e=new y(e));const s=`__default://[${o.length}]`;$(t,s,n),o.push(new N(e,s))}function x(t,e){const{cached:n}=t;v(t,e,"Cancel loading since deleting asset."),e in n&&delete n[e]}function v(t,e,n="Cancel loading asset."){const{loadings:o}=t;if(e in o){return o[e].reject(new Error(n)),delete o[e],!0}return!1}function H(t){const{cached:e,loadings:n,defaults:o}=t;for(let e of Object.keys(n))v(t,e,"Cancel loading asset - clearing all.");for(let t of Object.keys(e))delete e[t];o.length=0}function T(t,e){const{loadings:n}=t;if(e in n)return n[e].promise;throw new Error(`No loading promise in store for uri "${e}".`)}function L(t,e){const{defaults:n}=t;for(let o of n)if(o.glob.test(e)&&w(t,o.uri))return m(t,o.uri);return null}function m(t,e){if(e in t.cached)return t.cached[e];throw new Error(`No current asset cached for uri "${e}".`)}function O(t){return Object.keys(t.cached)}function w(t,e){return e in t.cached}function k(t,e){return e in t.loadings}class N{constructor(t,e){this.glob=t,this.uri=e}}class I{static nextAttempt(t){return++t.promiseHandle}static isCurrentAttempt(t,e){return t.promiseHandle===e}constructor(t){this._resolve=null,this._reject=null,this._reason=null,this._value=null,this.promiseHandle=0,this.timeoutHandle=Number.isFinite(t)&&t>0?setTimeout((()=>{this.reject(`Asset loading exceeded timeout of ${t} ms.`)}),t):null,this.promise=new Promise(((t,e)=>{this._value?t(this._value):this._resolve=t,this._reason?e(this._reason):this._reject=e}))}resolve(t){this.timeoutHandle&&(clearTimeout(this.timeoutHandle),this.timeoutHandle=null),this._resolve?this._resolve(t):this._value=t}reject(t){this.timeoutHandle&&(clearTimeout(this.timeoutHandle),this.timeoutHandle=null),this._reject?this._reject(t):this._reason=t}}var B=Object.freeze({__proto__:null,Fallback:N,Loading:I,cacheAndResolve:$,cacheAndResolveAsFallback:S,cancelAndReject:v,clearStore:H,create:function(){return{cached:{},loadings:{},defaults:[]}},currentFallback:L,currentKeys:O,currentLoading:T,currentValue:m,deleteAndReject:x,deleteAndRejectByGlob:function(t,e){"string"==typeof e&&(e=new y(e));const{cached:n,loadings:o}=t;for(let n of Object.keys(o))e.test(n)&&v(t,n,`Cancel loading since deleting all assets for "${e}".`);for(let t of Object.keys(n))e.test(t)&&delete n[t]},hasCurrentValue:w,isCurrentLoading:k,loadAllThenCache:C,loadThenCache:b,promiseWhenLoaded:async function(t,e,n){const{loadings:o}=t;if(e in o)return o[e].promise;{let t=new I(n);return o[e]=t,t.promise}}});function G(t,e){return w(t,e.uri)}function M(t,e){if(w(t,e.uri))return m(t,e.uri);const n=L(t,e.uri);return n||null}function D(t,e){let n=M(t,e);if(null!==n)return n;throw new Error(`Trying to get value from asset not yet loaded "${e.uri}".`)}async function P(t,e,n){if(w(t,e.uri))throw new Error(`Asset already cached for "${e.uri}" - probably trying to load duplicate asset name!`);if(k(t,e.uri))throw new Error(`Asset already loading for "${e.uri}" - if this is intentional, use load() instead!`);return await b(t,e.uri,e.uri,e.loader,e.opts,n)}async function U(t,e,n){return w(t,e.uri)?m(t,e.uri):k(t,e.uri)?await T(t,e.uri):await b(t,e.uri,e.uri,e.loader,e.opts,n)}async function K(t,e,n){return await b(t,e.uri,e.uri,e.loader,e.opts,n)}async function F(t,e){return v(t,e.uri)}async function j(t,e,n){$(t,e.uri,n)}async function X(t,e,n){if(w(t,e.uri))throw new Error(`Asset already cached for "${e.uri}" - probably trying to cache duplicate asset name!`);if(k(t,e.uri))throw new Error(`Asset already loading for "${e.uri}" - if this is intentional, use cachePut() instead!`);$(t,e.uri,n)}async function Q(t,e){x(t,e.uri)}var W=Object.freeze({__proto__:null,cachePut:j,cacheSafely:X,cancel:F,create:function(t,e,n={}){return{uri:t,loader:e,opts:n}},dispose:Q,get:M,getOrThrow:D,isCached:G,load:U,preload:P,reload:K});class q{cached={};loadings={};defaults=[];async loadAll(t,e){C(this,t,e)}fallbackFor(t,e){S(this,t,e)}keys(){return O(this)}async clear(){H(this)}}class Z{static DEFAULT_TIMEOUT=5e3;static globalCache=new q;static for(t,e,n){return new Z(t,e,n)}constructor(t,e,n){this.uri=t,this.loader=e,this.opts=n}isCached(){return G(Z.globalCache,this)}get(){return M(Z.globalCache,this)}getOrThrow(){return D(Z.globalCache,this)}async load(t=Z.DEFAULT_TIMEOUT){return await U(Z.globalCache,this,t)}async reload(t=Z.DEFAULT_TIMEOUT){return await K(Z.globalCache,this,t)}async preload(t=Z.DEFAULT_TIMEOUT){return await P(Z.globalCache,this,t)}async cancel(){return F(Z.globalCache,this)}async cachePut(t){j(Z.globalCache,this,t)}async cacheSafely(t){X(Z.globalCache,this,t)}async dispose(){Q(Z.globalCache,this)}}t.Asset=Z,t.GlobExp=y,t.LocalAsset=W,t.LocalAssetStore=B}));
//# sourceMappingURL=index.js.map
