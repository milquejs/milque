"use strict";const t={on(t,e,n=e){let r;if(this.__events.has(t)?r=this.__events.get(t):(r=new Map,this.__events.set(t,r)),r.has(n))throw new Error(`Found callback for event '${t}' with the same handle '${n}'.`);return r.set(n,e),this},off(t,e){if(!this.__events.has(t))throw new Error(`Unable to find event '${t}'.`);{const n=this.__events.get(t);if(!n.has(e))throw new Error(`Unable to find callback for event '${t}' with handle '${e}'.`);n.delete(e)}return this},once(t,e,n=e){return this.on(t,((...r)=>{this.off(t,n),e.apply(this.__context||this,r)}),n)},emit(t,...e){if(this.__events.has(t)){let n=[];const r=Array.from(this.__events.get(t).values());for(const t of r){let r=t.apply(this.__context||this,e);r&&n.push(r)}return n}return this.__events.set(t,new Map),[]}};const e={create:function(e){const n=Object.create(t);return n.__events=new Map,n.__context=e,n},assign:function(e,n){const r=Object.assign(e,t);return r.__events=new Map,r.__context=n,r},mixin:function(e,n){const r=e.prototype;return Object.assign(r,t),r.__events=new Map,r.__context=n,r}},n=5,r=4,o=3,s=2,i=1,a=0,h={[n]:u("#7F8C8D"),[r]:u("#2ECC71"),[o]:u("#4794C8"),[s]:u("#F39C12"),[i]:u("#C0392B"),[a]:[""]};function c(t,e){return t-e}function u(t){return[`background: ${t}`,"border-radius: 0.5em","color: white","font-weight: bold","padding: 2px 0.5em"]}function l(){}function f(t){switch(t){case n:return console.trace;case r:case o:return console.log;case s:return console.warn;case i:return console.error;case a:return l;default:return console.log}}function p(t,e,n,r){if(e&&t.unshift(`[${e}]`),n){let e=(o=n,s=h[r],[`%c${o}`,s.join(";")]);t.unshift(e[0],e[1])}var o,s;return t}const d=Symbol("level"),g=Symbol("domain"),m={};let _=s,w="app";class x{static get TRACE(){return n}static get DEBUG(){return r}static get INFO(){return o}static get WARN(){return s}static get ERROR(){return i}static get OFF(){return a}static getLogger(t){return t in m?m[t]:m[t]=new x(t)}static useDefaultLevel(t){return _=t,this}static useDefaultDomain(t){return w=t,this}constructor(t){this.name=t,this[d]=_,this[g]=w}setLevel(t){return this[d]=t,this}getLevel(){return this[d]}setDomain(t){return this[g]=t,this}getDomain(){return this[g]}log(t,...e){if(c(this[d],t)<0)return this;p(e,this.name,this[g],t),f(t)(...e)}trace(...t){if(c(this[d],n)<0)return this;p(t,this.name,this[g],n),f(n)(...t)}debug(...t){if(c(this[d],r)<0)return this;p(t,this.name,this[g],r),f(r)(...t)}info(...t){if(c(this[d],o)<0)return this;p(t,this.name,this[g],o),f(o)(...t)}warn(...t){if(c(this[d],s)<0)return this;p(t,this.name,this[g],s),f(s)(...t)}error(...t){if(c(this[d],i)<0)return this;p(t,this.name,this[g],i),f(i)(...t)}}const b="png",v="svg";function M(t,e){const n=document.createElement("a"),r=e.indexOf(";");e=e.substring(0,r+1)+"headers=Content-Disposition%3A%20attachment%3B%20filename="+t+";"+e.substring(r+1),n.setAttribute("href",e),n.setAttribute("download",t),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}const y=["svg","g"];function S(t,e=t.cloneNode(!0)){let n=t.childNodes,r=e.childNodes;for(var o=0;o<r.length;o++){let t=r[o],e=t.tagName;if(-1!=y.indexOf(e))S(n[o],t);else if(n[o]instanceof Element){const e=window.getComputedStyle(n[o]);let r=[];for(let t of Object.keys(e))r.push(`${t}:${e.getPropertyValue(t)};`);t.setAttribute("style",r.join(""))}}return e}class E{constructor(t){this._heap=[],this._comparator=t}get size(){return this._heap.length}clear(){this._heap.length=0}push(...t){for(let e of t)this._heap.push(e),this._shiftUp()}pop(){const t=this.peek();let e=this._heap.length-1;return e>0&&this._swap(0,e),this._heap.pop(),this._shiftDown(),t}replace(t){const e=this.peek();return this._heap[0]=t,this._shiftDown(),e}peek(){return this._heap[0]}at(t){return this._heap[t]}indexOf(t,e){return this._heap.indexOf(t,e)}splice(t,e){return this._heap.splice(t,e)}_compare(t,e){return this._comparator(this._heap[t],this._heap[e])}_swap(t,e){let n=this._heap[t];this._heap[t]=this._heap[e],this._heap[e]=n}_shiftUp(){let t,e=this._heap.length-1;for(;e>0&&this._compare(e,t=(e+1>>>1)-1);)this._swap(e,t),e=t}_shiftDown(){const t=this._heap.length;let e,n=0,r=I(n),o=r<t,s=L(n),i=s<t;for(;o&&this._compare(r,n)||i&&this._compare(s,n);)e=i&&this._compare(s,r)?s:r,this._swap(n,e),n=e,r=I(n),o=r<t,s=L(n),i=s<t}values(){return this._heap}[Symbol.iterator](){return this._heap[Symbol.iterator]()}}function I(t){return 1+(t<<1)}function L(t){return t+1<<1}function R(t,e,n){return Math.min(n,Math.max(e,t))}function C(t,e,n){let r=n-e,o=(t-e)%r;return o<0&&(o+=r),o+e}const O=Math.PI/180,N=180/Math.PI;function U(t,e,n){if(n.has(e))throw new Error(`Found cyclic dependency for '${e.name||e}'.`);if(!t.visited.has(e)){if(t.visited.add(e),t.edgeMap.has(e)){let r=t.edgeMap.get(e);if(r.size>0){n.add(e);for(let e of r)U(t,e,n);n.delete(e)}}t.dst.push(e)}}function k(t,e,n=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,o=Number.NaN,s=null){return t.fscore[e]=n,t.gscore[e]=r,t.hscore[e]=o,t.parents[e]=s,e}function D(t){return t>>16&255}function P(t){return t>>8&255}function F(t){return 255&t}function $(t,e,n,r=1){let o=Math.floor(255*Math.max(Math.min(t,1),0)),s=Math.floor(255*Math.max(Math.min(e,1),0)),i=Math.floor(255*Math.max(Math.min(n,1),0));return(255&Math.floor(255*Math.max(Math.min(r,1),0)))<<24|(255&o)<<16|(255&s)<<8|255&i}var A=Object.freeze({__proto__:null,alpha:function(t){return t>>24&255},alphaf:function(t){return(t>>24&255)/255},blue:F,bluef:function(t){return(255&t)/255},green:P,greenf:function(t){return(t>>8&255)/255},hexf:$,mix:function(t=0,e=16777215,n=.5){let r=this.redf(t),o=this.greenf(t),s=this.bluef(t),i=this.alphaf(t),a=(this.redf(e)-r)*n+r,h=(this.greenf(e)-o)*n+o,c=(this.bluef(e)-s)*n+s,u=(this.alphaf(e)-i)*n+i;return u<.01&&(u=void 0),$(a,h,c,u)},red:D,redf:function(t){return(t>>16&255)/255},toCSSColor:function(t){return"number"!=typeof t?t:`#${D(t).toString(16).padStart(2,"0")}${P(t).toString(16).padStart(2,"0")}${F(t).toString(16).padStart(2,"0")}`}});exports.Eventable=e,exports.FILE_TYPE_PNG=b,exports.FILE_TYPE_SVG=v,exports.HEX=A,exports.Logger=x,exports.PriorityQueue=E,exports.astarSearch=function(t,e,n,r){let o={fscore:{},gscore:{},hscore:{},parents:{}};k(o,t);let s=new Set,i=new Set;for(s.add(t);s.size>0;){let t;for(let e of s)t?o.fscore[e]<o.fscore[t]&&(t=e):t=e;let a=t;if(a===e){let t=[];for(;o.parents[a];)t.push(a),a=o.parents[a];return t.push(a),t.reverse()}i.add(a),s.delete(a);for(let t of n(a)){if(i.has(t))continue;let n=o.gscore[a]+1,h=!1;s.has(t)?n<o.gscore[t]&&(h=!0):(h=!0,k(o,t),o.hscore[t]=r(t,e),s.add(t)),h&&(o.parents[t]=a,o.gscore[t]=n,o.fscore[t]=n+o.hscore[t])}}return[]},exports.bitCount=function(t){return 16843009*((t=(858993459&(t-=t>>1&1431655765))+(t>>2&858993459))+(t>>4)&252645135)>>24},exports.bresenhamLine=function(t,e,n,r,o){let s=Math.floor(t),i=Math.floor(e),a=Math.floor(n),h=Math.floor(r),c=Math.abs(n-t),u=t<n?1:-1,l=-Math.abs(r-e),f=e<r?1:-1,p=c+l,d=s,g=i,m=o(d,g);if(void 0!==m)return m;let _=c*c+l*l,w=0;for(;w<_&&(d!==a||g!==h);){++w;let t=2*p;if(t>=l&&(p+=l,d+=u),t<=c&&(p+=c,g+=f),m=o(d,g),void 0!==m)return m}},exports.clamp=R,exports.cycle=C,exports.direction2=function(t,e,n,r){let o=n-t,s=r-e;return Math.atan2(s,o)},exports.distance2=function(t,e,n,r){let o=n-t,s=r-e;return Math.sqrt(o*o+s*s)},exports.downloadImageFromSVG=function(t,e,n,r,o){const s=function(t){const e=S(t),n=(new XMLSerializer).serializeToString(e),r=new Blob([n],{type:"image/svg+xml"});return r}(n);switch(e){case b:{const n=URL.createObjectURL(s),i=document.createElement("canvas"),a=i.getContext("2d"),h=window.devicePixelRatio||1;i.width=r*h,i.height=o*h,i.style.width=r+"px",i.style.height=o+"px",a.setTransform(h,0,0,h,0,0);const c=new Image;c.onload=()=>{a.drawImage(c,0,0),URL.revokeObjectURL(n);const r=i.toDataURL("image/"+e).replace("image/"+e,"image/octet-stream");M(t,r)},c.src=n}break;case v:{const e=new FileReader;e.onload=()=>{M(t,e.result)},e.readAsDataURL(s)}break;default:throw new Error("Unknown file type '"+e+"'")}},exports.downloadText=function(t,e){M(t,"data:text/plain; charset=utf-8,"+encodeURIComponent(e))},exports.downloadURL=M,exports.fisherYatesShuffle=function(t){for(let e=t.length-1;e>0;--e){let n=Math.floor(Math.random()*(e+1)),r=t[e];t[e]=t[n],t[n]=r}return t},exports.getURLParameters=function(t=window.location.search){return Object.fromEntries(new URLSearchParams(t).entries())},exports.lerp=function(t,e,n){return t+(e-t)*n},exports.lookAt2=function(t,e,n){return R(t+C(e-t,-Math.PI,Math.PI),t-n,t+n)},exports.toDegrees=function(t){return t*N},exports.toRadians=function(t){return t*O},exports.topoSort=function(t,e){let n=[];for(let r of t){let t=e(r);if(Array.isArray(t))n.push([r,...t]);else if(t)throw new Error("Dependency callback must return an array.")}return function(t,e,n=[]){let r=new Map;for(let t of e)if(t.length>1){let e=t[0],n=t[1];r.has(e)||r.set(e,new Set),r.has(n)||r.set(n,new Set),r.get(e).add(n)}let o={edgeMap:r,index:t.length,visited:new Set,dst:n};for(let e of t)U(o,e,new Set);return n}(function(t){let e=new Set;for(let n of t)for(let t of n)e.add(t);return Array.from(e)}(n),function(t){let e=[];for(let n of t){let t=n[0];for(let r=1;r<n.length;++r){let o=n[r];e.push([t,o])}}return e}(n))},exports.uploadFile=async function(t=[],e=!1){return new Promise(((n,r)=>{const o=document.createElement("input");o.addEventListener("change",(t=>{n(e?t.target.files:t.target.files[0])})),o.type="file",o.accept=t.join(","),o.style.display="none",o.toggleAttribute("multiple",e),document.body.appendChild(o),o.click(),document.body.removeChild(o)}))},exports.uuid=function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t)},exports.withinRadius=function(t,e,n,r,o){const s=t-n,i=e-r;return s*s+i*i<=o*o};
//# sourceMappingURL=milque-util.cjs.js.map
